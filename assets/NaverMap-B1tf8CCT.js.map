{"version":3,"file":"NaverMap-B1tf8CCT.js","sources":["../../src/pages/company/NaverMap.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport axios from \"axios\";\n\nconst MapComponent = () => {\n  const mapRef = useRef(null);\n  const [clientId, setClientId] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const fixedLatitude = 37.291614;\n  const fixedLongitude = 127.012637;\n\n  const getApiUrl = () => {\n    return (\n      import.meta.env.VITE_API_URL ||\n      (window.location.hostname === \"localhost\"\n        ? \"http://localhost:8080\"\n        : \"https://port-0-java-springboot-mbebujvsfb073e29.sel4.cloudtype.app\")\n    );\n  };\n\n  useEffect(() => {\n    const fetchClientId = async () => {\n      setLoading(true);\n      try {\n        const apiUrl = getApiUrl();\n        console.log(\"Fetching from:\", `${apiUrl}/api/naver/client-id`);\n        const response = await axios.get(`${apiUrl}/api/naver/client-id`, {\n          withCredentials: true,\n        });\n        console.log(\"Response data:\", response.data);\n        setClientId(response.data.clientId);\n      } catch (error) {\n        console.error(\n          \"클라이언트 ID 가져오기 실패:\",\n          error.response ? error.response.status : error.message,\n          error.response ? error.response.data : {}\n        );\n        if (error.response && error.response.status === 401) {\n          //console.warn(\"401 발생, 서버 인증 문제 확인 필요\");\n          setClientId(\"o2rbo106py\"); // 새로 발급받은 client-id 사용\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchClientId();\n  }, []);\n\n  useEffect(() => {\n    if (loading || !clientId) return;\n\n    const script = document.createElement(\"script\");\n    script.src = `https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=${clientId}&callback=initMap`;\n    script.async = true;\n    script.onload = () => {\n      if (window.naver && window.naver.maps) {\n        window.initMap = () => {\n          const map = new window.naver.maps.Map(mapRef.current, {\n            center: new window.naver.maps.LatLng(fixedLatitude, fixedLongitude),\n            zoom: 13,\n            mapTypeControl: true,\n            mapTypeId: window.naver.maps.MapTypeId.SATELLITE,\n            draggable: true,\n            pinchZoom: true,\n            scrollWheel: true,\n          });\n\n          new window.naver.maps.Marker({\n            position: new window.naver.maps.LatLng(fixedLatitude, fixedLongitude),\n            map: map,\n            draggable: false,\n          });\n        };\n        window.initMap();\n      } else {\n        console.error(\"네이버 지도 API 로드 실패 - window.naver 또는 naver.maps가 정의되지 않음\");\n      }\n    };\n    script.onerror = () => console.error(\"네이버 지도 API 로드 실패\");\n    document.head.appendChild(script);\n\n    return () => {\n      document.head.removeChild(script);\n      delete window.initMap;\n    };\n  }, [clientId, loading]);\n\n  // 인증 실패 처리\n  window.navermap_authFailure = function () {\n    console.error(\"네이버 지도 API 인증 실패\");\n    setLoading(false); // 로딩 상태 해제\n  };\n\n  return <div>{loading ? <p>로드 중...</p> : <div ref={mapRef} style={{ width: \"100%\", height: \"500px\" }} />}</div>;\n};\n\nexport default MapComponent;\n"],"names":["MapComponent","mapRef","useRef","clientId","setClientId","useState","loading","setLoading","fixedLatitude","fixedLongitude","getApiUrl","useEffect","apiUrl","response","axios","error","script","map","jsx"],"mappings":"sDAGA,MAAMA,EAAe,IAAM,CACzB,MAAMC,EAASC,EAAAA,OAAO,IAAI,EACpB,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAAS,IAAI,EACvC,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrCG,EAAgB,UAChBC,EAAiB,WAEjBC,EAAY,IAGb,OAAO,SAAS,WAAa,YAC1B,wBACA,qEAIRC,OAAAA,EAAAA,UAAU,IAAM,EACQ,SAAY,CAChCJ,EAAW,EAAI,EACf,GAAI,CACF,MAAMK,EAASF,EAAA,EACf,QAAQ,IAAI,iBAAkB,GAAGE,CAAM,sBAAsB,EAC7D,MAAMC,EAAW,MAAMC,EAAM,IAAI,GAAGF,CAAM,uBAAwB,CAChE,gBAAiB,EAAA,CAClB,EACD,QAAQ,IAAI,iBAAkBC,EAAS,IAAI,EAC3CT,EAAYS,EAAS,KAAK,QAAQ,CACpC,OAASE,EAAO,CACd,QAAQ,MACN,oBACAA,EAAM,SAAWA,EAAM,SAAS,OAASA,EAAM,QAC/CA,EAAM,SAAWA,EAAM,SAAS,KAAO,CAAA,CAAC,EAEtCA,EAAM,UAAYA,EAAM,SAAS,SAAW,KAE9CX,EAAY,YAAY,CAE5B,QAAA,CACEG,EAAW,EAAK,CAClB,CACF,GACA,CACF,EAAG,CAAA,CAAE,EAELI,EAAAA,UAAU,IAAM,CACd,GAAIL,GAAW,CAACH,EAAU,OAE1B,MAAMa,EAAS,SAAS,cAAc,QAAQ,EAC9C,OAAAA,EAAO,IAAM,0DAA0Db,CAAQ,oBAC/Ea,EAAO,MAAQ,GACfA,EAAO,OAAS,IAAM,CAChB,OAAO,OAAS,OAAO,MAAM,MAC/B,OAAO,QAAU,IAAM,CACrB,MAAMC,EAAM,IAAI,OAAO,MAAM,KAAK,IAAIhB,EAAO,QAAS,CACpD,OAAQ,IAAI,OAAO,MAAM,KAAK,OAAOO,EAAeC,CAAc,EAClE,KAAM,GACN,eAAgB,GAChB,UAAW,OAAO,MAAM,KAAK,UAAU,UACvC,UAAW,GACX,UAAW,GACX,YAAa,EAAA,CACd,EAED,IAAI,OAAO,MAAM,KAAK,OAAO,CAC3B,SAAU,IAAI,OAAO,MAAM,KAAK,OAAOD,EAAeC,CAAc,EACpE,IAAAQ,EACA,UAAW,EAAA,CACZ,CACH,EACA,OAAO,QAAA,GAEP,QAAQ,MAAM,wDAAwD,CAE1E,EACAD,EAAO,QAAU,IAAM,QAAQ,MAAM,kBAAkB,EACvD,SAAS,KAAK,YAAYA,CAAM,EAEzB,IAAM,CACX,SAAS,KAAK,YAAYA,CAAM,EAChC,OAAO,OAAO,OAChB,CACF,EAAG,CAACb,EAAUG,CAAO,CAAC,EAGtB,OAAO,qBAAuB,UAAY,CACxC,QAAQ,MAAM,kBAAkB,EAChCC,EAAW,EAAK,CAClB,QAEQ,MAAA,CAAK,SAAAD,QAAW,IAAA,CAAE,SAAA,SAAA,CAAO,EAAOY,EAAAA,IAAC,MAAA,CAAI,IAAKjB,EAAQ,MAAO,CAAE,MAAO,OAAQ,OAAQ,QAAQ,CAAG,EAAG,CAC1G"}