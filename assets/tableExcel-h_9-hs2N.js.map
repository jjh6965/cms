{"version":3,"file":"tableExcel-h_9-hs2N.js","sources":["../../node_modules/tabulator-tables/dist/js/tabulator_esm.mjs","../../src/utils/tableConfig.js","../../node_modules/xlsx/xlsx.mjs","../../src/utils/tableExcel.js"],"sourcesContent":["/* Tabulator v6.3.1 (c) Oliver Folkerd 2025 */\nclass CoreFeature{\n\n\tconstructor(table){\n\t\tthis.table = table;\n\t}\n\n\t//////////////////////////////////////////\n\t/////////////// DataLoad /////////////////\n\t//////////////////////////////////////////\n\n\treloadData(data, silent, columnsChanged){\n\t\treturn this.table.dataLoader.load(data, undefined, undefined, undefined, silent, columnsChanged);\n\t}\n\n\t//////////////////////////////////////////\n\t///////////// Localization ///////////////\n\t//////////////////////////////////////////\n\n\tlangText(){\n\t\treturn this.table.modules.localize.getText(...arguments);\n\t}\n\n\tlangBind(){\n\t\treturn this.table.modules.localize.bind(...arguments);\n\t}\n\n\tlangLocale(){\n\t\treturn this.table.modules.localize.getLocale(...arguments);\n\t}\n\n\n\t//////////////////////////////////////////\n\t////////// Inter Table Comms /////////////\n\t//////////////////////////////////////////\n\n\tcommsConnections(){\n\t\treturn this.table.modules.comms.getConnections(...arguments);\n\t}\n\n\tcommsSend(){\n\t\treturn this.table.modules.comms.send(...arguments);\n\t}\n\n\t//////////////////////////////////////////\n\t//////////////// Layout  /////////////////\n\t//////////////////////////////////////////\n\n\tlayoutMode(){\n\t\treturn this.table.modules.layout.getMode();\n\t}\n\n\tlayoutRefresh(force){\n\t\treturn this.table.modules.layout.layout(force);\n\t}\n\n\n\t//////////////////////////////////////////\n\t/////////////// Event Bus ////////////////\n\t//////////////////////////////////////////\n\n\tsubscribe(){\n\t\treturn this.table.eventBus.subscribe(...arguments);\n\t}\n\n\tunsubscribe(){\n\t\treturn this.table.eventBus.unsubscribe(...arguments);\n\t}\n\n\tsubscribed(key){\n\t\treturn this.table.eventBus.subscribed(key);\n\t}\n\n\tsubscriptionChange(){\n\t\treturn this.table.eventBus.subscriptionChange(...arguments);\n\t}\n\n\tdispatch(){\n\t\treturn this.table.eventBus.dispatch(...arguments);\n\t}\n\n\tchain(){\n\t\treturn this.table.eventBus.chain(...arguments);\n\t}\n\n\tconfirm(){\n\t\treturn this.table.eventBus.confirm(...arguments);\n\t}\n\n\tdispatchExternal(){\n\t\treturn this.table.externalEvents.dispatch(...arguments);\n\t}\n\n\tsubscribedExternal(key){\n\t\treturn this.table.externalEvents.subscribed(key);\n\t}\n\n\tsubscriptionChangeExternal(){\n\t\treturn this.table.externalEvents.subscriptionChange(...arguments);\n\t}\n\n\t//////////////////////////////////////////\n\t//////////////// Options /////////////////\n\t//////////////////////////////////////////\n\n\toptions(key){\n\t\treturn this.table.options[key];\n\t}\n\n\tsetOption(key, value){\n\t\tif(typeof value !== \"undefined\"){\n\t\t\tthis.table.options[key] = value;\n\t\t}\n\n\t\treturn this.table.options[key];\n\t}\n\n\t//////////////////////////////////////////\n\t/////////// Deprecation Checks ///////////\n\t//////////////////////////////////////////\n\n\tdeprecationCheck(oldOption, newOption,  convert){\n\t\treturn this.table.deprecationAdvisor.check(oldOption, newOption,  convert);\n\t}\n\n\tdeprecationCheckMsg(oldOption, msg){\n\t\treturn this.table.deprecationAdvisor.checkMsg(oldOption, msg);\n\t}\n\n\tdeprecationMsg(msg){\n\t\treturn this.table.deprecationAdvisor.msg(msg);\n\t}\n\t//////////////////////////////////////////\n\t//////////////// Modules /////////////////\n\t//////////////////////////////////////////\n\n\tmodule(key){\n\t\treturn this.table.module(key);\n\t}\n}\n\nclass Helpers{\n\n\tstatic elVisible(el){\n\t\treturn !(el.offsetWidth <= 0 && el.offsetHeight <= 0);\n\t}\n\n\tstatic elOffset(el){\n\t\tvar box = el.getBoundingClientRect();\n\n\t\treturn {\n\t\t\ttop: box.top + window.pageYOffset - document.documentElement.clientTop,\n\t\t\tleft: box.left + window.pageXOffset - document.documentElement.clientLeft\n\t\t};\n\t}\n\n\tstatic retrieveNestedData(separator, field, data){\n\t\tvar structure = separator ? field.split(separator) : [field],\n\t\tlength = structure.length,\n\t\toutput;\n\n\t\tfor(let i = 0; i < length; i++){\n\n\t\t\tdata = data[structure[i]];\n\n\t\t\toutput = data;\n\n\t\t\tif(!data){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tstatic deepClone(obj, clone, list = []){\n\t\tvar objectProto = {}.__proto__,\n\t\tarrayProto = [].__proto__;\n\n\t\tif (!clone){\n\t\t\tclone = Object.assign(Array.isArray(obj) ? [] : {}, obj);\n\t\t}\n\n\t\tfor(var i in obj) {\n\t\t\tlet subject = obj[i],\n\t\t\tmatch, copy;\n\n\t\t\tif(subject != null && typeof subject === \"object\" && (subject.__proto__ === objectProto || subject.__proto__ === arrayProto)){\n\t\t\t\tmatch = list.findIndex((item) => {\n\t\t\t\t\treturn item.subject === subject;\n\t\t\t\t});\n\n\t\t\t\tif(match > -1){\n\t\t\t\t\tclone[i] = list[match].copy;\n\t\t\t\t}else {\n\t\t\t\t\tcopy = Object.assign(Array.isArray(subject) ? [] : {}, subject);\n\n\t\t\t\t\tlist.unshift({subject, copy});\n\n\t\t\t\t\tclone[i] = this.deepClone(subject, copy, list);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn clone;\n\t}\n}\n\nlet Popup$1 = class Popup extends CoreFeature{\n\tconstructor(table, element, parent){\n\t\tsuper(table);\n\t\t\n\t\tthis.element = element;\n\t\tthis.container = this._lookupContainer();\n\t\t\n\t\tthis.parent = parent;\n\t\t\n\t\tthis.reversedX = false;\n\t\tthis.childPopup = null;\n\t\tthis.blurable = false;\n\t\tthis.blurCallback = null;\n\t\tthis.blurEventsBound = false;\n\t\tthis.renderedCallback = null;\n\t\t\n\t\tthis.visible = false;\n\t\tthis.hideable = true;\n\t\t\n\t\tthis.element.classList.add(\"tabulator-popup-container\");\n\t\t\n\t\tthis.blurEvent = this.hide.bind(this, false);\n\t\tthis.escEvent = this._escapeCheck.bind(this);\n\t\t\n\t\tthis.destroyBinding = this.tableDestroyed.bind(this);\n\t\tthis.destroyed = false;\n\t}\n\t\n\ttableDestroyed(){\n\t\tthis.destroyed = true;\n\t\tthis.hide(true);\n\t}\n\t\n\t_lookupContainer(){\n\t\tvar container = this.table.options.popupContainer;\n\t\t\n\t\tif(typeof container === \"string\"){\n\t\t\tcontainer = document.querySelector(container);\n\t\t\t\n\t\t\tif(!container){\n\t\t\t\tconsole.warn(\"Menu Error - no container element found matching selector:\",  this.table.options.popupContainer , \"(defaulting to document body)\");\n\t\t\t}\n\t\t}else if (container === true){\n\t\t\tcontainer = this.table.element;\n\t\t}\n\t\t\n\t\tif(container && !this._checkContainerIsParent(container)){\n\t\t\tcontainer = false;\n\t\t\tconsole.warn(\"Menu Error - container element does not contain this table:\",  this.table.options.popupContainer , \"(defaulting to document body)\");\n\t\t}\n\t\t\n\t\tif(!container){\n\t\t\tcontainer = document.body;\n\t\t}\n\t\t\n\t\treturn container;\n\t}\n\t\n\t_checkContainerIsParent(container, element = this.table.element){\n\t\tif(container === element){\n\t\t\treturn true;\n\t\t}else {\n\t\t\treturn element.parentNode ? this._checkContainerIsParent(container, element.parentNode) : false;\n\t\t}\n\t}\n\t\n\trenderCallback(callback){\n\t\tthis.renderedCallback = callback;\n\t}\n\t\n\tcontainerEventCoords(e){\n\t\tvar touch = !(e instanceof MouseEvent);\n\t\t\n\t\tvar x = touch ? e.touches[0].pageX : e.pageX;\n\t\tvar y = touch ? e.touches[0].pageY : e.pageY;\n\t\t\n\t\tif(this.container !== document.body){\n\t\t\tlet parentOffset = Helpers.elOffset(this.container);\n\t\t\t\n\t\t\tx -= parentOffset.left;\n\t\t\ty -= parentOffset.top;\n\t\t}\n\t\t\n\t\treturn {x, y};\n\t}\n\t\n\telementPositionCoords(element, position = \"right\"){\n\t\tvar offset = Helpers.elOffset(element),\n\t\tcontainerOffset, x, y;\n\t\t\n\t\tif(this.container !== document.body){\n\t\t\tcontainerOffset = Helpers.elOffset(this.container);\n\t\t\t\n\t\t\toffset.left -= containerOffset.left;\n\t\t\toffset.top -= containerOffset.top;\n\t\t}\n\t\t\n\t\tswitch(position){\n\t\t\tcase \"right\":\n\t\t\t\tx = offset.left + element.offsetWidth;\n\t\t\t\ty = offset.top - 1;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"bottom\":\n\t\t\t\tx = offset.left;\n\t\t\t\ty = offset.top + element.offsetHeight;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"left\":\n\t\t\t\tx = offset.left;\n\t\t\t\ty = offset.top - 1;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"top\":\n\t\t\t\tx = offset.left;\n\t\t\t\ty = offset.top;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"center\":\n\t\t\t\tx = offset.left + (element.offsetWidth / 2);\n\t\t\t\ty = offset.top + (element.offsetHeight / 2);\n\t\t\t\tbreak;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn {x, y, offset};\n\t}\n\t\n\tshow(origin, position){\n\t\tvar x, y, parentEl, parentOffset, coords;\n\t\t\n\t\tif(this.destroyed || this.table.destroyed){\n\t\t\treturn this;\n\t\t}\n\t\t\n\t\tif(origin instanceof HTMLElement){\n\t\t\tparentEl = origin;\n\t\t\tcoords = this.elementPositionCoords(origin, position);\n\t\t\t\n\t\t\tparentOffset = coords.offset;\n\t\t\tx = coords.x;\n\t\t\ty = coords.y;\n\t\t\t\n\t\t}else if(typeof origin === \"number\"){\n\t\t\tparentOffset = {top:0, left:0};\n\t\t\tx = origin;\n\t\t\ty = position;\n\t\t}else {\n\t\t\tcoords = this.containerEventCoords(origin);\n\t\t\t\n\t\t\tx = coords.x;\n\t\t\ty = coords.y;\n\t\t\t\n\t\t\tthis.reversedX = false;\n\t\t}\n\t\t\n\t\tthis.element.style.top = y + \"px\";\n\t\tthis.element.style.left = x + \"px\";\n\t\t\n\t\tthis.container.appendChild(this.element);\n\t\t\n\t\tif(typeof this.renderedCallback === \"function\"){\n\t\t\tthis.renderedCallback();\n\t\t}\n\t\t\n\t\tthis._fitToScreen(x, y, parentEl, parentOffset, position);\n\t\t\n\t\tthis.visible = true;\n\t\t\n\t\tthis.subscribe(\"table-destroy\", this.destroyBinding);\n\t\t\n\t\tthis.element.addEventListener(\"mousedown\", (e) => {\n\t\t\te.stopPropagation();\n\t\t});\n\t\t\n\t\treturn this;\n\t}\n\t\n\t_fitToScreen(x, y, parentEl, parentOffset, position){\n\t\tvar scrollTop = this.container === document.body ? document.documentElement.scrollTop : this.container.scrollTop;\n\t\t\n\t\t//move menu to start on right edge if it is too close to the edge of the screen\n\t\tif((x + this.element.offsetWidth) >= this.container.offsetWidth || this.reversedX){\n\t\t\tthis.element.style.left = \"\";\n\t\t\t\n\t\t\tif(parentEl){\n\t\t\t\tthis.element.style.right = (this.container.offsetWidth - parentOffset.left) + \"px\";\n\t\t\t}else {\n\t\t\t\tthis.element.style.right = (this.container.offsetWidth - x) + \"px\";\n\t\t\t}\n\t\t\t\n\t\t\tthis.reversedX = true;\n\t\t}\n\t\t\n\t\t//move menu to start on bottom edge if it is too close to the edge of the screen\n\t\tlet offsetHeight = Math.max(this.container.offsetHeight, scrollTop ? this.container.scrollHeight : 0);\n\t\tif((y + this.element.offsetHeight) > offsetHeight) {\n\t\t\tif(parentEl){\n\t\t\t\tswitch(position){\n\t\t\t\t\tcase \"bottom\":\n\t\t\t\t\t\tthis.element.style.top = (parseInt(this.element.style.top) - this.element.offsetHeight - parentEl.offsetHeight - 1) + \"px\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.element.style.top = (parseInt(this.element.style.top) - this.element.offsetHeight + parentEl.offsetHeight + 1) + \"px\";\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tthis.element.style.height = offsetHeight + \"px\";\n\t\t\t}\n\t\t}\n\t}\n\t\n\tisVisible(){\n\t\treturn this.visible;\n\t}\n\t\n\thideOnBlur(callback){\n\t\tthis.blurable = true;\n\t\t\n\t\tif(this.visible){\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(this.visible){\n\t\t\t\t\tthis.table.rowManager.element.addEventListener(\"scroll\", this.blurEvent);\n\t\t\t\t\tthis.subscribe(\"cell-editing\", this.blurEvent);\n\t\t\t\t\tdocument.body.addEventListener(\"click\", this.blurEvent);\n\t\t\t\t\tdocument.body.addEventListener(\"contextmenu\", this.blurEvent);\n\t\t\t\t\tdocument.body.addEventListener(\"mousedown\", this.blurEvent);\n\t\t\t\t\twindow.addEventListener(\"resize\", this.blurEvent);\n\t\t\t\t\tdocument.body.addEventListener(\"keydown\", this.escEvent);\n\n\t\t\t\t\tthis.blurEventsBound = true;\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t\t\n\t\t\tthis.blurCallback = callback;\n\t\t}\n\t\t\n\t\treturn this;\n\t}\n\t\n\t_escapeCheck(e){\n\t\tif(e.keyCode == 27){\n\t\t\tthis.hide();\n\t\t}\n\t}\n\t\n\tblockHide(){\n\t\tthis.hideable = false;\n\t}\n\t\n\trestoreHide(){\n\t\tthis.hideable = true;\n\t}\n\t\n\thide(silent = false){\n\t\tif(this.visible && this.hideable){\n\t\t\tif(this.blurable && this.blurEventsBound){\n\t\t\t\tdocument.body.removeEventListener(\"keydown\", this.escEvent);\n\t\t\t\tdocument.body.removeEventListener(\"click\", this.blurEvent);\n\t\t\t\tdocument.body.removeEventListener(\"contextmenu\", this.blurEvent);\n\t\t\t\tdocument.body.removeEventListener(\"mousedown\", this.blurEvent);\n\t\t\t\twindow.removeEventListener(\"resize\", this.blurEvent);\n\t\t\t\tthis.table.rowManager.element.removeEventListener(\"scroll\", this.blurEvent);\n\t\t\t\tthis.unsubscribe(\"cell-editing\", this.blurEvent);\n\n\t\t\t\tthis.blurEventsBound = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(this.childPopup){\n\t\t\t\tthis.childPopup.hide();\n\t\t\t}\n\t\t\t\n\t\t\tif(this.parent){\n\t\t\t\tthis.parent.childPopup = null;\n\t\t\t}\n\t\t\t\n\t\t\tif(this.element.parentNode){\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t\t\n\t\t\tthis.visible = false;\n\t\t\t\n\t\t\tif(this.blurCallback && !silent){\n\t\t\t\tthis.blurCallback();\n\t\t\t}\n\t\t\t\n\t\t\tthis.unsubscribe(\"table-destroy\", this.destroyBinding);\n\t\t}\n\t\t\n\t\treturn this;\n\t}\n\t\n\tchild(element){\n\t\tif(this.childPopup){\n\t\t\tthis.childPopup.hide();\n\t\t}\n\t\t\n\t\tthis.childPopup = new Popup(this.table, element, this);\n\t\t\n\t\treturn this.childPopup;\n\t}\n};\n\nclass Module extends CoreFeature{\n\t\n\tconstructor(table, name){\n\t\tsuper(table);\n\t\t\n\t\tthis._handler = null;\n\t}\n\t\n\tinitialize(){\n\t\t// setup module when table is initialized, to be overridden in module\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t////// Options Registration ///////\n\t///////////////////////////////////\n\t\n\tregisterTableOption(key, value){\n\t\tthis.table.optionsList.register(key, value);\n\t}\n\t\n\tregisterColumnOption(key, value){\n\t\tthis.table.columnManager.optionsList.register(key, value);\n\t}\n\t\n\t///////////////////////////////////\n\t/// Public Function Registration ///\n\t///////////////////////////////////\n\t\n\tregisterTableFunction(name, func){\n\t\tif(typeof this.table[name] === \"undefined\"){\n\t\t\tthis.table[name] = (...args) => {\n\t\t\t\tthis.table.initGuard(name);\n\t\t\t\t\n\t\t\t\treturn func(...args);\n\t\t\t};\n\t\t}else {\n\t\t\tconsole.warn(\"Unable to bind table function, name already in use\", name);\n\t\t}\n\t}\n\t\n\tregisterComponentFunction(component, func, handler){\n\t\treturn this.table.componentFunctionBinder.bind(component, func, handler);\n\t}\n\t\n\t///////////////////////////////////\n\t////////// Data Pipeline //////////\n\t///////////////////////////////////\n\t\n\tregisterDataHandler(handler, priority){\n\t\tthis.table.rowManager.registerDataPipelineHandler(handler, priority);\n\t\tthis._handler = handler;\n\t}\n\t\n\tregisterDisplayHandler(handler, priority){\n\t\tthis.table.rowManager.registerDisplayPipelineHandler(handler, priority);\n\t\tthis._handler = handler;\n\t}\n\t\n\tdisplayRows(adjust){\n\t\tvar index = this.table.rowManager.displayRows.length - 1, \n\t\tlookupIndex;\n\t\t\n\t\tif(this._handler){\n\t\t\tlookupIndex = this.table.rowManager.displayPipeline.findIndex((item) => {\n\t\t\t\treturn item.handler === this._handler;\n\t\t\t});\n\n\t\t\tif(lookupIndex > -1){\n\t\t\t\tindex = lookupIndex;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(adjust){\n\t\t\tindex = index + adjust;\n\t\t}\n\n\t\tif(this._handler){\n\t\t\tif(index > -1){\n\t\t\t\treturn this.table.rowManager.getDisplayRows(index);\n\t\t\t}else {\n\t\t\t\treturn this.activeRows();\n\t\t\t}\n\t\t}\t\n\t}\n\t\n\tactiveRows(){\n\t\treturn this.table.rowManager.activeRows;\n\t}\n\t\n\trefreshData(renderInPosition, handler){\n\t\tif(!handler){\n\t\t\thandler = this._handler;\n\t\t}\n\t\t\n\t\tif(handler){\n\t\t\tthis.table.rowManager.refreshActiveData(handler, false, renderInPosition);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t//////// Footer Management ////////\n\t///////////////////////////////////\n\t\n\tfooterAppend(element){\n\t\treturn this.table.footerManager.append(element);\n\t}\n\t\n\tfooterPrepend(element){\n\t\treturn this.table.footerManager.prepend(element);\n\t}\n\t\n\tfooterRemove(element){\n\t\treturn this.table.footerManager.remove(element);\n\t} \n\t\n\t///////////////////////////////////\n\t//////// Popups Management ////////\n\t///////////////////////////////////\n\t\n\tpopup(menuEl, menuContainer){\n\t\treturn new Popup$1(this.table, menuEl, menuContainer);\n\t}\n\t\n\t///////////////////////////////////\n\t//////// Alert Management ////////\n\t///////////////////////////////////\n\t\n\talert(content, type){\n\t\treturn this.table.alertManager.alert(content, type);\n\t}\n\t\n\tclearAlert(){\n\t\treturn this.table.alertManager.clear();\n\t}\n\t\n}\n\nvar defaultAccessors = {\r\n\trownum:function(value, data, type, params, column, row){\r\n\t\treturn row.getPosition();\r\n\t}\r\n};\n\nclass Accessor extends Module{\n\t\n\tstatic moduleName = \"accessor\";\n\n\t//load defaults\n\tstatic accessors = defaultAccessors;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.allowedTypes = [\"\", \"data\", \"download\", \"clipboard\", \"print\", \"htmlOutput\"]; //list of accessor types\n\n\t\tthis.registerColumnOption(\"accessor\");\n\t\tthis.registerColumnOption(\"accessorParams\");\n\t\tthis.registerColumnOption(\"accessorData\");\n\t\tthis.registerColumnOption(\"accessorDataParams\");\n\t\tthis.registerColumnOption(\"accessorDownload\");\n\t\tthis.registerColumnOption(\"accessorDownloadParams\");\n\t\tthis.registerColumnOption(\"accessorClipboard\");\n\t\tthis.registerColumnOption(\"accessorClipboardParams\");\n\t\tthis.registerColumnOption(\"accessorPrint\");\n\t\tthis.registerColumnOption(\"accessorPrintParams\");\n\t\tthis.registerColumnOption(\"accessorHtmlOutput\");\n\t\tthis.registerColumnOption(\"accessorHtmlOutputParams\");\n\t}\n\n\tinitialize(){\n\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"row-data-retrieve\", this.transformRow.bind(this));\n\t}\n\n\t//initialize column accessor\n\tinitializeColumn(column){\n\t\tvar match = false,\n\t\tconfig = {};\n\n\t\tthis.allowedTypes.forEach((type) => {\n\t\t\tvar key = \"accessor\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\t\taccessor;\n\n\t\t\tif(column.definition[key]){\n\t\t\t\taccessor = this.lookupAccessor(column.definition[key]);\n\n\t\t\t\tif(accessor){\n\t\t\t\t\tmatch = true;\n\n\t\t\t\t\tconfig[key] = {\n\t\t\t\t\t\taccessor:accessor,\n\t\t\t\t\t\tparams: column.definition[key + \"Params\"] || {},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(match){\n\t\t\tcolumn.modules.accessor = config;\n\t\t}\n\t}\n\n\tlookupAccessor(value){\n\t\tvar accessor = false;\n\n\t\t//set column accessor\n\t\tswitch(typeof value){\n\t\t\tcase \"string\":\n\t\t\t\tif(Accessor.accessors[value]){\n\t\t\t\t\taccessor = Accessor.accessors[value];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Accessor Error - No such accessor found, ignoring: \", value);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\taccessor = value;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn accessor;\n\t}\n\n\t//apply accessor to row\n\ttransformRow(row, type){\n\t\tvar key = \"accessor\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\trowComponent = row.getComponent();\n\n\t\t//clone data object with deep copy to isolate internal data from returned result\n\t\tvar data = Helpers.deepClone(row.data || {});\n\n\t\tthis.table.columnManager.traverse(function(column){\n\t\t\tvar value, accessor, params, colComponent;\n\n\t\t\tif(column.modules.accessor){\n\n\t\t\t\taccessor = column.modules.accessor[key] || column.modules.accessor.accessor || false;\n\n\t\t\t\tif(accessor){\n\t\t\t\t\tvalue = column.getFieldValue(data);\n\n\t\t\t\t\tif(value != \"undefined\"){\n\t\t\t\t\t\tcolComponent = column.getComponent();\n\t\t\t\t\t\tparams = typeof accessor.params === \"function\" ? accessor.params(value, data, type, colComponent, rowComponent) : accessor.params;\n\t\t\t\t\t\tcolumn.setFieldValue(data, accessor.accessor(value, data, type, params, colComponent, rowComponent));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn data;\n\t}\n}\n\nvar defaultConfig = {\n\tmethod: \"GET\",\n};\n\nfunction generateParamsList$1(data, prefix){\n\tvar output = [];\n\n\tprefix = prefix || \"\";\n\n\tif(Array.isArray(data)){\n\t\tdata.forEach((item, i) => {\n\t\t\toutput = output.concat(generateParamsList$1(item, prefix ? prefix + \"[\" + i + \"]\" : i));\n\t\t});\n\t}else if (typeof data === \"object\"){\n\t\tfor (var key in data){\n\t\t\toutput = output.concat(generateParamsList$1(data[key], prefix ? prefix + \"[\" + key + \"]\" : key));\n\t\t}\n\t}else {\n\t\toutput.push({key:prefix, value:data});\n\t}\n\n\treturn output;\n}\n\nfunction serializeParams(params){\n\tvar output = generateParamsList$1(params),\n\tencoded = [];\n\n\toutput.forEach(function(item){\n\t\tencoded.push(encodeURIComponent(item.key) + \"=\" + encodeURIComponent(item.value));\n\t});\n\n\treturn encoded.join(\"&\");\n}\n\nfunction urlBuilder(url, config, params){\n\tif(url){\n\t\tif(params && Object.keys(params).length){\n\t\t\tif(!config.method || config.method.toLowerCase() == \"get\"){\n\t\t\t\tconfig.method = \"get\";\n\n\t\t\t\turl += (url.includes(\"?\") ? \"&\" : \"?\") + serializeParams(params);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn url;\n}\n\nfunction defaultLoaderPromise(url, config, params){\n\tvar contentType;\n\n\treturn new Promise((resolve, reject) => {\n\t\t//set url\n\t\turl = this.urlGenerator.call(this.table, url, config, params);\n\n\t\t//set body content if not GET request\n\t\tif(config.method.toUpperCase() != \"GET\"){\n\t\t\tcontentType = typeof this.table.options.ajaxContentType === \"object\" ?  this.table.options.ajaxContentType : this.contentTypeFormatters[this.table.options.ajaxContentType];\n\t\t\tif(contentType){\n\n\t\t\t\tfor(var key in contentType.headers){\n\t\t\t\t\tif(!config.headers){\n\t\t\t\t\t\tconfig.headers = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tif(typeof config.headers[key] === \"undefined\"){\n\t\t\t\t\t\tconfig.headers[key] = contentType.headers[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconfig.body = contentType.body.call(this, url, config, params);\n\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Ajax Error - Invalid ajaxContentType value:\", this.table.options.ajaxContentType);\n\t\t\t}\n\t\t}\n\n\t\tif(url){\n\t\t\t//configure headers\n\t\t\tif(typeof config.headers === \"undefined\"){\n\t\t\t\tconfig.headers = {};\n\t\t\t}\n\n\t\t\tif(typeof config.headers.Accept === \"undefined\"){\n\t\t\t\tconfig.headers.Accept = \"application/json\";\n\t\t\t}\n\n\t\t\tif(typeof config.headers[\"X-Requested-With\"] === \"undefined\"){\n\t\t\t\tconfig.headers[\"X-Requested-With\"] = \"XMLHttpRequest\";\n\t\t\t}\n\n\t\t\tif(typeof config.mode === \"undefined\"){\n\t\t\t\tconfig.mode = \"cors\";\n\t\t\t}\n\n\t\t\tif(config.mode == \"cors\"){\n\t\t\t\tif(typeof config.headers[\"Origin\"] === \"undefined\"){\n\t\t\t\t\tconfig.headers[\"Origin\"] = window.location.origin;\n\t\t\t\t}\n        \n\t\t\t\tif(typeof config.credentials === \"undefined\"){\n\t\t\t\t\tconfig.credentials = 'same-origin';\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(typeof config.credentials === \"undefined\"){\n\t\t\t\t\tconfig.credentials = 'include';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//send request\n\t\t\tfetch(url, config)\n\t\t\t\t.then((response)=>{\n\t\t\t\t\tif(response.ok) {\n\t\t\t\t\t\tresponse.json()\n\t\t\t\t\t\t\t.then((data)=>{\n\t\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t\t}).catch((error)=>{\n\t\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t\t\tconsole.warn(\"Ajax Load Error - Invalid JSON returned\", error);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.error(\"Ajax Load Error - Connection Error: \" + response.status, response.statusText);\n\t\t\t\t\t\treject(response);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error)=>{\n\t\t\t\t\tconsole.error(\"Ajax Load Error - Connection Error: \", error);\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t}else {\n\t\t\tconsole.warn(\"Ajax Load Error - No URL Set\");\n\t\t\tresolve([]);\n\t\t}\n\t});\n}\n\nfunction generateParamsList(data, prefix){\n\tvar output = [];\n\n\tprefix = prefix || \"\";\n\n\tif(Array.isArray(data)){\n\t\tdata.forEach((item, i) => {\n\t\t\toutput = output.concat(generateParamsList(item, prefix ? prefix + \"[\" + i + \"]\" : i));\n\t\t});\n\t}else if (typeof data === \"object\"){\n\t\tfor (var key in data){\n\t\t\toutput = output.concat(generateParamsList(data[key], prefix ? prefix + \"[\" + key + \"]\" : key));\n\t\t}\n\t}else {\n\t\toutput.push({key:prefix, value:data});\n\t}\n\n\treturn output;\n}\n\nvar defaultContentTypeFormatters = {\n\t\"json\":{\n\t\theaders:{\n\t\t\t'Content-Type': 'application/json',\n\t\t},\n\t\tbody:function(url, config, params){\n\t\t\treturn JSON.stringify(params);\n\t\t},\n\t},\n\t\"form\":{\n\t\theaders:{\n\t\t},\n\t\tbody:function(url, config, params){\n\n\t\t\tvar output = generateParamsList(params),\n\t\t\tform = new FormData();\n\n\t\t\toutput.forEach(function(item){\n\t\t\t\tform.append(item.key, item.value);\n\t\t\t});\n\n\t\t\treturn form;\n\t\t},\n\t},\n};\n\nclass Ajax extends Module{\n\n\tstatic moduleName = \"ajax\";\n\n\t//load defaults\n\tstatic defaultConfig = defaultConfig;\n\tstatic defaultURLGenerator = urlBuilder;\n\tstatic defaultLoaderPromise = defaultLoaderPromise;\n\tstatic contentTypeFormatters = defaultContentTypeFormatters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.config = {}; //hold config object for ajax request\n\t\tthis.url = \"\"; //request URL\n\t\tthis.urlGenerator = false;\n\t\tthis.params = false; //request parameters\n\t\t\n\t\tthis.loaderPromise = false;\n\t\t\n\t\tthis.registerTableOption(\"ajaxURL\", false); //url for ajax loading\n\t\tthis.registerTableOption(\"ajaxURLGenerator\", false);\n\t\tthis.registerTableOption(\"ajaxParams\", {});  //params for ajax loading\n\t\tthis.registerTableOption(\"ajaxConfig\", \"get\"); //ajax request type\n\t\tthis.registerTableOption(\"ajaxContentType\", \"form\"); //ajax request type\n\t\tthis.registerTableOption(\"ajaxRequestFunc\", false); //promise function\n\t\t\n\t\tthis.registerTableOption(\"ajaxRequesting\", function(){});\n\t\tthis.registerTableOption(\"ajaxResponse\", false);\n\t\t\n\t\tthis.contentTypeFormatters = Ajax.contentTypeFormatters;\n\t}\n\t\n\t//initialize setup options\n\tinitialize(){\n\t\tthis.loaderPromise = this.table.options.ajaxRequestFunc || Ajax.defaultLoaderPromise;\n\t\tthis.urlGenerator = this.table.options.ajaxURLGenerator || Ajax.defaultURLGenerator;\n\t\t\n\t\tif(this.table.options.ajaxURL){\n\t\t\tthis.setUrl(this.table.options.ajaxURL);\n\t\t}\n\n\n\t\tthis.setDefaultConfig(this.table.options.ajaxConfig);\n\t\t\n\t\tthis.registerTableFunction(\"getAjaxUrl\", this.getUrl.bind(this));\n\t\t\n\t\tthis.subscribe(\"data-loading\", this.requestDataCheck.bind(this));\n\t\tthis.subscribe(\"data-params\", this.requestParams.bind(this));\n\t\tthis.subscribe(\"data-load\", this.requestData.bind(this));\n\t}\n\t\n\trequestParams(data, config, silent, params){\n\t\tvar ajaxParams = this.table.options.ajaxParams;\n\t\t\n\t\tif(ajaxParams){\n\t\t\tif(typeof ajaxParams === \"function\"){\n\t\t\t\tajaxParams = ajaxParams.call(this.table);\n\t\t\t}\n\t\t\t\n\t\t\tparams = Object.assign(Object.assign({}, ajaxParams), params);\n\t\t}\t\t\n\t\t\n\t\treturn params;\n\t}\n\t\n\trequestDataCheck(data, params, config, silent){\n\t\treturn !!((!data && this.url) || typeof data === \"string\");\n\t}\n\t\n\trequestData(url, params, config, silent, previousData){\n\t\tvar ajaxConfig;\n\t\t\n\t\tif(!previousData && this.requestDataCheck(url)){\n\t\t\tif(url){\n\t\t\t\tthis.setUrl(url);\n\t\t\t}\n\t\t\t\n\t\t\tajaxConfig = this.generateConfig(config);\n\t\t\t\n\t\t\treturn this.sendRequest(this.url, params, ajaxConfig);\n\t\t}else {\n\t\t\treturn previousData;\n\t\t}\n\t}\n\t\n\tsetDefaultConfig(config = {}){\n\t\tthis.config = Object.assign({}, Ajax.defaultConfig);\n\n\t\tif(typeof config == \"string\"){\n\t\t\tthis.config.method = config;\n\t\t}else {\n\t\t\tObject.assign(this.config, config);\n\t\t}\n\t}\n\t\n\t//load config object\n\tgenerateConfig(config = {}){\n\t\tvar ajaxConfig = Object.assign({}, this.config);\n\t\t\n\t\tif(typeof config == \"string\"){\n\t\t\tajaxConfig.method = config;\n\t\t}else {\n\t\t\tObject.assign(ajaxConfig, config);\n\t\t}\n\t\t\n\t\treturn ajaxConfig;\n\t}\n\t\n\t//set request url\n\tsetUrl(url){\n\t\tthis.url = url;\n\t}\n\t\n\t//get request url\n\tgetUrl(){\n\t\treturn this.url;\n\t}\n\t\n\t//send ajax request\n\tsendRequest(url, params, config){\n\t\tif(this.table.options.ajaxRequesting.call(this.table, url, params) !== false){\n\t\t\treturn this.loaderPromise(url, config, params)\n\t\t\t\t.then((data)=>{\n\t\t\t\t\tif(this.table.options.ajaxResponse){\n\t\t\t\t\t\tdata = this.table.options.ajaxResponse.call(this.table, url, params, data);\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\treturn data;\n\t\t\t\t});\n\t\t}else {\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n}\n\nvar defaultPasteActions = {\n\treplace:function(data){\n\t\treturn this.table.setData(data);\n\t},\n\tupdate:function(data){\n\t\treturn this.table.updateOrAddData(data);\n\t},\n\tinsert:function(data){\n\t\treturn this.table.addData(data);\n\t},\n};\n\nvar defaultPasteParsers = {\n\ttable:function(clipboard){\n\t\tvar data = [],\n\t\theaderFindSuccess = true,\n\t\tcolumns = this.table.columnManager.columns,\n\t\tcolumnMap = [],\n\t\trows = [];\n\t\t\n\t\t//get data from clipboard into array of columns and rows.\n\t\tclipboard = clipboard.split(\"\\n\");\n\t\t\n\t\tclipboard.forEach(function(row){\n\t\t\tdata.push(row.split(\"\\t\"));\n\t\t});\n\t\t\n\t\tif(data.length && !(data.length === 1 && data[0].length < 2)){\n\t\t\t\n\t\t\t//check if headers are present by title\n\t\t\tdata[0].forEach(function(value){\n\t\t\t\tvar column = columns.find(function(column){\n\t\t\t\t\treturn value && column.definition.title && value.trim() && column.definition.title.trim() === value.trim();\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(column){\n\t\t\t\t\tcolumnMap.push(column);\n\t\t\t\t}else {\n\t\t\t\t\theaderFindSuccess = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t//check if column headers are present by field\n\t\t\tif(!headerFindSuccess){\n\t\t\t\theaderFindSuccess = true;\n\t\t\t\tcolumnMap = [];\n\t\t\t\t\n\t\t\t\tdata[0].forEach(function(value){\n\t\t\t\t\tvar column = columns.find(function(column){\n\t\t\t\t\t\treturn value && column.field && value.trim() && column.field.trim() === value.trim();\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif(column){\n\t\t\t\t\t\tcolumnMap.push(column);\n\t\t\t\t\t}else {\n\t\t\t\t\t\theaderFindSuccess = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(!headerFindSuccess){\n\t\t\t\t\tcolumnMap = this.table.columnManager.columnsByIndex;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//remove header row if found\n\t\t\tif(headerFindSuccess){\n\t\t\t\tdata.shift();\n\t\t\t}\n\t\t\t\n\t\t\tdata.forEach(function(item){\n\t\t\t\tvar row = {};\n\t\t\t\t\n\t\t\t\titem.forEach(function(value, i){\n\t\t\t\t\tif(columnMap[i]){\n\t\t\t\t\t\trow[columnMap[i].field] = value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\trows.push(row);\n\t\t\t});\n\t\t\t\n\t\t\treturn rows;\n\t\t}else {\n\t\t\treturn false;\n\t\t}\n\t},\n};\n\nvar bindings$2 = {\r\n\tcopyToClipboard:[\"ctrl + 67\", \"meta + 67\"],\r\n};\n\nvar actions$2 = {\r\n\tcopyToClipboard:function(e){\r\n\t\tif(!this.table.modules.edit.currentCell){\r\n\t\t\tif(this.table.modExists(\"clipboard\", true)){\r\n\t\t\t\tthis.table.modules.clipboard.copy(false, true);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n};\n\nvar extensions$4 = {\r\n\tkeybindings:{\r\n\t\tbindings:bindings$2,\r\n\t\tactions:actions$2\r\n\t},\r\n};\n\nclass Clipboard extends Module{\n\n\tstatic moduleName = \"clipboard\";\n\tstatic moduleExtensions = extensions$4;\n\n\t//load defaults\n\tstatic pasteActions = defaultPasteActions;\n\tstatic pasteParsers = defaultPasteParsers;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.mode = true;\n\t\tthis.pasteParser = function(){};\n\t\tthis.pasteAction = function(){};\n\t\tthis.customSelection = false;\n\t\tthis.rowRange = false;\n\t\tthis.blocked = true; //block copy actions not originating from this command\n\n\t\tthis.registerTableOption(\"clipboard\", false); //enable clipboard\n\t\tthis.registerTableOption(\"clipboardCopyStyled\", true); //formatted table data\n\t\tthis.registerTableOption(\"clipboardCopyConfig\", false); //clipboard config\n\t\tthis.registerTableOption(\"clipboardCopyFormatter\", false); //DEPRECATED - REMOVE in 5.0\n\t\tthis.registerTableOption(\"clipboardCopyRowRange\", \"active\"); //restrict clipboard to visible rows only\n\t\tthis.registerTableOption(\"clipboardPasteParser\", \"table\"); //convert pasted clipboard data to rows\n\t\tthis.registerTableOption(\"clipboardPasteAction\", \"insert\"); //how to insert pasted data into the table\n\n\t\tthis.registerColumnOption(\"clipboard\");\n\t\tthis.registerColumnOption(\"titleClipboard\");\n\t}\n\n\tinitialize(){\n\t\tthis.mode = this.table.options.clipboard;\n\n\t\tthis.rowRange = this.table.options.clipboardCopyRowRange;\n\n\t\tif(this.mode === true || this.mode === \"copy\"){\n\t\t\tthis.table.element.addEventListener(\"copy\", (e) => {\n\t\t\t\tvar plain, html, list;\n\n\t\t\t\tif(!this.blocked){\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif(this.customSelection){\n\t\t\t\t\t\tplain = this.customSelection;\n\n\t\t\t\t\t\tif(this.table.options.clipboardCopyFormatter){\n\t\t\t\t\t\t\tplain = this.table.options.clipboardCopyFormatter(\"plain\", plain);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\n\t\t\t\t\t\tlist = this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig, this.table.options.clipboardCopyStyled, this.rowRange, \"clipboard\");\n\n\t\t\t\t\t\thtml = this.table.modules.export.generateHTMLTable(list);\n\t\t\t\t\t\tplain = html ? this.generatePlainContent(list) : \"\";\n\n\t\t\t\t\t\tif(this.table.options.clipboardCopyFormatter){\n\t\t\t\t\t\t\tplain = this.table.options.clipboardCopyFormatter(\"plain\", plain);\n\t\t\t\t\t\t\thtml = this.table.options.clipboardCopyFormatter(\"html\", html);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (window.clipboardData && window.clipboardData.setData) {\n\t\t\t\t\t\twindow.clipboardData.setData('Text', plain);\n\t\t\t\t\t} else if (e.clipboardData && e.clipboardData.setData) {\n\t\t\t\t\t\te.clipboardData.setData('text/plain', plain);\n\t\t\t\t\t\tif(html){\n\t\t\t\t\t\t\te.clipboardData.setData('text/html', html);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (e.originalEvent && e.originalEvent.clipboardData.setData) {\n\t\t\t\t\t\te.originalEvent.clipboardData.setData('text/plain', plain);\n\t\t\t\t\t\tif(html){\n\t\t\t\t\t\t\te.originalEvent.clipboardData.setData('text/html', html);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.dispatchExternal(\"clipboardCopied\", plain, html);\n\n\t\t\t\t\tthis.reset();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif(this.mode === true || this.mode === \"paste\"){\n\t\t\tthis.table.element.addEventListener(\"paste\", (e) => {\n\t\t\t\tthis.paste(e);\n\t\t\t});\n\t\t}\n\n\t\tthis.setPasteParser(this.table.options.clipboardPasteParser);\n\t\tthis.setPasteAction(this.table.options.clipboardPasteAction);\n\n\t\tthis.registerTableFunction(\"copyToClipboard\", this.copy.bind(this));\n\t}\n\n\treset(){\n\t\tthis.blocked = true;\n\t\tthis.customSelection = false;\n\t}\n\n\tgeneratePlainContent (list) {\n\t\tvar output = [];\n\n\t\tlist.forEach((row) => {\n\t\t\tvar rowData = [];\n\n\t\t\trow.columns.forEach((col) => {\n\t\t\t\tvar value = \"\";\n\n\t\t\t\tif(col){\n\n\t\t\t\t\tif(row.type === \"group\"){\n\t\t\t\t\t\tcol.value = col.component.getKey();\n\t\t\t\t\t}\n\n\t\t\t\t\tif(col.value === null){\n\t\t\t\t\t\tvalue = \"\";\n\t\t\t\t\t}else {\n\t\t\t\t\t\tswitch(typeof col.value){\n\t\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\t\tvalue = JSON.stringify(col.value);\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\t\tvalue = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tvalue = col.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trowData.push(value);\n\t\t\t});\n\n\t\t\toutput.push(rowData.join(\"\\t\"));\n\t\t});\n\n\t\treturn output.join(\"\\n\");\n\t}\n\n\tcopy (range, internal) {\n\t\tvar sel, textRange;\n\t\tthis.blocked = false;\n\t\tthis.customSelection = false;\n\t\n\n\t\tif (this.mode === true || this.mode === \"copy\") {\n\n\t\t\tthis.rowRange = range || this.table.options.clipboardCopyRowRange;\n\n\t\t\tif (typeof window.getSelection != \"undefined\" && typeof document.createRange != \"undefined\") {\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.selectNodeContents(this.table.element);\n\t\t\t\tsel = window.getSelection();\n\n\t\t\t\tif (sel.toString() && internal) {\n\t\t\t\t\tthis.customSelection = sel.toString();\n\t\t\t\t}\n\n\t\t\t\tsel.removeAllRanges();\n\t\t\t\tsel.addRange(range);\n\t\t\t} else if (typeof document.selection != \"undefined\" && typeof document.body.createTextRange != \"undefined\") {\n\t\t\t\ttextRange = document.body.createTextRange();\n\t\t\t\ttextRange.moveToElementText(this.table.element);\n\t\t\t\ttextRange.select();\n\t\t\t}\n\n\t\t\tdocument.execCommand('copy');\n\n\t\t\tif (sel) {\n\t\t\t\tsel.removeAllRanges();\n\t\t\t}\n\t\t}\n\t}\n\n\t//PASTE EVENT HANDLING\n\tsetPasteAction(action){\n\n\t\tswitch(typeof action){\n\t\t\tcase \"string\":\n\t\t\t\tthis.pasteAction = Clipboard.pasteActions[action];\n\n\t\t\t\tif(!this.pasteAction){\n\t\t\t\t\tconsole.warn(\"Clipboard Error - No such paste action found:\", action);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tthis.pasteAction = action;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetPasteParser(parser){\n\t\tswitch(typeof parser){\n\t\t\tcase \"string\":\n\t\t\t\tthis.pasteParser = Clipboard.pasteParsers[parser];\n\n\t\t\t\tif(!this.pasteParser){\n\t\t\t\t\tconsole.warn(\"Clipboard Error - No such paste parser found:\", parser);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tthis.pasteParser = parser;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpaste(e){\n\t\tvar data, rowData, rows;\n\n\t\tif(this.checkPasteOrigin(e)){\n\n\t\t\tdata = this.getPasteData(e);\n\n\t\t\trowData = this.pasteParser.call(this, data);\n\n\t\t\tif(rowData){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tif(this.table.modExists(\"mutator\")){\n\t\t\t\t\trowData = this.mutateData(rowData);\n\t\t\t\t}\n\n\t\t\t\trows = this.pasteAction.call(this, rowData);\n\n\t\t\t\tthis.dispatchExternal(\"clipboardPasted\", data, rowData, rows);\n\t\t\t}else {\n\t\t\t\tthis.dispatchExternal(\"clipboardPasteError\", data);\n\t\t\t}\n\t\t}\n\t}\n\n\tmutateData(data){\n\t\tvar output = [];\n\n\t\tif(Array.isArray(data)){\n\t\t\tdata.forEach((row) => {\n\t\t\t\toutput.push(this.table.modules.mutator.transformRow(row, \"clipboard\"));\n\t\t\t});\n\t\t}else {\n\t\t\toutput = data;\n\t\t}\n\n\t\treturn output;\n\t}\n\n\n\tcheckPasteOrigin(e){\n\t\tvar valid = true;\n\t\tvar blocked = this.confirm(\"clipboard-paste\", [e]);\n\n\t\tif(blocked || ![\"DIV\", \"SPAN\"].includes(e.target.tagName)){\n\t\t\tvalid = false;\n\t\t}\n\n\t\treturn valid;\n\t}\n\n\tgetPasteData(e){\n\t\tvar data;\n\n\t\tif (window.clipboardData && window.clipboardData.getData) {\n\t\t\tdata = window.clipboardData.getData('Text');\n\t\t} else if (e.clipboardData && e.clipboardData.getData) {\n\t\t\tdata = e.clipboardData.getData('text/plain');\n\t\t} else if (e.originalEvent && e.originalEvent.clipboardData.getData) {\n\t\t\tdata = e.originalEvent.clipboardData.getData('text/plain');\n\t\t}\n\n\t\treturn data;\n\t}\n}\n\nclass CalcComponent{\n\tconstructor (row){\n\t\tthis._row = row;\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._row.table.componentFunctionBinder.handle(\"row\", target._row, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetData(transform){\n\t\treturn this._row.getData(transform);\n\t}\n\n\tgetElement(){\n\t\treturn this._row.getElement();\n\t}\n\n\tgetTable(){\n\t\treturn this._row.table;\n\t}\n\n\tgetCells(){\n\t\tvar cells = [];\n\n\t\tthis._row.getCells().forEach(function(cell){\n\t\t\tcells.push(cell.getComponent());\n\t\t});\n\n\t\treturn cells;\n\t}\n\n\tgetCell(column){\n\t\tvar cell = this._row.getCell(column);\n\t\treturn cell ? cell.getComponent() : false;\n\t}\n\n\t_getSelf(){\n\t\treturn this._row;\n\t}\n}\n\n//public cell object\nclass CellComponent {\n\n\tconstructor (cell){\n\t\tthis._cell = cell;\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._cell.table.componentFunctionBinder.handle(\"cell\", target._cell, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetValue(){\n\t\treturn this._cell.getValue();\n\t}\n\n\tgetOldValue(){\n\t\treturn this._cell.getOldValue();\n\t}\n\n\tgetInitialValue(){\n\t\treturn this._cell.initialValue;\n\t}\n\n\tgetElement(){\n\t\treturn this._cell.getElement();\n\t}\n\n\tgetRow(){\n\t\treturn this._cell.row.getComponent();\n\t}\n\n\tgetData(transform){\n\t\treturn this._cell.row.getData(transform);\n\t}\n\tgetType(){\n\t\treturn \"cell\";\n\t}\n\tgetField(){\n\t\treturn this._cell.column.getField();\n\t}\n\n\tgetColumn(){\n\t\treturn this._cell.column.getComponent();\n\t}\n\n\tsetValue(value, mutate){\n\t\tif(typeof mutate == \"undefined\"){\n\t\t\tmutate = true;\n\t\t}\n\n\t\tthis._cell.setValue(value, mutate);\n\t}\n\n\trestoreOldValue(){\n\t\tthis._cell.setValueActual(this._cell.getOldValue());\n\t}\n\n\trestoreInitialValue(){\n\t\tthis._cell.setValueActual(this._cell.initialValue);\n\t}\n\n\tcheckHeight(){\n\t\tthis._cell.checkHeight();\n\t}\n\n\tgetTable(){\n\t\treturn this._cell.table;\n\t}\n\n\t_getSelf(){\n\t\treturn this._cell;\n\t}\n}\n\nclass Cell extends CoreFeature{\n\tconstructor(column, row){\n\t\tsuper(column.table);\n\n\t\tthis.table = column.table;\n\t\tthis.column = column;\n\t\tthis.row = row;\n\t\tthis.element = null;\n\t\tthis.value = null;\n\t\tthis.initialValue;\n\t\tthis.oldValue = null;\n\t\tthis.modules = {};\n\n\t\tthis.height = null;\n\t\tthis.width = null;\n\t\tthis.minWidth = null;\n\n\t\tthis.component = null;\n\n\t\tthis.loaded = false; //track if the cell has been added to the DOM yet\n\n\t\tthis.build();\n\t}\n\n\t//////////////// Setup Functions /////////////////\n\t//generate element\n\tbuild(){\n\t\tthis.generateElement();\n\n\t\tthis.setWidth();\n\n\t\tthis._configureCell();\n\n\t\tthis.setValueActual(this.column.getFieldValue(this.row.data));\n\n\t\tthis.initialValue = this.value;\n\t}\n\n\tgenerateElement(){\n\t\tthis.element = document.createElement('div');\n\t\tthis.element.className = \"tabulator-cell\";\n\t\tthis.element.setAttribute(\"role\", \"gridcell\");\n\n\t\tif(this.column.isRowHeader){\n\t\t\tthis.element.classList.add(\"tabulator-row-header\");\n\t\t}\n\t}\n\n\t_configureCell(){\n\t\tvar element = this.element,\n\t\tfield = this.column.getField(),\n\t\tvertAligns = {\n\t\t\ttop:\"flex-start\",\n\t\t\tbottom:\"flex-end\",\n\t\t\tmiddle:\"center\",\n\t\t},\n\t\thozAligns = {\n\t\t\tleft:\"flex-start\",\n\t\t\tright:\"flex-end\",\n\t\t\tcenter:\"center\",\n\t\t};\n\n\t\t//set text alignment\n\t\telement.style.textAlign = this.column.hozAlign;\n\n\t\tif(this.column.vertAlign){\n\t\t\telement.style.display = \"inline-flex\";\n\n\t\t\telement.style.alignItems = vertAligns[this.column.vertAlign] || \"\";\n\n\t\t\tif(this.column.hozAlign){\n\t\t\t\telement.style.justifyContent = hozAligns[this.column.hozAlign] || \"\";\n\t\t\t}\n\t\t}\n\n\t\tif(field){\n\t\t\telement.setAttribute(\"tabulator-field\", field);\n\t\t}\n\n\t\t//add class to cell if needed\n\t\tif(this.column.definition.cssClass){\n\t\t\tvar classNames = this.column.definition.cssClass.split(\" \");\n\t\t\tclassNames.forEach((className) => {\n\t\t\t\telement.classList.add(className);\n\t\t\t});\n\t\t}\n\n\t\tthis.dispatch(\"cell-init\", this);\n\n\t\t//hide cell if not visible\n\t\tif(!this.column.visible){\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\t//generate cell contents\n\t_generateContents(){\n\t\tvar val;\n\n\t\tval = this.chain(\"cell-format\", this, null, () => {\n\t\t\treturn this.element.innerHTML = this.value;\n\t\t});\n\n\t\tswitch(typeof val){\n\t\t\tcase \"object\":\n\t\t\t\tif(val instanceof Node){\n\n\t\t\t\t\t//clear previous cell contents\n\t\t\t\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\n\t\t\t\t\tthis.element.appendChild(val);\n\t\t\t\t}else {\n\t\t\t\t\tthis.element.innerHTML = \"\";\n\n\t\t\t\t\tif(val != null){\n\t\t\t\t\t\tconsole.warn(\"Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:\", val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"undefined\":\n\t\t\t\tthis.element.innerHTML = \"\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.element.innerHTML = val;\n\t\t}\n\t}\n\n\tcellRendered(){\n\t\tthis.dispatch(\"cell-rendered\", this);\n\t}\n\n\t//////////////////// Getters ////////////////////\n\tgetElement(containerOnly){\n\t\tif(!this.loaded){\n\t\t\tthis.loaded = true;\n\t\t\tif(!containerOnly){\n\t\t\t\tthis.layoutElement();\n\t\t\t}\n\t\t}\n\n\t\treturn this.element;\n\t}\n\n\tgetValue(){\n\t\treturn this.value;\n\t}\n\n\tgetOldValue(){\n\t\treturn this.oldValue;\n\t}\n\n\t//////////////////// Actions ////////////////////\n\tsetValue(value, mutate, force){\n\t\tvar changed = this.setValueProcessData(value, mutate, force);\n\n\t\tif(changed){\n\t\t\tthis.dispatch(\"cell-value-updated\", this);\n\n\t\t\tthis.cellRendered();\n\n\t\t\tif(this.column.definition.cellEdited){\n\t\t\t\tthis.column.definition.cellEdited.call(this.table, this.getComponent());\n\t\t\t}\n\n\t\t\tthis.dispatchExternal(\"cellEdited\", this.getComponent());\n\n\t\t\tif(this.subscribedExternal(\"dataChanged\")){\n\t\t\t\tthis.dispatchExternal(\"dataChanged\", this.table.rowManager.getData());\n\t\t\t}\n\t\t}\n\t}\n\n\tsetValueProcessData(value, mutate, force){\n\t\tvar changed = false;\n\n\t\tif(this.value !== value || force){\n\n\t\t\tchanged = true;\n\n\t\t\tif(mutate){\n\t\t\t\tvalue = this.chain(\"cell-value-changing\", [this, value], null, value);\n\t\t\t}\n\t\t}\n\n\t\tthis.setValueActual(value);\n\n\t\tif(changed){\n\t\t\tthis.dispatch(\"cell-value-changed\", this);\n\t\t}\n\n\t\treturn changed;\n\t}\n\n\tsetValueActual(value){\n\t\tthis.oldValue = this.value;\n\n\t\tthis.value = value;\n\n\t\tthis.dispatch(\"cell-value-save-before\", this);\n\n\t\tthis.column.setFieldValue(this.row.data, value);\n\n\t\tthis.dispatch(\"cell-value-save-after\", this);\n\n\t\tif(this.loaded){\n\t\t\tthis.layoutElement();\n\t\t}\n\t}\n\n\tlayoutElement(){\n\t\tthis._generateContents();\n\n\t\tthis.dispatch(\"cell-layout\", this);\n\t}\n\n\tsetWidth(){\n\t\tthis.width = this.column.width;\n\t\tthis.element.style.width = this.column.widthStyled;\n\t}\n\n\tclearWidth(){\n\t\tthis.width = \"\";\n\t\tthis.element.style.width = \"\";\n\t}\n\n\tgetWidth(){\n\t\treturn this.width || this.element.offsetWidth;\n\t}\n\n\tsetMinWidth(){\n\t\tthis.minWidth = this.column.minWidth;\n\t\tthis.element.style.minWidth = this.column.minWidthStyled;\n\t}\n\n\tsetMaxWidth(){\n\t\tthis.maxWidth = this.column.maxWidth;\n\t\tthis.element.style.maxWidth = this.column.maxWidthStyled;\n\t}\n\n\tcheckHeight(){\n\t\t// var height = this.element.css(\"height\");\n\t\tthis.row.reinitializeHeight();\n\t}\n\n\tclearHeight(){\n\t\tthis.element.style.height = \"\";\n\t\tthis.height = null;\n\n\t\tthis.dispatch(\"cell-height\", this, \"\");\n\t}\n\n\tsetHeight(){\n\t\tthis.height = this.row.height;\n\t\tthis.element.style.height = this.row.heightStyled;\n\n\t\tthis.dispatch(\"cell-height\", this, this.row.heightStyled);\n\t}\n\n\tgetHeight(){\n\t\treturn this.height || this.element.offsetHeight;\n\t}\n\n\tshow(){\n\t\tthis.element.style.display = this.column.vertAlign ? \"inline-flex\" : \"\";\n\t}\n\n\thide(){\n\t\tthis.element.style.display = \"none\";\n\t}\n\n\tdelete(){\n\t\tthis.dispatch(\"cell-delete\", this);\n\n\t\tif(!this.table.rowManager.redrawBlock && this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n\n\t\tthis.element = false;\n\t\tthis.column.deleteCell(this);\n\t\tthis.row.deleteCell(this);\n\t\tthis.calcs = {};\n\t}\n\n\tgetIndex(){\n\t\treturn this.row.getCellIndex(this);\n\t}\n\n\t//////////////// Object Generation /////////////////\n\tgetComponent(){\n\t\tif(!this.component){\n\t\t\tthis.component = new CellComponent(this);\n\t\t}\n\n\t\treturn this.component;\n\t}\n}\n\n//public column object\nclass ColumnComponent {\n\tconstructor (column){\n\t\tthis._column = column;\n\t\tthis.type = \"ColumnComponent\";\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._column.table.componentFunctionBinder.handle(\"column\", target._column, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetElement(){\n\t\treturn this._column.getElement();\n\t}\n\n\tgetDefinition(){\n\t\treturn this._column.getDefinition();\n\t}\n\n\tgetField(){\n\t\treturn this._column.getField();\n\t}\n\n\tgetTitleDownload() {\n\t\treturn this._column.getTitleDownload();\n\t}\n\n\tgetCells(){\n\t\tvar cells = [];\n\n\t\tthis._column.cells.forEach(function(cell){\n\t\t\tcells.push(cell.getComponent());\n\t\t});\n\n\t\treturn cells;\n\t}\n\n\tisVisible(){\n\t\treturn this._column.visible;\n\t}\n\n\tshow(){\n\t\tif(this._column.isGroup){\n\t\t\tthis._column.columns.forEach(function(column){\n\t\t\t\tcolumn.show();\n\t\t\t});\n\t\t}else {\n\t\t\tthis._column.show();\n\t\t}\n\t}\n\n\thide(){\n\t\tif(this._column.isGroup){\n\t\t\tthis._column.columns.forEach(function(column){\n\t\t\t\tcolumn.hide();\n\t\t\t});\n\t\t}else {\n\t\t\tthis._column.hide();\n\t\t}\n\t}\n\n\ttoggle(){\n\t\tif(this._column.visible){\n\t\t\tthis.hide();\n\t\t}else {\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\tdelete(){\n\t\treturn this._column.delete();\n\t}\n\n\tgetSubColumns(){\n\t\tvar output = [];\n\n\t\tif(this._column.columns.length){\n\t\t\tthis._column.columns.forEach(function(column){\n\t\t\t\toutput.push(column.getComponent());\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tgetParentColumn(){\n\t\treturn this._column.getParentComponent();\n\t}\n\n\t_getSelf(){\n\t\treturn this._column;\n\t}\n\n\tscrollTo(position, ifVisible){\n\t\treturn this._column.table.columnManager.scrollToColumn(this._column, position, ifVisible);\n\t}\n\n\tgetTable(){\n\t\treturn this._column.table;\n\t}\n\n\tmove(to, after){\n\t\tvar toColumn = this._column.table.columnManager.findColumn(to);\n\n\t\tif(toColumn){\n\t\t\tthis._column.table.columnManager.moveColumn(this._column, toColumn, after);\n\t\t}else {\n\t\t\tconsole.warn(\"Move Error - No matching column found:\", toColumn);\n\t\t}\n\t}\n\n\tgetNextColumn(){\n\t\tvar nextCol = this._column.nextColumn();\n\n\t\treturn nextCol ? nextCol.getComponent() : false;\n\t}\n\n\tgetPrevColumn(){\n\t\tvar prevCol = this._column.prevColumn();\n\n\t\treturn prevCol ? prevCol.getComponent() : false;\n\t}\n\n\tupdateDefinition(updates){\n\t\treturn this._column.updateDefinition(updates);\n\t}\n\n\tgetWidth(){\n\t\treturn this._column.getWidth();\n\t}\n\n\tsetWidth(width){\n\t\tvar result;\n\n\t\tif(width === true){\n\t\t\tresult =  this._column.reinitializeWidth(true);\n\t\t}else {\n\t\t\tresult =  this._column.setWidth(width);\n\t\t}\n\n\t\tthis._column.table.columnManager.rerenderColumns(true);\n\n\t\treturn result;\n\t}\n}\n\nvar defaultColumnOptions = {\n\t\"title\": undefined,\n\t\"field\": undefined,\n\t\"columns\": undefined,\n\t\"visible\": undefined,\n\t\"hozAlign\": undefined,\n\t\"vertAlign\": undefined,\n\t\"width\": undefined,\n\t\"minWidth\": 40,\n\t\"maxWidth\": undefined,\n\t\"maxInitialWidth\": undefined,\n\t\"cssClass\": undefined,\n\t\"variableHeight\": undefined,\n\t\"headerVertical\": undefined,\n\t\"headerHozAlign\": undefined,\n\t\"headerWordWrap\": false,\n\t\"editableTitle\": undefined,\n};\n\nclass Column extends CoreFeature{\n\t\n\tstatic defaultOptionList = defaultColumnOptions;\n\t\n\tconstructor(def, parent, rowHeader){\n\t\tsuper(parent.table);\n\t\t\n\t\tthis.definition = def; //column definition\n\t\tthis.parent = parent; //hold parent object\n\t\tthis.type = \"column\"; //type of element\n\t\tthis.columns = []; //child columns\n\t\tthis.cells = []; //cells bound to this column\n\t\tthis.isGroup = false;\n\t\tthis.isRowHeader = rowHeader;\n\t\tthis.element = this.createElement(); //column header element\n\t\tthis.contentElement = false;\n\t\tthis.titleHolderElement = false;\n\t\tthis.titleElement = false;\n\t\tthis.groupElement = this.createGroupElement(); //column group holder element\n\t\tthis.hozAlign = \"\"; //horizontal text alignment\n\t\tthis.vertAlign = \"\"; //vert text alignment\n\t\t\n\t\t//multi dimensional filed handling\n\t\tthis.field =\"\";\n\t\tthis.fieldStructure = \"\";\n\t\tthis.getFieldValue = \"\";\n\t\tthis.setFieldValue = \"\";\n\t\t\n\t\tthis.titleDownload = null;\n\t\tthis.titleFormatterRendered = false;\n\t\t\n\t\tthis.mapDefinitions();\n\t\t\n\t\tthis.setField(this.definition.field);\n\t\t\n\t\tthis.modules = {}; //hold module variables;\n\t\t\n\t\tthis.width = null; //column width\n\t\tthis.widthStyled = \"\"; //column width pre-styled to improve render efficiency\n\t\tthis.maxWidth = null; //column maximum width\n\t\tthis.maxWidthStyled = \"\"; //column maximum pre-styled to improve render efficiency\n\t\tthis.maxInitialWidth = null;\n\t\tthis.minWidth = null; //column minimum width\n\t\tthis.minWidthStyled = \"\"; //column minimum pre-styled to improve render efficiency\n\t\tthis.widthFixed = false; //user has specified a width for this column\n\t\t\n\t\tthis.visible = true; //default visible state\n\t\t\n\t\tthis.component = null;\n\t\t\n\t\t//initialize column\n\t\tif(this.definition.columns){\n\t\t\t\n\t\t\tthis.isGroup = true;\n\t\t\t\n\t\t\tthis.definition.columns.forEach((def, i) => {\n\t\t\t\tvar newCol = new Column(def, this);\n\t\t\t\tthis.attachColumn(newCol);\n\t\t\t});\n\t\t\t\n\t\t\tthis.checkColumnVisibility();\n\t\t}else {\n\t\t\tparent.registerColumnField(this);\n\t\t}\n\t\t\n\t\tthis._initialize();\n\t}\n\t\n\tcreateElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-col\");\n\t\tel.setAttribute(\"role\", \"columnheader\");\n\t\tel.setAttribute(\"aria-sort\", \"none\");\n\n\t\tif(this.isRowHeader){\n\t\t\tel.classList.add(\"tabulator-row-header\");\n\t\t}\n\t\t\n\t\tswitch(this.table.options.columnHeaderVertAlign){\n\t\t\tcase \"middle\":\n\t\t\t\tel.style.justifyContent = \"center\";\n\t\t\t\tbreak;\n\t\t\tcase \"bottom\":\n\t\t\t\tel.style.justifyContent = \"flex-end\";\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\treturn el;\n\t}\n\t\n\tcreateGroupElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-col-group-cols\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tmapDefinitions(){\n\t\tvar defaults = this.table.options.columnDefaults;\n\t\t\n\t\t//map columnDefaults onto column definitions\n\t\tif(defaults){\n\t\t\tfor(let key in defaults){\n\t\t\t\tif(typeof this.definition[key] === \"undefined\"){\n\t\t\t\t\tthis.definition[key] = defaults[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.definition = this.table.columnManager.optionsList.generate(Column.defaultOptionList, this.definition);\n\t}\n\t\n\tcheckDefinition(){\n\t\tObject.keys(this.definition).forEach((key) => {\n\t\t\tif(Column.defaultOptionList.indexOf(key) === -1){\n\t\t\t\tconsole.warn(\"Invalid column definition option in '\" + (this.field || this.definition.title) + \"' column:\", key);\n\t\t\t}\n\t\t});\n\t}\n\n\tsetField(field){\n\t\tthis.field = field;\n\t\tthis.fieldStructure = field ? (this.table.options.nestedFieldSeparator ? field.split(this.table.options.nestedFieldSeparator) : [field]) : [];\n\t\tthis.getFieldValue = this.fieldStructure.length > 1 ? this._getNestedData : this._getFlatData;\n\t\tthis.setFieldValue = this.fieldStructure.length > 1 ? this._setNestedData : this._setFlatData;\n\t}\n\t\n\t//register column position with column manager\n\tregisterColumnPosition(column){\n\t\tthis.parent.registerColumnPosition(column);\n\t}\n\t\n\t//register column position with column manager\n\tregisterColumnField(column){\n\t\tthis.parent.registerColumnField(column);\n\t}\n\t\n\t//trigger position registration\n\treRegisterPosition(){\n\t\tif(this.isGroup){\n\t\t\tthis.columns.forEach(function(column){\n\t\t\t\tcolumn.reRegisterPosition();\n\t\t\t});\n\t\t}else {\n\t\t\tthis.registerColumnPosition(this);\n\t\t}\n\t}\n\t\n\t//build header element\n\t_initialize(){\n\t\tvar def = this.definition;\n\t\t\n\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\t\t\n\t\tif(def.headerVertical){\n\t\t\tthis.element.classList.add(\"tabulator-col-vertical\");\n\t\t\t\n\t\t\tif(def.headerVertical === \"flip\"){\n\t\t\t\tthis.element.classList.add(\"tabulator-col-vertical-flip\");\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.contentElement = this._buildColumnHeaderContent();\n\t\t\n\t\tthis.element.appendChild(this.contentElement);\n\t\t\n\t\tif(this.isGroup){\n\t\t\tthis._buildGroupHeader();\n\t\t}else {\n\t\t\tthis._buildColumnHeader();\n\t\t}\n\t\t\n\t\tthis.dispatch(\"column-init\", this);\n\t}\n\t\n\t//build header element for header\n\t_buildColumnHeader(){\n\t\tvar def = this.definition;\n\t\t\n\t\tthis.dispatch(\"column-layout\", this);\n\t\t\n\t\t//set column visibility\n\t\tif(typeof def.visible != \"undefined\"){\n\t\t\tif(def.visible){\n\t\t\t\tthis.show(true);\n\t\t\t}else {\n\t\t\t\tthis.hide(true);\n\t\t\t}\n\t\t}\n\t\t\n\t\t//assign additional css classes to column header\n\t\tif(def.cssClass){\n\t\t\tvar classNames = def.cssClass.split(\" \");\n\t\t\tclassNames.forEach((className) => {\n\t\t\t\tthis.element.classList.add(className);\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(def.field){\n\t\t\tthis.element.setAttribute(\"tabulator-field\", def.field);\n\t\t}\n\t\t\n\t\t//set min width if present\n\t\tthis.setMinWidth(parseInt(def.minWidth));\n\t\t\n\t\tif (def.maxInitialWidth) {\n\t\t\tthis.maxInitialWidth = parseInt(def.maxInitialWidth);\n\t\t}\n\t\t\n\t\tif(def.maxWidth){\n\t\t\tthis.setMaxWidth(parseInt(def.maxWidth));\n\t\t}\n\t\t\n\t\tthis.reinitializeWidth();\n\t\t\n\t\t//set horizontal text alignment\n\t\tthis.hozAlign = this.definition.hozAlign;\n\t\tthis.vertAlign = this.definition.vertAlign;\n\t\t\n\t\tthis.titleElement.style.textAlign = this.definition.headerHozAlign;\n\t}\n\t\n\t_buildColumnHeaderContent(){\n\t\tvar contentElement = document.createElement(\"div\");\n\t\tcontentElement.classList.add(\"tabulator-col-content\");\n\t\t\n\t\tthis.titleHolderElement = document.createElement(\"div\");\n\t\tthis.titleHolderElement.classList.add(\"tabulator-col-title-holder\");\n\t\t\n\t\tcontentElement.appendChild(this.titleHolderElement);\n\t\t\n\t\tthis.titleElement = this._buildColumnHeaderTitle();\n\t\t\n\t\tthis.titleHolderElement.appendChild(this.titleElement);\n\t\t\n\t\treturn contentElement;\n\t}\n\t\n\t//build title element of column\n\t_buildColumnHeaderTitle(){\n\t\tvar def = this.definition;\n\t\t\n\t\tvar titleHolderElement = document.createElement(\"div\");\n\t\ttitleHolderElement.classList.add(\"tabulator-col-title\");\n\t\t\n\t\tif(def.headerWordWrap){\n\t\t\ttitleHolderElement.classList.add(\"tabulator-col-title-wrap\");\n\t\t}\n\t\t\n\t\tif(def.editableTitle){\n\t\t\tvar titleElement = document.createElement(\"input\");\n\t\t\ttitleElement.classList.add(\"tabulator-title-editor\");\n\t\t\t\n\t\t\ttitleElement.addEventListener(\"click\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\ttitleElement.focus();\n\t\t\t});\n\t\t\t\n\t\t\ttitleElement.addEventListener(\"mousedown\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t\t\n\t\t\ttitleElement.addEventListener(\"change\", () => {\n\t\t\t\tdef.title = titleElement.value;\n\t\t\t\tthis.dispatchExternal(\"columnTitleChanged\", this.getComponent());\n\t\t\t});\n\t\t\t\n\t\t\ttitleHolderElement.appendChild(titleElement);\n\t\t\t\n\t\t\tif(def.field){\n\t\t\t\tthis.langBind(\"columns|\" + def.field, (text) => {\n\t\t\t\t\ttitleElement.value = text || (def.title || \"&nbsp;\");\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\ttitleElement.value  = def.title || \"&nbsp;\";\n\t\t\t}\n\t\t\t\n\t\t}else {\n\t\t\tif(def.field){\n\t\t\t\tthis.langBind(\"columns|\" + def.field, (text) => {\n\t\t\t\t\tthis._formatColumnHeaderTitle(titleHolderElement, text || (def.title || \"&nbsp;\"));\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tthis._formatColumnHeaderTitle(titleHolderElement, def.title || \"&nbsp;\");\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn titleHolderElement;\n\t}\n\t\n\t_formatColumnHeaderTitle(el, title){\n\t\tvar contents = this.chain(\"column-format\", [this, title, el], null, () => {\n\t\t\treturn title;\n\t\t});\n\t\t\n\t\tswitch(typeof contents){\n\t\t\tcase \"object\":\n\t\t\t\tif(contents instanceof Node){\n\t\t\t\t\tel.appendChild(contents);\n\t\t\t\t}else {\n\t\t\t\t\tel.innerHTML = \"\";\n\t\t\t\t\tconsole.warn(\"Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:\", contents);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"undefined\":\n\t\t\t\tel.innerHTML = \"\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tel.innerHTML = contents;\n\t\t}\n\t}\n\t\n\t//build header element for column group\n\t_buildGroupHeader(){\n\t\tthis.element.classList.add(\"tabulator-col-group\");\n\t\tthis.element.setAttribute(\"role\", \"columngroup\");\n\t\tthis.element.setAttribute(\"aria-title\", this.definition.title);\n\t\t\n\t\t//asign additional css classes to column header\n\t\tif(this.definition.cssClass){\n\t\t\tvar classNames = this.definition.cssClass.split(\" \");\n\t\t\tclassNames.forEach((className) => {\n\t\t\t\tthis.element.classList.add(className);\n\t\t\t});\n\t\t}\n\t\t\n\t\tthis.titleElement.style.textAlign = this.definition.headerHozAlign;\n\t\t\n\t\tthis.element.appendChild(this.groupElement);\n\t}\n\t\n\t//flat field lookup\n\t_getFlatData(data){\n\t\treturn data[this.field];\n\t}\n\t\n\t//nested field lookup\n\t_getNestedData(data){\n\t\tvar dataObj = data,\n\t\tstructure = this.fieldStructure,\n\t\tlength = structure.length,\n\t\toutput;\n\t\t\n\t\tfor(let i = 0; i < length; i++){\n\t\t\t\n\t\t\tdataObj = dataObj[structure[i]];\n\t\t\t\n\t\t\toutput = dataObj;\n\t\t\t\n\t\t\tif(!dataObj){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\t//flat field set\n\t_setFlatData(data, value){\n\t\tif(this.field){\n\t\t\tdata[this.field] = value;\n\t\t}\n\t}\n\t\n\t//nested field set\n\t_setNestedData(data, value){\n\t\tvar dataObj = data,\n\t\tstructure = this.fieldStructure,\n\t\tlength = structure.length;\n\t\t\n\t\tfor(let i = 0; i < length; i++){\n\t\t\t\n\t\t\tif(i == length -1){\n\t\t\t\tdataObj[structure[i]] = value;\n\t\t\t}else {\n\t\t\t\tif(!dataObj[structure[i]]){\n\t\t\t\t\tif(typeof value !== \"undefined\"){\n\t\t\t\t\t\tdataObj[structure[i]] = {};\n\t\t\t\t\t}else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdataObj = dataObj[structure[i]];\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//attach column to this group\n\tattachColumn(column){\n\t\tif(this.groupElement){\n\t\t\tthis.columns.push(column);\n\t\t\tthis.groupElement.appendChild(column.getElement());\n\t\t\t\n\t\t\tcolumn.columnRendered();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Warning - Column being attached to another column instead of column group\");\n\t\t}\n\t}\n\t\n\t//vertically align header in column\n\tverticalAlign(alignment, height){\n\t\t\n\t\t//calculate height of column header and group holder element\n\t\tvar parentHeight = this.parent.isGroup ? this.parent.getGroupElement().clientHeight : (height || this.parent.getHeadersElement().clientHeight);\n\t\t// var parentHeight = this.parent.isGroup ? this.parent.getGroupElement().clientHeight : this.parent.getHeadersElement().clientHeight;\n\t\t\n\t\tthis.element.style.height = parentHeight + \"px\";\n\t\t\n\t\tthis.dispatch(\"column-height\", this, this.element.style.height);\n\t\t\n\t\tif(this.isGroup){\n\t\t\tthis.groupElement.style.minHeight = (parentHeight - this.contentElement.offsetHeight) + \"px\";\n\t\t}\n\t\t\n\t\t//vertically align cell contents\n\t\t// if(!this.isGroup && alignment !== \"top\"){\n\t\t// \tif(alignment === \"bottom\"){\n\t\t// \t\tthis.element.style.paddingTop = (this.element.clientHeight - this.contentElement.offsetHeight) + \"px\";\n\t\t// \t}else{\n\t\t// \t\tthis.element.style.paddingTop = ((this.element.clientHeight - this.contentElement.offsetHeight) / 2) + \"px\";\n\t\t// \t}\n\t\t// }\n\t\t\n\t\tthis.columns.forEach(function(column){\n\t\t\tcolumn.verticalAlign(alignment);\n\t\t});\n\t}\n\t\n\t//clear vertical alignment\n\tclearVerticalAlign(){\n\t\tthis.element.style.paddingTop = \"\";\n\t\tthis.element.style.height = \"\";\n\t\tthis.element.style.minHeight = \"\";\n\t\tthis.groupElement.style.minHeight = \"\";\n\t\t\n\t\tthis.columns.forEach(function(column){\n\t\t\tcolumn.clearVerticalAlign();\n\t\t});\n\t\t\n\t\tthis.dispatch(\"column-height\", this, \"\");\n\t}\n\t\n\t//// Retrieve Column Information ////\n\t//return column header element\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\t\n\t//return column group element\n\tgetGroupElement(){\n\t\treturn this.groupElement;\n\t}\n\t\n\t//return field name\n\tgetField(){\n\t\treturn this.field;\n\t}\n\t\n\tgetTitleDownload() {\n\t\treturn this.titleDownload;\n\t}\n\t\n\t//return the first column in a group\n\tgetFirstColumn(){\n\t\tif(!this.isGroup){\n\t\t\treturn this;\n\t\t}else {\n\t\t\tif(this.columns.length){\n\t\t\t\treturn this.columns[0].getFirstColumn();\n\t\t\t}else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//return the last column in a group\n\tgetLastColumn(){\n\t\tif(!this.isGroup){\n\t\t\treturn this;\n\t\t}else {\n\t\t\tif(this.columns.length){\n\t\t\t\treturn this.columns[this.columns.length -1].getLastColumn();\n\t\t\t}else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//return all columns in a group\n\tgetColumns(traverse){\n\t\tvar columns = [];\n\t\t\n\t\tif(traverse){\n\t\t\tthis.columns.forEach((column) => {\n\t\t\t\tcolumns.push(column);\n\t\t\t\t\n\t\t\t\tcolumns = columns.concat(column.getColumns(true));\n\t\t\t});\n\t\t}else {\n\t\t\tcolumns = this.columns;\n\t\t}\n\t\t\n\t\treturn columns;\n\t}\n\t\n\t//return all columns in a group\n\tgetCells(){\n\t\treturn this.cells;\n\t}\n\t\n\t//retrieve the top column in a group of columns\n\tgetTopColumn(){\n\t\tif(this.parent.isGroup){\n\t\t\treturn this.parent.getTopColumn();\n\t\t}else {\n\t\t\treturn this;\n\t\t}\n\t}\n\t\n\t//return column definition object\n\tgetDefinition(updateBranches){\n\t\tvar colDefs = [];\n\t\t\n\t\tif(this.isGroup && updateBranches){\n\t\t\tthis.columns.forEach(function(column){\n\t\t\t\tcolDefs.push(column.getDefinition(true));\n\t\t\t});\n\t\t\t\n\t\t\tthis.definition.columns = colDefs;\n\t\t}\n\t\t\n\t\treturn this.definition;\n\t}\n\t\n\t//////////////////// Actions ////////////////////\n\tcheckColumnVisibility(){\n\t\tvar visible = false;\n\t\t\n\t\tthis.columns.forEach(function(column){\n\t\t\tif(column.visible){\n\t\t\t\tvisible = true;\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(visible){\n\t\t\tthis.show();\n\t\t\tthis.dispatchExternal(\"columnVisibilityChanged\", this.getComponent(), false);\n\t\t}else {\n\t\t\tthis.hide();\n\t\t}\n\t}\n\t\n\t//show column\n\tshow(silent, responsiveToggle){\n\t\tif(!this.visible){\n\t\t\tthis.visible = true;\n\t\t\t\n\t\t\tthis.element.style.display = \"\";\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.checkColumnVisibility();\n\t\t\t}\n\t\t\t\n\t\t\tthis.cells.forEach(function(cell){\n\t\t\t\tcell.show();\n\t\t\t});\n\t\t\t\n\t\t\tif(!this.isGroup && this.width === null){\n\t\t\t\tthis.reinitializeWidth();\n\t\t\t}\n\t\t\t\n\t\t\tthis.table.columnManager.verticalAlignHeaders();\n\t\t\t\n\t\t\tthis.dispatch(\"column-show\", this, responsiveToggle);\n\t\t\t\n\t\t\tif(!silent){\n\t\t\t\tthis.dispatchExternal(\"columnVisibilityChanged\", this.getComponent(), true);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.matchChildWidths();\n\t\t\t}\n\t\t\t\n\t\t\tif(!this.silent){\n\t\t\t\tthis.table.columnManager.rerenderColumns();\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//hide column\n\thide(silent, responsiveToggle){\n\t\tif(this.visible){\n\t\t\tthis.visible = false;\n\t\t\t\n\t\t\tthis.element.style.display = \"none\";\n\t\t\t\n\t\t\tthis.table.columnManager.verticalAlignHeaders();\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.checkColumnVisibility();\n\t\t\t}\n\t\t\t\n\t\t\tthis.cells.forEach(function(cell){\n\t\t\t\tcell.hide();\n\t\t\t});\n\t\t\t\n\t\t\tthis.dispatch(\"column-hide\", this, responsiveToggle);\n\t\t\t\n\t\t\tif(!silent){\n\t\t\t\tthis.dispatchExternal(\"columnVisibilityChanged\", this.getComponent(), false);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.matchChildWidths();\n\t\t\t}\n\t\t\t\n\t\t\tif(!this.silent){\n\t\t\t\tthis.table.columnManager.rerenderColumns();\n\t\t\t}\n\t\t}\n\t}\n\t\n\tmatchChildWidths(){\n\t\tvar childWidth = 0;\n\t\t\n\t\tif(this.contentElement && this.columns.length){\n\t\t\tthis.columns.forEach(function(column){\n\t\t\t\tif(column.visible){\n\t\t\t\t\tchildWidth += column.getWidth();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.contentElement.style.maxWidth = (childWidth - 1) + \"px\";\n\t\t\tif (this.table.initialized) {\n\t\t\t\tthis.element.style.width = childWidth + \"px\";\n\t\t\t}\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.matchChildWidths();\n\t\t\t}\n\t\t}\n\t}\n\t\n\tremoveChild(child){\n\t\tvar index = this.columns.indexOf(child);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.columns.splice(index, 1);\n\t\t}\n\t\t\n\t\tif(!this.columns.length){\n\t\t\tthis.delete();\n\t\t}\n\t}\n\t\n\tsetWidth(width){\n\t\tthis.widthFixed = true;\n\t\tthis.setWidthActual(width);\n\t}\n\t\n\tsetWidthActual(width){\n\t\tif(isNaN(width)){\n\t\t\twidth = Math.floor((this.table.element.clientWidth/100) * parseInt(width));\n\t\t}\n\t\t\n\t\twidth = Math.max(this.minWidth, width);\n\t\t\n\t\tif(this.maxWidth){\n\t\t\twidth = Math.min(this.maxWidth, width);\n\t\t}\n\t\t\n\t\tthis.width = width;\n\t\tthis.widthStyled = width ? width + \"px\" : \"\";\n\t\t\n\t\tthis.element.style.width = this.widthStyled;\n\t\t\n\t\tif(!this.isGroup){\n\t\t\tthis.cells.forEach(function(cell){\n\t\t\t\tcell.setWidth();\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(this.parent.isGroup){\n\t\t\tthis.parent.matchChildWidths();\n\t\t}\n\t\t\n\t\tthis.dispatch(\"column-width\", this);\n\t\t\n\t\tif(this.subscribedExternal(\"columnWidth\")){\n\t\t\tthis.dispatchExternal(\"columnWidth\", this.getComponent());\n\t\t}\n\t}\n\t\n\tcheckCellHeights(){\n\t\tvar rows = [];\n\t\t\n\t\tthis.cells.forEach(function(cell){\n\t\t\tif(cell.row.heightInitialized){\n\t\t\t\tif(cell.row.getElement().offsetParent !== null){\n\t\t\t\t\trows.push(cell.row);\n\t\t\t\t\tcell.row.clearCellHeight();\n\t\t\t\t}else {\n\t\t\t\t\tcell.row.heightInitialized = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\trows.forEach(function(row){\n\t\t\trow.calcHeight();\n\t\t});\n\t\t\n\t\trows.forEach(function(row){\n\t\t\trow.setCellHeight();\n\t\t});\n\t}\n\t\n\tgetWidth(){\n\t\tvar width = 0;\n\t\t\n\t\tif(this.isGroup){\n\t\t\tthis.columns.forEach(function(column){\n\t\t\t\tif(column.visible){\n\t\t\t\t\twidth += column.getWidth();\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\twidth = this.width;\n\t\t}\n\t\t\n\t\treturn width;\n\t}\n\t\n\tgetLeftOffset(){\n\t\tvar offset = this.element.offsetLeft;\n\t\t\n\t\tif(this.parent.isGroup){\n\t\t\toffset += this.parent.getLeftOffset();\n\t\t}\n\t\t\n\t\treturn offset;\n\t}\n\t\n\tgetHeight(){\n\t\treturn Math.ceil(this.element.getBoundingClientRect().height);\n\t}\n\t\n\tsetMinWidth(minWidth){\n\t\tif(this.maxWidth && minWidth > this.maxWidth){\n\t\t\tminWidth = this.maxWidth;\n\t\t\t\n\t\t\tconsole.warn(\"the minWidth (\"+ minWidth + \"px) for column '\" + this.field + \"' cannot be bigger that its maxWidth (\"+ this.maxWidthStyled + \")\");\n\t\t}\n\t\t\n\t\tthis.minWidth = minWidth;\n\t\tthis.minWidthStyled = minWidth ? minWidth + \"px\" : \"\";\n\t\t\n\t\tthis.element.style.minWidth = this.minWidthStyled;\n\t\t\n\t\tthis.cells.forEach(function(cell){\n\t\t\tcell.setMinWidth();\n\t\t});\n\t}\n\t\n\tsetMaxWidth(maxWidth){\n\t\tif(this.minWidth && maxWidth < this.minWidth){\n\t\t\tmaxWidth = this.minWidth;\n\t\t\t\n\t\t\tconsole.warn(\"the maxWidth (\"+ maxWidth + \"px) for column '\" + this.field + \"' cannot be smaller that its minWidth (\"+ this.minWidthStyled + \")\");\n\t\t}\n\t\t\n\t\tthis.maxWidth = maxWidth;\n\t\tthis.maxWidthStyled = maxWidth ? maxWidth + \"px\" : \"\";\n\t\t\n\t\tthis.element.style.maxWidth = this.maxWidthStyled;\n\t\t\n\t\tthis.cells.forEach(function(cell){\n\t\t\tcell.setMaxWidth();\n\t\t});\n\t}\n\t\n\tdelete(){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(this.isGroup){\n\t\t\t\tthis.columns.forEach(function(column){\n\t\t\t\t\tcolumn.delete();\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"column-delete\", this);\n\t\t\t\n\t\t\tvar cellCount = this.cells.length;\n\t\t\t\n\t\t\tfor(let i = 0; i < cellCount; i++){\n\t\t\t\tthis.cells[0].delete();\n\t\t\t}\n\t\t\t\n\t\t\tif(this.element.parentNode){\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t\t\n\t\t\tthis.element = false;\n\t\t\tthis.contentElement = false;\n\t\t\tthis.titleElement = false;\n\t\t\tthis.groupElement = false;\n\t\t\t\n\t\t\tif(this.parent.isGroup){\n\t\t\t\tthis.parent.removeChild(this);\n\t\t\t}\n\t\t\t\n\t\t\tthis.table.columnManager.deregisterColumn(this);\n\t\t\t\n\t\t\tthis.table.columnManager.rerenderColumns(true);\n\t\t\t\n\t\t\tthis.dispatch(\"column-deleted\", this);\n\t\t\t\n\t\t\tresolve();\n\t\t});\n\t}\n\t\n\tcolumnRendered(){\n\t\tif(this.titleFormatterRendered){\n\t\t\tthis.titleFormatterRendered();\n\t\t}\n\t\t\n\t\tthis.dispatch(\"column-rendered\", this);\n\t}\n\t\n\t//////////////// Cell Management /////////////////\n\t//generate cell for this column\n\tgenerateCell(row){\n\t\tvar cell = new Cell(this, row);\n\t\t\n\t\tthis.cells.push(cell);\n\t\t\n\t\treturn cell;\n\t}\n\t\n\tnextColumn(){\n\t\tvar index = this.table.columnManager.findColumnIndex(this);\n\t\treturn index > -1 ? this._nextVisibleColumn(index + 1) : false;\n\t}\n\t\n\t_nextVisibleColumn(index){\n\t\tvar column = this.table.columnManager.getColumnByIndex(index);\n\t\treturn !column || column.visible ? column : this._nextVisibleColumn(index + 1);\n\t}\n\t\n\tprevColumn(){\n\t\tvar index = this.table.columnManager.findColumnIndex(this);\n\t\treturn index > -1 ? this._prevVisibleColumn(index - 1) : false;\n\t}\n\t\n\t_prevVisibleColumn(index){\n\t\tvar column = this.table.columnManager.getColumnByIndex(index);\n\t\treturn !column || column.visible ? column : this._prevVisibleColumn(index - 1);\n\t}\n\t\n\treinitializeWidth(force){\n\t\tthis.widthFixed = false;\n\t\t\n\t\t//set width if present\n\t\tif(typeof this.definition.width !== \"undefined\" && !force){\n\t\t\t// maxInitialWidth ignored here as width specified\n\t\t\tthis.setWidth(this.definition.width);\n\t\t}\n\t\t\n\t\tthis.dispatch(\"column-width-fit-before\", this);\n\t\t\n\t\tthis.fitToData(force);\n\t\t\n\t\tthis.dispatch(\"column-width-fit-after\", this);\n\t}\n\t\n\t//set column width to maximum cell width for non group columns\n\tfitToData(force){\n\t\tif(this.isGroup){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif(!this.widthFixed){\n\t\t\tthis.element.style.width = \"\";\n\t\t\t\n\t\t\tthis.cells.forEach((cell) => {\n\t\t\t\tcell.clearWidth();\n\t\t\t});\n\t\t}\n\t\t\n\t\tvar maxWidth = this.element.offsetWidth;\n\t\t\n\t\tif(!this.width || !this.widthFixed){\n\t\t\tthis.cells.forEach((cell) => {\n\t\t\t\tvar width = cell.getWidth();\n\t\t\t\t\n\t\t\t\tif(width > maxWidth){\n\t\t\t\t\tmaxWidth = width;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(maxWidth){\n\t\t\t\tvar setTo = maxWidth + 1;\n\t\t\t\t\n\t\t\t\tif(force){\n\t\t\t\t\tthis.setWidth(setTo);\n\t\t\t\t}else {\n\t\t\t\t\tif (this.maxInitialWidth && !force) {\n\t\t\t\t\t\tsetTo = Math.min(setTo, this.maxInitialWidth);\n\t\t\t\t\t}\n\t\t\t\t\tthis.setWidthActual(setTo);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tupdateDefinition(updates){\n\t\tvar definition;\n\t\t\n\t\tif(!this.isGroup){\n\t\t\tif(!this.parent.isGroup){\n\t\t\t\tdefinition = Object.assign({}, this.getDefinition());\n\t\t\t\tdefinition = Object.assign(definition, updates);\n\t\t\t\t\n\t\t\t\treturn this.table.columnManager.addColumn(definition, false, this)\n\t\t\t\t\t.then((column) => {\n\t\t\t\t\t\n\t\t\t\t\t\tif(definition.field == this.field){\n\t\t\t\t\t\t\tthis.field = false; //clear field name to prevent deletion of duplicate column from arrays\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\treturn this.delete()\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconsole.error(\"Column Update Error - The updateDefinition function is only available on ungrouped columns\");\n\t\t\t\treturn Promise.reject(\"Column Update Error - The updateDefinition function is only available on columns, not column groups\");\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.error(\"Column Update Error - The updateDefinition function is only available on ungrouped columns\");\n\t\t\treturn Promise.reject(\"Column Update Error - The updateDefinition function is only available on columns, not column groups\");\n\t\t}\n\t}\n\t\n\tdeleteCell(cell){\n\t\tvar index = this.cells.indexOf(cell);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.cells.splice(index, 1);\n\t\t}\n\t}\n\t\n\t//////////////// Object Generation /////////////////\n\tgetComponent(){\n\t\tif(!this.component){\n\t\t\tthis.component = new ColumnComponent(this);\n\t\t}\n\t\t\n\t\treturn this.component;\n\t}\n\t\n\tgetPosition(){\n\t\treturn this.table.columnManager.getVisibleColumnsByIndex().indexOf(this) + 1;\n\t}\n\t\n\tgetParentComponent(){\n\t\treturn this.parent instanceof Column ? this.parent.getComponent() : false;\n\t}\n}\n\n//public row object\nclass RowComponent {\n\n\tconstructor (row){\n\t\tthis._row = row;\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._row.table.componentFunctionBinder.handle(\"row\", target._row, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetData(transform){\n\t\treturn this._row.getData(transform);\n\t}\n\n\tgetElement(){\n\t\treturn this._row.getElement();\n\t}\n\n\tgetCells(){\n\t\tvar cells = [];\n\n\t\tthis._row.getCells().forEach(function(cell){\n\t\t\tcells.push(cell.getComponent());\n\t\t});\n\n\t\treturn cells;\n\t}\n\n\tgetCell(column){\n\t\tvar cell = this._row.getCell(column);\n\t\treturn cell ? cell.getComponent() : false;\n\t}\n\n\tgetIndex(){\n\t\treturn this._row.getData(\"data\")[this._row.table.options.index];\n\t}\n\n\tgetPosition(){\n\t\treturn this._row.getPosition();\n\t}\n\n\twatchPosition(callback){\n\t\treturn this._row.watchPosition(callback);\n\t}\n\n\tdelete(){\n\t\treturn this._row.delete();\n\t}\n\n\tscrollTo(position, ifVisible){\n\t\treturn this._row.table.rowManager.scrollToRow(this._row, position, ifVisible);\n\t}\n\n\tmove(to, after){\n\t\tthis._row.moveToRow(to, after);\n\t}\n\n\tupdate(data){\n\t\treturn this._row.updateData(data);\n\t}\n\n\tnormalizeHeight(){\n\t\tthis._row.normalizeHeight(true);\n\t}\n\n\t_getSelf(){\n\t\treturn this._row;\n\t}\n\n\treformat(){\n\t\treturn this._row.reinitialize();\n\t}\n\n\tgetTable(){\n\t\treturn this._row.table;\n\t}\n\n\tgetNextRow(){\n\t\tvar row = this._row.nextRow();\n\t\treturn row ? row.getComponent() : row;\n\t}\n\n\tgetPrevRow(){\n\t\tvar row = this._row.prevRow();\n\t\treturn row ? row.getComponent() : row;\n\t}\n}\n\nclass Row extends CoreFeature{\n\tconstructor (data, parent, type = \"row\"){\n\t\tsuper(parent.table);\n\t\t\n\t\tthis.parent = parent;\n\t\tthis.data = {};\n\t\tthis.type = type; //type of element\n\t\tthis.element = false;\n\t\tthis.modules = {}; //hold module variables;\n\t\tthis.cells = [];\n\t\tthis.height = 0; //hold element height\n\t\tthis.heightStyled = \"\"; //hold element height pre-styled to improve render efficiency\n\t\tthis.manualHeight = false; //user has manually set row height\n\t\tthis.outerHeight = 0; //hold elements outer height\n\t\tthis.initialized = false; //element has been rendered\n\t\tthis.heightInitialized = false; //element has resized cells to fit\n\t\tthis.position = 0; //store position of element in row list\n\t\tthis.positionWatchers = [];\n\t\t\n\t\tthis.component = null;\n\t\t\n\t\tthis.created = false;\n\t\t\n\t\tthis.setData(data);\n\t}\n\t\n\tcreate(){\n\t\tif(!this.created){\n\t\t\tthis.created = true;\n\t\t\tthis.generateElement();\n\t\t}\n\t}\n\t\n\tcreateElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-row\");\n\t\tel.setAttribute(\"role\", \"row\");\n\t\t\n\t\tthis.element = el;\n\t}\n\t\n\tgetElement(){\n\t\tthis.create();\n\t\treturn this.element;\n\t}\n\t\n\tdetachElement(){\n\t\tif (this.element && this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n\t}\n\t\n\tgenerateElement(){\n\t\tthis.createElement();\n\t\tthis.dispatch(\"row-init\", this);\n\t}\n\t\n\tgenerateCells(){\n\t\tthis.cells = this.table.columnManager.generateCells(this);\n\t}\n\t\n\t//functions to setup on first render\n\tinitialize(force, inFragment){\n\t\tthis.create();\n\t\t\n\t\tif(!this.initialized || force){\n\t\t\t\n\t\t\tthis.deleteCells();\n\t\t\t\n\t\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\t\t\t\n\t\t\tthis.dispatch(\"row-layout-before\", this);\n\t\t\t\n\t\t\tthis.generateCells();\n\t\t\t\n\t\t\tthis.initialized = true;\n\t\t\t\n\t\t\tthis.table.columnManager.renderer.renderRowCells(this, inFragment);\n\t\t\t\n\t\t\tif(force){\n\t\t\t\tthis.normalizeHeight();\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-layout\", this);\n\t\t\t\n\t\t\tif(this.table.options.rowFormatter){\n\t\t\t\tthis.table.options.rowFormatter(this.getComponent());\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-layout-after\", this);\n\t\t}else {\n\t\t\tthis.table.columnManager.renderer.rerenderRowCells(this, inFragment);\n\t\t}\n\t}\n\n\trendered(){\n\t\tthis.cells.forEach((cell) => {\n\t\t\tcell.cellRendered();\n\t\t});\n\t}\n\t\n\treinitializeHeight(){\n\t\tthis.heightInitialized = false;\n\t\t\n\t\tif(this.element && this.element.offsetParent !== null){\n\t\t\tthis.normalizeHeight(true);\n\t\t}\n\t}\n\n\tdeinitialize(){\n\t\tthis.initialized = false;\n\t}\n\t\n\tdeinitializeHeight(){\n\t\tthis.heightInitialized = false;\n\t}\n\t\n\treinitialize(children){\n\t\tthis.initialized = false;\n\t\tthis.heightInitialized = false;\n\t\t\n\t\tif(!this.manualHeight){\n\t\t\tthis.height = 0;\n\t\t\tthis.heightStyled = \"\";\n\t\t}\n\t\t\n\t\tif(this.element && this.element.offsetParent !== null){\n\t\t\tthis.initialize(true);\n\t\t}\n\t\t\n\t\tthis.dispatch(\"row-relayout\", this);\n\t}\n\t\n\t//get heights when doing bulk row style calcs in virtual DOM\n\tcalcHeight(force){\n\t\tvar maxHeight = 0, minHeight  = 0;\n\n\t\tif(this.table.options.rowHeight){\n\t\t\tthis.height = this.table.options.rowHeight;\n\t\t}else {\n\t\t\tminHeight = this.calcMinHeight();\n\t\t\tmaxHeight = this.calcMaxHeight();\n\t\t\t\n\t\t\tif(force){\n\t\t\t\tthis.height = Math.max(maxHeight, minHeight);\n\t\t\t}else {\n\t\t\t\tthis.height = this.manualHeight ? this.height : Math.max(maxHeight, minHeight);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.heightStyled = this.height ? this.height + \"px\" : \"\";\n\t\tthis.outerHeight = this.element.offsetHeight;\n\t}\n\n\tcalcMinHeight(){\n\t\treturn this.table.options.resizableRows ? this.element.clientHeight : 0;\n\t}\n\n\tcalcMaxHeight(){\n\t\tvar maxHeight = 0;\n\n\t\tthis.cells.forEach(function(cell){\n\t\t\tvar height = cell.getHeight();\n\n\t\t\tif(height > maxHeight){\n\t\t\t\tmaxHeight = height;\n\t\t\t}\n\t\t});\n\n\t\treturn maxHeight;\n\t}\n\t\n\t//set of cells\n\tsetCellHeight(){\n\t\tthis.cells.forEach(function(cell){\n\t\t\tcell.setHeight();\n\t\t});\n\t\t\n\t\tthis.heightInitialized = true;\n\t}\n\t\n\tclearCellHeight(){\n\t\tthis.cells.forEach(function(cell){\n\t\t\tcell.clearHeight();\n\t\t});\n\t}\n\t\n\t//normalize the height of elements in the row\n\tnormalizeHeight(force){\n\t\tif(force && !this.table.options.rowHeight){\n\t\t\tthis.clearCellHeight();\n\t\t}\n\t\t\n\t\tthis.calcHeight(force);\n\t\t\n\t\tthis.setCellHeight();\n\t}\n\t\n\t//set height of rows\n\tsetHeight(height, force){\n\t\tif(this.height != height || force){\n\t\t\t\n\t\t\tthis.manualHeight = true;\n\t\t\t\n\t\t\tthis.height = height;\n\t\t\tthis.heightStyled = height ? height + \"px\" : \"\";\n\t\t\t\n\t\t\tthis.setCellHeight();\n\t\t\t\n\t\t\t// this.outerHeight = this.element.outerHeight();\n\t\t\tthis.outerHeight = this.element.offsetHeight;\n\n\t\t\tif(this.subscribedExternal(\"rowHeight\")){\n\t\t\t\tthis.dispatchExternal(\"rowHeight\", this.getComponent());\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//return rows outer height\n\tgetHeight(){\n\t\treturn this.outerHeight;\n\t}\n\t\n\t//return rows outer Width\n\tgetWidth(){\n\t\treturn this.element.offsetWidth;\n\t}\n\t\n\t//////////////// Cell Management /////////////////\n\tdeleteCell(cell){\n\t\tvar index = this.cells.indexOf(cell);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.cells.splice(index, 1);\n\t\t}\n\t}\n\t\n\t//////////////// Data Management /////////////////\n\tsetData(data){\n\t\tthis.data = this.chain(\"row-data-init-before\", [this, data], undefined, data);\n\t\t\n\t\tthis.dispatch(\"row-data-init-after\", this);\n\t}\n\t\n\t//update the rows data\n\tupdateData(updatedData){\n\t\tvar visible = this.element && Helpers.elVisible(this.element),\n\t\ttempData = {},\n\t\tnewRowData;\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t\n\t\t\tif(typeof updatedData === \"string\"){\n\t\t\t\tupdatedData = JSON.parse(updatedData);\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-data-save-before\", this);\n\t\t\t\n\t\t\tif(this.subscribed(\"row-data-changing\")){\n\t\t\t\ttempData = Object.assign(tempData, this.data);\n\t\t\t\ttempData = Object.assign(tempData, updatedData);\n\t\t\t}\n\t\t\t\n\t\t\tnewRowData = this.chain(\"row-data-changing\", [this, tempData, updatedData], null, updatedData);\n\t\t\t\n\t\t\t//set data\n\t\t\tfor (let attrname in newRowData) {\n\t\t\t\tthis.data[attrname] = newRowData[attrname];\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-data-save-after\", this);\n\t\t\t\n\t\t\t//update affected cells only\n\t\t\tfor (let attrname in updatedData) {\n\t\t\t\t\n\t\t\t\tlet columns = this.table.columnManager.getColumnsByFieldRoot(attrname);\n\t\t\t\t\n\t\t\t\tcolumns.forEach((column) => {\n\t\t\t\t\tlet cell = this.getCell(column.getField());\n\t\t\t\t\t\n\t\t\t\t\tif(cell){\n\t\t\t\t\t\tlet value = column.getFieldValue(newRowData);\n\t\t\t\t\t\tif(cell.getValue() !== value){\n\t\t\t\t\t\t\tcell.setValueProcessData(value);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(visible){\n\t\t\t\t\t\t\t\tcell.cellRendered();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t//Partial reinitialization if visible\n\t\t\tif(visible){\n\t\t\t\tthis.normalizeHeight(true);\n\t\t\t\t\n\t\t\t\tif(this.table.options.rowFormatter){\n\t\t\t\t\tthis.table.options.rowFormatter(this.getComponent());\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.initialized = false;\n\t\t\t\tthis.height = 0;\n\t\t\t\tthis.heightStyled = \"\";\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"row-data-changed\", this, visible, updatedData);\n\t\t\t\n\t\t\t//this.reinitialize();\n\t\t\t\n\t\t\tthis.dispatchExternal(\"rowUpdated\", this.getComponent());\n\t\t\t\n\t\t\tif(this.subscribedExternal(\"dataChanged\")){\n\t\t\t\tthis.dispatchExternal(\"dataChanged\", this.table.rowManager.getData());\n\t\t\t}\n\t\t\t\n\t\t\tresolve();\n\t\t});\n\t}\n\t\n\tgetData(transform){\n\t\tif(transform){\n\t\t\treturn this.chain(\"row-data-retrieve\", [this, transform], null, this.data);\n\t\t}\n\t\t\n\t\treturn this.data;\n\t}\n\t\n\tgetCell(column){\n\t\tvar match = false;\n\t\t\n\t\tcolumn = this.table.columnManager.findColumn(column);\n\t\t\n\t\tif(!this.initialized && this.cells.length === 0){\n\t\t\tthis.generateCells();\n\t\t}\n\t\t\n\t\tmatch = this.cells.find(function(cell){\n\t\t\treturn cell.column === column;\n\t\t});\n\t\t\n\t\treturn match;\n\t}\n\t\n\tgetCellIndex(findCell){\n\t\treturn this.cells.findIndex(function(cell){\n\t\t\treturn cell === findCell;\n\t\t});\n\t}\n\t\n\tfindCell(subject){\n\t\treturn this.cells.find((cell) => {\n\t\t\treturn cell.element === subject;\n\t\t});\n\t}\n\t\n\tgetCells(){\n\t\tif(!this.initialized && this.cells.length === 0){\n\t\t\tthis.generateCells();\n\t\t}\n\t\t\n\t\treturn this.cells;\n\t}\n\t\n\tnextRow(){\n\t\tvar row = this.table.rowManager.nextDisplayRow(this, true);\n\t\treturn row || false;\n\t}\n\t\n\tprevRow(){\n\t\tvar row = this.table.rowManager.prevDisplayRow(this, true);\n\t\treturn row || false;\n\t}\n\t\n\tmoveToRow(to, before){\n\t\tvar toRow = this.table.rowManager.findRow(to);\n\t\t\n\t\tif(toRow){\n\t\t\tthis.table.rowManager.moveRowActual(this, toRow, !before);\n\t\t\tthis.table.rowManager.refreshActiveData(\"display\", false, true);\n\t\t}else {\n\t\t\tconsole.warn(\"Move Error - No matching row found:\", to);\n\t\t}\n\t}\n\t\n\t///////////////////// Actions  /////////////////////\n\tdelete(){\n\t\tthis.dispatch(\"row-delete\", this);\n\t\t\n\t\tthis.deleteActual();\n\t\t\n\t\treturn Promise.resolve();\n\t}\n\t\n\tdeleteActual(blockRedraw){\n\t\tthis.detachModules();\n\t\t\n\t\tthis.table.rowManager.deleteRow(this, blockRedraw);\n\t\t\n\t\tthis.deleteCells();\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.heightInitialized = false;\n\t\tthis.element = false;\n\t\t\n\t\tthis.dispatch(\"row-deleted\", this);\n\t}\n\t\n\tdetachModules(){\n\t\tthis.dispatch(\"row-deleting\", this);\n\t}\n\t\n\tdeleteCells(){\n\t\tvar cellCount = this.cells.length;\n\t\t\n\t\tfor(let i = 0; i < cellCount; i++){\n\t\t\tthis.cells[0].delete();\n\t\t}\n\t}\n\t\n\twipe(){\n\t\tthis.detachModules();\n\t\tthis.deleteCells();\n\t\t\n\t\tif(this.element){\n\t\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\t\t\t\n\t\t\tif(this.element.parentNode){\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.element = false;\n\t\tthis.modules = {};\n\t}\n\n\tisDisplayed(){\n\t\treturn this.table.rowManager.getDisplayRows().includes(this);\n\t}\n\n\tgetPosition(){\n\t\treturn this.isDisplayed() ? this.position : false;\n\t}\n\n\tsetPosition(position){\n\t\tif(position != this.position){\n\t\t\tthis.position = position;\n\n\t\t\tthis.positionWatchers.forEach((callback) => {\n\t\t\t\tcallback(this.position);\n\t\t\t});\n\t\t}\n\t}\n\n\twatchPosition(callback){\n\t\tthis.positionWatchers.push(callback);\n\n\t\tcallback(this.position);\n\t}\n\t\n\tgetGroup(){\n\t\treturn this.modules.group || false;\n\t}\n\t\n\t//////////////// Object Generation /////////////////\n\tgetComponent(){\n\t\tif(!this.component){\n\t\t\tthis.component = new RowComponent(this);\n\t\t}\n\t\t\n\t\treturn this.component;\n\t}\n}\n\nvar defaultCalculations = {\n\t\"avg\":function(values, data, calcParams){\n\t\tvar output = 0,\n\t\tprecision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : 2;\n\n\t\tif(values.length){\n\t\t\toutput = values.reduce(function(sum, value){\n\t\t\t\treturn Number(sum) + Number(value);\n\t\t\t});\n\n\t\t\toutput = output / values.length;\n\n\t\t\toutput = precision !== false ? output.toFixed(precision) : output;\n\t\t}\n\n\t\treturn parseFloat(output).toString();\n\t},\n\t\"max\":function(values, data, calcParams){\n\t\tvar output = null,\n\t\tprecision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tvalues.forEach(function(value){\n\n\t\t\tvalue = Number(value);\n\n\t\t\tif(value > output || output === null){\n\t\t\t\toutput = value;\n\t\t\t}\n\t\t});\n\n\t\treturn output !== null ? (precision !== false ? output.toFixed(precision) : output) : \"\";\n\t},\n\t\"min\":function(values, data, calcParams){\n\t\tvar output = null,\n\t\tprecision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tvalues.forEach(function(value){\n\n\t\t\tvalue = Number(value);\n\n\t\t\tif(value < output || output === null){\n\t\t\t\toutput = value;\n\t\t\t}\n\t\t});\n\n\t\treturn output !== null ? (precision !== false ? output.toFixed(precision) : output) : \"\";\n\t},\n\t\"sum\":function(values, data, calcParams){\n\t\tvar output = 0,\n\t\tprecision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tif(values.length){\n\t\t\tvalues.forEach(function(value){\n\t\t\t\tvalue = Number(value);\n\n\t\t\t\toutput += !isNaN(value) ? Number(value) : 0;\n\t\t\t});\n\t\t}\n\n\t\treturn precision !== false ? output.toFixed(precision) : output;\n\t},\n\t\"concat\":function(values, data, calcParams){\n\t\tvar output = 0;\n\n\t\tif(values.length){\n\t\t\toutput = values.reduce(function(sum, value){\n\t\t\t\treturn String(sum) + String(value);\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t},\n\t\"count\":function(values, data, calcParams){\n\t\tvar output = 0;\n\n\t\tif(values.length){\n\t\t\tvalues.forEach(function(value){\n\t\t\t\tif(value){\n\t\t\t\t\toutput ++;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t},\n\t\"unique\":function(values, data, calcParams){\n\t\tvar unique = values.filter((value, index) => {\n\t\t\treturn (values || value === 0) && values.indexOf(value) === index;\n\t\t});\n\n\t\treturn unique.length;\n\t},\n};\n\nclass ColumnCalcs extends Module{\n\n\tstatic moduleName = \"columnCalcs\";\n\n\t//load defaults\n\tstatic calculations = defaultCalculations;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.topCalcs = [];\n\t\tthis.botCalcs = [];\n\t\tthis.genColumn = false;\n\t\tthis.topElement = this.createElement();\n\t\tthis.botElement = this.createElement();\n\t\tthis.topRow = false;\n\t\tthis.botRow = false;\n\t\tthis.topInitialized = false;\n\t\tthis.botInitialized = false;\n\t\t\n\t\tthis.blocked = false;\n\t\tthis.recalcAfterBlock = false;\n\t\t\n\t\tthis.registerTableOption(\"columnCalcs\", true);\n\t\t\n\t\tthis.registerColumnOption(\"topCalc\");\n\t\tthis.registerColumnOption(\"topCalcParams\");\n\t\tthis.registerColumnOption(\"topCalcFormatter\");\n\t\tthis.registerColumnOption(\"topCalcFormatterParams\");\n\t\tthis.registerColumnOption(\"bottomCalc\");\n\t\tthis.registerColumnOption(\"bottomCalcParams\");\n\t\tthis.registerColumnOption(\"bottomCalcFormatter\");\n\t\tthis.registerColumnOption(\"bottomCalcFormatterParams\");\n\t}\n\t\n\tcreateElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-calcs-holder\");\n\t\treturn el;\n\t}\n\t\n\tinitialize(){\n\t\tthis.genColumn = new Column({field:\"value\"}, this);\n\t\t\n\t\tthis.subscribe(\"cell-value-changed\", this.cellValueChanged.bind(this));\n\t\tthis.subscribe(\"column-init\", this.initializeColumnCheck.bind(this));\n\t\tthis.subscribe(\"row-deleted\", this.rowsUpdated.bind(this));\n\t\tthis.subscribe(\"scroll-horizontal\", this.scrollHorizontal.bind(this));\n\t\tthis.subscribe(\"row-added\", this.rowsUpdated.bind(this));\n\t\tthis.subscribe(\"column-moved\", this.recalcActiveRows.bind(this));\n\t\tthis.subscribe(\"column-add\", this.recalcActiveRows.bind(this));\n\t\tthis.subscribe(\"data-refreshed\", this.recalcActiveRowsRefresh.bind(this));\n\t\tthis.subscribe(\"table-redraw\", this.tableRedraw.bind(this));\n\t\tthis.subscribe(\"rows-visible\", this.visibleRows.bind(this));\n\t\tthis.subscribe(\"scrollbar-vertical\", this.adjustForScrollbar.bind(this));\n\t\t\n\t\tthis.subscribe(\"redraw-blocked\", this.blockRedraw.bind(this));\n\t\tthis.subscribe(\"redraw-restored\", this.restoreRedraw.bind(this));\n\n\t\tthis.subscribe(\"table-redrawing\", this.resizeHolderWidth.bind(this));\n\t\tthis.subscribe(\"column-resized\", this.resizeHolderWidth.bind(this));\n\t\tthis.subscribe(\"column-show\", this.resizeHolderWidth.bind(this));\n\t\tthis.subscribe(\"column-hide\", this.resizeHolderWidth.bind(this));\n\t\t\n\t\tthis.registerTableFunction(\"getCalcResults\", this.getResults.bind(this));\n\t\tthis.registerTableFunction(\"recalc\", this.userRecalc.bind(this));\n\n\n\t\tthis.resizeHolderWidth();\n\t}\n\n\tresizeHolderWidth(){\n\t\tthis.topElement.style.minWidth = this.table.columnManager.headersElement.offsetWidth + \"px\";\n\t}\n\n\t\n\ttableRedraw(force){\n\t\tthis.recalc(this.table.rowManager.activeRows);\n\t\t\n\t\tif(force){\n\t\t\tthis.redraw();\n\t\t}\n\t}\n\t\n\tblockRedraw(){\n\t\tthis.blocked = true;\n\t\tthis.recalcAfterBlock = false;\n\t}\n\t\n\t\n\trestoreRedraw(){\n\t\tthis.blocked = false;\n\t\t\n\t\tif(this.recalcAfterBlock){\n\t\t\tthis.recalcAfterBlock = false;\n\t\t\tthis.recalcActiveRowsRefresh();\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\tuserRecalc(){\n\t\tthis.recalc(this.table.rowManager.activeRows);\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tblockCheck(){\n\t\tif(this.blocked){\n\t\t\tthis.recalcAfterBlock = true;\n\t\t}\n\t\t\n\t\treturn this.blocked;\n\t}\n\t\n\tvisibleRows(viewable, rows){\n\t\tif(this.topRow){\n\t\t\trows.unshift(this.topRow);\n\t\t}\n\t\t\n\t\tif(this.botRow){\n\t\t\trows.push(this.botRow);\n\t\t}\n\t\t\n\t\treturn rows;\n\t}\n\t\n\trowsUpdated(row){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.recalcRowGroup(row);\n\t\t}else {\n\t\t\tthis.recalcActiveRows();\n\t\t}\n\t}\n\t\n\trecalcActiveRowsRefresh(){\n\t\tif(this.table.options.groupBy && this.table.options.dataTreeStartExpanded && this.table.options.dataTree){\n\t\t\tthis.recalcAll();\n\t\t}else {\n\t\t\tthis.recalcActiveRows();\n\t\t}\n\t}\n\t\n\trecalcActiveRows(){\n\t\tthis.recalc(this.table.rowManager.activeRows);\n\t}\n\t\n\tcellValueChanged(cell){\n\t\tif(cell.column.definition.topCalc || cell.column.definition.bottomCalc){\n\t\t\tif(this.table.options.groupBy){\n\t\t\t\tif(this.table.options.columnCalcs == \"table\" || this.table.options.columnCalcs == \"both\"){\n\t\t\t\t\tthis.recalcActiveRows();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.table.options.columnCalcs != \"table\"){\n\t\t\t\t\tthis.recalcRowGroup(cell.row);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.recalcActiveRows();\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinitializeColumnCheck(column){\n\t\tif(column.definition.topCalc || column.definition.bottomCalc){\n\t\t\tthis.initializeColumn(column);\n\t\t}\n\t}\n\t\n\t//initialize column calcs\n\tinitializeColumn(column){\n\t\tvar def = column.definition;\n\t\t\n\t\tvar config = {\n\t\t\ttopCalcParams:def.topCalcParams || {},\n\t\t\tbotCalcParams:def.bottomCalcParams || {},\n\t\t};\n\t\t\n\t\tif(def.topCalc){\n\t\t\t\n\t\t\tswitch(typeof def.topCalc){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tif(ColumnCalcs.calculations[def.topCalc]){\n\t\t\t\t\t\tconfig.topCalc = ColumnCalcs.calculations[def.topCalc];\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Column Calc Error - No such calculation found, ignoring: \", def.topCalc);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"function\":\n\t\t\t\t\tconfig.topCalc = def.topCalc;\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif(config.topCalc){\n\t\t\t\tcolumn.modules.columnCalcs = config;\n\t\t\t\tthis.topCalcs.push(column);\n\t\t\t\t\n\t\t\t\tif(this.table.options.columnCalcs != \"group\"){\n\t\t\t\t\tthis.initializeTopRow();\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tif(def.bottomCalc){\n\t\t\tswitch(typeof def.bottomCalc){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tif(ColumnCalcs.calculations[def.bottomCalc]){\n\t\t\t\t\t\tconfig.botCalc = ColumnCalcs.calculations[def.bottomCalc];\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Column Calc Error - No such calculation found, ignoring: \", def.bottomCalc);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"function\":\n\t\t\t\t\tconfig.botCalc = def.bottomCalc;\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif(config.botCalc){\n\t\t\t\tcolumn.modules.columnCalcs = config;\n\t\t\t\tthis.botCalcs.push(column);\n\t\t\t\t\n\t\t\t\tif(this.table.options.columnCalcs != \"group\"){\n\t\t\t\t\tthis.initializeBottomRow();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\t\n\t//dummy functions to handle being mock column manager\n\tregisterColumnField(){}\n\t\n\tremoveCalcs(){\n\t\tvar changed = false;\n\t\t\n\t\tif(this.topInitialized){\n\t\t\tthis.topInitialized = false;\n\t\t\tthis.topElement.parentNode.removeChild(this.topElement);\n\t\t\tchanged = true;\n\t\t}\n\t\t\n\t\tif(this.botInitialized){\n\t\t\tthis.botInitialized = false;\n\t\t\tthis.footerRemove(this.botElement);\n\t\t\tchanged = true;\n\t\t}\n\t\t\n\t\tif(changed){\n\t\t\tthis.table.rowManager.adjustTableSize();\n\t\t}\n\t}\n\t\n\treinitializeCalcs(){\n\t\tif(this.topCalcs.length){\n\t\t\tthis.initializeTopRow();\n\t\t}\n\n\t\tif(this.botCalcs.length){\n\t\t\tthis.initializeBottomRow();\n\t\t}\n\t}\n\t\n\tinitializeTopRow(){\n\t\tvar\tfragment = document.createDocumentFragment();\n\t\t\n\t\tif(!this.topInitialized){\n\n\t\t\tfragment.appendChild(document.createElement(\"br\"));\n\t\t\tfragment.appendChild(this.topElement);\n\n\t\t\tthis.table.columnManager.getContentsElement().insertBefore(fragment, this.table.columnManager.headersElement.nextSibling);\n\t\t\tthis.topInitialized = true;\n\t\t}\n\t}\n\t\n\tinitializeBottomRow(){\n\t\tif(!this.botInitialized){\n\t\t\tthis.footerPrepend(this.botElement);\n\t\t\tthis.botInitialized = true;\n\t\t}\n\t}\n\t\n\tscrollHorizontal(left){\n\t\tif(this.botInitialized && this.botRow){\n\t\t\tthis.botElement.scrollLeft = left;\n\t\t}\n\t}\n\t\n\trecalc(rows){\n\t\tvar data, row;\n\t\t\n\t\tif(!this.blockCheck()){\n\t\t\tif(this.topInitialized || this.botInitialized){\n\t\t\t\tdata = this.rowsToData(rows);\n\t\t\t\t\n\t\t\t\tif(this.topInitialized){\n\t\t\t\t\tif(this.topRow){\n\t\t\t\t\t\tthis.topRow.deleteCells();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\trow = this.generateRow(\"top\", data);\n\t\t\t\t\tthis.topRow = row;\n\t\t\t\t\twhile(this.topElement.firstChild) this.topElement.removeChild(this.topElement.firstChild);\n\t\t\t\t\tthis.topElement.appendChild(row.getElement());\n\t\t\t\t\trow.initialize(true);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.botInitialized){\n\t\t\t\t\tif(this.botRow){\n\t\t\t\t\t\tthis.botRow.deleteCells();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\trow = this.generateRow(\"bottom\", data);\n\t\t\t\t\tthis.botRow = row;\n\t\t\t\t\twhile(this.botElement.firstChild) this.botElement.removeChild(this.botElement.firstChild);\n\t\t\t\t\tthis.botElement.appendChild(row.getElement());\n\t\t\t\t\trow.initialize(true);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.table.rowManager.adjustTableSize();\n\t\t\t\t\n\t\t\t\t//set resizable handles\n\t\t\t\tif(this.table.modExists(\"frozenColumns\")){\n\t\t\t\t\tthis.table.modules.frozenColumns.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\trecalcRowGroup(row){\n\t\tthis.recalcGroup(this.table.modules.groupRows.getRowGroup(row));\n\t}\n\t\n\trecalcAll(){\n\t\tif(this.topCalcs.length || this.botCalcs.length){\n\t\t\tif(this.table.options.columnCalcs !== \"group\"){\n\t\t\t\tthis.recalcActiveRows();\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.options.groupBy && this.table.options.columnCalcs !== \"table\"){\n\t\t\t\t\n\t\t\t\tvar groups = this.table.modules.groupRows.getChildGroups();\n\t\t\t\t\n\t\t\t\tgroups.forEach((group) => {\n\t\t\t\t\tthis.recalcGroup(group);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\t\n\trecalcGroup(group){\n\t\tvar data, rowData;\n\t\t\n\t\tif(!this.blockCheck()){\n\t\t\tif(group){\n\t\t\t\tif(group.calcs){\n\t\t\t\t\tif(group.calcs.bottom){\n\t\t\t\t\t\tdata = this.rowsToData(group.rows);\n\t\t\t\t\t\trowData = this.generateRowData(\"bottom\", data);\n\t\t\t\t\t\t\n\t\t\t\t\t\tgroup.calcs.bottom.updateData(rowData);\n\t\t\t\t\t\tgroup.calcs.bottom.reinitialize();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(group.calcs.top){\n\t\t\t\t\t\tdata = this.rowsToData(group.rows);\n\t\t\t\t\t\trowData = this.generateRowData(\"top\", data);\n\t\t\t\t\t\t\n\t\t\t\t\t\tgroup.calcs.top.updateData(rowData);\n\t\t\t\t\t\tgroup.calcs.top.reinitialize();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//generate top stats row\n\tgenerateTopRow(rows){\n\t\treturn this.generateRow(\"top\", this.rowsToData(rows));\n\t}\n\t//generate bottom stats row\n\tgenerateBottomRow(rows){\n\t\treturn this.generateRow(\"bottom\", this.rowsToData(rows));\n\t}\n\t\n\trowsToData(rows){\n\t\tvar data = [],\n\t\thasDataTreeColumnCalcs = this.table.options.dataTree && this.table.options.dataTreeChildColumnCalcs,\n\t\tdataTree = this.table.modules.dataTree;\n\n\t\trows.forEach((row) => {\n\t\t\tdata.push(row.getData());\n\n\t\t\tif(hasDataTreeColumnCalcs && row.modules.dataTree?.open){\n\t\t\t\tthis.rowsToData(dataTree.getFilteredTreeChildren(row)).forEach(dataRow =>{\n\t\t\t\t\tdata.push(row);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn data;\n\t}\n\t\n\t//generate stats row\n\tgenerateRow(pos, data){\n\t\tvar rowData = this.generateRowData(pos, data),\n\t\trow;\n\t\t\n\t\tif(this.table.modExists(\"mutator\")){\n\t\t\tthis.table.modules.mutator.disable();\n\t\t}\n\t\t\n\t\trow = new Row(rowData, this, \"calc\");\n\t\t\n\t\tif(this.table.modExists(\"mutator\")){\n\t\t\tthis.table.modules.mutator.enable();\n\t\t}\n\t\t\n\t\trow.getElement().classList.add(\"tabulator-calcs\", \"tabulator-calcs-\" + pos);\n\t\t\n\t\trow.component = false;\n\t\t\n\t\trow.getComponent = () => {\n\t\t\tif(!row.component){\n\t\t\t\trow.component = new CalcComponent(row);\n\t\t\t}\n\t\t\t\n\t\t\treturn row.component;\n\t\t};\n\t\t\n\t\trow.generateCells = () => {\n\t\t\t\n\t\t\tvar cells = [];\n\t\t\t\n\t\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\t\t\n\t\t\t\t//set field name of mock column\n\t\t\t\tthis.genColumn.setField(column.getField());\n\t\t\t\tthis.genColumn.hozAlign = column.hozAlign;\n\t\t\t\t\n\t\t\t\tif(column.definition[pos + \"CalcFormatter\"] && this.table.modExists(\"format\")){\n\t\t\t\t\tthis.genColumn.modules.format = {\n\t\t\t\t\t\tformatter: this.table.modules.format.lookupFormatter(column.definition[pos + \"CalcFormatter\"]),\n\t\t\t\t\t\tparams: column.definition[pos + \"CalcFormatterParams\"] || {},\n\t\t\t\t\t};\n\t\t\t\t}else {\n\t\t\t\t\tthis.genColumn.modules.format = {\n\t\t\t\t\t\tformatter: this.table.modules.format.lookupFormatter(\"plaintext\"),\n\t\t\t\t\t\tparams:{}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//ensure css class definition is replicated to calculation cell\n\t\t\t\tthis.genColumn.definition.cssClass = column.definition.cssClass;\n\t\t\t\t\n\t\t\t\t//generate cell and assign to correct column\n\t\t\t\tvar cell = new Cell(this.genColumn, row);\n\t\t\t\tcell.getElement();\n\t\t\t\tcell.column = column;\n\t\t\t\tcell.setWidth();\n\t\t\t\t\n\t\t\t\tcolumn.cells.push(cell);\n\t\t\t\tcells.push(cell);\n\t\t\t\t\n\t\t\t\tif(!column.visible){\n\t\t\t\t\tcell.hide();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\trow.cells = cells;\n\t\t};\n\t\t\n\t\treturn row;\n\t}\n\t\n\t//generate stats row\n\tgenerateRowData(pos, data){\n\t\tvar rowData = {},\n\t\tcalcs = pos == \"top\" ? this.topCalcs : this.botCalcs,\n\t\ttype = pos == \"top\" ? \"topCalc\" : \"botCalc\",\n\t\tparams, paramKey;\n\t\t\n\t\tcalcs.forEach(function(column){\n\t\t\tvar values = [];\n\t\t\t\n\t\t\tif(column.modules.columnCalcs && column.modules.columnCalcs[type]){\n\t\t\t\tdata.forEach(function(item){\n\t\t\t\t\tvalues.push(column.getFieldValue(item));\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tparamKey = type + \"Params\";\n\t\t\t\tparams = typeof column.modules.columnCalcs[paramKey] === \"function\" ? column.modules.columnCalcs[paramKey](values, data) : column.modules.columnCalcs[paramKey];\n\t\t\t\t\n\t\t\t\tcolumn.setFieldValue(rowData, column.modules.columnCalcs[type](values, data, params));\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn rowData;\n\t}\n\t\n\thasTopCalcs(){\n\t\treturn\t!!(this.topCalcs.length);\n\t}\n\t\n\thasBottomCalcs(){\n\t\treturn\t!!(this.botCalcs.length);\n\t}\n\t\n\t//handle table redraw\n\tredraw(){\n\t\tif(this.topRow){\n\t\t\tthis.topRow.normalizeHeight(true);\n\t\t}\n\t\tif(this.botRow){\n\t\t\tthis.botRow.normalizeHeight(true);\n\t\t}\n\t}\n\t\n\t//return the calculated\n\tgetResults(){\n\t\tvar results = {},\n\t\tgroups;\n\t\t\n\t\tif(this.table.options.groupBy && this.table.modExists(\"groupRows\")){\n\t\t\tgroups = this.table.modules.groupRows.getGroups(true);\n\t\t\t\n\t\t\tgroups.forEach((group) => {\n\t\t\t\tresults[group.getKey()] = this.getGroupResults(group);\n\t\t\t});\n\t\t}else {\n\t\t\tresults = {\n\t\t\t\ttop: this.topRow ? this.topRow.getData() : {},\n\t\t\t\tbottom: this.botRow ? this.botRow.getData() : {},\n\t\t\t};\n\t\t}\n\t\t\n\t\treturn results;\n\t}\n\t\n\t//get results from a group\n\tgetGroupResults(group){\n\t\tvar groupObj = group._getSelf(),\n\t\tsubGroups = group.getSubGroups(),\n\t\tsubGroupResults = {},\n\t\tresults = {};\n\t\t\n\t\tsubGroups.forEach((subgroup) => {\n\t\t\tsubGroupResults[subgroup.getKey()] = this.getGroupResults(subgroup);\n\t\t});\n\t\t\n\t\tresults = {\n\t\t\ttop: groupObj.calcs.top ? groupObj.calcs.top.getData() : {},\n\t\t\tbottom: groupObj.calcs.bottom ? groupObj.calcs.bottom.getData() : {},\n\t\t\tgroups: subGroupResults,\n\t\t};\n\t\t\n\t\treturn results;\n\t}\n\t\n\tadjustForScrollbar(width){\n\t\tif(this.botRow){\n\t\t\tif(this.table.rtl){\n\t\t\t\tthis.botElement.style.paddingLeft = width + \"px\";\n\t\t\t}else {\n\t\t\t\tthis.botElement.style.paddingRight = width + \"px\";\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass DataTree extends Module{\n\n\tstatic moduleName = \"dataTree\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.indent = 10;\n\t\tthis.field = \"\";\n\t\tthis.collapseEl = null;\n\t\tthis.expandEl = null;\n\t\tthis.branchEl = null;\n\t\tthis.elementField = false;\n\n\t\tthis.startOpen = function(){};\n\n\t\tthis.registerTableOption(\"dataTree\", false); //enable data tree\n\t\tthis.registerTableOption(\"dataTreeFilter\", true); //filter child rows\n\t\tthis.registerTableOption(\"dataTreeSort\", true); //sort child rows\n\t\tthis.registerTableOption(\"dataTreeElementColumn\", false);\n\t\tthis.registerTableOption(\"dataTreeBranchElement\", true);//show data tree branch element\n\t\tthis.registerTableOption(\"dataTreeChildIndent\", 9); //data tree child indent in px\n\t\tthis.registerTableOption(\"dataTreeChildField\", \"_children\");//data tre column field to look for child rows\n\t\tthis.registerTableOption(\"dataTreeCollapseElement\", false);//data tree row collapse element\n\t\tthis.registerTableOption(\"dataTreeExpandElement\", false);//data tree row expand element\n\t\tthis.registerTableOption(\"dataTreeStartExpanded\", false);\n\t\tthis.registerTableOption(\"dataTreeChildColumnCalcs\", false);//include visible data tree rows in column calculations\n\t\tthis.registerTableOption(\"dataTreeSelectPropagate\", false);//selecting a parent row selects its children\n\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"treeCollapse\", this.collapseRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"treeExpand\", this.expandRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"treeToggle\", this.toggleRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"getTreeParent\", this.getTreeParent.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"getTreeChildren\", this.getRowChildren.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"addTreeChild\", this.addTreeChildRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"isTreeExpanded\", this.isRowExpanded.bind(this));\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.dataTree){\n\t\t\tvar dummyEl = null,\n\t\t\toptions = this.table.options;\n\n\t\t\tthis.field = options.dataTreeChildField;\n\t\t\tthis.indent = options.dataTreeChildIndent;\n\n\t\t\tif(this.options(\"movableRows\")){\n\t\t\t\tconsole.warn(\"The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior\");\n\t\t\t}\n\n\t\t\tif(options.dataTreeBranchElement){\n\n\t\t\t\tif(options.dataTreeBranchElement === true){\n\t\t\t\t\tthis.branchEl = document.createElement(\"div\");\n\t\t\t\t\tthis.branchEl.classList.add(\"tabulator-data-tree-branch\");\n\t\t\t\t}else {\n\t\t\t\t\tif(typeof options.dataTreeBranchElement === \"string\"){\n\t\t\t\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\t\t\t\tdummyEl.innerHTML = options.dataTreeBranchElement;\n\t\t\t\t\t\tthis.branchEl = dummyEl.firstChild;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.branchEl = options.dataTreeBranchElement;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.branchEl = document.createElement(\"div\");\n\t\t\t\tthis.branchEl.classList.add(\"tabulator-data-tree-branch-empty\");\n\t\t\t}\n\n\t\t\tif(options.dataTreeCollapseElement){\n\t\t\t\tif(typeof options.dataTreeCollapseElement === \"string\"){\n\t\t\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\t\t\tdummyEl.innerHTML = options.dataTreeCollapseElement;\n\t\t\t\t\tthis.collapseEl = dummyEl.firstChild;\n\t\t\t\t}else {\n\t\t\t\t\tthis.collapseEl = options.dataTreeCollapseElement;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.collapseEl = document.createElement(\"div\");\n\t\t\t\tthis.collapseEl.classList.add(\"tabulator-data-tree-control\");\n\t\t\t\tthis.collapseEl.tabIndex = 0;\n\t\t\t\tthis.collapseEl.innerHTML = \"<div class='tabulator-data-tree-control-collapse'></div>\";\n\t\t\t}\n\n\t\t\tif(options.dataTreeExpandElement){\n\t\t\t\tif(typeof options.dataTreeExpandElement === \"string\"){\n\t\t\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\t\t\tdummyEl.innerHTML = options.dataTreeExpandElement;\n\t\t\t\t\tthis.expandEl = dummyEl.firstChild;\n\t\t\t\t}else {\n\t\t\t\t\tthis.expandEl = options.dataTreeExpandElement;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.expandEl = document.createElement(\"div\");\n\t\t\t\tthis.expandEl.classList.add(\"tabulator-data-tree-control\");\n\t\t\t\tthis.expandEl.tabIndex = 0;\n\t\t\t\tthis.expandEl.innerHTML = \"<div class='tabulator-data-tree-control-expand'></div>\";\n\t\t\t}\n\n\n\t\t\tswitch(typeof options.dataTreeStartExpanded){\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tthis.startOpen = function(row, index){\n\t\t\t\t\t\treturn options.dataTreeStartExpanded;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\tthis.startOpen = options.dataTreeStartExpanded;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis.startOpen = function(row, index){\n\t\t\t\t\t\treturn options.dataTreeStartExpanded[index];\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.subscribe(\"row-init\", this.initializeRow.bind(this));\n\t\t\tthis.subscribe(\"row-layout-after\", this.layoutRow.bind(this));\n\t\t\tthis.subscribe(\"row-deleting\", this.rowDeleting.bind(this));\n\t\t\tthis.subscribe(\"row-deleted\", this.rowDelete.bind(this),0);\n\t\t\tthis.subscribe(\"row-data-changed\", this.rowDataChanged.bind(this), 10);\n\t\t\tthis.subscribe(\"cell-value-updated\", this.cellValueChanged.bind(this));\n\t\t\tthis.subscribe(\"edit-cancelled\", this.cellValueChanged.bind(this));\n\t\t\tthis.subscribe(\"column-moving-rows\", this.columnMoving.bind(this));\n\t\t\tthis.subscribe(\"table-built\", this.initializeElementField.bind(this));\n\t\t\tthis.subscribe(\"table-redrawing\", this.tableRedrawing.bind(this));\n\n\t\t\tthis.registerDisplayHandler(this.getRows.bind(this), 30);\n\t\t}\n\t}\n\n\ttableRedrawing(force){\n\t\tvar rows;\n\n\t\tif(force){\n\t\t\trows = this.table.rowManager.getRows();\n\t\t\t\n\t\t\trows.forEach((row) => {\n\t\t\t\tthis.reinitializeRowChildren(row);\n\t\t\t});\n\t\t}\n\t}\n\n\tinitializeElementField(){\n\t\tvar firstCol = this.table.columnManager.getFirstVisibleColumn();\n\n\t\tthis.elementField = this.table.options.dataTreeElementColumn || (firstCol ? firstCol.field : false);\n\t}\n\t\n\tgetRowChildren(row){\n\t\treturn this.getTreeChildren(row, true);\n\t}\n\n\tcolumnMoving(){\n\t\tvar rows = [];\n\n\t\tthis.table.rowManager.rows.forEach((row) => {\n\t\t\trows = rows.concat(this.getTreeChildren(row, false, true));\n\t\t});\n\n\t\treturn rows;\n\t}\n\n\trowDataChanged(row, visible, updatedData){\n\t\tif(this.redrawNeeded(updatedData)){\n\t\t\tthis.initializeRow(row);\n\n\t\t\tif(visible){\n\t\t\t\tthis.layoutRow(row);\n\t\t\t\tthis.refreshData(true);\n\t\t\t}\n\t\t}\n\t}\n\n\tcellValueChanged(cell){\n\t\tvar field = cell.column.getField();\n\n\t\tif(field === this.elementField){\n\t\t\tthis.layoutRow(cell.row);\n\t\t}\n\t}\n\n\tinitializeRow(row){\n\t\tvar childArray = row.getData()[this.field];\n\t\tvar isArray = Array.isArray(childArray);\n\n\t\tvar children = isArray || (!isArray && typeof childArray === \"object\" && childArray !== null);\n\n\t\tif(!children && row.modules.dataTree && row.modules.dataTree.branchEl){\n\t\t\trow.modules.dataTree.branchEl.parentNode.removeChild(row.modules.dataTree.branchEl);\n\t\t}\n\n\t\tif(!children && row.modules.dataTree && row.modules.dataTree.controlEl){\n\t\t\trow.modules.dataTree.controlEl.parentNode.removeChild(row.modules.dataTree.controlEl);\n\t\t}\n\n\t\trow.modules.dataTree = {\n\t\t\tindex: row.modules.dataTree ? row.modules.dataTree.index : 0,\n\t\t\topen: children ? (row.modules.dataTree ? row.modules.dataTree.open : this.startOpen(row.getComponent(), 0)) : false,\n\t\t\tcontrolEl: row.modules.dataTree && children ? row.modules.dataTree.controlEl : false,\n\t\t\tbranchEl: row.modules.dataTree && children ? row.modules.dataTree.branchEl : false,\n\t\t\tparent: row.modules.dataTree ? row.modules.dataTree.parent : false,\n\t\t\tchildren:children,\n\t\t};\n\t}\n\n\treinitializeRowChildren(row){\n\t\tvar children = this.getTreeChildren(row, false, true);\n\n\t\tchildren.forEach(function(child){\n\t\t\tchild.reinitialize(true);\n\t\t});\n\t}\n\n\tlayoutRow(row){\n\t\tvar cell = this.elementField ? row.getCell(this.elementField) : row.getCells()[0],\n\t\tel = cell.getElement(),\n\t\tconfig = row.modules.dataTree;\n\n\t\tif(config.branchEl){\n\t\t\tif(config.branchEl.parentNode){\n\t\t\t\tconfig.branchEl.parentNode.removeChild(config.branchEl);\n\t\t\t}\n\t\t\tconfig.branchEl = false;\n\t\t}\n\n\t\tif(config.controlEl){\n\t\t\tif(config.controlEl.parentNode){\n\t\t\t\tconfig.controlEl.parentNode.removeChild(config.controlEl);\n\t\t\t}\n\t\t\tconfig.controlEl = false;\n\t\t}\n\n\t\tthis.generateControlElement(row, el);\n\n\t\trow.getElement().classList.add(\"tabulator-tree-level-\" + config.index);\n\n\t\tif(config.index){\n\t\t\tif(this.branchEl){\n\t\t\t\tconfig.branchEl = this.branchEl.cloneNode(true);\n\t\t\t\tel.insertBefore(config.branchEl, el.firstChild);\n\n\t\t\t\tif(this.table.rtl){\n\t\t\t\t\tconfig.branchEl.style.marginRight = (((config.branchEl.offsetWidth + config.branchEl.style.marginLeft) * (config.index - 1)) + (config.index * this.indent)) + \"px\";\n\t\t\t\t}else {\n\t\t\t\t\tconfig.branchEl.style.marginLeft = (((config.branchEl.offsetWidth + config.branchEl.style.marginRight) * (config.index - 1)) + (config.index * this.indent)) + \"px\";\n\t\t\t\t}\n\t\t\t}else {\n\n\t\t\t\tif(this.table.rtl){\n\t\t\t\t\tel.style.paddingRight = parseInt(window.getComputedStyle(el, null).getPropertyValue('padding-right')) + (config.index * this.indent) + \"px\";\n\t\t\t\t}else {\n\t\t\t\t\tel.style.paddingLeft = parseInt(window.getComputedStyle(el, null).getPropertyValue('padding-left')) + (config.index * this.indent) + \"px\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgenerateControlElement(row, el){\n\t\tvar config = row.modules.dataTree,\n\t\toldControl = config.controlEl;\n\n\t\tel = el || row.getCells()[0].getElement();\n\n\t\tif(config.children !== false){\n\n\t\t\tif(config.open){\n\t\t\t\tconfig.controlEl = this.collapseEl.cloneNode(true);\n\t\t\t\tconfig.controlEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.collapseRow(row);\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconfig.controlEl = this.expandEl.cloneNode(true);\n\t\t\t\tconfig.controlEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tthis.expandRow(row);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconfig.controlEl.addEventListener(\"mousedown\", (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\n\t\t\tif(oldControl && oldControl.parentNode === el){\n\t\t\t\toldControl.parentNode.replaceChild(config.controlEl,oldControl);\n\t\t\t}else {\n\t\t\t\tel.insertBefore(config.controlEl, el.firstChild);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetRows(rows){\n\t\tvar output = [];\n\n\t\trows.forEach((row, i) => {\n\t\t\tvar config, children;\n\n\t\t\toutput.push(row);\n\n\t\t\tif(row instanceof Row){\n\n\t\t\t\trow.create();\n\n\t\t\t\tconfig = row.modules.dataTree;\n\n\t\t\t\tif(!config.index && config.children !== false){\n\t\t\t\t\tchildren = this.getChildren(row, false, true);\n\n\t\t\t\t\tchildren.forEach((child) => {\n\t\t\t\t\t\tchild.create();\n\t\t\t\t\t\toutput.push(child);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\tgetChildren(row, allChildren, sortOnly){\n\t\tvar config = row.modules.dataTree,\n\t\tchildren = [],\n\t\toutput = [];\n\n\t\tif(config.children !== false && (config.open || allChildren)){\n\t\t\tif(!Array.isArray(config.children)){\n\t\t\t\tconfig.children = this.generateChildren(row);\n\t\t\t}\n\n\t\t\tif(this.table.modExists(\"filter\") && this.table.options.dataTreeFilter){\n\t\t\t\tchildren = this.table.modules.filter.filter(config.children);\n\t\t\t}else {\n\t\t\t\tchildren = config.children;\n\t\t\t}\n\n\t\t\tif(this.table.modExists(\"sort\") && this.table.options.dataTreeSort){\n\t\t\t\tthis.table.modules.sort.sort(children, sortOnly);\n\t\t\t}\n\n\t\t\tchildren.forEach((child) => {\n\t\t\t\toutput.push(child);\n\n\t\t\t\tvar subChildren = this.getChildren(child, false, true);\n\n\t\t\t\tsubChildren.forEach((sub) => {\n\t\t\t\t\toutput.push(sub);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tgenerateChildren(row){\n\t\tvar children = [];\n\n\t\tvar childArray = row.getData()[this.field];\n\n\t\tif(!Array.isArray(childArray)){\n\t\t\tchildArray = [childArray];\n\t\t}\n\n\t\tchildArray.forEach((childData) => {\n\t\t\tvar childRow = new Row(childData || {}, this.table.rowManager);\n\n\t\t\tchildRow.create();\n\n\t\t\tchildRow.modules.dataTree.index = row.modules.dataTree.index + 1;\n\t\t\tchildRow.modules.dataTree.parent = row;\n\n\t\t\tif(childRow.modules.dataTree.children){\n\t\t\t\tchildRow.modules.dataTree.open = this.startOpen(childRow.getComponent(), childRow.modules.dataTree.index);\n\t\t\t}\n\t\t\tchildren.push(childRow);\n\t\t});\n\n\t\treturn children;\n\t}\n\n\texpandRow(row, silent){\n\t\tvar config = row.modules.dataTree;\n\n\t\tif(config.children !== false){\n\t\t\tconfig.open = true;\n\n\t\t\trow.reinitialize();\n\n\t\t\tthis.refreshData(true);\n\n\t\t\tthis.dispatchExternal(\"dataTreeRowExpanded\", row.getComponent(), row.modules.dataTree.index);\n\t\t}\n\t}\n\n\tcollapseRow(row){\n\t\tvar config = row.modules.dataTree;\n\n\t\tif(config.children !== false){\n\t\t\tconfig.open = false;\n\n\t\t\trow.reinitialize();\n\n\t\t\tthis.refreshData(true);\n\n\t\t\tthis.dispatchExternal(\"dataTreeRowCollapsed\", row.getComponent(), row.modules.dataTree.index);\n\t\t}\n\t}\n\n\ttoggleRow(row){\n\t\tvar config = row.modules.dataTree;\n\n\t\tif(config.children !== false){\n\t\t\tif(config.open){\n\t\t\t\tthis.collapseRow(row);\n\t\t\t}else {\n\t\t\t\tthis.expandRow(row);\n\t\t\t}\n\t\t}\n\t}\n\n\tisRowExpanded(row){\n\t\treturn row.modules.dataTree.open;\n\t}\n\n\tgetTreeParent(row){\n\t\treturn row.modules.dataTree.parent ? row.modules.dataTree.parent.getComponent() : false;\n\t}\n\n\tgetTreeParentRoot(row){\n\t\treturn row.modules.dataTree && row.modules.dataTree.parent ? this.getTreeParentRoot(row.modules.dataTree.parent) : row;\n\t}\n\n\tgetFilteredTreeChildren(row){\n\t\tvar config = row.modules.dataTree,\n\t\toutput = [], children;\n\n\t\tif(config.children){\n\n\t\t\tif(!Array.isArray(config.children)){\n\t\t\t\tconfig.children = this.generateChildren(row);\n\t\t\t}\n\n\t\t\tif(this.table.modExists(\"filter\") && this.table.options.dataTreeFilter){\n\t\t\t\tchildren = this.table.modules.filter.filter(config.children);\n\t\t\t}else {\n\t\t\t\tchildren = config.children;\n\t\t\t}\n\n\t\t\tchildren.forEach((childRow) => {\n\t\t\t\tif(childRow instanceof Row){\n\t\t\t\t\toutput.push(childRow);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\trowDeleting(row){\n\t\tvar config = row.modules.dataTree;\n\n\t\tif (config && config.children && Array.isArray(config.children)){\n\t\t\tconfig.children.forEach((childRow) => {\n\t\t\t\tif(childRow instanceof Row){\n\t\t\t\t\tchildRow.wipe();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\trowDelete(row){\n\t\tvar parent = row.modules.dataTree.parent,\n\t\tchildIndex;\n\n\t\tif(parent){\n\t\t\tchildIndex = this.findChildIndex(row, parent);\n\n\t\t\tif(childIndex !== false){\n\t\t\t\tparent.data[this.field].splice(childIndex, 1);\n\t\t\t}\n\n\t\t\tif(!parent.data[this.field].length){\n\t\t\t\tdelete parent.data[this.field];\n\t\t\t}\n\n\t\t\tthis.initializeRow(parent);\n\t\t\tthis.layoutRow(parent);\n\t\t}\n\n\t\tthis.refreshData(true);\n\t}\n\n\taddTreeChildRow(row, data, top, index){\n\t\tvar childIndex = false;\n\n\t\tif(typeof data === \"string\"){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\n\t\tif(!Array.isArray(row.data[this.field])){\n\t\t\trow.data[this.field] = [];\n\n\t\t\trow.modules.dataTree.open = this.startOpen(row.getComponent(), row.modules.dataTree.index);\n\t\t}\n\n\t\tif(typeof index !== \"undefined\"){\n\t\t\tchildIndex = this.findChildIndex(index, row);\n\n\t\t\tif(childIndex !== false){\n\t\t\t\trow.data[this.field].splice((top ? childIndex : childIndex + 1), 0, data);\n\t\t\t}\n\t\t}\n\n\t\tif(childIndex === false){\n\t\t\tif(top){\n\t\t\t\trow.data[this.field].unshift(data);\n\t\t\t}else {\n\t\t\t\trow.data[this.field].push(data);\n\t\t\t}\n\t\t}\n\n\t\tthis.initializeRow(row);\n\t\tthis.layoutRow(row);\n\n\t\tthis.refreshData(true);\n\t}\n\n\tfindChildIndex(subject, parent){\n\t\tvar match = false;\n\n\t\tif(typeof subject == \"object\"){\n\n\t\t\tif(subject instanceof Row){\n\t\t\t\t//subject is row element\n\t\t\t\tmatch = subject.data;\n\t\t\t}else if(subject instanceof RowComponent){\n\t\t\t\t//subject is public row component\n\t\t\t\tmatch = subject._getSelf().data;\n\t\t\t}else if(typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement){\n\t\t\t\tif(parent.modules.dataTree){\n\t\t\t\t\tmatch = parent.modules.dataTree.children.find((childRow) => {\n\t\t\t\t\t\treturn childRow instanceof Row ? childRow.element === subject : false;\n\t\t\t\t\t});\n\n\t\t\t\t\tif(match){\n\t\t\t\t\t\tmatch = match.data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else if(subject === null){\n\t\t\t\tmatch = false;\n\t\t\t}\n\n\t\t}else if(typeof subject == \"undefined\"){\n\t\t\tmatch = false;\n\t\t}else {\n\t\t\t//subject should be treated as the index of the row\n\t\t\tmatch = parent.data[this.field].find((row) => {\n\t\t\t\treturn row.data[this.table.options.index] == subject;\n\t\t\t});\n\t\t}\n\n\t\tif(match){\n\n\t\t\tif(Array.isArray(parent.data[this.field])){\n\t\t\t\tmatch = parent.data[this.field].indexOf(match);\n\t\t\t}\n\n\t\t\tif(match == -1){\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t}\n\n\t\t//catch all for any other type of input\n\n\t\treturn match;\n\t}\n\n\tgetTreeChildren(row, component, recurse){\n\t\tvar config = row.modules.dataTree,\n\t\toutput = [];\n\n\t\tif(config && config.children){\n\n\t\t\tif(!Array.isArray(config.children)){\n\t\t\t\tconfig.children = this.generateChildren(row);\n\t\t\t}\n\n\t\t\tconfig.children.forEach((childRow) => {\n\t\t\t\tif(childRow instanceof Row){\n\t\t\t\t\toutput.push(component ? childRow.getComponent() : childRow);\n\n\t\t\t\t\tif(recurse){\n\t\t\t\t\t\tthis.getTreeChildren(childRow, component, recurse).forEach(child => {\n\t\t\t\t\t\t\toutput.push(child);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tgetChildField(){\n\t\treturn this.field;\n\t}\n\n\tredrawNeeded(data){\n\t\treturn (this.field ? typeof data[this.field] !== \"undefined\" : false) || (this.elementField ? typeof data[this.elementField] !== \"undefined\" : false);\n\t}\n}\n\nfunction csv$1(list, options = {}, setFileContents){\n\tvar delimiter = options.delimiter ? options.delimiter : \",\",\n\tfileContents = [],\n\theaders = [];\n\n\tlist.forEach((row) => {\n\t\tvar item = [];\n\n\t\tswitch(row.type){\n\t\t\tcase \"group\":\n\t\t\t\tconsole.warn(\"Download Warning - CSV downloader cannot process row groups\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tconsole.warn(\"Download Warning - CSV downloader cannot process column calculations\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"header\":\n\t\t\t\trow.columns.forEach((col, i) => {\n\t\t\t\t\tif(col && col.depth === 1){\n\t\t\t\t\t\theaders[i] = typeof col.value == \"undefined\"  || col.value === null ? \"\" : ('\"' + String(col.value).split('\"').join('\"\"') + '\"');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\trow.columns.forEach((col) => {\n\n\t\t\t\t\tif(col){\n\n\t\t\t\t\t\tswitch(typeof col.value){\n\t\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\t\tcol.value = col.value !== null ? JSON.stringify(col.value) : \"\";\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\t\tcol.value = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\titem.push('\"' + String(col.value).split('\"').join('\"\"') + '\"');\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfileContents.push(item.join(delimiter));\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(headers.length){\n\t\tfileContents.unshift(headers.join(delimiter));\n\t}\n\n\tfileContents = fileContents.join(\"\\n\");\n\n\tif(options.bom){\n\t\tfileContents = \"\\ufeff\" + fileContents;\n\t}\n\n\tsetFileContents(fileContents, \"text/csv\");\n}\n\nfunction json$2(list, options, setFileContents){\n\tvar fileContents = [];\n\n\tlist.forEach((row) => {\n\t\tvar item = {};\n\n\t\tswitch(row.type){\n\t\t\tcase \"header\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process row groups\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process column calculations\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\trow.columns.forEach((col) => {\n\t\t\t\t\tif(col){\n\t\t\t\t\t\titem[col.component.getTitleDownload() || col.component.getField()] = col.value;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfileContents.push(item);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tfileContents = JSON.stringify(fileContents, null, '\\t');\n\n\tsetFileContents(fileContents, \"application/json\");\n}\n\nfunction pdf(list, options = {}, setFileContents){\n\tvar header = [],\n\tbody = [],\n\tautoTableParams = {},\n\trowGroupStyles = options.rowGroupStyles || {\n\t\tfontStyle: \"bold\",\n\t\tfontSize: 12,\n\t\tcellPadding: 6,\n\t\tfillColor: 220,\n\t},\n\trowCalcStyles = options.rowCalcStyles || {\n\t\tfontStyle: \"bold\",\n\t\tfontSize: 10,\n\t\tcellPadding: 4,\n\t\tfillColor: 232,\n\t},\n\tjsPDFParams = options.jsPDF || {},\n\ttitle = options.title ? options.title : \"\",\n\tjspdfLib, doc;\n\n\tif(!jsPDFParams.orientation){\n\t\tjsPDFParams.orientation = options.orientation || \"landscape\";\n\t}\n\n\tif(!jsPDFParams.unit){\n\t\tjsPDFParams.unit = \"pt\";\n\t}\n\n\t//parse row list\n\tlist.forEach((row) => {\n\t\tswitch(row.type){\n\t\t\tcase \"header\":\n\t\t\t\theader.push(parseRow(row));\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tbody.push(parseRow(row, rowGroupStyles));\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tbody.push(parseRow(row, rowCalcStyles));\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\tbody.push(parseRow(row));\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tfunction parseRow(row, styles){\n\t\tvar rowData = [];\n\n\t\trow.columns.forEach((col) =>{\n\t\t\tvar cell;\n\n\t\t\tif(col){\n\t\t\t\tswitch(typeof col.value){\n\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\tcol.value = col.value !== null ? JSON.stringify(col.value) : \"\";\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\tcol.value = \"\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcell = {\n\t\t\t\t\tcontent:col.value,\n\t\t\t\t\tcolSpan:col.width,\n\t\t\t\t\trowSpan:col.height,\n\t\t\t\t};\n\n\t\t\t\tif(styles){\n\t\t\t\t\tcell.styles = styles;\n\t\t\t\t}\n\n\t\t\t\trowData.push(cell);\n\t\t\t}\n\t\t});\n\n\t\treturn rowData;\n\t}\n\n\n\t//configure PDF\n\tjspdfLib = this.dependencyRegistry.lookup(\"jspdf\", \"jsPDF\");\n\tdoc = new jspdfLib(jsPDFParams); //set document to landscape, better for most tables\n\n\tif(options.autoTable){\n\t\tif(typeof options.autoTable === \"function\"){\n\t\t\tautoTableParams = options.autoTable(doc) || {};\n\t\t}else {\n\t\t\tautoTableParams = options.autoTable;\n\t\t}\n\t}\n\n\tif(title){\n\t\tautoTableParams.didDrawPage = function(data) {\n\t\t\tdoc.text(title, 40, 30);\n\t\t};\n\t}\n\n\tautoTableParams.head = header;\n\tautoTableParams.body = body;\n\n\tdoc.autoTable(autoTableParams);\n\n\tif(options.documentProcessing){\n\t\toptions.documentProcessing(doc);\n\t}\n\n\tsetFileContents(doc.output(\"arraybuffer\"), \"application/pdf\");\n}\n\nfunction xlsx$1(list, options, setFileContents){\n\tvar self = this,\n\tsheetName = options.sheetName || \"Sheet1\",\n\tXLSXLib = this.dependencyRegistry.lookup(\"XLSX\"),\n\tworkbook = XLSXLib.utils.book_new(),\n\ttableFeatures = new CoreFeature(this),\n\tcompression =  'compress' in options ? options.compress : true,\n\twriteOptions = options.writeOptions || {bookType:'xlsx', bookSST:true, compression},\n\toutput;\n\n\twriteOptions.type = 'binary';\n\n\tworkbook.SheetNames = [];\n\tworkbook.Sheets = {};\n\n\tfunction generateSheet(){\n\t\tvar rows = [],\n\t\tmerges = [],\n\t\tworksheet = {},\n\t\trange = {s: {c:0, r:0}, e: {c:(list[0] ? list[0].columns.reduce((a, b) => a + (b && b.width ? b.width : 1), 0) : 0), r:list.length }};\n\n\t\t//parse row list\n\t\tlist.forEach((row, i) => {\n\t\t\tvar rowData = [];\n\n\t\t\trow.columns.forEach(function(col, j){\n\n\t\t\t\tif(col){\n\t\t\t\t\trowData.push(!(col.value instanceof Date) && typeof col.value === \"object\" ? JSON.stringify(col.value) : col.value);\n\n\t\t\t\t\tif(col.width > 1 || col.height > -1){\n\t\t\t\t\t\tif(col.height > 1 || col.width > 1){\n\t\t\t\t\t\t\tmerges.push({s:{r:i,c:j},e:{r:i + col.height - 1,c:j + col.width - 1}});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\trowData.push(\"\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trows.push(rowData);\n\t\t});\n\n\t\t//convert rows to worksheet\n\t\tXLSXLib.utils.sheet_add_aoa(worksheet, rows);\n\n\t\tworksheet['!ref'] = XLSXLib.utils.encode_range(range);\n\n\t\tif(merges.length){\n\t\t\tworksheet[\"!merges\"] = merges;\n\t\t}\n\n\t\treturn worksheet;\n\t}\n\n\tif(options.sheetOnly){\n\t\tsetFileContents(generateSheet());\n\t\treturn;\n\t}\n\n\tif(options.sheets){\n\t\tfor(var sheet in options.sheets){\n\n\t\t\tif(options.sheets[sheet] === true){\n\t\t\t\tworkbook.SheetNames.push(sheet);\n\t\t\t\tworkbook.Sheets[sheet] = generateSheet();\n\t\t\t}else {\n\n\t\t\t\tworkbook.SheetNames.push(sheet);\n\n\t\t\t\ttableFeatures.commsSend(options.sheets[sheet], \"download\", \"intercept\",{\n\t\t\t\t\ttype:\"xlsx\",\n\t\t\t\t\toptions:{sheetOnly:true},\n\t\t\t\t\tactive:self.active,\n\t\t\t\t\tintercept:function(data){\n\t\t\t\t\t\tworkbook.Sheets[sheet] = data;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}else {\n\t\tworkbook.SheetNames.push(sheetName);\n\t\tworkbook.Sheets[sheetName] = generateSheet();\n\t}\n\n\tif(options.documentProcessing){\n\t\tworkbook = options.documentProcessing(workbook);\n\t}\n\n\t//convert workbook to binary array\n\tfunction s2ab(s) {\n\t\tvar buf = new ArrayBuffer(s.length);\n\t\tvar view = new Uint8Array(buf);\n\t\tfor (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\t\treturn buf;\n\t}\n\n\toutput = XLSXLib.write(workbook, writeOptions);\n\n\tsetFileContents(s2ab(output), \"application/octet-stream\");\n}\n\nfunction html$1(list, options, setFileContents){\n\tif(this.modExists(\"export\", true)){\n\t\tsetFileContents(this.modules.export.generateHTMLTable(list), \"text/html\");\n\t}\n}\n\nfunction jsonLines (list, options, setFileContents) {\n\tconst fileContents = [];\n\n\tlist.forEach((row) => {\n\t\tconst item = {};\n\n\t\tswitch (row.type) {\n\t\t\tcase \"header\":\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process row groups\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process column calculations\");\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\trow.columns.forEach((col) => {\n\t\t\t\t\tif (col) {\n\t\t\t\t\t\titem[col.component.getTitleDownload() || col.component.getField()] = col.value;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfileContents.push(JSON.stringify(item));\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tsetFileContents(fileContents.join(\"\\n\"), \"application/x-ndjson\");\n}\n\nvar defaultDownloaders = {\n\tcsv:csv$1,\n\tjson:json$2,\n\tjsonLines:jsonLines,\n\tpdf:pdf,\n\txlsx:xlsx$1,\n\thtml:html$1,\n};\n\nclass Download extends Module{\n\n\tstatic moduleName = \"download\";\n\n\t//load defaults\n\tstatic downloaders = defaultDownloaders;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.registerTableOption(\"downloadEncoder\", function(data, mimeType){\n\t\t\treturn new Blob([data],{type:mimeType});\n\t\t}); //function to manipulate download data\n\t\tthis.registerTableOption(\"downloadConfig\", {}); //download config\n\t\tthis.registerTableOption(\"downloadRowRange\", \"active\"); //restrict download to active rows only\n\n\t\tthis.registerColumnOption(\"download\");\n\t\tthis.registerColumnOption(\"titleDownload\");\n\t}\n\n\tinitialize(){\n\t\tthis.deprecatedOptionsCheck();\n\n\t\tthis.registerTableFunction(\"download\", this.download.bind(this));\n\t\tthis.registerTableFunction(\"downloadToTab\", this.downloadToTab.bind(this));\n\t}\n\n\tdeprecatedOptionsCheck(){\n\n\t}\t\n\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\n\tdownloadToTab(type, filename, options, active){\n\t\tthis.download(type, filename, options, active, true);\n\t}\n\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\n\t//trigger file download\n\tdownload(type, filename, options, range, interceptCallback){\n\t\tvar downloadFunc = false;\n\n\t\tfunction buildLink(data, mime){\n\t\t\tif(interceptCallback){\n\t\t\t\tif(interceptCallback === true){\n\t\t\t\t\tthis.triggerDownload(data, mime, type, filename, true);\n\t\t\t\t}else {\n\t\t\t\t\tinterceptCallback(data);\n\t\t\t\t}\n\n\t\t\t}else {\n\t\t\t\tthis.triggerDownload(data, mime, type, filename);\n\t\t\t}\n\t\t}\n\n\t\tif(typeof type == \"function\"){\n\t\t\tdownloadFunc = type;\n\t\t}else {\n\t\t\tif(Download.downloaders[type]){\n\t\t\t\tdownloadFunc = Download.downloaders[type];\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Download Error - No such download type found: \", type);\n\t\t\t}\n\t\t}\n\n\t\tif(downloadFunc){\n\t\t\tvar list = this.generateExportList(range);\n\n\t\t\tdownloadFunc.call(this.table, list , options || {}, buildLink.bind(this));\n\t\t}\n\t}\n\n\tgenerateExportList(range){\n\t\tvar list = this.table.modules.export.generateExportList(this.table.options.downloadConfig, false, range || this.table.options.downloadRowRange, \"download\");\n\n\t\t//assign group header formatter\n\t\tvar groupHeader = this.table.options.groupHeaderDownload;\n\n\t\tif(groupHeader && !Array.isArray(groupHeader)){\n\t\t\tgroupHeader = [groupHeader];\n\t\t}\n\n\t\tlist.forEach((row) => {\n\t\t\tvar group;\n\n\t\t\tif(row.type === \"group\"){\n\t\t\t\tgroup = row.columns[0];\n\n\t\t\t\tif(groupHeader && groupHeader[row.indent]){\n\t\t\t\t\tgroup.value = groupHeader[row.indent](group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn list;\n\t}\n\n\ttriggerDownload(data, mime, type, filename, newTab){\n\t\tvar element = document.createElement('a'),\n\t\tblob = this.table.options.downloadEncoder(data, mime);\n\n\t\tif(blob){\n\t\t\tif(newTab){\n\t\t\t\twindow.open(window.URL.createObjectURL(blob));\n\t\t\t}else {\n\t\t\t\tfilename = filename || \"Tabulator.\" + (typeof type === \"function\" ? \"txt\" : type);\n\t\t\t\t\n\t\t\t\tif(navigator.msSaveOrOpenBlob){\n\t\t\t\t\tnavigator.msSaveOrOpenBlob(blob, filename);\n\t\t\t\t}else {\n\t\t\t\t\telement.setAttribute('href', window.URL.createObjectURL(blob));\n\n\t\t\t\t\t//set file title\n\t\t\t\t\telement.setAttribute('download', filename);\n\n\t\t\t\t\t//trigger download\n\t\t\t\t\telement.style.display = 'none';\n\t\t\t\t\tdocument.body.appendChild(element);\n\t\t\t\t\telement.click();\n\n\t\t\t\t\t//remove temporary link element\n\t\t\t\t\tdocument.body.removeChild(element);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.dispatchExternal(\"downloadComplete\");\n\t\t}\n\t}\n\n\tcommsReceived(table, action, data){\n\t\tswitch(action){\n\t\t\tcase \"intercept\":\n\t\t\t\tthis.download(data.type, \"\", data.options, data.active, data.intercept);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nfunction maskInput(el, options){\n\tvar mask = options.mask,\n\tmaskLetter = typeof options.maskLetterChar !== \"undefined\" ? options.maskLetterChar : \"A\",\n\tmaskNumber = typeof options.maskNumberChar !== \"undefined\" ? options.maskNumberChar : \"9\",\n\tmaskWildcard = typeof options.maskWildcardChar !== \"undefined\" ? options.maskWildcardChar : \"*\";\n\n\tfunction fillSymbols(index){\n\t\tvar symbol = mask[index];\n\t\tif(typeof symbol !== \"undefined\" && symbol !== maskWildcard && symbol !== maskLetter && symbol !== maskNumber){\n\t\t\tel.value = el.value + \"\" + symbol;\n\t\t\tfillSymbols(index+1);\n\t\t}\n\t}\n\n\tel.addEventListener(\"keydown\", (e) => {\n\t\tvar index = el.value.length,\n\t\tchar = e.key;\n\n\t\tif(e.keyCode > 46 && !e.ctrlKey && !e.metaKey){\n\t\t\tif(index >= mask.length){\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}else {\n\t\t\t\tswitch(mask[index]){\n\t\t\t\t\tcase maskLetter:\n\t\t\t\t\t\tif(char.toUpperCase() == char.toLowerCase()){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase maskNumber:\n\t\t\t\t\t\tif(isNaN(char)){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase maskWildcard:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(char !== mask[index]){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn;\n\t});\n\n\tel.addEventListener(\"keyup\", (e) => {\n\t\tif(e.keyCode > 46){\n\t\t\tif(options.maskAutoFill){\n\t\t\t\tfillSymbols(el.value.length);\n\t\t\t}\n\t\t}\n\t});\n\n\n\tif(!el.placeholder){\n\t\tel.placeholder = mask;\n\t}\n\n\tif(options.maskAutoFill){\n\t\tfillSymbols(el.value.length);\n\t}\n}\n\n//input element\nfunction input(cell, onRendered, success, cancel, editorParams){\n\t//create and style input\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\n\tinput.setAttribute(\"type\", editorParams.search ? \"search\" : \"text\");\n\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\tinput.value = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\n\tonRendered(function(){\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction onChange(e){\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && input.value !== \"\") || input.value !== cellValue){\n\t\t\tif(success(input.value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\n\t//submit new value on blur or change\n\tinput.addEventListener(\"change\", onChange);\n\tinput.addEventListener(\"blur\", onChange);\n\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\t// case 9:\n\t\t\tcase 13:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(editorParams.mask){\n\t\tmaskInput(input, editorParams);\n\t}\n\n\treturn input;\n}\n\n//resizable text area element\nfunction textarea$1(cell, onRendered, success, cancel, editorParams){\n\tvar cellValue = cell.getValue(),\n\tvertNav = editorParams.verticalNavigation || \"hybrid\",\n\tvalue = String(cellValue !== null && typeof cellValue !== \"undefined\"  ? cellValue : \"\"),\n\tinput = document.createElement(\"textarea\"),\n\tscrollHeight = 0;\n\n\t//create and style input\n\tinput.style.display = \"block\";\n\tinput.style.padding = \"2px\";\n\tinput.style.height = \"100%\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\tinput.style.whiteSpace = \"pre-wrap\";\n\tinput.style.resize = \"none\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\tinput.value = value;\n\n\tonRendered(function(){\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\n\t\t\tinput.scrollHeight;\n\t\t\tinput.style.height = input.scrollHeight + \"px\";\n\t\t\tcell.getRow().normalizeHeight();\n\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction onChange(e){\n\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && input.value !== \"\") || input.value !== cellValue){\n\n\t\t\tif(success(input.value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tcell.getRow().normalizeHeight();\n\t\t\t},300);\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\n\t//submit new value on blur or change\n\tinput.addEventListener(\"change\", onChange);\n\tinput.addEventListener(\"blur\", onChange);\n\n\tinput.addEventListener(\"keyup\", function(){\n\n\t\tinput.style.height = \"\";\n\n\t\tvar heightNow = input.scrollHeight;\n\n\t\tinput.style.height = heightNow + \"px\";\n\n\t\tif(heightNow != scrollHeight){\n\t\t\tscrollHeight = heightNow;\n\t\t\tcell.getRow().normalizeHeight();\n\t\t}\n\t});\n\n\tinput.addEventListener(\"keydown\", function(e){\n\n\t\tswitch(e.keyCode){\n\n\t\t\tcase 13:\n\t\t\t\tif(e.shiftKey && editorParams.shiftEnterSubmit){\n\t\t\t\t\tonChange();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\n\t\t\tcase 38: //up arrow\n\t\t\t\tif(vertNav == \"editor\" || (vertNav == \"hybrid\" && input.selectionStart)){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\" || (vertNav == \"hybrid\" && input.selectionStart !== input.value.length)){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(editorParams.mask){\n\t\tmaskInput(input, editorParams);\n\t}\n\n\treturn input;\n}\n\n//input element with type of number\nfunction number$1(cell, onRendered, success, cancel, editorParams){\n\tvar cellValue = cell.getValue(),\n\tvertNav = editorParams.verticalNavigation || \"editor\",\n\tinput = document.createElement(\"input\");\n\n\tinput.setAttribute(\"type\", \"number\");\n\n\tif(typeof editorParams.max != \"undefined\"){\n\t\tinput.setAttribute(\"max\", editorParams.max);\n\t}\n\n\tif(typeof editorParams.min != \"undefined\"){\n\t\tinput.setAttribute(\"min\", editorParams.min);\n\t}\n\n\tif(typeof editorParams.step != \"undefined\"){\n\t\tinput.setAttribute(\"step\", editorParams.step);\n\t}\n\n\t//create and style input\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\tinput.value = cellValue;\n\n\tvar blurFunc = function(e){\n\t\tonChange();\n\t};\n\n\tonRendered(function () {\n\t\tif(cell.getType() === \"cell\"){\n\t\t\t//submit new value on blur\n\t\t\tinput.removeEventListener(\"blur\", blurFunc);\n\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\n\t\t\t//submit new value on blur\n\t\t\tinput.addEventListener(\"blur\", blurFunc);\n\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction onChange(){\n\t\tvar value = input.value;\n\n\t\tif(!isNaN(value) && value !==\"\"){\n\t\t\tvalue = Number(value);\n\t\t}\n\n\t\tif(value !== cellValue){\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 13:\n\t\t\t// case 9:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\n\t\t\tcase 38: //up arrow\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\"){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(editorParams.mask){\n\t\tmaskInput(input, editorParams);\n\t}\n\n\treturn input;\n}\n\n//input element with type of number\nfunction range(cell, onRendered, success, cancel, editorParams){\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\t\n\tinput.setAttribute(\"type\", \"range\");\n\t\n\tif (typeof editorParams.max != \"undefined\") {\n\t\tinput.setAttribute(\"max\", editorParams.max);\n\t}\n\t\n\tif (typeof editorParams.min != \"undefined\") {\n\t\tinput.setAttribute(\"min\", editorParams.min);\n\t}\n\t\n\tif (typeof editorParams.step != \"undefined\") {\n\t\tinput.setAttribute(\"step\", editorParams.step);\n\t}\n\t\n\t//create and style input\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinput.value = cellValue;\n\t\n\tonRendered(function () {\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\t\t}\n\t});\n\t\n\tfunction onChange(){\n\t\tvar value = input.value;\n\t\t\n\t\tif(!isNaN(value) && value !==\"\"){\n\t\t\tvalue = Number(value);\n\t\t}\n\t\t\n\t\tif(value != cellValue){\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"blur\", function(e){\n\t\tonChange();\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 13:\n\t\t\t// case 9:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\n//input element\nfunction date$1(cell, onRendered, success, cancel, editorParams){\n\tvar inputFormat = editorParams.format,\n\tvertNav = editorParams.verticalNavigation || \"editor\",\n\tDT = inputFormat ? (window.DateTime || luxon.DateTime) : null;\n\t\n\t//create and style input\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\t\n\tfunction convertDate(value){\n\t\tvar newDatetime;\n\t\t\n\t\tif(DT.isDateTime(value)){\n\t\t\tnewDatetime = value;\n\t\t}else if(inputFormat === \"iso\"){\n\t\t\tnewDatetime = DT.fromISO(String(value));\n\t\t}else {\n\t\t\tnewDatetime = DT.fromFormat(String(value), inputFormat);\n\t\t}\n\t\t\n\t\treturn newDatetime.toFormat(\"yyyy-MM-dd\");\n\t}\n\t\n\tinput.type = \"date\";\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\n\tif(editorParams.max){\n\t\tinput.setAttribute(\"max\", inputFormat ? convertDate(editorParams.max) : editorParams.max);\n\t}\n\n\tif(editorParams.min){\n\t\tinput.setAttribute(\"min\", inputFormat ? convertDate(editorParams.min) : editorParams.min);\n\t}\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcellValue = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\t\n\tif(inputFormat){\n\t\tif(DT){\t\t\n\t\t\tcellValue = convertDate(cellValue);\t\t\t\n\t\t}else {\n\t\t\tconsole.error(\"Editor Error - 'date' editor 'format' param is dependant on luxon.js\");\n\t\t}\n\t}\n\t\n\tinput.value = cellValue;\n\t\n\tonRendered(function(){\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\t\t\t\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\t\n\tfunction onChange(){\n\t\tvar value = input.value,\n\t\tluxDate;\n\t\t\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && value !== \"\") || value !== cellValue){\n\t\t\t\n\t\t\tif(value && inputFormat){\n\t\t\t\tluxDate = DT.fromFormat(String(value), \"yyyy-MM-dd\");\n\n\t\t\t\tswitch(inputFormat){\n\t\t\t\t\tcase true:\n\t\t\t\t\t\tvalue = luxDate;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"iso\":\n\t\t\t\t\t\tvalue = luxDate.toISO();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvalue = luxDate.toFormat(inputFormat);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"blur\", function(e) {\n\t\tif (e.relatedTarget || e.rangeParent || e.explicitOriginalTarget !== input) {\n\t\t\tonChange(); // only on a \"true\" blur; not when focusing browser's date/time picker\n\t\t}\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\t// case 9:\n\t\t\tcase 13:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 38: //up arrow\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\"){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\n//input element\nfunction time$1(cell, onRendered, success, cancel, editorParams){\n\tvar inputFormat = editorParams.format,\n\tvertNav = editorParams.verticalNavigation || \"editor\",\n\tDT = inputFormat ? (window.DateTime || luxon.DateTime) : null, \n\tnewDatetime;\n\t\n\t//create and style input\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\t\n\tinput.type = \"time\";\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcellValue = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\t\n\tif(inputFormat){\n\t\tif(DT){\n\t\t\tif(DT.isDateTime(cellValue)){\n\t\t\t\tnewDatetime = cellValue;\n\t\t\t}else if(inputFormat === \"iso\"){\n\t\t\t\tnewDatetime = DT.fromISO(String(cellValue));\n\t\t\t}else {\n\t\t\t\tnewDatetime = DT.fromFormat(String(cellValue), inputFormat);\n\t\t\t}\n\t\t\t\n\t\t\tcellValue = newDatetime.toFormat(\"HH:mm\");\n\t\t\t\n\t\t}else {\n\t\t\tconsole.error(\"Editor Error - 'date' editor 'format' param is dependant on luxon.js\");\n\t\t}\n\t}\n\t\n\tinput.value = cellValue;\n\t\n\tonRendered(function(){\n\t\tif(cell.getType() == \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\t\t\t\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\t\n\tfunction onChange(){\n\t\tvar value = input.value,\n\t\tluxTime;\n\t\t\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && value !== \"\") || value !== cellValue){\n\t\t\t\n\t\t\tif(value && inputFormat){\n\t\t\t\tluxTime = DT.fromFormat(String(value), \"hh:mm\");\n\n\t\t\t\tswitch(inputFormat){\n\t\t\t\t\tcase true:\n\t\t\t\t\t\tvalue = luxTime;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"iso\":\n\t\t\t\t\t\tvalue = luxTime.toISO();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvalue = luxTime.toFormat(inputFormat);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"blur\", function(e) {\n\t\tif (e.relatedTarget || e.rangeParent || e.explicitOriginalTarget !== input) {\n\t\t\tonChange(); // only on a \"true\" blur; not when focusing browser's date/time picker\n\t\t}\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\t// case 9:\n\t\t\tcase 13:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\n\t\t\tcase 38: //up arrow\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\"){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\n//input element\nfunction datetime$2(cell, onRendered, success, cancel, editorParams){\n\tvar inputFormat = editorParams.format,\n\tvertNav = editorParams.verticalNavigation || \"editor\",\n\tDT = inputFormat ? (this.table.dependencyRegistry.lookup([\"luxon\", \"DateTime\"], \"DateTime\")) : null, \n\tnewDatetime;\n\t\n\t//create and style input\n\tvar cellValue = cell.getValue(),\n\tinput = document.createElement(\"input\");\n\t\n\tinput.type = \"datetime-local\";\n\tinput.style.padding = \"4px\";\n\tinput.style.width = \"100%\";\n\tinput.style.boxSizing = \"border-box\";\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcellValue = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\t\n\tif(inputFormat){\n\t\tif(DT){\n\t\t\tif(DT.isDateTime(cellValue)){\n\t\t\t\tnewDatetime = cellValue;\n\t\t\t}else if(inputFormat === \"iso\"){\n\t\t\t\tnewDatetime = DT.fromISO(String(cellValue));\n\t\t\t}else {\n\t\t\t\tnewDatetime = DT.fromFormat(String(cellValue), inputFormat);\n\t\t\t}\n\t\t\t\n\t\t\tcellValue = newDatetime.toFormat(\"yyyy-MM-dd\")  + \"T\" + newDatetime.toFormat(\"HH:mm\");\n\t\t}else {\n\t\t\tconsole.error(\"Editor Error - 'date' editor 'format' param is dependant on luxon.js\");\n\t\t}\n\t}\n\t\n\tinput.value = cellValue;\n\t\n\tonRendered(function(){\n\t\tif(cell.getType() === \"cell\"){\n\t\t\tinput.focus({preventScroll: true});\n\t\t\tinput.style.height = \"100%\";\n\t\t\t\n\t\t\tif(editorParams.selectContents){\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t});\n\t\n\tfunction onChange(){\n\t\tvar value = input.value,\n\t\tluxDateTime;\n\t\t\n\t\tif(((cellValue === null || typeof cellValue === \"undefined\") && value !== \"\") || value !== cellValue){\n\n\t\t\tif(value && inputFormat){\n\t\t\t\tluxDateTime = DT.fromISO(String(value));\n\n\t\t\t\tswitch(inputFormat){\n\t\t\t\t\tcase true:\n\t\t\t\t\t\tvalue = luxDateTime;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"iso\":\n\t\t\t\t\t\tvalue = luxDateTime.toISO();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvalue = luxDateTime.toFormat(inputFormat);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(success(value)){\n\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t}\n\t\t}else {\n\t\t\tcancel();\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"blur\", function(e) {\n\t\tif (e.relatedTarget || e.rangeParent || e.explicitOriginalTarget !== input) {\n\t\t\tonChange(); // only on a \"true\" blur; not when focusing browser's date/time picker\n\t\t}\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\t// case 9:\n\t\t\tcase 13:\n\t\t\t\tonChange();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27:\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 35:\n\t\t\tcase 36:\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\n\t\t\tcase 38: //up arrow\n\t\t\tcase 40: //down arrow\n\t\t\t\tif(vertNav == \"editor\"){\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\nlet Edit$1 = class Edit{\n\tconstructor(editor, cell, onRendered, success, cancel, editorParams){\n\t\tthis.edit = editor;\n\t\tthis.table = editor.table;\n\t\tthis.cell = cell;\n\t\tthis.params = this._initializeParams(editorParams);\n\t\t\n\t\tthis.data = [];\n\t\tthis.displayItems = [];\n\t\tthis.currentItems = [];\n\t\tthis.focusedItem = null;\n\t\t\n\t\tthis.input = this._createInputElement();\n\t\tthis.listEl = this._createListElement();\n\t\t\n\t\tthis.initialValues = null; \n\t\t\n\t\tthis.isFilter = cell.getType() === \"header\";\n\t\t\n\t\tthis.filterTimeout = null;\n\t\tthis.filtered = false;\n\t\tthis.typing = false;\n\t\t\n\t\tthis.values = []; \n\t\tthis.popup = null;  \n\t\t\n\t\tthis.listIteration = 0;\n\t\t\n\t\tthis.lastAction=\"\";\n\t\tthis.filterTerm=\"\";\n\t\t\n\t\tthis.blurable = true;\n\t\t\n\t\tthis.actions = {\n\t\t\tsuccess:success,\n\t\t\tcancel:cancel\n\t\t};\n\t\t\n\t\tthis._deprecatedOptionsCheck();\n\t\tthis._initializeValue();\n\t\t\n\t\tonRendered(this._onRendered.bind(this));\n\t}\n\t\n\t_deprecatedOptionsCheck(){\n\t\t// if(this.params.listItemFormatter){\n\t\t// \tthis.cell.getTable().deprecationAdvisor.msg(\"The listItemFormatter editor param has been deprecated, please see the latest editor documentation for updated options\");\n\t\t// }\n\t\t\n\t\t// if(this.params.sortValuesList){\n\t\t// \tthis.cell.getTable().deprecationAdvisor.msg(\"The sortValuesList editor param has been deprecated, please see the latest editor documentation for updated options\");\n\t\t// }\n\t\t\n\t\t// if(this.params.searchFunc){\n\t\t// \tthis.cell.getTable().deprecationAdvisor.msg(\"The searchFunc editor param has been deprecated, please see the latest editor documentation for updated options\");\n\t\t// }\n\t\t\n\t\t// if(this.params.searchingPlaceholder){\n\t\t// \tthis.cell.getTable().deprecationAdvisor.msg(\"The searchingPlaceholder editor param has been deprecated, please see the latest editor documentation for updated options\");\n\t\t// }\n\t}\n\t\n\t_initializeValue(){\n\t\tvar initialValue = this.cell.getValue();\n\t\t\n\t\tif(typeof initialValue === \"undefined\" && typeof this.params.defaultValue !== \"undefined\"){\n\t\t\tinitialValue = this.params.defaultValue;\n\t\t}\n\t\t\n\t\tthis.initialValues = this.params.multiselect ? initialValue : [initialValue];\n\t\t\n\t\tif(this.isFilter){\n\t\t\tthis.input.value = this.initialValues ? this.initialValues.join(\",\") : \"\";\n\t\t\tthis.headerFilterInitialListGen();            \n\t\t}\n\t}\n\t\n\t_onRendered(){\n\t\tvar cellEl = this.cell.getElement();\n\t\t\n\t\tfunction clickStop(e){\n\t\t\te.stopPropagation();\n\t\t}\t\n\t\t\n\t\tif(!this.isFilter){\n\t\t\tthis.input.style.height = \"100%\";\n\t\t\tthis.input.focus({preventScroll: true});\n\t\t}\n\t\t\n\t\t\n\t\tcellEl.addEventListener(\"click\", clickStop);\n\t\t\n\t\tsetTimeout(() => {\n\t\t\tcellEl.removeEventListener(\"click\", clickStop);\n\t\t}, 1000);\n\t\t\n\t\tthis.input.addEventListener(\"mousedown\", this._preventPopupBlur.bind(this));\n\t}\n\t\n\t_createListElement(){\n\t\tvar listEl = document.createElement(\"div\");\n\t\tlistEl.classList.add(\"tabulator-edit-list\");\n\t\t\n\t\tlistEl.addEventListener(\"mousedown\", this._preventBlur.bind(this));\n\t\tlistEl.addEventListener(\"keydown\", this._inputKeyDown.bind(this));\n\t\t\n\t\treturn listEl;\n\t}\n\t\n\t_setListWidth(){\n\t\tvar element = this.isFilter ? this.input : this.cell.getElement();\n\t\t\n\t\tthis.listEl.style.minWidth = element.offsetWidth + \"px\";\n\t\t\n\t\tif(this.params.maxWidth){\n\t\t\tif(this.params.maxWidth === true){\n\t\t\t\tthis.listEl.style.maxWidth = element.offsetWidth + \"px\";\n\t\t\t}else if(typeof this.params.maxWidth === \"number\"){\n\t\t\t\tthis.listEl.style.maxWidth = this.params.maxWidth + \"px\";\n\t\t\t}else {\n\t\t\t\tthis.listEl.style.maxWidth = this.params.maxWidth;\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\t\n\t_createInputElement(){\n\t\tvar attribs = this.params.elementAttributes;\n\t\tvar input = document.createElement(\"input\");\n\t\t\n\t\tinput.setAttribute(\"type\", this.params.clearable ? \"search\" : \"text\");\n\t\t\n\t\tinput.style.padding = \"4px\";\n\t\tinput.style.width = \"100%\";\n\t\tinput.style.boxSizing = \"border-box\";\n\t\t\n\t\tif(!this.params.autocomplete){\n\t\t\tinput.style.cursor = \"default\";\n\t\t\tinput.style.caretColor = \"transparent\";\n\t\t\t// input.readOnly = (this.edit.currentCell != false);\n\t\t}\n\t\t\n\t\tif(attribs && typeof attribs == \"object\"){\n\t\t\tfor (let key in attribs){\n\t\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + attribs[\"+\" + key]);\n\t\t\t\t}else {\n\t\t\t\t\tinput.setAttribute(key, attribs[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(this.params.mask){\n\t\t\tmaskInput(input, this.params);\n\t\t}\n\t\t\n\t\tthis._bindInputEvents(input);\n\t\t\n\t\treturn input;\n\t}\n\t\n\t_initializeParams(params){\n\t\tvar valueKeys = [\"values\", \"valuesURL\", \"valuesLookup\"],\n\t\tvalueCheck;\n\t\t\n\t\tparams = Object.assign({}, params);\n\t\t\n\t\tparams.verticalNavigation = params.verticalNavigation || \"editor\";\n\t\tparams.placeholderLoading = typeof params.placeholderLoading === \"undefined\" ? \"Searching ...\" : params.placeholderLoading;\n\t\tparams.placeholderEmpty = typeof params.placeholderEmpty === \"undefined\" ? \"No Results Found\" : params.placeholderEmpty;\n\t\tparams.filterDelay = typeof params.filterDelay === \"undefined\" ? 300 : params.filterDelay;\n\t\t\n\t\tparams.emptyValue = Object.keys(params).includes(\"emptyValue\") ? params.emptyValue : \"\";\n\t\t\n\t\tvalueCheck = Object.keys(params).filter(key => valueKeys.includes(key)).length;\n\t\t\n\t\tif(!valueCheck){\n\t\t\tconsole.warn(\"list editor config error - either the values, valuesURL, or valuesLookup option must be set\");\n\t\t}else if(valueCheck > 1){\n\t\t\tconsole.warn(\"list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor\");\n\t\t}\n\t\t\n\t\tif(params.autocomplete){\n\t\t\tif(params.multiselect){\n\t\t\t\tparams.multiselect = false;\n\t\t\t\tconsole.warn(\"list editor config error - multiselect option is not available when autocomplete is enabled\");\n\t\t\t}\n\t\t}else {\n\t\t\tif(params.freetext){\n\t\t\t\tparams.freetext = false;\n\t\t\t\tconsole.warn(\"list editor config error - freetext option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.filterFunc){\n\t\t\t\tparams.filterFunc = false;\n\t\t\t\tconsole.warn(\"list editor config error - filterFunc option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.filterRemote){\n\t\t\t\tparams.filterRemote = false;\n\t\t\t\tconsole.warn(\"list editor config error - filterRemote option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.mask){\n\t\t\t\tparams.mask = false;\n\t\t\t\tconsole.warn(\"list editor config error - mask option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.allowEmpty){\n\t\t\t\tparams.allowEmpty = false;\n\t\t\t\tconsole.warn(\"list editor config error - allowEmpty option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t\t\n\t\t\tif(params.listOnEmpty){\n\t\t\t\tparams.listOnEmpty = false;\n\t\t\t\tconsole.warn(\"list editor config error - listOnEmpty option is only available when autocomplete is enabled\");\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(params.filterRemote && !(typeof params.valuesLookup === \"function\" || params.valuesURL)){\n\t\t\tparams.filterRemote = false;\n\t\t\tconsole.warn(\"list editor config error - filterRemote option should only be used when values list is populated from a remote source\");\n\t\t}\n\t\treturn params;\n\t}\n\t//////////////////////////////////////\n\t////////// Event Handling ////////////\n\t//////////////////////////////////////\n\t\n\t_bindInputEvents(input){\n\t\tinput.addEventListener(\"focus\", this._inputFocus.bind(this));\n\t\tinput.addEventListener(\"click\", this._inputClick.bind(this));\n\t\tinput.addEventListener(\"blur\", this._inputBlur.bind(this));\n\t\tinput.addEventListener(\"keydown\", this._inputKeyDown.bind(this));\n\t\tinput.addEventListener(\"search\", this._inputSearch.bind(this));\n\t\t\n\t\tif(this.params.autocomplete){\n\t\t\tinput.addEventListener(\"keyup\", this._inputKeyUp.bind(this));\n\t\t}\n\t}\n\t\n\t\n\t_inputFocus(e){\n\t\tthis.rebuildOptionsList();\n\t}\n\t\n\t_filter(){\n\t\tif(this.params.filterRemote){\n\t\t\tclearTimeout(this.filterTimeout);\n\t\t\t\n\t\t\tthis.filterTimeout = setTimeout(() => {\n\t\t\t\tthis.rebuildOptionsList();\n\t\t\t}, this.params.filterDelay);\n\t\t}else {\n\t\t\tthis._filterList();\n\t\t}\n\t}\n\t\n\t_inputClick(e){\n\t\te.stopPropagation();\n\t}\n\t\n\t_inputBlur(e){\n\t\tif(this.blurable){\n\t\t\tif(this.popup){\n\t\t\t\tthis.popup.hide();\n\t\t\t}else {\n\t\t\t\tthis._resolveValue(true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_inputSearch(){\n\t\tthis._clearChoices();\n\t}\n\t\n\t_inputKeyDown(e){\n\t\tswitch(e.keyCode){\n\t\t\t\n\t\t\tcase 38: //up arrow\n\t\t\t\tthis._keyUp(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 40: //down arrow\n\t\t\t\tthis._keyDown(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 37: //left arrow\n\t\t\tcase 39: //right arrow\n\t\t\t\tthis._keySide(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 13: //enter\n\t\t\t\tthis._keyEnter();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 27: //escape\n\t\t\t\tthis._keyEsc();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 36: //home\n\t\t\tcase 35: //end\n\t\t\t\tthis._keyHomeEnd(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase 9: //tab\n\t\t\t\tthis._keyTab(e);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tthis._keySelectLetter(e);\n\t\t}\n\t}\n\t\n\t_inputKeyUp(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 38: //up arrow\n\t\t\tcase 37: //left arrow\n\t\t\tcase 39: //up arrow\n\t\t\tcase 40: //right arrow\n\t\t\tcase 13: //enter\n\t\t\tcase 27: //escape\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tthis._keyAutoCompLetter(e);\n\t\t}\n\t}\n\t\n\t_preventPopupBlur(){\n\t\tif(this.popup){\n\t\t\tthis.popup.blockHide();\n\t\t}\n\t\t\n\t\tsetTimeout(() =>{\n\t\t\tif(this.popup){\n\t\t\t\tthis.popup.restoreHide();\n\t\t\t}\n\t\t}, 10);\n\t}\n\t\n\t_preventBlur(){\n\t\tthis.blurable = false;\n\t\t\n\t\tsetTimeout(() =>{\n\t\t\tthis.blurable = true;\n\t\t}, 10);\n\t}\n\t\n\t//////////////////////////////////////\n\t//////// Keyboard Navigation /////////\n\t//////////////////////////////////////\n\t\n\t_keyTab(e){\n\t\tif(this.params.autocomplete && this.lastAction === \"typing\"){\n\t\t\tthis._resolveValue(true);\n\t\t}else {\n\t\t\tif(this.focusedItem){\n\t\t\t\tthis._chooseItem(this.focusedItem, true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keyUp(e){\n\t\tvar index = this.displayItems.indexOf(this.focusedItem);\n\t\t\n\t\tif(this.params.verticalNavigation == \"editor\" || (this.params.verticalNavigation == \"hybrid\" && index)){\n\t\t\te.stopImmediatePropagation();\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tif(index > 0){\n\t\t\t\tthis._focusItem(this.displayItems[index - 1]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keyDown(e){\n\t\tvar index = this.displayItems.indexOf(this.focusedItem);\n\t\t\n\t\tif(this.params.verticalNavigation == \"editor\" || (this.params.verticalNavigation == \"hybrid\" && index < this.displayItems.length - 1)){\n\t\t\te.stopImmediatePropagation();\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tif(index < this.displayItems.length - 1){\n\t\t\t\tif(index == -1){\n\t\t\t\t\tthis._focusItem(this.displayItems[0]);\n\t\t\t\t}else {\n\t\t\t\t\tthis._focusItem(this.displayItems[index + 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keySide(e){\n\t\tif(!this.params.autocomplete){\n\t\t\te.stopImmediatePropagation();\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\t\n\t_keyEnter(e){\n\t\tif(this.params.autocomplete && this.lastAction === \"typing\"){\n\t\t\tthis._resolveValue(true);\n\t\t}else {\n\t\t\tif(this.focusedItem){\n\t\t\t\tthis._chooseItem(this.focusedItem);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keyEsc(e){\n\t\tthis._cancel();\n\t}\n\t\n\t_keyHomeEnd(e){\n\t\tif(this.params.autocomplete){\n\t\t\t//prevent table navigation while using input element\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t}\n\t\n\t_keySelectLetter(e){\n\t\tif(!this.params.autocomplete){\n\t\t\t// if(this.edit.currentCell === false){\n\t\t\te.preventDefault();\n\t\t\t// }\n\t\t\t\n\t\t\tif(e.keyCode >= 38 && e.keyCode <= 90){\n\t\t\t\tthis._scrollToValue(e.keyCode);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_keyAutoCompLetter(e){\n\t\tthis._filter();\n\t\tthis.lastAction = \"typing\";\n\t\tthis.typing = true;\n\t}\n\t\n\t\n\t_scrollToValue(char){\n\t\tclearTimeout(this.filterTimeout);\n\t\t\n\t\tvar character = String.fromCharCode(char).toLowerCase();\n\t\tthis.filterTerm += character.toLowerCase();\n\t\t\n\t\tvar match = this.displayItems.find((item) => {\n\t\t\treturn typeof item.label !== \"undefined\" && item.label.toLowerCase().startsWith(this.filterTerm);\n\t\t});\n\t\t\n\t\tif(match){\n\t\t\tthis._focusItem(match);\n\t\t}\n\t\t\n\t\tthis.filterTimeout = setTimeout(() => {\n\t\t\tthis.filterTerm = \"\";\n\t\t}, 800);\n\t}\n\t\n\t_focusItem(item){\n\t\tthis.lastAction = \"focus\";\n\t\t\n\t\tif(this.focusedItem && this.focusedItem.element){\n\t\t\tthis.focusedItem.element.classList.remove(\"focused\");\n\t\t}\n\t\t\n\t\tthis.focusedItem = item;\n\t\t\n\t\tif(item && item.element){\n\t\t\titem.element.classList.add(\"focused\");\n\t\t\titem.element.scrollIntoView({behavior: 'smooth', block: 'nearest', inline: 'start'});\n\t\t}\n\t}\n\t\n\t\n\t//////////////////////////////////////\n\t/////// Data List Generation /////////\n\t//////////////////////////////////////\n\theaderFilterInitialListGen(){\n\t\tthis._generateOptions(true);\n\t}\n\t\n\trebuildOptionsList(){\n\t\tthis._generateOptions()\n\t\t\t.then(this._sortOptions.bind(this))\n\t\t\t.then(this._buildList.bind(this))\n\t\t\t.then(this._showList.bind(this))\n\t\t\t.catch((e) => {\n\t\t\t\tif(!Number.isInteger(e)){\n\t\t\t\t\tconsole.error(\"List generation error\", e);\n\t\t\t\t}\n\t\t\t});\n\t}\n\t\n\t_filterList(){\n\t\tthis._buildList(this._filterOptions());\n\t\tthis._showList();\n\t}\n\t\n\t_generateOptions(silent){\n\t\tvar values = [];\n\t\tvar iteration = ++ this.listIteration;\n\t\t\n\t\tthis.filtered = false;\n\t\t\n\t\tif(this.params.values){\n\t\t\tvalues = this.params.values;\n\t\t}else if (this.params.valuesURL){\n\t\t\tvalues = this._ajaxRequest(this.params.valuesURL, this.input.value);\n\t\t}else {\n\t\t\tif(typeof this.params.valuesLookup === \"function\"){\n\t\t\t\tvalues = this.params.valuesLookup(this.cell, this.input.value);\n\t\t\t}else if(this.params.valuesLookup){\n\t\t\t\tvalues = this._uniqueColumnValues(this.params.valuesLookupField);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(values instanceof Promise){\n\t\t\tif(!silent){\n\t\t\t\tthis._addPlaceholder(this.params.placeholderLoading);\n\t\t\t}\n\t\t\t\n\t\t\treturn values.then()\n\t\t\t\t.then((responseValues) => {\n\t\t\t\t\tif(this.listIteration === iteration){\n\t\t\t\t\t\treturn this._parseList(responseValues);\n\t\t\t\t\t}else {\n\t\t\t\t\t\treturn Promise.reject(iteration);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}else {\n\t\t\treturn Promise.resolve(this._parseList(values));\n\t\t}\n\t}\n\t\n\t_addPlaceholder(contents){\n\t\tvar placeholder = document.createElement(\"div\");\n\t\t\n\t\tif(typeof contents === \"function\"){\n\t\t\tcontents = contents(this.cell.getComponent(), this.listEl);\n\t\t}\n\t\t\n\t\tif(contents){\n\t\t\tthis._clearList();\n\t\t\t\n\t\t\tif(contents instanceof HTMLElement){\n\t\t\t\tplaceholder = contents;\n\t\t\t}else {\n\t\t\t\tplaceholder.classList.add(\"tabulator-edit-list-placeholder\");\n\t\t\t\tplaceholder.innerHTML = contents;\n\t\t\t}\n\t\t\t\n\t\t\tthis.listEl.appendChild(placeholder);\n\t\t\t\n\t\t\tthis._showList();\n\t\t}\n\t}\n\t\n\t_ajaxRequest(url, term){\n\t\tvar params = this.params.filterRemote ? {term:term} : {};\n\t\turl = urlBuilder(url, {}, params);\n\t\t\n\t\treturn fetch(url)\n\t\t\t.then((response)=>{\n\t\t\t\tif(response.ok) {\n\t\t\t\t\treturn response.json()\n\t\t\t\t\t\t.catch((error)=>{\n\t\t\t\t\t\t\tconsole.warn(\"List Ajax Load Error - Invalid JSON returned\", error);\n\t\t\t\t\t\t\treturn Promise.reject(error);\n\t\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tconsole.error(\"List Ajax Load Error - Connection Error: \" + response.status, response.statusText);\n\t\t\t\t\treturn Promise.reject(response);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error)=>{\n\t\t\t\tconsole.error(\"List Ajax Load Error - Connection Error: \", error);\n\t\t\t\treturn Promise.reject(error);\n\t\t\t});\n\t}\n\t\n\t_uniqueColumnValues(field){\n\t\tvar output = {},\n\t\tdata = this.table.getData(this.params.valuesLookup),\n\t\tcolumn;\n\t\t\n\t\tif(field){\n\t\t\tcolumn = this.table.columnManager.getColumnByField(field);\n\t\t}else {\n\t\t\tcolumn = this.cell.getColumn()._getSelf();\n\t\t}\n\t\t\n\t\tif(column){\n\t\t\tdata.forEach((row) => {\n\t\t\t\tvar val = column.getFieldValue(row);\n\t\t\t\t\n\t\t\t\tif(!this._emptyValueCheck(val)){\n\t\t\t\t\tif(this.params.multiselect && Array.isArray(val)){\n\t\t\t\t\t\tval.forEach((item) => {\n\t\t\t\t\t\t\tif(!this._emptyValueCheck(item)){\n\t\t\t\t\t\t\t\toutput[item] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\toutput[val] = true;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\tconsole.warn(\"unable to find matching column to create select lookup list:\", field);\n\t\t\toutput = [];\n\t\t}\n\t\t\n\t\treturn Object.keys(output);\n\t}\n\n\t_emptyValueCheck(value){\n\t\treturn value === null || typeof value === \"undefined\" || value === \"\";\n\t}\n\t\n\t_parseList(inputValues){\n\t\tvar data = [];\n\t\t\n\t\tif(!Array.isArray(inputValues)){\n\t\t\tinputValues = Object.entries(inputValues).map(([key, value]) => {\n\t\t\t\treturn {\n\t\t\t\t\tlabel:value,\n\t\t\t\t\tvalue:key,\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t\t\n\t\tinputValues.forEach((value) => {\n\t\t\tif(typeof value !== \"object\"){\n\t\t\t\tvalue = {\n\t\t\t\t\tlabel:value,\n\t\t\t\t\tvalue:value,\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tthis._parseListItem(value, data, 0);\n\t\t});\n\t\t\n\t\tif(!this.currentItems.length && this.params.freetext){\n\t\t\tthis.input.value = this.initialValues;\n\t\t\tthis.typing = true;\n\t\t\tthis.lastAction = \"typing\";\n\t\t}\n\t\t\n\t\tthis.data = data;\n\t\t\n\t\treturn data;    \n\t}\n\t\n\t_parseListItem(option, data, level){\n\t\tvar item = {};\n\t\t\n\t\tif(option.options){\n\t\t\titem = this._parseListGroup(option, level + 1);\n\t\t}else {\n\t\t\titem = {\n\t\t\t\tlabel:option.label,\n\t\t\t\tvalue:option.value,\n\t\t\t\titemParams:option.itemParams,\n\t\t\t\telementAttributes: option.elementAttributes,\n\t\t\t\telement:false,\n\t\t\t\tselected:false,\n\t\t\t\tvisible:true,\n\t\t\t\tlevel:level,\n\t\t\t\toriginal:option,\n\t\t\t};\n\t\t\t\n\t\t\tif(this.initialValues && this.initialValues.indexOf(option.value) > -1){\n\t\t\t\tthis._chooseItem(item, true);\n\t\t\t}\n\t\t}\n\t\t\n\t\tdata.push(item);\n\t}\n\t\n\t_parseListGroup(option, level){\n\t\tvar item = {\n\t\t\tlabel:option.label,\n\t\t\tgroup:true,\n\t\t\titemParams:option.itemParams,\n\t\t\telementAttributes:option.elementAttributes,\n\t\t\telement:false,\n\t\t\tvisible:true,\n\t\t\tlevel:level,\n\t\t\toptions:[],\n\t\t\toriginal:option,\n\t\t};\n\t\t\n\t\toption.options.forEach((child) => {\n\t\t\tthis._parseListItem(child, item.options, level);\n\t\t});\n\t\t\n\t\treturn item;\n\t}\n\t\n\t_sortOptions(options){\n\t\tvar sorter;\n\t\t\n\t\tif(this.params.sort){\n\t\t\tsorter = typeof this.params.sort === \"function\" ? this.params.sort : this._defaultSortFunction.bind(this);\n\t\t\t\n\t\t\tthis._sortGroup(sorter, options);\n\t\t}\n\t\t\n\t\treturn options;\n\t}\n\t\n\t_sortGroup(sorter, options){\n\t\toptions.sort((a,b) => {\n\t\t\treturn sorter(a.label, b.label, a.value, b.value, a.original, b.original);\n\t\t});\n\t\t\n\t\toptions.forEach((option) => {\n\t\t\tif(option.group){\n\t\t\t\tthis._sortGroup(sorter, option.options);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t_defaultSortFunction(as, bs){\n\t\tvar a, b, a1, b1, i= 0, L, rx = /(\\d+)|(\\D+)/g, rd = /\\d/;\n\t\tvar emptyAlign = 0;\n\t\t\n\t\tif(this.params.sort === \"desc\"){\n\t\t\t[as, bs] = [bs, as];\n\t\t}\n\t\t\n\t\t//handle empty values\n\t\tif(!as && as!== 0){\n\t\t\temptyAlign =  !bs && bs!== 0 ? 0 : -1;\n\t\t}else if(!bs && bs!== 0){\n\t\t\temptyAlign =  1;\n\t\t}else {\n\t\t\tif(isFinite(as) && isFinite(bs)) return as - bs;\n\t\t\ta = String(as).toLowerCase();\n\t\t\tb = String(bs).toLowerCase();\n\t\t\tif(a === b) return 0;\n\t\t\tif(!(rd.test(a) && rd.test(b))) return a > b ? 1 : -1;\n\t\t\ta = a.match(rx);\n\t\t\tb = b.match(rx);\n\t\t\tL = a.length > b.length ? b.length : a.length;\n\t\t\twhile(i < L){\n\t\t\t\ta1= a[i];\n\t\t\t\tb1= b[i++];\n\t\t\t\tif(a1 !== b1){\n\t\t\t\t\tif(isFinite(a1) && isFinite(b1)){\n\t\t\t\t\t\tif(a1.charAt(0) === \"0\") a1 = \".\" + a1;\n\t\t\t\t\t\tif(b1.charAt(0) === \"0\") b1 = \".\" + b1;\n\t\t\t\t\t\treturn a1 - b1;\n\t\t\t\t\t}\n\t\t\t\t\telse return a1 > b1 ? 1 : -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn a.length > b.length;\n\t\t}\n\t\t\n\t\treturn emptyAlign;\n\t}\n\t\n\t_filterOptions(){\n\t\tvar filterFunc = this.params.filterFunc || this._defaultFilterFunc,\n\t\tterm = this.input.value;\n\t\t\n\t\tif(term){\n\t\t\tthis.filtered = true;\n\t\t\t\n\t\t\tthis.data.forEach((item) => {\n\t\t\t\tthis._filterItem(filterFunc, term, item);\n\t\t\t});\n\t\t}else {\n\t\t\tthis.filtered = false;\n\t\t}\n\t\t\n\t\treturn this.data;\n\t}\n\t\n\t_filterItem(func, term, item){\n\t\tvar matches = false;\n\t\t\n\t\tif(!item.group){\n\t\t\titem.visible = func(term, item.label, item.value, item.original);\n\t\t}else {\n\t\t\titem.options.forEach((option) => {\n\t\t\t\tif(this._filterItem(func, term, option)){\n\t\t\t\t\tmatches = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\titem.visible = matches;\n\t\t}\n\t\t\n\t\treturn item.visible;\n\t}\n\t\n\t_defaultFilterFunc(term, label, value, item){\n\t\tterm = String(term).toLowerCase();\n\t\t\n\t\tif(label !== null && typeof label !== \"undefined\"){\n\t\t\tif(String(label).toLowerCase().indexOf(term) > -1 || String(value).toLowerCase().indexOf(term) > -1){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\t//////////////////////////////////////\n\t/////////// Display List /////////////\n\t//////////////////////////////////////\n\t\n\t_clearList(){\n\t\twhile(this.listEl.firstChild) this.listEl.removeChild(this.listEl.firstChild);\n\t\t\n\t\tthis.displayItems = [];\n\t}\n\t\n\t_buildList(data){\n\t\tthis._clearList();\n\t\t\n\t\tdata.forEach((option) => {\n\t\t\tthis._buildItem(option);\n\t\t});\n\t\t\n\t\tif(!this.displayItems.length){\n\t\t\tthis._addPlaceholder(this.params.placeholderEmpty);\n\t\t}  \n\t}\n\t\n\t_buildItem(item){\n\t\tvar el = item.element,\n\t\tcontents;\n\t\t\n\t\tif(!this.filtered || item.visible){\n\t\t\t\n\t\t\tif(!el){\n\t\t\t\tel = document.createElement(\"div\");\n\t\t\t\tel.tabIndex = 0;\n\t\t\t\t\n\t\t\t\tcontents = this.params.itemFormatter ? this.params.itemFormatter(item.label, item.value, item.original, el) : item.label;\n\t\t\t\t\n\t\t\t\tif(contents instanceof HTMLElement){\n\t\t\t\t\tel.appendChild(contents);\n\t\t\t\t}else {\n\t\t\t\t\tel.innerHTML = contents;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(item.group){\n\t\t\t\t\tel.classList.add(\"tabulator-edit-list-group\");\n\t\t\t\t}else {\n\t\t\t\t\tel.classList.add(\"tabulator-edit-list-item\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tel.classList.add(\"tabulator-edit-list-group-level-\" + item.level);\n\t\t\t\t\n\t\t\t\tif(item.elementAttributes && typeof item.elementAttributes == \"object\"){\n\t\t\t\t\tfor (let key in item.elementAttributes){\n\t\t\t\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\t\t\tel.setAttribute(key, this.input.getAttribute(key) + item.elementAttributes[\"+\" + key]);\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tel.setAttribute(key, item.elementAttributes[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(item.group){\n\t\t\t\t\tel.addEventListener(\"click\", this._groupClick.bind(this, item));\n\t\t\t\t}else {\n\t\t\t\t\tel.addEventListener(\"click\", this._itemClick.bind(this, item));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tel.addEventListener(\"mousedown\", this._preventBlur.bind(this));\n\t\t\t\t\n\t\t\t\titem.element = el;\n\t\t\t}\n\t\t\t\n\t\t\tthis._styleItem(item);\n\t\t\t\n\t\t\tthis.listEl.appendChild(el);\n\t\t\t\n\t\t\tif(item.group){\n\t\t\t\titem.options.forEach((option) => {\n\t\t\t\t\tthis._buildItem(option);\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tthis.displayItems.push(item);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_showList(){\n\t\tvar startVis = this.popup && this.popup.isVisible();\n\t\t\n\t\tif(this.input.parentNode){\n\t\t\tif(this.params.autocomplete && this.input.value === \"\" && !this.params.listOnEmpty){\n\t\t\t\tif(this.popup){\n\t\t\t\t\tthis.popup.hide(true);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tthis._setListWidth();\n\t\t\t\n\t\t\tif(!this.popup){\n\t\t\t\tthis.popup = this.edit.popup(this.listEl);\n\t\t\t}\n\t\t\t\n\t\t\tthis.popup.show(this.cell.getElement(), \"bottom\");\n\t\t\t\n\t\t\tif(!startVis){\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.popup.hideOnBlur(this._resolveValue.bind(this, true));\n\t\t\t\t}, 10);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_styleItem(item){\n\t\tif(item && item.element){\n\t\t\tif(item.selected){\n\t\t\t\titem.element.classList.add(\"active\");\n\t\t\t}else {\n\t\t\t\titem.element.classList.remove(\"active\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//////////////////////////////////////\n\t///////// User Interaction ///////////\n\t//////////////////////////////////////\n\t\n\t_itemClick(item, e){\n\t\te.stopPropagation();\n\t\t\n\t\tthis._chooseItem(item);\n\t}\n\t\n\t_groupClick(item, e){\n\t\te.stopPropagation();\n\t}\n\t\n\t\n\t//////////////////////////////////////\n\t////// Current Item Management ///////\n\t//////////////////////////////////////\n\t\n\t_cancel(){\n\t\tthis.popup.hide(true);\n\t\tthis.actions.cancel();\n\t}\n\t\n\t_clearChoices(){\n\t\tthis.typing = true;\n\t\t\n\t\tthis.currentItems.forEach((item) => {\n\t\t\titem.selected = false;\n\t\t\tthis._styleItem(item);\n\t\t});\n\t\t\n\t\tthis.currentItems = [];\n\t\t\n\t\tthis.focusedItem = null;\n\t}\n\t\n\t_chooseItem(item, silent){\n\t\tvar index;\n\t\t\n\t\tthis.typing = false;\n\t\t\n\t\tif(this.params.multiselect){\n\t\t\tindex = this.currentItems.indexOf(item);\n\t\t\t\n\t\t\tif(index > -1){\n\t\t\t\tthis.currentItems.splice(index, 1);\n\t\t\t\titem.selected = false;\n\t\t\t}else {\n\t\t\t\tthis.currentItems.push(item);\n\t\t\t\titem.selected = true;\n\t\t\t}\n\t\t\t\n\t\t\tthis.input.value = this.currentItems.map(item => item.label).join(\",\");\n\t\t\t\n\t\t\tthis._styleItem(item);\n\t\t\t\n\t\t}else {\n\t\t\tthis.currentItems = [item];\n\t\t\titem.selected = true;\n\t\t\t\n\t\t\tthis.input.value = item.label;\n\t\t\t\n\t\t\tthis._styleItem(item);\n\t\t\t\n\t\t\tif(!silent){\n\t\t\t\tthis._resolveValue();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._focusItem(item);\n\t}\n\t\n\t_resolveValue(blur){\n\t\tvar output, initialValue;\n\t\t\n\t\tif(this.popup){\n\t\t\tthis.popup.hide(true);\n\t\t}\n\t\t\n\t\tif(this.params.multiselect){\n\t\t\toutput = this.currentItems.map(item => item.value);\n\t\t}else {\n\t\t\tif(blur && this.params.autocomplete && this.typing){\n\t\t\t\tif(this.params.freetext || (this.params.allowEmpty && this.input.value === \"\")){\n\t\t\t\t\toutput = this.input.value;\n\t\t\t\t}else {\n\t\t\t\t\tthis.actions.cancel();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(this.currentItems[0]){\n\t\t\t\t\toutput = this.currentItems[0].value;\n\t\t\t\t}else {\n\t\t\t\t\tinitialValue = Array.isArray(this.initialValues) ? this.initialValues[0] : this.initialValues;\n\t\t\t\t\t\n\t\t\t\t\tif(initialValue === null || typeof initialValue === \"undefined\" || initialValue === \"\"){\n\t\t\t\t\t\toutput = initialValue;\n\t\t\t\t\t}else {\n\t\t\t\t\t\toutput = this.params.emptyValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(output === \"\"){\n\t\t\toutput = this.params.emptyValue;\n\t\t}\n\t\t\n\t\tthis.actions.success(output);\n\t\t\n\t\tif(this.isFilter){\n\t\t\tthis.initialValues = output && !Array.isArray(output) ? [output] : output;\n\t\t\tthis.currentItems = [];\n\t\t}\n\t}\n\t\n};\n\nfunction list(cell, onRendered, success, cancel, editorParams){\n\tvar list = new Edit$1(this, cell, onRendered, success, cancel, editorParams);\n\n\treturn list.input;\n}\n\n//star rating\nfunction star$1(cell, onRendered, success, cancel, editorParams){\n\tvar self = this,\n\telement = cell.getElement(),\n\tvalue = cell.getValue(),\n\tmaxStars = element.getElementsByTagName(\"svg\").length || 5,\n\tsize = element.getElementsByTagName(\"svg\")[0] ? element.getElementsByTagName(\"svg\")[0].getAttribute(\"width\") : 14,\n\tstars = [],\n\tstarsHolder = document.createElement(\"div\"),\n\tstar = document.createElementNS('http://www.w3.org/2000/svg', \"svg\");\n\n\n\t//change star type\n\tfunction starChange(val){\n\t\tstars.forEach(function(star, i){\n\t\t\tif(i < val){\n\t\t\t\tif(self.table.browser == \"ie\"){\n\t\t\t\t\tstar.setAttribute(\"class\", \"tabulator-star-active\");\n\t\t\t\t}else {\n\t\t\t\t\tstar.classList.replace(\"tabulator-star-inactive\", \"tabulator-star-active\");\n\t\t\t\t}\n\n\t\t\t\tstar.innerHTML = '<polygon fill=\"#488CE9\" stroke=\"#014AAE\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\t\t\t}else {\n\t\t\t\tif(self.table.browser == \"ie\"){\n\t\t\t\t\tstar.setAttribute(\"class\", \"tabulator-star-inactive\");\n\t\t\t\t}else {\n\t\t\t\t\tstar.classList.replace(\"tabulator-star-active\", \"tabulator-star-inactive\");\n\t\t\t\t}\n\n\t\t\t\tstar.innerHTML = '<polygon fill=\"#010155\" stroke=\"#686868\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\t\t\t}\n\t\t});\n\t}\n\n\t//build stars\n\tfunction buildStar(i){\n\n\t\tvar starHolder =  document.createElement(\"span\");\n\t\tvar nextStar = star.cloneNode(true);\n\n\t\tstars.push(nextStar);\n\n\t\tstarHolder.addEventListener(\"mouseenter\", function(e){\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t\tstarChange(i);\n\t\t});\n\n\t\tstarHolder.addEventListener(\"mousemove\", function(e){\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t});\n\n\t\tstarHolder.addEventListener(\"click\", function(e){\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t\tsuccess(i);\n\t\t\telement.blur();\n\t\t});\n\n\t\tstarHolder.appendChild(nextStar);\n\t\tstarsHolder.appendChild(starHolder);\n\n\t}\n\n\t//handle keyboard navigation value change\n\tfunction changeValue(val){\n\t\tvalue = val;\n\t\tstarChange(val);\n\t}\n\n\t//style cell\n\telement.style.whiteSpace = \"nowrap\";\n\telement.style.overflow = \"hidden\";\n\telement.style.textOverflow = \"ellipsis\";\n\n\t//style holding element\n\tstarsHolder.style.verticalAlign = \"middle\";\n\tstarsHolder.style.display = \"inline-block\";\n\tstarsHolder.style.padding = \"4px\";\n\n\t//style star\n\tstar.setAttribute(\"width\", size);\n\tstar.setAttribute(\"height\", size);\n\tstar.setAttribute(\"viewBox\", \"0 0 512 512\");\n\tstar.setAttribute(\"xml:space\", \"preserve\");\n\tstar.style.padding = \"0 1px\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tstarsHolder.setAttribute(key, starsHolder.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tstarsHolder.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//create correct number of stars\n\tfor(var i=1;i<= maxStars;i++){\n\t\tbuildStar(i);\n\t}\n\n\t//ensure value does not exceed number of stars\n\tvalue = Math.min(parseInt(value), maxStars);\n\n\t// set initial styling of stars\n\tstarChange(value);\n\n\tstarsHolder.addEventListener(\"mousemove\", function(e){\n\t\tstarChange(0);\n\t});\n\n\tstarsHolder.addEventListener(\"click\", function(e){\n\t\tsuccess(0);\n\t});\n\n\telement.addEventListener(\"blur\", function(e){\n\t\tcancel();\n\t});\n\n\t//allow key based navigation\n\telement.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 39: //right arrow\n\t\t\t\tchangeValue(value + 1);\n\t\t\t\tbreak;\n\n\t\t\tcase 37: //left arrow\n\t\t\t\tchangeValue(value - 1);\n\t\t\t\tbreak;\n\n\t\t\tcase 13: //enter\n\t\t\t\tsuccess(value);\n\t\t\t\tbreak;\n\n\t\t\tcase 27: //escape\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\treturn starsHolder;\n}\n\n//draggable progress bar\nfunction progress$1(cell, onRendered, success, cancel, editorParams){\n\tvar element = cell.getElement(),\n\tmax = typeof editorParams.max === \"undefined\" ? ((element.getElementsByTagName(\"div\")[0] && element.getElementsByTagName(\"div\")[0].getAttribute(\"max\")) || 100) : editorParams.max,\n\tmin = typeof editorParams.min === \"undefined\" ? ((element.getElementsByTagName(\"div\")[0] && element.getElementsByTagName(\"div\")[0].getAttribute(\"min\")) || 0) : editorParams.min,\n\tpercent = (max - min) / 100,\n\tvalue = cell.getValue() || 0,\n\thandle = document.createElement(\"div\"),\n\tbar = document.createElement(\"div\"),\n\tmouseDrag, mouseDragWidth;\n\n\t//set new value\n\tfunction updateValue(){\n\t\tvar style = window.getComputedStyle(element, null);\n\n\t\tvar calcVal = (percent * Math.round(bar.offsetWidth / ((element.clientWidth - parseInt(style.getPropertyValue(\"padding-left\")) - parseInt(style.getPropertyValue(\"padding-right\")))/100))) + min;\n\t\tsuccess(calcVal);\n\t\telement.setAttribute(\"aria-valuenow\", calcVal);\n\t\telement.setAttribute(\"aria-label\", value);\n\t}\n\n\t//style handle\n\thandle.style.position = \"absolute\";\n\thandle.style.right = \"0\";\n\thandle.style.top = \"0\";\n\thandle.style.bottom = \"0\";\n\thandle.style.width = \"5px\";\n\thandle.classList.add(\"tabulator-progress-handle\");\n\n\t//style bar\n\tbar.style.display = \"inline-block\";\n\tbar.style.position = \"relative\";\n\t// bar.style.top = \"8px\";\n\t// bar.style.bottom = \"8px\";\n\t// bar.style.left = \"4px\";\n\t// bar.style.marginRight = \"4px\";\n\tbar.style.height = \"100%\";\n\tbar.style.backgroundColor = \"#488CE9\";\n\tbar.style.maxWidth = \"100%\";\n\tbar.style.minWidth = \"0%\";\n\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tbar.setAttribute(key, bar.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tbar.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//style cell\n\telement.style.padding = \"4px 4px\";\n\n\t//make sure value is in range\n\tvalue = Math.min(parseFloat(value), max);\n\tvalue = Math.max(parseFloat(value), min);\n\n\t//workout percentage\n\tvalue = Math.round((value - min) / percent);\n\t// bar.style.right = value + \"%\";\n\tbar.style.width = value + \"%\";\n\n\telement.setAttribute(\"aria-valuemin\", min);\n\telement.setAttribute(\"aria-valuemax\", max);\n\n\tbar.appendChild(handle);\n\n\thandle.addEventListener(\"mousedown\", function(e){\n\t\tmouseDrag = e.screenX;\n\t\tmouseDragWidth = bar.offsetWidth;\n\t});\n\n\thandle.addEventListener(\"mouseover\", function(){\n\t\thandle.style.cursor = \"ew-resize\";\n\t});\n\n\telement.addEventListener(\"mousemove\", function(e){\n\t\tif(mouseDrag){\n\t\t\tbar.style.width = (mouseDragWidth + e.screenX - mouseDrag) + \"px\";\n\t\t}\n\t});\n\n\telement.addEventListener(\"mouseup\", function(e){\n\t\tif(mouseDrag){\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\n\t\t\tmouseDrag = false;\n\t\t\tmouseDragWidth = false;\n\n\t\t\tupdateValue();\n\t\t}\n\t});\n\n\t//allow key based navigation\n\telement.addEventListener(\"keydown\", function(e){\n\t\tswitch(e.keyCode){\n\t\t\tcase 39: //right arrow\n\t\t\t\te.preventDefault();\n\t\t\t\tbar.style.width = (bar.clientWidth + element.clientWidth/100) + \"px\";\n\t\t\t\tbreak;\n\n\t\t\tcase 37: //left arrow\n\t\t\t\te.preventDefault();\n\t\t\t\tbar.style.width = (bar.clientWidth - element.clientWidth/100) + \"px\";\n\t\t\t\tbreak;\n\n\t\t\tcase 9: //tab\n\t\t\tcase 13: //enter\n\t\t\t\tupdateValue();\n\t\t\t\tbreak;\n\n\t\t\tcase 27: //escape\n\t\t\t\tcancel();\n\t\t\t\tbreak;\n\n\t\t}\n\t});\n\n\telement.addEventListener(\"blur\", function(){\n\t\tcancel();\n\t});\n\n\treturn bar;\n}\n\n//checkbox\nfunction tickCross$1(cell, onRendered, success, cancel, editorParams){\n\tvar value = cell.getValue(),\n\tinput = document.createElement(\"input\"),\n\ttristate = editorParams.tristate,\n\tindetermValue = typeof editorParams.indeterminateValue === \"undefined\" ? null : editorParams.indeterminateValue,\n\tindetermState = false,\n\ttrueValueSet = Object.keys(editorParams).includes(\"trueValue\"),\n\tfalseValueSet = Object.keys(editorParams).includes(\"falseValue\");\n\t\n\tinput.setAttribute(\"type\", \"checkbox\");\n\tinput.style.marginTop = \"5px\";\n\tinput.style.boxSizing = \"border-box\";\n\t\n\tif(editorParams.elementAttributes && typeof editorParams.elementAttributes == \"object\"){\n\t\tfor (let key in editorParams.elementAttributes){\n\t\t\tif(key.charAt(0) == \"+\"){\n\t\t\t\tkey = key.slice(1);\n\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t}else {\n\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinput.value = value;\n\t\n\tif(tristate && (typeof value === \"undefined\" || value === indetermValue || value === \"\")){\n\t\tindetermState = true;\n\t\tinput.indeterminate = true;\n\t}\n\t\n\tif(this.table.browser != \"firefox\" && this.table.browser != \"safari\"){ //prevent blur issue on mac firefox\n\t\tonRendered(function(){\n\t\t\tif(cell.getType() === \"cell\"){\n\t\t\t\tinput.focus({preventScroll: true});\n\t\t\t}\n\t\t});\n\t}\n\t\n\tinput.checked = trueValueSet ? value === editorParams.trueValue : (value === true || value === \"true\" || value === \"True\" || value === 1);\n\t\n\tfunction setValue(blur){\n\t\tvar checkedValue = input.checked;\n\t\t\n\t\tif(trueValueSet && checkedValue){\n\t\t\tcheckedValue = editorParams.trueValue;\n\t\t}else if(falseValueSet && !checkedValue){\n\t\t\tcheckedValue = editorParams.falseValue;\n\t\t}\n\t\t\n\t\tif(tristate){\n\t\t\tif(!blur){\n\t\t\t\tif(input.checked && !indetermState){\n\t\t\t\t\tinput.checked = false;\n\t\t\t\t\tinput.indeterminate = true;\n\t\t\t\t\tindetermState = true;\n\t\t\t\t\treturn indetermValue;\n\t\t\t\t}else {\n\t\t\t\t\tindetermState = false;\n\t\t\t\t\treturn checkedValue;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(indetermState){\n\t\t\t\t\treturn indetermValue;\n\t\t\t\t}else {\n\t\t\t\t\treturn checkedValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\treturn checkedValue;\n\t\t}\n\t}\n\t\n\t//submit new value on blur\n\tinput.addEventListener(\"change\", function(e){\n\t\tsuccess(setValue());\n\t});\n\n\tinput.addEventListener(\"blur\", function(e){\n\t\tsuccess(setValue(true));\n\t});\n\t\n\t//submit new value on enter\n\tinput.addEventListener(\"keydown\", function(e){\n\t\tif(e.keyCode == 13){\n\t\t\tsuccess(setValue());\n\t\t}\n\t\tif(e.keyCode == 27){\n\t\t\tcancel();\n\t\t}\n\t});\n\t\n\treturn input;\n}\n\nfunction adaptable$1(cell, onRendered, success, cancel, params){\r\n\tvar column = cell._getSelf().column,\r\n\tlookup, editorFunc, editorParams;\r\n    \r\n\tfunction defaultLookup(cell){\r\n\t\tvar value = cell.getValue(),\r\n\t\teditor = \"input\";\r\n        \r\n\t\tswitch(typeof value){\r\n\t\t\tcase \"number\":\r\n\t\t\t\teditor = \"number\";\r\n\t\t\t\tbreak;\r\n            \r\n\t\t\tcase \"boolean\":\r\n\t\t\t\teditor = \"tickCross\";\r\n\t\t\t\tbreak;\r\n            \r\n\t\t\tcase \"string\":\r\n\t\t\t\tif(value.includes(\"\\n\")){\r\n\t\t\t\t\teditor = \"textarea\";\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n        \r\n\t\treturn editor;\r\n\t}\r\n    \r\n\tlookup = params.editorLookup ? params.editorLookup(cell) : defaultLookup(cell);\r\n\r\n\tif(params.paramsLookup){\r\n\t\teditorParams = typeof params.paramsLookup === \"function\" ? params.paramsLookup(lookup, cell) : params.paramsLookup[lookup];\r\n\t}\r\n\r\n\teditorFunc = this.table.modules.edit.lookupEditor(lookup, column);\r\n    \r\n\treturn  editorFunc.call(this, cell, onRendered, success, cancel, editorParams || {});\r\n}\n\nvar defaultEditors = {\n\tinput:input,\n\ttextarea:textarea$1,\n\tnumber:number$1,\n\trange:range,\n\tdate:date$1,\n\ttime:time$1,\n\tdatetime:datetime$2,\n\tlist:list,\n\tstar:star$1,\n\tprogress:progress$1,\n\ttickCross:tickCross$1,\n\tadaptable:adaptable$1,\n};\n\nclass Edit extends Module{\n\n\tstatic moduleName = \"edit\";\n\n\t//load defaults\n\tstatic editors = defaultEditors;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.currentCell = false; //hold currently editing cell\n\t\tthis.mouseClick = false; //hold mousedown state to prevent click binding being overridden by editor opening\n\t\tthis.recursionBlock = false; //prevent focus recursion\n\t\tthis.invalidEdit = false;\n\t\tthis.editedCells = [];\n\t\tthis.convertEmptyValues = false;\n\t\t\n\t\tthis.editors = Edit.editors;\n\t\n\t\tthis.registerTableOption(\"editTriggerEvent\", \"focus\");\n\t\tthis.registerTableOption(\"editorEmptyValue\");\n\t\tthis.registerTableOption(\"editorEmptyValueFunc\", this.emptyValueCheck.bind(this));\n\n\t\tthis.registerColumnOption(\"editable\");\n\t\tthis.registerColumnOption(\"editor\");\n\t\tthis.registerColumnOption(\"editorParams\");\n\t\tthis.registerColumnOption(\"editorEmptyValue\");\n\t\tthis.registerColumnOption(\"editorEmptyValueFunc\");\n\t\t\n\t\tthis.registerColumnOption(\"cellEditing\");\n\t\tthis.registerColumnOption(\"cellEdited\");\n\t\tthis.registerColumnOption(\"cellEditCancelled\");\n\t\t\n\t\tthis.registerTableFunction(\"getEditedCells\", this.getEditedCells.bind(this));\n\t\tthis.registerTableFunction(\"clearCellEdited\", this.clearCellEdited.bind(this));\n\t\tthis.registerTableFunction(\"navigatePrev\", this.navigatePrev.bind(this));\n\t\tthis.registerTableFunction(\"navigateNext\", this.navigateNext.bind(this));\n\t\tthis.registerTableFunction(\"navigateLeft\", this.navigateLeft.bind(this));\n\t\tthis.registerTableFunction(\"navigateRight\", this.navigateRight.bind(this));\n\t\tthis.registerTableFunction(\"navigateUp\", this.navigateUp.bind(this));\n\t\tthis.registerTableFunction(\"navigateDown\", this.navigateDown.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"cell\", \"isEdited\", this.cellIsEdited.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"clearEdited\", this.clearEdited.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"edit\", this.editCell.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"cancelEdit\", this.cellCancelEdit.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"cell\", \"navigatePrev\", this.navigatePrev.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateNext\", this.navigateNext.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateLeft\", this.navigateLeft.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateRight\", this.navigateRight.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateUp\", this.navigateUp.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"navigateDown\", this.navigateDown.bind(this));\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"cell-init\", this.bindEditor.bind(this));\n\t\tthis.subscribe(\"cell-delete\", this.clearEdited.bind(this));\n\t\tthis.subscribe(\"cell-value-changed\", this.updateCellClass.bind(this));\n\t\tthis.subscribe(\"column-layout\", this.initializeColumnCheck.bind(this));\n\t\tthis.subscribe(\"column-delete\", this.columnDeleteCheck.bind(this));\n\t\tthis.subscribe(\"row-deleting\", this.rowDeleteCheck.bind(this));\n\t\tthis.subscribe(\"row-layout\", this.rowEditableCheck.bind(this));\n\t\tthis.subscribe(\"data-refreshing\", this.cancelEdit.bind(this));\n\t\tthis.subscribe(\"clipboard-paste\", this.pasteBlocker.bind(this));\n\t\t\n\t\tthis.subscribe(\"keybinding-nav-prev\", this.navigatePrev.bind(this, undefined));\n\t\tthis.subscribe(\"keybinding-nav-next\", this.keybindingNavigateNext.bind(this));\n\t\t\n\t\t// this.subscribe(\"keybinding-nav-left\", this.navigateLeft.bind(this, undefined));\n\t\t// this.subscribe(\"keybinding-nav-right\", this.navigateRight.bind(this, undefined));\n\t\tthis.subscribe(\"keybinding-nav-up\", this.navigateUp.bind(this, undefined));\n\t\tthis.subscribe(\"keybinding-nav-down\", this.navigateDown.bind(this, undefined));\n\n\t\tif(Object.keys(this.table.options).includes(\"editorEmptyValue\")){\n\t\t\tthis.convertEmptyValues = true;\n\t\t}\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////// Paste Negation //////////\n\t///////////////////////////////////\n\t\n\tpasteBlocker(e){\n\t\tif(this.currentCell){\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t////// Keybinding Functions ///////\n\t///////////////////////////////////\n\t\n\tkeybindingNavigateNext(e){\n\t\tvar cell = this.currentCell,\n\t\tnewRow = this.options(\"tabEndNewRow\");\n\n\t\tif(cell){\n\t\t\tif(!this.navigateNext(cell, e)){\n\t\t\t\tif(newRow){\n\t\t\t\t\tcell.getElement().firstChild.blur();\n\t\t\t\t\t\n\t\t\t\t\tif(!this.invalidEdit){\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(newRow === true){\n\t\t\t\t\t\t\tnewRow = this.table.addRow({});\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tif(typeof newRow == \"function\"){\n\t\t\t\t\t\t\t\tnewRow = this.table.addRow(newRow(cell.row.getComponent()));\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tnewRow = this.table.addRow(Object.assign({}, newRow));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tnewRow.then(() => {\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tcell.getComponent().navigateNext();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Cell Functions //////////\n\t///////////////////////////////////\n\t\n\tcellIsEdited(cell){\n\t\treturn !! cell.modules.edit && cell.modules.edit.edited;\n\t}\n\t\n\tcellCancelEdit(cell){\n\t\tif(cell === this.currentCell){\n\t\t\tthis.table.modules.edit.cancelEdit();\n\t\t}else {\n\t\t\tconsole.warn(\"Cancel Editor Error - This cell is not currently being edited \");\n\t\t}\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\tupdateCellClass(cell){\n\t\tif(this.allowEdit(cell)) {\n\t\t\tcell.getElement().classList.add(\"tabulator-editable\");\n\t\t}\n\t\telse {\n\t\t\tcell.getElement().classList.remove(\"tabulator-editable\");\n\t\t}\n\t}\n\t\n\tclearCellEdited(cells){\n\t\tif(!cells){\n\t\t\tcells = this.table.modules.edit.getEditedCells();\n\t\t}\n\t\t\n\t\tif(!Array.isArray(cells)){\n\t\t\tcells = [cells];\n\t\t}\n\t\t\n\t\tcells.forEach((cell) => {\n\t\t\tthis.table.modules.edit.clearEdited(cell._getSelf());\n\t\t});\n\t}\n\t\n\tnavigatePrev(cell = this.currentCell, e){\n\t\tvar nextCell, prevRow;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tnextCell = this.navigateLeft();\n\t\t\t\n\t\t\tif(nextCell){\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tprevRow = this.table.rowManager.prevDisplayRow(cell.row, true);\n\t\t\t\t\n\t\t\t\tif(prevRow){\n\t\t\t\t\tnextCell = this.findPrevEditableCell(prevRow, prevRow.cells.length);\n\t\t\t\t\t\n\t\t\t\t\tif(nextCell){\n\t\t\t\t\t\tnextCell.getComponent().edit();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateNext(cell = this.currentCell, e){\n\t\tvar nextCell, nextRow;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tnextCell = this.navigateRight();\n\t\t\t\n\t\t\tif(nextCell){\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tnextRow = this.table.rowManager.nextDisplayRow(cell.row, true);\n\t\t\t\t\n\t\t\t\tif(nextRow){\n\t\t\t\t\tnextCell = this.findNextEditableCell(nextRow, -1);\n\t\t\t\t\t\n\t\t\t\t\tif(nextCell){\n\t\t\t\t\t\tnextCell.getComponent().edit();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateLeft(cell = this.currentCell, e){\n\t\tvar index, nextCell;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tindex = cell.getIndex();\n\t\t\tnextCell = this.findPrevEditableCell(cell.row, index);\n\t\t\t\n\t\t\tif(nextCell){\n\t\t\t\tnextCell.getComponent().edit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateRight(cell = this.currentCell, e){\n\t\tvar index, nextCell;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tindex = cell.getIndex();\n\t\t\tnextCell = this.findNextEditableCell(cell.row, index);\n\t\t\t\n\t\t\tif(nextCell){\n\t\t\t\tnextCell.getComponent().edit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateUp(cell = this.currentCell, e){\n\t\tvar index, nextRow;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tindex = cell.getIndex();\n\t\t\tnextRow = this.table.rowManager.prevDisplayRow(cell.row, true);\n\t\t\t\n\t\t\tif(nextRow){\n\t\t\t\tnextRow.cells[index].getComponent().edit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tnavigateDown(cell = this.currentCell, e){\n\t\tvar index, nextRow;\n\t\t\n\t\tif(cell){\n\t\t\t\n\t\t\tif(e){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tindex = cell.getIndex();\n\t\t\tnextRow = this.table.rowManager.nextDisplayRow(cell.row, true);\n\t\t\t\n\t\t\tif(nextRow){\n\t\t\t\tnextRow.cells[index].getComponent().edit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tfindNextEditableCell(row, index){\n\t\tvar nextCell = false;\n\t\t\n\t\tif(index < row.cells.length-1){\n\t\t\tfor(var i = index+1; i < row.cells.length; i++){\n\t\t\t\tlet cell = row.cells[i];\n\t\t\t\t\n\t\t\t\tif(cell.column.modules.edit && Helpers.elVisible(cell.getElement())){\n\t\t\t\t\tlet allowEdit = this.allowEdit(cell);\n\t\t\t\t\t\n\t\t\t\t\tif(allowEdit){\n\t\t\t\t\t\tnextCell = cell;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn nextCell;\n\t}\n\t\n\tfindPrevEditableCell(row, index){\n\t\tvar prevCell = false;\n\t\t\n\t\tif(index > 0){\n\t\t\tfor(var i = index-1; i >= 0; i--){\n\t\t\t\tlet cell = row.cells[i];\n\t\t\t\t\n\t\t\t\tif(cell.column.modules.edit && Helpers.elVisible(cell.getElement())){\n\t\t\t\t\tlet allowEdit = this.allowEdit(cell);\n\t\t\t\t\t\n\t\t\t\t\tif(allowEdit){\n\t\t\t\t\t\tprevCell = cell;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn prevCell;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tinitializeColumnCheck(column){\n\t\tif(typeof column.definition.editor !== \"undefined\"){\n\t\t\tthis.initializeColumn(column);\n\t\t}\n\t}\n\t\n\tcolumnDeleteCheck(column){\n\t\tif(this.currentCell && this.currentCell.column === column){\n\t\t\tthis.cancelEdit();\n\t\t}\n\t}\n\t\n\trowDeleteCheck(row){\n\t\tif(this.currentCell && this.currentCell.row === row){\n\t\t\tthis.cancelEdit();\n\t\t}\n\t}\n\t\n\trowEditableCheck(row){\n\t\trow.getCells().forEach((cell) => {\n\t\t\tif(cell.column.modules.edit && typeof cell.column.modules.edit.check === \"function\"){\n\t\t\t\tthis.updateCellClass(cell);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//initialize column editor\n\tinitializeColumn(column){\n\t\tvar convertEmpty = Object.keys(column.definition).includes(\"editorEmptyValue\");\n\n\t\tvar config = {\n\t\t\teditor:false,\n\t\t\tblocked:false,\n\t\t\tcheck:column.definition.editable,\n\t\t\tparams:column.definition.editorParams || {},\n\t\t\tconvertEmptyValues:convertEmpty,\n\t\t\teditorEmptyValue:column.definition.editorEmptyValue,\n\t\t\teditorEmptyValueFunc:column.definition.editorEmptyValueFunc,\n\t\t};\n\t\t\n\t\t//set column editor\n\t\tconfig.editor = this.lookupEditor(column.definition.editor, column);\n\t\t\n\t\tif(config.editor){\n\t\t\tcolumn.modules.edit = config;\n\t\t}\n\t}\n\n\tlookupEditor(editor, column){\n\t\tvar editorFunc;\n\n\t\tswitch(typeof editor){\n\t\t\tcase \"string\":\n\t\t\t\tif(this.editors[editor]){\n\t\t\t\t\teditorFunc = this.editors[editor];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Editor Error - No such editor found: \", editor);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"function\":\n\t\t\t\teditorFunc = editor;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"boolean\":\n\t\t\t\tif(editor === true){\n\t\t\t\t\tif(typeof column.definition.formatter !== \"function\"){\n\t\t\t\t\t\tif(this.editors[column.definition.formatter]){\n\t\t\t\t\t\t\teditorFunc = this.editors[column.definition.formatter];\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\teditorFunc = this.editors[\"input\"];\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Editor Error - Cannot auto lookup editor for a custom formatter: \", column.definition.formatter);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn editorFunc;\n\t}\n\t\n\tgetCurrentCell(){\n\t\treturn this.currentCell ? this.currentCell.getComponent() : false;\n\t}\n\t\n\tclearEditor(cancel){\n\t\tvar cell = this.currentCell,\n\t\tcellEl;\n\t\t\n\t\tthis.invalidEdit = false;\n\t\t\n\t\tif(cell){\n\t\t\tthis.currentCell = false;\n\t\t\t\n\t\t\tcellEl = cell.getElement();\n\t\t\t\n\t\t\tthis.dispatch(\"edit-editor-clear\", cell, cancel);\n\t\t\t\n\t\t\tcellEl.classList.remove(\"tabulator-editing\");\n\t\t\t\n\t\t\twhile(cellEl.firstChild) cellEl.removeChild(cellEl.firstChild);\n\t\t\t\n\t\t\tcell.row.getElement().classList.remove(\"tabulator-editing\");\n\t\t\t\n\t\t\tcell.table.element.classList.remove(\"tabulator-editing\");\n\t\t}\n\t}\n\t\n\tcancelEdit(){\n\t\tif(this.currentCell){\n\t\t\tvar cell = this.currentCell;\n\t\t\tvar component = this.currentCell.getComponent();\n\t\t\t\n\t\t\tthis.clearEditor(true);\n\t\t\tcell.setValueActual(cell.getValue());\n\t\t\tcell.cellRendered();\n\t\t\t\n\t\t\tif(cell.column.definition.editor == \"textarea\" || cell.column.definition.variableHeight){\n\t\t\t\tcell.row.normalizeHeight(true);\n\t\t\t}\n\t\t\t\n\t\t\tif(cell.column.definition.cellEditCancelled){\n\t\t\t\tcell.column.definition.cellEditCancelled.call(this.table, component);\n\t\t\t}\n\t\t\t\n\t\t\tthis.dispatch(\"edit-cancelled\", cell);\n\t\t\tthis.dispatchExternal(\"cellEditCancelled\", component);\n\t\t}\n\t}\n\t\n\t//return a formatted value for a cell\n\tbindEditor(cell){\n\t\tif(cell.column.modules.edit){\n\t\t\tvar self = this,\n\t\t\telement = cell.getElement(true);\n\t\t\t\n\t\t\tthis.updateCellClass(cell);\n\t\t\telement.setAttribute(\"tabindex\", 0);\n\t\t\t\n\t\t\telement.addEventListener(\"mousedown\", function(e){\n\t\t\t\tif (e.button === 2) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}else {\n\t\t\t\t\tself.mouseClick = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(this.options(\"editTriggerEvent\") === \"dblclick\"){\n\t\t\t\telement.addEventListener(\"dblclick\", function(e){\n\t\t\t\t\tif(!element.classList.contains(\"tabulator-editing\")){\n\t\t\t\t\t\telement.focus({preventScroll: true});\n\t\t\t\t\t\tself.edit(cell, e, false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tif(this.options(\"editTriggerEvent\") === \"focus\" || this.options(\"editTriggerEvent\") === \"click\"){\n\t\t\t\telement.addEventListener(\"click\", function(e){\n\t\t\t\t\tif(!element.classList.contains(\"tabulator-editing\")){\n\t\t\t\t\t\telement.focus({preventScroll: true});\n\t\t\t\t\t\tself.edit(cell, e, false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif(this.options(\"editTriggerEvent\") === \"focus\"){\n\t\t\t\telement.addEventListener(\"focus\", function(e){\n\t\t\t\t\tif(!self.recursionBlock){\n\t\t\t\t\t\tself.edit(cell, e, false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfocusCellNoEvent(cell, block){\n\t\tthis.recursionBlock = true;\n\t\t\n\t\tif(!(block && this.table.browser === \"ie\")){\n\t\t\tcell.getElement().focus({preventScroll: true});\n\t\t}\n\t\t\n\t\tthis.recursionBlock = false;\n\t}\n\t\n\teditCell(cell, forceEdit){\n\t\tthis.focusCellNoEvent(cell);\n\t\tthis.edit(cell, false, forceEdit);\n\t}\n\t\n\tfocusScrollAdjust(cell){\n\t\tif(this.table.rowManager.getRenderMode() == \"virtual\"){\n\t\t\tvar topEdge = this.table.rowManager.element.scrollTop,\n\t\t\tbottomEdge = this.table.rowManager.element.clientHeight + this.table.rowManager.element.scrollTop,\n\t\t\trowEl = cell.row.getElement();\n\t\t\t\n\t\t\tif(rowEl.offsetTop < topEdge){\n\t\t\t\tthis.table.rowManager.element.scrollTop -= (topEdge - rowEl.offsetTop);\n\t\t\t}else {\n\t\t\t\tif(rowEl.offsetTop + rowEl.offsetHeight  > bottomEdge){\n\t\t\t\t\tthis.table.rowManager.element.scrollTop += (rowEl.offsetTop + rowEl.offsetHeight - bottomEdge);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tvar leftEdge = this.table.rowManager.element.scrollLeft,\n\t\t\trightEdge = this.table.rowManager.element.clientWidth + this.table.rowManager.element.scrollLeft,\n\t\t\tcellEl = cell.getElement();\n\t\t\t\n\t\t\tif(this.table.modExists(\"frozenColumns\")){\n\t\t\t\tleftEdge += parseInt(this.table.modules.frozenColumns.leftMargin || 0);\n\t\t\t\trightEdge -= parseInt(this.table.modules.frozenColumns.rightMargin || 0);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.options.renderHorizontal === \"virtual\"){\n\t\t\t\tleftEdge -= parseInt(this.table.columnManager.renderer.vDomPadLeft);\n\t\t\t\trightEdge -= parseInt(this.table.columnManager.renderer.vDomPadLeft);\n\t\t\t}\n\t\t\t\n\t\t\tif(cellEl.offsetLeft < leftEdge){\n\t\t\t\tthis.table.rowManager.element.scrollLeft -= (leftEdge - cellEl.offsetLeft);\n\t\t\t}else {\n\t\t\t\tif(cellEl.offsetLeft + cellEl.offsetWidth  > rightEdge){\n\t\t\t\t\tthis.table.rowManager.element.scrollLeft += (cellEl.offsetLeft + cellEl.offsetWidth - rightEdge);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tallowEdit(cell) {\n\t\tvar check = cell.column.modules.edit ? true : false;\n\t\t\n\t\tif(cell.column.modules.edit){\n\t\t\tswitch(typeof cell.column.modules.edit.check){\n\t\t\t\tcase \"function\":\n\t\t\t\t\tif(cell.row.initialized){\n\t\t\t\t\t\tcheck = cell.column.modules.edit.check(cell.getComponent());\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"string\":\n\t\t\t\t\tcheck = !!cell.row.data[cell.column.modules.edit.check];\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tcheck = cell.column.modules.edit.check;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn check;\n\t}\n\t\n\tedit(cell, e, forceEdit){\n\t\tvar self = this,\n\t\tallowEdit = true,\n\t\trendered = function(){},\n\t\telement = cell.getElement(),\n\t\teditFinished = false,\n\t\tcellEditor, component, params;\n\n\t\t//prevent editing if another cell is refusing to leave focus (eg. validation fail)\n\t\t\n\t\tif(this.currentCell){\n\t\t\tif(!this.invalidEdit && this.currentCell !== cell){\n\t\t\t\tthis.cancelEdit();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t//handle successful value change\n\t\tfunction success(value){\n\t\t\tif(self.currentCell === cell && !editFinished){\n\t\t\t\tvar valid = self.chain(\"edit-success\", [cell, value], true, true);\n\n\t\t\t\tif(valid === true || self.table.options.validationMode === \"highlight\"){\n\n\t\t\t\t\teditFinished = true;\n\n\t\t\t\t\tself.clearEditor();\n\t\t\t\t\t\n\t\t\t\t\tif(!cell.modules.edit){\n\t\t\t\t\t\tcell.modules.edit = {};\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tcell.modules.edit.edited = true;\n\t\t\t\t\t\n\t\t\t\t\tif(self.editedCells.indexOf(cell) == -1){\n\t\t\t\t\t\tself.editedCells.push(cell);\n\t\t\t\t\t}\n\n\t\t\t\t\tvalue = self.transformEmptyValues(value, cell);\n\t\t\t\t\t\n\t\t\t\t\tcell.setValue(value, true);\n\n\t\t\t\t\treturn valid === true;\n\t\t\t\t}else {\n\t\t\t\t\teditFinished = true;\n\t\t\t\t\tself.invalidEdit = true;\n\t\t\t\t\tself.focusCellNoEvent(cell, true);\n\t\t\t\t\trendered();\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\teditFinished = false;\n\t\t\t\t\t}, 10);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t//handle aborted edit\n\t\tfunction cancel(){\n\t\t\t// editFinished = true;\n\n\t\t\tif(self.currentCell === cell && !editFinished){\n\t\t\t\tself.cancelEdit();\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction onRendered(callback){\n\t\t\trendered = callback;\n\t\t}\n\t\t\n\t\tif(!cell.column.modules.edit.blocked){\n\t\t\tif(e){\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t\t\n\t\t\tallowEdit = this.allowEdit(cell);\n\t\t\t\n\t\t\tif(allowEdit || forceEdit){\n\t\t\t\tself.cancelEdit();\n\t\t\t\t\n\t\t\t\tself.currentCell = cell;\n\t\t\t\t\n\t\t\t\tthis.focusScrollAdjust(cell);\n\t\t\t\t\n\t\t\t\tcomponent = cell.getComponent();\n\t\t\t\t\n\t\t\t\tif(this.mouseClick){\n\t\t\t\t\tthis.mouseClick = false;\n\t\t\t\t\t\n\t\t\t\t\tif(cell.column.definition.cellClick){\n\t\t\t\t\t\tcell.column.definition.cellClick.call(this.table, e, component);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(cell.column.definition.cellEditing){\n\t\t\t\t\tcell.column.definition.cellEditing.call(this.table, component);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.dispatch(\"cell-editing\", cell);\n\t\t\t\tthis.dispatchExternal(\"cellEditing\", component);\n\t\t\t\t\n\t\t\t\tparams = typeof cell.column.modules.edit.params === \"function\" ? cell.column.modules.edit.params(component) : cell.column.modules.edit.params;\n\t\t\t\t\n\t\t\t\tcellEditor = cell.column.modules.edit.editor.call(self, component, onRendered, success, cancel, params);\n\t\t\t\t\n\t\t\t\t//if editor returned, add to DOM, if false, abort edit\n\t\t\t\tif(this.currentCell && cellEditor !== false){\n\t\t\t\t\tif(cellEditor instanceof Node){\n\t\t\t\t\t\telement.classList.add(\"tabulator-editing\");\n\t\t\t\t\t\tcell.row.getElement().classList.add(\"tabulator-editing\");\n\t\t\t\t\t\tcell.table.element.classList.add(\"tabulator-editing\");\n\t\t\t\t\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\t\t\t\t\t\telement.appendChild(cellEditor);\n\t\t\t\t\t\t\n\t\t\t\t\t\t//trigger onRendered Callback\n\t\t\t\t\t\trendered();\n\t\t\t\t\t\t\n\t\t\t\t\t\t//prevent editing from triggering rowClick event\n\t\t\t\t\t\tvar children = element.children;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\t\t\t\tchildren[i].addEventListener(\"click\", function(e){\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Edit Error - Editor should return an instance of Node, the editor returned:\", cellEditor);\n\t\t\t\t\t\tthis.blur(element);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tthis.blur(element);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tthis.mouseClick = false;\n\t\t\t\tthis.blur(element);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else {\n\t\t\tthis.mouseClick = false;\n\t\t\tthis.blur(element);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\temptyValueCheck(value){\n\t\treturn value === \"\" || value === null || typeof value === \"undefined\";\n\t}\n\n\ttransformEmptyValues(value, cell){\n\t\tvar mod = cell.column.modules.edit, \n\t\tconvert = mod.convertEmptyValues || this.convertEmptyValues,\n\t\tcheckFunc;\n\t\t\n\t\tif(convert){\n\t\t\tcheckFunc = mod.editorEmptyValueFunc || this.options(\"editorEmptyValueFunc\");\n\n\t\t\tif(checkFunc && checkFunc(value)){\n\t\t\t\tvalue = mod.convertEmptyValues ? mod.editorEmptyValue : this.options(\"editorEmptyValue\");\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn value;\n\t}\n\t\n\tblur(element){\n\t\tif(!this.confirm(\"edit-blur\", [element]) ){\n\t\t\telement.blur();\n\t\t}\n\t}\n\t\n\tgetEditedCells(){\n\t\tvar output = [];\n\t\t\n\t\tthis.editedCells.forEach((cell) => {\n\t\t\toutput.push(cell.getComponent());\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tclearEdited(cell){\n\t\tvar editIndex;\n\t\t\n\t\tif(cell.modules.edit && cell.modules.edit.edited){\n\t\t\tcell.modules.edit.edited = false;\n\t\t\t\n\t\t\tthis.dispatch(\"edit-edited-clear\", cell);\n\t\t}\n\t\t\n\t\teditIndex = this.editedCells.indexOf(cell);\n\t\t\n\t\tif(editIndex > -1){\n\t\t\tthis.editedCells.splice(editIndex, 1);\n\t\t}\n\t}\n}\n\nclass ExportRow{\n\tconstructor(type, columns, component, indent){\n\t\tthis.type = type;\n\t\tthis.columns = columns;\n\t\tthis.component = component || false;\n\t\tthis.indent = indent || 0;\n\t}\n}\n\nclass ExportColumn{\n\tconstructor(value, component, width, height, depth){\n\t\tthis.value = value;\n\t\tthis.component = component || false;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.depth = depth;\n\t}\n}\n\nvar columnLookups$1 = {\r\n\r\n};\n\nvar rowLookups$1 = {\r\n\tvisible:function(){\r\n\t\treturn this.rowManager.getVisibleRows(false, true);\r\n\t},\r\n\tall:function(){\r\n\t\treturn this.rowManager.rows;\r\n\t},\r\n\tselected:function(){\r\n\t\treturn this.modules.selectRow.selectedRows;\r\n\t},\r\n\tactive:function(){\r\n\t\tif(this.options.pagination){\r\n\t\t\treturn this.rowManager.getDisplayRows(this.rowManager.displayRows.length - 2);\r\n\t\t}else {\r\n\t\t\treturn this.rowManager.getDisplayRows();\r\n\t\t}\r\n\t},\r\n};\n\nclass Export extends Module{\n\n\tstatic moduleName = \"export\";\n\n\tstatic columnLookups = columnLookups$1;\n\tstatic rowLookups = rowLookups$1;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.config = {};\n\t\tthis.cloneTableStyle = true;\n\t\tthis.colVisProp = \"\";\n\t\tthis.colVisPropAttach = \"\";\n\t\t\n\t\tthis.registerTableOption(\"htmlOutputConfig\", false); //html output config\n\t\t\n\t\tthis.registerColumnOption(\"htmlOutput\");\n\t\tthis.registerColumnOption(\"titleHtmlOutput\");\n\t}\n\t\n\tinitialize(){\n\t\tthis.registerTableFunction(\"getHtml\", this.getHtml.bind(this));\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tgenerateExportList(config, style, range, colVisProp){\n\t\tvar headers, body, columns, colLookup;\n\n\t\tthis.cloneTableStyle = style;\n\t\tthis.config = config || {};\n\t\tthis.colVisProp = colVisProp;\n\t\tthis.colVisPropAttach = this.colVisProp.charAt(0).toUpperCase() + this.colVisProp.slice(1);\n\n\t\tcolLookup = Export.columnLookups[range];\n\n\t\tif(colLookup){\n\t\t\tcolumns = colLookup.call(this.table);\n\t\t\tcolumns = columns.filter(col => this.columnVisCheck(col));\n\t\t}\n\n\t\theaders = this.config.columnHeaders !== false ? this.headersToExportRows(this.generateColumnGroupHeaders(columns)) : [];\n\n\t\tif(columns){\n\t\t\tcolumns = columns.map(col => col.getComponent());\n\t\t}\n\t\t\n\t\tbody = this.bodyToExportRows(this.rowLookup(range), columns);\n\n\t\treturn headers.concat(body);\n\t}\n\t\n\tgenerateTable(config, style, range, colVisProp){\n\t\tvar list = this.generateExportList(config, style, range, colVisProp);\n\t\t\n\t\treturn this.generateTableElement(list);\n\t}\n\t\n\trowLookup(range){\n\t\tvar rows = [], \n\t\trowLookup;\n\t\t\n\t\tif(typeof range == \"function\"){\n\t\t\trange.call(this.table).forEach((row) =>{\n\t\t\t\trow = this.table.rowManager.findRow(row);\n\t\t\t\t\n\t\t\t\tif(row){\n\t\t\t\t\trows.push(row);\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\trowLookup = Export.rowLookups[range] || Export.rowLookups[\"active\"];\n\n\t\t\trows = rowLookup.call(this.table);\n\t\t}\n\t\t\n\t\treturn Object.assign([], rows);\n\t}\n\t\n\tgenerateColumnGroupHeaders(columns){\n\t\tvar output = [];\n\t\t\n\t\tif (!columns) {\n\t\t\tcolumns = this.config.columnGroups !== false ? this.table.columnManager.columns : this.table.columnManager.columnsByIndex;\n\t\t}\n\t\t\n\t\tcolumns.forEach((column) => {\n\t\t\tvar colData = this.processColumnGroup(column);\n\t\t\t\n\t\t\tif(colData){\n\t\t\t\toutput.push(colData);\n\t\t\t}\n\t\t});\n\n\n\n\t\treturn output;\n\t}\n\t\n\tprocessColumnGroup(column){\n\t\tvar subGroups = column.columns,\n\t\tmaxDepth = 0,\n\t\ttitle = column.definition[\"title\" + (this.colVisPropAttach)] || column.definition.title;\n\t\t\n\t\tvar groupData = {\n\t\t\ttitle:title,\n\t\t\tcolumn:column,\n\t\t\tdepth:1,\n\t\t};\n\t\t\n\t\tif(subGroups.length){\n\t\t\tgroupData.subGroups = [];\n\t\t\tgroupData.width = 0;\n\t\t\t\n\t\t\tsubGroups.forEach((subGroup) => {\n\t\t\t\tvar subGroupData = this.processColumnGroup(subGroup);\n\t\t\t\t\n\t\t\t\tif(subGroupData){\n\t\t\t\t\tgroupData.width += subGroupData.width;\n\t\t\t\t\tgroupData.subGroups.push(subGroupData);\n\t\t\t\t\t\n\t\t\t\t\tif(subGroupData.depth > maxDepth){\n\t\t\t\t\t\tmaxDepth = subGroupData.depth;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tgroupData.depth += maxDepth;\n\t\t\t\n\t\t\tif(!groupData.width){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else {\n\t\t\tif(this.columnVisCheck(column)){\n\t\t\t\tgroupData.width = 1;\n\t\t\t}else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn groupData;\n\t}\n\t\n\tcolumnVisCheck(column){\n\t\tvar visProp = column.definition[this.colVisProp];\n\n\t\tif(this.config.rowHeaders === false && column.isRowHeader){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(typeof visProp === \"function\"){\n\t\t\tvisProp = visProp.call(this.table, column.getComponent());\n\t\t}\n\n\t\tif(visProp === false || visProp === true){\n\t\t\treturn visProp;\n\t\t}\n\n\t\treturn column.visible && column.field;\n\t}\n\t\n\theadersToExportRows(columns){\n\t\tvar headers = [],\n\t\theaderDepth = 0,\n\t\texportRows = [];\n\t\t\n\t\tfunction parseColumnGroup(column, level){\n\t\t\t\n\t\t\tvar depth = headerDepth - level;\n\t\t\t\n\t\t\tif(typeof headers[level] === \"undefined\"){\n\t\t\t\theaders[level] = [];\n\t\t\t}\n\t\t\t\n\t\t\tcolumn.height = column.subGroups ? 1 : (depth - column.depth) + 1;\n\t\t\t\n\t\t\theaders[level].push(column);\n\t\t\t\n\t\t\tif(column.height > 1){\n\t\t\t\tfor(let i = 1; i < column.height; i ++){\n\t\t\t\t\t\n\t\t\t\t\tif(typeof headers[level + i] === \"undefined\"){\n\t\t\t\t\t\theaders[level + i] = [];\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\theaders[level + i].push(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(column.width > 1){\n\t\t\t\tfor(let i = 1; i < column.width; i ++){\n\t\t\t\t\theaders[level].push(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(column.subGroups){\n\t\t\t\tcolumn.subGroups.forEach(function(subGroup){\n\t\t\t\t\tparseColumnGroup(subGroup, level+1);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\t\t//calculate maximum header depth\n\t\tcolumns.forEach(function(column){\n\t\t\tif(column.depth > headerDepth){\n\t\t\t\theaderDepth = column.depth;\n\t\t\t}\n\t\t});\n\t\t\n\t\tcolumns.forEach(function(column){\n\t\t\tparseColumnGroup(column,0);\n\t\t});\n\t\t\n\t\theaders.forEach((header) => {\n\t\t\tvar columns = [];\n\t\t\t\n\t\t\theader.forEach((col) => {\n\t\t\t\tif(col){\n\t\t\t\t\tlet title = typeof col.title === \"undefined\" ? \"\" : col.title;\n\t\t\t\t\tcolumns.push(new ExportColumn(title, col.column.getComponent(), col.width, col.height, col.depth));\n\t\t\t\t}else {\n\t\t\t\t\tcolumns.push(null);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\texportRows.push(new ExportRow(\"header\", columns));\n\t\t});\n\t\t\n\t\treturn exportRows;\n\t}\n\t\n\tbodyToExportRows(rows, columns = []){\n\t\tvar exportRows = [];\n\t\t\n\t\tif (columns.length === 0) {\n\t\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\t\tif (this.columnVisCheck(column)) {\n\t\t\t\t\tcolumns.push(column.getComponent());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(this.config.columnCalcs !== false && this.table.modExists(\"columnCalcs\")){\n\t\t\tif(this.table.modules.columnCalcs.topInitialized){\n\t\t\t\trows.unshift(this.table.modules.columnCalcs.topRow);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.modules.columnCalcs.botInitialized){\n\t\t\t\trows.push(this.table.modules.columnCalcs.botRow);\n\t\t\t}\n\t\t}\n\n\t\trows = rows.filter((row) => {\n\t\t\tswitch(row.type){\n\t\t\t\tcase \"group\":\n\t\t\t\t\treturn this.config.rowGroups !== false;\n\t\t\t\t\n\t\t\t\tcase \"calc\":\n\t\t\t\t\treturn this.config.columnCalcs !== false;\n\t\t\t\t\n\t\t\t\tcase \"row\":\n\t\t\t\t\treturn !(this.table.options.dataTree && this.config.dataTree === false && row.modules.dataTree.parent);\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\n\t\t});\n\t\t\n\t\trows.forEach((row, i) => {\n\t\t\tvar rowData = row.getData(this.colVisProp);\n\t\t\tvar exportCols = [];\n\t\t\tvar indent = 0;\n\t\t\t\n\t\t\tswitch(row.type){\n\t\t\t\tcase \"group\":\n\t\t\t\t\tindent = row.level;\n\t\t\t\t\texportCols.push(new ExportColumn(row.key, row.getComponent(), columns.length, 1));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"calc\" :\n\t\t\t\tcase \"row\" :\n\t\t\t\t\tcolumns.forEach((col) => {\n\t\t\t\t\t\texportCols.push(new ExportColumn(col._column.getFieldValue(rowData), col, 1, 1));\n\t\t\t\t\t});\n\t\t\t\t\n\t\t\t\t\tif(this.table.options.dataTree && this.config.dataTree !== false){\n\t\t\t\t\t\tindent = row.modules.dataTree.index;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\texportRows.push(new ExportRow(row.type, exportCols, row.getComponent(), indent));\n\t\t});\n\t\t\n\t\treturn exportRows;\n\t}\n\t\n\tgenerateTableElement(list){\n\t\tvar table = document.createElement(\"table\"),\n\t\theaderEl = document.createElement(\"thead\"),\n\t\tbodyEl = document.createElement(\"tbody\"),\n\t\tstyles = this.lookupTableStyles(),\n\t\trowFormatter = this.table.options[\"rowFormatter\" + (this.colVisPropAttach)],\n\t\tsetup = {};\n\t\t\n\t\tsetup.rowFormatter = rowFormatter !== null ? rowFormatter : this.table.options.rowFormatter;\n\t\t\n\t\tif(this.table.options.dataTree &&this.config.dataTree !== false && this.table.modExists(\"columnCalcs\")){\n\t\t\tsetup.treeElementField = this.table.modules.dataTree.elementField;\n\t\t}\n\t\t\n\t\t//assign group header formatter\n\t\tsetup.groupHeader = this.table.options[\"groupHeader\" + (this.colVisPropAttach)];\n\t\t\n\t\tif(setup.groupHeader && !Array.isArray(setup.groupHeader)){\n\t\t\tsetup.groupHeader = [setup.groupHeader];\n\t\t}\n\t\t\n\t\ttable.classList.add(\"tabulator-print-table\");\n\t\t\n\t\tthis.mapElementStyles(this.table.columnManager.getHeadersElement(), headerEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"background-color\", \"color\", \"font-weight\", \"font-family\", \"font-size\"]);\n\n\t\tif(list.length > 1000){\n\t\t\tconsole.warn(\"It may take a long time to render an HTML table with more than 1000 rows\");\n\t\t}\n\t\t\n\t\tlist.forEach((row, i) => {\n\t\t\tlet rowEl;\n\t\t\t\n\t\t\tswitch(row.type){\n\t\t\t\tcase \"header\":\n\t\t\t\t\theaderEl.appendChild(this.generateHeaderElement(row, setup, styles));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"group\":\n\t\t\t\t\tbodyEl.appendChild(this.generateGroupElement(row, setup, styles));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"calc\":\n\t\t\t\t\tbodyEl.appendChild(this.generateCalcElement(row, setup, styles));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"row\":\n\t\t\t\t\trowEl = this.generateRowElement(row, setup, styles);\n\t\t\t\t\n\t\t\t\t\tthis.mapElementStyles(((i % 2) && styles.evenRow) ? styles.evenRow : styles.oddRow, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\t\t\t\t\tbodyEl.appendChild(rowEl);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(headerEl.innerHTML){\n\t\t\ttable.appendChild(headerEl);\n\t\t}\n\t\t\n\t\ttable.appendChild(bodyEl);\n\t\t\n\t\t\n\t\tthis.mapElementStyles(this.table.element, table, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\"]);\n\t\treturn table;\n\t}\n\t\n\tlookupTableStyles(){\n\t\tvar styles = {};\n\t\t\n\t\t//lookup row styles\n\t\tif(this.cloneTableStyle && window.getComputedStyle){\n\t\t\tstyles.oddRow = this.table.element.querySelector(\".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\t\tstyles.evenRow = this.table.element.querySelector(\".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\t\tstyles.calcRow = this.table.element.querySelector(\".tabulator-row.tabulator-calcs\");\n\t\t\tstyles.firstRow = this.table.element.querySelector(\".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\t\tstyles.firstGroup = this.table.element.getElementsByClassName(\"tabulator-group\")[0];\n\t\t\t\n\t\t\tif(styles.firstRow){\n\t\t\t\tstyles.styleCells = styles.firstRow.getElementsByClassName(\"tabulator-cell\");\n\t\t\t\tstyles.styleRowHeader = styles.firstRow.getElementsByClassName(\"tabulator-row-header\")[0];\n\t\t\t\tstyles.firstCell = styles.styleCells[0];\n\t\t\t\tstyles.lastCell = styles.styleCells[styles.styleCells.length - 1];\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn styles;\n\t}\n\t\n\tgenerateHeaderElement(row, setup, styles){\n\t\tvar rowEl = document.createElement(\"tr\");\n\t\t\n\t\trow.columns.forEach((column) => {\n\t\t\tif(column){\n\t\t\t\tvar cellEl = document.createElement(\"th\");\n\t\t\t\tvar classNames = column.component._column.definition.cssClass ? column.component._column.definition.cssClass.split(\" \") : [];\n\t\t\t\t\n\t\t\t\tcellEl.colSpan = column.width;\n\t\t\t\tcellEl.rowSpan = column.height;\n\t\t\t\t\n\t\t\t\tcellEl.innerHTML = column.value;\n\t\t\t\t\n\t\t\t\tif(this.cloneTableStyle){\n\t\t\t\t\tcellEl.style.boxSizing = \"border-box\";\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tclassNames.forEach(function(className) {\n\t\t\t\t\tcellEl.classList.add(className);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.mapElementStyles(column.component.getElement(), cellEl, [\"text-align\", \"border-left\", \"border-right\", \"background-color\", \"color\", \"font-weight\", \"font-family\", \"font-size\"]);\n\t\t\t\tthis.mapElementStyles(column.component._column.contentElement, cellEl, [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\"]);\n\t\t\n\t\t\t\tif(column.component._column.visible){\n\t\t\t\t\tthis.mapElementStyles(column.component.getElement(), cellEl, [\"width\"]);\n\t\t\t\t}else {\n\t\t\t\t\tif(column.component._column.definition.width){\n\t\t\t\t\t\tcellEl.style.width = column.component._column.definition.width + \"px\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(column.component._column.parent && column.component._column.parent.isGroup){\n\t\t\t\t\tthis.mapElementStyles(column.component._column.parent.groupElement, cellEl, [\"border-top\"]);\n\t\t\t\t}else {\n\t\t\t\t\tthis.mapElementStyles(column.component.getElement(), cellEl, [\"border-top\"]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(column.component._column.isGroup){\n\t\t\t\t\tthis.mapElementStyles(column.component.getElement(), cellEl, [\"border-bottom\"]);\n\t\t\t\t}else {\n\t\t\t\t\tthis.mapElementStyles(this.table.columnManager.getElement(), cellEl, [\"border-bottom\"]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trowEl.appendChild(cellEl);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn rowEl;\n\t}\n\t\n\tgenerateGroupElement(row, setup, styles){\n\t\t\n\t\tvar rowEl = document.createElement(\"tr\"),\n\t\tcellEl = document.createElement(\"td\"),\n\t\tgroup = row.columns[0];\n\t\t\n\t\trowEl.classList.add(\"tabulator-print-table-row\");\n\t\t\n\t\tif(setup.groupHeader && setup.groupHeader[row.indent]){\n\t\t\tgroup.value = setup.groupHeader[row.indent](group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t\t}else {\n\t\t\tif(setup.groupHeader !== false){\n\t\t\t\tgroup.value = row.component._group.generator(group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t\t\t}\n\t\t}\n\t\t\n\t\tcellEl.colSpan = group.width;\n\t\tcellEl.innerHTML = group.value;\n\t\t\n\t\trowEl.classList.add(\"tabulator-print-table-group\");\n\t\trowEl.classList.add(\"tabulator-group-level-\" + row.indent);\n\t\t\n\t\tif(group.component.isVisible()){\n\t\t\trowEl.classList.add(\"tabulator-group-visible\");\n\t\t}\n\t\t\n\t\tthis.mapElementStyles(styles.firstGroup, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\t\tthis.mapElementStyles(styles.firstGroup, cellEl, [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\"]);\n\t\t\n\t\trowEl.appendChild(cellEl);\n\t\t\n\t\treturn rowEl;\n\t}\n\t\n\tgenerateCalcElement(row, setup, styles){\n\t\tvar rowEl = this.generateRowElement(row, setup, styles);\n\t\t\n\t\trowEl.classList.add(\"tabulator-print-table-calcs\");\n\t\tthis.mapElementStyles(styles.calcRow, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\t\t\n\t\treturn rowEl;\n\t}\n\t\n\tgenerateRowElement(row, setup, styles){\n\t\tvar rowEl = document.createElement(\"tr\");\n\t\t\n\t\trowEl.classList.add(\"tabulator-print-table-row\");\n\t\t\n\t\trow.columns.forEach((col, i) => {\n\t\t\tif(col){\n\t\t\t\tvar cellEl = document.createElement(\"td\"),\n\t\t\t\tcolumn = col.component._column,\n\t\t\t\ttable =  this.table,\n\t\t\t\tindex = table.columnManager.findColumnIndex(column),\n\t\t\t\tvalue = col.value,\n\t\t\t\tcellStyle, styleProps;\n\t\t\t\t\n\t\t\t\tvar cellWrapper = {\n\t\t\t\t\tmodules:{},\n\t\t\t\t\tgetValue:function(){\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t},\n\t\t\t\t\tgetField:function(){\n\t\t\t\t\t\treturn column.definition.field;\n\t\t\t\t\t},\n\t\t\t\t\tgetElement:function(){\n\t\t\t\t\t\treturn cellEl;\n\t\t\t\t\t},\n\t\t\t\t\tgetType:function(){\n\t\t\t\t\t\treturn \"cell\";\n\t\t\t\t\t},\n\t\t\t\t\tgetColumn:function(){\n\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t},\n\t\t\t\t\tgetData:function(){\n\t\t\t\t\t\treturn row.component.getData();\n\t\t\t\t\t},\n\t\t\t\t\tgetRow:function(){\n\t\t\t\t\t\treturn row.component;\n\t\t\t\t\t},\n\t\t\t\t\tgetTable:function(){\n\t\t\t\t\t\treturn table;\n\t\t\t\t\t},\n\t\t\t\t\tgetComponent:function(){\n\t\t\t\t\t\treturn cellWrapper;\n\t\t\t\t\t},\n\t\t\t\t\tcolumn:column,\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tvar classNames = column.definition.cssClass ? column.definition.cssClass.split(\" \") : [];\n\t\t\t\t\n\t\t\t\tclassNames.forEach(function(className) {\n\t\t\t\t\tcellEl.classList.add(className);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(this.table.modExists(\"format\") && this.config.formatCells !== false){\n\t\t\t\t\tvalue = this.table.modules.format.formatExportValue(cellWrapper, this.colVisProp);\n\t\t\t\t}else {\n\t\t\t\t\tswitch(typeof value){\n\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\tvalue = value !== null ? JSON.stringify(value) : \"\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\tvalue = \"\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(value instanceof Node){\n\t\t\t\t\tcellEl.appendChild(value);\n\t\t\t\t}else {\n\t\t\t\t\tcellEl.innerHTML = value;\n\t\t\t\t}\n\n\t\t\t\tstyleProps = [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\", \"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"text-align\"];\n\n\t\t\t\tif(column.isRowHeader){\n\t\t\t\t\tcellStyle = styles.styleRowHeader;\n\t\t\t\t\tstyleProps.push(\"background-color\");\n\t\t\t\t}else {\n\t\t\t\t\tcellStyle = styles.styleCells && styles.styleCells[index] ? styles.styleCells[index] : styles.firstCell;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(cellStyle){\n\t\t\t\t\tthis.mapElementStyles(cellStyle, cellEl, styleProps);\n\t\t\t\t\t\n\t\t\t\t\tif(column.definition.align){\n\t\t\t\t\t\tcellEl.style.textAlign = column.definition.align;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.table.options.dataTree && this.config.dataTree !== false){\n\t\t\t\t\tif((setup.treeElementField && setup.treeElementField == column.field) || (!setup.treeElementField && i == 0)){\n\t\t\t\t\t\tif(row.component._row.modules.dataTree.controlEl){\n\t\t\t\t\t\t\tcellEl.insertBefore(row.component._row.modules.dataTree.controlEl.cloneNode(true), cellEl.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(row.component._row.modules.dataTree.branchEl){\n\t\t\t\t\t\t\tcellEl.insertBefore(row.component._row.modules.dataTree.branchEl.cloneNode(true), cellEl.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trowEl.appendChild(cellEl);\n\t\t\t\t\n\t\t\t\tif(cellWrapper.modules.format && cellWrapper.modules.format.renderedCallback){\n\t\t\t\t\tcellWrapper.modules.format.renderedCallback();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(setup.rowFormatter && row.type === \"row\" && this.config.formatCells !== false){\n\t\t\tlet formatComponent = Object.assign(row.component);\n\n\t\t\tformatComponent.getElement = function(){return rowEl;};\n\n\t\t\tsetup.rowFormatter(row.component);\n\t\t}\n\t\t\n\t\treturn rowEl;\n\t}\n\t\n\tgenerateHTMLTable(list){\n\t\tvar holder = document.createElement(\"div\");\n\t\t\n\t\tholder.appendChild(this.generateTableElement(list));\n\t\t\n\t\treturn holder.innerHTML;\n\t}\n\t\n\tgetHtml(visible, style, config, colVisProp){\n\t\tvar list = this.generateExportList(config || this.table.options.htmlOutputConfig, style, visible, colVisProp || \"htmlOutput\");\n\t\t\n\t\treturn this.generateHTMLTable(list);\n\t}\n\t\n\tmapElementStyles(from, to, props){\n\t\tif(this.cloneTableStyle && from && to){\n\t\t\t\n\t\t\tvar lookup = {\n\t\t\t\t\"background-color\" : \"backgroundColor\",\n\t\t\t\t\"color\" : \"fontColor\",\n\t\t\t\t\"width\" : \"width\",\n\t\t\t\t\"font-weight\" : \"fontWeight\",\n\t\t\t\t\"font-family\" : \"fontFamily\",\n\t\t\t\t\"font-size\" : \"fontSize\",\n\t\t\t\t\"text-align\" : \"textAlign\",\n\t\t\t\t\"border-top\" : \"borderTop\",\n\t\t\t\t\"border-left\" : \"borderLeft\",\n\t\t\t\t\"border-right\" : \"borderRight\",\n\t\t\t\t\"border-bottom\" : \"borderBottom\",\n\t\t\t\t\"padding-top\" : \"paddingTop\",\n\t\t\t\t\"padding-left\" : \"paddingLeft\",\n\t\t\t\t\"padding-right\" : \"paddingRight\",\n\t\t\t\t\"padding-bottom\" : \"paddingBottom\",\n\t\t\t};\n\t\t\t\n\t\t\tif(window.getComputedStyle){\n\t\t\t\tvar fromStyle = window.getComputedStyle(from);\n\n\t\t\t\tprops.forEach(function(prop){\n\t\t\t\t\tif(!to.style[lookup[prop]]){\n\t\t\t\t\t\tto.style[lookup[prop]] = fromStyle.getPropertyValue(prop);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar defaultFilters = {\n\n\t//equal to\n\t\"=\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal == filterVal ? true : false;\n\t},\n\n\t//less than\n\t\"<\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal < filterVal ? true : false;\n\t},\n\n\t//less than or equal to\n\t\"<=\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal <= filterVal ? true : false;\n\t},\n\n\t//greater than\n\t\">\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal > filterVal ? true : false;\n\t},\n\n\t//greater than or equal to\n\t\">=\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal >= filterVal ? true : false;\n\t},\n\n\t//not equal to\n\t\"!=\":function(filterVal, rowVal, rowData, filterParams){\n\t\treturn rowVal != filterVal ? true : false;\n\t},\n\n\t\"regex\":function(filterVal, rowVal, rowData, filterParams){\n\n\t\tif(typeof filterVal == \"string\"){\n\t\t\tfilterVal = new RegExp(filterVal);\n\t\t}\n\n\t\treturn filterVal.test(rowVal);\n\t},\n\n\t//contains the string\n\t\"like\":function(filterVal, rowVal, rowData, filterParams){\n\t\tif(filterVal === null || typeof filterVal === \"undefined\"){\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t}else {\n\t\t\tif(typeof rowVal !== 'undefined' && rowVal !== null){\n\t\t\t\treturn String(rowVal).toLowerCase().indexOf(filterVal.toLowerCase()) > -1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//contains the keywords\n\t\"keywords\":function(filterVal, rowVal, rowData, filterParams){\n\t\tvar keywords = filterVal.toLowerCase().split(typeof filterParams.separator === \"undefined\" ? \" \" : filterParams.separator),\n\t\tvalue = String(rowVal === null || typeof rowVal === \"undefined\" ? \"\" : rowVal).toLowerCase(),\n\t\tmatches = [];\n\n\t\tkeywords.forEach((keyword) =>{\n\t\t\tif(value.includes(keyword)){\n\t\t\t\tmatches.push(true);\n\t\t\t}\n\t\t});\n\n\t\treturn filterParams.matchAll ? matches.length === keywords.length : !!matches.length;\n\t},\n\n\t//starts with the string\n\t\"starts\":function(filterVal, rowVal, rowData, filterParams){\n\t\tif(filterVal === null || typeof filterVal === \"undefined\"){\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t}else {\n\t\t\tif(typeof rowVal !== 'undefined' && rowVal !== null){\n\t\t\t\treturn String(rowVal).toLowerCase().startsWith(filterVal.toLowerCase());\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//ends with the string\n\t\"ends\":function(filterVal, rowVal, rowData, filterParams){\n\t\tif(filterVal === null || typeof filterVal === \"undefined\"){\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t}else {\n\t\t\tif(typeof rowVal !== 'undefined' && rowVal !== null){\n\t\t\t\treturn String(rowVal).toLowerCase().endsWith(filterVal.toLowerCase());\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//in array\n\t\"in\":function(filterVal, rowVal, rowData, filterParams){\n\t\tif(Array.isArray(filterVal)){\n\t\t\treturn filterVal.length ? filterVal.indexOf(rowVal) > -1 : true;\n\t\t}else {\n\t\t\tconsole.warn(\"Filter Error - filter value is not an array:\", filterVal);\n\t\t\treturn false;\n\t\t}\n\t},\n};\n\nclass Filter extends Module{\n\n\tstatic moduleName = \"filter\";\n\n\t//load defaults\n\tstatic filters = defaultFilters;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.filterList = []; //hold filter list\n\t\tthis.headerFilters = {}; //hold column filters\n\t\tthis.headerFilterColumns = []; //hold columns that use header filters\n\n\t\tthis.prevHeaderFilterChangeCheck = \"\";\n\t\tthis.prevHeaderFilterChangeCheck = \"{}\";\n\n\t\tthis.changed = false; //has filtering changed since last render\n\t\tthis.tableInitialized = false;\n\n\t\tthis.registerTableOption(\"filterMode\", \"local\"); //local or remote filtering\n\n\t\tthis.registerTableOption(\"initialFilter\", false); //initial filtering criteria\n\t\tthis.registerTableOption(\"initialHeaderFilter\", false); //initial header filtering criteria\n\t\tthis.registerTableOption(\"headerFilterLiveFilterDelay\", 300); //delay before updating column after user types in header filter\n\t\tthis.registerTableOption(\"placeholderHeaderFilter\", false); //placeholder when header filter is empty\n\n\t\tthis.registerColumnOption(\"headerFilter\");\n\t\tthis.registerColumnOption(\"headerFilterPlaceholder\");\n\t\tthis.registerColumnOption(\"headerFilterParams\");\n\t\tthis.registerColumnOption(\"headerFilterEmptyCheck\");\n\t\tthis.registerColumnOption(\"headerFilterFunc\");\n\t\tthis.registerColumnOption(\"headerFilterFuncParams\");\n\t\tthis.registerColumnOption(\"headerFilterLiveFilter\");\n\n\t\tthis.registerTableFunction(\"searchRows\", this.searchRows.bind(this));\n\t\tthis.registerTableFunction(\"searchData\", this.searchData.bind(this));\n\n\t\tthis.registerTableFunction(\"setFilter\", this.userSetFilter.bind(this));\n\t\tthis.registerTableFunction(\"refreshFilter\", this.userRefreshFilter.bind(this));\n\t\tthis.registerTableFunction(\"addFilter\", this.userAddFilter.bind(this));\n\t\tthis.registerTableFunction(\"getFilters\", this.getFilters.bind(this));\n\t\tthis.registerTableFunction(\"setHeaderFilterFocus\", this.userSetHeaderFilterFocus.bind(this));\n\t\tthis.registerTableFunction(\"getHeaderFilterValue\", this.userGetHeaderFilterValue.bind(this));\n\t\tthis.registerTableFunction(\"setHeaderFilterValue\", this.userSetHeaderFilterValue.bind(this));\n\t\tthis.registerTableFunction(\"getHeaderFilters\", this.getHeaderFilters.bind(this));\n\t\tthis.registerTableFunction(\"removeFilter\", this.userRemoveFilter.bind(this));\n\t\tthis.registerTableFunction(\"clearFilter\", this.userClearFilter.bind(this));\n\t\tthis.registerTableFunction(\"clearHeaderFilter\", this.userClearHeaderFilter.bind(this));\n\n\t\tthis.registerComponentFunction(\"column\", \"headerFilterFocus\", this.setHeaderFilterFocus.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"reloadHeaderFilter\", this.reloadHeaderFilter.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"getHeaderFilterValue\", this.getHeaderFilterValue.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"setHeaderFilterValue\", this.setHeaderFilterValue.bind(this));\n\t}\n\n\tinitialize(){\n\t\tthis.subscribe(\"column-init\", this.initializeColumnHeaderFilter.bind(this));\n\t\tthis.subscribe(\"column-width-fit-before\", this.hideHeaderFilterElements.bind(this));\n\t\tthis.subscribe(\"column-width-fit-after\", this.showHeaderFilterElements.bind(this));\n\t\tthis.subscribe(\"table-built\", this.tableBuilt.bind(this));\n\t\tthis.subscribe(\"placeholder\", this.generatePlaceholder.bind(this));\n\n\t\tif(this.table.options.filterMode === \"remote\"){\n\t\t\tthis.subscribe(\"data-params\", this.remoteFilterParams.bind(this));\n\t\t}\n\n\t\tthis.registerDataHandler(this.filter.bind(this), 10);\n\t}\n\n\ttableBuilt(){\n\t\tif(this.table.options.initialFilter){\n\t\t\tthis.setFilter(this.table.options.initialFilter);\n\t\t}\n\n\t\tif(this.table.options.initialHeaderFilter){\n\t\t\tthis.table.options.initialHeaderFilter.forEach((item) => {\n\n\t\t\t\tvar column = this.table.columnManager.findColumn(item.field);\n\n\t\t\t\tif(column){\n\t\t\t\t\tthis.setHeaderFilterValue(column, item.value);\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", item.field);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.tableInitialized = true;\n\t}\n\n\tremoteFilterParams(data, config, silent, params){\n\t\tparams.filter = this.getFilters(true, true);\n\t\treturn params;\n\t}\n\n\tgeneratePlaceholder(text){\n\t\tif(this.table.options.placeholderHeaderFilter && Object.keys(this.headerFilters).length){\n\t\t\treturn this.table.options.placeholderHeaderFilter;\n\t\t}\n\t}\n\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\n\t//set standard filters\n\tuserSetFilter(field, type, value, params){\n\t\tthis.setFilter(field, type, value, params);\n\t\tthis.refreshFilter();\n\t}\n\n\t//set standard filters\n\tuserRefreshFilter(){\n\t\tthis.refreshFilter();\n\t}\n\n\t//add filter to array\n\tuserAddFilter(field, type, value, params){\n\t\tthis.addFilter(field, type, value, params);\n\t\tthis.refreshFilter();\n\t}\n\n\tuserSetHeaderFilterFocus(field){\n\t\tvar column = this.table.columnManager.findColumn(field);\n\n\t\tif(column){\n\t\t\tthis.setHeaderFilterFocus(column);\n\t\t}else {\n\t\t\tconsole.warn(\"Column Filter Focus Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tuserGetHeaderFilterValue(field) {\n\t\tvar column = this.table.columnManager.findColumn(field);\n\n\t\tif(column){\n\t\t\treturn this.getHeaderFilterValue(column);\n\t\t}else {\n\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", field);\n\t\t}\n\t}\n\n\tuserSetHeaderFilterValue(field, value){\n\t\tvar column = this.table.columnManager.findColumn(field);\n\n\t\tif(column){\n\t\t\tthis.setHeaderFilterValue(column, value);\n\t\t}else {\n\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//remove filter from array\n\tuserRemoveFilter(field, type, value){\n\t\tthis.removeFilter(field, type, value);\n\t\tthis.refreshFilter();\n\t}\n\n\t//clear filters\n\tuserClearFilter(all){\n\t\tthis.clearFilter(all);\n\t\tthis.refreshFilter();\n\t}\n\n\t//clear header filters\n\tuserClearHeaderFilter(){\n\t\tthis.clearHeaderFilter();\n\t\tthis.refreshFilter();\n\t}\n\n\n\t//search for specific row components\n\tsearchRows(field, type, value){\n\t\treturn this.search(\"rows\", field, type, value);\n\t}\n\n\t//search for specific data\n\tsearchData(field, type, value){\n\t\treturn this.search(\"data\", field, type, value);\n\t}\n\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\n\tinitializeColumnHeaderFilter(column){\n\t\tvar def = column.definition;\n\n\t\tif(def.headerFilter){\n\t\t\tthis.initializeColumn(column);\n\t\t}\n\t}\n\n\t//initialize column header filter\n\tinitializeColumn(column, value){\n\t\tvar self = this,\n\t\tfield = column.getField();\n\n\t\t//handle successfully value change\n\t\tfunction success(value){\n\t\t\tvar filterType = (column.modules.filter.tagType == \"input\" && column.modules.filter.attrType == \"text\") || column.modules.filter.tagType == \"textarea\" ? \"partial\" : \"match\",\n\t\t\ttype = \"\",\n\t\t\tfilterChangeCheck = \"\",\n\t\t\tfilterFunc;\n\n\t\t\tif(typeof column.modules.filter.prevSuccess === \"undefined\" || column.modules.filter.prevSuccess !== value){\n\n\t\t\t\tcolumn.modules.filter.prevSuccess = value;\n\n\t\t\t\tif(!column.modules.filter.emptyFunc(value)){\n\t\t\t\t\tcolumn.modules.filter.value = value;\n\n\t\t\t\t\tswitch(typeof column.definition.headerFilterFunc){\n\t\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\t\tif(Filter.filters[column.definition.headerFilterFunc]){\n\t\t\t\t\t\t\t\ttype = column.definition.headerFilterFunc;\n\t\t\t\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\t\t\t\tvar params = column.definition.headerFilterFuncParams || {};\n\t\t\t\t\t\t\t\t\tvar fieldVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\t\t\tparams = typeof params === \"function\" ? params(value, fieldVal, data) : params;\n\n\t\t\t\t\t\t\t\t\treturn Filter.filters[column.definition.headerFilterFunc](value, fieldVal, data, params);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tconsole.warn(\"Header Filter Error - Matching filter function not found: \", column.definition.headerFilterFunc);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\t\t\tvar params = column.definition.headerFilterFuncParams || {};\n\t\t\t\t\t\t\t\tvar fieldVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\t\tparams = typeof params === \"function\" ? params(value, fieldVal, data) : params;\n\n\t\t\t\t\t\t\t\treturn column.definition.headerFilterFunc(value, fieldVal, data, params);\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\ttype = filterFunc;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(!filterFunc){\n\t\t\t\t\t\tswitch(filterType){\n\t\t\t\t\t\t\tcase \"partial\":\n\t\t\t\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\t\t\t\tvar colVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\t\t\tif(typeof colVal !== 'undefined' && colVal !== null){\n\t\t\t\t\t\t\t\t\t\treturn String(colVal).toLowerCase().indexOf(String(value).toLowerCase()) > -1;\n\t\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\ttype = \"like\";\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\t\t\t\treturn column.getFieldValue(data) == value;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\ttype = \"=\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tself.headerFilters[field] = {value:value, func:filterFunc, type:type};\n\t\t\t\t}else {\n\t\t\t\t\tdelete self.headerFilters[field];\n\t\t\t\t}\n\n\t\t\t\tcolumn.modules.filter.value = value;\n\n\t\t\t\tfilterChangeCheck = JSON.stringify(self.headerFilters);\n\n\t\t\t\tif(self.prevHeaderFilterChangeCheck !== filterChangeCheck){\n\t\t\t\t\tself.prevHeaderFilterChangeCheck = filterChangeCheck;\n\n\t\t\t\t\tself.trackChanges();\n\t\t\t\t\tself.refreshFilter();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\tcolumn.modules.filter = {\n\t\t\tsuccess:success,\n\t\t\tattrType:false,\n\t\t\ttagType:false,\n\t\t\temptyFunc:false,\n\t\t};\n\n\t\tthis.generateHeaderFilterElement(column);\n\t}\n\n\tgenerateHeaderFilterElement(column, initialValue, reinitialize){\n\t\tvar self = this,\n\t\tsuccess = column.modules.filter.success,\n\t\tfield = column.getField(),\n\t\tfilterElement, editor, editorElement, cellWrapper, typingTimer, searchTrigger, params, onRenderedCallback;\n\n\t\tcolumn.modules.filter.value = initialValue;\n\n\t\t//handle aborted edit\n\t\tfunction cancel(){}\n\n\t\tfunction onRendered(callback){\n\t\t\tonRenderedCallback = callback;\n\t\t}\n\n\t\tif(column.modules.filter.headerElement && column.modules.filter.headerElement.parentNode){\n\t\t\tcolumn.contentElement.removeChild(column.modules.filter.headerElement.parentNode);\n\t\t}\n\n\t\tif(field){\n\n\t\t\t//set empty value function\n\t\t\tcolumn.modules.filter.emptyFunc = column.definition.headerFilterEmptyCheck || function(value){\n\t\t\t\treturn !value && value !== 0;\n\t\t\t};\n\n\t\t\tfilterElement = document.createElement(\"div\");\n\t\t\tfilterElement.classList.add(\"tabulator-header-filter\");\n\n\t\t\t//set column editor\n\t\t\tswitch(typeof column.definition.headerFilter){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tif(self.table.modules.edit.editors[column.definition.headerFilter]){\n\t\t\t\t\t\teditor = self.table.modules.edit.editors[column.definition.headerFilter];\n\n\t\t\t\t\t\tif((column.definition.headerFilter === \"tick\" || column.definition.headerFilter === \"tickCross\") && !column.definition.headerFilterEmptyCheck){\n\t\t\t\t\t\t\tcolumn.modules.filter.emptyFunc = function(value){\n\t\t\t\t\t\t\t\treturn value !== true && value !== false;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Filter Error - Cannot build header filter, No such editor found: \", column.definition.editor);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\teditor = column.definition.headerFilter;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tif(column.modules.edit && column.modules.edit.editor){\n\t\t\t\t\t\teditor = column.modules.edit.editor;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(column.definition.formatter && self.table.modules.edit.editors[column.definition.formatter]){\n\t\t\t\t\t\t\teditor = self.table.modules.edit.editors[column.definition.formatter];\n\n\t\t\t\t\t\t\tif((column.definition.formatter === \"tick\" || column.definition.formatter === \"tickCross\") && !column.definition.headerFilterEmptyCheck){\n\t\t\t\t\t\t\t\tcolumn.modules.filter.emptyFunc = function(value){\n\t\t\t\t\t\t\t\t\treturn value !== true && value !== false;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\teditor = self.table.modules.edit.editors[\"input\"];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif(editor){\n\n\t\t\t\tcellWrapper = {\n\t\t\t\t\tgetValue:function(){\n\t\t\t\t\t\treturn typeof initialValue !== \"undefined\" ? initialValue : \"\";\n\t\t\t\t\t},\n\t\t\t\t\tgetField:function(){\n\t\t\t\t\t\treturn column.definition.field;\n\t\t\t\t\t},\n\t\t\t\t\tgetElement:function(){\n\t\t\t\t\t\treturn filterElement;\n\t\t\t\t\t},\n\t\t\t\t\tgetColumn:function(){\n\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t},\n\t\t\t\t\tgetTable:() => {\n\t\t\t\t\t\treturn this.table;\n\t\t\t\t\t},\n\t\t\t\t\tgetType:() => {\n\t\t\t\t\t\treturn \"header\";\n\t\t\t\t\t},\n\t\t\t\t\tgetRow:function(){\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tnormalizeHeight:function(){\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tparams = column.definition.headerFilterParams || {};\n\n\t\t\t\tparams = typeof params === \"function\" ? params.call(self.table, cellWrapper) : params;\n\n\t\t\t\teditorElement = editor.call(this.table.modules.edit, cellWrapper, onRendered, success, cancel, params);\n\n\t\t\t\tif(!editorElement){\n\t\t\t\t\tconsole.warn(\"Filter Error - Cannot add filter to \" + field + \" column, editor returned a value of false\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!(editorElement instanceof Node)){\n\t\t\t\t\tconsole.warn(\"Filter Error - Cannot add filter to \" + field + \" column, editor should return an instance of Node, the editor returned:\", editorElement);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//set Placeholder Text\n\t\t\t\tself.langBind(\"headerFilters|columns|\" + column.definition.field, function(value){\n\t\t\t\t\teditorElement.setAttribute(\"placeholder\", typeof value !== \"undefined\" && value ? value : (column.definition.headerFilterPlaceholder || self.langText(\"headerFilters|default\")));\n\t\t\t\t});\n\n\t\t\t\t//focus on element on click\n\t\t\t\teditorElement.addEventListener(\"click\", function(e){\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\teditorElement.focus();\n\t\t\t\t});\n\n\t\t\t\teditorElement.addEventListener(\"focus\", (e) => {\n\t\t\t\t\tvar left = this.table.columnManager.contentsElement.scrollLeft;\n\n\t\t\t\t\tvar headerPos = this.table.rowManager.element.scrollLeft;\n\n\t\t\t\t\tif(left !== headerPos){\n\t\t\t\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\t\t\t\t\t\tthis.table.columnManager.scrollHorizontal(left);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t//live update filters as user types\n\t\t\t\ttypingTimer = false;\n\n\t\t\t\tsearchTrigger = function(e){\n\t\t\t\t\tif(typingTimer){\n\t\t\t\t\t\tclearTimeout(typingTimer);\n\t\t\t\t\t}\n\n\t\t\t\t\ttypingTimer = setTimeout(function(){\n\t\t\t\t\t\tsuccess(editorElement.value);\n\t\t\t\t\t},self.table.options.headerFilterLiveFilterDelay);\n\t\t\t\t};\n\n\t\t\t\tcolumn.modules.filter.headerElement = editorElement;\n\t\t\t\tcolumn.modules.filter.attrType = editorElement.hasAttribute(\"type\") ? editorElement.getAttribute(\"type\").toLowerCase() : \"\" ;\n\t\t\t\tcolumn.modules.filter.tagType = editorElement.tagName.toLowerCase();\n\n\t\t\t\tif(column.definition.headerFilterLiveFilter !== false){\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!(\n\t\t\t\t\t\t\tcolumn.definition.headerFilter === 'autocomplete' ||\n\t\t\t\t\t\t\tcolumn.definition.headerFilter === 'tickCross' ||\n\t\t\t\t\t\t\t((column.definition.editor === 'autocomplete' ||\n\t\t\t\t\t\t\t\tcolumn.definition.editor === 'tickCross') &&\n\t\t\t\t\t\t\tcolumn.definition.headerFilter === true)\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\teditorElement.addEventListener(\"keyup\", searchTrigger);\n\t\t\t\t\t\teditorElement.addEventListener(\"search\", searchTrigger);\n\n\n\t\t\t\t\t\t//update number filtered columns on change\n\t\t\t\t\t\tif(column.modules.filter.attrType == \"number\"){\n\t\t\t\t\t\t\teditorElement.addEventListener(\"change\", function(e){\n\t\t\t\t\t\t\t\tsuccess(editorElement.value);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//change text inputs to search inputs to allow for clearing of field\n\t\t\t\t\t\tif(column.modules.filter.attrType == \"text\" && this.table.browser !== \"ie\"){\n\t\t\t\t\t\t\teditorElement.setAttribute(\"type\", \"search\");\n\t\t\t\t\t\t// editorElement.off(\"change blur\"); //prevent blur from triggering filter and preventing selection click\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//prevent input and select elements from propagating click to column sorters etc\n\t\t\t\t\tif(column.modules.filter.tagType == \"input\" || column.modules.filter.tagType == \"select\" || column.modules.filter.tagType == \"textarea\"){\n\t\t\t\t\t\teditorElement.addEventListener(\"mousedown\",function(e){\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfilterElement.appendChild(editorElement);\n\n\t\t\t\tcolumn.contentElement.appendChild(filterElement);\n\n\t\t\t\tif(!reinitialize){\n\t\t\t\t\tself.headerFilterColumns.push(column);\n\t\t\t\t}\n\n\t\t\t\tif(onRenderedCallback){\n\t\t\t\t\tonRenderedCallback();\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Filter Error - Cannot add header filter, column has no field set:\", column.definition.title);\n\t\t}\n\t}\n\n\t//hide all header filter elements (used to ensure correct column widths in \"fitData\" layout mode)\n\thideHeaderFilterElements(){\n\t\tthis.headerFilterColumns.forEach(function(column){\n\t\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\t\tcolumn.modules.filter.headerElement.style.display = 'none';\n\t\t\t}\n\t\t});\n\t}\n\n\t//show all header filter elements (used to ensure correct column widths in \"fitData\" layout mode)\n\tshowHeaderFilterElements(){\n\t\tthis.headerFilterColumns.forEach(function(column){\n\t\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\t\tcolumn.modules.filter.headerElement.style.display = '';\n\t\t\t}\n\t\t});\n\t}\n\n\t//programmatically set focus of header filter\n\tsetHeaderFilterFocus(column){\n\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\tcolumn.modules.filter.headerElement.focus();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Filter Focus Error - No header filter set on column:\", column.getField());\n\t\t}\n\t}\n\n\t//programmatically get value of header filter\n\tgetHeaderFilterValue(column){\n\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\treturn column.modules.filter.value;\n\t\t} else {\n\t\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t\t}\n\t}\n\n\t//programmatically set value of header filter\n\tsetHeaderFilterValue(column, value){\n\t\tif (column){\n\t\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\t\tthis.generateHeaderFilterElement(column, value, true);\n\t\t\t\tcolumn.modules.filter.success(value);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t\t\t}\n\t\t}\n\t}\n\n\treloadHeaderFilter(column){\n\t\tif (column){\n\t\t\tif(column.modules.filter && column.modules.filter.headerElement){\n\t\t\t\tthis.generateHeaderFilterElement(column, column.modules.filter.value, true);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t\t\t}\n\t\t}\n\t}\n\n\trefreshFilter(){\n\t\tif(this.tableInitialized){\n\t\t\tif(this.table.options.filterMode === \"remote\"){\n\t\t\t\tthis.reloadData(null, false, false);\n\t\t\t}else {\n\t\t\t\tthis.refreshData(true);\n\t\t\t}\n\t\t}\n\n\t\t//TODO - Persist left position of row manager\n\t\t// left = this.scrollLeft;\n\t\t// this.scrollHorizontal(left);\n\t}\n\n\t//check if the filters has changed since last use\n\ttrackChanges(){\n\t\tthis.changed = true;\n\t\tthis.dispatch(\"filter-changed\");\n\t}\n\n\t//check if the filters has changed since last use\n\thasChanged(){\n\t\tvar changed = this.changed;\n\t\tthis.changed = false;\n\t\treturn changed;\n\t}\n\n\t//set standard filters\n\tsetFilter(field, type, value, params){\n\t\tthis.filterList = [];\n\n\t\tif(!Array.isArray(field)){\n\t\t\tfield = [{field:field, type:type, value:value, params:params}];\n\t\t}\n\n\t\tthis.addFilter(field);\n\t}\n\n\t//add filter to array\n\taddFilter(field, type, value, params){\n\t\tvar changed = false;\n\n\t\tif(!Array.isArray(field)){\n\t\t\tfield = [{field:field, type:type, value:value, params:params}];\n\t\t}\n\n\t\tfield.forEach((filter) => {\n\t\t\tfilter = this.findFilter(filter);\n\n\t\t\tif(filter){\n\t\t\t\tthis.filterList.push(filter);\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\n\t\tif(changed){\n\t\t\tthis.trackChanges();\n\t\t}\n\t}\n\n\tfindFilter(filter){\n\t\tvar column;\n\n\t\tif(Array.isArray(filter)){\n\t\t\treturn this.findSubFilters(filter);\n\t\t}\n\n\t\tvar filterFunc = false;\n\n\t\tif(typeof filter.field == \"function\"){\n\t\t\tfilterFunc = function(data){\n\t\t\t\treturn filter.field(data, filter.type || {});// pass params to custom filter function\n\t\t\t};\n\t\t}else {\n\n\t\t\tif(Filter.filters[filter.type]){\n\n\t\t\t\tcolumn = this.table.columnManager.getColumnByField(filter.field);\n\n\t\t\t\tif(column){\n\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\treturn Filter.filters[filter.type](filter.value, column.getFieldValue(data), data, filter.params || {});\n\t\t\t\t\t};\n\t\t\t\t}else {\n\t\t\t\t\tfilterFunc = function(data){\n\t\t\t\t\t\treturn Filter.filters[filter.type](filter.value, data[filter.field], data, filter.params || {});\n\t\t\t\t\t};\n\t\t\t\t}\n\n\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Filter Error - No such filter type found, ignoring: \", filter.type);\n\t\t\t}\n\t\t}\n\n\t\tfilter.func = filterFunc;\n\n\t\treturn filter.func ? filter : false;\n\t}\n\n\tfindSubFilters(filters){\n\t\tvar output = [];\n\n\t\tfilters.forEach((filter) => {\n\t\t\tfilter = this.findFilter(filter);\n\n\t\t\tif(filter){\n\t\t\t\toutput.push(filter);\n\t\t\t}\n\t\t});\n\n\t\treturn output.length ? output : false;\n\t}\n\n\t//get all filters\n\tgetFilters(all, ajax){\n\t\tvar output = [];\n\n\t\tif(all){\n\t\t\toutput = this.getHeaderFilters();\n\t\t}\n\n\t\tif(ajax){\n\t\t\toutput.forEach(function(item){\n\t\t\t\tif(typeof item.type == \"function\"){\n\t\t\t\t\titem.type = \"function\";\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\toutput = output.concat(this.filtersToArray(this.filterList, ajax));\n\n\t\treturn output;\n\t}\n\n\t//filter to Object\n\tfiltersToArray(filterList, ajax){\n\t\tvar output = [];\n\n\t\tfilterList.forEach((filter) => {\n\t\t\tvar item;\n\n\t\t\tif(Array.isArray(filter)){\n\t\t\t\toutput.push(this.filtersToArray(filter, ajax));\n\t\t\t}else {\n\t\t\t\titem = {field:filter.field, type:filter.type, value:filter.value};\n\n\t\t\t\tif(ajax){\n\t\t\t\t\tif(typeof item.type == \"function\"){\n\t\t\t\t\t\titem.type = \"function\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toutput.push(item);\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\t//get all filters\n\tgetHeaderFilters(){\n\t\tvar output = [];\n\n\t\tfor(var key in this.headerFilters){\n\t\t\toutput.push({field:key, type:this.headerFilters[key].type, value:this.headerFilters[key].value});\n\t\t}\n\n\t\treturn output;\n\t}\n\n\t//remove filter from array\n\tremoveFilter(field, type, value){\n\t\tif(!Array.isArray(field)){\n\t\t\tfield = [{field:field, type:type, value:value}];\n\t\t}\n\n\t\tfield.forEach((filter) => {\n\t\t\tvar index = -1;\n\n\t\t\tif(typeof filter.field == \"object\"){\n\t\t\t\tindex = this.filterList.findIndex((element) => {\n\t\t\t\t\treturn filter === element;\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tindex = this.filterList.findIndex((element) => {\n\t\t\t\t\treturn filter.field === element.field && filter.type === element.type  && filter.value === element.value;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif(index > -1){\n\t\t\t\tthis.filterList.splice(index, 1);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Filter Error - No matching filter type found, ignoring: \", filter.type);\n\t\t\t}\n\t\t});\n\n\t\tthis.trackChanges();\n\t}\n\n\t//clear filters\n\tclearFilter(all){\n\t\tthis.filterList = [];\n\n\t\tif(all){\n\t\t\tthis.clearHeaderFilter();\n\t\t}\n\n\t\tthis.trackChanges();\n\t}\n\n\t//clear header filters\n\tclearHeaderFilter(){\n\t\tthis.headerFilters = {};\n\t\tthis.prevHeaderFilterChangeCheck = \"{}\";\n\n\t\tthis.headerFilterColumns.forEach((column) => {\n\t\t\tif(typeof column.modules.filter.value !== \"undefined\"){\n\t\t\t\tdelete column.modules.filter.value;\n\t\t\t}\n\t\t\tcolumn.modules.filter.prevSuccess = undefined;\n\t\t\tthis.reloadHeaderFilter(column);\n\t\t});\n\n\t\tthis.trackChanges();\n\t}\n\n\t//search data and return matching rows\n\tsearch (searchType, field, type, value){\n\t\tvar activeRows = [],\n\t\tfilterList = [];\n\n\t\tif(!Array.isArray(field)){\n\t\t\tfield = [{field:field, type:type, value:value}];\n\t\t}\n\n\t\tfield.forEach((filter) => {\n\t\t\tfilter = this.findFilter(filter);\n\n\t\t\tif(filter){\n\t\t\t\tfilterList.push(filter);\n\t\t\t}\n\t\t});\n\n\t\tthis.table.rowManager.rows.forEach((row) => {\n\t\t\tvar match = true;\n\n\t\t\tfilterList.forEach((filter) => {\n\t\t\t\tif(!this.filterRecurse(filter, row.getData())){\n\t\t\t\t\tmatch = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(match){\n\t\t\t\tactiveRows.push(searchType === \"data\" ? row.getData(\"data\") : row.getComponent());\n\t\t\t}\n\n\t\t});\n\n\t\treturn activeRows;\n\t}\n\n\t//filter row array\n\tfilter(rowList, filters){\n\t\tvar activeRows = [],\n\t\tactiveRowComponents = [];\n\n\t\tif(this.subscribedExternal(\"dataFiltering\")){\n\t\t\tthis.dispatchExternal(\"dataFiltering\", this.getFilters(true));\n\t\t}\n\n\t\tif(this.table.options.filterMode !== \"remote\" && (this.filterList.length || Object.keys(this.headerFilters).length)){\n\n\t\t\trowList.forEach((row) => {\n\t\t\t\tif(this.filterRow(row)){\n\t\t\t\t\tactiveRows.push(row);\n\t\t\t\t}\n\t\t\t});\n\n\t\t}else {\n\t\t\tactiveRows = rowList.slice(0);\n\t\t}\n\n\t\tif(this.subscribedExternal(\"dataFiltered\")){\n\n\t\t\tactiveRows.forEach((row) => {\n\t\t\t\tactiveRowComponents.push(row.getComponent());\n\t\t\t});\n\n\t\t\tthis.dispatchExternal(\"dataFiltered\", this.getFilters(true), activeRowComponents);\n\t\t}\n\n\t\treturn activeRows;\n\t}\n\n\t//filter individual row\n\tfilterRow(row, filters){\n\t\tvar match = true,\n\t\tdata = row.getData();\n\n\t\tthis.filterList.forEach((filter) => {\n\t\t\tif(!this.filterRecurse(filter, data)){\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t});\n\n\n\t\tfor(var field in this.headerFilters){\n\t\t\tif(!this.headerFilters[field].func(data)){\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t}\n\n\t\treturn match;\n\t}\n\n\tfilterRecurse(filter, data){\n\t\tvar match = false;\n\n\t\tif(Array.isArray(filter)){\n\t\t\tfilter.forEach((subFilter) => {\n\t\t\t\tif(this.filterRecurse(subFilter, data)){\n\t\t\t\t\tmatch = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\tmatch = filter.func(data);\n\t\t}\n\n\t\treturn match;\n\t}\n}\n\nfunction plaintext(cell, formatterParams, onRendered){\n\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n}\n\nfunction html(cell, formatterParams, onRendered){\n\treturn cell.getValue();\n}\n\nfunction textarea(cell, formatterParams, onRendered){\n\tcell.getElement().style.whiteSpace = \"pre-wrap\";\n\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n}\n\nfunction money(cell, formatterParams, onRendered){\n\tvar floatVal = parseFloat(cell.getValue()),\n\tsign = \"\",\n\tnumber, integer, decimal, rgx, value;\n\n\tvar decimalSym = formatterParams.decimal || \".\";\n\tvar thousandSym = formatterParams.thousand || \",\";\n\tvar negativeSign = formatterParams.negativeSign || \"-\";\n\tvar symbol = formatterParams.symbol || \"\";\n\tvar after = !!formatterParams.symbolAfter;\n\tvar precision = typeof formatterParams.precision !== \"undefined\" ? formatterParams.precision : 2;\n\n\tif(isNaN(floatVal)){\n\t\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n\t}\n\n\tif(floatVal < 0){\n\t\tfloatVal = Math.abs(floatVal);\n\t\tsign = negativeSign;\n\t}\n\n\tnumber = precision !== false ? floatVal.toFixed(precision) : floatVal;\n\tnumber = String(number).split(\".\");\n\n\tinteger = number[0];\n\tdecimal = number.length > 1 ? decimalSym + number[1] : \"\";\n\n\tif (formatterParams.thousand !== false) {\n\t\trgx = /(\\d+)(\\d{3})/;\n\n\t\twhile (rgx.test(integer)){\n\t\t\tinteger = integer.replace(rgx, \"$1\" + thousandSym + \"$2\");\n\t\t}\n\t}\n\n\tvalue = integer + decimal;\n\t\n\tif(sign === true){\n\t\tvalue = \"(\" + value  + \")\";\n\t\treturn after ? value + symbol : symbol + value;\n\t}else {\n\t\treturn after ? sign + value + symbol : sign + symbol + value;\n\t}\n}\n\nfunction link(cell, formatterParams, onRendered){\n\tvar value = cell.getValue(),\n\turlPrefix = formatterParams.urlPrefix || \"\",\n\tdownload = formatterParams.download,\n\tlabel = value,\n\tel = document.createElement(\"a\"),\n\tdata;\n\n\tfunction labelTraverse(path, data){\n\t\tvar item = path.shift(),\n\t\tvalue = data[item];\n\t\t\n\t\tif(path.length && typeof value === \"object\"){\n\t\t\treturn labelTraverse(path, value);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tif(formatterParams.labelField){\n\t\tdata = cell.getData();\n\t\tlabel = labelTraverse(formatterParams.labelField.split(this.table.options.nestedFieldSeparator), data);\n\t}\n\n\tif(formatterParams.label){\n\t\tswitch(typeof formatterParams.label){\n\t\t\tcase \"string\":\n\t\t\t\tlabel = formatterParams.label;\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tlabel = formatterParams.label(cell);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(label){\n\t\tif(formatterParams.urlField){\n\t\t\tdata = cell.getData();\n\n\t\t\tvalue = Helpers.retrieveNestedData(this.table.options.nestedFieldSeparator, formatterParams.urlField, data);\n\t\t}\n\n\t\tif(formatterParams.url){\n\t\t\tswitch(typeof formatterParams.url){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tvalue = formatterParams.url;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\tvalue = formatterParams.url(cell);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tel.setAttribute(\"href\", urlPrefix + value);\n\n\t\tif(formatterParams.target){\n\t\t\tel.setAttribute(\"target\", formatterParams.target);\n\t\t}\n\n\t\tif(formatterParams.download){\n\n\t\t\tif(typeof download == \"function\"){\n\t\t\t\tdownload = download(cell);\n\t\t\t}else {\n\t\t\t\tdownload = download === true ? \"\" : download;\n\t\t\t}\n\n\t\t\tel.setAttribute(\"download\", download);\n\t\t}\n\n\t\tel.innerHTML = this.emptyToSpace(this.sanitizeHTML(label));\n\n\t\treturn el;\n\t}else {\n\t\treturn \"&nbsp;\";\n\t}\n}\n\nfunction image(cell, formatterParams, onRendered){\n\tvar el = document.createElement(\"img\"),\n\tsrc = cell.getValue();\n\n\tif(formatterParams.urlPrefix){\n\t\tsrc = formatterParams.urlPrefix + cell.getValue();\n\t}\n\n\tif(formatterParams.urlSuffix){\n\t\tsrc = src + formatterParams.urlSuffix;\n\t}\n\n\tel.setAttribute(\"src\", src);\n\n\tswitch(typeof formatterParams.height){\n\t\tcase \"number\":\n\t\t\tel.style.height = formatterParams.height + \"px\";\n\t\t\tbreak;\n\n\t\tcase \"string\":\n\t\t\tel.style.height = formatterParams.height;\n\t\t\tbreak;\n\t}\n\n\tswitch(typeof formatterParams.width){\n\t\tcase \"number\":\n\t\t\tel.style.width = formatterParams.width + \"px\";\n\t\t\tbreak;\n\n\t\tcase \"string\":\n\t\t\tel.style.width = formatterParams.width;\n\t\t\tbreak;\n\t}\n\n\tel.addEventListener(\"load\", function(){\n\t\tcell.getRow().normalizeHeight();\n\t});\n\n\treturn el;\n}\n\nfunction tickCross(cell, formatterParams, onRendered){\n\tvar value = cell.getValue(),\n\telement = cell.getElement(),\n\tempty = formatterParams.allowEmpty,\n\ttruthy = formatterParams.allowTruthy,\n\ttrueValueSet = Object.keys(formatterParams).includes(\"trueValue\"),\n\ttick = typeof formatterParams.tickElement !== \"undefined\" ? formatterParams.tickElement : '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#2DC214\" clip-rule=\"evenodd\" d=\"M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z\" fill-rule=\"evenodd\"/></svg>',\n\tcross = typeof formatterParams.crossElement !== \"undefined\" ? formatterParams.crossElement : '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\"  viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#CE1515\" d=\"M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z\"/></svg>';\n\n\tif((trueValueSet && value === formatterParams.trueValue) || (!trueValueSet && ((truthy && value) || (value === true || value === \"true\" || value === \"True\" || value === 1 || value === \"1\")))){\n\t\telement.setAttribute(\"aria-checked\", true);\n\t\treturn tick || \"\";\n\t}else {\n\t\tif(empty && (value === \"null\" || value === \"\" || value === null || typeof value === \"undefined\")){\n\t\t\telement.setAttribute(\"aria-checked\", \"mixed\");\n\t\t\treturn \"\";\n\t\t}else {\n\t\t\telement.setAttribute(\"aria-checked\", false);\n\t\t\treturn cross || \"\";\n\t\t}\n\t}\n}\n\nfunction datetime$1(cell, formatterParams, onRendered){\n\tvar DT = this.table.dependencyRegistry.lookup([\"luxon\", \"DateTime\"], \"DateTime\");\n\tvar inputFormat = formatterParams.inputFormat || \"yyyy-MM-dd HH:mm:ss\";\n\tvar\toutputFormat = formatterParams.outputFormat || \"dd/MM/yyyy HH:mm:ss\";\n\tvar\tinvalid = typeof formatterParams.invalidPlaceholder !== \"undefined\" ? formatterParams.invalidPlaceholder : \"\";\n\tvar value = cell.getValue();\n\n\tif(typeof DT != \"undefined\"){\n\t\tvar newDatetime;\n\n\t\tif(DT.isDateTime(value)){\n\t\t\tnewDatetime = value;\n\t\t}else if(inputFormat === \"iso\"){\n\t\t\tnewDatetime = DT.fromISO(String(value));\n\t\t}else {\n\t\t\tnewDatetime = DT.fromFormat(String(value), inputFormat);\n\t\t}\n\n\t\tif(newDatetime.isValid){\n\t\t\tif(formatterParams.timezone){\n\t\t\t\tnewDatetime = newDatetime.setZone(formatterParams.timezone);\n\t\t\t}\n\n\t\t\treturn newDatetime.toFormat(outputFormat);\n\t\t}else {\n\t\t\tif(invalid === true || !value){\n\t\t\t\treturn value;\n\t\t\t}else if(typeof invalid === \"function\"){\n\t\t\t\treturn invalid(value);\n\t\t\t}else {\n\t\t\t\treturn invalid;\n\t\t\t}\n\t\t}\n\t}else {\n\t\tconsole.error(\"Format Error - 'datetime' formatter is dependant on luxon.js\");\n\t}\n}\n\nfunction datetimediff (cell, formatterParams, onRendered) {\n\tvar DT = this.table.dependencyRegistry.lookup([\"luxon\", \"DateTime\"], \"DateTime\");\n\tvar inputFormat = formatterParams.inputFormat || \"yyyy-MM-dd HH:mm:ss\";\n\tvar invalid = typeof formatterParams.invalidPlaceholder !== \"undefined\" ? formatterParams.invalidPlaceholder : \"\";\n\tvar suffix = typeof formatterParams.suffix !== \"undefined\" ? formatterParams.suffix : false;\n\tvar unit = typeof formatterParams.unit !== \"undefined\" ? formatterParams.unit : \"days\";\n\tvar humanize = typeof formatterParams.humanize !== \"undefined\" ? formatterParams.humanize : false;\n\tvar date = typeof formatterParams.date !== \"undefined\" ? formatterParams.date : DT.now();\n\tvar value = cell.getValue();\n\n\tif(typeof DT != \"undefined\"){\n\t\tvar newDatetime;\n\n\t\tif(DT.isDateTime(value)){\n\t\t\tnewDatetime = value;\n\t\t}else if(inputFormat === \"iso\"){\n\t\t\tnewDatetime = DT.fromISO(String(value));\n\t\t}else {\n\t\t\tnewDatetime = DT.fromFormat(String(value), inputFormat);\n\t\t}\n\n\t\tif (newDatetime.isValid){\n\t\t\tif(humanize){\n\t\t\t\treturn newDatetime.diff(date, unit).toHuman()  + (suffix ? \" \" + suffix : \"\");\n\t\t\t}else {\n\t\t\t\treturn parseInt(newDatetime.diff(date, unit)[unit]) + (suffix ? \" \" + suffix : \"\");\n\t\t\t}\n\t\t} else {\n\n\t\t\tif (invalid === true) {\n\t\t\t\treturn value;\n\t\t\t} else if (typeof invalid === \"function\") {\n\t\t\t\treturn invalid(value);\n\t\t\t} else {\n\t\t\t\treturn invalid;\n\t\t\t}\n\t\t}\n\t}else {\n\t\tconsole.error(\"Format Error - 'datetimediff' formatter is dependant on luxon.js\");\n\t}\n}\n\nfunction lookup (cell, formatterParams, onRendered) {\n\tvar value = cell.getValue();\n\n\tif (typeof formatterParams[value] === \"undefined\") {\n\t\tconsole.warn('Missing display value for ' + value);\n\t\treturn value;\n\t}\n\n\treturn formatterParams[value];\n}\n\nfunction star(cell, formatterParams, onRendered){\n\tvar value = cell.getValue(),\n\telement = cell.getElement(),\n\tmaxStars = formatterParams && formatterParams.stars ? formatterParams.stars : 5,\n\tstars = document.createElement(\"span\"),\n\tstar = document.createElementNS('http://www.w3.org/2000/svg', \"svg\"),\n\tstarActive = '<polygon fill=\"#FFEA00\" stroke=\"#C1AB60\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>',\n\tstarInactive = '<polygon fill=\"#D2D2D2\" stroke=\"#686868\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\n\t//style stars holder\n\tstars.style.verticalAlign = \"middle\";\n\n\t//style star\n\tstar.setAttribute(\"width\", \"14\");\n\tstar.setAttribute(\"height\", \"14\");\n\tstar.setAttribute(\"viewBox\", \"0 0 512 512\");\n\tstar.setAttribute(\"xml:space\", \"preserve\");\n\tstar.style.padding = \"0 1px\";\n\n\tvalue = value && !isNaN(value) ? parseInt(value) : 0;\n\n\tvalue = Math.max(0, Math.min(value, maxStars));\n\n\tfor(var i=1;i<= maxStars;i++){\n\t\tvar nextStar = star.cloneNode(true);\n\t\tnextStar.innerHTML = i <= value ? starActive : starInactive;\n\n\t\tstars.appendChild(nextStar);\n\t}\n\n\telement.style.whiteSpace = \"nowrap\";\n\telement.style.overflow = \"hidden\";\n\telement.style.textOverflow = \"ellipsis\";\n\n\telement.setAttribute(\"aria-label\", value);\n\n\treturn stars;\n}\n\nfunction traffic(cell, formatterParams, onRendered){\n\tvar value = this.sanitizeHTML(cell.getValue()) || 0,\n\tel = document.createElement(\"span\"),\n\tmax = formatterParams && formatterParams.max ? formatterParams.max : 100,\n\tmin = formatterParams && formatterParams.min ? formatterParams.min : 0,\n\tcolors = formatterParams && typeof formatterParams.color !== \"undefined\" ? formatterParams.color : [\"red\", \"orange\", \"green\"],\n\tcolor = \"#666666\",\n\tpercent, percentValue;\n\n\tif(isNaN(value) || typeof cell.getValue() === \"undefined\"){\n\t\treturn;\n\t}\n\n\tel.classList.add(\"tabulator-traffic-light\");\n\n\t//make sure value is in range\n\tpercentValue = parseFloat(value) <= max ? parseFloat(value) : max;\n\tpercentValue = parseFloat(percentValue) >= min ? parseFloat(percentValue) : min;\n\n\t//workout percentage\n\tpercent = (max - min) / 100;\n\tpercentValue = Math.round((percentValue - min) / percent);\n\n\t//set color\n\tswitch(typeof colors){\n\t\tcase \"string\":\n\t\t\tcolor = colors;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tcolor = colors(value);\n\t\t\tbreak;\n\t\tcase \"object\":\n\t\t\tif(Array.isArray(colors)){\n\t\t\t\tvar unit = 100 / colors.length;\n\t\t\t\tvar index = Math.floor(percentValue / unit);\n\n\t\t\t\tindex = Math.min(index, colors.length - 1);\n\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\tcolor = colors[index];\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\n\tel.style.backgroundColor = color;\n\n\treturn el;\n}\n\nfunction progress(cell, formatterParams = {}, onRendered){ //progress bar\n\tvar value = this.sanitizeHTML(cell.getValue()) || 0,\n\telement = cell.getElement(),\n\tmax = formatterParams.max ? formatterParams.max : 100,\n\tmin = formatterParams.min ? formatterParams.min : 0,\n\tlegendAlign = formatterParams.legendAlign ? formatterParams.legendAlign : \"center\",\n\tpercent, percentValue, color, legend, legendColor;\n\n\t//make sure value is in range\n\tpercentValue = parseFloat(value) <= max ? parseFloat(value) : max;\n\tpercentValue = parseFloat(percentValue) >= min ? parseFloat(percentValue) : min;\n\n\t//workout percentage\n\tpercent = (max - min) / 100;\n\tpercentValue = Math.round((percentValue - min) / percent);\n\n\t//set bar color\n\tswitch(typeof formatterParams.color){\n\t\tcase \"string\":\n\t\t\tcolor = formatterParams.color;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tcolor = formatterParams.color(value);\n\t\t\tbreak;\n\t\tcase \"object\":\n\t\t\tif(Array.isArray(formatterParams.color)){\n\t\t\t\tlet unit = 100 / formatterParams.color.length;\n\t\t\t\tlet index = Math.floor(percentValue / unit);\n\n\t\t\t\tindex = Math.min(index, formatterParams.color.length - 1);\n\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\tcolor = formatterParams.color[index];\n\t\t\t\tbreak;\n\t\t\t}\n\t\tdefault:\n\t\t\tcolor = \"#2DC214\";\n\t}\n\n\t//generate legend\n\tswitch(typeof formatterParams.legend){\n\t\tcase \"string\":\n\t\t\tlegend = formatterParams.legend;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tlegend = formatterParams.legend(value);\n\t\t\tbreak;\n\t\tcase \"boolean\":\n\t\t\tlegend = value;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlegend = false;\n\t}\n\n\t//set legend color\n\tswitch(typeof formatterParams.legendColor){\n\t\tcase \"string\":\n\t\t\tlegendColor = formatterParams.legendColor;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tlegendColor = formatterParams.legendColor(value);\n\t\t\tbreak;\n\t\tcase \"object\":\n\t\t\tif(Array.isArray(formatterParams.legendColor)){\n\t\t\t\tlet unit = 100 / formatterParams.legendColor.length;\n\t\t\t\tlet index = Math.floor(percentValue / unit);\n\n\t\t\t\tindex = Math.min(index, formatterParams.legendColor.length - 1);\n\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\tlegendColor = formatterParams.legendColor[index];\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlegendColor = \"#000\";\n\t}\n\n\telement.style.minWidth = \"30px\";\n\telement.style.position = \"relative\";\n\n\telement.setAttribute(\"aria-label\", percentValue);\n\n\tvar barEl = document.createElement(\"div\");\n\tbarEl.style.display = \"inline-block\";\n\tbarEl.style.width = percentValue + \"%\";\n\tbarEl.style.backgroundColor = color;\n\tbarEl.style.height = \"100%\";\n\n\tbarEl.setAttribute('data-max', max);\n\tbarEl.setAttribute('data-min', min);\n\n\tvar barContainer = document.createElement(\"div\");\n\tbarContainer.style.position = \"relative\";\n\tbarContainer.style.width = \"100%\";\n\tbarContainer.style.height = \"100%\";\n\n\tif(legend){\n\t\tvar legendEl = document.createElement(\"div\");\n\t\tlegendEl.style.position = \"absolute\";\n\t\tlegendEl.style.top = 0;\n\t\tlegendEl.style.left = 0;\n\t\tlegendEl.style.textAlign = legendAlign;\n\t\tlegendEl.style.width = \"100%\";\n\t\tlegendEl.style.color = legendColor;\n\t\tlegendEl.innerHTML = legend;\n\t}\n\n\tonRendered(function(){\n\n\t\t//handle custom element needed if formatter is to be included in printed/downloaded output\n\t\tif(!(cell instanceof CellComponent)){\n\t\t\tvar holderEl = document.createElement(\"div\");\n\t\t\tholderEl.style.position = \"absolute\";\n\t\t\tholderEl.style.top = \"4px\";\n\t\t\tholderEl.style.bottom = \"4px\";\n\t\t\tholderEl.style.left = \"4px\";\n\t\t\tholderEl.style.right = \"4px\";\n\n\t\t\telement.appendChild(holderEl);\n\n\t\t\telement = holderEl;\n\t\t}\n\n\t\telement.appendChild(barContainer);\n\t\tbarContainer.appendChild(barEl);\n\n\t\tif(legend){\n\t\t\tbarContainer.appendChild(legendEl);\n\t\t}\n\t});\n\n\treturn \"\";\n}\n\nfunction color(cell, formatterParams, onRendered){\n\tcell.getElement().style.backgroundColor = this.sanitizeHTML(cell.getValue());\n\treturn \"\";\n}\n\nfunction buttonTick(cell, formatterParams, onRendered){\n\treturn '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#2DC214\" clip-rule=\"evenodd\" d=\"M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z\" fill-rule=\"evenodd\"/></svg>';\n}\n\nfunction buttonCross(cell, formatterParams, onRendered){\n\treturn '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#CE1515\" d=\"M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z\"/></svg>';\n}\n\nfunction toggle(cell, formatterParams, onRendered){\r\n\tvar value = cell.getValue(),\r\n\tsize = formatterParams.size ||15,\r\n\tsizePx = size + \"px\",\r\n\tcontainEl, switchEl,\r\n\tonValue = formatterParams.hasOwnProperty(\"onValue\") ? formatterParams.onValue : true,\r\n\toffValue = formatterParams.hasOwnProperty(\"offValue\") ? formatterParams.offValue : false,\r\n\r\n\r\n\tstate = formatterParams.onTruthy ? value : value === onValue;\r\n\r\n\t\r\n\tcontainEl = document.createElement(\"div\");\r\n\tcontainEl.classList.add(\"tabulator-toggle\");\r\n\r\n\tif(state){\r\n\t\tcontainEl.classList.add(\"tabulator-toggle-on\");\r\n\t\tcontainEl.style.flexDirection = \"row-reverse\";\r\n\r\n\t\tif(formatterParams.onColor){\r\n\t\t\tcontainEl.style.background = formatterParams.onColor;\r\n\t\t}\r\n\t}else {\r\n\t\tif(formatterParams.offColor){\r\n\t\t\tcontainEl.style.background = formatterParams.offColor;\r\n\t\t}\r\n\t}\r\n\r\n\tcontainEl.style.width = (2.5 * size) + \"px\";\r\n\tcontainEl.style.borderRadius = sizePx;\r\n\r\n\tif(formatterParams.clickable){\r\n\t\tcontainEl.addEventListener(\"click\", (e) => {\r\n\t\t\tcell.setValue(state ? offValue : onValue);\r\n\t\t});\r\n\t}\r\n\r\n\tswitchEl = document.createElement(\"div\");\r\n\tswitchEl.classList.add(\"tabulator-toggle-switch\");\r\n\r\n\tswitchEl.style.height = sizePx;\r\n\tswitchEl.style.width = sizePx;\r\n\tswitchEl.style.borderRadius = sizePx;\r\n\t\r\n\tcontainEl.appendChild(switchEl);\r\n\t\r\n\treturn containEl;\r\n}\n\nfunction rownum(cell, formatterParams, onRendered){\n\tvar content = document.createElement(\"span\");\n\tvar row = cell.getRow();\n\tvar table = cell.getTable();\n\n\trow.watchPosition((position) => {\n\t\tif (formatterParams.relativeToPage) {\n\t\t\tposition += table.modules.page.getPageSize() * (table.modules.page.getPage() - 1);\n\t\t}\n\t\tcontent.innerText = position;\n\t});\n\t\n\treturn content;\n}\n\nfunction handle(cell, formatterParams, onRendered){\n\tcell.getElement().classList.add(\"tabulator-row-handle\");\n\treturn \"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>\";\n}\n\nfunction adaptable(cell, params, onRendered){\r\n\tvar lookup, formatterFunc, formatterParams;\r\n    \r\n\tfunction defaultLookup(cell){\r\n\t\tvar value = cell.getValue(),\r\n\t\tformatter = \"plaintext\";\r\n        \r\n\t\tswitch(typeof value){           \r\n\t\t\tcase \"boolean\":\r\n\t\t\t\tformatter = \"tickCross\";\r\n\t\t\t\tbreak;\r\n            \r\n\t\t\tcase \"string\":\r\n\t\t\t\tif(value.includes(\"\\n\")){\r\n\t\t\t\t\tformatter = \"textarea\";\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n        \r\n\t\treturn formatter;\r\n\t}\r\n    \r\n\tlookup = params.formatterLookup ? params.formatterLookup(cell) : defaultLookup(cell);\r\n\r\n\tif(params.paramsLookup){\r\n\t\tformatterParams = typeof params.paramsLookup === \"function\" ? params.paramsLookup(lookup, cell) : params.paramsLookup[lookup];\r\n\t}\r\n\r\n\tformatterFunc = this.table.modules.format.lookupFormatter(lookup);\r\n    \r\n\treturn  formatterFunc.call(this, cell, formatterParams || {}, onRendered);\r\n}\n\nfunction array$2(cell, formatterParams, onRendered){\n\tvar delimiter = formatterParams.delimiter || \",\",\n\tvalue = cell.getValue(),\n\ttable = this.table,\n\tvalueMap;\n\t\n\tif(formatterParams.valueMap){\n\t\tif(typeof formatterParams.valueMap === \"string\"){\n\t\t\tvalueMap = function(value){\n\t\t\t\treturn value.map((item) => {\n\t\t\t\t\treturn Helpers.retrieveNestedData(table.options.nestedFieldSeparator, formatterParams.valueMap, item);\n\t\t\t\t});\n\t\t\t};\n\t\t}else {\n\t\t\tvalueMap = formatterParams.valueMap;\n\t\t}\n\t}\n\n\tif(Array.isArray(value)){\n\t\tif(valueMap){\n\t\t\tvalue = valueMap(value);\n\t\t}\n\n\t\treturn value.join(delimiter);\n\t}else {\n\t\treturn value;\n\t}\n}\n\nfunction json$1(cell, formatterParams, onRendered){\n\tvar indent = formatterParams.indent || \"\\t\",\n\tmultiline = typeof formatterParams.multiline === \"undefined\" ? true : formatterParams.multiline,\n\treplacer = formatterParams.replacer || null,\n\tvalue = cell.getValue();\n\t\n\tif(multiline){\n\t\tcell.getElement().style.whiteSpace = \"pre-wrap\";\n\t}\n\n\treturn JSON.stringify(value, replacer, indent);\n}\n\nvar defaultFormatters = {\n\tplaintext:plaintext,\n\thtml:html,\n\ttextarea:textarea,\n\tmoney:money,\n\tlink:link,\n\timage:image,\n\ttickCross:tickCross,\n\tdatetime:datetime$1,\n\tdatetimediff:datetimediff,\n\tlookup:lookup,\n\tstar:star,\n\ttraffic:traffic,\n\tprogress:progress,\n\tcolor:color,\n\tbuttonTick:buttonTick,\n\tbuttonCross:buttonCross,\n\ttoggle:toggle,\n\trownum:rownum,\n\thandle:handle,\n\tadaptable:adaptable,\n\tarray:array$2,\n\tjson:json$1,\n};\n\nclass Format extends Module{\n\t\n\tstatic moduleName = \"format\";\n\t\n\t//load defaults\n\tstatic formatters = defaultFormatters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.registerColumnOption(\"formatter\");\n\t\tthis.registerColumnOption(\"formatterParams\");\n\t\t\n\t\tthis.registerColumnOption(\"formatterPrint\");\n\t\tthis.registerColumnOption(\"formatterPrintParams\");\n\t\tthis.registerColumnOption(\"formatterClipboard\");\n\t\tthis.registerColumnOption(\"formatterClipboardParams\");\n\t\tthis.registerColumnOption(\"formatterHtmlOutput\");\n\t\tthis.registerColumnOption(\"formatterHtmlOutputParams\");\n\t\tthis.registerColumnOption(\"titleFormatter\");\n\t\tthis.registerColumnOption(\"titleFormatterParams\");\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"cell-format\", this.formatValue.bind(this));\n\t\tthis.subscribe(\"cell-rendered\", this.cellRendered.bind(this));\n\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"column-format\", this.formatHeader.bind(this));\n\t}\n\t\n\t//initialize column formatter\n\tinitializeColumn(column){\n\t\tcolumn.modules.format = this.lookupTypeFormatter(column, \"\");\n\t\t\n\t\tif(typeof column.definition.formatterPrint !== \"undefined\"){\n\t\t\tcolumn.modules.format.print = this.lookupTypeFormatter(column, \"Print\");\n\t\t}\n\t\t\n\t\tif(typeof column.definition.formatterClipboard !== \"undefined\"){\n\t\t\tcolumn.modules.format.clipboard = this.lookupTypeFormatter(column, \"Clipboard\");\n\t\t}\n\t\t\n\t\tif(typeof column.definition.formatterHtmlOutput !== \"undefined\"){\n\t\t\tcolumn.modules.format.htmlOutput = this.lookupTypeFormatter(column, \"HtmlOutput\");\n\t\t}\n\t}\n\t\n\tlookupTypeFormatter(column, type){\n\t\tvar config = {params:column.definition[\"formatter\" + type + \"Params\"] || {}},\n\t\tformatter = column.definition[\"formatter\" + type];\n\t\t\n\t\tconfig.formatter = this.lookupFormatter(formatter);\n\t\t\n\t\treturn config;\n\t}\n\t\n\t\n\tlookupFormatter(formatter){\n\t\tvar formatterFunc;\n\n\t\t//set column formatter\n\t\tswitch(typeof formatter){\n\t\t\tcase \"string\":\n\t\t\t\tif(Format.formatters[formatter]){\n\t\t\t\t\tformatterFunc = Format.formatters[formatter];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Formatter Error - No such formatter found: \", formatter);\n\t\t\t\t\tformatterFunc = Format.formatters.plaintext;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"function\":\n\t\t\t\tformatterFunc = formatter;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tformatterFunc = Format.formatters.plaintext;\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\treturn formatterFunc;\n\t}\n\t\n\tcellRendered(cell){\n\t\tif(cell.modules.format && cell.modules.format.renderedCallback && !cell.modules.format.rendered){\n\t\t\tcell.modules.format.renderedCallback();\n\t\t\tcell.modules.format.rendered = true;\n\t\t}\n\t}\n\t\n\t//return a formatted value for a column header\n\tformatHeader(column, title, el){\n\t\tvar formatter, params, onRendered, mockCell;\n\t\t\n\t\tif(column.definition.titleFormatter){\n\t\t\tformatter = this.lookupFormatter(column.definition.titleFormatter);\n\t\t\t\n\t\t\tonRendered = (callback) => {\n\t\t\t\tcolumn.titleFormatterRendered = callback;\n\t\t\t};\n\t\t\t\n\t\t\tmockCell = {\n\t\t\t\tgetValue:function(){\n\t\t\t\t\treturn title;\n\t\t\t\t},\n\t\t\t\tgetElement:function(){\n\t\t\t\t\treturn el;\n\t\t\t\t},\n\t\t\t\tgetType:function(){\n\t\t\t\t\treturn \"header\";\n\t\t\t\t},\n\t\t\t\tgetColumn:function(){\n\t\t\t\t\treturn column.getComponent();\n\t\t\t\t},\n\t\t\t\tgetTable:() => {\n\t\t\t\t\treturn this.table;\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\tparams = column.definition.titleFormatterParams || {};\n\t\t\t\n\t\t\tparams = typeof params === \"function\" ? params() : params;\n\t\t\t\n\t\t\treturn formatter.call(this, mockCell, params, onRendered);\n\t\t}else {\n\t\t\treturn title;\n\t\t}\n\t}\n\t\n\t\n\t//return a formatted value for a cell\n\tformatValue(cell){\n\t\tvar component = cell.getComponent(),\n\t\tparams = typeof cell.column.modules.format.params === \"function\" ? cell.column.modules.format.params(component) : cell.column.modules.format.params;\n\t\t\n\t\tfunction onRendered(callback){\n\t\t\tif(!cell.modules.format){\n\t\t\t\tcell.modules.format = {};\n\t\t\t}\n\t\t\t\n\t\t\tcell.modules.format.renderedCallback = callback;\n\t\t\tcell.modules.format.rendered = false;\n\t\t}\n\t\t\n\t\treturn cell.column.modules.format.formatter.call(this, component, params, onRendered);\n\t}\n\t\n\tformatExportValue(cell, type){\n\t\tvar formatter = cell.column.modules.format[type],\n\t\tparams;\n\t\t\n\t\tif(formatter){\n\t\t\tparams = typeof formatter.params === \"function\" ? formatter.params(cell.getComponent()) : formatter.params;\n\t\t\t\n\t\t\tfunction onRendered(callback){\n\t\t\t\tif(!cell.modules.format){\n\t\t\t\t\tcell.modules.format = {};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcell.modules.format.renderedCallback = callback;\n\t\t\t\tcell.modules.format.rendered = false;\n\t\t\t}\n\t\t\t\n\t\t\treturn formatter.formatter.call(this, cell.getComponent(), params, onRendered);\n\t\t\t\n\t\t}else {\n\t\t\treturn this.formatValue(cell);\n\t\t}\n\t}\n\t\n\tsanitizeHTML(value){\n\t\tif(value){\n\t\t\tvar entityMap = {\n\t\t\t\t'&': '&amp;',\n\t\t\t\t'<': '&lt;',\n\t\t\t\t'>': '&gt;',\n\t\t\t\t'\"': '&quot;',\n\t\t\t\t\"'\": '&#39;',\n\t\t\t\t'/': '&#x2F;',\n\t\t\t\t'`': '&#x60;',\n\t\t\t\t'=': '&#x3D;'\n\t\t\t};\n\t\t\t\n\t\t\treturn String(value).replace(/[&<>\"'`=/]/g, function (s) {\n\t\t\t\treturn entityMap[s];\n\t\t\t});\n\t\t}else {\n\t\t\treturn value;\n\t\t}\n\t}\n\t\n\temptyToSpace(value){\n\t\treturn value === null || typeof value === \"undefined\" || value === \"\" ? \"&nbsp;\" : value;\n\t}\n\t\n}\n\nclass FrozenColumns extends Module{\n\n\tstatic moduleName = \"frozenColumns\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.leftColumns = [];\n\t\tthis.rightColumns = [];\n\t\tthis.initializationMode = \"left\";\n\t\tthis.active = false;\n\t\tthis.blocked = true;\n\t\t\n\t\tthis.registerColumnOption(\"frozen\");\n\t}\n\t\n\t//reset initial state\n\treset(){\n\t\tthis.initializationMode = \"left\";\n\t\tthis.leftColumns = [];\n\t\tthis.rightColumns = [];\n\t\tthis.active = false;\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"cell-layout\", this.layoutCell.bind(this));\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"column-width\", this.layout.bind(this));\n\t\tthis.subscribe(\"row-layout-after\", this.layoutRow.bind(this));\n\t\tthis.subscribe(\"table-layout\", this.layout.bind(this));\n\t\tthis.subscribe(\"columns-loading\", this.reset.bind(this));\n\t\t\n\t\tthis.subscribe(\"column-add\", this.reinitializeColumns.bind(this));\n\t\tthis.subscribe(\"column-deleted\", this.reinitializeColumns.bind(this));\n\t\tthis.subscribe(\"column-hide\", this.reinitializeColumns.bind(this));\n\t\tthis.subscribe(\"column-show\", this.reinitializeColumns.bind(this));\n\t\tthis.subscribe(\"columns-loaded\", this.reinitializeColumns.bind(this));\n\t\t\n\t\tthis.subscribe(\"table-redraw\", this.layout.bind(this));\n\t\tthis.subscribe(\"layout-refreshing\", this.blockLayout.bind(this));\n\t\tthis.subscribe(\"layout-refreshed\", this.unblockLayout.bind(this));\n\t\tthis.subscribe(\"scrollbar-vertical\", this.adjustForScrollbar.bind(this));\n\t}\n\t\n\tblockLayout(){\n\t\tthis.blocked = true;\n\t}\n\t\n\tunblockLayout(){\n\t\tthis.blocked = false;\n\t}\n\t\n\tlayoutCell(cell){\n\t\tthis.layoutElement(cell.element, cell.column);\n\t}\n\t\n\treinitializeColumns(){\n\t\tthis.reset();\n\t\t\n\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\tthis.initializeColumn(column);\n\t\t});\n\n\t\tthis.layout();\n\t}\n\t\n\t//initialize specific column\n\tinitializeColumn(column){\n\t\tvar config = {margin:0, edge:false};\n\t\t\n\t\tif(!column.isGroup){\t\t\t\n\t\t\tif(this.frozenCheck(column)){\n\t\t\t\tconfig.position = this.initializationMode;\n\t\t\t\t\n\t\t\t\tif(this.initializationMode == \"left\"){\n\t\t\t\t\tthis.leftColumns.push(column);\n\t\t\t\t}else {\n\t\t\t\t\tthis.rightColumns.unshift(column);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.active = true;\n\t\t\t\t\n\t\t\t\tcolumn.modules.frozen = config;\n\t\t\t}else {\n\t\t\t\tthis.initializationMode = \"right\";\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfrozenCheck(column){\n\t\tif(column.parent.isGroup && column.definition.frozen){\n\t\t\tconsole.warn(\"Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups\");\n\t\t}\n\t\t\n\t\tif(column.parent.isGroup){\n\t\t\treturn this.frozenCheck(column.parent);\n\t\t}else {\n\t\t\treturn column.definition.frozen;\n\t\t}\n\t}\n\t\n\t//layout calculation rows\n\tlayoutCalcRows(){\n\t\tif(this.table.modExists(\"columnCalcs\")){\n\t\t\tif(this.table.modules.columnCalcs.topInitialized && this.table.modules.columnCalcs.topRow){\n\t\t\t\tthis.layoutRow(this.table.modules.columnCalcs.topRow);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.modules.columnCalcs.botInitialized && this.table.modules.columnCalcs.botRow){\n\t\t\t\tthis.layoutRow(this.table.modules.columnCalcs.botRow);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.modExists(\"groupRows\")){\n\t\t\t\tthis.layoutGroupCalcs(this.table.modules.groupRows.getGroups());\n\t\t\t}\n\t\t}\n\t}\n\t\n\tlayoutGroupCalcs(groups){\n\t\tgroups.forEach((group) => {\n\t\t\tif(group.calcs.top){\n\t\t\t\tthis.layoutRow(group.calcs.top);\n\t\t\t}\n\t\t\t\n\t\t\tif(group.calcs.bottom){\n\t\t\t\tthis.layoutRow(group.calcs.bottom);\n\t\t\t}\n\t\t\t\n\t\t\tif(group.groupList && group.groupList.length){\n\t\t\t\tthis.layoutGroupCalcs(group.groupList);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//calculate column positions and layout headers\n\tlayoutColumnPosition(allCells){\n\t\tvar leftParents = [];\n\t\t\n\t\tvar leftMargin = 0;\n\t\tvar rightMargin = 0;\n\t\t\n\t\tthis.leftColumns.forEach((column, i) => {\t\n\t\t\tcolumn.modules.frozen.marginValue = leftMargin;\n\t\t\tcolumn.modules.frozen.margin = column.modules.frozen.marginValue + \"px\";\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\tleftMargin += column.getWidth();\n\t\t\t}\n\t\t\t\n\t\t\tif(i == this.leftColumns.length - 1){\n\t\t\t\tcolumn.modules.frozen.edge = true;\n\t\t\t}else {\n\t\t\t\tcolumn.modules.frozen.edge = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(column.parent.isGroup){\n\t\t\t\tvar parentEl = this.getColGroupParentElement(column);\n\t\t\t\tif(!leftParents.includes(parentEl)){\n\t\t\t\t\tthis.layoutElement(parentEl, column);\n\t\t\t\t\tleftParents.push(parentEl);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tparentEl.classList.toggle(\"tabulator-frozen-left\",  column.modules.frozen.edge && column.modules.frozen.position === \"left\");\n\t\t\t\tparentEl.classList.toggle(\"tabulator-frozen-right\", column.modules.frozen.edge && column.modules.frozen.position === \"right\");\n\t\t\t}else {\n\t\t\t\tthis.layoutElement(column.getElement(), column);\n\t\t\t}\n\t\t\t\n\t\t\tif(allCells){\n\t\t\t\tcolumn.cells.forEach((cell) => {\n\t\t\t\t\tthis.layoutElement(cell.getElement(true), column);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.rightColumns.forEach((column, i) => {\n\t\t\t\n\t\t\tcolumn.modules.frozen.marginValue = rightMargin;\n\t\t\tcolumn.modules.frozen.margin = column.modules.frozen.marginValue + \"px\";\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\trightMargin += column.getWidth();\n\t\t\t}\n\t\t\t\n\t\t\tif(i == this.rightColumns.length - 1){\n\t\t\t\tcolumn.modules.frozen.edge = true;\n\t\t\t}else {\n\t\t\t\tcolumn.modules.frozen.edge = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(column.parent.isGroup){\n\t\t\t\tthis.layoutElement(this.getColGroupParentElement(column), column);\n\t\t\t}else {\n\t\t\t\tthis.layoutElement(column.getElement(), column);\n\t\t\t}\n\t\t\t\n\t\t\tif(allCells){\n\t\t\t\tcolumn.cells.forEach((cell) => {\n\t\t\t\t\tthis.layoutElement(cell.getElement(true), column);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\t\n\tgetColGroupParentElement(column){\n\t\treturn column.parent.isGroup ? this.getColGroupParentElement(column.parent) : column.getElement();\n\t}\n\t\n\t//layout columns appropriately\n\tlayout(){\t\n\t\tif(this.active && !this.blocked){\n\t\t\t//calculate left columns\n\t\t\tthis.layoutColumnPosition();\n\t\t\t\n\t\t\tthis.reinitializeRows();\n\t\t\t\n\t\t\tthis.layoutCalcRows();\n\t\t}\n\t}\n\t\n\treinitializeRows(){\n\t\tvar visibleRows = this.table.rowManager.getVisibleRows(true);\n\t\tvar otherRows = this.table.rowManager.getRows().filter(row => !visibleRows.includes(row));\n\t\t\n\t\totherRows.forEach((row) =>{\n\t\t\trow.deinitialize();\n\t\t});\n\t\t\n\t\tvisibleRows.forEach((row) =>{\n\t\t\tif(row.type === \"row\"){\n\t\t\t\tthis.layoutRow(row);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tlayoutRow(row){\n\t\tif(this.table.options.layout === \"fitDataFill\" && this.rightColumns.length){\n\t\t\tthis.table.rowManager.getTableElement().style.minWidth = \"calc(100% - \" + this.rightMargin + \")\";\n\t\t}\n\t\t\n\t\tthis.leftColumns.forEach((column) => {\n\t\t\tvar cell = row.getCell(column);\n\t\t\t\n\t\t\tif(cell){\n\t\t\t\tthis.layoutElement(cell.getElement(true), column);\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.rightColumns.forEach((column) => {\n\t\t\tvar cell = row.getCell(column);\n\t\t\t\n\t\t\tif(cell){\n\t\t\t\tthis.layoutElement(cell.getElement(true), column);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tlayoutElement(element, column){\n\t\tvar position;\n\t\t\n\t\tif(column.modules.frozen && element){\n\t\t\telement.style.position = \"sticky\";\n\n\t\t\tif(this.table.rtl){\n\t\t\t\tposition = column.modules.frozen.position === \"left\" ? \"right\" : \"left\";\n\t\t\t}else {\n\t\t\t\tposition = column.modules.frozen.position;\n\t\t\t}\n\t\t\n\t\t\telement.style[position] = column.modules.frozen.margin;\n\n\t\t\telement.classList.add(\"tabulator-frozen\");\n\t\t\t\n\t\t\telement.classList.toggle(\"tabulator-frozen-left\",  column.modules.frozen.edge && column.modules.frozen.position === \"left\");\n\t\t\telement.classList.toggle(\"tabulator-frozen-right\", column.modules.frozen.edge && column.modules.frozen.position === \"right\");\n\t\t}\n\t}\n\n\tadjustForScrollbar(width){\n\t\tif(this.rightColumns.length){\n\t\t\tthis.table.columnManager.getContentsElement().style.width = \"calc(100% - \" + width + \"px)\";\n\t\t}\n\t}\n\n\tgetFrozenColumns(){\n\t\treturn this.leftColumns.concat(this.rightColumns);\n\t}\n\t\n\t_calcSpace(columns, index){\n\t\tvar width = 0;\n\t\t\n\t\tfor (let i = 0; i < index; i++){\n\t\t\tif(columns[i].visible){\n\t\t\t\twidth += columns[i].getWidth();\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn width;\n\t}\n}\n\nclass FrozenRows extends Module{\n\n\tstatic moduleName = \"frozenRows\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.topElement = document.createElement(\"div\");\n\t\tthis.rows = [];\n\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"freeze\", this.freezeRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"unfreeze\", this.unfreezeRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"isFrozen\", this.isRowFrozen.bind(this));\n\n\t\t//register table options\n\t\tthis.registerTableOption(\"frozenRowsField\", \"id\"); //field to choose frozen rows by\n\t\tthis.registerTableOption(\"frozenRows\", false); //holder for frozen row identifiers\n\t}\n\n\tinitialize(){\n\t\tvar\tfragment = document.createDocumentFragment();\n\t\t\n\t\tthis.rows = [];\n\n\t\tthis.topElement.classList.add(\"tabulator-frozen-rows-holder\");\n\t\t\n\t\tfragment.appendChild(document.createElement(\"br\"));\n\t\tfragment.appendChild(this.topElement);\n\n\t\t// this.table.columnManager.element.append(this.topElement);\n\t\tthis.table.columnManager.getContentsElement().insertBefore(fragment, this.table.columnManager.headersElement.nextSibling);\n\n\t\tthis.subscribe(\"row-deleting\", this.detachRow.bind(this));\n\t\tthis.subscribe(\"rows-visible\", this.visibleRows.bind(this));\n\n\t\tthis.registerDisplayHandler(this.getRows.bind(this), 10);\n\n\t\tif(this.table.options.frozenRows){\n\t\t\tthis.subscribe(\"data-processed\", this.initializeRows.bind(this));\n\t\t\tthis.subscribe(\"row-added\", this.initializeRow.bind(this));\n\t\t\tthis.subscribe(\"table-redrawing\", this.resizeHolderWidth.bind(this));\n\t\t\tthis.subscribe(\"column-resized\", this.resizeHolderWidth.bind(this));\n\t\t\tthis.subscribe(\"column-show\", this.resizeHolderWidth.bind(this));\n\t\t\tthis.subscribe(\"column-hide\", this.resizeHolderWidth.bind(this));\n\t\t}\n\n\t\tthis.resizeHolderWidth();\n\t}\n\n\tresizeHolderWidth(){\n\t\tthis.topElement.style.minWidth = this.table.columnManager.headersElement.offsetWidth + \"px\";\n\t}\n\n\tinitializeRows(){\n\t\tthis.table.rowManager.getRows().forEach((row) => {\n\t\t\tthis.initializeRow(row);\n\t\t});\n\t}\n\n\tinitializeRow(row){\n\t\tvar frozenRows = this.table.options.frozenRows,\n\t\trowType = typeof frozenRows;\n\n\t\tif(rowType === \"number\"){\n\t\t\tif(row.getPosition() && (row.getPosition() + this.rows.length) <= frozenRows){\n\t\t\t\tthis.freezeRow(row);\n\t\t\t}\n\t\t}else if(rowType === \"function\"){\n\t\t\tif(frozenRows.call(this.table, row.getComponent())){\n\t\t\t\tthis.freezeRow(row);\n\t\t\t}\n\t\t}else if(Array.isArray(frozenRows)){\n\t\t\tif(frozenRows.includes(row.data[this.options(\"frozenRowsField\")])){\n\t\t\t\tthis.freezeRow(row);\n\t\t\t}\n\t\t}\n\t}\n\n\tisRowFrozen(row){\n\t\tvar index = this.rows.indexOf(row);\n\t\treturn index > -1;\n\t}\n\n\tisFrozen(){\n\t\treturn !!this.rows.length;\n\t}\n\n\tvisibleRows(viewable, rows){\n\t\tthis.rows.forEach((row) => {\n\t\t\trows.push(row);\n\t\t});\n\n\t\treturn rows;\n\t}\n\n\t//filter frozen rows out of display data\n\tgetRows(rows){\n\t\tvar output = rows.slice(0);\n\n\t\tthis.rows.forEach(function(row){\n\t\t\tvar index = output.indexOf(row);\n\n\t\t\tif(index > -1){\n\t\t\t\toutput.splice(index, 1);\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\tfreezeRow(row){\n\t\tif(!row.modules.frozen){\n\t\t\trow.modules.frozen = true;\n\t\t\tthis.topElement.appendChild(row.getElement());\n\t\t\trow.initialize();\n\t\t\trow.normalizeHeight();\n\t\t\n\t\t\tthis.rows.push(row);\n\n\t\t\tthis.refreshData(false, \"display\");\n\n\t\t\tthis.table.rowManager.adjustTableSize();\n\n\t\t\tthis.styleRows();\n\n\t\t}else {\n\t\t\tconsole.warn(\"Freeze Error - Row is already frozen\");\n\t\t}\n\t}\n\n\tunfreezeRow(row){\n\t\tif(row.modules.frozen){\n\n\t\t\trow.modules.frozen = false;\n\n\t\t\tthis.detachRow(row);\n\n\t\t\tthis.table.rowManager.adjustTableSize();\n\n\t\t\tthis.refreshData(false, \"display\");\n\n\t\t\tif(this.rows.length){\n\t\t\t\tthis.styleRows();\n\t\t\t}\n\n\t\t}else {\n\t\t\tconsole.warn(\"Freeze Error - Row is already unfrozen\");\n\t\t}\n\t}\n\n\tdetachRow(row){\n\t\tvar index = this.rows.indexOf(row);\n\n\t\tif(index > -1){\n\t\t\tvar rowEl = row.getElement();\n\n\t\t\tif(rowEl.parentNode){\n\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t}\n\n\t\t\tthis.rows.splice(index, 1);\n\t\t}\n\t}\n\n\tstyleRows(row){\n\t\tthis.rows.forEach((row, i) => {\n\t\t\tthis.table.rowManager.styleRow(row, i);\n\t\t});\n\t}\n}\n\n//public group object\nclass GroupComponent {\n\tconstructor (group){\n\t\tthis._group = group;\n\t\tthis.type = \"GroupComponent\";\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function(target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t}else {\n\t\t\t\t\treturn target._group.groupManager.table.componentFunctionBinder.handle(\"group\", target._group, name);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetKey(){\n\t\treturn this._group.key;\n\t}\n\n\tgetField(){\n\t\treturn this._group.field;\n\t}\n\n\tgetElement(){\n\t\treturn this._group.element;\n\t}\n\n\tgetRows(){\n\t\treturn this._group.getRows(true);\n\t}\n\n\tgetSubGroups(){\n\t\treturn this._group.getSubGroups(true);\n\t}\n\n\tgetParentGroup(){\n\t\treturn this._group.parent ? this._group.parent.getComponent() : false;\n\t}\n\n\tisVisible(){\n\t\treturn this._group.visible;\n\t}\n\n\tshow(){\n\t\tthis._group.show();\n\t}\n\n\thide(){\n\t\tthis._group.hide();\n\t}\n\n\ttoggle(){\n\t\tthis._group.toggleVisibility();\n\t}\n\n\tscrollTo(position, ifVisible){\n\t\treturn this._group.groupManager.table.rowManager.scrollToRow(this._group, position, ifVisible);\n\t}\n\n\t_getSelf(){\n\t\treturn this._group;\n\t}\n\n\tgetTable(){\n\t\treturn this._group.groupManager.table;\n\t}\n}\n\n//Group functions\nclass Group{\n\t\n\tconstructor(groupManager, parent, level, key, field, generator, oldGroup){\n\t\tthis.groupManager = groupManager;\n\t\tthis.parent = parent;\n\t\tthis.key = key;\n\t\tthis.level = level;\n\t\tthis.field = field;\n\t\tthis.hasSubGroups = level < (groupManager.groupIDLookups.length - 1);\n\t\tthis.addRow = this.hasSubGroups ? this._addRowToGroup : this._addRow;\n\t\tthis.type = \"group\"; //type of element\n\t\tthis.old = oldGroup;\n\t\tthis.rows = [];\n\t\tthis.groups = [];\n\t\tthis.groupList = [];\n\t\tthis.generator = generator;\n\t\tthis.element = false;\n\t\tthis.elementContents = false;\n\t\tthis.height = 0;\n\t\tthis.outerHeight = 0;\n\t\tthis.initialized = false;\n\t\tthis.calcs = {};\n\t\tthis.initialized = false;\n\t\tthis.modules = {};\n\t\tthis.arrowElement = false;\n\t\t\n\t\tthis.visible = oldGroup ? oldGroup.visible : (typeof groupManager.startOpen[level] !== \"undefined\" ? groupManager.startOpen[level] : groupManager.startOpen[0]);\n\t\t\n\t\tthis.component = null;\n\t\t\n\t\tthis.createElements();\n\t\tthis.addBindings();\n\t\t\n\t\tthis.createValueGroups();\n\t}\n\t\n\twipe(elementsOnly){\n\t\tif(!elementsOnly){\n\t\t\tif(this.groupList.length){\n\t\t\t\tthis.groupList.forEach(function(group){\n\t\t\t\t\tgroup.wipe();\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tthis.rows.forEach((row) => {\n\t\t\t\t\tif(row.modules){\n\t\t\t\t\t\tdelete row.modules.group;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.element = false;\n\t\tthis.arrowElement = false;\n\t\tthis.elementContents = false;\n\t}\n\t\n\tcreateElements(){\n\t\tvar arrow = document.createElement(\"div\");\n\t\tarrow.classList.add(\"tabulator-arrow\");\n\t\t\n\t\tthis.element = document.createElement(\"div\");\n\t\tthis.element.classList.add(\"tabulator-row\");\n\t\tthis.element.classList.add(\"tabulator-group\");\n\t\tthis.element.classList.add(\"tabulator-group-level-\" + this.level);\n\t\tthis.element.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\tthis.arrowElement = document.createElement(\"div\");\n\t\tthis.arrowElement.classList.add(\"tabulator-group-toggle\");\n\t\tthis.arrowElement.appendChild(arrow);\n\t\t\n\t\t//setup movable rows\n\t\tif(this.groupManager.table.options.movableRows !== false && this.groupManager.table.modExists(\"moveRow\")){\n\t\t\tthis.groupManager.table.modules.moveRow.initializeGroupHeader(this);\n\t\t}\n\t}\n\t\n\tcreateValueGroups(){\n\t\tvar level = this.level + 1;\n\t\tif(this.groupManager.allowedValues && this.groupManager.allowedValues[level]){\n\t\t\tthis.groupManager.allowedValues[level].forEach((value) => {\n\t\t\t\tthis._createGroup(value, level);\n\t\t\t});\n\t\t}\n\t}\n\t\n\taddBindings(){\n\t\tvar toggleElement;\n\t\t\n\t\tif(this.groupManager.table.options.groupToggleElement){\n\t\t\ttoggleElement = this.groupManager.table.options.groupToggleElement == \"arrow\" ? this.arrowElement : this.element;\n\t\t\t\n\t\t\ttoggleElement.addEventListener(\"click\", (e) => {\n\t\t\t\tif(this.groupManager.table.options.groupToggleElement === \"arrow\"){\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t}\n\n\t\t\t\t//allow click event to propagate before toggling visibility\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.toggleVisibility();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\t\n\t_createGroup(groupID, level){\n\t\tvar groupKey = level + \"_\" + groupID;\n\t\tvar group = new Group(this.groupManager, this, level, groupID,  this.groupManager.groupIDLookups[level].field, this.groupManager.headerGenerator[level] || this.groupManager.headerGenerator[0], this.old ? this.old.groups[groupKey] : false);\n\t\t\n\t\tthis.groups[groupKey] = group;\n\t\tthis.groupList.push(group);\n\t}\n\t\n\t_addRowToGroup(row){\n\t\t\n\t\tvar level = this.level + 1;\n\t\t\n\t\tif(this.hasSubGroups){\n\t\t\tvar groupID = this.groupManager.groupIDLookups[level].func(row.getData()),\n\t\t\tgroupKey = level + \"_\" + groupID;\n\t\t\t\n\t\t\tif(this.groupManager.allowedValues && this.groupManager.allowedValues[level]){\n\t\t\t\tif(this.groups[groupKey]){\n\t\t\t\t\tthis.groups[groupKey].addRow(row);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(!this.groups[groupKey]){\n\t\t\t\t\tthis._createGroup(groupID, level);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.groups[groupKey].addRow(row);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_addRow(row){\n\t\tthis.rows.push(row);\n\t\trow.modules.group = this;\n\t}\n\t\n\tinsertRow(row, to, after){\n\t\tvar data = this.conformRowData({});\n\t\t\n\t\trow.updateData(data);\n\t\t\n\t\tvar toIndex = this.rows.indexOf(to);\n\t\t\n\t\tif(toIndex > -1){\n\t\t\tif(after){\n\t\t\t\tthis.rows.splice(toIndex+1, 0, row);\n\t\t\t}else {\n\t\t\t\tthis.rows.splice(toIndex, 0, row);\n\t\t\t}\n\t\t}else {\n\t\t\tif(after){\n\t\t\t\tthis.rows.push(row);\n\t\t\t}else {\n\t\t\t\tthis.rows.unshift(row);\n\t\t\t}\n\t\t}\n\t\t\n\t\trow.modules.group = this;\n\t\t\n\t\t// this.generateGroupHeaderContents();\n\t\t\n\t\tif(this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.options.columnCalcs != \"table\"){\n\t\t\tthis.groupManager.table.modules.columnCalcs.recalcGroup(this);\n\t\t}\n\t\t\n\t\tthis.groupManager.updateGroupRows(true);\n\t}\n\t\n\tscrollHeader(left){\n\t\tif(this.arrowElement){\n\t\t\tthis.arrowElement.style.marginLeft = left;\n\t\t\t\n\t\t\tthis.groupList.forEach(function(child){\n\t\t\t\tchild.scrollHeader(left);\n\t\t\t});\n\t\t}\n\t}\n\t\n\tgetRowIndex(row){}\n\t\n\t//update row data to match grouping constraints\n\tconformRowData(data){\n\t\tif(this.field){\n\t\t\tdata[this.field] = this.key;\n\t\t}else {\n\t\t\tconsole.warn(\"Data Conforming Error - Cannot conform row data to match new group as groupBy is a function\");\n\t\t}\n\t\t\n\t\tif(this.parent){\n\t\t\tdata = this.parent.conformRowData(data);\n\t\t}\n\t\t\n\t\treturn data;\n\t}\n\t\n\tremoveRow(row){\n\t\tvar index = this.rows.indexOf(row);\n\t\tvar el = row.getElement();\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.rows.splice(index, 1);\n\t\t}\n\t\t\n\t\tif(!this.groupManager.table.options.groupValues && !this.rows.length){\n\t\t\tif(this.parent){\n\t\t\t\tthis.parent.removeGroup(this);\n\t\t\t}else {\n\t\t\t\tthis.groupManager.removeGroup(this);\n\t\t\t}\t\t\n\t\t\t\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t\t\n\t\t}else {\n\t\t\t\n\t\t\tif(el.parentNode){\n\t\t\t\tel.parentNode.removeChild(el);\n\t\t\t}\n\t\t\t\n\t\t\tif(!this.groupManager.blockRedraw){\n\t\t\t\tthis.generateGroupHeaderContents();\n\t\t\t\t\n\t\t\t\tif(this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.options.columnCalcs != \"table\"){\n\t\t\t\t\tthis.groupManager.table.modules.columnCalcs.recalcGroup(this);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\t\n\tremoveGroup(group){\n\t\tvar groupKey = group.level + \"_\" + group.key,\n\t\tindex;\n\t\t\n\t\tif(this.groups[groupKey]){\n\t\t\tdelete this.groups[groupKey];\n\t\t\t\n\t\t\tindex = this.groupList.indexOf(group);\n\t\t\t\n\t\t\tif(index > -1){\n\t\t\t\tthis.groupList.splice(index, 1);\n\t\t\t}\n\t\t\t\n\t\t\tif(!this.groupList.length){\n\t\t\t\tif(this.parent){\n\t\t\t\t\tthis.parent.removeGroup(this);\n\t\t\t\t}else {\n\t\t\t\t\tthis.groupManager.removeGroup(this);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tgetHeadersAndRows(){\n\t\tvar output = [];\n\t\t\n\t\toutput.push(this);\n\t\t\n\t\tthis._visSet();\n\t\t\n\t\t\n\t\tif(this.calcs.top){\n\t\t\tthis.calcs.top.detachElement();\n\t\t\tthis.calcs.top.deleteCells();\n\t\t}\n\t\t\n\t\tif(this.calcs.bottom){\n\t\t\tthis.calcs.bottom.detachElement();\n\t\t\tthis.calcs.bottom.deleteCells();\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\tif(this.visible){\n\t\t\tif(this.groupList.length){\n\t\t\t\tthis.groupList.forEach(function(group){\n\t\t\t\t\toutput = output.concat(group.getHeadersAndRows());\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tif(this.groupManager.table.options.columnCalcs != \"table\" && this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.modules.columnCalcs.hasTopCalcs()){\n\t\t\t\t\tthis.calcs.top = this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows);\n\t\t\t\t\toutput.push(this.calcs.top);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\toutput = output.concat(this.rows);\n\t\t\t\t\n\t\t\t\tif(this.groupManager.table.options.columnCalcs != \"table\" &&  this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.modules.columnCalcs.hasBottomCalcs()){\n\t\t\t\t\tthis.calcs.bottom = this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows);\n\t\t\t\t\toutput.push(this.calcs.bottom);\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tif(!this.groupList.length && this.groupManager.table.options.columnCalcs != \"table\"){\n\t\t\t\t\n\t\t\t\tif(this.groupManager.table.modExists(\"columnCalcs\")){\n\t\t\t\t\tif(this.groupManager.table.modules.columnCalcs.hasTopCalcs()){\n\t\t\t\t\t\tif(this.groupManager.table.options.groupClosedShowCalcs){\n\t\t\t\t\t\t\tthis.calcs.top = this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows);\n\t\t\t\t\t\t\toutput.push(this.calcs.top);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(this.groupManager.table.modules.columnCalcs.hasBottomCalcs()){\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.groupManager.table.options.groupClosedShowCalcs){\n\t\t\t\t\t\t\tthis.calcs.bottom = this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows);\n\t\t\t\t\t\t\toutput.push(this.calcs.bottom);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetData(visible, transform){\n\t\tvar output = [];\n\t\t\n\t\tthis._visSet();\n\t\t\n\t\tif(!visible || (visible && this.visible)){\n\t\t\tthis.rows.forEach((row) => {\n\t\t\t\toutput.push(row.getData(transform || \"data\"));\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetRowCount(){\n\t\tvar count = 0;\n\t\t\n\t\tif(this.groupList.length){\n\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\tcount += group.getRowCount();\n\t\t\t});\n\t\t}else {\n\t\t\tcount = this.rows.length;\n\t\t}\n\t\treturn count;\n\t}\n\n\t\n\ttoggleVisibility(){\n\t\tif(this.visible){\n\t\t\tthis.hide();\n\t\t}else {\n\t\t\tthis.show();\n\t\t}\n\t}\n\t\n\thide(){\n\t\tthis.visible = false;\n\t\t\n\t\tif(this.groupManager.table.rowManager.getRenderMode() == \"basic\" && !this.groupManager.table.options.pagination){\n\t\t\t\n\t\t\tthis.element.classList.remove(\"tabulator-group-visible\");\n\t\t\t\n\t\t\tif(this.groupList.length){\n\t\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\t\t\n\t\t\t\t\tvar rows = group.getHeadersAndRows();\n\t\t\t\t\t\n\t\t\t\t\trows.forEach((row) => {\n\t\t\t\t\t\trow.detachElement();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tthis.rows.forEach((row) => {\n\t\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t\t\n\t\t}else {\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t}\n\t\t\n\t\tthis.groupManager.table.externalEvents.dispatch(\"groupVisibilityChanged\", this.getComponent(), false);\n\t}\n\t\n\tshow(){\n\t\tthis.visible = true;\n\t\t\n\t\tif(this.groupManager.table.rowManager.getRenderMode() == \"basic\" && !this.groupManager.table.options.pagination){\n\t\t\t\n\t\t\tthis.element.classList.add(\"tabulator-group-visible\");\n\t\t\t\n\t\t\tvar prev = this.generateElement();\n\t\t\t\n\t\t\tif(this.groupList.length){\n\t\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\t\tvar rows = group.getHeadersAndRows();\n\t\t\t\t\t\n\t\t\t\t\trows.forEach((row) => {\n\t\t\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\t\t\tprev.parentNode.insertBefore(rowEl, prev.nextSibling);\n\t\t\t\t\t\trow.initialize();\n\t\t\t\t\t\tprev = rowEl;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tthis.rows.forEach((row) => {\n\t\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\t\tprev.parentNode.insertBefore(rowEl, prev.nextSibling);\n\t\t\t\t\trow.initialize();\n\t\t\t\t\tprev = rowEl;\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t}else {\n\t\t\tthis.groupManager.updateGroupRows(true);\n\t\t}\n\t\t\n\t\tthis.groupManager.table.externalEvents.dispatch(\"groupVisibilityChanged\", this.getComponent(), true);\n\t}\n\t\n\t_visSet(){\n\t\tvar data = [];\n\t\t\n\t\tif(typeof this.visible == \"function\"){\n\t\t\t\n\t\t\tthis.rows.forEach(function(row){\n\t\t\t\tdata.push(row.getData());\n\t\t\t});\n\t\t\t\n\t\t\tthis.visible = this.visible(this.key, this.getRowCount(), data, this.getComponent());\n\t\t}\n\t}\n\t\n\tgetRowGroup(row){\n\t\tvar match = false;\n\t\tif(this.groupList.length){\n\t\t\tthis.groupList.forEach(function(group){\n\t\t\t\tvar result = group.getRowGroup(row);\n\t\t\t\t\n\t\t\t\tif(result){\n\t\t\t\t\tmatch = result;\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\tif(this.rows.find(function(item){\n\t\t\t\treturn item === row;\n\t\t\t})){\n\t\t\t\tmatch = this;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn match;\n\t}\n\t\n\tgetSubGroups(component){\n\t\tvar output = [];\n\t\t\n\t\tthis.groupList.forEach(function(child){\n\t\t\toutput.push(component ? child.getComponent() : child);\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetRows(component, includeChildren){\n\t\tvar output = [];\n\t\t\n\t\tif(includeChildren && this.groupList.length){\n\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\toutput = output.concat(group.getRows(component, includeChildren));\n\t\t\t});\n\t\t}else {\n\t\t\tthis.rows.forEach(function(row){\n\t\t\t\toutput.push(component ? row.getComponent() : row);\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgenerateGroupHeaderContents(){\n\t\tvar data = [];\n\t\t\n\t\tvar rows = this.getRows(false, true);\n\t\t\n\t\trows.forEach(function(row){\n\t\t\tdata.push(row.getData());\n\t\t});\n\t\t\n\t\tthis.elementContents = this.generator(this.key, this.getRowCount(), data, this.getComponent());\n\t\t\n\t\twhile(this.element.firstChild) this.element.removeChild(this.element.firstChild);\n\t\t\n\t\tif(typeof this.elementContents === \"string\"){\n\t\t\tthis.element.innerHTML = this.elementContents;\n\t\t}else {\n\t\t\tthis.element.appendChild(this.elementContents);\n\t\t}\n\t\t\n\t\tthis.element.insertBefore(this.arrowElement, this.element.firstChild);\n\t}\n\t\n\tgetPath(path = []) {\n\t\tpath.unshift(this.key);\n\t\tif(this.parent) {\n\t\t\tthis.parent.getPath(path);\n\t\t}\n\t\treturn path;\n\t}\n\t\n\t////////////// Standard Row Functions //////////////\n\t\n\tgetElement(){\n\t\treturn this.elementContents ? this.element : this.generateElement();\n\t}\n\t\n\tgenerateElement(){\n\t\tthis.addBindings = false;\n\t\t\n\t\tthis._visSet();\n\t\t\n\t\tif(this.visible){\n\t\t\tthis.element.classList.add(\"tabulator-group-visible\");\n\t\t}else {\n\t\t\tthis.element.classList.remove(\"tabulator-group-visible\");\n\t\t}\n\t\t\n\t\tfor(var i = 0; i < this.element.childNodes.length; ++i){\n\t\t\tthis.element.childNodes[i].parentNode.removeChild(this.element.childNodes[i]);\n\t\t}\n\t\t\n\t\tthis.generateGroupHeaderContents();\n\t\t\n\t\t// this.addBindings();\n\t\t\n\t\treturn this.element;\n\t}\n\t\n\tdetachElement(){\n\t\tif (this.element && this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n\t}\n\t\n\t//normalize the height of elements in the row\n\tnormalizeHeight(){\n\t\tthis.setHeight(this.element.clientHeight);\n\t}\n\t\n\tinitialize(force){\n\t\tif(!this.initialized || force){\n\t\t\tthis.normalizeHeight();\n\t\t\tthis.initialized = true;\n\t\t}\n\t}\n\t\n\treinitialize(){\n\t\tthis.initialized = false;\n\t\tthis.height = 0;\n\t\t\n\t\tif(Helpers.elVisible(this.element)){\n\t\t\tthis.initialize(true);\n\t\t}\n\t}\n\t\n\tsetHeight(height){\n\t\tif(this.height != height){\n\t\t\tthis.height = height;\n\t\t\tthis.outerHeight = this.element.offsetHeight;\n\t\t}\n\t}\n\t\n\t//return rows outer height\n\tgetHeight(){\n\t\treturn this.outerHeight;\n\t}\n\t\n\tgetGroup(){\n\t\treturn this;\n\t}\n\t\n\treinitializeHeight(){}\n\t\n\tcalcHeight(){}\n\t\n\tsetCellHeight(){}\n\t\n\tclearCellHeight(){}\n\t\n\tdeinitializeHeight(){}\n\n\trendered(){}\n\t\n\t//////////////// Object Generation /////////////////\n\tgetComponent(){\n\t\tif(!this.component){\n\t\t\tthis.component = new GroupComponent(this);\n\t\t}\n\t\t\n\t\treturn this.component;\n\t}\n}\n\nclass GroupRows extends Module{\n\n\tstatic moduleName = \"groupRows\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.groupIDLookups = false; //enable table grouping and set field to group by\n\t\tthis.startOpen = [function(){return false;}]; //starting state of group\n\t\tthis.headerGenerator = [function(){return \"\";}];\n\t\tthis.groupList = []; //ordered list of groups\n\t\tthis.allowedValues = false;\n\t\tthis.groups = {}; //hold row groups\n\t\t\n\t\tthis.displayHandler = this.getRows.bind(this);\n\n\t\tthis.blockRedraw = false;\n\t\t\n\t\t//register table options\n\t\tthis.registerTableOption(\"groupBy\", false); //enable table grouping and set field to group by\n\t\tthis.registerTableOption(\"groupStartOpen\", true); //starting state of group\n\t\tthis.registerTableOption(\"groupValues\", false);\n\t\tthis.registerTableOption(\"groupUpdateOnCellEdit\", false);\n\t\tthis.registerTableOption(\"groupHeader\", false); //header generation function\n\t\tthis.registerTableOption(\"groupHeaderPrint\", null);\n\t\tthis.registerTableOption(\"groupHeaderClipboard\", null);\n\t\tthis.registerTableOption(\"groupHeaderHtmlOutput\", null);\n\t\tthis.registerTableOption(\"groupHeaderDownload\", null);\n\t\tthis.registerTableOption(\"groupToggleElement\", \"arrow\");\n\t\tthis.registerTableOption(\"groupClosedShowCalcs\", false);\n\t\t\n\t\t//register table functions\n\t\tthis.registerTableFunction(\"setGroupBy\", this.setGroupBy.bind(this));\n\t\tthis.registerTableFunction(\"setGroupValues\", this.setGroupValues.bind(this));\n\t\tthis.registerTableFunction(\"setGroupStartOpen\", this.setGroupStartOpen.bind(this));\n\t\tthis.registerTableFunction(\"setGroupHeader\", this.setGroupHeader.bind(this));\n\t\tthis.registerTableFunction(\"getGroups\", this.userGetGroups.bind(this));\n\t\tthis.registerTableFunction(\"getGroupedData\", this.userGetGroupedData.bind(this));\n\t\t\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"getGroup\", this.rowGetGroup.bind(this));\n\t}\n\t\n\t//initialize group configuration\n\tinitialize(){\n\t\tthis.subscribe(\"table-destroy\", this._blockRedrawing.bind(this));\n\t\tthis.subscribe(\"rows-wipe\", this._blockRedrawing.bind(this));\n\t\tthis.subscribe(\"rows-wiped\", this._restore_redrawing.bind(this));\n\n\t\tif(this.table.options.groupBy){\n\t\t\tif(this.table.options.groupUpdateOnCellEdit){\n\t\t\t\tthis.subscribe(\"cell-value-updated\", this.cellUpdated.bind(this));\n\t\t\t\tthis.subscribe(\"row-data-changed\", this.reassignRowToGroup.bind(this), 0);\n\t\t\t}\n\t\t\t\n\t\t\tthis.subscribe(\"table-built\", this.configureGroupSetup.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"row-deleting\", this.rowDeleting.bind(this));\n\t\t\tthis.subscribe(\"row-deleted\", this.rowsUpdated.bind(this));\n\t\t\tthis.subscribe(\"scroll-horizontal\", this.scrollHeaders.bind(this));\n\t\t\tthis.subscribe(\"rows-wipe\", this.wipe.bind(this));\n\t\t\tthis.subscribe(\"rows-added\", this.rowsUpdated.bind(this));\n\t\t\tthis.subscribe(\"row-moving\", this.rowMoving.bind(this));\n\t\t\tthis.subscribe(\"row-adding-index\", this.rowAddingIndex.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"rows-sample\", this.rowSample.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"render-virtual-fill\", this.virtualRenderFill.bind(this));\n\t\t\t\n\t\t\tthis.registerDisplayHandler(this.displayHandler, 20);\n\t\t\t\n\t\t\tthis.initialized = true;\n\t\t}\n\t}\n\t\n\t_blockRedrawing(){\n\t\tthis.blockRedraw = true;\n\t}\n\n\t_restore_redrawing(){\n\t\tthis.blockRedraw = false;\n\t}\n\n\tconfigureGroupSetup(){\n\t\tif(this.table.options.groupBy){\n\t\t\tvar groupBy = this.table.options.groupBy,\n\t\t\tstartOpen = this.table.options.groupStartOpen,\n\t\t\tgroupHeader = this.table.options.groupHeader;\n\t\t\t\n\t\t\tthis.allowedValues = this.table.options.groupValues;\n\t\t\t\n\t\t\tif(Array.isArray(groupBy) && Array.isArray(groupHeader) && groupBy.length > groupHeader.length){\n\t\t\t\tconsole.warn(\"Error creating group headers, groupHeader array is shorter than groupBy array\");\n\t\t\t}\n\t\t\t\n\t\t\tthis.headerGenerator = [function(){return \"\";}];\n\t\t\tthis.startOpen = [function(){return false;}]; //starting state of group\n\t\t\t\n\t\t\tthis.langBind(\"groups|item\", (langValue, lang) => {\n\t\t\t\tthis.headerGenerator[0] = (value, count, data) => { //header layout function\n\t\t\t\t\treturn (typeof value === \"undefined\" ? \"\" : value) + \"<span>(\" + count + \" \" + ((count === 1) ? langValue : lang.groups.items) + \")</span>\";\n\t\t\t\t};\n\t\t\t});\n\t\t\t\n\t\t\tthis.groupIDLookups = [];\n\t\t\t\n\t\t\tif(groupBy){\n\t\t\t\tif(this.table.modExists(\"columnCalcs\") && this.table.options.columnCalcs != \"table\" && this.table.options.columnCalcs != \"both\"){\n\t\t\t\t\tthis.table.modules.columnCalcs.removeCalcs();\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(this.table.modExists(\"columnCalcs\") && this.table.options.columnCalcs != \"group\"){\n\t\t\t\t\t\n\t\t\t\t\tvar cols = this.table.columnManager.getRealColumns();\n\t\t\t\t\t\n\t\t\t\t\tcols.forEach((col) => {\n\t\t\t\t\t\tif(col.definition.topCalc){\n\t\t\t\t\t\t\tthis.table.modules.columnCalcs.initializeTopRow();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(col.definition.bottomCalc){\n\t\t\t\t\t\t\tthis.table.modules.columnCalcs.initializeBottomRow();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(!Array.isArray(groupBy)){\n\t\t\t\tgroupBy = [groupBy];\n\t\t\t}\n\t\t\t\n\t\t\tgroupBy.forEach((group, i) => {\n\t\t\t\tvar lookupFunc, column;\n\t\t\t\t\n\t\t\t\tif(typeof group == \"function\"){\n\t\t\t\t\tlookupFunc = group;\n\t\t\t\t}else {\n\t\t\t\t\tcolumn = this.table.columnManager.getColumnByField(group);\n\t\t\t\t\t\n\t\t\t\t\tif(column){\n\t\t\t\t\t\tlookupFunc = function(data){\n\t\t\t\t\t\t\treturn column.getFieldValue(data);\n\t\t\t\t\t\t};\n\t\t\t\t\t}else {\n\t\t\t\t\t\tlookupFunc = function(data){\n\t\t\t\t\t\t\treturn data[group];\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.groupIDLookups.push({\n\t\t\t\t\tfield: typeof group === \"function\" ? false : group,\n\t\t\t\t\tfunc:lookupFunc,\n\t\t\t\t\tvalues:this.allowedValues ? this.allowedValues[i] : false,\n\t\t\t\t});\n\t\t\t});\n\t\t\t\n\t\t\tif(startOpen){\n\t\t\t\tif(!Array.isArray(startOpen)){\n\t\t\t\t\tstartOpen = [startOpen];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tstartOpen.forEach((level) => {\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.startOpen = startOpen;\n\t\t\t}\n\t\t\t\n\t\t\tif(groupHeader){\n\t\t\t\tthis.headerGenerator = Array.isArray(groupHeader) ? groupHeader : [groupHeader];\n\t\t\t}\n\t\t}else {\n\t\t\tthis.groupList = [];\n\t\t\tthis.groups = {};\n\t\t}\n\t}\n\t\n\trowSample(rows, prevValue){\n\t\tif(this.table.options.groupBy){\n\t\t\tvar group = this.getGroups(false)[0];\n\t\t\t\n\t\t\tprevValue.push(group.getRows(false)[0]);\n\t\t}\n\t\t\n\t\treturn prevValue;\n\t}\n\t\n\tvirtualRenderFill(){\n\t\tvar el = this.table.rowManager.tableElement;\n\t\tvar rows = this.table.rowManager.getVisibleRows();\n\t\t\n\t\tif(this.table.options.groupBy){\n\t\t\trows = rows.filter((row) => {\n\t\t\t\treturn row.type !== \"group\";\n\t\t\t});\n\t\t\t\n\t\t\tel.style.minWidth = !rows.length ? this.table.columnManager.getWidth() + \"px\" : \"\";\n\t\t}else {\n\t\t\treturn rows;\n\t\t}\n\t}\n\t\n\trowAddingIndex(row, index, top){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.assignRowToGroup(row);\n\t\t\t\n\t\t\tvar groupRows = row.modules.group.rows;\n\t\t\t\n\t\t\tif(groupRows.length > 1){\n\t\t\t\tif(!index || (index && groupRows.indexOf(index) == -1)){\n\t\t\t\t\tif(top){\n\t\t\t\t\t\tif(groupRows[0] !== row){\n\t\t\t\t\t\t\tindex = groupRows[0];\n\t\t\t\t\t\t\tthis.table.rowManager.moveRowInArray(row.modules.group.rows, row, index, !top);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(groupRows[groupRows.length -1] !== row){\n\t\t\t\t\t\t\tindex = groupRows[groupRows.length -1];\n\t\t\t\t\t\t\tthis.table.rowManager.moveRowInArray(row.modules.group.rows, row, index, !top);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tthis.table.rowManager.moveRowInArray(row.modules.group.rows, row, index, !top);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn index;\n\t\t}\n\t}\n\t\n\ttrackChanges(){\n\t\tthis.dispatch(\"group-changed\");\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\t\n\tsetGroupBy(groups){\n\t\tthis.table.options.groupBy = groups;\n\t\t\n\t\tif(!this.initialized){\n\t\t\tthis.initialize();\n\t\t}\n\t\t\n\t\tthis.configureGroupSetup();\n\n\t\tif(!groups && this.table.modExists(\"columnCalcs\") && this.table.options.columnCalcs === true){\n\t\t\tthis.table.modules.columnCalcs.reinitializeCalcs();\n\t\t}\n\t\t\n\t\tthis.refreshData();\n\t\t\n\t\tthis.trackChanges();\n\t}\n\t\n\tsetGroupValues(groupValues){\n\t\tthis.table.options.groupValues = groupValues;\n\t\tthis.configureGroupSetup();\n\t\tthis.refreshData();\n\t\t\n\t\tthis.trackChanges();\n\t}\n\t\n\tsetGroupStartOpen(values){\n\t\tthis.table.options.groupStartOpen = values;\n\t\tthis.configureGroupSetup();\n\t\t\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.refreshData();\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t}else {\n\t\t\tconsole.warn(\"Grouping Update - cant refresh view, no groups have been set\");\n\t\t}\n\t}\n\t\n\tsetGroupHeader(values){\n\t\tthis.table.options.groupHeader = values;\n\t\tthis.configureGroupSetup();\n\t\t\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.refreshData();\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t}else {\n\t\t\tconsole.warn(\"Grouping Update - cant refresh view, no groups have been set\");\n\t\t}\n\t}\n\t\n\tuserGetGroups(values){\n\t\treturn this.getGroups(true);\n\t}\n\t\n\t// get grouped table data in the same format as getData()\n\tuserGetGroupedData(){\n\t\treturn this.table.options.groupBy ? this.getGroupedData() : this.getData();\n\t}\n\t\n\t\n\t///////////////////////////////////////\n\t///////// Component Functions /////////\n\t///////////////////////////////////////\n\t\n\trowGetGroup(row){\n\t\treturn row.modules.group ? row.modules.group.getComponent() : false;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\trowMoving(from, to, after){\n\t\tif(this.table.options.groupBy){\n\t\t\tif(!after && to instanceof Group){\n\t\t\t\tto = this.table.rowManager.prevDisplayRow(from) || to;\n\t\t\t}\n\t\t\t\n\t\t\tvar toGroup = to instanceof Group ? to : to.modules.group;\n\t\t\tvar fromGroup = from instanceof Group ? from : from.modules.group;\n\t\t\t\n\t\t\tif(toGroup === fromGroup){\n\t\t\t\tthis.table.rowManager.moveRowInArray(toGroup.rows, from, to, after);\n\t\t\t}else {\n\t\t\t\tif(fromGroup){\n\t\t\t\t\tfromGroup.removeRow(from);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttoGroup.insertRow(from, to, after);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\trowDeleting(row){\n\t\t//remove from group\n\t\tif(this.table.options.groupBy && row.modules.group){\n\t\t\trow.modules.group.removeRow(row);\n\t\t}\n\t}\n\t\n\trowsUpdated(row){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.updateGroupRows(true);\n\t\t}\t\n\t}\n\t\n\tcellUpdated(cell){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.reassignRowToGroup(cell.row);\n\t\t}\n\t}\n\t\n\t//return appropriate rows with group headers\n\tgetRows(rows){\n\t\tif(this.table.options.groupBy && this.groupIDLookups.length){\n\t\t\t\n\t\t\tthis.dispatchExternal(\"dataGrouping\");\n\t\t\t\n\t\t\tthis.generateGroups(rows);\n\t\t\t\n\t\t\tif(this.subscribedExternal(\"dataGrouped\")){\n\t\t\t\tthis.dispatchExternal(\"dataGrouped\", this.getGroups(true));\n\t\t\t}\n\t\t\t\n\t\t\treturn this.updateGroupRows();\n\t\t\t\n\t\t}else {\n\t\t\treturn rows.slice(0);\n\t\t}\n\t}\n\t\n\tgetGroups(component){\n\t\tvar groupComponents = [];\n\t\t\n\t\tthis.groupList.forEach(function(group){\n\t\t\tgroupComponents.push(component ? group.getComponent() : group);\n\t\t});\n\t\t\n\t\treturn groupComponents;\n\t}\n\t\n\tgetChildGroups(group){\n\t\tvar groupComponents = [];\n\t\t\n\t\tif(!group){\n\t\t\tgroup = this;\n\t\t}\n\t\t\n\t\tgroup.groupList.forEach((child) => {\n\t\t\tif(child.groupList.length){\n\t\t\t\tgroupComponents = groupComponents.concat(this.getChildGroups(child));\n\t\t\t}else {\n\t\t\t\tgroupComponents.push(child);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groupComponents;\n\t}\n\t\n\twipe(){\n\t\tif(this.table.options.groupBy){\n\t\t\tthis.groupList.forEach(function(group){\n\t\t\t\tgroup.wipe();\n\t\t\t});\n\t\t\t\n\t\t\tthis.groupList = [];\n\t\t\tthis.groups = {};\n\t\t}\n\t}\n\t\n\tpullGroupListData(groupList) {\n\t\tvar groupListData = [];\n\t\t\n\t\tgroupList.forEach((group) => {\n\t\t\tvar groupHeader = {};\n\t\t\tgroupHeader.level = 0;\n\t\t\tgroupHeader.rowCount = 0;\n\t\t\tgroupHeader.headerContent = \"\";\n\t\t\tvar childData = [];\n\t\t\t\n\t\t\tif (group.hasSubGroups) {\n\t\t\t\tchildData = this.pullGroupListData(group.groupList);\n\t\t\t\t\n\t\t\t\tgroupHeader.level = group.level;\n\t\t\t\tgroupHeader.rowCount = childData.length - group.groupList.length; // data length minus number of sub-headers\n\t\t\t\tgroupHeader.headerContent = group.generator(group.key, groupHeader.rowCount, group.rows, group);\n\t\t\t\t\n\t\t\t\tgroupListData.push(groupHeader);\n\t\t\t\tgroupListData = groupListData.concat(childData);\n\t\t\t}\n\t\t\t\n\t\t\telse {\n\t\t\t\tgroupHeader.level = group.level;\n\t\t\t\tgroupHeader.headerContent = group.generator(group.key, group.rows.length, group.rows, group);\n\t\t\t\tgroupHeader.rowCount = group.getRows().length;\n\t\t\t\t\n\t\t\t\tgroupListData.push(groupHeader);\n\t\t\t\t\n\t\t\t\tgroup.getRows().forEach((row) => {\n\t\t\t\t\tgroupListData.push(row.getData(\"data\"));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groupListData;\n\t}\n\t\n\tgetGroupedData(){\n\t\t\n\t\treturn this.pullGroupListData(this.groupList);\n\t}\n\t\n\tgetRowGroup(row){\n\t\tvar match = false;\n\t\t\n\t\tif(this.options(\"dataTree\")){\n\t\t\trow = this.table.modules.dataTree.getTreeParentRoot(row);\n\t\t}\n\t\t\n\t\tthis.groupList.forEach((group) => {\n\t\t\tvar result = group.getRowGroup(row);\n\t\t\t\n\t\t\tif(result){\n\t\t\t\tmatch = result;\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn match;\n\t}\n\t\n\tcountGroups(){\n\t\treturn this.groupList.length;\n\t}\n\t\n\tgenerateGroups(rows){\n\t\tvar oldGroups = this.groups;\n\t\t\n\t\tthis.groups = {};\n\t\tthis.groupList = [];\n\t\t\n\t\tif(this.allowedValues && this.allowedValues[0]){\n\t\t\tthis.allowedValues[0].forEach((value) => {\n\t\t\t\tthis.createGroup(value, 0, oldGroups);\n\t\t\t});\n\t\t\t\n\t\t\trows.forEach((row) => {\n\t\t\t\tthis.assignRowToExistingGroup(row, oldGroups);\n\t\t\t});\n\t\t}else {\n\t\t\trows.forEach((row) => {\n\t\t\t\tthis.assignRowToGroup(row, oldGroups);\n\t\t\t});\n\t\t}\n\t\t\n\t\tObject.values(oldGroups).forEach((group) => {\n\t\t\tgroup.wipe(true);\n\t\t});\t\n\t}\n\t\n\t\n\tcreateGroup(groupID, level, oldGroups){\n\t\tvar groupKey = level + \"_\" + groupID,\n\t\tgroup;\n\t\t\n\t\toldGroups = oldGroups || [];\n\t\t\n\t\tgroup = new Group(this, false, level, groupID, this.groupIDLookups[0].field, this.headerGenerator[0], oldGroups[groupKey]);\n\t\t\n\t\tthis.groups[groupKey] = group;\n\t\tthis.groupList.push(group);\n\t}\n\t\n\tassignRowToExistingGroup(row, oldGroups){\n\t\tvar groupID = this.groupIDLookups[0].func(row.getData()),\n\t\tgroupKey = \"0_\" + groupID;\n\t\t\n\t\tif(this.groups[groupKey]){\n\t\t\tthis.groups[groupKey].addRow(row);\n\t\t}\n\t}\n\t\n\tassignRowToGroup(row, oldGroups){\n\t\tvar groupID = this.groupIDLookups[0].func(row.getData()),\n\t\tnewGroupNeeded = !this.groups[\"0_\" + groupID];\n\t\t\n\t\tif(newGroupNeeded){\n\t\t\tthis.createGroup(groupID, 0, oldGroups);\n\t\t}\n\t\t\n\t\tthis.groups[\"0_\" + groupID].addRow(row);\n\t\t\n\t\treturn !newGroupNeeded;\n\t}\n\t\n\treassignRowToGroup(row){\n\t\tif(row.type === \"row\"){\n\t\t\tvar oldRowGroup = row.modules.group,\n\t\t\toldGroupPath = oldRowGroup.getPath(),\n\t\t\tnewGroupPath = this.getExpectedPath(row),\n\t\t\tsamePath;\n\t\t\t\n\t\t\t// figure out if new group path is the same as old group path\n\t\t\tsamePath = (oldGroupPath.length == newGroupPath.length) && oldGroupPath.every((element, index) => {\n\t\t\t\treturn element === newGroupPath[index];\n\t\t\t});\n\t\t\t\n\t\t\t// refresh if they new path and old path aren't the same (aka the row's groupings have changed)\n\t\t\tif(!samePath) {\n\t\t\t\toldRowGroup.removeRow(row);\n\t\t\t\tthis.assignRowToGroup(row, this.groups);\n\t\t\t\tthis.refreshData(true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tgetExpectedPath(row) {\n\t\tvar groupPath = [], rowData = row.getData();\n\t\t\n\t\tthis.groupIDLookups.forEach((groupId) => {\n\t\t\tgroupPath.push(groupId.func(rowData));\n\t\t});\n\t\t\n\t\treturn groupPath;\n\t}\n\t\n\tupdateGroupRows(force){\n\t\tvar output = [];\n\n\t\tif(!this.blockRedraw){\n\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\toutput = output.concat(group.getHeadersAndRows());\n\t\t\t});\n\t\t\t\n\t\t\tif(force){\n\t\t\t\tthis.refreshData(true);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tscrollHeaders(left){\n\t\tif(this.table.options.groupBy){\n\t\t\tif(this.table.options.renderHorizontal === \"virtual\"){\n\t\t\t\tleft -= this.table.columnManager.renderer.vDomPadLeft;\n\t\t\t}\n\t\t\t\n\t\t\tleft = left + \"px\";\n\t\t\t\n\t\t\tthis.groupList.forEach((group) => {\n\t\t\t\tgroup.scrollHeader(left);\n\t\t\t});\n\t\t}\n\t}\n\t\n\tremoveGroup(group){\n\t\tvar groupKey = group.level + \"_\" + group.key,\n\t\tindex;\n\t\t\n\t\tif(this.groups[groupKey]){\n\t\t\tdelete this.groups[groupKey];\n\t\t\t\n\t\t\tindex = this.groupList.indexOf(group);\n\t\t\t\n\t\t\tif(index > -1){\n\t\t\t\tthis.groupList.splice(index, 1);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcheckBasicModeGroupHeaderWidth(){\n\t\tvar element = this.table.rowManager.tableElement,\n\t\tonlyGroupHeaders = true;\n\t\t\n\t\tthis.table.rowManager.getDisplayRows().forEach((row, index) =>{\n\t\t\tthis.table.rowManager.styleRow(row, index);\n\t\t\telement.appendChild(row.getElement());\n\t\t\trow.initialize(true);\n\t\t\t\n\t\t\tif(row.type !== \"group\"){\n\t\t\t\tonlyGroupHeaders = false;\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(onlyGroupHeaders){\n\t\t\telement.style.minWidth = this.table.columnManager.getWidth() + \"px\";\n\t\t}else {\n\t\t\telement.style.minWidth = \"\";\n\t\t}\n\t}\n\t\n}\n\nvar defaultUndoers = {\n\tcellEdit: function(action){\n\t\taction.component.setValueProcessData(action.data.oldValue);\n\t\taction.component.cellRendered();\n\t},\n\n\trowAdd: function(action){\n\t\taction.component.deleteActual();\n\n\t\tthis.table.rowManager.checkPlaceholder();\n\t},\n\n\trowDelete: function(action){\n\t\tvar newRow = this.table.rowManager.addRowActual(action.data.data, action.data.pos, action.data.index);\n\n\t\tif(this.table.options.groupBy && this.table.modExists(\"groupRows\")){\n\t\t\tthis.table.modules.groupRows.updateGroupRows(true);\n\t\t}\n\n\t\tthis._rebindRow(action.component, newRow);\n\n\t\tthis.table.rowManager.checkPlaceholder();\n\t},\n\n\trowMove: function(action){\n\t\tvar after = (action.data.posFrom  - action.data.posTo) > 0;\n\n\t\tthis.table.rowManager.moveRowActual(action.component, this.table.rowManager.getRowFromPosition(action.data.posFrom), after);\n\n\t\tthis.table.rowManager.regenerateRowPositions();\n\t\tthis.table.rowManager.reRenderInPosition();\n\t},\n};\n\nvar defaultRedoers = {\n\tcellEdit: function(action){\n\t\taction.component.setValueProcessData(action.data.newValue);\n\t\taction.component.cellRendered();\n\t},\n\n\trowAdd: function(action){\n\t\tvar newRow = this.table.rowManager.addRowActual(action.data.data, action.data.pos, action.data.index);\n\n\t\tif(this.table.options.groupBy && this.table.modExists(\"groupRows\")){\n\t\t\tthis.table.modules.groupRows.updateGroupRows(true);\n\t\t}\n\n\t\tthis._rebindRow(action.component, newRow);\n\n\t\tthis.table.rowManager.checkPlaceholder();\n\t},\n\n\trowDelete:function(action){\n\t\taction.component.deleteActual();\n\n\t\tthis.table.rowManager.checkPlaceholder();\n\t},\n\n\trowMove: function(action){\n\t\tthis.table.rowManager.moveRowActual(action.component, this.table.rowManager.getRowFromPosition(action.data.posTo), action.data.after);\n\t\t\n\t\tthis.table.rowManager.regenerateRowPositions();\n\t\tthis.table.rowManager.reRenderInPosition();\n\t},\n};\n\nvar bindings$1 = {\r\n\tundo:[\"ctrl + 90\", \"meta + 90\"],\r\n\tredo:[\"ctrl + 89\", \"meta + 89\"],\r\n};\n\nvar actions$1 = {\r\n\tundo:function(e){\r\n\t\tvar cell = false;\r\n\t\tif(this.table.options.history && this.table.modExists(\"history\") && this.table.modExists(\"edit\")){\r\n\r\n\t\t\tcell = this.table.modules.edit.currentCell;\r\n\r\n\t\t\tif(!cell){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.table.modules.history.undo();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tredo:function(e){\r\n\t\tvar cell = false;\r\n\t\tif(this.table.options.history && this.table.modExists(\"history\") && this.table.modExists(\"edit\")){\r\n\r\n\t\t\tcell = this.table.modules.edit.currentCell;\r\n\r\n\t\t\tif(!cell){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.table.modules.history.redo();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n};\n\nvar extensions$3 = {\r\n\tkeybindings:{\r\n\t\tbindings:bindings$1,\r\n\t\tactions:actions$1\r\n\t},\r\n};\n\nclass History extends Module{\n\n\tstatic moduleName = \"history\";\n\tstatic moduleExtensions = extensions$3;\n\n\t//load defaults\n\tstatic undoers = defaultUndoers;\n\tstatic redoers = defaultRedoers;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.history = [];\n\t\tthis.index = -1;\n\n\t\tthis.registerTableOption(\"history\", false); //enable edit history\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.history){\n\t\t\tthis.subscribe(\"cell-value-updated\", this.cellUpdated.bind(this));\n\t\t\tthis.subscribe(\"cell-delete\", this.clearComponentHistory.bind(this));\n\t\t\tthis.subscribe(\"row-delete\", this.rowDeleted.bind(this));\n\t\t\tthis.subscribe(\"rows-wipe\", this.clear.bind(this));\n\t\t\tthis.subscribe(\"row-added\", this.rowAdded.bind(this));\n\t\t\tthis.subscribe(\"row-move\", this.rowMoved.bind(this));\n\t\t}\n\n\t\tthis.registerTableFunction(\"undo\", this.undo.bind(this));\n\t\tthis.registerTableFunction(\"redo\", this.redo.bind(this));\n\t\tthis.registerTableFunction(\"getHistoryUndoSize\", this.getHistoryUndoSize.bind(this));\n\t\tthis.registerTableFunction(\"getHistoryRedoSize\", this.getHistoryRedoSize.bind(this));\n\t\tthis.registerTableFunction(\"clearHistory\", this.clear.bind(this));\n\t}\n\n\trowMoved(from, to, after){\n\t\tthis.action(\"rowMove\", from, {posFrom:from.getPosition(), posTo:to.getPosition(), to:to, after:after});\n\t}\n\n\trowAdded(row, data, pos, index){\n\t\tthis.action(\"rowAdd\", row, {data:data, pos:pos, index:index});\n\t}\n\n\trowDeleted(row){\n\t\tvar index, rows;\n\n\t\tif(this.table.options.groupBy){\n\n\t\t\trows = row.getComponent().getGroup()._getSelf().rows;\n\t\t\tindex = rows.indexOf(row);\n\n\t\t\tif(index){\n\t\t\t\tindex = rows[index-1];\n\t\t\t}\n\t\t}else {\n\t\t\tindex = row.table.rowManager.getRowIndex(row);\n\n\t\t\tif(index){\n\t\t\t\tindex = row.table.rowManager.rows[index-1];\n\t\t\t}\n\t\t}\n\n\t\tthis.action(\"rowDelete\", row, {data:row.getData(), pos:!index, index:index});\n\t}\n\n\tcellUpdated(cell){\n\t\tthis.action(\"cellEdit\", cell, {oldValue:cell.oldValue, newValue:cell.value});\n\t}\n\n\tclear(){\n\t\tthis.history = [];\n\t\tthis.index = -1;\n\t}\n\n\taction(type, component, data){\n\t\tthis.history = this.history.slice(0, this.index + 1);\n\n\t\tthis.history.push({\n\t\t\ttype:type,\n\t\t\tcomponent:component,\n\t\t\tdata:data,\n\t\t});\n\n\t\tthis.index ++;\n\t}\n\n\tgetHistoryUndoSize(){\n\t\treturn this.index + 1;\n\t}\n\n\tgetHistoryRedoSize(){\n\t\treturn this.history.length - (this.index + 1);\n\t}\n\n\tclearComponentHistory(component){\n\t\tvar index = this.history.findIndex(function(item){\n\t\t\treturn item.component === component;\n\t\t});\n\n\t\tif(index > -1){\n\t\t\tthis.history.splice(index, 1);\n\t\t\tif(index <= this.index){\n\t\t\t\tthis.index--;\n\t\t\t}\n\n\t\t\tthis.clearComponentHistory(component);\n\t\t}\n\t}\n\n\tundo(){\n\t\tif(this.index > -1){\n\t\t\tlet action = this.history[this.index];\n\n\t\t\tHistory.undoers[action.type].call(this, action);\n\n\t\t\tthis.index--;\n\n\t\t\tthis.dispatchExternal(\"historyUndo\", action.type, action.component.getComponent(), action.data);\n\n\t\t\treturn true;\n\t\t}else {\n\t\t\tconsole.warn(this.options(\"history\") ? \"History Undo Error - No more history to undo\" : \"History module not enabled\");\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tredo(){\n\t\tif(this.history.length-1 > this.index){\n\n\t\t\tthis.index++;\n\n\t\t\tlet action = this.history[this.index];\n\n\t\t\tHistory.redoers[action.type].call(this, action);\n\n\t\t\tthis.dispatchExternal(\"historyRedo\", action.type, action.component.getComponent(), action.data);\n\n\t\t\treturn true;\n\t\t}else {\n\t\t\tconsole.warn(this.options(\"history\") ? \"History Redo Error - No more history to redo\" : \"History module not enabled\");\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//rebind rows to new element after deletion\n\t_rebindRow(oldRow, newRow){\n\t\tthis.history.forEach(function(action){\n\t\t\tif(action.component instanceof Row){\n\t\t\t\tif(action.component === oldRow){\n\t\t\t\t\taction.component = newRow;\n\t\t\t\t}\n\t\t\t}else if(action.component instanceof Cell){\n\t\t\t\tif(action.component.row === oldRow){\n\t\t\t\t\tvar field = action.component.column.getField();\n\n\t\t\t\t\tif(field){\n\t\t\t\t\t\taction.component = newRow.getCell(field);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nclass HtmlTableImport extends Module{\n\n\tstatic moduleName = \"htmlTableImport\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.fieldIndex = [];\n\t\tthis.hasIndex = false;\n\t}\n\n\tinitialize(){\n\t\tthis.tableElementCheck();\n\t}\n\n\ttableElementCheck(){\n\t\tif(this.table.originalElement && this.table.originalElement.tagName === \"TABLE\"){\n\t\t\tif(this.table.originalElement.childNodes.length){\n\t\t\t\tthis.parseTable();\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element.\");\n\t\t\t}\n\t\t}\n\t}\n\n\tparseTable(){\n\t\tvar element = this.table.originalElement,\n\t\toptions = this.table.options,\n\t\theaders = element.getElementsByTagName(\"th\"),\n\t\trows = element.getElementsByTagName(\"tbody\")[0],\n\t\tdata = [];\n\n\t\tthis.hasIndex = false;\n\n\t\tthis.dispatchExternal(\"htmlImporting\");\n\n\t\trows = rows ? rows.getElementsByTagName(\"tr\") : [];\n\n\t\t//check for Tabulator inline options\n\t\tthis._extractOptions(element, options);\n\n\t\tif(headers.length){\n\t\t\tthis._extractHeaders(headers, rows);\n\t\t}else {\n\t\t\tthis._generateBlankHeaders(headers, rows);\n\t\t}\n\n\t\t//iterate through table rows and build data set\n\t\tfor(var index = 0; index < rows.length; index++){\n\t\t\tvar row = rows[index],\n\t\t\tcells = row.getElementsByTagName(\"td\"),\n\t\t\titem = {};\n\n\t\t\t//create index if the don't exist in table\n\t\t\tif(!this.hasIndex){\n\t\t\t\titem[options.index] = index;\n\t\t\t}\n\n\t\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\t\tvar cell = cells[i];\n\t\t\t\tif(typeof this.fieldIndex[i] !== \"undefined\"){\n\t\t\t\t\titem[this.fieldIndex[i]] = cell.innerHTML;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//add row data to item\n\t\t\tdata.push(item);\n\t\t}\n\n\t\toptions.data = data;\n\n\t\tthis.dispatchExternal(\"htmlImported\");\n\t}\n\n\t//extract tabulator attribute options\n\t_extractOptions(element, options, defaultOptions){\n\t\tvar attributes = element.attributes;\n\t\tvar optionsArr = defaultOptions ? Object.keys(defaultOptions) : Object.keys(options);\n\t\tvar optionsList = {};\n\n\t\toptionsArr.forEach((item) => {\n\t\t\toptionsList[item.toLowerCase()] = item;\n\t\t});\n\n\t\tfor(var index in attributes){\n\t\t\tvar attrib = attributes[index];\n\t\t\tvar name;\n\n\t\t\tif(attrib && typeof attrib == \"object\" && attrib.name && attrib.name.indexOf(\"tabulator-\") === 0){\n\t\t\t\tname = attrib.name.replace(\"tabulator-\", \"\");\n\n\t\t\t\tif(typeof optionsList[name] !== \"undefined\"){\n\t\t\t\t\toptions[optionsList[name]] = this._attribValue(attrib.value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//get value of attribute\n\t_attribValue(value){\n\t\tif(value === \"true\"){\n\t\t\treturn true;\n\t\t}\n\n\t\tif(value === \"false\"){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\t//find column if it has already been defined\n\t_findCol(title){\n\t\tvar match = this.table.options.columns.find((column) => {\n\t\t\treturn column.title === title;\n\t\t});\n\n\t\treturn match || false;\n\t}\n\n\t//extract column from headers\n\t_extractHeaders(headers, rows){\n\t\tfor(var index = 0; index < headers.length; index++){\n\t\t\tvar header = headers[index],\n\t\t\texists = false,\n\t\t\tcol = this._findCol(header.textContent),\n\t\t\twidth;\n\n\t\t\tif(col){\n\t\t\t\texists = true;\n\t\t\t}else {\n\t\t\t\tcol = {title:header.textContent.trim()};\n\t\t\t}\n\n\t\t\tif(!col.field) {\n\t\t\t\tcol.field = header.textContent.trim().toLowerCase().replaceAll(\" \", \"_\");\n\t\t\t}\n\n\t\t\twidth = header.getAttribute(\"width\");\n\n\t\t\tif(width && !col.width)\t{\n\t\t\t\tcol.width = width;\n\t\t\t}\n\n\t\t\t//check for Tabulator inline options\n\t\t\tthis._extractOptions(header, col, this.table.columnManager.optionsList.registeredDefaults);\n\n\t\t\tthis.fieldIndex[index] = col.field;\n\n\t\t\tif(col.field == this.table.options.index){\n\t\t\t\tthis.hasIndex = true;\n\t\t\t}\n\n\t\t\tif(!exists){\n\t\t\t\tthis.table.options.columns.push(col);\n\t\t\t}\n\n\t\t}\n\t}\n\n\t//generate blank headers\n\t_generateBlankHeaders(headers, rows){\n\t\tfor(var index = 0; index < headers.length; index++){\n\t\t\tvar header = headers[index],\n\t\t\tcol = {title:\"\", field:\"col\" + index};\n\n\t\t\tthis.fieldIndex[index] = col.field;\n\n\t\t\tvar width = header.getAttribute(\"width\");\n\n\t\t\tif(width){\n\t\t\t\tcol.width = width;\n\t\t\t}\n\n\t\t\tthis.table.options.columns.push(col);\n\t\t}\n\t}\n}\n\nfunction csv(input){\n\tvar data = [],\n\trow = 0, \n\tcol = 0,\n\tinQuote = false;\n    \n\t//Iterate over each character\n\tfor (let index = 0; index < input.length; index++) {\n\t\tlet char = input[index], \n\t\tnextChar = input[index+1];      \n        \n\t\t//Initialize empty row\n\t\tif(!data[row]){\n\t\t\tdata[row] = [];\n\t\t}\n\n\t\t//Initialize empty column\n\t\tif(!data[row][col]){\n\t\t\tdata[row][col] = \"\";\n\t\t}\n        \n\t\t//Handle quotation mark inside string\n\t\tif (char == '\"' && inQuote && nextChar == '\"') { \n\t\t\tdata[row][col] += char; \n\t\t\tindex++;\n\t\t\tcontinue; \n\t\t}\n        \n\t\t//Begin / End Quote\n\t\tif (char == '\"') { \n\t\t\tinQuote = !inQuote;\n\t\t\tcontinue;\n\t\t}\n        \n\t\t//Next column (if not in quote)\n\t\tif (char == ',' && !inQuote) { \n\t\t\tcol++;\n\t\t\tcontinue; \n\t\t}\n        \n\t\t//New row if new line and not in quote (CRLF) \n\t\tif (char == '\\r' && nextChar == '\\n' && !inQuote) { \n\t\t\tcol = 0; \n\t\t\trow++; \n\t\t\tindex++; \n\t\t\tcontinue; \n\t\t}\n        \n\t\t//New row if new line and not in quote (CR or LF) \n\t\tif ((char == '\\r' || char == '\\n') && !inQuote) { \n\t\t\tcol = 0;\n\t\t\trow++;\n\t\t\tcontinue; \n\t\t}\n\n\t\t//Normal Character, append to column\n\t\tdata[row][col] += char;\n\t}\n\n\treturn data;\n}\n\nfunction json(input){\n\ttry {\n\t\treturn JSON.parse(input);\n\t} catch(e) {\n\t\tconsole.warn(\"JSON Import Error - File contents is invalid JSON\", e);\n\t\treturn Promise.reject();\n\t}\n}\n\nfunction array$1 (input){\n\treturn input;\n}\n\nfunction xlsx(input){\r\n\tvar XLSXLib = this.dependencyRegistry.lookup(\"XLSX\"),\r\n\tworkbook2 = XLSXLib.read(input),\r\n\tsheet = workbook2.Sheets[workbook2.SheetNames[0]];\r\n\t\r\n\treturn XLSXLib.utils.sheet_to_json(sheet, {header: 1 });\r\n}\n\nvar defaultImporters = {\n\tcsv:csv,\n\tjson:json,\n\tarray:array$1,\n\txlsx:xlsx,\n};\n\nclass Import extends Module{\n\t\n\tstatic moduleName = \"import\";\n\t\n\t//load defaults\n\tstatic importers = defaultImporters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.registerTableOption(\"importFormat\");\n\t\tthis.registerTableOption(\"importReader\", \"text\");\n\t\tthis.registerTableOption(\"importHeaderTransform\");\n\t\tthis.registerTableOption(\"importValueTransform\");\n\t\tthis.registerTableOption(\"importDataValidator\");\n\t\tthis.registerTableOption(\"importFileValidator\");\n\t}\n\t\n\tinitialize(){\n\t\tthis.registerTableFunction(\"import\", this.importFromFile.bind(this));\n\t\t\n\t\tif(this.table.options.importFormat){\n\t\t\tthis.subscribe(\"data-loading\", this.loadDataCheck.bind(this), 10);\n\t\t\tthis.subscribe(\"data-load\", this.loadData.bind(this), 10);\n\t\t}\n\t}\n\t\n\tloadDataCheck(data){\n\t\treturn this.table.options.importFormat && (typeof data === \"string\" || (Array.isArray(data) && data.length && Array.isArray(data)));\n\t}\n\t\n\tloadData(data, params, config, silent, previousData){\n\t\treturn this.importData(this.lookupImporter(), data)\n\t\t\t.then(this.structureData.bind(this))\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.error(\"Import Error:\", err || \"Unable to import data\");\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t}\n\t\n\tlookupImporter(importFormat){\n\t\tvar importer;\n\t\t\n\t\tif(!importFormat){\n\t\t\timportFormat = this.table.options.importFormat;\n\t\t}\n\t\t\n\t\tif(typeof importFormat === \"string\"){\n\t\t\timporter = Import.importers[importFormat];\n\t\t}else {\n\t\t\timporter = importFormat;\n\t\t}\n\t\t\n\t\tif(!importer){\n\t\t\tconsole.error(\"Import Error - Importer not found:\", importFormat);\n\t\t}\n\t\t\n\t\treturn importer;\n\t}\n\t\n\timportFromFile(importFormat, extension, importReader){\n\t\tvar importer = this.lookupImporter(importFormat);\n\t\t\n\t\tif(importer){\n\t\t\treturn this.pickFile(extension, importReader)\n\t\t\t\t.then(this.importData.bind(this, importer))\n\t\t\t\t.then(this.structureData.bind(this))\n\t\t\t\t.then(this.mutateData.bind(this))\n\t\t\t\t.then(this.validateData.bind(this))\n\t\t\t\t.then(this.setData.bind(this))\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tthis.dispatch(\"import-error\", err);\n\t\t\t\t\tthis.dispatchExternal(\"importError\", err);\n\t\t\t\t\t\n\t\t\t\t\tconsole.error(\"Import Error:\", err || \"Unable to import file\");\n\t\t\t\t\t\n\t\t\t\t\tthis.table.dataLoader.alertError();\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.table.dataLoader.clearAlert();\n\t\t\t\t\t}, 3000);\n\t\t\t\t\t\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t});\n\t\t}\n\t}\n\t\n\tpickFile(extensions, importReader){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar input = document.createElement(\"input\");\n\t\t\tinput.type = \"file\";\n\t\t\tinput.accept = extensions;\n\t\t\t\n\t\t\tinput.addEventListener(\"change\", (e) => {\n\t\t\t\tvar file = input.files[0],\n\t\t\t\treader = new FileReader(),\n\t\t\t\tvalid = this.validateFile(file);\n\n\t\t\t\tif(valid === true){\n\t\t\t\t\n\t\t\t\t\tthis.dispatch(\"import-importing\", input.files);\n\t\t\t\t\tthis.dispatchExternal(\"importImporting\", input.files);\n\t\t\t\t\n\t\t\t\t\tswitch(importReader || this.table.options.importReader){\n\t\t\t\t\t\tcase \"buffer\":\n\t\t\t\t\t\t\treader.readAsArrayBuffer(file);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase \"binary\":\n\t\t\t\t\t\t\treader.readAsBinaryString(file);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase \"url\":\n\t\t\t\t\t\t\treader.readAsDataURL(file);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase \"text\":\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treader.readAsText(file);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treader.onload = (e) => {\n\t\t\t\t\t\tresolve(reader.result);\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\treader.onerror = (e) => {\n\t\t\t\t\t\tconsole.warn(\"File Load Error - Unable to read file\");\n\t\t\t\t\t\treject(e);\n\t\t\t\t\t};\n\t\t\t\t}else {\n\t\t\t\t\treject(valid);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.dispatch(\"import-choose\");\n\t\t\tthis.dispatchExternal(\"importChoose\");\n\t\t\tinput.click();\n\t\t});\n\t}\n\t\n\timportData(importer, fileContents){\n\t\tvar data;\n\t\t\n\t\tthis.table.dataLoader.alertLoader();\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tdata = importer.call(this.table, fileContents);\n\t\t\t\t\n\t\t\t\tif(data instanceof Promise){\n\t\t\t\t\tresolve(data);\n\t\t\t\t}else {\n\t\t\t\t\tdata ? resolve(data) : reject();\n\t\t\t\t}\n\t\t\t}, 10);\n\t\t});\n\t}\n\t\n\tstructureData(parsedData){\n\t\tvar data = [];\n\t\t\n\t\tif(Array.isArray(parsedData) && parsedData.length && Array.isArray(parsedData[0])){\n\t\t\tif(this.table.options.autoColumns){\n\t\t\t\tdata = this.structureArrayToObject(parsedData);\n\t\t\t}else {\n\t\t\t\tdata = this.structureArrayToColumns(parsedData);\n\t\t\t}\n\t\t\t\n\t\t\treturn data;\n\t\t}else {\n\t\t\treturn parsedData;\n\t\t}\n\t}\n\t\n\tmutateData(data){\n\t\tvar output = [];\n\t\t\n\t\tif(Array.isArray(data)){\n\t\t\tdata.forEach((row) => {\n\t\t\t\toutput.push(this.table.modules.mutator.transformRow(row, \"import\"));\n\t\t\t});\n\t\t}else {\n\t\t\toutput = data;\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\ttransformHeader(headers){\n\t\tvar output = [];\n\t\t\n\t\tif(this.table.options.importHeaderTransform){\n\t\t\theaders.forEach((item) => {\n\t\t\t\toutput.push(this.table.options.importHeaderTransform.call(this.table, item, headers));\n\t\t\t});\n\t\t}else {\n\t\t\treturn headers;\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\ttransformData(row){\n\t\tvar output = [];\n\n\t\tif(this.table.options.importValueTransform){\n\t\t\trow.forEach((item) => {\n\t\t\t\toutput.push(this.table.options.importValueTransform.call(this.table, item, row));\n\t\t\t});\n\t\t}else {\n\t\t\treturn row;\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tstructureArrayToObject(parsedData){\n\t\tvar columns = this.transformHeader(parsedData.shift());\t\n\t\t\n\t\tvar data = parsedData.map((values) => {\n\t\t\tvar row = {};\n\n\t\t\tvalues = this.transformData(values);\n\t\t\t\n\t\t\tcolumns.forEach((key, i) => {\n\t\t\t\trow[key] = values[i];\n\t\t\t});\n\t\t\t\n\t\t\treturn row;\n\t\t});\n\t\t\n\t\treturn data;\n\t}\n\t\n\tstructureArrayToColumns(parsedData){\n\t\tvar data = [],\n\t\tfirstRow = this.transformHeader(parsedData[0]),\n\t\tcolumns = this.table.getColumns();\n\t\t\n\t\t//remove first row if it is the column names\n\t\tif(columns[0] && firstRow[0]){\n\t\t\tif(columns[0].getDefinition().title === firstRow[0]){\n\t\t\t\tparsedData.shift();\n\t\t\t}\n\t\t}\n\t\t\n\t\t//convert row arrays to objects\n\t\tparsedData.forEach((rowData) => {\n\t\t\tvar row = {};\n\n\t\t\trowData = this.transformData(rowData);\n\t\t\t\n\t\t\trowData.forEach((value, index) => {\n\t\t\t\tvar column = columns[index];\n\t\t\t\t\n\t\t\t\tif(column){\n\t\t\t\t\trow[column.getField()] = value;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tdata.push(row);\n\t\t});\n\t\t\n\t\treturn data;\n\t}\n\n\tvalidateFile(file){\n\t\tif(this.table.options.importFileValidator){\n\t\t\treturn this.table.options.importFileValidator.call(this.table, file);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tvalidateData(data){\n\t\tvar result;\n\n\t\tif(this.table.options.importDataValidator){\n\t\t\tresult = this.table.options.importDataValidator.call(this.table, data);\n\n\t\t\tif(result === true){\n\t\t\t\treturn data;\n\t\t\t}else {\n\t\t\t\treturn Promise.reject(result);\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\t\n\tsetData(data){\n\t\tthis.dispatch(\"import-imported\", data);\n\t\tthis.dispatchExternal(\"importImported\", data);\n\t\t\n\t\tthis.table.dataLoader.clearAlert();\n\t\t\n\t\treturn this.table.setData(data);\n\t}\n}\n\nclass Interaction extends Module{\n\n\tstatic moduleName = \"interaction\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.eventMap = {\n\t\t\t//row events\n\t\t\trowClick:\"row-click\",\n\t\t\trowDblClick:\"row-dblclick\",\n\t\t\trowContext:\"row-contextmenu\",\n\t\t\trowMouseEnter:\"row-mouseenter\",\n\t\t\trowMouseLeave:\"row-mouseleave\",\n\t\t\trowMouseOver:\"row-mouseover\",\n\t\t\trowMouseOut:\"row-mouseout\",\n\t\t\trowMouseMove:\"row-mousemove\",\n\t\t\trowMouseDown:\"row-mousedown\",\n\t\t\trowMouseUp:\"row-mouseup\",\n\t\t\trowTap:\"row\",\n\t\t\trowDblTap:\"row\",\n\t\t\trowTapHold:\"row\",\n\n\t\t\t//cell events\n\t\t\tcellClick:\"cell-click\",\n\t\t\tcellDblClick:\"cell-dblclick\",\n\t\t\tcellContext:\"cell-contextmenu\",\n\t\t\tcellMouseEnter:\"cell-mouseenter\",\n\t\t\tcellMouseLeave:\"cell-mouseleave\",\n\t\t\tcellMouseOver:\"cell-mouseover\",\n\t\t\tcellMouseOut:\"cell-mouseout\",\n\t\t\tcellMouseMove:\"cell-mousemove\",\n\t\t\tcellMouseDown:\"cell-mousedown\",\n\t\t\tcellMouseUp:\"cell-mouseup\",\n\t\t\tcellTap:\"cell\",\n\t\t\tcellDblTap:\"cell\",\n\t\t\tcellTapHold:\"cell\",\n\n\t\t\t//column header events\n\t\t\theaderClick:\"column-click\",\n\t\t\theaderDblClick:\"column-dblclick\",\n\t\t\theaderContext:\"column-contextmenu\",\n\t\t\theaderMouseEnter:\"column-mouseenter\",\n\t\t\theaderMouseLeave:\"column-mouseleave\",\n\t\t\theaderMouseOver:\"column-mouseover\",\n\t\t\theaderMouseOut:\"column-mouseout\",\n\t\t\theaderMouseMove:\"column-mousemove\",\n\t\t\theaderMouseDown:\"column-mousedown\",\n\t\t\theaderMouseUp:\"column-mouseup\",\n\t\t\theaderTap:\"column\",\n\t\t\theaderDblTap:\"column\",\n\t\t\theaderTapHold:\"column\",\n\n\t\t\t//group header\n\t\t\tgroupClick:\"group-click\",\n\t\t\tgroupDblClick:\"group-dblclick\",\n\t\t\tgroupContext:\"group-contextmenu\",\n\t\t\tgroupMouseEnter:\"group-mouseenter\",\n\t\t\tgroupMouseLeave:\"group-mouseleave\",\n\t\t\tgroupMouseOver:\"group-mouseover\",\n\t\t\tgroupMouseOut:\"group-mouseout\",\n\t\t\tgroupMouseMove:\"group-mousemove\",\n\t\t\tgroupMouseDown:\"group-mousedown\",\n\t\t\tgroupMouseUp:\"group-mouseup\",\n\t\t\tgroupTap:\"group\",\n\t\t\tgroupDblTap:\"group\",\n\t\t\tgroupTapHold:\"group\",\n\t\t};\n\n\t\tthis.subscribers = {};\n\n\t\tthis.touchSubscribers = {};\n\n\t\tthis.columnSubscribers = {};\n\n\t\tthis.touchWatchers = {\n\t\t\trow:{\n\t\t\t\ttap:null,\n\t\t\t\ttapDbl:null,\n\t\t\t\ttapHold:null,\n\t\t\t},\n\t\t\tcell:{\n\t\t\t\ttap:null,\n\t\t\t\ttapDbl:null,\n\t\t\t\ttapHold:null,\n\t\t\t},\n\t\t\tcolumn:{\n\t\t\t\ttap:null,\n\t\t\t\ttapDbl:null,\n\t\t\t\ttapHold:null,\n\t\t\t},\n\t\t\tgroup:{\n\t\t\t\ttap:null,\n\t\t\t\ttapDbl:null,\n\t\t\t\ttapHold:null,\n\t\t\t}\n\t\t};\n\n\t\tthis.registerColumnOption(\"headerClick\");\n\t\tthis.registerColumnOption(\"headerDblClick\");\n\t\tthis.registerColumnOption(\"headerContext\");\n\t\tthis.registerColumnOption(\"headerMouseEnter\");\n\t\tthis.registerColumnOption(\"headerMouseLeave\");\n\t\tthis.registerColumnOption(\"headerMouseOver\");\n\t\tthis.registerColumnOption(\"headerMouseOut\");\n\t\tthis.registerColumnOption(\"headerMouseMove\");\n\t\tthis.registerColumnOption(\"headerMouseDown\");\n\t\tthis.registerColumnOption(\"headerMouseUp\");\n\t\tthis.registerColumnOption(\"headerTap\");\n\t\tthis.registerColumnOption(\"headerDblTap\");\n\t\tthis.registerColumnOption(\"headerTapHold\");\n\n\t\tthis.registerColumnOption(\"cellClick\");\n\t\tthis.registerColumnOption(\"cellDblClick\");\n\t\tthis.registerColumnOption(\"cellContext\");\n\t\tthis.registerColumnOption(\"cellMouseEnter\");\n\t\tthis.registerColumnOption(\"cellMouseLeave\");\n\t\tthis.registerColumnOption(\"cellMouseOver\");\n\t\tthis.registerColumnOption(\"cellMouseOut\");\n\t\tthis.registerColumnOption(\"cellMouseMove\");\n\t\tthis.registerColumnOption(\"cellMouseDown\");\n\t\tthis.registerColumnOption(\"cellMouseUp\");\n\t\tthis.registerColumnOption(\"cellTap\");\n\t\tthis.registerColumnOption(\"cellDblTap\");\n\t\tthis.registerColumnOption(\"cellTapHold\");\n\n\t}\n\n\tinitialize(){\n\t\tthis.initializeExternalEvents();\n\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"cell-dblclick\", this.cellContentsSelectionFixer.bind(this));\n\t\tthis.subscribe(\"scroll-horizontal\", this.clearTouchWatchers.bind(this));\n\t\tthis.subscribe(\"scroll-vertical\", this.clearTouchWatchers.bind(this));\n\t}\n\n\tclearTouchWatchers(){\n\t\tvar types = Object.values(this.touchWatchers);\n\n\t\ttypes.forEach((type) => {\n\t\t\tfor(let key in type){\n\t\t\t\ttype[key] = null;\n\t\t\t}\n\t\t});\n\t}\n\t\t\n\tcellContentsSelectionFixer(e, cell){\n\t\tvar range;\n\n\t\tif(this.table.modExists(\"edit\")){\n\t\t\tif (this.table.modules.edit.currentCell === cell){\n\t\t\t\treturn; //prevent instant selection of editor content\n\t\t\t}\n\t\t}\n\n\t\te.preventDefault();\n\n\t\ttry{\n\t\t\tif (document.selection) { // IE\n\t\t\t\trange = document.body.createTextRange();\n\t\t\t\trange.moveToElementText(cell.getElement());\n\t\t\t\trange.select();\n\t\t\t} else if (window.getSelection) {\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.selectNode(cell.getElement());\n\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\twindow.getSelection().addRange(range);\n\t\t\t}\n\t\t}catch(e){}\n\t}\n\n\tinitializeExternalEvents(){\n\t\tfor(let key in this.eventMap){\n\t\t\tthis.subscriptionChangeExternal(key, this.subscriptionChanged.bind(this, key));\n\t\t}\n\t}\n\n\tsubscriptionChanged(key, added){\n\t\tif(added){\n\t\t\tif(!this.subscribers[key]){\n\t\t\t\tif(this.eventMap[key].includes(\"-\")){\n\t\t\t\t\tthis.subscribers[key] = this.handle.bind(this, key);\n\t\t\t\t\tthis.subscribe(this.eventMap[key], this.subscribers[key]);\n\t\t\t\t}else {\n\t\t\t\t\tthis.subscribeTouchEvents(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tif(this.eventMap[key].includes(\"-\")){\n\t\t\t\tif(this.subscribers[key] && !this.columnSubscribers[key]  && !this.subscribedExternal(key)){\n\t\t\t\t\tthis.unsubscribe(this.eventMap[key], this.subscribers[key]);\n\t\t\t\t\tdelete this.subscribers[key];\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.unsubscribeTouchEvents(key);\n\t\t\t}\n\t\t}\n\t}\n\n\n\tsubscribeTouchEvents(key){\n\t\tvar type = this.eventMap[key];\n\n\t\tif(!this.touchSubscribers[type + \"-touchstart\"]){\n\t\t\tthis.touchSubscribers[type + \"-touchstart\"] = this.handleTouch.bind(this, type, \"start\");\n\t\t\tthis.touchSubscribers[type + \"-touchend\"] = this.handleTouch.bind(this, type, \"end\");\n\n\t\t\tthis.subscribe(type + \"-touchstart\", this.touchSubscribers[type + \"-touchstart\"]);\n\t\t\tthis.subscribe(type + \"-touchend\", this.touchSubscribers[type + \"-touchend\"]);\n\t\t}\n\n\t\tthis.subscribers[key] = true;\n\t}\n\n\tunsubscribeTouchEvents(key){\n\t\tvar noTouch = true,\n\t\ttype = this.eventMap[key];\n\n\t\tif(this.subscribers[key] && !this.subscribedExternal(key)){\n\t\t\tdelete this.subscribers[key];\n\n\t\t\tfor(let i in this.eventMap){\n\t\t\t\tif(this.eventMap[i] === type){\n\t\t\t\t\tif(this.subscribers[i]){\n\t\t\t\t\t\tnoTouch = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(noTouch){\n\t\t\t\tthis.unsubscribe(type + \"-touchstart\", this.touchSubscribers[type + \"-touchstart\"]);\n\t\t\t\tthis.unsubscribe(type + \"-touchend\", this.touchSubscribers[type + \"-touchend\"]);\n\n\t\t\t\tdelete this.touchSubscribers[type + \"-touchstart\"];\n\t\t\t\tdelete this.touchSubscribers[type + \"-touchend\"];\n\t\t\t}\n\t\t}\n\t}\n\n\tinitializeColumn(column){\n\t\tvar def = column.definition;\n\n\t\tfor(let key in this.eventMap){\n\t\t\tif(def[key]){\n\t\t\t\tthis.subscriptionChanged(key, true);\n\n\t\t\t\tif(!this.columnSubscribers[key]){\n\t\t\t\t\tthis.columnSubscribers[key] = [];\n\t\t\t\t}\n\n\t\t\t\tthis.columnSubscribers[key].push(column);\n\t\t\t}\n\t\t}\n\t}\n\n\thandle(action, e, component){\n\t\tthis.dispatchEvent(action, e, component);\n\t}\n\n\thandleTouch(type, action, e, component){\n\t\tvar watchers = this.touchWatchers[type];\n\n\t\tif(type === \"column\"){\n\t\t\ttype = \"header\";\n\t\t}\n\n\t\tswitch(action){\n\t\t\tcase \"start\":\n\t\t\t\twatchers.tap = true;\n\n\t\t\t\tclearTimeout(watchers.tapHold);\n\n\t\t\t\twatchers.tapHold = setTimeout(() => {\n\t\t\t\t\tclearTimeout(watchers.tapHold);\n\t\t\t\t\twatchers.tapHold = null;\n\n\t\t\t\t\twatchers.tap = null;\n\t\t\t\t\tclearTimeout(watchers.tapDbl);\n\t\t\t\t\twatchers.tapDbl = null;\n\n\t\t\t\t\tthis.dispatchEvent(type + \"TapHold\", e,  component);\n\t\t\t\t}, 1000);\n\t\t\t\tbreak;\n\n\t\t\tcase \"end\":\n\t\t\t\tif(watchers.tap){\n\n\t\t\t\t\twatchers.tap = null;\n\t\t\t\t\tthis.dispatchEvent(type + \"Tap\", e,  component);\n\t\t\t\t}\n\n\t\t\t\tif(watchers.tapDbl){\n\t\t\t\t\tclearTimeout(watchers.tapDbl);\n\t\t\t\t\twatchers.tapDbl = null;\n\n\t\t\t\t\tthis.dispatchEvent(type + \"DblTap\", e,  component);\n\t\t\t\t}else {\n\t\t\t\t\twatchers.tapDbl = setTimeout(() => {\n\t\t\t\t\t\tclearTimeout(watchers.tapDbl);\n\t\t\t\t\t\twatchers.tapDbl = null;\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\n\t\t\t\tclearTimeout(watchers.tapHold);\n\t\t\t\twatchers.tapHold = null;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tdispatchEvent(action, e, component){\n\t\tvar componentObj = component.getComponent(),\n\t\tcallback;\n\n\t\tif(this.columnSubscribers[action]){\n\n\t\t\tif(component instanceof Cell){\n\t\t\t\tcallback = component.column.definition[action];\n\t\t\t}else if(component instanceof Column){\n\t\t\t\tcallback = component.definition[action];\n\t\t\t}\n\n\t\t\tif(callback){\n\t\t\t\tcallback(e, componentObj);\n\t\t\t}\n\t\t}\n\n\t\tthis.dispatchExternal(action, e, componentObj);\n\t}\n}\n\nvar defaultBindings = {\n\tnavPrev:\"shift + 9\",\n\tnavNext:9,\n\tnavUp:38,\n\tnavDown:40,\n\tnavLeft:37,\n\tnavRight:39,\n\tscrollPageUp:33,\n\tscrollPageDown:34,\n\tscrollToStart:36,\n\tscrollToEnd:35,\n};\n\nvar defaultActions = {\n\tkeyBlock:function(e){\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\n\tscrollPageUp:function(e){\n\t\tvar rowManager = this.table.rowManager,\n\t\tnewPos = rowManager.scrollTop - rowManager.element.clientHeight;\n\n\t\te.preventDefault();\n\n\t\tif(rowManager.displayRowsCount){\n\t\t\tif(newPos >= 0){\n\t\t\t\trowManager.element.scrollTop = newPos;\n\t\t\t}else {\n\t\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[0]);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\n\tscrollPageDown:function(e){\n\t\tvar rowManager = this.table.rowManager,\n\t\tnewPos = rowManager.scrollTop + rowManager.element.clientHeight,\n\t\tscrollMax = rowManager.element.scrollHeight;\n\n\t\te.preventDefault();\n\n\t\tif(rowManager.displayRowsCount){\n\t\t\tif(newPos <= scrollMax){\n\t\t\t\trowManager.element.scrollTop = newPos;\n\t\t\t}else {\n\t\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount - 1]);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.element.focus();\n\n\t},\n\n\tscrollToStart:function(e){\n\t\tvar rowManager = this.table.rowManager;\n\n\t\te.preventDefault();\n\n\t\tif(rowManager.displayRowsCount){\n\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[0]);\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\n\tscrollToEnd:function(e){\n\t\tvar rowManager = this.table.rowManager;\n\n\t\te.preventDefault();\n\n\t\tif(rowManager.displayRowsCount){\n\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount - 1]);\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\n\tnavPrev:function(e){\n\t\tthis.dispatch(\"keybinding-nav-prev\", e);\n\t},\n\n\tnavNext:function(e){\n\t\tthis.dispatch(\"keybinding-nav-next\", e);\n\t},\n\n\tnavLeft:function(e){\n\t\tthis.dispatch(\"keybinding-nav-left\", e);\n\t},\n\n\tnavRight:function(e){\n\t\tthis.dispatch(\"keybinding-nav-right\", e);\n\t},\n\n\tnavUp:function(e){\n\t\tthis.dispatch(\"keybinding-nav-up\", e);\n\t},\n\n\tnavDown:function(e){\n\t\tthis.dispatch(\"keybinding-nav-down\", e);\n\t},\n};\n\nclass Keybindings extends Module{\n\n\tstatic moduleName = \"keybindings\";\n\n\t//load defaults\n\tstatic bindings = defaultBindings;\n\tstatic actions = defaultActions;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.watchKeys = null;\n\t\tthis.pressedKeys = null;\n\t\tthis.keyupBinding = false;\n\t\tthis.keydownBinding = false;\n\n\t\tthis.registerTableOption(\"keybindings\", {}); //array for keybindings\n\t\tthis.registerTableOption(\"tabEndNewRow\", false); //create new row when tab to end of table\n\t}\n\n\tinitialize(){\n\t\tvar bindings = this.table.options.keybindings,\n\t\tmergedBindings = {};\n\n\t\tthis.watchKeys = {};\n\t\tthis.pressedKeys = [];\n\n\t\tif(bindings !== false){\n\t\t\tObject.assign(mergedBindings, Keybindings.bindings);\n\t\t\tObject.assign(mergedBindings, bindings);\n\n\t\t\tthis.mapBindings(mergedBindings);\n\t\t\tthis.bindEvents();\n\t\t}\n\n\t\tthis.subscribe(\"table-destroy\", this.clearBindings.bind(this));\n\t}\n\n\tmapBindings(bindings){\n\t\tfor(let key in bindings){\n\t\t\tif(Keybindings.actions[key]){\n\t\t\t\tif(bindings[key]){\n\t\t\t\t\tif(typeof bindings[key] !== \"object\"){\n\t\t\t\t\t\tbindings[key] = [bindings[key]];\n\t\t\t\t\t}\n\n\t\t\t\t\tbindings[key].forEach((binding) => {\n\t\t\t\t\t\tvar bindingList = Array.isArray(binding) ?  binding : [binding];\n\t\t\t\t\t\t\n\t\t\t\t\t\tbindingList.forEach((item) => {\n\t\t\t\t\t\t\tthis.mapBinding(key, item);\n\t\t\t\t\t\t});\t\t\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Key Binding Error - no such action:\", key);\n\t\t\t}\n\t\t}\n\t}\n\n\tmapBinding(action, symbolsList){\n\t\tvar binding = {\n\t\t\taction: Keybindings.actions[action],\n\t\t\tkeys: [],\n\t\t\tctrl: false,\n\t\t\tshift: false,\n\t\t\tmeta: false,\n\t\t};\n\n\t\tvar symbols = symbolsList.toString().toLowerCase().split(\" \").join(\"\").split(\"+\");\n\n\t\tsymbols.forEach((symbol) => {\n\t\t\tswitch(symbol){\n\t\t\t\tcase \"ctrl\":\n\t\t\t\t\tbinding.ctrl = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"shift\":\n\t\t\t\t\tbinding.shift = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"meta\":\n\t\t\t\t\tbinding.meta = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tsymbol = isNaN(symbol) ? symbol.toUpperCase().charCodeAt(0) : parseInt(symbol);\n\t\t\t\t\tbinding.keys.push(symbol);\n\n\t\t\t\t\tif(!this.watchKeys[symbol]){\n\t\t\t\t\t\tthis.watchKeys[symbol] = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.watchKeys[symbol].push(binding);\n\t\t\t}\n\t\t});\n\t}\n\n\tbindEvents(){\n\t\tvar self = this;\n\n\t\tthis.keyupBinding = function(e){\n\t\t\tvar code = e.keyCode;\n\t\t\tvar bindings = self.watchKeys[code];\n\n\t\t\tif(bindings){\n\n\t\t\t\tself.pressedKeys.push(code);\n\n\t\t\t\tbindings.forEach(function(binding){\n\t\t\t\t\tself.checkBinding(e, binding);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tthis.keydownBinding = function(e){\n\t\t\tvar code = e.keyCode;\n\t\t\tvar bindings = self.watchKeys[code];\n\n\t\t\tif(bindings){\n\n\t\t\t\tvar index = self.pressedKeys.indexOf(code);\n\n\t\t\t\tif(index > -1){\n\t\t\t\t\tself.pressedKeys.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.table.element.addEventListener(\"keydown\", this.keyupBinding);\n\n\t\tthis.table.element.addEventListener(\"keyup\", this.keydownBinding);\n\t}\n\n\tclearBindings(){\n\t\tif(this.keyupBinding){\n\t\t\tthis.table.element.removeEventListener(\"keydown\", this.keyupBinding);\n\t\t}\n\n\t\tif(this.keydownBinding){\n\t\t\tthis.table.element.removeEventListener(\"keyup\", this.keydownBinding);\n\t\t}\n\t}\n\n\tcheckBinding(e, binding){\n\t\tvar match = true;\n\n\t\tif(e.ctrlKey == binding.ctrl && e.shiftKey == binding.shift && e.metaKey == binding.meta){\n\t\t\tbinding.keys.forEach((key) => {\n\t\t\t\tvar index = this.pressedKeys.indexOf(key);\n\n\t\t\t\tif(index == -1){\n\t\t\t\t\tmatch = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(match){\n\t\t\t\tbinding.action.call(this, e);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nclass Menu extends Module{\n\n\tstatic moduleName = \"menu\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.menuContainer = null;\n\t\tthis.nestedMenuBlock = false;\n\t\t\n\t\tthis.currentComponent = null;\n\t\tthis.rootPopup = null;\n\t\t\n\t\tthis.columnSubscribers = {};\n\t\t\n\t\t// this.registerTableOption(\"menuContainer\", undefined); //deprecated\n\t\t\n\t\tthis.registerTableOption(\"rowContextMenu\", false);\n\t\tthis.registerTableOption(\"rowClickMenu\", false);\n\t\tthis.registerTableOption(\"rowDblClickMenu\", false);\n\t\tthis.registerTableOption(\"groupContextMenu\", false);\n\t\tthis.registerTableOption(\"groupClickMenu\", false);\n\t\tthis.registerTableOption(\"groupDblClickMenu\", false);\n\t\t\n\t\tthis.registerColumnOption(\"headerContextMenu\");\n\t\tthis.registerColumnOption(\"headerClickMenu\");\n\t\tthis.registerColumnOption(\"headerDblClickMenu\");\n\t\tthis.registerColumnOption(\"headerMenu\");\n\t\tthis.registerColumnOption(\"headerMenuIcon\");\n\t\tthis.registerColumnOption(\"contextMenu\");\n\t\tthis.registerColumnOption(\"clickMenu\");\n\t\tthis.registerColumnOption(\"dblClickMenu\");\n\t\t\n\t}\n\t\n\tinitialize(){\n\t\tthis.deprecatedOptionsCheck();\n\t\tthis.initializeRowWatchers();\n\t\tthis.initializeGroupWatchers();\n\t\t\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t}\n\t\n\tdeprecatedOptionsCheck(){\n\t\t// if(!this.deprecationCheck(\"menuContainer\", \"popupContainer\")){\n\t\t// \tthis.table.options.popupContainer = this.table.options.menuContainer;\n\t\t// }\n\t}\t\n\t\n\tinitializeRowWatchers(){\n\t\tif(this.table.options.rowContextMenu){\n\t\t\tthis.subscribe(\"row-contextmenu\", this.loadMenuEvent.bind(this, this.table.options.rowContextMenu));\n\t\t\tthis.table.on(\"rowTapHold\", this.loadMenuEvent.bind(this, this.table.options.rowContextMenu));\n\t\t}\n\t\t\n\t\tif(this.table.options.rowClickMenu){\n\t\t\tthis.subscribe(\"row-click\", this.loadMenuEvent.bind(this, this.table.options.rowClickMenu));\n\t\t}\n\t\t\n\t\tif(this.table.options.rowDblClickMenu){\n\t\t\tthis.subscribe(\"row-dblclick\", this.loadMenuEvent.bind(this, this.table.options.rowDblClickMenu));\n\t\t}\n\t}\n\t\n\tinitializeGroupWatchers(){\n\t\tif(this.table.options.groupContextMenu){\n\t\t\tthis.subscribe(\"group-contextmenu\", this.loadMenuEvent.bind(this, this.table.options.groupContextMenu));\n\t\t\tthis.table.on(\"groupTapHold\", this.loadMenuEvent.bind(this, this.table.options.groupContextMenu));\n\t\t}\n\t\t\n\t\tif(this.table.options.groupClickMenu){\n\t\t\tthis.subscribe(\"group-click\", this.loadMenuEvent.bind(this, this.table.options.groupClickMenu));\n\t\t}\n\t\t\n\t\tif(this.table.options.groupDblClickMenu){\n\t\t\tthis.subscribe(\"group-dblclick\", this.loadMenuEvent.bind(this, this.table.options.groupDblClickMenu));\n\t\t}\n\t}\n\n\tinitializeColumn(column){\n\t\tvar\tdef = column.definition;\n\t\t\n\t\t//handle column events\n\t\tif(def.headerContextMenu && !this.columnSubscribers.headerContextMenu){\n\t\t\tthis.columnSubscribers.headerContextMenu = this.loadMenuTableColumnEvent.bind(this, \"headerContextMenu\");\n\t\t\tthis.subscribe(\"column-contextmenu\", this.columnSubscribers.headerContextMenu);\n\t\t\tthis.table.on(\"headerTapHold\", this.loadMenuTableColumnEvent.bind(this, \"headerContextMenu\"));\n\t\t}\n\t\t\n\t\tif(def.headerClickMenu && !this.columnSubscribers.headerClickMenu){\n\t\t\tthis.columnSubscribers.headerClickMenu = this.loadMenuTableColumnEvent.bind(this, \"headerClickMenu\");\n\t\t\tthis.subscribe(\"column-click\", this.columnSubscribers.headerClickMenu);\n\t\t}\n\t\t\n\t\tif(def.headerDblClickMenu && !this.columnSubscribers.headerDblClickMenu){\n\t\t\tthis.columnSubscribers.headerDblClickMenu = this.loadMenuTableColumnEvent.bind(this, \"headerDblClickMenu\");\n\t\t\tthis.subscribe(\"column-dblclick\", this.columnSubscribers.headerDblClickMenu);\n\t\t}\n\t\t\n\t\tif(def.headerMenu){\n\t\t\tthis.initializeColumnHeaderMenu(column);\n\t\t}\n\t\t\n\t\t//handle cell events\n\t\tif(def.contextMenu && !this.columnSubscribers.contextMenu){\n\t\t\tthis.columnSubscribers.contextMenu = this.loadMenuTableCellEvent.bind(this, \"contextMenu\");\n\t\t\tthis.subscribe(\"cell-contextmenu\", this.columnSubscribers.contextMenu);\n\t\t\tthis.table.on(\"cellTapHold\", this.loadMenuTableCellEvent.bind(this, \"contextMenu\"));\n\t\t}\n\t\t\n\t\tif(def.clickMenu && !this.columnSubscribers.clickMenu){\n\t\t\tthis.columnSubscribers.clickMenu = this.loadMenuTableCellEvent.bind(this, \"clickMenu\");\n\t\t\tthis.subscribe(\"cell-click\", this.columnSubscribers.clickMenu);\n\t\t}\n\t\t\n\t\tif(def.dblClickMenu && !this.columnSubscribers.dblClickMenu){\n\t\t\tthis.columnSubscribers.dblClickMenu = this.loadMenuTableCellEvent.bind(this, \"dblClickMenu\");\n\t\t\tthis.subscribe(\"cell-dblclick\", this.columnSubscribers.dblClickMenu);\n\t\t}\n\t}\n\t\n\tinitializeColumnHeaderMenu(column){\n\t\tvar icon = column.definition.headerMenuIcon,\n\t\theaderMenuEl;\n\t\t\n\t\theaderMenuEl = document.createElement(\"span\");\n\t\theaderMenuEl.classList.add(\"tabulator-header-popup-button\");\n\t\t\n\t\tif(icon){\n\t\t\tif(typeof icon === \"function\"){\n\t\t\t\ticon = icon(column.getComponent());\n\t\t\t}\n\t\t\t\n\t\t\tif(icon instanceof HTMLElement){\n\t\t\t\theaderMenuEl.appendChild(icon);\n\t\t\t}else {\n\t\t\t\theaderMenuEl.innerHTML = icon;\n\t\t\t}\n\t\t}else {\n\t\t\theaderMenuEl.innerHTML = \"&vellip;\";\n\t\t}\n\t\t\n\t\theaderMenuEl.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tthis.loadMenuEvent(column.definition.headerMenu, e, column);\n\t\t});\n\t\t\n\t\tcolumn.titleElement.insertBefore(headerMenuEl, column.titleElement.firstChild);\n\t}\n\t\n\tloadMenuTableCellEvent(option, e, cell){\n\t\tif(cell._cell){\n\t\t\tcell = cell._cell;\n\t\t}\n\t\t\n\t\tif(cell.column.definition[option]){\n\t\t\tthis.loadMenuEvent(cell.column.definition[option], e, cell);\n\t\t}\n\t}\n\t\n\tloadMenuTableColumnEvent(option, e, column){\n\t\tif(column._column){\n\t\t\tcolumn = column._column;\n\t\t}\n\t\t\n\t\tif(column.definition[option]){\n\t\t\tthis.loadMenuEvent(column.definition[option], e, column);\n\t\t}\n\t}\n\t\n\tloadMenuEvent(menu, e, component){\n\t\tif(component._group){\n\t\t\tcomponent = component._group;\n\t\t}else if(component._row){\n\t\t\tcomponent = component._row;\n\t\t}\n\t\t\n\t\tmenu = typeof menu == \"function\" ? menu.call(this.table, e, component.getComponent()) : menu;\n\t\t\n\t\tthis.loadMenu(e, component, menu);\n\t}\n\t\n\tloadMenu(e, component, menu, parentEl, parentPopup){\n\t\tvar touch = !(e instanceof MouseEvent),\t\t\n\t\tmenuEl = document.createElement(\"div\"),\n\t\tpopup;\n\t\t\n\t\tmenuEl.classList.add(\"tabulator-menu\");\n\t\t\n\t\tif(!touch){\n\t\t\te.preventDefault();\n\t\t}\n\t\t\n\t\t//abort if no menu set\n\t\tif(!menu || !menu.length){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif(!parentEl){\n\t\t\tif(this.nestedMenuBlock){\n\t\t\t\t//abort if child menu already open\n\t\t\t\tif(this.rootPopup){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.nestedMenuBlock = setTimeout(() => {\n\t\t\t\t\tthis.nestedMenuBlock = false;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.rootPopup){\n\t\t\t\tthis.rootPopup.hide();\t\n\t\t\t}\n\t\t\t\n\t\t\tthis.rootPopup = popup = this.popup(menuEl);\n\t\t\t\n\t\t}else {\n\t\t\tpopup = parentPopup.child(menuEl);\n\t\t}\n\t\t\n\t\tmenu.forEach((item) => {\n\t\t\tvar itemEl = document.createElement(\"div\"),\n\t\t\tlabel = item.label,\n\t\t\tdisabled = item.disabled;\n\t\t\t\n\t\t\tif(item.separator){\n\t\t\t\titemEl.classList.add(\"tabulator-menu-separator\");\n\t\t\t}else {\n\t\t\t\titemEl.classList.add(\"tabulator-menu-item\");\n\t\t\t\t\n\t\t\t\tif(typeof label == \"function\"){\n\t\t\t\t\tlabel = label.call(this.table, component.getComponent());\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(label instanceof Node){\n\t\t\t\t\titemEl.appendChild(label);\n\t\t\t\t}else {\n\t\t\t\t\titemEl.innerHTML = label;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(typeof disabled == \"function\"){\n\t\t\t\t\tdisabled = disabled.call(this.table, component.getComponent());\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(disabled){\n\t\t\t\t\titemEl.classList.add(\"tabulator-menu-item-disabled\");\n\t\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tif(item.menu && item.menu.length){\n\t\t\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tthis.loadMenu(e, component, item.menu, itemEl, popup);\n\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(item.action){\n\t\t\t\t\t\t\titemEl.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\t\t\titem.action(e, component.getComponent());\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(item.menu && item.menu.length){\n\t\t\t\t\titemEl.classList.add(\"tabulator-menu-item-submenu\");\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tmenuEl.appendChild(itemEl);\n\t\t});\n\t\t\n\t\tmenuEl.addEventListener(\"click\", (e) => {\n\t\t\tif(this.rootPopup){\n\t\t\t\tthis.rootPopup.hide();\n\t\t\t}\n\t\t});\n\t\t\n\t\tpopup.show(parentEl || e);\n\t\t\n\t\tif(popup === this.rootPopup){\n\t\t\tthis.rootPopup.hideOnBlur(() => {\n\t\t\t\tthis.rootPopup = null;\n\t\t\t\t\n\t\t\t\tif(this.currentComponent){\n\t\t\t\t\tthis.dispatch(\"menu-closed\", menu, popup);\n\t\t\t\t\tthis.dispatchExternal(\"menuClosed\", this.currentComponent.getComponent());\n\t\t\t\t\tthis.currentComponent = null;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.currentComponent = component;\n\t\t\t\n\t\t\tthis.dispatch(\"menu-opened\", menu, popup);\n\t\t\tthis.dispatchExternal(\"menuOpened\", component.getComponent());\n\t\t}\n\t}\n}\n\nclass MoveColumns extends Module{\n\n\tstatic moduleName = \"moveColumn\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.placeholderElement = this.createPlaceholderElement();\n\t\tthis.hoverElement = false; //floating column header element\n\t\tthis.checkTimeout = false; //click check timeout holder\n\t\tthis.checkPeriod = 250; //period to wait on mousedown to consider this a move and not a click\n\t\tthis.moving = false; //currently moving column\n\t\tthis.toCol = false; //destination column\n\t\tthis.toColAfter = false; //position of moving column relative to the destination column\n\t\tthis.startX = 0; //starting position within header element\n\t\tthis.autoScrollMargin = 40; //auto scroll on edge when within margin\n\t\tthis.autoScrollStep = 5; //auto scroll distance in pixels\n\t\tthis.autoScrollTimeout = false; //auto scroll timeout\n\t\tthis.touchMove = false;\n\t\t\n\t\tthis.moveHover = this.moveHover.bind(this);\n\t\tthis.endMove = this.endMove.bind(this);\n\t\t\n\t\tthis.registerTableOption(\"movableColumns\", false); //enable movable columns\n\t}\n\t\n\tcreatePlaceholderElement(){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-col\");\n\t\tel.classList.add(\"tabulator-col-placeholder\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tinitialize(){\n\t\tif(this.table.options.movableColumns){\n\t\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\t\tthis.subscribe(\"alert-show\", this.abortMove.bind(this));\n\t\t}\n\t}\n\n\tabortMove(){\n\t\tclearTimeout(this.checkTimeout);\n\t}\n\t\n\tinitializeColumn(column){\n\t\tvar self = this,\n\t\tconfig = {},\n\t\tcolEl;\n\n\t\tif(!column.modules.frozen && !column.isGroup && !column.isRowHeader){\n\t\t\tcolEl = column.getElement();\n\t\t\t\n\t\t\tconfig.mousemove = function(e){\n\t\t\t\tif(column.parent === self.moving.parent){\n\t\t\t\t\tif((((self.touchMove ? e.touches[0].pageX : e.pageX) - Helpers.elOffset(colEl).left) + self.table.columnManager.contentsElement.scrollLeft) > (column.getWidth() / 2)){\n\t\t\t\t\t\tif(self.toCol !== column || !self.toColAfter){\n\t\t\t\t\t\t\tcolEl.parentNode.insertBefore(self.placeholderElement, colEl.nextSibling);\n\t\t\t\t\t\t\tself.moveColumn(column, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(self.toCol !== column || self.toColAfter){\n\t\t\t\t\t\t\tcolEl.parentNode.insertBefore(self.placeholderElement, colEl);\n\t\t\t\t\t\t\tself.moveColumn(column, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(self);\n\t\t\t\n\t\t\tcolEl.addEventListener(\"mousedown\", function(e){\n\t\t\t\tself.touchMove = false;\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tself.checkTimeout = setTimeout(function(){\n\t\t\t\t\t\tself.startMove(e, column);\n\t\t\t\t\t}, self.checkPeriod);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tcolEl.addEventListener(\"mouseup\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tif(self.checkTimeout){\n\t\t\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tself.bindTouchEvents(column);\n\t\t}\n\t\t\n\t\tcolumn.modules.moveColumn = config;\n\t}\n\t\n\tbindTouchEvents(column){\n\t\tvar colEl = column.getElement(),\n\t\tstartXMove = false, //shifting center position of the cell\n\t\tnextCol, prevCol, nextColWidth, prevColWidth, nextColWidthLast, prevColWidthLast;\n\t\t\n\t\tcolEl.addEventListener(\"touchstart\", (e) => {\n\t\t\tthis.checkTimeout = setTimeout(() => {\n\t\t\t\tthis.touchMove = true;\n\t\t\t\tnextCol = column.nextColumn();\n\t\t\t\tnextColWidth = nextCol ? nextCol.getWidth()/2 : 0;\n\t\t\t\tprevCol = column.prevColumn();\n\t\t\t\tprevColWidth = prevCol ? prevCol.getWidth()/2 : 0;\n\t\t\t\tnextColWidthLast = 0;\n\t\t\t\tprevColWidthLast = 0;\n\t\t\t\tstartXMove = false;\n\t\t\t\t\n\t\t\t\tthis.startMove(e, column);\n\t\t\t}, this.checkPeriod);\n\t\t}, {passive: true});\n\t\t\n\t\tcolEl.addEventListener(\"touchmove\", (e) => {\n\t\t\tvar diff, moveToCol;\n\t\t\t\n\t\t\tif(this.moving){\n\t\t\t\tthis.moveHover(e);\n\t\t\t\t\n\t\t\t\tif(!startXMove){\n\t\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdiff = e.touches[0].pageX - startXMove;\n\t\t\t\t\n\t\t\t\tif(diff > 0){\n\t\t\t\t\tif(nextCol && diff - nextColWidthLast > nextColWidth){\n\t\t\t\t\t\tmoveToCol = nextCol;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(moveToCol !== column){\n\t\t\t\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t\t\t\t\tmoveToCol.getElement().parentNode.insertBefore(this.placeholderElement, moveToCol.getElement().nextSibling);\n\t\t\t\t\t\t\tthis.moveColumn(moveToCol, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tif(prevCol && -diff - prevColWidthLast >  prevColWidth){\n\t\t\t\t\t\tmoveToCol = prevCol;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(moveToCol !== column){\n\t\t\t\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t\t\t\t\tmoveToCol.getElement().parentNode.insertBefore(this.placeholderElement, moveToCol.getElement());\n\t\t\t\t\t\t\tthis.moveColumn(moveToCol, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(moveToCol){\n\t\t\t\t\tnextCol = moveToCol.nextColumn();\n\t\t\t\t\tnextColWidthLast = nextColWidth;\n\t\t\t\t\tnextColWidth = nextCol ? nextCol.getWidth() / 2 : 0;\n\t\t\t\t\tprevCol = moveToCol.prevColumn();\n\t\t\t\t\tprevColWidthLast = prevColWidth;\n\t\t\t\t\tprevColWidth = prevCol ? prevCol.getWidth() / 2 : 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, {passive: true});\n\t\t\n\t\tcolEl.addEventListener(\"touchend\", (e) => {\n\t\t\tif(this.checkTimeout){\n\t\t\t\tclearTimeout(this.checkTimeout);\n\t\t\t}\n\t\t\tif(this.moving){\n\t\t\t\tthis.endMove(e);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tstartMove(e, column){\n\t\tvar element = column.getElement(),\n\t\theaderElement = this.table.columnManager.getContentsElement(),\n\t\theadersElement = this.table.columnManager.getHeadersElement();\n\t\t\n\t\t//Prevent moving columns when range selection is active\n\t\tif(this.table.modules.selectRange && this.table.modules.selectRange.columnSelection){\n\t\t\tif(this.table.modules.selectRange.mousedown && this.table.modules.selectRange.selecting === \"column\"){\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.moving = column;\n\t\tthis.startX = (this.touchMove ? e.touches[0].pageX : e.pageX) - Helpers.elOffset(element).left;\n\t\t\n\t\tthis.table.element.classList.add(\"tabulator-block-select\");\n\t\t\n\t\t//create placeholder\n\t\tthis.placeholderElement.style.width = column.getWidth() + \"px\";\n\t\tthis.placeholderElement.style.height = column.getHeight() + \"px\";\n\t\t\n\t\telement.parentNode.insertBefore(this.placeholderElement, element);\n\t\telement.parentNode.removeChild(element);\n\t\t\n\t\t//create hover element\n\t\tthis.hoverElement = element.cloneNode(true);\n\t\tthis.hoverElement.classList.add(\"tabulator-moving\");\n\t\t\n\t\theaderElement.appendChild(this.hoverElement);\n\t\t\n\t\tthis.hoverElement.style.left = \"0\";\n\t\tthis.hoverElement.style.bottom = (headerElement.clientHeight - headersElement.offsetHeight) + \"px\";\n\t\t\n\t\tif(!this.touchMove){\n\t\t\tthis._bindMouseMove();\n\t\t\t\n\t\t\tdocument.body.addEventListener(\"mousemove\", this.moveHover);\n\t\t\tdocument.body.addEventListener(\"mouseup\", this.endMove);\n\t\t}\n\t\t\n\t\tthis.moveHover(e);\n\n\t\tthis.dispatch(\"column-moving\", e, this.moving);\n\t}\n\t\n\t_bindMouseMove(){\n\t\tthis.table.columnManager.columnsByIndex.forEach(function(column){\n\t\t\tif(column.modules.moveColumn.mousemove){\n\t\t\t\tcolumn.getElement().addEventListener(\"mousemove\", column.modules.moveColumn.mousemove);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t_unbindMouseMove(){\n\t\tthis.table.columnManager.columnsByIndex.forEach(function(column){\n\t\t\tif(column.modules.moveColumn.mousemove){\n\t\t\t\tcolumn.getElement().removeEventListener(\"mousemove\", column.modules.moveColumn.mousemove);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tmoveColumn(column, after){\n\t\tvar movingCells = this.moving.getCells();\n\t\t\n\t\tthis.toCol = column;\n\t\tthis.toColAfter = after;\n\t\t\n\t\tif(after){\n\t\t\tcolumn.getCells().forEach(function(cell, i){\n\t\t\t\tvar cellEl = cell.getElement(true);\n\t\t\t\t\n\t\t\t\tif(cellEl.parentNode && movingCells[i]){\n\t\t\t\t\tcellEl.parentNode.insertBefore(movingCells[i].getElement(), cellEl.nextSibling);\n\t\t\t\t}\n\t\t\t});\n\t\t}else {\n\t\t\tcolumn.getCells().forEach(function(cell, i){\n\t\t\t\tvar cellEl = cell.getElement(true);\n\t\t\t\t\n\t\t\t\tif(cellEl.parentNode && movingCells[i]){\n\t\t\t\t\tcellEl.parentNode.insertBefore(movingCells[i].getElement(), cellEl);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\t\n\tendMove(e){\n\t\tif(e.which === 1 || this.touchMove){\n\t\t\tthis._unbindMouseMove();\n\t\t\t\n\t\t\tthis.placeholderElement.parentNode.insertBefore(this.moving.getElement(), this.placeholderElement.nextSibling);\n\t\t\tthis.placeholderElement.parentNode.removeChild(this.placeholderElement);\n\t\t\tthis.hoverElement.parentNode.removeChild(this.hoverElement);\n\t\t\t\n\t\t\tthis.table.element.classList.remove(\"tabulator-block-select\");\n\t\t\t\n\t\t\tif(this.toCol){\n\t\t\t\tthis.table.columnManager.moveColumnActual(this.moving, this.toCol, this.toColAfter);\n\t\t\t}\n\n\t\t\tthis.moving = false;\n\t\t\tthis.toCol = false;\n\t\t\tthis.toColAfter = false;\n\t\t\t\n\t\t\tif(!this.touchMove){\n\t\t\t\tdocument.body.removeEventListener(\"mousemove\", this.moveHover);\n\t\t\t\tdocument.body.removeEventListener(\"mouseup\", this.endMove);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tmoveHover(e){\n\t\tvar columnHolder = this.table.columnManager.getContentsElement(),\n\t\tscrollLeft = columnHolder.scrollLeft,\n\t\txPos = ((this.touchMove ? e.touches[0].pageX : e.pageX) - Helpers.elOffset(columnHolder).left) + scrollLeft,\n\t\tscrollPos;\n\t\t\n\t\tthis.hoverElement.style.left = (xPos - this.startX) + \"px\";\n\t\t\n\t\tif(xPos - scrollLeft < this.autoScrollMargin){\n\t\t\tif(!this.autoScrollTimeout){\n\t\t\t\tthis.autoScrollTimeout = setTimeout(() => {\n\t\t\t\t\tscrollPos = Math.max(0,scrollLeft-5);\n\t\t\t\t\tthis.table.rowManager.getElement().scrollLeft = scrollPos;\n\t\t\t\t\tthis.autoScrollTimeout = false;\n\t\t\t\t}, 1);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(scrollLeft + columnHolder.clientWidth - xPos < this.autoScrollMargin){\n\t\t\tif(!this.autoScrollTimeout){\n\t\t\t\tthis.autoScrollTimeout = setTimeout(() => {\n\t\t\t\t\tscrollPos = Math.min(columnHolder.clientWidth, scrollLeft+5);\n\t\t\t\t\tthis.table.rowManager.getElement().scrollLeft = scrollPos;\n\t\t\t\t\tthis.autoScrollTimeout = false;\n\t\t\t\t}, 1);\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar defaultSenders = {\r\n\tdelete:function(fromRow, toRow, toTable){\r\n\t\tfromRow.delete();\r\n\t}\r\n};\n\nvar defaultReceivers = {\r\n\tinsert:function(fromRow, toRow, fromTable){\r\n\t\tthis.table.addRow(fromRow.getData(), undefined, toRow);\r\n\t\treturn true;\r\n\t},\r\n\r\n\tadd:function(fromRow, toRow, fromTable){\r\n\t\tthis.table.addRow(fromRow.getData());\r\n\t\treturn true;\r\n\t},\r\n\r\n\tupdate:function(fromRow, toRow, fromTable){\r\n\t\tif(toRow){\r\n\t\t\ttoRow.update(fromRow.getData());\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\r\n\treplace:function(fromRow, toRow, fromTable){\r\n\t\tif(toRow){\r\n\t\t\tthis.table.addRow(fromRow.getData(), undefined, toRow);\r\n\t\t\ttoRow.delete();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n};\n\nclass MoveRows extends Module{\n\n\tstatic moduleName = \"moveRow\";\n\n\t//load defaults\n\tstatic senders = defaultSenders;\n\tstatic receivers = defaultReceivers;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.placeholderElement = this.createPlaceholderElement();\n\t\tthis.hoverElement = false; //floating row header element\n\t\tthis.checkTimeout = false; //click check timeout holder\n\t\tthis.checkPeriod = 150; //period to wait on mousedown to consider this a move and not a click\n\t\tthis.moving = false; //currently moving row\n\t\tthis.toRow = false; //destination row\n\t\tthis.toRowAfter = false; //position of moving row relative to the destination row\n\t\tthis.hasHandle = false; //row has handle instead of fully movable row\n\t\tthis.startY = 0; //starting Y position within header element\n\t\tthis.startX = 0; //starting X position within header element\n\n\t\tthis.moveHover = this.moveHover.bind(this);\n\t\tthis.endMove = this.endMove.bind(this);\n\t\tthis.tableRowDropEvent = false;\n\n\t\tthis.touchMove = false;\n\n\t\tthis.connection = false;\n\t\tthis.connectionSelectorsTables = false;\n\t\tthis.connectionSelectorsElements = false;\n\t\tthis.connectionElements = [];\n\t\tthis.connections = [];\n\n\t\tthis.connectedTable = false;\n\t\tthis.connectedRow = false;\n\n\t\tthis.registerTableOption(\"movableRows\", false); //enable movable rows\n\t\tthis.registerTableOption(\"movableRowsConnectedTables\", false); //tables for movable rows to be connected to\n\t\tthis.registerTableOption(\"movableRowsConnectedElements\", false); //other elements for movable rows to be connected to\n\t\tthis.registerTableOption(\"movableRowsSender\", false);\n\t\tthis.registerTableOption(\"movableRowsReceiver\", \"insert\");\n\n\t\tthis.registerColumnOption(\"rowHandle\");\n\t}\n\n\tcreatePlaceholderElement(){\n\t\tvar el = document.createElement(\"div\");\n\n\t\tel.classList.add(\"tabulator-row\");\n\t\tel.classList.add(\"tabulator-row-placeholder\");\n\n\t\treturn el;\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.movableRows){\n\t\t\tthis.connectionSelectorsTables = this.table.options.movableRowsConnectedTables;\n\t\t\tthis.connectionSelectorsElements = this.table.options.movableRowsConnectedElements;\n\n\t\t\tthis.connection = this.connectionSelectorsTables || this.connectionSelectorsElements;\n\n\t\t\tthis.subscribe(\"cell-init\", this.initializeCell.bind(this));\n\t\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\t\tthis.subscribe(\"row-init\", this.initializeRow.bind(this));\n\t\t}\n\t}\n\n\tinitializeGroupHeader(group){\n\t\tvar self = this,\n\t\tconfig = {};\n\n\t\t//inter table drag drop\n\t\tconfig.mouseup = function(e){\n\t\t\tself.tableRowDrop(e, group);\n\t\t}.bind(self);\n\n\t\t//same table drag drop\n\t\tconfig.mousemove = function(e){\n\t\t\tvar rowEl;\n\n\t\t\tif(((e.pageY - Helpers.elOffset(group.element).top) + self.table.rowManager.element.scrollTop) > (group.getHeight() / 2)){\n\t\t\t\tif(self.toRow !== group || !self.toRowAfter){\n\t\t\t\t\trowEl = group.getElement();\n\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl.nextSibling);\n\t\t\t\t\tself.moveRow(group, true);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(self.toRow !== group || self.toRowAfter){\n\t\t\t\t\trowEl = group.getElement();\n\t\t\t\t\tif(rowEl.previousSibling){\n\t\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl);\n\t\t\t\t\t\tself.moveRow(group, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(self);\n\n\t\tgroup.modules.moveRow = config;\n\t}\n\n\tinitializeRow(row){\n\t\tvar self = this,\n\t\tconfig = {},\n\t\trowEl;\n\n\t\t//inter table drag drop\n\t\tconfig.mouseup = function(e){\n\t\t\tself.tableRowDrop(e, row);\n\t\t}.bind(self);\n\n\t\t//same table drag drop\n\t\tconfig.mousemove = function(e){\n\t\t\tvar rowEl = row.getElement();\n\n\t\t\tif(((e.pageY - Helpers.elOffset(rowEl).top) + self.table.rowManager.element.scrollTop) > (row.getHeight() / 2)){\n\t\t\t\tif(self.toRow !== row || !self.toRowAfter){\n\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl.nextSibling);\n\t\t\t\t\tself.moveRow(row, true);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(self.toRow !== row || self.toRowAfter){\n\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl);\n\t\t\t\t\tself.moveRow(row, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(self);\n\n\n\t\tif(!this.hasHandle){\n\n\t\t\trowEl = row.getElement();\n\n\t\t\trowEl.addEventListener(\"mousedown\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tself.checkTimeout = setTimeout(function(){\n\t\t\t\t\t\tself.startMove(e, row);\n\t\t\t\t\t}, self.checkPeriod);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\trowEl.addEventListener(\"mouseup\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tif(self.checkTimeout){\n\t\t\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bindTouchEvents(row, row.getElement());\n\t\t}\n\n\t\trow.modules.moveRow = config;\n\t}\n\n\tinitializeColumn(column){\n\t\tif(column.definition.rowHandle && this.table.options.movableRows !== false){\n\t\t\tthis.hasHandle = true;\n\t\t}\n\t}\n\n\tinitializeCell(cell){\n\t\tif(cell.column.definition.rowHandle && this.table.options.movableRows !== false){\n\t\t\tvar self = this,\n\t\t\tcellEl = cell.getElement(true);\n\n\t\t\tcellEl.addEventListener(\"mousedown\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tself.checkTimeout = setTimeout(function(){\n\t\t\t\t\t\tself.startMove(e, cell.row);\n\t\t\t\t\t}, self.checkPeriod);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tcellEl.addEventListener(\"mouseup\", function(e){\n\t\t\t\tif(e.which === 1){\n\t\t\t\t\tif(self.checkTimeout){\n\t\t\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bindTouchEvents(cell.row, cellEl);\n\t\t}\n\t}\n\n\tbindTouchEvents(row, element){\n\t\tvar startYMove = false, //shifting center position of the cell\n\t\tnextRow, prevRow, nextRowHeight, prevRowHeight, nextRowHeightLast, prevRowHeightLast;\n\n\t\telement.addEventListener(\"touchstart\", (e) => {\n\t\t\tthis.checkTimeout = setTimeout(() => {\n\t\t\t\tthis.touchMove = true;\n\t\t\t\tnextRow = row.nextRow();\n\t\t\t\tnextRowHeight = nextRow ? nextRow.getHeight()/2 : 0;\n\t\t\t\tprevRow = row.prevRow();\n\t\t\t\tprevRowHeight = prevRow ? prevRow.getHeight()/2 : 0;\n\t\t\t\tnextRowHeightLast = 0;\n\t\t\t\tprevRowHeightLast = 0;\n\t\t\t\tstartYMove = false;\n\n\t\t\t\tthis.startMove(e, row);\n\t\t\t}, this.checkPeriod);\n\t\t}, {passive: true});\n\t\tthis.moving, this.toRow, this.toRowAfter;\n\t\telement.addEventListener(\"touchmove\", (e) => {\n\n\t\t\tvar diff, moveToRow;\n\n\t\t\tif(this.moving){\n\t\t\t\te.preventDefault();\n\n\t\t\t\tthis.moveHover(e);\n\n\t\t\t\tif(!startYMove){\n\t\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t\t}\n\n\t\t\t\tdiff = e.touches[0].pageY - startYMove;\n\n\t\t\t\tif(diff > 0){\n\t\t\t\t\tif(nextRow && diff - nextRowHeightLast > nextRowHeight){\n\t\t\t\t\t\tmoveToRow = nextRow;\n\n\t\t\t\t\t\tif(moveToRow !== row){\n\t\t\t\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t\t\t\t\tmoveToRow.getElement().parentNode.insertBefore(this.placeholderElement, moveToRow.getElement().nextSibling);\n\t\t\t\t\t\t\tthis.moveRow(moveToRow, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tif(prevRow && -diff - prevRowHeightLast >  prevRowHeight){\n\t\t\t\t\t\tmoveToRow = prevRow;\n\n\t\t\t\t\t\tif(moveToRow !== row){\n\t\t\t\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t\t\t\t\tmoveToRow.getElement().parentNode.insertBefore(this.placeholderElement, moveToRow.getElement());\n\t\t\t\t\t\t\tthis.moveRow(moveToRow, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(moveToRow){\n\t\t\t\t\tnextRow = moveToRow.nextRow();\n\t\t\t\t\tnextRowHeightLast = nextRowHeight;\n\t\t\t\t\tnextRowHeight = nextRow ? nextRow.getHeight() / 2 : 0;\n\t\t\t\t\tprevRow = moveToRow.prevRow();\n\t\t\t\t\tprevRowHeightLast = prevRowHeight;\n\t\t\t\t\tprevRowHeight = prevRow ? prevRow.getHeight() / 2 : 0;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener(\"touchend\", (e) => {\n\t\t\tif(this.checkTimeout){\n\t\t\t\tclearTimeout(this.checkTimeout);\n\t\t\t}\n\t\t\tif(this.moving){\n\t\t\t\tthis.endMove(e);\n\t\t\t\tthis.touchMove = false;\n\t\t\t}\n\t\t});\n\t}\n\n\t_bindMouseMove(){\n\t\tthis.table.rowManager.getDisplayRows().forEach((row) => {\n\t\t\tif((row.type === \"row\" || row.type === \"group\") && row.modules.moveRow && row.modules.moveRow.mousemove){\n\t\t\t\trow.getElement().addEventListener(\"mousemove\", row.modules.moveRow.mousemove);\n\t\t\t}\n\t\t});\n\t}\n\n\t_unbindMouseMove(){\n\t\tthis.table.rowManager.getDisplayRows().forEach((row) => {\n\t\t\tif((row.type === \"row\" || row.type === \"group\") && row.modules.moveRow && row.modules.moveRow.mousemove){\n\t\t\t\trow.getElement().removeEventListener(\"mousemove\", row.modules.moveRow.mousemove);\n\t\t\t}\n\t\t});\n\t}\n\n\tstartMove(e, row){\n\t\tvar element = row.getElement();\n\n\t\tthis.setStartPosition(e, row);\n\n\t\tthis.moving = row;\n\n\t\tthis.table.element.classList.add(\"tabulator-block-select\");\n\n\t\t//create placeholder\n\t\tthis.placeholderElement.style.width = row.getWidth() + \"px\";\n\t\tthis.placeholderElement.style.height = row.getHeight() + \"px\";\n\n\t\tif(!this.connection){\n\t\t\telement.parentNode.insertBefore(this.placeholderElement, element);\n\t\t\telement.parentNode.removeChild(element);\n\t\t}else {\n\t\t\tthis.table.element.classList.add(\"tabulator-movingrow-sending\");\n\t\t\tthis.connectToTables(row);\n\t\t}\n\n\t\t//create hover element\n\t\tthis.hoverElement = element.cloneNode(true);\n\t\tthis.hoverElement.classList.add(\"tabulator-moving\");\n\n\t\tif(this.connection){\n\t\t\tdocument.body.appendChild(this.hoverElement);\n\t\t\tthis.hoverElement.style.left = \"0\";\n\t\t\tthis.hoverElement.style.top = \"0\";\n\t\t\tthis.hoverElement.style.width = this.table.element.clientWidth + \"px\";\n\t\t\tthis.hoverElement.style.whiteSpace = \"nowrap\";\n\t\t\tthis.hoverElement.style.overflow = \"hidden\";\n\t\t\tthis.hoverElement.style.pointerEvents = \"none\";\n\t\t}else {\n\t\t\tthis.table.rowManager.getTableElement().appendChild(this.hoverElement);\n\n\t\t\tthis.hoverElement.style.left = \"0\";\n\t\t\tthis.hoverElement.style.top = \"0\";\n\n\t\t\tthis._bindMouseMove();\n\t\t}\n\n\t\tdocument.body.addEventListener(\"mousemove\", this.moveHover);\n\t\tdocument.body.addEventListener(\"mouseup\", this.endMove);\n\n\t\tthis.dispatchExternal(\"rowMoving\", row.getComponent());\n\n\t\tthis.moveHover(e);\n\t}\n\n\tsetStartPosition(e, row){\n\t\tvar pageX = this.touchMove ? e.touches[0].pageX : e.pageX,\n\t\tpageY = this.touchMove ? e.touches[0].pageY : e.pageY,\n\t\telement, position;\n\n\t\telement = row.getElement();\n\t\tif(this.connection){\n\t\t\tposition = element.getBoundingClientRect();\n\n\t\t\tthis.startX = position.left - pageX + window.pageXOffset;\n\t\t\tthis.startY = position.top - pageY + window.pageYOffset;\n\t\t}else {\n\t\t\tthis.startY = (pageY - element.getBoundingClientRect().top);\n\t\t}\n\t}\n\n\tendMove(e){\n\t\tif(!e || e.which === 1 || this.touchMove){\n\t\t\tthis._unbindMouseMove();\n\n\t\t\tif(!this.connection){\n\t\t\t\tthis.placeholderElement.parentNode.insertBefore(this.moving.getElement(), this.placeholderElement.nextSibling);\n\t\t\t\tthis.placeholderElement.parentNode.removeChild(this.placeholderElement);\n\t\t\t}\n\n\t\t\tthis.hoverElement.parentNode.removeChild(this.hoverElement);\n\n\t\t\tthis.table.element.classList.remove(\"tabulator-block-select\");\n\n\t\t\tif(this.toRow){\n\t\t\t\tthis.table.rowManager.moveRow(this.moving, this.toRow, this.toRowAfter);\n\t\t\t}else {\n\t\t\t\tthis.dispatchExternal(\"rowMoveCancelled\", this.moving.getComponent());\n\t\t\t}\n\n\t\t\tthis.moving = false;\n\t\t\tthis.toRow = false;\n\t\t\tthis.toRowAfter = false;\n\n\t\t\tdocument.body.removeEventListener(\"mousemove\", this.moveHover);\n\t\t\tdocument.body.removeEventListener(\"mouseup\", this.endMove);\n\n\t\t\tif(this.connection){\n\t\t\t\tthis.table.element.classList.remove(\"tabulator-movingrow-sending\");\n\t\t\t\tthis.disconnectFromTables();\n\t\t\t}\n\t\t}\n\t}\n\n\tmoveRow(row, after){\n\t\tthis.toRow = row;\n\t\tthis.toRowAfter = after;\n\t}\n\n\tmoveHover(e){\n\t\tif(this.connection){\n\t\t\tthis.moveHoverConnections.call(this, e);\n\t\t}else {\n\t\t\tthis.moveHoverTable.call(this, e);\n\t\t}\n\t}\n\n\tmoveHoverTable(e){\n\t\tvar rowHolder = this.table.rowManager.getElement(),\n\t\tscrollTop = rowHolder.scrollTop,\n\t\tyPos = ((this.touchMove ? e.touches[0].pageY : e.pageY) - rowHolder.getBoundingClientRect().top) + scrollTop;\n\t\t\n\t\tthis.hoverElement.style.top = Math.min(yPos - this.startY, this.table.rowManager.element.scrollHeight - this.hoverElement.offsetHeight) + \"px\";\n\t}\n\n\tmoveHoverConnections(e){\n\t\tthis.hoverElement.style.left = (this.startX + (this.touchMove ? e.touches[0].pageX : e.pageX)) + \"px\";\n\t\tthis.hoverElement.style.top = (this.startY + (this.touchMove ? e.touches[0].pageY : e.pageY)) + \"px\";\n\t}\n\n\telementRowDrop(e, element, row){\n\t\tthis.dispatchExternal(\"movableRowsElementDrop\", e, element, row ? row.getComponent() : false);\n\t}\n\n\t//establish connection with other tables\n\tconnectToTables(row){\n\t\tvar connectionTables;\n\n\t\tif(this.connectionSelectorsTables){\n\t\t\tconnectionTables = this.commsConnections(this.connectionSelectorsTables);\n\n\t\t\tthis.dispatchExternal(\"movableRowsSendingStart\", connectionTables);\n\n\t\t\tthis.commsSend(this.connectionSelectorsTables, \"moveRow\", \"connect\", {\n\t\t\t\trow:row,\n\t\t\t});\n\t\t}\n\n\t\tif(this.connectionSelectorsElements){\n\n\t\t\tthis.connectionElements = [];\n\n\t\t\tif(!Array.isArray(this.connectionSelectorsElements)){\n\t\t\t\tthis.connectionSelectorsElements = [this.connectionSelectorsElements];\n\t\t\t}\n\n\t\t\tthis.connectionSelectorsElements.forEach((query) => {\n\t\t\t\tif(typeof query === \"string\"){\n\t\t\t\t\tthis.connectionElements = this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(query)));\n\t\t\t\t}else {\n\t\t\t\t\tthis.connectionElements.push(query);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.connectionElements.forEach((element) => {\n\t\t\t\tvar dropEvent = (e) => {\n\t\t\t\t\tthis.elementRowDrop(e, element, this.moving);\n\t\t\t\t};\n\n\t\t\t\telement.addEventListener(\"mouseup\", dropEvent);\n\t\t\t\telement.tabulatorElementDropEvent = dropEvent;\n\n\t\t\t\telement.classList.add(\"tabulator-movingrow-receiving\");\n\t\t\t});\n\t\t}\n\t}\n\n\t//disconnect from other tables\n\tdisconnectFromTables(){\n\t\tvar connectionTables;\n\n\t\tif(this.connectionSelectorsTables){\n\t\t\tconnectionTables = this.commsConnections(this.connectionSelectorsTables);\n\n\t\t\tthis.dispatchExternal(\"movableRowsSendingStop\", connectionTables);\n\n\t\t\tthis.commsSend(this.connectionSelectorsTables, \"moveRow\", \"disconnect\");\n\t\t}\n\n\t\tthis.connectionElements.forEach((element) => {\n\t\t\telement.classList.remove(\"tabulator-movingrow-receiving\");\n\t\t\telement.removeEventListener(\"mouseup\", element.tabulatorElementDropEvent);\n\t\t\tdelete element.tabulatorElementDropEvent;\n\t\t});\n\t}\n\n\t//accept incomming connection\n\tconnect(table, row){\n\t\tif(!this.connectedTable){\n\t\t\tthis.connectedTable = table;\n\t\t\tthis.connectedRow = row;\n\n\t\t\tthis.table.element.classList.add(\"tabulator-movingrow-receiving\");\n\n\t\t\tthis.table.rowManager.getDisplayRows().forEach((row) => {\n\t\t\t\tif(row.type === \"row\" && row.modules.moveRow && row.modules.moveRow.mouseup){\n\t\t\t\t\trow.getElement().addEventListener(\"mouseup\", row.modules.moveRow.mouseup);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.tableRowDropEvent = this.tableRowDrop.bind(this);\n\n\t\t\tthis.table.element.addEventListener(\"mouseup\", this.tableRowDropEvent);\n\n\t\t\tthis.dispatchExternal(\"movableRowsReceivingStart\", row, table);\n\n\t\t\treturn true;\n\t\t}else {\n\t\t\tconsole.warn(\"Move Row Error - Table cannot accept connection, already connected to table:\", this.connectedTable);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//close incoming connection\n\tdisconnect(table){\n\t\tif(table === this.connectedTable){\n\t\t\tthis.connectedTable = false;\n\t\t\tthis.connectedRow = false;\n\n\t\t\tthis.table.element.classList.remove(\"tabulator-movingrow-receiving\");\n\n\t\t\tthis.table.rowManager.getDisplayRows().forEach((row) =>{\n\t\t\t\tif(row.type === \"row\" && row.modules.moveRow && row.modules.moveRow.mouseup){\n\t\t\t\t\trow.getElement().removeEventListener(\"mouseup\", row.modules.moveRow.mouseup);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.table.element.removeEventListener(\"mouseup\", this.tableRowDropEvent);\n\n\t\t\tthis.dispatchExternal(\"movableRowsReceivingStop\", table);\n\t\t}else {\n\t\t\tconsole.warn(\"Move Row Error - trying to disconnect from non connected table\");\n\t\t}\n\t}\n\n\tdropComplete(table, row, success){\n\t\tvar sender = false;\n\n\t\tif(success){\n\n\t\t\tswitch(typeof this.table.options.movableRowsSender){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tsender = MoveRows.senders[this.table.options.movableRowsSender];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\tsender = this.table.options.movableRowsSender;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif(sender){\n\t\t\t\tsender.call(this, this.moving ? this.moving.getComponent() : undefined, row ? row.getComponent() : undefined, table);\n\t\t\t}else {\n\t\t\t\tif(this.table.options.movableRowsSender){\n\t\t\t\t\tconsole.warn(\"Mover Row Error - no matching sender found:\", this.table.options.movableRowsSender);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.dispatchExternal(\"movableRowsSent\", this.moving.getComponent(), row ? row.getComponent() : undefined, table);\n\t\t}else {\n\t\t\tthis.dispatchExternal(\"movableRowsSentFailed\", this.moving.getComponent(), row ? row.getComponent() : undefined, table);\n\t\t}\n\n\t\tthis.endMove();\n\t}\n\n\ttableRowDrop(e, row){\n\t\tvar receiver = false,\n\t\tsuccess = false;\n\n\t\te.stopImmediatePropagation();\n\n\t\tswitch(typeof this.table.options.movableRowsReceiver){\n\t\t\tcase \"string\":\n\t\t\t\treceiver = MoveRows.receivers[this.table.options.movableRowsReceiver];\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\treceiver = this.table.options.movableRowsReceiver;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif(receiver){\n\t\t\tsuccess = receiver.call(this, this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t\t}else {\n\t\t\tconsole.warn(\"Mover Row Error - no matching receiver found:\", this.table.options.movableRowsReceiver);\n\t\t}\n\n\t\tif(success){\n\t\t\tthis.dispatchExternal(\"movableRowsReceived\", this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t\t}else {\n\t\t\tthis.dispatchExternal(\"movableRowsReceivedFailed\", this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t\t}\n\n\t\tthis.commsSend(this.connectedTable, \"moveRow\", \"dropcomplete\", {\n\t\t\trow:row,\n\t\t\tsuccess:success,\n\t\t});\n\t}\n\n\tcommsReceived(table, action, data){\n\t\tswitch(action){\n\t\t\tcase \"connect\":\n\t\t\t\treturn this.connect(table, data.row);\n\n\t\t\tcase \"disconnect\":\n\t\t\t\treturn this.disconnect(table);\n\n\t\t\tcase \"dropcomplete\":\n\t\t\t\treturn this.dropComplete(table, data.row, data.success);\n\t\t}\n\t}\n}\n\nvar defaultMutators = {};\n\nclass Mutator extends Module{\n\n\tstatic moduleName = \"mutator\";\n\n\t//load defaults\n\tstatic mutators = defaultMutators;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.allowedTypes = [\"\", \"data\", \"edit\", \"clipboard\", \"import\"]; //list of mutation types\n\t\tthis.enabled = true;\n\n\t\tthis.registerColumnOption(\"mutator\");\n\t\tthis.registerColumnOption(\"mutatorParams\");\n\t\tthis.registerColumnOption(\"mutatorData\");\n\t\tthis.registerColumnOption(\"mutatorDataParams\");\n\t\tthis.registerColumnOption(\"mutatorEdit\");\n\t\tthis.registerColumnOption(\"mutatorEditParams\");\n\t\tthis.registerColumnOption(\"mutatorClipboard\");\n\t\tthis.registerColumnOption(\"mutatorClipboardParams\");\n\t\tthis.registerColumnOption(\"mutatorImport\");\n\t\tthis.registerColumnOption(\"mutatorImportParams\");\n\t\tthis.registerColumnOption(\"mutateLink\");\n\t}\n\n\tinitialize(){\n\t\tthis.subscribe(\"cell-value-changing\", this.transformCell.bind(this));\n\t\tthis.subscribe(\"cell-value-changed\", this.mutateLink.bind(this));\n\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"row-data-init-before\", this.rowDataChanged.bind(this));\n\t\tthis.subscribe(\"row-data-changing\", this.rowDataChanged.bind(this));\n\t}\n\n\trowDataChanged(row, tempData, updatedData){\n\t\treturn this.transformRow(tempData, \"data\", updatedData);\n\t}\n\n\t//initialize column mutator\n\tinitializeColumn(column){\n\t\tvar match = false,\n\t\tconfig = {};\n\n\t\tthis.allowedTypes.forEach((type) => {\n\t\t\tvar key = \"mutator\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\t\tmutator;\n\n\t\t\tif(column.definition[key]){\n\t\t\t\tmutator = this.lookupMutator(column.definition[key]);\n\n\t\t\t\tif(mutator){\n\t\t\t\t\tmatch = true;\n\n\t\t\t\t\tconfig[key] = {\n\t\t\t\t\t\tmutator:mutator,\n\t\t\t\t\t\tparams: column.definition[key + \"Params\"] || {},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(match){\n\t\t\tcolumn.modules.mutate = config;\n\t\t}\n\t}\n\n\tlookupMutator(value){\n\t\tvar mutator = false;\n\n\t\t//set column mutator\n\t\tswitch(typeof value){\n\t\t\tcase \"string\":\n\t\t\t\tif(Mutator.mutators[value]){\n\t\t\t\t\tmutator = Mutator.mutators[value];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Mutator Error - No such mutator found, ignoring: \", value);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tmutator = value;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn mutator;\n\t}\n\n\t//apply mutator to row\n\ttransformRow(data, type, updatedData){\n\t\tvar key = \"mutator\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\tvalue;\n\n\t\t// console.log(\"key\", key)\n\n\t\tif(this.enabled){\n\n\t\t\tthis.table.columnManager.traverse((column) => {\n\t\t\t\tvar mutator, params, component;\n\n\t\t\t\tif(column.modules.mutate){\n\t\t\t\t\tmutator = column.modules.mutate[key] || column.modules.mutate.mutator || false;\n\n\t\t\t\t\tif(mutator){\n\t\t\t\t\t\tvalue = column.getFieldValue(typeof updatedData !== \"undefined\" ? updatedData : data);\n\n\t\t\t\t\t\tif((type == \"data\" && !updatedData)|| typeof value !== \"undefined\"){\n\t\t\t\t\t\t\tcomponent = column.getComponent();\n\t\t\t\t\t\t\tparams = typeof mutator.params === \"function\" ? mutator.params(value, data, type, component) : mutator.params;\n\t\t\t\t\t\t\tcolumn.setFieldValue(data, mutator.mutator(value, data, type, params, component));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn data;\n\t}\n\n\t//apply mutator to new cell value\n\ttransformCell(cell, value){\n\t\tif(cell.column.modules.mutate){\n\t\t\tvar mutator = cell.column.modules.mutate.mutatorEdit || cell.column.modules.mutate.mutator || false,\n\t\t\ttempData = {};\n\n\t\t\tif(mutator){\n\t\t\t\ttempData = Object.assign(tempData, cell.row.getData());\n\t\t\t\tcell.column.setFieldValue(tempData, value);\n\t\t\t\treturn mutator.mutator(value, tempData, \"edit\", mutator.params, cell.getComponent());\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tmutateLink(cell){\n\t\tvar links = cell.column.definition.mutateLink;\n\n\t\tif(links){\n\t\t\tif(!Array.isArray(links)){\n\t\t\t\tlinks = [links];\n\t\t\t}\n\n\t\t\tlinks.forEach((link) => {\n\t\t\t\tvar linkCell = cell.row.getCell(link);\n\n\t\t\t\tif(linkCell){\n\t\t\t\t\tlinkCell.setValue(linkCell.getValue(), true, true);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tenable(){\n\t\tthis.enabled = true;\n\t}\n\n\tdisable(){\n\t\tthis.enabled = false;\n\t}\n}\n\nfunction rows(pageSize, currentRow, currentPage, totalRows, totalPages){\n\tvar el = document.createElement(\"span\"),\n\tshowingEl = document.createElement(\"span\"),\n\tvalueEl = document.createElement(\"span\"),\n\tofEl = document.createElement(\"span\"),\n\ttotalEl = document.createElement(\"span\"),\n\trowsEl = document.createElement(\"span\");\n\n\tthis.table.modules.localize.langBind(\"pagination|counter|showing\", (value) => {\n\t\tshowingEl.innerHTML = value;\n\t});\n\n\tthis.table.modules.localize.langBind(\"pagination|counter|of\", (value) => {\n\t\tofEl.innerHTML = value;\n\t});\n\n\tthis.table.modules.localize.langBind(\"pagination|counter|rows\", (value) => {\n\t\trowsEl.innerHTML = value;\n\t});\n\n\tif(totalRows){\n\t\tvalueEl.innerHTML = \" \" + currentRow + \"-\" + Math.min((currentRow + pageSize - 1), totalRows) + \" \";\n\t\t\n\t\ttotalEl.innerHTML = \" \" + totalRows + \" \";\n\t\t\n\t\tel.appendChild(showingEl);\n\t\tel.appendChild(valueEl);\n\t\tel.appendChild(ofEl);\n\t\tel.appendChild(totalEl);\n\t\tel.appendChild(rowsEl);\n\t}else {\n\t\tvalueEl.innerHTML = \" 0 \";\n\n\t\tel.appendChild(showingEl);\n\t\tel.appendChild(valueEl);\n\t\tel.appendChild(rowsEl);\n\t}\n\t\n\treturn el;\n}\n\nfunction pages(pageSize, currentRow, currentPage, totalRows, totalPages){\n\n\tvar el = document.createElement(\"span\"),\n\tshowingEl = document.createElement(\"span\"),\n\tvalueEl = document.createElement(\"span\"),\n\tofEl = document.createElement(\"span\"),\n\ttotalEl = document.createElement(\"span\"),\n\trowsEl = document.createElement(\"span\");\n\t\n\tthis.table.modules.localize.langBind(\"pagination|counter|showing\", (value) => {\n\t\tshowingEl.innerHTML = value;\n\t});\n\t\n\tvalueEl.innerHTML = \" \" + currentPage + \" \";\n\t\n\tthis.table.modules.localize.langBind(\"pagination|counter|of\", (value) => {\n\t\tofEl.innerHTML = value;\n\t});\n\t\n\ttotalEl.innerHTML = \" \" + totalPages + \" \";\n\t\n\tthis.table.modules.localize.langBind(\"pagination|counter|pages\", (value) => {\n\t\trowsEl.innerHTML = value;\n\t});\n\t\n\tel.appendChild(showingEl);\n\tel.appendChild(valueEl);\n\tel.appendChild(ofEl);\n\tel.appendChild(totalEl);\n\tel.appendChild(rowsEl);\n\t\n\treturn el;\n}\n\nvar defaultPageCounters = {\n\trows:rows,\n\tpages:pages,\n};\n\nclass Page extends Module{\n\n\tstatic moduleName = \"page\";\n\n\t//load defaults\n\tstatic pageCounters = defaultPageCounters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.mode = \"local\";\n\t\tthis.progressiveLoad = false;\n\t\t\n\t\tthis.element = null;\n\t\tthis.pageCounterElement = null;\n\t\tthis.pageCounter = null;\n\t\t\n\t\tthis.size = 0;\n\t\tthis.page = 1;\n\t\tthis.count = 5;\n\t\tthis.max = 1;\n\n\t\tthis.remoteRowCountEstimate = null;\n\t\t\n\t\tthis.initialLoad = true;\n\t\tthis.dataChanging = false; //flag to check if data is being changed by this module\n\t\t\n\t\tthis.pageSizes = [];\n\t\t\n\t\tthis.registerTableOption(\"pagination\", false); //set pagination type\n\t\tthis.registerTableOption(\"paginationMode\", \"local\"); //local or remote pagination\n\t\tthis.registerTableOption(\"paginationSize\", false); //set number of rows to a page\n\t\tthis.registerTableOption(\"paginationInitialPage\", 1); //initial page to show on load\n\t\tthis.registerTableOption(\"paginationCounter\", false);  // set pagination counter\n\t\tthis.registerTableOption(\"paginationCounterElement\", false);  // set pagination counter\n\t\tthis.registerTableOption(\"paginationButtonCount\", 5);  // set count of page button\n\t\tthis.registerTableOption(\"paginationSizeSelector\", false); //add pagination size selector element\n\t\tthis.registerTableOption(\"paginationElement\", false); //element to hold pagination numbers\n\t\t// this.registerTableOption(\"paginationDataSent\", {}); //pagination data sent to the server\n\t\t// this.registerTableOption(\"paginationDataReceived\", {}); //pagination data received from the server\n\t\tthis.registerTableOption(\"paginationAddRow\", \"page\"); //add rows on table or page\n\t\tthis.registerTableOption(\"paginationOutOfRange\", false); //reset the current page when the last page < this.page, values: false|function|any value accepted by setPage()\n\t\t\n\t\tthis.registerTableOption(\"progressiveLoad\", false); //progressive loading\n\t\tthis.registerTableOption(\"progressiveLoadDelay\", 0); //delay between requests\n\t\tthis.registerTableOption(\"progressiveLoadScrollMargin\", 0); //margin before scroll begins\n\t\t\n\t\tthis.registerTableFunction(\"setMaxPage\", this.setMaxPage.bind(this));\n\t\tthis.registerTableFunction(\"setPage\", this.setPage.bind(this));\n\t\tthis.registerTableFunction(\"setPageToRow\", this.userSetPageToRow.bind(this));\n\t\tthis.registerTableFunction(\"setPageSize\", this.userSetPageSize.bind(this));\n\t\tthis.registerTableFunction(\"getPageSize\", this.getPageSize.bind(this));\n\t\tthis.registerTableFunction(\"previousPage\", this.previousPage.bind(this));\n\t\tthis.registerTableFunction(\"nextPage\", this.nextPage.bind(this));\n\t\tthis.registerTableFunction(\"getPage\", this.getPage.bind(this));\n\t\tthis.registerTableFunction(\"getPageMax\", this.getPageMax.bind(this));\n\t\t\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"pageTo\", this.setPageToRow.bind(this));\n\t}\n\t\n\tinitialize(){\n\t\tif(this.table.options.pagination){\n\t\t\tthis.subscribe(\"row-deleted\", this.rowsUpdated.bind(this));\n\t\t\tthis.subscribe(\"row-added\", this.rowsUpdated.bind(this));\n\t\t\tthis.subscribe(\"data-processed\", this.initialLoadComplete.bind(this));\n\t\t\tthis.subscribe(\"table-built\", this.calculatePageSizes.bind(this));\n\t\t\tthis.subscribe(\"footer-redraw\", this.footerRedraw.bind(this));\n\n\t\t\tif(this.table.options.paginationAddRow == \"page\"){\n\t\t\t\tthis.subscribe(\"row-adding-position\", this.rowAddingPosition.bind(this));\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.options.paginationMode === \"remote\"){\n\t\t\t\tthis.subscribe(\"data-params\", this.remotePageParams.bind(this));\n\t\t\t\tthis.subscribe(\"data-loaded\", this._parseRemoteData.bind(this));\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.options.progressiveLoad){\n\t\t\t\tconsole.error(\"Progressive Load Error - Pagination and progressive load cannot be used at the same time\");\n\t\t\t}\n\t\t\t\n\t\t\tthis.registerDisplayHandler(this.restOnRenderBefore.bind(this), 40);\n\t\t\tthis.registerDisplayHandler(this.getRows.bind(this), 50);\n\t\t\t\n\t\t\tthis.createElements();\n\t\t\tthis.initializePageCounter();\n\t\t\tthis.initializePaginator();\n\t\t}else if(this.table.options.progressiveLoad){\n\t\t\tthis.subscribe(\"data-params\", this.remotePageParams.bind(this));\n\t\t\tthis.subscribe(\"data-loaded\", this._parseRemoteData.bind(this));\n\t\t\tthis.subscribe(\"table-built\", this.calculatePageSizes.bind(this));\n\t\t\tthis.subscribe(\"data-processed\", this.initialLoadComplete.bind(this));\n\t\t\t\n\t\t\tthis.initializeProgressive(this.table.options.progressiveLoad);\n\t\t\t\n\t\t\tif(this.table.options.progressiveLoad === \"scroll\"){\n\t\t\t\tthis.subscribe(\"scroll-vertical\", this.scrollVertical.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\t\n\trowAddingPosition(row, top){\n\t\tvar rowManager = this.table.rowManager,\n\t\tdisplayRows = rowManager.getDisplayRows(),\n\t\tindex;\n\t\t\n\t\tif(top){\n\t\t\tif(displayRows.length){\n\t\t\t\tindex = displayRows[0];\n\t\t\t}else {\n\t\t\t\tif(rowManager.activeRows.length){\n\t\t\t\t\tindex = rowManager.activeRows[rowManager.activeRows.length-1];\n\t\t\t\t\ttop = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tif(displayRows.length){\n\t\t\t\tindex = displayRows[displayRows.length - 1];\n\t\t\t\ttop = displayRows.length < this.size ? false : true;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn {index, top};\n\t}\n\t\n\tcalculatePageSizes(){\n\t\tvar testElRow, testElCell;\n\t\t\n\t\tif(this.table.options.paginationSize){\n\t\t\tthis.size = this.table.options.paginationSize;\n\t\t}else {\n\t\t\ttestElRow = document.createElement(\"div\");\n\t\t\ttestElRow.classList.add(\"tabulator-row\");\n\t\t\ttestElRow.style.visibility = \"hidden\";\n\t\t\t\n\t\t\ttestElCell = document.createElement(\"div\");\n\t\t\ttestElCell.classList.add(\"tabulator-cell\");\n\t\t\ttestElCell.innerHTML = \"Page Row Test\";\n\t\t\t\n\t\t\ttestElRow.appendChild(testElCell);\n\t\t\t\n\t\t\tthis.table.rowManager.getTableElement().appendChild(testElRow);\n\t\t\t\n\t\t\tthis.size = Math.floor(this.table.rowManager.getElement().clientHeight / testElRow.offsetHeight);\n\t\t\t\n\t\t\tthis.table.rowManager.getTableElement().removeChild(testElRow);\n\t\t}\n\n\t\tthis.dispatchExternal(\"pageSizeChanged\", this.size);\n\t\t\n\t\tthis.generatePageSizeSelectList();\n\t}\n\t\n\tinitialLoadComplete(){\n\t\tthis.initialLoad = false;\n\t}\n\t\n\tremotePageParams(data, config, silent, params){\n\t\tif(!this.initialLoad){\n\t\t\tif((this.progressiveLoad && !silent) || (!this.progressiveLoad && !this.dataChanging)){\n\t\t\t\tthis.reset(true);\n\t\t\t}\n\t\t}\n\t\t\n\t\t//configure request params\n\t\tparams.page = this.page;\n\t\t\n\t\t//set page size if defined\n\t\tif(this.size){\n\t\t\tparams.size = this.size;\n\t\t}\n\t\t\n\t\treturn params;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\t\n\tuserSetPageToRow(row){\n\t\tif(this.table.options.pagination){\n\t\t\trow = this.table.rowManager.findRow(row);\n\t\t\t\n\t\t\tif(row){\n\t\t\t\treturn this.setPageToRow(row);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn Promise.reject();\n\t}\n\t\n\tuserSetPageSize(size){\n\t\tif(this.table.options.pagination){\n\t\t\tthis.setPageSize(size);\n\t\t\treturn this.setPage(1);\n\t\t}else {\n\t\t\treturn false;\n\t\t}\n\t}\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tscrollVertical(top, dir){\n\t\tvar element, diff, margin;\n\t\tif(!dir && !this.table.dataLoader.loading){\n\t\t\telement = this.table.rowManager.getElement();\n\t\t\tdiff = element.scrollHeight - element.clientHeight - top;\n\t\t\tmargin = this.table.options.progressiveLoadScrollMargin || (element.clientHeight * 2);\n\t\t\t\n\t\t\tif(diff < margin){\n\t\t\t\tthis.nextPage()\n\t\t\t\t\t.catch(() => {}); //consume the exception thrown when on the last page\n\t\t\t}\n\t\t}\n\t}\n\t\n\trestOnRenderBefore(rows, renderInPosition){\n\t\tif(!renderInPosition){\n\t\t\tif(this.mode === \"local\"){\n\t\t\t\tthis.reset();\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn rows;\n\t}\n\t\n\trowsUpdated(){\n\t\tthis.refreshData(true, \"all\");\n\t}\n\t\n\tcreateElements(){\n\t\tvar button;\n\t\t\n\t\tthis.element = document.createElement(\"span\");\n\t\tthis.element.classList.add(\"tabulator-paginator\");\n\t\t\n\t\tthis.pagesElement = document.createElement(\"span\");\n\t\tthis.pagesElement.classList.add(\"tabulator-pages\");\n\t\t\n\t\tbutton = document.createElement(\"button\");\n\t\tbutton.classList.add(\"tabulator-page\");\n\t\tbutton.setAttribute(\"type\", \"button\");\n\t\tbutton.setAttribute(\"role\", \"button\");\n\t\tbutton.setAttribute(\"aria-label\", \"\");\n\t\tbutton.setAttribute(\"title\", \"\");\n\t\t\n\t\tthis.firstBut = button.cloneNode(true);\n\t\tthis.firstBut.setAttribute(\"data-page\", \"first\");\n\t\t\n\t\tthis.prevBut = button.cloneNode(true);\n\t\tthis.prevBut.setAttribute(\"data-page\", \"prev\");\n\t\t\n\t\tthis.nextBut = button.cloneNode(true);\n\t\tthis.nextBut.setAttribute(\"data-page\", \"next\");\n\t\t\n\t\tthis.lastBut = button.cloneNode(true);\n\t\tthis.lastBut.setAttribute(\"data-page\", \"last\");\n\t\t\n\t\tif(this.table.options.paginationSizeSelector){\n\t\t\tthis.pageSizeSelect = document.createElement(\"select\");\n\t\t\tthis.pageSizeSelect.classList.add(\"tabulator-page-size\");\n\t\t}\n\t}\n\t\n\tgeneratePageSizeSelectList(){\n\t\tvar pageSizes = [];\n\t\t\n\t\tif(this.pageSizeSelect){\n\t\t\t\n\t\t\tif(Array.isArray(this.table.options.paginationSizeSelector)){\n\t\t\t\tpageSizes = this.table.options.paginationSizeSelector;\n\t\t\t\tthis.pageSizes = pageSizes;\n\t\t\t\t\n\t\t\t\tif(this.pageSizes.indexOf(this.size) == -1){\n\t\t\t\t\tpageSizes.unshift(this.size);\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\t\n\t\t\t\tif(this.pageSizes.indexOf(this.size) == -1){\n\t\t\t\t\tpageSizes = [];\n\t\t\t\t\t\n\t\t\t\t\tfor (let i = 1; i < 5; i++){\n\t\t\t\t\t\tpageSizes.push(this.size * i);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.pageSizes = pageSizes;\n\t\t\t\t}else {\n\t\t\t\t\tpageSizes = this.pageSizes;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\twhile(this.pageSizeSelect.firstChild) this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);\n\t\t\t\n\t\t\tpageSizes.forEach((item) => {\n\t\t\t\tvar itemEl = document.createElement(\"option\");\n\t\t\t\titemEl.value = item;\n\t\t\t\t\n\t\t\t\tif(item === true){\n\t\t\t\t\tthis.langBind(\"pagination|all\", function(value){\n\t\t\t\t\t\titemEl.innerHTML = value;\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\titemEl.innerHTML = item;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tthis.pageSizeSelect.appendChild(itemEl);\n\t\t\t});\n\t\t\t\n\t\t\tthis.pageSizeSelect.value = this.size;\n\t\t}\n\t}\n\t\n\tinitializePageCounter(){\n\t\tvar counter = this.table.options.paginationCounter,\n\t\tpageCounter = null;\n\t\t\n\t\tif(counter){\n\t\t\tif(typeof counter === \"function\"){\n\t\t\t\tpageCounter = counter;\n\t\t\t}else {\n\t\t\t\tpageCounter = Page.pageCounters[counter];\n\t\t\t}\n\t\t\t\n\t\t\tif(pageCounter){\n\t\t\t\tthis.pageCounter = pageCounter;\n\t\t\t\t\n\t\t\t\tthis.pageCounterElement = document.createElement(\"span\");\n\t\t\t\tthis.pageCounterElement.classList.add(\"tabulator-page-counter\");\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Pagination Error - No such page counter found: \", counter);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//setup pagination\n\tinitializePaginator(hidden){\n\t\tvar pageSelectLabel, paginationCounterHolder;\n\t\t\n\t\tif(!hidden){\n\t\t\t//build pagination element\n\t\t\t\n\t\t\t//bind localizations\n\t\t\tthis.langBind(\"pagination|first\", (value) => {\n\t\t\t\tthis.firstBut.innerHTML = value;\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|first_title\", (value) => {\n\t\t\t\tthis.firstBut.setAttribute(\"aria-label\", value);\n\t\t\t\tthis.firstBut.setAttribute(\"title\", value);\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|prev\", (value) => {\n\t\t\t\tthis.prevBut.innerHTML = value;\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|prev_title\", (value) => {\n\t\t\t\tthis.prevBut.setAttribute(\"aria-label\", value);\n\t\t\t\tthis.prevBut.setAttribute(\"title\", value);\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|next\", (value) => {\n\t\t\t\tthis.nextBut.innerHTML = value;\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|next_title\", (value) => {\n\t\t\t\tthis.nextBut.setAttribute(\"aria-label\", value);\n\t\t\t\tthis.nextBut.setAttribute(\"title\", value);\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|last\", (value) => {\n\t\t\t\tthis.lastBut.innerHTML = value;\n\t\t\t});\n\t\t\t\n\t\t\tthis.langBind(\"pagination|last_title\", (value) => {\n\t\t\t\tthis.lastBut.setAttribute(\"aria-label\", value);\n\t\t\t\tthis.lastBut.setAttribute(\"title\", value);\n\t\t\t});\n\t\t\t\n\t\t\t//click bindings\n\t\t\tthis.firstBut.addEventListener(\"click\", () => {\n\t\t\t\tthis.setPage(1);\n\t\t\t});\n\t\t\t\n\t\t\tthis.prevBut.addEventListener(\"click\", () => {\n\t\t\t\tthis.previousPage();\n\t\t\t});\n\t\t\t\n\t\t\tthis.nextBut.addEventListener(\"click\", () => {\n\t\t\t\tthis.nextPage();\n\t\t\t});\n\t\t\t\n\t\t\tthis.lastBut.addEventListener(\"click\", () => {\n\t\t\t\tthis.setPage(this.max);\n\t\t\t});\n\t\t\t\n\t\t\tif(this.table.options.paginationElement){\n\t\t\t\tthis.element = this.table.options.paginationElement;\n\t\t\t}\n\t\t\t\n\t\t\tif(this.pageSizeSelect){\n\t\t\t\tpageSelectLabel = document.createElement(\"label\");\n\t\t\t\t\n\t\t\t\tthis.langBind(\"pagination|page_size\", (value) => {\n\t\t\t\t\tthis.pageSizeSelect.setAttribute(\"aria-label\", value);\n\t\t\t\t\tthis.pageSizeSelect.setAttribute(\"title\", value);\n\t\t\t\t\tpageSelectLabel.innerHTML = value;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.element.appendChild(pageSelectLabel);\n\t\t\t\tthis.element.appendChild(this.pageSizeSelect);\n\t\t\t\t\n\t\t\t\tthis.pageSizeSelect.addEventListener(\"change\", (e) => {\n\t\t\t\t\tthis.setPageSize(this.pageSizeSelect.value == \"true\" ? true : this.pageSizeSelect.value);\n\t\t\t\t\tthis.setPage(1);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t//append to DOM\n\t\t\tthis.element.appendChild(this.firstBut);\n\t\t\tthis.element.appendChild(this.prevBut);\n\t\t\tthis.element.appendChild(this.pagesElement);\n\t\t\tthis.element.appendChild(this.nextBut);\n\t\t\tthis.element.appendChild(this.lastBut);\n\t\t\t\n\t\t\tif(!this.table.options.paginationElement){\n\t\t\t\tif(this.table.options.paginationCounter){\n\n\t\t\t\t\tif(this.table.options.paginationCounterElement){\n\t\t\t\t\t\tif(this.table.options.paginationCounterElement instanceof HTMLElement){\n\t\t\t\t\t\t\tthis.table.options.paginationCounterElement.appendChild(this.pageCounterElement);\n\t\t\t\t\t\t}else if(typeof this.table.options.paginationCounterElement === \"string\"){\n\t\t\t\t\t\t\tpaginationCounterHolder = document.querySelector(this.table.options.paginationCounterElement);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(paginationCounterHolder){\n\t\t\t\t\t\t\t\tpaginationCounterHolder.appendChild(this.pageCounterElement);\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tconsole.warn(\"Pagination Error - Unable to find element matching paginationCounterElement selector:\", this.table.options.paginationCounterElement);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.footerAppend(this.pageCounterElement);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.footerAppend(this.element);\n\t\t\t}\n\t\t\t\n\t\t\tthis.page = this.table.options.paginationInitialPage;\n\t\t\tthis.count = this.table.options.paginationButtonCount;\n\t\t}\n\t\t\n\t\t//set default values\n\t\tthis.mode = this.table.options.paginationMode;\n\t}\n\t\n\tinitializeProgressive(mode){\n\t\tthis.initializePaginator(true);\n\t\tthis.mode = \"progressive_\" + mode;\n\t\tthis.progressiveLoad = true;\n\t}\n\t\n\ttrackChanges(){\n\t\tthis.dispatch(\"page-changed\");\n\t}\n\t\n\t//calculate maximum page from number of rows\n\tsetMaxRows(rowCount){\n\t\tif(!rowCount){\n\t\t\tthis.max = 1;\n\t\t}else {\n\t\t\tthis.max = this.size === true ?  1 : Math.ceil(rowCount/this.size);\n\t\t}\n\t\t\n\t\tif(this.page > this.max){\n\t\t\tthis.page = this.max;\n\t\t}\n\t}\n\t\n\t//reset to first page without triggering action\n\treset(force){\n\t\tif(!this.initialLoad){\n\t\t\tif(this.mode == \"local\" || force){\n\t\t\t\tthis.page = 1;\n\t\t\t\tthis.trackChanges();\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//set the maximum page\n\tsetMaxPage(max){\n\t\t\n\t\tmax = parseInt(max);\n\t\t\n\t\tthis.max = max || 1;\n\t\t\n\t\tif(this.page > this.max){\n\t\t\tthis.page = this.max;\n\t\t\tthis.trigger();\n\t\t}\n\t}\n\t\n\t//set current page number\n\tsetPage(page){\n\t\tswitch(page){\n\t\t\tcase \"first\":\n\t\t\t\treturn this.setPage(1);\n\t\n\t\t\tcase \"prev\":\n\t\t\t\treturn this.previousPage();\n\t\t\t\n\t\t\tcase \"next\":\n\t\t\t\treturn this.nextPage();\n\t\t\t\n\t\t\tcase \"last\":\n\t\t\t\treturn this.setPage(this.max);\n\t\t}\n\t\t\n\t\tpage = parseInt(page);\n\t\t\n\t\tif((page > 0 && page <= this.max) || this.mode !== \"local\"){\n\t\t\tthis.page = page;\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t\t\n\t\t\treturn this.trigger();\n\t\t}else {\n\t\t\tconsole.warn(\"Pagination Error - Requested page is out of range of 1 - \" + this.max + \":\", page);\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\tsetPageToRow(row){\n\t\tvar rows = this.displayRows(-1);\n\t\tvar index = rows.indexOf(row);\n\t\n\t\tif(index > -1){\n\t\t\tvar page = this.size === true ? 1 : Math.ceil((index + 1) / this.size);\n\t\t\t\n\t\t\treturn this.setPage(page);\n\t\t}else {\n\t\t\tconsole.warn(\"Pagination Error - Requested row is not visible\");\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\tsetPageSize(size){\n\t\tif(size !== true){\n\t\t\tsize = parseInt(size);\n\t\t}\n\n\t\tif(size > 0){\n\t\t\tthis.size = size;\n\t\t\tthis.dispatchExternal(\"pageSizeChanged\", size);\n\t\t}\n\t\t\n\t\tif(this.pageSizeSelect){\n\t\t\t// this.pageSizeSelect.value = size;\n\t\t\tthis.generatePageSizeSelectList();\n\t\t}\n\t\t\n\t\tthis.trackChanges();\n\t}\n\t\n\t_setPageCounter(totalRows, size, currentRow){\n\t\tvar content;\n\t\t\n\t\tif(this.pageCounter){\n\n\t\t\tif(this.mode === \"remote\"){\n\t\t\t\tsize = this.size;\n\t\t\t\tcurrentRow = ((this.page - 1) * this.size) + 1;\n\t\t\t\ttotalRows = this.remoteRowCountEstimate;\n\t\t\t}\n\n\t\t\tcontent = this.pageCounter.call(this, size, currentRow, this.page, totalRows, this.max);\n\t\t\t\n\t\t\tswitch(typeof content){\n\t\t\t\tcase \"object\":\n\t\t\t\t\tif(content instanceof Node){\n\t\t\t\t\t\n\t\t\t\t\t\t//clear previous cell contents\n\t\t\t\t\t\twhile(this.pageCounterElement.firstChild) this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);\n\t\t\t\t\t\n\t\t\t\t\t\tthis.pageCounterElement.appendChild(content);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.pageCounterElement.innerHTML = \"\";\n\t\t\t\t\t\n\t\t\t\t\t\tif(content != null){\n\t\t\t\t\t\t\tconsole.warn(\"Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:\", content);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"undefined\":\n\t\t\t\t\tthis.pageCounterElement.innerHTML = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.pageCounterElement.innerHTML = content;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//setup the pagination buttons\n\t_setPageButtons(){\n\t\tlet leftSize = Math.floor((this.count-1) / 2);\n\t\tlet rightSize = Math.ceil((this.count-1) / 2);\n\t\tlet min = this.max - this.page + leftSize + 1 < this.count ? this.max-this.count+1: Math.max(this.page-leftSize,1);\n\t\tlet max = this.page <= rightSize? Math.min(this.count, this.max) :Math.min(this.page+rightSize, this.max);\n\t\t\n\t\twhile(this.pagesElement.firstChild) this.pagesElement.removeChild(this.pagesElement.firstChild);\n\t\t\n\t\tif(this.page == 1){\n\t\t\tthis.firstBut.disabled = true;\n\t\t\tthis.prevBut.disabled = true;\n\t\t}else {\n\t\t\tthis.firstBut.disabled = false;\n\t\t\tthis.prevBut.disabled = false;\n\t\t}\n\t\t\n\t\tif(this.page == this.max){\n\t\t\tthis.lastBut.disabled = true;\n\t\t\tthis.nextBut.disabled = true;\n\t\t}else {\n\t\t\tthis.lastBut.disabled = false;\n\t\t\tthis.nextBut.disabled = false;\n\t\t}\n\t\t\n\t\tfor(let i = min; i <= max; i++){\n\t\t\tif(i>0 && i <= this.max){\n\t\t\t\tthis.pagesElement.appendChild(this._generatePageButton(i));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.footerRedraw();\n\t}\n\t\n\t_generatePageButton(page){\n\t\tvar button = document.createElement(\"button\");\n\t\t\n\t\tbutton.classList.add(\"tabulator-page\");\n\t\tif(page == this.page){\n\t\t\tbutton.classList.add(\"active\");\n\t\t}\n\t\t\n\t\tbutton.setAttribute(\"type\", \"button\");\n\t\tbutton.setAttribute(\"role\", \"button\");\n\t\t\n\t\tthis.langBind(\"pagination|page_title\", (value) => {\n\t\t\tbutton.setAttribute(\"aria-label\", value + \" \" + page);\n\t\t\tbutton.setAttribute(\"title\", value + \" \" + page);\n\t\t});\n\t\t\n\t\tbutton.setAttribute(\"data-page\", page);\n\t\tbutton.textContent = page;\n\t\t\n\t\tbutton.addEventListener(\"click\", (e) => {\n\t\t\tthis.setPage(page);\n\t\t});\n\t\t\n\t\treturn button;\n\t}\n\t\n\t//previous page\n\tpreviousPage(){\n\t\tif(this.page > 1){\n\t\t\tthis.page--;\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t\t\n\t\t\treturn this.trigger();\n\t\t\t\n\t\t}else {\n\t\t\tconsole.warn(\"Pagination Error - Previous page would be less than page 1:\", 0);\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\t//next page\n\tnextPage(){\n\t\tif(this.page < this.max){\n\t\t\tthis.page++;\n\t\t\t\n\t\t\tthis.trackChanges();\n\t\t\t\n\t\t\treturn this.trigger();\n\t\t\t\n\t\t}else {\n\t\t\tif(!this.progressiveLoad){\n\t\t\t\tconsole.warn(\"Pagination Error - Next page would be greater than maximum page of \" + this.max + \":\", this.max + 1);\n\t\t\t}\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\t//return current page number\n\tgetPage(){\n\t\treturn this.page;\n\t}\n\t\n\t//return max page number\n\tgetPageMax(){\n\t\treturn this.max;\n\t}\n\t\n\tgetPageSize(size){\n\t\treturn this.size;\n\t}\n\t\n\tgetMode(){\n\t\treturn this.mode;\n\t}\n\t\n\t//return appropriate rows for current page\n\tgetRows(data){\n\t\tvar actualRowPageSize = 0,\n\t\toutput, start, end, actualStartRow;\n\n\t\tvar actualRows = data.filter((row) => {\n\t\t\treturn row.type === \"row\";\n\t\t});\n\t\t\n\t\tif(this.mode == \"local\"){\n\t\t\toutput = [];\n\t\t\t\n\t\t\tthis.setMaxRows(data.length);\n\t\t\t\n\t\t\tif(this.size === true){\n\t\t\t\tstart = 0;\n\t\t\t\tend = data.length;\n\t\t\t}else {\n\t\t\t\tstart = this.size * (this.page - 1);\n\t\t\t\tend = start + parseInt(this.size);\n\t\t\t}\n\t\t\t\n\t\t\tthis._setPageButtons();\n\t\t\t\n\t\t\tfor(let i = start; i < end; i++){\n\t\t\t\tlet row = data[i];\n\n\t\t\t\tif(row){\n\t\t\t\t\toutput.push(row);\n\n\t\t\t\t\tif(row.type === \"row\"){\n\t\t\t\t\t\tif(!actualStartRow){\n\t\t\t\t\t\t\tactualStartRow = row;\n\t\t\t\t\t\t}\t\n\n\t\t\t\t\t\tactualRowPageSize++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis._setPageCounter(actualRows.length, actualRowPageSize, actualStartRow ? (actualRows.indexOf(actualStartRow) + 1) : 0);\n\t\t\t\n\t\t\treturn output;\n\t\t}else {\n\t\t\tthis._setPageButtons();\n\t\t\tthis._setPageCounter(actualRows.length);\n\t\t\t\n\t\t\treturn data.slice(0);\n\t\t}\n\t}\n\t\n\ttrigger(){\n\t\tvar left;\n\t\t\n\t\tswitch(this.mode){\n\t\t\tcase \"local\":\n\t\t\t\tleft = this.table.rowManager.scrollLeft;\n\t\t\t\n\t\t\t\tthis.refreshData();\n\t\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\t\t\t\n\t\t\t\tthis.dispatchExternal(\"pageLoaded\", this.getPage());\n\t\t\t\n\t\t\t\treturn Promise.resolve();\n\t\t\t\n\t\t\tcase \"remote\":\n\t\t\t\tthis.dataChanging = true;\n\t\t\t\treturn this.reloadData(null)\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tthis.dataChanging = false;\n\t\t\t\t\t});\n\t\t\t\n\t\t\tcase \"progressive_load\":\n\t\t\tcase \"progressive_scroll\":\n\t\t\t\treturn this.reloadData(null, true);\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tconsole.warn(\"Pagination Error - no such pagination mode:\", this.mode);\n\t\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\t_parseRemoteData(data){\n\t\tvar margin, paginationOutOfRange;\n\t\t\n\t\tif(typeof data.last_page === \"undefined\"){\n\t\t\tconsole.warn(\"Remote Pagination Error - Server response missing '\" + (this.options(\"dataReceiveParams\").last_page || \"last_page\") + \"' property\");\n\t\t}\n\t\t\n\t\tif(data.data){\n\t\t\tthis.max = parseInt(data.last_page) || 1;\n\n\t\t\tthis.remoteRowCountEstimate = typeof data.last_row !== \"undefined\" ? data.last_row : (data.last_page * this.size - (this.page == data.last_page ? (this.size - data.data.length) : 0));\n\t\t\t\n\t\t\tif(this.progressiveLoad){\n\t\t\t\tswitch(this.mode){\n\t\t\t\t\tcase \"progressive_load\":\n\t\t\t\t\t\n\t\t\t\t\t\tif(this.page == 1){\n\t\t\t\t\t\t\tthis.table.rowManager.setData(data.data, false, this.page == 1);\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tthis.table.rowManager.addRows(data.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\tif(this.page < this.max){\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tthis.nextPage();\n\t\t\t\t\t\t\t}, this.table.options.progressiveLoadDelay);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"progressive_scroll\":\n\t\t\t\t\t\tdata = this.page === 1 ? data.data : this.table.rowManager.getData().concat(data.data);\n\t\t\t\t\t\n\t\t\t\t\t\tthis.table.rowManager.setData(data, this.page !== 1, this.page == 1);\n\t\t\t\t\t\n\t\t\t\t\t\tmargin = this.table.options.progressiveLoadScrollMargin || (this.table.rowManager.element.clientHeight * 2);\n\t\t\t\t\t\n\t\t\t\t\t\tif(this.table.rowManager.element.scrollHeight <= (this.table.rowManager.element.clientHeight + margin)){\n\t\t\t\t\t\t\tif(this.page < this.max){\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tthis.nextPage();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn false;\n\t\t\t}else {\n\n\t\t\t\tif(this.page > this.max){\n\t\t\t\t\tconsole.warn( \"Remote Pagination Error - Server returned last page value lower than the current page\" );\n\n\t\t\t\t\tpaginationOutOfRange = this.options('paginationOutOfRange');\n\n\t\t\t\t\tif(paginationOutOfRange){\n\t\t\t\t\t\treturn this.setPage(typeof paginationOutOfRange === 'function' ? paginationOutOfRange.call(this, this.page, this.max) :\tpaginationOutOfRange);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// left = this.table.rowManager.scrollLeft;\n\t\t\t\tthis.dispatchExternal(\"pageLoaded\",  this.getPage());\n\t\t\t\t// this.table.rowManager.scrollHorizontal(left);\n\t\t\t\t// this.table.columnManager.scrollHorizontal(left);\n\t\t\t}\n\t\t\t\n\t\t}else {\n\t\t\tconsole.warn(\"Remote Pagination Error - Server response missing '\" + (this.options(\"dataReceiveParams\").data || \"data\") + \"' property\");\n\t\t}\n\t\t\n\t\treturn data.data;\n\t}\n\t\n\t//handle the footer element being redrawn\n\tfooterRedraw(){\n\t\tvar footer = this.table.footerManager.containerElement;\n\n\t\tif((Math.ceil(footer.clientWidth) - footer.scrollWidth) < 0){\n\t\t\tthis.pagesElement.style.display = 'none';\n\t\t}else {\n\t\t\tthis.pagesElement.style.display = '';\n\t\t\t\n\t\t\tif((Math.ceil(footer.clientWidth) - footer.scrollWidth) < 0){\n\t\t\t\tthis.pagesElement.style.display = 'none';\n\t\t\t}\n\t\t}\n\t}\n}\n\n// read persistance information from storage\nvar defaultReaders = {\n\tlocal:function(id, type){\n\t\tvar data = localStorage.getItem(id + \"-\" + type);\n\n\t\treturn data ? JSON.parse(data) : false;\n\t},\n\tcookie:function(id, type){\n\t\tvar cookie = document.cookie,\n\t\tkey = id + \"-\" + type,\n\t\tcookiePos = cookie.indexOf(key + \"=\"),\n\t\tend, data;\n\n\t\t//if cookie exists, decode and load column data into tabulator\n\t\tif(cookiePos > -1){\n\t\t\tcookie = cookie.slice(cookiePos);\n\n\t\t\tend = cookie.indexOf(\";\");\n\n\t\t\tif(end > -1){\n\t\t\t\tcookie = cookie.slice(0, end);\n\t\t\t}\n\n\t\t\tdata = cookie.replace(key + \"=\", \"\");\n\t\t}\n\n\t\treturn data ? JSON.parse(data) : false;\n\t}\n};\n\n//write persistence information to storage\nvar defaultWriters = {\n\tlocal:function(id, type, data){\n\t\tlocalStorage.setItem(id + \"-\" + type, JSON.stringify(data));\n\t},\n\tcookie:function(id, type, data){\n\t\tvar expireDate = new Date();\n\n\t\texpireDate.setDate(expireDate.getDate() + 10000);\n\n\t\tdocument.cookie = id + \"-\" + type + \"=\" + JSON.stringify(data) + \"; expires=\" + expireDate.toUTCString();\n\t}\n};\n\nclass Persistence extends Module{\n\n\tstatic moduleName = \"persistence\";\n\n\tstatic moduleInitOrder = -10;\n\n\t//load defaults\n\tstatic readers = defaultReaders;\n\tstatic writers = defaultWriters;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.mode = \"\";\n\t\tthis.id = \"\";\n\t\t// this.persistProps = [\"field\", \"width\", \"visible\"];\n\t\tthis.defWatcherBlock = false;\n\t\tthis.config = {};\n\t\tthis.readFunc = false;\n\t\tthis.writeFunc = false;\n\n\t\tthis.registerTableOption(\"persistence\", false);\n\t\tthis.registerTableOption(\"persistenceID\", \"\"); //key for persistent storage\n\t\tthis.registerTableOption(\"persistenceMode\", true); //mode for storing persistence information\n\t\tthis.registerTableOption(\"persistenceReaderFunc\", false); //function for handling persistence data reading\n\t\tthis.registerTableOption(\"persistenceWriterFunc\", false); //function for handling persistence data writing\n\t}\n\n\t// Test for whether localStorage is available for use.\n\tlocalStorageTest() {\n\t\tvar  testKey =  \"_tabulator_test\";\n\n\t\ttry {\n\t\t\twindow.localStorage.setItem( testKey, testKey);\n\t\t\twindow.localStorage.removeItem( testKey );\n\t\t\treturn true;\n\t\t} catch(e) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//setup parameters\n\tinitialize(){\n\t\tif(this.table.options.persistence){\n\t\t\t//determine persistent layout storage type\n\t\t\tvar mode = this.table.options.persistenceMode,\n\t\t\tid = this.table.options.persistenceID,\n\t\t\tretrievedData;\n\n\t\t\tthis.mode = mode !== true ?  mode : (this.localStorageTest() ? \"local\" : \"cookie\");\n\n\t\t\tif(this.table.options.persistenceReaderFunc){\n\t\t\t\tif(typeof this.table.options.persistenceReaderFunc === \"function\"){\n\t\t\t\t\tthis.readFunc = this.table.options.persistenceReaderFunc;\n\t\t\t\t}else {\n\t\t\t\t\tif(Persistence.readers[this.table.options.persistenceReaderFunc]){\n\t\t\t\t\t\tthis.readFunc = Persistence.readers[this.table.options.persistenceReaderFunc];\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Persistence Read Error - invalid reader set\", this.table.options.persistenceReaderFunc);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(Persistence.readers[this.mode]){\n\t\t\t\t\tthis.readFunc = Persistence.readers[this.mode];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Persistence Read Error - invalid reader set\", this.mode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.table.options.persistenceWriterFunc){\n\t\t\t\tif(typeof this.table.options.persistenceWriterFunc === \"function\"){\n\t\t\t\t\tthis.writeFunc = this.table.options.persistenceWriterFunc;\n\t\t\t\t}else {\n\t\t\t\t\tif(Persistence.writers[this.table.options.persistenceWriterFunc]){\n\t\t\t\t\t\tthis.writeFunc = Persistence.writers[this.table.options.persistenceWriterFunc];\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Persistence Write Error - invalid reader set\", this.table.options.persistenceWriterFunc);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(Persistence.writers[this.mode]){\n\t\t\t\t\tthis.writeFunc = Persistence.writers[this.mode];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Persistence Write Error - invalid writer set\", this.mode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//set storage tag\n\t\t\tthis.id = \"tabulator-\" + (id || (this.table.element.getAttribute(\"id\") || \"\"));\n\n\t\t\tthis.config = {\n\t\t\t\tsort:this.table.options.persistence === true || this.table.options.persistence.sort,\n\t\t\t\tfilter:this.table.options.persistence === true || this.table.options.persistence.filter,\n\t\t\t\theaderFilter:this.table.options.persistence === true || this.table.options.persistence.headerFilter,\n\t\t\t\tgroup:this.table.options.persistence === true || this.table.options.persistence.group,\n\t\t\t\tpage:this.table.options.persistence === true || this.table.options.persistence.page,\n\t\t\t\tcolumns:this.table.options.persistence === true ? [\"title\", \"width\", \"visible\"] : this.table.options.persistence.columns,\n\t\t\t};\n\n\t\t\t//load pagination data if needed\n\t\t\tif(this.config.page){\n\t\t\t\tretrievedData = this.retrieveData(\"page\");\n\n\t\t\t\tif(retrievedData){\n\t\t\t\t\tif(typeof retrievedData.paginationSize !== \"undefined\" && (this.config.page === true || this.config.page.size)){\n\t\t\t\t\t\tthis.table.options.paginationSize = retrievedData.paginationSize;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(typeof retrievedData.paginationInitialPage !== \"undefined\" && (this.config.page === true || this.config.page.page)){\n\t\t\t\t\t\tthis.table.options.paginationInitialPage = retrievedData.paginationInitialPage;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//load group data if needed\n\t\t\tif(this.config.group){\n\t\t\t\tretrievedData = this.retrieveData(\"group\");\n\n\t\t\t\tif(retrievedData){\n\t\t\t\t\tif(typeof retrievedData.groupBy !== \"undefined\" && (this.config.group === true || this.config.group.groupBy)){\n\t\t\t\t\t\tthis.table.options.groupBy = retrievedData.groupBy;\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof retrievedData.groupStartOpen !== \"undefined\" && (this.config.group === true || this.config.group.groupStartOpen)){\n\t\t\t\t\t\tthis.table.options.groupStartOpen = retrievedData.groupStartOpen;\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof retrievedData.groupHeader !== \"undefined\" && (this.config.group === true || this.config.group.groupHeader)){\n\t\t\t\t\t\tthis.table.options.groupHeader = retrievedData.groupHeader;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.config.columns){\n\t\t\t\tthis.table.options.columns = this.load(\"columns\", this.table.options.columns);\n\t\t\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\t\t\tthis.subscribe(\"column-show\", this.save.bind(this, \"columns\"));\n\t\t\t\tthis.subscribe(\"column-hide\", this.save.bind(this, \"columns\"));\n\t\t\t\tthis.subscribe(\"column-moved\", this.save.bind(this, \"columns\"));\n\t\t\t}\n\n\t\t\tthis.subscribe(\"table-built\", this.tableBuilt.bind(this), 0);\n\n\t\t\tthis.subscribe(\"table-redraw\", this.tableRedraw.bind(this));\n\n\t\t\tthis.subscribe(\"filter-changed\", this.eventSave.bind(this, \"filter\"));\n\t\t\tthis.subscribe(\"filter-changed\", this.eventSave.bind(this, \"headerFilter\"));\n\t\t\tthis.subscribe(\"sort-changed\", this.eventSave.bind(this, \"sort\"));\n\t\t\tthis.subscribe(\"group-changed\", this.eventSave.bind(this, \"group\"));\n\t\t\tthis.subscribe(\"page-changed\", this.eventSave.bind(this, \"page\"));\n\t\t\tthis.subscribe(\"column-resized\", this.eventSave.bind(this, \"columns\"));\n\t\t\tthis.subscribe(\"column-width\", this.eventSave.bind(this, \"columns\"));\n\t\t\tthis.subscribe(\"layout-refreshed\", this.eventSave.bind(this, \"columns\"));\n\t\t}\n\n\t\tthis.registerTableFunction(\"getColumnLayout\", this.getColumnLayout.bind(this));\n\t\tthis.registerTableFunction(\"setColumnLayout\", this.setColumnLayout.bind(this));\n\t}\n\n\teventSave(type){\n\t\tif(this.config[type]){\n\t\t\tthis.save(type);\n\t\t}\n\t}\n\n\ttableBuilt(){\n\t\tvar sorters, filters, headerFilters;\n\n\t\tif(this.config.sort){\n\t\t\tsorters = this.load(\"sort\");\n\n\t\t\tif(!sorters === false){\n\t\t\t\tthis.table.options.initialSort = sorters;\n\t\t\t}\n\t\t}\n\n\t\tif(this.config.filter){\n\t\t\tfilters = this.load(\"filter\");\n\n\t\t\tif(!filters === false){\n\t\t\t\tthis.table.options.initialFilter = filters;\n\t\t\t}\n\t\t}\n\t\tif(this.config.headerFilter){\n\t\t\theaderFilters = this.load(\"headerFilter\");\n\n\t\t\tif(!headerFilters === false){\n\t\t\t\tthis.table.options.initialHeaderFilter = headerFilters;\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\n\ttableRedraw(force){\n\t\tif(force && this.config.columns){\n\t\t\tthis.save(\"columns\");\n\t\t}\n\t}\n\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\n\tgetColumnLayout(){\n\t\treturn this.parseColumns(this.table.columnManager.getColumns());\n\t}\n\n\tsetColumnLayout(layout){\n\t\tthis.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns, layout, true));\n\t\treturn true;\n\t}\n\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\n\tinitializeColumn(column){\n\t\tvar def, keys;\n\n\t\tif(this.config.columns){\n\t\t\tthis.defWatcherBlock = true;\n\n\t\t\tdef = column.getDefinition();\n\n\t\t\tkeys = this.config.columns === true ? Object.keys(def) : this.config.columns;\n\n\t\t\tkeys.forEach((key)=>{\n\t\t\t\tvar props = Object.getOwnPropertyDescriptor(def, key);\n\t\t\t\tvar value = def[key];\n\n\t\t\t\tif(props){\n\t\t\t\t\tObject.defineProperty(def, key, {\n\t\t\t\t\t\tset: (newValue) => {\n\t\t\t\t\t\t\tvalue = newValue;\n\n\t\t\t\t\t\t\tif(!this.defWatcherBlock){\n\t\t\t\t\t\t\t\tthis.save(\"columns\");\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(props.set){\n\t\t\t\t\t\t\t\tprops.set(newValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tget:() => {\n\t\t\t\t\t\t\tif(props.get){\n\t\t\t\t\t\t\t\tprops.get();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.defWatcherBlock = false;\n\t\t}\n\t}\n\n\t//load saved definitions\n\tload(type, current){\n\t\tvar data = this.retrieveData(type);\n\n\t\tif(current){\n\t\t\tdata = data ? this.mergeDefinition(current, data) : current;\n\t\t}\n\n\t\treturn data;\n\t}\n\n\t//retrieve data from memory\n\tretrieveData(type){\n\t\treturn this.readFunc ? this.readFunc(this.id, type) : false;\n\t}\n\n\t//merge old and new column definitions\n\tmergeDefinition(oldCols, newCols, mergeAllNew){\n\t\tvar output = [];\n\n\t\tnewCols = newCols || [];\n\n\t\tnewCols.forEach((column, to) => {\n\t\t\tvar from = this._findColumn(oldCols, column),\n\t\t\tkeys;\n\n\t\t\tif(from){\n\t\t\t\tif(mergeAllNew){\n\t\t\t\t\tkeys = Object.keys(column);\n\t\t\t\t}else if(this.config.columns === true || this.config.columns == undefined){\n\t\t\t\t\tkeys =  Object.keys(from);\n\t\t\t\t\tkeys.push(\"width\");\n\t\t\t\t}else {\n\t\t\t\t\tkeys = this.config.columns;\n\t\t\t\t}\n\n\t\t\t\tkeys.forEach((key)=>{\n\t\t\t\t\tif(key !== \"columns\" && typeof column[key] !== \"undefined\"){\n\t\t\t\t\t\tfrom[key] = column[key];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(from.columns){\n\t\t\t\t\tfrom.columns = this.mergeDefinition(from.columns, column.columns);\n\t\t\t\t}\n\n\t\t\t\toutput.push(from);\n\t\t\t}\n\t\t});\n\n\t\toldCols.forEach((column, i) => {\n\t\t\tvar from = this._findColumn(newCols, column);\n\n\t\t\tif (!from) {\n\t\t\t\tif(output.length>i){\n\t\t\t\t\toutput.splice(i, 0, column);\n\t\t\t\t}else {\n\t\t\t\t\toutput.push(column);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\t//find matching columns\n\t_findColumn(columns, subject){\n\t\tvar type = subject.columns ? \"group\" : (subject.field ? \"field\" : \"object\");\n\n\t\treturn columns.find(function(col){\n\t\t\tswitch(type){\n\t\t\t\tcase \"group\":\n\t\t\t\t\treturn col.title === subject.title && col.columns.length === subject.columns.length;\n\n\t\t\t\tcase \"field\":\n\t\t\t\t\treturn col.field === subject.field;\n\n\t\t\t\tcase \"object\":\n\t\t\t\t\treturn col === subject;\n\t\t\t}\n\t\t});\n\t}\n\n\t//save data\n\tsave(type){\n\t\tvar data = {};\n\n\t\tswitch(type){\n\t\t\tcase \"columns\":\n\t\t\t\tdata = this.parseColumns(this.table.columnManager.getColumns());\n\t\t\t\tbreak;\n\n\t\t\tcase \"filter\":\n\t\t\t\tdata = this.table.modules.filter.getFilters();\n\t\t\t\tbreak;\n\n\t\t\tcase \"headerFilter\":\n\t\t\t\tdata = this.table.modules.filter.getHeaderFilters();\n\t\t\t\tbreak;\n\n\t\t\tcase \"sort\":\n\t\t\t\tdata = this.validateSorters(this.table.modules.sort.getSort());\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tdata = this.getGroupConfig();\n\t\t\t\tbreak;\n\n\t\t\tcase \"page\":\n\t\t\t\tdata = this.getPageConfig();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif(this.writeFunc){\n\t\t\tthis.writeFunc(this.id, type, data);\n\t\t}\n\n\t}\n\n\t//ensure sorters contain no function data\n\tvalidateSorters(data){\n\t\tdata.forEach(function(item){\n\t\t\titem.column = item.field;\n\t\t\tdelete item.field;\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tgetGroupConfig(){\n\t\tvar data = {};\n\n\t\tif(this.config.group){\n\t\t\tif(this.config.group === true || this.config.group.groupBy){\n\t\t\t\tdata.groupBy = this.table.options.groupBy;\n\t\t\t}\n\n\t\t\tif(this.config.group === true || this.config.group.groupStartOpen){\n\t\t\t\tdata.groupStartOpen = this.table.options.groupStartOpen;\n\t\t\t}\n\n\t\t\tif(this.config.group === true || this.config.group.groupHeader){\n\t\t\t\tdata.groupHeader = this.table.options.groupHeader;\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tgetPageConfig(){\n\t\tvar data = {};\n\n\t\tif(this.config.page){\n\t\t\tif(this.config.page === true || this.config.page.size){\n\t\t\t\tdata.paginationSize = this.table.modules.page.getPageSize();\n\t\t\t}\n\n\t\t\tif(this.config.page === true || this.config.page.page){\n\t\t\t\tdata.paginationInitialPage = this.table.modules.page.getPage();\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\n\n\t//parse columns for data to store\n\tparseColumns(columns){\n\t\tvar definitions = [],\n\t\texcludedKeys = [\"headerContextMenu\", \"headerMenu\", \"contextMenu\", \"clickMenu\"];\n\n\t\tcolumns.forEach((column) => {\n\t\t\tvar defStore = {},\n\t\t\tcolDef = column.getDefinition(),\n\t\t\tkeys;\n\n\t\t\tif(column.isGroup){\n\t\t\t\tdefStore.title = colDef.title;\n\t\t\t\tdefStore.columns = this.parseColumns(column.getColumns());\n\t\t\t}else {\n\t\t\t\tdefStore.field = column.getField();\n\n\t\t\t\tif(this.config.columns === true || this.config.columns == undefined){\n\t\t\t\t\tkeys =  Object.keys(colDef);\n\t\t\t\t\tkeys.push(\"width\");\n\t\t\t\t\tkeys.push(\"visible\");\n\t\t\t\t}else {\n\t\t\t\t\tkeys = this.config.columns;\n\t\t\t\t}\n\n\t\t\t\tkeys.forEach((key)=>{\n\t\t\t\t\tswitch(key){\n\t\t\t\t\t\tcase \"width\":\n\t\t\t\t\t\t\tdefStore.width = column.getWidth();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"visible\":\n\t\t\t\t\t\t\tdefStore.visible = column.visible;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif(typeof colDef[key] !== \"function\" && excludedKeys.indexOf(key) === -1){\n\t\t\t\t\t\t\t\tdefStore[key] = colDef[key];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tdefinitions.push(defStore);\n\t\t});\n\n\t\treturn definitions;\n\t}\n}\n\nclass Popup extends Module{\n\t\n\tstatic moduleName = \"popup\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.columnSubscribers = {};\n\t\t\n\t\tthis.registerTableOption(\"rowContextPopup\", false);\n\t\tthis.registerTableOption(\"rowClickPopup\", false);\n\t\tthis.registerTableOption(\"rowDblClickPopup\", false);\n\t\tthis.registerTableOption(\"groupContextPopup\", false);\n\t\tthis.registerTableOption(\"groupClickPopup\", false);\n\t\tthis.registerTableOption(\"groupDblClickPopup\", false);\n\t\t\n\t\tthis.registerColumnOption(\"headerContextPopup\");\n\t\tthis.registerColumnOption(\"headerClickPopup\");\n\t\tthis.registerColumnOption(\"headerDblClickPopup\");\n\t\tthis.registerColumnOption(\"headerPopup\");\n\t\tthis.registerColumnOption(\"headerPopupIcon\");\n\t\tthis.registerColumnOption(\"contextPopup\");\n\t\tthis.registerColumnOption(\"clickPopup\");\n\t\tthis.registerColumnOption(\"dblClickPopup\");\n\n\t\tthis.registerComponentFunction(\"cell\", \"popup\", this._componentPopupCall.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"popup\", this._componentPopupCall.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"popup\", this._componentPopupCall.bind(this));\n\t\tthis.registerComponentFunction(\"group\", \"popup\", this._componentPopupCall.bind(this));\n\t\t\n\t}\n\t\n\tinitialize(){\n\t\tthis.initializeRowWatchers();\n\t\tthis.initializeGroupWatchers();\n\t\t\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t}\n\n\t_componentPopupCall(component, contents, position){\n\t\tthis.loadPopupEvent(contents, null, component, position);\n\t}\n\t\n\tinitializeRowWatchers(){\n\t\tif(this.table.options.rowContextPopup){\n\t\t\tthis.subscribe(\"row-contextmenu\", this.loadPopupEvent.bind(this, this.table.options.rowContextPopup));\n\t\t\tthis.table.on(\"rowTapHold\", this.loadPopupEvent.bind(this, this.table.options.rowContextPopup));\n\t\t}\n\t\t\n\t\tif(this.table.options.rowClickPopup){\n\t\t\tthis.subscribe(\"row-click\", this.loadPopupEvent.bind(this, this.table.options.rowClickPopup));\n\t\t}\n\n\t\tif(this.table.options.rowDblClickPopup){\n\t\t\tthis.subscribe(\"row-dblclick\", this.loadPopupEvent.bind(this, this.table.options.rowDblClickPopup));\n\t\t}\n\t}\n\t\n\tinitializeGroupWatchers(){\n\t\tif(this.table.options.groupContextPopup){\n\t\t\tthis.subscribe(\"group-contextmenu\", this.loadPopupEvent.bind(this, this.table.options.groupContextPopup));\n\t\t\tthis.table.on(\"groupTapHold\", this.loadPopupEvent.bind(this, this.table.options.groupContextPopup));\n\t\t}\n\t\t\n\t\tif(this.table.options.groupClickPopup){\n\t\t\tthis.subscribe(\"group-click\", this.loadPopupEvent.bind(this, this.table.options.groupClickPopup));\n\t\t}\n\n\t\tif(this.table.options.groupDblClickPopup){\n\t\t\tthis.subscribe(\"group-dblclick\", this.loadPopupEvent.bind(this, this.table.options.groupDblClickPopup));\n\t\t}\n\t}\n\n\tinitializeColumn(column){\n\t\tvar def = column.definition;\n\t\t\n\t\t//handle column events\n\t\tif(def.headerContextPopup && !this.columnSubscribers.headerContextPopup){\n\t\t\tthis.columnSubscribers.headerContextPopup = this.loadPopupTableColumnEvent.bind(this, \"headerContextPopup\");\n\t\t\tthis.subscribe(\"column-contextmenu\", this.columnSubscribers.headerContextPopup);\n\t\t\tthis.table.on(\"headerTapHold\", this.loadPopupTableColumnEvent.bind(this, \"headerContextPopup\"));\n\t\t}\n\t\t\n\t\tif(def.headerClickPopup && !this.columnSubscribers.headerClickPopup){\n\t\t\tthis.columnSubscribers.headerClickPopup = this.loadPopupTableColumnEvent.bind(this, \"headerClickPopup\");\n\t\t\tthis.subscribe(\"column-click\", this.columnSubscribers.headerClickPopup);\n\t\t\n\t\t\n\t\t}if(def.headerDblClickPopup && !this.columnSubscribers.headerDblClickPopup){\n\t\t\tthis.columnSubscribers.headerDblClickPopup = this.loadPopupTableColumnEvent.bind(this, \"headerDblClickPopup\");\n\t\t\tthis.subscribe(\"column-dblclick\", this.columnSubscribers.headerDblClickPopup);\n\t\t}\n\t\t\n\t\tif(def.headerPopup){\n\t\t\tthis.initializeColumnHeaderPopup(column);\n\t\t}\n\t\t\n\t\t//handle cell events\n\t\tif(def.contextPopup && !this.columnSubscribers.contextPopup){\n\t\t\tthis.columnSubscribers.contextPopup = this.loadPopupTableCellEvent.bind(this, \"contextPopup\");\n\t\t\tthis.subscribe(\"cell-contextmenu\", this.columnSubscribers.contextPopup);\n\t\t\tthis.table.on(\"cellTapHold\", this.loadPopupTableCellEvent.bind(this, \"contextPopup\"));\n\t\t}\n\t\t\n\t\tif(def.clickPopup && !this.columnSubscribers.clickPopup){\n\t\t\tthis.columnSubscribers.clickPopup = this.loadPopupTableCellEvent.bind(this, \"clickPopup\");\n\t\t\tthis.subscribe(\"cell-click\", this.columnSubscribers.clickPopup);\n\t\t}\n\n\t\tif(def.dblClickPopup && !this.columnSubscribers.dblClickPopup){\n\t\t\tthis.columnSubscribers.dblClickPopup = this.loadPopupTableCellEvent.bind(this, \"dblClickPopup\");\n\t\t\tthis.subscribe(\"cell-click\", this.columnSubscribers.dblClickPopup);\n\t\t}\n\t}\n\t\n\tinitializeColumnHeaderPopup(column){\n\t\tvar icon = column.definition.headerPopupIcon,\n\t\theaderPopupEl;\n\t\t\n\t\theaderPopupEl = document.createElement(\"span\");\n\t\theaderPopupEl.classList.add(\"tabulator-header-popup-button\");\n\n\t\tif(icon){\n\t\t\tif(typeof icon === \"function\"){\n\t\t\t\ticon = icon(column.getComponent());\n\t\t\t}\n\n\t\t\tif(icon instanceof HTMLElement){\n\t\t\t\theaderPopupEl.appendChild(icon);\n\t\t\t}else {\n\t\t\t\theaderPopupEl.innerHTML = icon;\n\t\t\t}\n\t\t}else {\n\t\t\theaderPopupEl.innerHTML = \"&vellip;\";\n\t\t}\n\t\t\n\t\theaderPopupEl.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tthis.loadPopupEvent(column.definition.headerPopup, e, column);\n\t\t});\n\t\t\n\t\tcolumn.titleElement.insertBefore(headerPopupEl, column.titleElement.firstChild);\n\t}\n\t\n\tloadPopupTableCellEvent(option, e, cell){\n\t\tif(cell._cell){\n\t\t\tcell = cell._cell;\n\t\t}\n\t\t\n\t\tif(cell.column.definition[option]){\n\t\t\tthis.loadPopupEvent(cell.column.definition[option], e, cell);\n\t\t}\n\t}\n\t\n\tloadPopupTableColumnEvent(option, e, column){\n\t\tif(column._column){\n\t\t\tcolumn = column._column;\n\t\t}\n\t\t\n\t\tif(column.definition[option]){\n\t\t\tthis.loadPopupEvent(column.definition[option], e, column);\n\t\t}\n\t}\n\t\n\tloadPopupEvent(contents, e, component, position){\n\t\tvar renderedCallback;\n\n\t\tfunction onRendered(callback){\n\t\t\trenderedCallback = callback;\n\t\t}\n\t\t\n\t\tif(component._group){\n\t\t\tcomponent = component._group;\n\t\t}else if(component._row){\n\t\t\tcomponent = component._row;\n\t\t}\n\t\t\n\t\tcontents = typeof contents == \"function\" ? contents.call(this.table, e, component.getComponent(),  onRendered) : contents;\n\t\t\n\t\tthis.loadPopup(e, component, contents, renderedCallback, position);\n\t}\n\t\n\tloadPopup(e, component, contents, renderedCallback, position){\n\t\tvar touch = !(e instanceof MouseEvent),\n\t\tcontentsEl, popup;\n\t\t\n\t\tif(contents instanceof HTMLElement){\n\t\t\tcontentsEl = contents;\n\t\t}else {\n\t\t\tcontentsEl = document.createElement(\"div\");\n\t\t\tcontentsEl.innerHTML = contents;\n\t\t}\n\t\t\n\t\tcontentsEl.classList.add(\"tabulator-popup\");\n\n\t\tcontentsEl.addEventListener(\"click\", (e) =>{\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tif(!touch){\n\t\t\te.preventDefault();\n\t\t}\n\t\t\n\t\tpopup = this.popup(contentsEl);\n\n\t\tif(typeof renderedCallback === \"function\"){\n\t\t\tpopup.renderCallback(renderedCallback);\n\t\t}\n\n\t\tif(e){\n\t\t\tpopup.show(e);\n\t\t}else {\n\t\t\tpopup.show(component.getElement(), position || \"center\");\n\t\t}\n\n\t\t\n\t\tpopup.hideOnBlur(() => {\n\t\t\tthis.dispatchExternal(\"popupClosed\", component.getComponent());\n\t\t});\n\n\t\tthis.dispatchExternal(\"popupOpened\", component.getComponent());\n\t}\n}\n\nclass Print extends Module{\n\n\tstatic moduleName = \"print\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.element = false;\n\t\tthis.manualBlock = false;\n\t\tthis.beforeprintEventHandler = null;\n\t\tthis.afterprintEventHandler = null;\n\n\t\tthis.registerTableOption(\"printAsHtml\", false); //enable print as html\n\t\tthis.registerTableOption(\"printFormatter\", false); //printing page formatter\n\t\tthis.registerTableOption(\"printHeader\", false); //page header contents\n\t\tthis.registerTableOption(\"printFooter\", false); //page footer contents\n\t\tthis.registerTableOption(\"printStyled\", true); //enable print as html styling\n\t\tthis.registerTableOption(\"printRowRange\", \"visible\"); //restrict print to visible rows only\n\t\tthis.registerTableOption(\"printConfig\", {}); //print config options\n\n\t\tthis.registerColumnOption(\"print\");\n\t\tthis.registerColumnOption(\"titlePrint\");\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.printAsHtml){\n\t\t\tthis.beforeprintEventHandler = this.replaceTable.bind(this);\n\t\t\tthis.afterprintEventHandler = this.cleanup.bind(this);\n\n\t\t\twindow.addEventListener(\"beforeprint\", this.beforeprintEventHandler );\n\t\t\twindow.addEventListener(\"afterprint\", this.afterprintEventHandler);\n\t\t\tthis.subscribe(\"table-destroy\", this.destroy.bind(this));\n\t\t}\n\n\t\tthis.registerTableFunction(\"print\", this.printFullscreen.bind(this));\n\t}\n\n\tdestroy(){\n\t\tif(this.table.options.printAsHtml){\n\t\t\twindow.removeEventListener( \"beforeprint\", this.beforeprintEventHandler );\n\t\t\twindow.removeEventListener( \"afterprint\", this.afterprintEventHandler );\n\t\t}\n\t}\n\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\n\treplaceTable(){\n\t\tif(!this.manualBlock){\n\t\t\tthis.element = document.createElement(\"div\");\n\t\t\tthis.element.classList.add(\"tabulator-print-table\");\n\n\t\t\tthis.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig, this.table.options.printStyled, this.table.options.printRowRange, \"print\"));\n\n\t\t\tthis.table.element.style.display = \"none\";\n\n\t\t\tthis.table.element.parentNode.insertBefore(this.element, this.table.element);\n\t\t}\n\t}\n\n\tcleanup(){\n\t\tdocument.body.classList.remove(\"tabulator-print-fullscreen-hide\");\n\n\t\tif(this.element && this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\tthis.table.element.style.display = \"\";\n\t\t}\n\t}\n\n\tprintFullscreen(visible, style, config){\n\t\tvar scrollX = window.scrollX,\n\t\tscrollY = window.scrollY,\n\t\theaderEl = document.createElement(\"div\"),\n\t\tfooterEl = document.createElement(\"div\"),\n\t\ttableEl = this.table.modules.export.generateTable(typeof config != \"undefined\" ? config : this.table.options.printConfig, typeof style != \"undefined\" ? style : this.table.options.printStyled, visible || this.table.options.printRowRange, \"print\"),\n\t\theaderContent, footerContent;\n\n\t\tthis.manualBlock = true;\n\n\t\tthis.element = document.createElement(\"div\");\n\t\tthis.element.classList.add(\"tabulator-print-fullscreen\");\n\n\t\tif(this.table.options.printHeader){\n\t\t\theaderEl.classList.add(\"tabulator-print-header\");\n\n\t\t\theaderContent = typeof this.table.options.printHeader == \"function\" ? this.table.options.printHeader.call(this.table) : this.table.options.printHeader;\n\n\t\t\tif(typeof headerContent == \"string\"){\n\t\t\t\theaderEl.innerHTML = headerContent;\n\t\t\t}else {\n\t\t\t\theaderEl.appendChild(headerContent);\n\t\t\t}\n\n\t\t\tthis.element.appendChild(headerEl);\n\t\t}\n\n\t\tthis.element.appendChild(tableEl);\n\n\t\tif(this.table.options.printFooter){\n\t\t\tfooterEl.classList.add(\"tabulator-print-footer\");\n\n\t\t\tfooterContent = typeof this.table.options.printFooter == \"function\" ? this.table.options.printFooter.call(this.table) : this.table.options.printFooter;\n\n\n\t\t\tif(typeof footerContent == \"string\"){\n\t\t\t\tfooterEl.innerHTML = footerContent;\n\t\t\t}else {\n\t\t\t\tfooterEl.appendChild(footerContent);\n\t\t\t}\n\n\t\t\tthis.element.appendChild(footerEl);\n\t\t}\n\n\t\tdocument.body.classList.add(\"tabulator-print-fullscreen-hide\");\n\t\tdocument.body.appendChild(this.element);\n\n\t\tif(this.table.options.printFormatter){\n\t\t\tthis.table.options.printFormatter(this.element, tableEl);\n\t\t}\n\n\t\twindow.print();\n\n\t\tthis.cleanup();\n\n\t\twindow.scrollTo(scrollX, scrollY);\n\n\t\tthis.manualBlock = false;\n\t}\n}\n\nclass ReactiveData extends Module{\n\n\tstatic moduleName = \"reactiveData\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.data = false;\n\t\tthis.blocked = false; //block reactivity while performing update\n\t\tthis.origFuncs = {}; // hold original data array functions to allow replacement after data is done with\n\t\tthis.currentVersion = 0;\n\t\t\n\t\tthis.registerTableOption(\"reactiveData\", false); //enable data reactivity\n\t}\n\t\n\tinitialize(){\n\t\tif(this.table.options.reactiveData){\n\t\t\tthis.subscribe(\"cell-value-save-before\", this.block.bind(this, \"cellsave\"));\n\t\t\tthis.subscribe(\"cell-value-save-after\", this.unblock.bind(this, \"cellsave\"));\n\t\t\tthis.subscribe(\"row-data-save-before\", this.block.bind(this, \"rowsave\"));\n\t\t\tthis.subscribe(\"row-data-save-after\", this.unblock.bind(this, \"rowsave\"));\n\t\t\tthis.subscribe(\"row-data-init-after\", this.watchRow.bind(this));\n\t\t\tthis.subscribe(\"data-processing\", this.watchData.bind(this));\n\t\t\tthis.subscribe(\"table-destroy\", this.unwatchData.bind(this));\n\t\t}\n\t}\n\t\n\twatchData(data){\n\t\tvar self = this,\n\t\tversion;\n\t\t\n\t\tthis.currentVersion ++;\n\t\t\n\t\tversion = this.currentVersion;\n\t\t\n\t\tthis.unwatchData();\n\t\t\n\t\tthis.data = data;\n\t\t\n\t\t//override array push function\n\t\tthis.origFuncs.push = data.push;\n\t\t\n\t\tObject.defineProperty(this.data, \"push\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar args = Array.from(arguments),\n\t\t\t\tresult;\n\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\t\n\t\t\t\t\tself.block(\"data-push\");\n\n\t\t\t\t\targs.forEach((arg) => {\n\t\t\t\t\t\tself.table.rowManager.addRowActual(arg, false);\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tresult = self.origFuncs.push.apply(data, arguments);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"data-push\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t\t\n\t\t//override array unshift function\n\t\tthis.origFuncs.unshift = data.unshift;\n\t\t\n\t\tObject.defineProperty(this.data, \"unshift\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar args = Array.from(arguments),\n\t\t\t\tresult;\n\t\t\t\t\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"data-unshift\");\n\t\t\t\t\t\n\t\t\t\t\targs.forEach((arg) => {\n\t\t\t\t\t\tself.table.rowManager.addRowActual(arg, true);\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tresult = self.origFuncs.unshift.apply(data, arguments);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"data-unshift\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t\t\n\t\t\n\t\t//override array shift function\n\t\tthis.origFuncs.shift = data.shift;\n\t\t\n\t\tObject.defineProperty(this.data, \"shift\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar row, result;\n\t\t\t\t\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"data-shift\");\n\t\t\t\t\t\n\t\t\t\t\tif(self.data.length){\n\t\t\t\t\t\trow = self.table.rowManager.getRowFromDataObject(self.data[0]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(row){\n\t\t\t\t\t\t\trow.deleteActual();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = self.origFuncs.shift.call(data);\n\n\t\t\t\t\tself.unblock(\"data-shift\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t\t\n\t\t//override array pop function\n\t\tthis.origFuncs.pop = data.pop;\n\t\t\n\t\tObject.defineProperty(this.data, \"pop\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar row, result;\n\t\t\t\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"data-pop\");\n\t\t\t\t\t\n\t\t\t\t\tif(self.data.length){\n\t\t\t\t\t\trow = self.table.rowManager.getRowFromDataObject(self.data[self.data.length - 1]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(row){\n\t\t\t\t\t\t\trow.deleteActual();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = self.origFuncs.pop.call(data);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"data-pop\");\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t\t\n\t\t\n\t\t//override array splice function\n\t\tthis.origFuncs.splice = data.splice;\n\t\t\n\t\tObject.defineProperty(this.data, \"splice\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function(){\n\t\t\t\tvar args = Array.from(arguments),\n\t\t\t\tstart = args[0] < 0 ? data.length + args[0] : args[0],\n\t\t\t\tend = args[1],\n\t\t\t\tnewRows = args[2] ? args.slice(2) : false,\n\t\t\t\tstartRow, result;\n\t\t\t\t\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"data-splice\");\n\t\t\t\t\t//add new rows\n\t\t\t\t\tif(newRows){\n\t\t\t\t\t\tstartRow = data[start] ? self.table.rowManager.getRowFromDataObject(data[start]) : false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(startRow){\n\t\t\t\t\t\t\tnewRows.forEach((rowData) => {\n\t\t\t\t\t\t\t\tself.table.rowManager.addRowActual(rowData, true, startRow, true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tnewRows = newRows.slice().reverse();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tnewRows.forEach((rowData) => {\n\t\t\t\t\t\t\t\tself.table.rowManager.addRowActual(rowData, true, false, true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t//delete removed rows\n\t\t\t\t\tif(end !== 0){\n\t\t\t\t\t\tvar oldRows = data.slice(start, typeof args[1] === \"undefined\" ? args[1] : start + end);\n\t\t\t\t\t\t\n\t\t\t\t\t\toldRows.forEach((rowData, i) => {\n\t\t\t\t\t\t\tvar row = self.table.rowManager.getRowFromDataObject(rowData);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(row){\n\t\t\t\t\t\t\t\trow.deleteActual(i !== oldRows.length - 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(newRows || end !== 0){\n\t\t\t\t\t\tself.table.rowManager.reRenderInPosition();\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = self.origFuncs.splice.apply(data, arguments);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"data-splice\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn result ;\n\t\t\t}\n\t\t});\n\t}\n\t\n\tunwatchData(){\n\t\tif(this.data !== false){\n\t\t\tfor(var key in this.origFuncs){\n\t\t\t\tObject.defineProperty(this.data, key, {\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tconfigurable:true,\n\t\t\t\t\twritable:true,\n\t\t\t\t\tvalue: this.origFuncs.key,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\t\n\twatchRow(row){\n\t\tvar data = row.getData();\n\t\t\n\t\tfor(var key in data){\n\t\t\tthis.watchKey(row, data, key);\n\t\t}\n\t\t\n\t\tif(this.table.options.dataTree){\n\t\t\tthis.watchTreeChildren(row);\n\t\t}\n\t}\n\t\n\twatchTreeChildren (row){\n\t\tvar self = this,\n\t\tchildField = row.getData()[this.table.options.dataTreeChildField],\n\t\torigFuncs = {};\n\t\t\n\t\tif(childField){\n\t\t\t\n\t\t\torigFuncs.push = childField.push;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"push\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-push\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result = origFuncs.push.apply(childField, arguments);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-push\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\torigFuncs.unshift = childField.unshift;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"unshift\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-unshift\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result =  origFuncs.unshift.apply(childField, arguments);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-unshift\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\torigFuncs.shift = childField.shift;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"shift\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-shift\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result =  origFuncs.shift.call(childField);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-shift\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\torigFuncs.pop = childField.pop;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"pop\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-pop\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result =  origFuncs.pop.call(childField);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-pop\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\torigFuncs.splice = childField.splice;\n\t\t\t\n\t\t\tObject.defineProperty(childField, \"splice\", {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: () => {\n\t\t\t\t\tif(!self.blocked){\n\t\t\t\t\t\tself.block(\"tree-splice\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar result =  origFuncs.splice.apply(childField, arguments);\n\t\t\t\t\t\tthis.rebuildTree(row);\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.unblock(\"tree-splice\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\t\n\trebuildTree(row){\n\t\tthis.table.modules.dataTree.initializeRow(row);\n\t\tthis.table.modules.dataTree.layoutRow(row);\n\t\tthis.table.rowManager.refreshActiveData(\"tree\", false, true);\n\t}\n\t\n\twatchKey(row, data, key){\n\t\tvar self = this,\n\t\tprops = Object.getOwnPropertyDescriptor(data, key),\n\t\tvalue = data[key],\n\t\tversion = this.currentVersion;\n\t\t\n\t\tObject.defineProperty(data, key, {\n\t\t\tset: (newValue) => {\n\t\t\t\tvalue = newValue;\n\t\t\t\tif(!self.blocked && version === self.currentVersion){\n\t\t\t\t\tself.block(\"key\");\n\t\t\t\t\t\n\t\t\t\t\tvar update = {};\n\t\t\t\t\tupdate[key] = newValue;\n\t\t\t\t\trow.updateData(update);\n\t\t\t\t\t\n\t\t\t\t\tself.unblock(\"key\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(props.set){\n\t\t\t\t\tprops.set(newValue);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget:() => {\n\t\t\t\t\n\t\t\t\tif(props.get){\n\t\t\t\t\tprops.get();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn value;\n\t\t\t}\n\t\t});\n\t}\n\t\n\tunwatchRow(row){\n\t\tvar data = row.getData();\n\t\t\n\t\tfor(var key in data){\n\t\t\tObject.defineProperty(data, key, {\n\t\t\t\tvalue:data[key],\n\t\t\t});\n\t\t}\n\t}\n\t\n\tblock(key){\n\t\tif(!this.blocked){\n\t\t\tthis.blocked = key;\n\t\t}\n\t}\n\t\n\tunblock(key){\n\t\tif(this.blocked === key){\n\t\t\tthis.blocked = false;\n\t\t}\n\t}\n}\n\nclass ResizeColumns extends Module{\n\n\tstatic moduleName = \"resizeColumns\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.startColumn = false;\n\t\tthis.startX = false;\n\t\tthis.startWidth = false;\n\t\tthis.latestX = false;\n\t\tthis.handle = null;\n\t\tthis.initialNextColumn = null;\n\t\tthis.nextColumn = null;\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.registerColumnOption(\"resizable\", true);\n\t\tthis.registerTableOption(\"resizableColumnFit\", false);\n\t\tthis.registerTableOption(\"resizableColumnGuide\", false);\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"column-rendered\", this.layoutColumnHeader.bind(this));\n\t}\n\t\n\tinitializeEventWatchers(){\n\t\tif(!this.initialized){\n\t\t\t\n\t\t\tthis.subscribe(\"cell-rendered\", this.layoutCellHandles.bind(this));\n\t\t\tthis.subscribe(\"cell-delete\", this.deInitializeComponent.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"cell-height\", this.resizeHandle.bind(this));\n\t\t\tthis.subscribe(\"column-moved\", this.columnLayoutUpdated.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"column-hide\", this.deInitializeColumn.bind(this));\n\t\t\tthis.subscribe(\"column-show\", this.columnLayoutUpdated.bind(this));\n\t\t\tthis.subscribe(\"column-width\", this.columnWidthUpdated.bind(this));\n\t\t\t\n\t\t\tthis.subscribe(\"column-delete\", this.deInitializeComponent.bind(this));\n\t\t\tthis.subscribe(\"column-height\", this.resizeHandle.bind(this));\n\t\t\t\n\t\t\tthis.initialized = true;\n\t\t}\n\t}\n\t\n\t\n\tlayoutCellHandles(cell){\n\t\tif(cell.row.type === \"row\"){\n\t\t\tthis.deInitializeComponent(cell);\n\t\t\tthis.initializeColumn(\"cell\", cell, cell.column, cell.element);\n\t\t}\n\t}\n\t\n\tlayoutColumnHeader(column){\n\t\tif(column.definition.resizable){\n\t\t\tthis.initializeEventWatchers();\n\t\t\tthis.deInitializeComponent(column);\n\t\t\tthis.initializeColumn(\"header\", column, column, column.element);\n\t\t}\n\t}\n\t\n\tcolumnLayoutUpdated(column){\n\t\tvar prev = column.prevColumn();\n\t\t\n\t\tthis.reinitializeColumn(column);\n\t\t\n\t\tif(prev){\n\t\t\tthis.reinitializeColumn(prev);\n\t\t}\n\t}\n\t\n\tcolumnWidthUpdated(column){\n\t\tif(column.modules.frozen){\n\t\t\tif(this.table.modules.frozenColumns.leftColumns.includes(column)){\n\t\t\t\tthis.table.modules.frozenColumns.leftColumns.forEach((col) => {\n\t\t\t\t\tthis.reinitializeColumn(col);\n\t\t\t\t});\n\t\t\t}else if(this.table.modules.frozenColumns.rightColumns.includes(column)){\n\t\t\t\tthis.table.modules.frozenColumns.rightColumns.forEach((col) => {\n\t\t\t\t\tthis.reinitializeColumn(col);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tfrozenColumnOffset(column){\n\t\tvar offset = false;\n\n\t\tif(column.modules.frozen){\n\t\t\toffset = column.modules.frozen.marginValue; \n\n\t\t\tif(column.modules.frozen.position === \"left\"){\n\t\t\t\toffset += column.getWidth() - 3;\n\t\t\t}else {\n\t\t\t\tif(offset){\n\t\t\t\t\toffset -= 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn offset !== false ? offset + \"px\" : false;\n\t}\n\t\n\treinitializeColumn(column){\n\t\tvar frozenOffset = this.frozenColumnOffset(column);\n\t\t\n\t\tcolumn.cells.forEach((cell) => {\n\t\t\tif(cell.modules.resize && cell.modules.resize.handleEl){\n\t\t\t\tif(frozenOffset){\n\t\t\t\t\tcell.modules.resize.handleEl.style[column.modules.frozen.position] = frozenOffset;\n\t\t\t\t\tcell.modules.resize.handleEl.style[\"z-index\"] = 11;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcell.element.after(cell.modules.resize.handleEl);\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(column.modules.resize && column.modules.resize.handleEl){\n\t\t\tif(frozenOffset){\n\t\t\t\tcolumn.modules.resize.handleEl.style[column.modules.frozen.position] = frozenOffset;\n\t\t\t}\n\t\t\t\n\t\t\tcolumn.element.after(column.modules.resize.handleEl);\n\t\t}\n\t}\n\t\n\tinitializeColumn(type, component, column, element){\n\t\tvar self = this,\n\t\tvariableHeight = false,\n\t\tmode = column.definition.resizable,\n\t\tconfig = {},\n\t\tnearestColumn = column.getLastColumn();\n\t\t\n\t\t//set column resize mode\n\t\tif(type === \"header\"){\n\t\t\tvariableHeight = column.definition.formatter == \"textarea\" || column.definition.variableHeight;\n\t\t\tconfig = {variableHeight:variableHeight};\n\t\t}\n\t\t\n\t\tif((mode === true || mode == type) && this._checkResizability(nearestColumn)){\n\t\t\t\n\t\t\tvar handle = document.createElement('span');\n\t\t\thandle.className = \"tabulator-col-resize-handle\";\n\t\t\t\n\t\t\thandle.addEventListener(\"click\", function(e){\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t\t\n\t\t\tvar handleDown = function(e){\n\t\t\t\tself.startColumn = column;\n\t\t\t\tself.initialNextColumn = self.nextColumn = nearestColumn.nextColumn();\n\t\t\t\tself._mouseDown(e, nearestColumn, handle);\n\t\t\t};\n\t\t\t\n\t\t\thandle.addEventListener(\"mousedown\", handleDown);\n\t\t\thandle.addEventListener(\"touchstart\", handleDown, {passive: true});\n\t\t\t\n\t\t\t//resize column on  double click\n\t\t\thandle.addEventListener(\"dblclick\", (e) => {\n\t\t\t\tvar oldWidth = nearestColumn.getWidth();\n\t\t\t\t\n\t\t\t\te.stopPropagation();\n\t\t\t\tnearestColumn.reinitializeWidth(true);\n\t\t\t\t\n\t\t\t\tif(oldWidth !== nearestColumn.getWidth()){\n\t\t\t\t\tself.dispatch(\"column-resized\", nearestColumn);\n\t\t\t\t\tself.dispatchExternal(\"columnResized\", nearestColumn.getComponent());\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(column.modules.frozen){\n\t\t\t\thandle.style.position = \"sticky\";\n\t\t\t\thandle.style[column.modules.frozen.position] = this.frozenColumnOffset(column);\n\t\t\t}\n\t\t\t\n\t\t\tconfig.handleEl = handle;\n\t\t\t\n\t\t\tif(element.parentNode && column.visible){\n\t\t\t\telement.after(handle);\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tcomponent.modules.resize = config;\n\t}\n\t\n\tdeInitializeColumn(column){\n\t\tthis.deInitializeComponent(column);\n\t\t\n\t\tcolumn.cells.forEach((cell) => {\n\t\t\tthis.deInitializeComponent(cell);\n\t\t});\n\t}\n\t\n\tdeInitializeComponent(component){\n\t\tvar handleEl;\n\t\t\n\t\tif(component.modules.resize){\n\t\t\thandleEl = component.modules.resize.handleEl;\n\t\t\t\n\t\t\tif(handleEl && handleEl.parentElement){\n\t\t\t\thandleEl.parentElement.removeChild(handleEl);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tresizeHandle(component, height){\n\t\tif(component.modules.resize && component.modules.resize.handleEl){\n\t\t\tcomponent.modules.resize.handleEl.style.height = height;\n\t\t}\n\t}\n\t\n\tresize(e, column){\n\t\tvar x = typeof e.clientX === \"undefined\" ? e.touches[0].clientX : e.clientX,\n\t\tstartDiff = x - this.startX,\n\t\tmoveDiff = x - this.latestX,\n\t\tblockedBefore, blockedAfter;\n\n\t\tthis.latestX = x;\n\n\t\tif(this.table.rtl){\n\t\t\tstartDiff = -startDiff;\n\t\t\tmoveDiff = -moveDiff;\n\t\t}\n\n\t\tblockedBefore = column.width == column.minWidth || column.width == column.maxWidth;\n\n\t\tcolumn.setWidth(this.startWidth + startDiff);\n\n\t\tblockedAfter = column.width == column.minWidth || column.width == column.maxWidth;\n\n\t\tif(moveDiff < 0){\n\t\t\tthis.nextColumn = this.initialNextColumn;\n\t\t}\n\n\t\tif(this.table.options.resizableColumnFit && this.nextColumn && !(blockedBefore && blockedAfter)){\n\t\t\tlet colWidth = this.nextColumn.getWidth();\n\n\t\t\tif(moveDiff > 0){\n\t\t\t\tif(colWidth <= this.nextColumn.minWidth){\n\t\t\t\t\tthis.nextColumn = this.nextColumn.nextColumn();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.nextColumn){\n\t\t\t\tthis.nextColumn.setWidth(this.nextColumn.getWidth() - moveDiff);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.columnManager.rerenderColumns(true);\n\n\t\tif(!this.table.browserSlow && column.modules.resize && column.modules.resize.variableHeight){\n\t\t\tcolumn.checkCellHeights();\n\t\t}\n\t}\n\n\tcalcGuidePosition(e, column, handle) {\n\t\tvar mouseX = typeof e.clientX === \"undefined\" ? e.touches[0].clientX : e.clientX,\n\t\thandleX = handle.getBoundingClientRect().x - this.table.element.getBoundingClientRect().x,\n\t\ttableX = this.table.element.getBoundingClientRect().x,\n\t\tcolumnX = column.element.getBoundingClientRect().left - tableX,\n\t\tmouseDiff = mouseX - this.startX,\n\t\tpos = Math.max(handleX + mouseDiff, columnX + column.minWidth);\n\n\t\tif(column.maxWidth){\n\t\t\tpos = Math.min(pos, columnX + column.maxWidth);\n\t\t}\n\n\t\treturn pos;\n\t}\n\n\t_checkResizability(column){\n\t\treturn column.definition.resizable;\n\t}\n\t\n\t_mouseDown(e, column, handle){\n\t\tvar self = this,\n\t\tguideEl;\n\n\t\tthis.dispatchExternal(\"columnResizing\", column.getComponent());\n\n\t\tif(self.table.options.resizableColumnGuide){\n\t\t\tguideEl = document.createElement(\"span\");\n\t\t\tguideEl.classList.add('tabulator-col-resize-guide');\n\t\t\tself.table.element.appendChild(guideEl);\n\t\t\tsetTimeout(() => {\n\t\t\t\tguideEl.style.left = self.calcGuidePosition(e, column, handle) + \"px\";\n\t\t\t});\n\t\t}\n\n\t\tself.table.element.classList.add(\"tabulator-block-select\");\n\n\t\tfunction mouseMove(e){\n\t\t\tif(self.table.options.resizableColumnGuide){\n\t\t\t\tguideEl.style.left = self.calcGuidePosition(e, column, handle) + \"px\";\n\t\t\t}else {\n\t\t\t\tself.resize(e, column);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction mouseUp(e){\n\t\t\tif(self.table.options.resizableColumnGuide){\n\t\t\t\tself.resize(e, column);\n\t\t\t\tguideEl.remove();\n\t\t\t}\n\t\t\t\n\t\t\t//block editor from taking action while resizing is taking place\n\t\t\tif(self.startColumn.modules.edit){\n\t\t\t\tself.startColumn.modules.edit.blocked = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(self.table.browserSlow && column.modules.resize && column.modules.resize.variableHeight){\n\t\t\t\tcolumn.checkCellHeights();\n\t\t\t}\n\t\t\t\n\t\t\tdocument.body.removeEventListener(\"mouseup\", mouseUp);\n\t\t\tdocument.body.removeEventListener(\"mousemove\", mouseMove);\n\t\t\t\n\t\t\thandle.removeEventListener(\"touchmove\", mouseMove);\n\t\t\thandle.removeEventListener(\"touchend\", mouseUp);\n\t\t\t\n\t\t\tself.table.element.classList.remove(\"tabulator-block-select\");\n\t\t\t\n\t\t\tif(self.startWidth !== column.getWidth()){\n\t\t\t\tself.table.columnManager.verticalAlignHeaders();\n\n\t\t\t\tself.dispatch(\"column-resized\", column);\n\t\t\t\tself.dispatchExternal(\"columnResized\", column.getComponent());\n\t\t\t}\n\t\t}\n\t\t\n\t\te.stopPropagation(); //prevent resize from interfering with movable columns\n\t\t\n\t\t//block editor from taking action while resizing is taking place\n\t\tif(self.startColumn.modules.edit){\n\t\t\tself.startColumn.modules.edit.blocked = true;\n\t\t}\n\t\t\n\t\tself.startX = typeof e.clientX === \"undefined\" ? e.touches[0].clientX : e.clientX;\n\t\tself.latestX = self.startX;\n\t\tself.startWidth = column.getWidth();\n\t\t\n\t\tdocument.body.addEventListener(\"mousemove\", mouseMove);\n\t\tdocument.body.addEventListener(\"mouseup\", mouseUp);\n\t\thandle.addEventListener(\"touchmove\", mouseMove, {passive: true});\n\t\thandle.addEventListener(\"touchend\", mouseUp);\n\t}\n}\n\nclass ResizeRows extends Module{\n\n\tstatic moduleName = \"resizeRows\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.startColumn = false;\n\t\tthis.startY = false;\n\t\tthis.startHeight = false;\n\t\tthis.handle = null;\n\t\tthis.prevHandle = null;\n\n\t\tthis.registerTableOption(\"resizableRows\", false); //resizable rows\n\t\tthis.registerTableOption(\"resizableRowGuide\", false);\n\t}\n\n\tinitialize(){\n\t\tif(this.table.options.resizableRows){\n\t\t\tthis.subscribe(\"row-layout-after\", this.initializeRow.bind(this));\n\t\t}\n\t}\n\n\tinitializeRow(row){\n\t\tvar self = this,\n\t\trowEl = row.getElement();\n\n\t\tvar handle = document.createElement('div');\n\t\thandle.className = \"tabulator-row-resize-handle\";\n\n\t\tvar prevHandle = document.createElement('div');\n\t\tprevHandle.className = \"tabulator-row-resize-handle prev\";\n\n\t\thandle.addEventListener(\"click\", function(e){\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tvar handleDown = function(e){\n\t\t\tself.startRow = row;\n\t\t\tself._mouseDown(e, row, handle);\n\t\t};\n\n\t\thandle.addEventListener(\"mousedown\", handleDown);\n\t\thandle.addEventListener(\"touchstart\", handleDown, {passive: true});\n\n\t\tprevHandle.addEventListener(\"click\", function(e){\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tvar prevHandleDown =  function(e){\n\t\t\tvar prevRow = self.table.rowManager.prevDisplayRow(row);\n\n\t\t\tif(prevRow){\n\t\t\t\tself.startRow = prevRow;\n\t\t\t\tself._mouseDown(e, prevRow, prevHandle);\n\t\t\t}\n\t\t};\n\n\t\tprevHandle.addEventListener(\"mousedown\",prevHandleDown);\n\t\tprevHandle.addEventListener(\"touchstart\",prevHandleDown, {passive: true});\n\n\t\trowEl.appendChild(handle);\n\t\trowEl.appendChild(prevHandle);\n\t}\n\n\tresize(e, row) {\n\t\trow.setHeight(this.startHeight + ((typeof e.screenY === \"undefined\" ? e.touches[0].screenY : e.screenY) - this.startY));\n\t}\n\n\tcalcGuidePosition(e, row, handle) {\n\t\tvar mouseY = typeof e.screenY === \"undefined\" ? e.touches[0].screenY : e.screenY,\n\t\thandleY = handle.getBoundingClientRect().y - this.table.element.getBoundingClientRect().y,\n\t\ttableY = this.table.element.getBoundingClientRect().y,\n\t\trowY = row.element.getBoundingClientRect().top - tableY,\n\t\tmouseDiff = mouseY - this.startY;\n\n\t\treturn Math.max(handleY + mouseDiff, rowY);\n\t}\n\n\t_mouseDown(e, row, handle){\n\t\tvar self = this,\n\t\tguideEl;\n\n\t\tself.dispatchExternal(\"rowResizing\", row.getComponent());\n\n\t\tif(self.table.options.resizableRowGuide){\n\t\t\tguideEl = document.createElement(\"span\");\n\t\t\tguideEl.classList.add('tabulator-row-resize-guide');\n\t\t\tself.table.element.appendChild(guideEl);\n\t\t\tsetTimeout(() => {\n\t\t\t\tguideEl.style.top = self.calcGuidePosition(e, row, handle) + \"px\";\n\t\t\t});\n\t\t}\n\n\t\tself.table.element.classList.add(\"tabulator-block-select\");\n\n\t\tfunction mouseMove(e){\n\t\t\tif(self.table.options.resizableRowGuide){\n\t\t\t\tguideEl.style.top = self.calcGuidePosition(e, row, handle) + \"px\";\n\t\t\t}else {\n\t\t\t\tself.resize(e, row);\n\t\t\t}\n\t\t}\n\n\t\tfunction mouseUp(e){\n\t\t\tif(self.table.options.resizableRowGuide){\n\t\t\t\tself.resize(e, row);\n\t\t\t\tguideEl.remove();\n\t\t\t}\n\n\t\t\t// //block editor from taking action while resizing is taking place\n\t\t\t// if(self.startColumn.modules.edit){\n\t\t\t// \tself.startColumn.modules.edit.blocked = false;\n\t\t\t// }\n\n\t\t\tdocument.body.removeEventListener(\"mouseup\", mouseMove);\n\t\t\tdocument.body.removeEventListener(\"mousemove\", mouseMove);\n\n\t\t\thandle.removeEventListener(\"touchmove\", mouseMove);\n\t\t\thandle.removeEventListener(\"touchend\", mouseUp);\n\n\t\t\tself.table.element.classList.remove(\"tabulator-block-select\");\n\n\t\t\tself.dispatchExternal(\"rowResized\", row.getComponent());\n\t\t}\n\n\t\te.stopPropagation(); //prevent resize from interfering with movable columns\n\n\t\t//block editor from taking action while resizing is taking place\n\t\t// if(self.startColumn.modules.edit){\n\t\t// \tself.startColumn.modules.edit.blocked = true;\n\t\t// }\n\n\t\tself.startY = typeof e.screenY === \"undefined\" ? e.touches[0].screenY : e.screenY;\n\t\tself.startHeight = row.getHeight();\n\n\t\tdocument.body.addEventListener(\"mousemove\", mouseMove);\n\t\tdocument.body.addEventListener(\"mouseup\", mouseUp);\n\n\t\thandle.addEventListener(\"touchmove\", mouseMove, {passive: true});\n\t\thandle.addEventListener(\"touchend\", mouseUp);\n\t}\n}\n\nclass ResizeTable extends Module{\n\n\tstatic moduleName = \"resizeTable\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.binding = false;\n\t\tthis.visibilityObserver = false;\n\t\tthis.resizeObserver = false;\n\t\tthis.containerObserver = false;\n\t\t\n\t\tthis.tableHeight = 0;\n\t\tthis.tableWidth = 0;\n\t\tthis.containerHeight = 0;\n\t\tthis.containerWidth = 0;\n\t\t\n\t\tthis.autoResize = false;\n\t\t\n\t\tthis.visible = false;\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.initialRedraw = false;\n\t\t\n\t\tthis.registerTableOption(\"autoResize\", true); //auto resize table\n\t}\n\t\n\tinitialize(){\n\t\tif(this.table.options.autoResize){\n\t\t\tvar table = this.table,\n\t\t\ttableStyle;\n\t\t\t\n\t\t\tthis.tableHeight = table.element.clientHeight;\n\t\t\tthis.tableWidth = table.element.clientWidth;\n\t\t\t\n\t\t\tif(table.element.parentNode){\n\t\t\t\tthis.containerHeight = table.element.parentNode.clientHeight;\n\t\t\t\tthis.containerWidth = table.element.parentNode.clientWidth;\n\t\t\t}\n\t\t\t\n\t\t\tif(typeof IntersectionObserver !== \"undefined\" && typeof ResizeObserver !== \"undefined\" && table.rowManager.getRenderMode() === \"virtual\"){\n\t\t\t\t\n\t\t\t\tthis.initializeVisibilityObserver();\n\t\t\t\t\n\t\t\t\tthis.autoResize = true;\n\t\t\t\t\n\t\t\t\tthis.resizeObserver = new ResizeObserver((entry) => {\n\t\t\t\t\tif(!table.browserMobile || (table.browserMobile && (!table.modules.edit || (table.modules.edit && !table.modules.edit.currentCell)))){\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar nodeHeight = Math.floor(entry[0].contentRect.height);\n\t\t\t\t\t\tvar nodeWidth = Math.floor(entry[0].contentRect.width);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.tableHeight != nodeHeight || this.tableWidth != nodeWidth){\n\t\t\t\t\t\t\tthis.tableHeight = nodeHeight;\n\t\t\t\t\t\t\tthis.tableWidth = nodeWidth;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(table.element.parentNode){\n\t\t\t\t\t\t\t\tthis.containerHeight = table.element.parentNode.clientHeight;\n\t\t\t\t\t\t\t\tthis.containerWidth = table.element.parentNode.clientWidth;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tthis.redrawTable();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.resizeObserver.observe(table.element);\n\t\t\t\t\n\t\t\t\ttableStyle = window.getComputedStyle(table.element);\n\t\t\t\t\n\t\t\t\tif(this.table.element.parentNode && !this.table.rowManager.fixedHeight && (tableStyle.getPropertyValue(\"max-height\") || tableStyle.getPropertyValue(\"min-height\"))){\n\t\t\t\t\t\n\t\t\t\t\tthis.containerObserver = new ResizeObserver((entry) => {\n\t\t\t\t\t\tif(!table.browserMobile || (table.browserMobile && (!table.modules.edit || (table.modules.edit && !table.modules.edit.currentCell)))){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar nodeHeight = Math.floor(entry[0].contentRect.height);\n\t\t\t\t\t\t\tvar nodeWidth = Math.floor(entry[0].contentRect.width);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(this.containerHeight != nodeHeight || this.containerWidth != nodeWidth){\n\t\t\t\t\t\t\t\tthis.containerHeight = nodeHeight;\n\t\t\t\t\t\t\t\tthis.containerWidth = nodeWidth;\n\t\t\t\t\t\t\t\tthis.tableHeight = table.element.clientHeight;\n\t\t\t\t\t\t\t\tthis.tableWidth = table.element.clientWidth;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tthis.redrawTable();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.containerObserver.observe(this.table.element.parentNode);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.subscribe(\"table-resize\", this.tableResized.bind(this));\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tthis.binding = function(){\n\t\t\t\t\tif(!table.browserMobile || (table.browserMobile && (!table.modules.edit || (table.modules.edit && !table.modules.edit.currentCell)))){\n\t\t\t\t\t\ttable.columnManager.rerenderColumns(true);\n\t\t\t\t\t\ttable.redraw();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\twindow.addEventListener(\"resize\", this.binding);\n\t\t\t}\n\t\t\t\n\t\t\tthis.subscribe(\"table-destroy\", this.clearBindings.bind(this));\n\t\t}\n\t}\n\t\n\tinitializeVisibilityObserver(){\n\t\tthis.visibilityObserver = new IntersectionObserver((entries) => {\n\t\t\tthis.visible = entries[0].isIntersecting;\n\t\t\t\n\t\t\tif(!this.initialized){\n\t\t\t\tthis.initialized = true;\n\t\t\t\tthis.initialRedraw = !this.visible;\n\t\t\t}else {\n\t\t\t\tif(this.visible){\n\t\t\t\t\tthis.redrawTable(this.initialRedraw);\n\t\t\t\t\tthis.initialRedraw = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.visibilityObserver.observe(this.table.element);\n\t}\n\t\n\tredrawTable(force){\n\t\tif(this.initialized && this.visible){\n\t\t\tthis.table.columnManager.rerenderColumns(true);\n\t\t\tthis.table.redraw(force);\n\t\t}\n\t}\n\t\n\ttableResized(){\n\t\tthis.table.rowManager.redraw();\n\t}\n\t\n\tclearBindings(){\n\t\tif(this.binding){\n\t\t\twindow.removeEventListener(\"resize\", this.binding);\n\t\t}\n\t\t\n\t\tif(this.resizeObserver){\n\t\t\tthis.resizeObserver.unobserve(this.table.element);\n\t\t}\n\t\t\n\t\tif(this.visibilityObserver){\n\t\t\tthis.visibilityObserver.unobserve(this.table.element);\n\t\t}\n\t\t\n\t\tif(this.containerObserver){\n\t\t\tthis.containerObserver.unobserve(this.table.element.parentNode);\n\t\t}\n\t}\n}\n\nfunction responsiveCollapse(cell, formatterParams, onRendered){\n\tvar el = document.createElement(\"div\"),\n\tconfig = cell.getRow()._row.modules.responsiveLayout;\n\n\tel.classList.add(\"tabulator-responsive-collapse-toggle\");\n\t\n\tel.innerHTML = `<svg class='tabulator-responsive-collapse-toggle-open' viewbox=\"0 0 24 24\">\n  <line x1=\"7\" y1=\"12\" x2=\"17\" y2=\"12\" fill=\"none\" stroke-width=\"3\" stroke-linecap=\"round\" />\n  <line y1=\"7\" x1=\"12\" y2=\"17\" x2=\"12\" fill=\"none\" stroke-width=\"3\" stroke-linecap=\"round\" />\n</svg>\n\n<svg class='tabulator-responsive-collapse-toggle-close' viewbox=\"0 0 24 24\">\n  <line x1=\"7\" y1=\"12\" x2=\"17\" y2=\"12\"  fill=\"none\" stroke-width=\"3\" stroke-linecap=\"round\" />\n</svg>`;\n\n\tcell.getElement().classList.add(\"tabulator-row-handle\");\n\n\tfunction toggleList(isOpen){\n\t\tvar collapseEl = config.element;\n\n\t\tconfig.open = isOpen;\n\n\t\tif(collapseEl){\n\n\t\t\tif(config.open){\n\t\t\t\tel.classList.add(\"open\");\n\t\t\t\tcollapseEl.style.display = '';\n\t\t\t}else {\n\t\t\t\tel.classList.remove(\"open\");\n\t\t\t\tcollapseEl.style.display = 'none';\n\t\t\t}\n\t\t}\n\t}\n\n\tel.addEventListener(\"click\", function(e){\n\t\te.stopImmediatePropagation();\n\t\ttoggleList(!config.open);\n\t\tcell.getTable().rowManager.adjustTableSize();\n\t});\n\n\ttoggleList(config.open);\n\n\treturn el;\n}\n\nvar extensions$2 = {\r\n\tformat:{\r\n\t\tformatters:{\r\n\t\t\tresponsiveCollapse:responsiveCollapse,\r\n\t\t}\r\n\t}\r\n};\n\nclass ResponsiveLayout extends Module{\n\n\tstatic moduleName = \"responsiveLayout\";\n\tstatic moduleExtensions = extensions$2;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.columns = [];\n\t\tthis.hiddenColumns = [];\n\t\tthis.mode = \"\";\n\t\tthis.index = 0;\n\t\tthis.collapseFormatter = [];\n\t\tthis.collapseStartOpen = true;\n\t\tthis.collapseHandleColumn = false;\n\n\t\tthis.registerTableOption(\"responsiveLayout\", false); //responsive layout flags\n\t\tthis.registerTableOption(\"responsiveLayoutCollapseStartOpen\", true); //start showing collapsed data\n\t\tthis.registerTableOption(\"responsiveLayoutCollapseUseFormatters\", true); //responsive layout collapse formatter\n\t\tthis.registerTableOption(\"responsiveLayoutCollapseFormatter\", false); //responsive layout collapse formatter\n\n\t\tthis.registerColumnOption(\"responsive\");\n\t}\n\n\t//generate responsive columns list\n\tinitialize(){\n\t\tif(this.table.options.responsiveLayout){\n\t\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\t\tthis.subscribe(\"column-show\", this.updateColumnVisibility.bind(this));\n\t\t\tthis.subscribe(\"column-hide\", this.updateColumnVisibility.bind(this));\n\t\t\tthis.subscribe(\"columns-loaded\", this.initializeResponsivity.bind(this));\n\t\t\tthis.subscribe(\"column-moved\", this.initializeResponsivity.bind(this));\n\t\t\tthis.subscribe(\"column-add\", this.initializeResponsivity.bind(this));\n\t\t\tthis.subscribe(\"column-delete\", this.initializeResponsivity.bind(this));\n\n\t\t\tthis.subscribe(\"table-redrawing\", this.tableRedraw.bind(this));\n\t\t\t\n\t\t\tif(this.table.options.responsiveLayout === \"collapse\"){\n\t\t\t\tthis.subscribe(\"row-data-changed\", this.generateCollapsedRowContent.bind(this));\n\t\t\t\tthis.subscribe(\"row-init\", this.initializeRow.bind(this));\n\t\t\t\tthis.subscribe(\"row-layout\", this.layoutRow.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\ttableRedraw(force){\n\t\tif([\"fitColumns\", \"fitDataStretch\"].indexOf(this.layoutMode()) === -1){\n\t\t\tif(!force){\n\t\t\t\tthis.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tinitializeResponsivity(){\n\t\tvar columns = [];\n\n\t\tthis.mode = this.table.options.responsiveLayout;\n\t\tthis.collapseFormatter = this.table.options.responsiveLayoutCollapseFormatter || this.formatCollapsedData;\n\t\tthis.collapseStartOpen = this.table.options.responsiveLayoutCollapseStartOpen;\n\t\tthis.hiddenColumns = [];\n\n\t\tif(this.collapseFormatter){\n\t\t\tthis.collapseFormatter = this.collapseFormatter.bind(this.table);\n\t\t}\n\n\t\t//determine level of responsivity for each column\n\t\tthis.table.columnManager.columnsByIndex.forEach((column, i) => {\n\t\t\tif(column.modules.responsive){\n\t\t\t\tif(column.modules.responsive.order && column.modules.responsive.visible){\n\t\t\t\t\tcolumn.modules.responsive.index = i;\n\t\t\t\t\tcolumns.push(column);\n\n\t\t\t\t\tif(!column.visible && this.mode === \"collapse\"){\n\t\t\t\t\t\tthis.hiddenColumns.push(column);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t//sort list by responsivity\n\t\tcolumns = columns.reverse();\n\t\tcolumns = columns.sort((a, b) => {\n\t\t\tvar diff = b.modules.responsive.order - a.modules.responsive.order;\n\t\t\treturn diff || (b.modules.responsive.index - a.modules.responsive.index);\n\t\t});\n\n\t\tthis.columns = columns;\n\n\t\tif(this.mode === \"collapse\"){\n\t\t\tthis.generateCollapsedContent();\n\t\t}\n\n\t\t//assign collapse column\n\t\tfor (let col of this.table.columnManager.columnsByIndex){\n\t\t\tif(col.definition.formatter == \"responsiveCollapse\"){\n\t\t\t\tthis.collapseHandleColumn = col;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(this.collapseHandleColumn){\n\t\t\tif(this.hiddenColumns.length){\n\t\t\t\tthis.collapseHandleColumn.show();\n\t\t\t}else {\n\t\t\t\tthis.collapseHandleColumn.hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t//define layout information\n\tinitializeColumn(column){\n\t\tvar def = column.getDefinition();\n\n\t\tcolumn.modules.responsive = {order: typeof def.responsive === \"undefined\" ? 1 : def.responsive, visible:def.visible === false ? false : true};\n\t}\n\n\tinitializeRow(row){\n\t\tvar el;\n\n\t\tif(row.type !== \"calc\"){\n\t\t\tel = document.createElement(\"div\");\n\t\t\tel.classList.add(\"tabulator-responsive-collapse\");\n\n\t\t\trow.modules.responsiveLayout = {\n\t\t\t\telement:el,\n\t\t\t\topen:this.collapseStartOpen,\n\t\t\t};\n\n\t\t\tif(!this.collapseStartOpen){\n\t\t\t\tel.style.display = 'none';\n\t\t\t}\n\t\t}\n\t}\n\n\tlayoutRow(row){\n\t\tvar rowEl = row.getElement();\n\n\t\tif(row.modules.responsiveLayout){\n\t\t\trowEl.appendChild(row.modules.responsiveLayout.element);\n\t\t\tthis.generateCollapsedRowContent(row);\n\t\t}\n\t}\n\n\t//update column visibility\n\tupdateColumnVisibility(column, responsiveToggle){\n\t\tif(!responsiveToggle && column.modules.responsive){\n\t\t\tcolumn.modules.responsive.visible = column.visible;\n\t\t\tthis.initializeResponsivity();\n\t\t}\n\t}\n\n\thideColumn(column){\n\t\tvar colCount = this.hiddenColumns.length;\n\n\t\tcolumn.hide(false, true);\n\n\t\tif(this.mode === \"collapse\"){\n\t\t\tthis.hiddenColumns.unshift(column);\n\t\t\tthis.generateCollapsedContent();\n\n\t\t\tif(this.collapseHandleColumn && !colCount){\n\t\t\t\tthis.collapseHandleColumn.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tshowColumn(column){\n\t\tvar index;\n\n\t\tcolumn.show(false, true);\n\t\t//set column width to prevent calculation loops on uninitialized columns\n\t\tcolumn.setWidth(column.getWidth());\n\n\t\tif(this.mode === \"collapse\"){\n\t\t\tindex = this.hiddenColumns.indexOf(column);\n\n\t\t\tif(index > -1){\n\t\t\t\tthis.hiddenColumns.splice(index, 1);\n\t\t\t}\n\n\t\t\tthis.generateCollapsedContent();\n\n\t\t\tif(this.collapseHandleColumn && !this.hiddenColumns.length){\n\t\t\t\tthis.collapseHandleColumn.hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t//redraw columns to fit space\n\tupdate(){\n\t\tvar working = true;\n\n\t\twhile(working){\n\n\t\t\tlet width = this.table.modules.layout.getMode() == \"fitColumns\" ? this.table.columnManager.getFlexBaseWidth() : this.table.columnManager.getWidth();\n\n\t\t\tlet diff = (this.table.options.headerVisible ? this.table.columnManager.element.clientWidth : this.table.element.clientWidth) - width;\n\n\t\t\tif(diff < 0){\n\t\t\t\t//table is too wide\n\t\t\t\tlet column = this.columns[this.index];\n\n\t\t\t\tif(column){\n\t\t\t\t\tthis.hideColumn(column);\n\t\t\t\t\tthis.index ++;\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\n\t\t\t}else {\n\n\t\t\t\t//table has spare space\n\t\t\t\tlet column = this.columns[this.index -1];\n\n\t\t\t\tif(column){\n\t\t\t\t\tif(diff > 0){\n\t\t\t\t\t\tif(diff >= column.getWidth()){\n\t\t\t\t\t\t\tthis.showColumn(column);\n\t\t\t\t\t\t\tthis.index --;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tworking = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tworking = false;\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!this.table.rowManager.activeRowsCount){\n\t\t\t\tthis.table.rowManager.renderEmptyScroll();\n\t\t\t}\n\t\t}\n\t}\n\n\tgenerateCollapsedContent(){\n\t\tvar rows = this.table.rowManager.getDisplayRows();\n\n\t\trows.forEach((row) => {\n\t\t\tthis.generateCollapsedRowContent(row);\n\t\t});\n\t}\n\n\tgenerateCollapsedRowContent(row){\n\t\tvar el, contents;\n\n\t\tif(row.modules.responsiveLayout){\n\t\t\tel = row.modules.responsiveLayout.element;\n\n\t\t\twhile(el.firstChild) el.removeChild(el.firstChild);\n\n\t\t\tcontents = this.collapseFormatter(this.generateCollapsedRowData(row));\n\t\t\tif(contents){\n\t\t\t\tel.appendChild(contents);\n\t\t\t}\n\t\t\trow.calcHeight(true);\n\t\t}\n\t}\n\n\tgenerateCollapsedRowData(row){\n\t\tvar data = row.getData(),\n\t\toutput = [],\n\t\tmockCellComponent;\n\n\t\tthis.hiddenColumns.forEach((column) => {\n\t\t\tvar value = column.getFieldValue(data);\n\n\t\t\tif(column.definition.title && column.field){\n\t\t\t\tif(column.modules.format && this.table.options.responsiveLayoutCollapseUseFormatters){\n\n\t\t\t\t\tmockCellComponent = {\n\t\t\t\t\t\tvalue:false,\n\t\t\t\t\t\tdata:{},\n\t\t\t\t\t\tgetValue:function(){\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetData:function(){\n\t\t\t\t\t\t\treturn data;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetType:function(){\n\t\t\t\t\t\t\treturn \"cell\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetElement:function(){\n\t\t\t\t\t\t\treturn document.createElement(\"div\");\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetRow:function(){\n\t\t\t\t\t\t\treturn row.getComponent();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetColumn:function(){\n\t\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetTable:() => {\n\t\t\t\t\t\t\treturn this.table;\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\tfunction onRendered(callback){\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push({\n\t\t\t\t\t\tfield: column.field,\n\t\t\t\t\t\ttitle: column.definition.title,\n\t\t\t\t\t\tvalue: column.modules.format.formatter.call(this.table.modules.format, mockCellComponent, column.modules.format.params, onRendered)\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\toutput.push({\n\t\t\t\t\t\tfield: column.field,\n\t\t\t\t\t\ttitle: column.definition.title,\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn output;\n\t}\n\n\tformatCollapsedData(data){\n\t\tvar list = document.createElement(\"table\");\n\n\t\tdata.forEach((item) => {\n\t\t\tvar row = document.createElement(\"tr\");\n\t\t\tvar titleData = document.createElement(\"td\");\n\t\t\tvar valueData = document.createElement(\"td\");\n\t\t\tvar node_content;\n\n\t\t\tvar titleHighlight = document.createElement(\"strong\");\n\t\t\ttitleData.appendChild(titleHighlight);\n\t\t\t\n\t\t\tthis.modules.localize.bind(\"columns|\" + item.field, function(text){\n\t\t\t\ttitleHighlight.innerHTML = text || item.title;\n\t\t\t});\n\n\t\t\tif(item.value instanceof Node){\n\t\t\t\tnode_content = document.createElement(\"div\");\n\t\t\t\tnode_content.appendChild(item.value);\n\t\t\t\tvalueData.appendChild(node_content);\n\t\t\t}else {\n\t\t\t\tvalueData.innerHTML = item.value;\n\t\t\t}\n\n\t\t\trow.appendChild(titleData);\n\t\t\trow.appendChild(valueData);\n\t\t\tlist.appendChild(row);\n\t\t});\n\n\t\treturn Object.keys(data).length ? list : \"\";\n\t}\n}\n\nfunction rowSelection(cell, formatterParams, onRendered){\n\tvar checkbox = document.createElement(\"input\");\n\tvar blocked = false;\n\n\tcheckbox.type = 'checkbox';\n\n\tcheckbox.setAttribute(\"aria-label\", \"Select Row\");\n\t\n\tif(this.table.modExists(\"selectRow\", true)){\n\n\t\tcheckbox.addEventListener(\"click\", (e) => {\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tif(typeof cell.getRow == 'function'){\n\t\t\tvar row = cell.getRow();\n\n\t\t\tif(row instanceof RowComponent){\n\n\t\t\t\tcheckbox.addEventListener(\"change\", (e) => {\n\t\t\t\t\tif(this.table.options.selectableRowsRangeMode === \"click\"){\n\t\t\t\t\t\tif(!blocked){\n\t\t\t\t\t\t\trow.toggleSelect();\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tblocked = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\trow.toggleSelect();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(this.table.options.selectableRowsRangeMode === \"click\"){\n\t\t\t\t\tcheckbox.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\tblocked = true;\n\t\t\t\t\t\tthis.table.modules.selectRow.handleComplexRowClick(row._row, e);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tcheckbox.checked = row.isSelected && row.isSelected();\n\t\t\t\tthis.table.modules.selectRow.registerRowSelectCheckbox(row, checkbox);\n\t\t\t}else {\n\t\t\t\tcheckbox = \"\";\n\t\t\t}\n\t\t}else {\n\t\t\tcheckbox.addEventListener(\"change\", (e) => {\n\t\t\t\tif(this.table.modules.selectRow.selectedRows.length){\n\t\t\t\t\tthis.table.deselectRow();\n\t\t\t\t}else {\n\t\t\t\t\tthis.table.selectRow(formatterParams.rowRange);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.table.modules.selectRow.registerHeaderSelectCheckbox(checkbox);\n\t\t}\n\t}\n\n\treturn checkbox;\n}\n\nvar extensions$1 = {\r\n\tformat:{\r\n\t\tformatters:{\r\n\t\t\trowSelection:rowSelection,\r\n\t\t}\r\n\t}\r\n};\n\nclass SelectRow extends Module{\n\n\tstatic moduleName = \"selectRow\";\n\tstatic moduleExtensions = extensions$1;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.selecting = false; //flag selecting in progress\n\t\tthis.lastClickedRow = false; //last clicked row\n\t\tthis.selectPrev = []; //hold previously selected element for drag drop selection\n\t\tthis.selectedRows = []; //hold selected rows\n\t\tthis.headerCheckboxElement = null; // hold header select element\n\t\t\n\t\tthis.registerTableOption(\"selectableRows\", \"highlight\"); //highlight rows on hover\n\t\tthis.registerTableOption(\"selectableRowsRangeMode\", \"drag\");  //highlight rows on hover\n\t\tthis.registerTableOption(\"selectableRowsRollingSelection\", true); //roll selection once maximum number of selectable rows is reached\n\t\tthis.registerTableOption(\"selectableRowsPersistence\", true); // maintain selection when table view is updated\n\t\tthis.registerTableOption(\"selectableRowsCheck\", function(data, row){return true;}); //check whether row is selectable\n\t\t\n\t\tthis.registerTableFunction(\"selectRow\", this.selectRows.bind(this));\n\t\tthis.registerTableFunction(\"deselectRow\", this.deselectRows.bind(this));\n\t\tthis.registerTableFunction(\"toggleSelectRow\", this.toggleRow.bind(this));\n\t\tthis.registerTableFunction(\"getSelectedRows\", this.getSelectedRows.bind(this));\n\t\tthis.registerTableFunction(\"getSelectedData\", this.getSelectedData.bind(this));\n\t\t\n\t\t//register component functions\n\t\tthis.registerComponentFunction(\"row\", \"select\", this.selectRows.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"deselect\", this.deselectRows.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"toggleSelect\", this.toggleRow.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"isSelected\", this.isRowSelected.bind(this));\n\t}\n\t\n\tinitialize(){\n\n\t\tthis.deprecatedOptionsCheck();\n\n\t\tif(this.table.options.selectableRows === \"highlight\" && this.table.options.selectableRange){\n\t\t\tthis.table.options.selectableRows = false;\n\t\t}\n\n\t\tif(this.table.options.selectableRows !== false){\n\t\t\tthis.subscribe(\"row-init\", this.initializeRow.bind(this));\n\t\t\tthis.subscribe(\"row-deleting\", this.rowDeleted.bind(this));\n\t\t\tthis.subscribe(\"rows-wipe\", this.clearSelectionData.bind(this));\n\t\t\tthis.subscribe(\"rows-retrieve\", this.rowRetrieve.bind(this));\n\t\t\t\n\t\t\tif(this.table.options.selectableRows && !this.table.options.selectableRowsPersistence){\n\t\t\t\tthis.subscribe(\"data-refreshing\", this.deselectRows.bind(this));\n\t\t\t}\n\t\t}\n\t}\n\n\tdeprecatedOptionsCheck(){\n\t\t// this.deprecationCheck(\"selectable\", \"selectableRows\", true);\n\t\t// this.deprecationCheck(\"selectableRollingSelection\", \"selectableRowsRollingSelection\", true);\n\t\t// this.deprecationCheck(\"selectableRangeMode\", \"selectableRowsRangeMode\", true);\n\t\t// this.deprecationCheck(\"selectablePersistence\", \"selectableRowsPersistence\", true);\n\t\t// this.deprecationCheck(\"selectableCheck\", \"selectableRowsCheck\", true);\n\t}\n\t\n\trowRetrieve(type, prevValue){\n\t\treturn type === \"selected\" ? this.selectedRows : prevValue;\n\t}\n\t\n\trowDeleted(row){\n\t\tthis._deselectRow(row, true);\n\t}\n\t\n\tclearSelectionData(silent){\n\t\tvar prevSelected = this.selectedRows.length;\n\n\t\tthis.selecting = false;\n\t\tthis.lastClickedRow = false;\n\t\tthis.selectPrev = [];\n\t\tthis.selectedRows = [];\n\t\t\n\t\tif(prevSelected && silent !== true){\n\t\t\tthis._rowSelectionChanged();\n\t\t}\n\t}\n\t\n\tinitializeRow(row){\n\t\tvar self = this,\n\t\tselectable = self.checkRowSelectability(row),\n\t\telement = row.getElement();\n\t\t\n\t\t// trigger end of row selection\n\t\tvar endSelect = function(){\n\t\t\t\n\t\t\tsetTimeout(function(){\n\t\t\t\tself.selecting = false;\n\t\t\t}, 50);\n\t\t\t\n\t\t\tdocument.body.removeEventListener(\"mouseup\", endSelect);\n\t\t};\n\t\t\n\t\trow.modules.select = {selected:false};\n\n\t\telement.classList.toggle(\"tabulator-selectable\", selectable);\n\t\telement.classList.toggle(\"tabulator-unselectable\", !selectable);\n\t\t\n\t\t//set row selection class\n\t\tif(self.checkRowSelectability(row)){\t\t\t\n\t\t\tif(self.table.options.selectableRows && self.table.options.selectableRows != \"highlight\"){\n\t\t\t\tif(self.table.options.selectableRowsRangeMode === \"click\"){\n\t\t\t\t\telement.addEventListener(\"click\", this.handleComplexRowClick.bind(this, row));\n\t\t\t\t}else {\n\t\t\t\t\telement.addEventListener(\"click\", function(e){\n\t\t\t\t\t\tif(!self.table.modExists(\"edit\") || !self.table.modules.edit.getCurrentCell()){\n\t\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(!self.selecting){\n\t\t\t\t\t\t\tself.toggleRow(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\telement.addEventListener(\"mousedown\", function(e){\n\t\t\t\t\t\tif(e.shiftKey){\n\t\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tself.selecting = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tself.selectPrev = [];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdocument.body.addEventListener(\"mouseup\", endSelect);\n\t\t\t\t\t\t\tdocument.body.addEventListener(\"keyup\", endSelect);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tself.toggleRow(row);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\telement.addEventListener(\"mouseenter\", function(e){\n\t\t\t\t\t\tif(self.selecting){\n\t\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\t\tself.toggleRow(row);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(self.selectPrev[1] == row){\n\t\t\t\t\t\t\t\tself.toggleRow(self.selectPrev[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\telement.addEventListener(\"mouseout\", function(e){\n\t\t\t\t\t\tif(self.selecting){\n\t\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\t\tself.selectPrev.unshift(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\thandleComplexRowClick(row, e){\n\t\tif(e.shiftKey){\n\t\t\tthis.table._clearSelection();\n\t\t\tthis.lastClickedRow = this.lastClickedRow || row;\n\t\t\t\n\t\t\tvar lastClickedRowIdx = this.table.rowManager.getDisplayRowIndex(this.lastClickedRow);\n\t\t\tvar rowIdx = this.table.rowManager.getDisplayRowIndex(row);\n\t\t\t\n\t\t\tvar fromRowIdx = lastClickedRowIdx <= rowIdx ? lastClickedRowIdx : rowIdx;\n\t\t\tvar toRowIdx = lastClickedRowIdx >= rowIdx ? lastClickedRowIdx : rowIdx;\n\t\t\t\n\t\t\tvar rows = this.table.rowManager.getDisplayRows().slice(0);\n\t\t\tvar toggledRows = rows.splice(fromRowIdx, toRowIdx - fromRowIdx + 1);\n\t\t\t\n\t\t\tif(e.ctrlKey || e.metaKey){\n\t\t\t\ttoggledRows.forEach((toggledRow)=>{\n\t\t\t\t\tif(toggledRow !== this.lastClickedRow){\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.table.options.selectableRows !== true && !this.isRowSelected(row)){\n\t\t\t\t\t\t\tif(this.selectedRows.length < this.table.options.selectableRows){\n\t\t\t\t\t\t\t\tthis.toggleRow(toggledRow);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tthis.toggleRow(toggledRow);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.lastClickedRow = row;\n\t\t\t}else {\n\t\t\t\tthis.deselectRows(undefined, true);\n\t\t\t\t\n\t\t\t\tif(this.table.options.selectableRows !== true){\n\t\t\t\t\tif(toggledRows.length > this.table.options.selectableRows){\n\t\t\t\t\t\ttoggledRows = toggledRows.slice(0, this.table.options.selectableRows);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.selectRows(toggledRows);\n\t\t\t}\n\t\t\tthis.table._clearSelection();\n\t\t}\n\t\telse if(e.ctrlKey || e.metaKey){\n\t\t\tthis.toggleRow(row);\n\t\t\tthis.lastClickedRow = row;\n\t\t}else {\n\t\t\tthis.deselectRows(undefined, true);\n\t\t\tthis.selectRows(row);\n\t\t\tthis.lastClickedRow = row;\n\t\t}\n\t}\n\n\tcheckRowSelectability(row){\n\t\tif(row && row.type === \"row\"){\n\t\t\treturn this.table.options.selectableRowsCheck.call(this.table, row.getComponent());\n\t\t}\n\n\t\treturn false;\n\t}\n\t\n\t//toggle row selection\n\ttoggleRow(row){\n\t\tif(this.checkRowSelectability(row)){\n\t\t\tif(row.modules.select && row.modules.select.selected){\n\t\t\t\tthis._deselectRow(row);\n\t\t\t}else {\n\t\t\t\tthis._selectRow(row);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//select a number of rows\n\tselectRows(rows){\n\t\tvar changes = [], \n\t\trowMatch, change;\n\t\t\n\t\tswitch(typeof rows){\n\t\t\tcase \"undefined\":\n\t\t\t\trowMatch = this.table.rowManager.rows;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"number\":\n\t\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase \"string\":\n\t\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\t\t\t\n\t\t\t\tif(!rowMatch){\n\t\t\t\t\trowMatch = this.table.rowManager.getRows(rows);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\trowMatch = rows;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif(Array.isArray(rowMatch)){\n\t\t\tif(rowMatch.length){\n\t\t\t\trowMatch.forEach((row) => {\n\t\t\t\t\tchange = this._selectRow(row, true, true);\n\n\t\t\t\t\tif(change){\n\t\t\t\t\t\tchanges.push(change);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis._rowSelectionChanged(false, changes);\n\t\t\t}\n\t\t}else {\n\t\t\tif(rowMatch){\n\t\t\t\tthis._selectRow(rowMatch, false, true);\n\t\t\t}\n\t\t}\t\n\t}\n\t\n\t//select an individual row\n\t_selectRow(rowInfo, silent, force){\n\t\t//handle max row count\n\t\tif(!isNaN(this.table.options.selectableRows) && this.table.options.selectableRows !== true && !force){\n\t\t\tif(this.selectedRows.length >= this.table.options.selectableRows){\n\t\t\t\tif(this.table.options.selectableRowsRollingSelection){\n\t\t\t\t\tthis._deselectRow(this.selectedRows[0]);\n\t\t\t\t}else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar row = this.table.rowManager.findRow(rowInfo);\n\t\t\n\t\tif(row){\n\t\t\tif(this.selectedRows.indexOf(row) == -1){\n\t\t\t\trow.getElement().classList.add(\"tabulator-selected\");\n\t\t\t\tif(!row.modules.select){\n\t\t\t\t\trow.modules.select = {};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trow.modules.select.selected = true;\n\t\t\t\tif(row.modules.select.checkboxEl){\n\t\t\t\t\trow.modules.select.checkboxEl.checked = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.selectedRows.push(row);\n\t\t\t\t\n\t\t\t\tif(this.table.options.dataTreeSelectPropagate){\n\t\t\t\t\tthis.childRowSelection(row, true);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.dispatchExternal(\"rowSelected\", row.getComponent());\n\t\t\t\t\n\t\t\t\tthis._rowSelectionChanged(silent, row);\n\n\t\t\t\treturn row;\n\t\t\t}\n\t\t}else {\n\t\t\tif(!silent){\n\t\t\t\tconsole.warn(\"Selection Error - No such row found, ignoring selection:\" + rowInfo);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tisRowSelected(row){\n\t\treturn this.selectedRows.indexOf(row) !== -1;\n\t}\n\t\n\t//deselect a number of rows\n\tdeselectRows(rows, silent){\n\t\tvar changes = [], \n\t\trowMatch, change;\n\t\t\n\t\tswitch(typeof rows){\n\t\t\tcase \"undefined\":\n\t\t\t\trowMatch = Object.assign([], this.selectedRows);\n\t\t\t\tbreak;\n\n\t\t\tcase \"number\":\n\t\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"string\":\n\t\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\t\t\t\n\t\t\t\tif(!rowMatch){\n\t\t\t\t\trowMatch = this.table.rowManager.getRows(rows);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\trowMatch = rows;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif(Array.isArray(rowMatch)){\n\t\t\tif(rowMatch.length){\n\t\t\t\trowMatch.forEach((row) => {\n\t\t\t\t\tchange = this._deselectRow(row, true, true);\n\n\t\t\t\t\tif(change){\n\t\t\t\t\t\tchanges.push(change);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis._rowSelectionChanged(silent, [], changes);\n\t\t\t}\n\t\t}else {\n\t\t\tif(rowMatch){\n\t\t\t\tthis._deselectRow(rowMatch, silent, true);\n\t\t\t}\n\t\t}\t\n\t}\n\t\n\t//deselect an individual row\n\t_deselectRow(rowInfo, silent){\n\t\tvar self = this,\n\t\trow = self.table.rowManager.findRow(rowInfo),\n\t\tindex, element;\n\t\t\n\t\tif(row){\n\t\t\tindex = self.selectedRows.findIndex(function(selectedRow){\n\t\t\t\treturn selectedRow == row;\n\t\t\t});\n\t\t\t\n\t\t\tif(index > -1){\n\n\t\t\t\telement = row.getElement();\n\t\t\t\t\n\t\t\t\tif(element){\n\t\t\t\t\telement.classList.remove(\"tabulator-selected\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(!row.modules.select){\n\t\t\t\t\trow.modules.select = {};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trow.modules.select.selected = false;\n\t\t\t\tif(row.modules.select.checkboxEl){\n\t\t\t\t\trow.modules.select.checkboxEl.checked = false;\n\t\t\t\t}\n\t\t\t\tself.selectedRows.splice(index, 1);\n\t\t\t\t\n\t\t\t\tif(this.table.options.dataTreeSelectPropagate){\n\t\t\t\t\tthis.childRowSelection(row, false);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.dispatchExternal(\"rowDeselected\", row.getComponent());\n\t\t\t\t\n\t\t\t\tself._rowSelectionChanged(silent, undefined, row);\n\n\t\t\t\treturn row;\n\t\t\t}\n\t\t}else {\n\t\t\tif(!silent){\n\t\t\t\tconsole.warn(\"Deselection Error - No such row found, ignoring selection:\" + rowInfo);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tgetSelectedData(){\n\t\tvar data = [];\n\t\t\n\t\tthis.selectedRows.forEach(function(row){\n\t\t\tdata.push(row.getData());\n\t\t});\n\t\t\n\t\treturn data;\n\t}\n\t\n\tgetSelectedRows(){\n\t\tvar rows = [];\n\t\t\n\t\tthis.selectedRows.forEach(function(row){\n\t\t\trows.push(row.getComponent());\n\t\t});\n\t\t\n\t\treturn rows;\n\t}\n\t\n\t_rowSelectionChanged(silent, selected = [], deselected = []){\n\t\tif(this.headerCheckboxElement){\n\t\t\tif(this.selectedRows.length === 0){\n\t\t\t\tthis.headerCheckboxElement.checked = false;\n\t\t\t\tthis.headerCheckboxElement.indeterminate = false;\n\t\t\t} else if(this.table.rowManager.rows.length === this.selectedRows.length){\n\t\t\t\tthis.headerCheckboxElement.checked = true;\n\t\t\t\tthis.headerCheckboxElement.indeterminate = false;\n\t\t\t} else {\n\t\t\t\tthis.headerCheckboxElement.indeterminate = true;\n\t\t\t\tthis.headerCheckboxElement.checked = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(!silent){\n\t\t\tif(!Array.isArray(selected)){\n\t\t\t\tselected = [selected];\n\t\t\t}\n\n\t\t\tselected = selected.map(row => row.getComponent());\n\n\t\t\tif(!Array.isArray(deselected)){\n\t\t\t\tdeselected = [deselected];\n\t\t\t}\n\n\t\t\tdeselected = deselected.map(row => row.getComponent());\n\n\t\t\tthis.dispatchExternal(\"rowSelectionChanged\", this.getSelectedData(), this.getSelectedRows(), selected, deselected);\n\t\t}\n\t}\n\t\n\tregisterRowSelectCheckbox (row, element) {\n\t\tif(!row._row.modules.select){\n\t\t\trow._row.modules.select = {};\n\t\t}\n\t\t\n\t\trow._row.modules.select.checkboxEl = element;\n\t}\n\t\n\tregisterHeaderSelectCheckbox (element) {\n\t\tthis.headerCheckboxElement = element;\n\t}\n\t\n\tchildRowSelection(row, select){\n\t\tvar children = this.table.modules.dataTree.getChildren(row, true, true);\n\t\t\n\t\tif(select){\n\t\t\tfor(let child of children){\n\t\t\t\tthis._selectRow(child, true);\n\t\t\t}\n\t\t}else {\n\t\t\tfor(let child of children){\n\t\t\t\tthis._deselectRow(child, true);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass RangeComponent {\n\tconstructor(range) {\n\t\tthis._range = range;\n\n\t\treturn new Proxy(this, {\n\t\t\tget: function (target, name, receiver) {\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\n\t\t\t\t\treturn target[name];\n\t\t\t\t} else {\n\t\t\t\t\treturn target._range.table.componentFunctionBinder.handle(\"range\", target._range, name);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\tgetElement() {\n\t\treturn this._range.element;\n\t}\n\n\tgetData() {\n\t\treturn this._range.getData();\n\t}\n\n\tgetCells() {\n\t\treturn this._range.getCells(true, true);\n\t}\n\n\tgetStructuredCells() {\n\t\treturn this._range.getStructuredCells();\n\t}\n\n\tgetRows() {\n\t\treturn this._range.getRows().map((row) => row.getComponent());\n\t}\n\n\tgetColumns() {\n\t\treturn this._range.getColumns().map((column) => column.getComponent());\n\t}\n\t\n\tgetBounds() {\n\t\treturn this._range.getBounds();\n\t}\n\n\tgetTopEdge() {\n\t\treturn this._range.top;\n\t}\n\n\tgetBottomEdge() {\n\t\treturn this._range.bottom;\n\t}\n\n\tgetLeftEdge() {\n\t\treturn this._range.left;\n\t}\n\n\tgetRightEdge() {\n\t\treturn this._range.right;\n\t}\n\n\tsetBounds(start, end){\n\t\tif(this._range.destroyedGuard(\"setBounds\")){\n\t\t\tthis._range.setBounds(start ? start._cell : start, end ? end._cell : end);\n\t\t}\n\t}\n\n\tsetStartBound(start){\n\t\tif(this._range.destroyedGuard(\"setStartBound\")){\n\t\t\tthis._range.setEndBound(start ? start._cell : start);\n\t\t\tthis._range.rangeManager.layoutElement();\n\t\t}\n\t}\n\n\tsetEndBound(end){\n\t\tif(this._range.destroyedGuard(\"setEndBound\")){\n\t\t\tthis._range.setEndBound(end ? end._cell : end);\n\t\t\tthis._range.rangeManager.layoutElement();\n\t\t}\n\t}\n\n\tclearValues(){\n\t\tif(this._range.destroyedGuard(\"clearValues\")){\n\t\t\tthis._range.clearValues();\n\t\t}\n\t}\n\n\tremove(){\n\t\tif(this._range.destroyedGuard(\"remove\")){\n\t\t\tthis._range.destroy(true);\n\t\t}\n\t}\n}\n\nclass Range extends CoreFeature{\n\tconstructor(table, rangeManager, start, end) {\n\t\tsuper(table);\n\t\t\n\t\tthis.rangeManager = rangeManager;\n\t\tthis.element = null;\n\t\tthis.initialized = false;\n\t\tthis.initializing = {\n\t\t\tstart:false,\n\t\t\tend:false,\n\t\t};\n\t\tthis.destroyed = false;\n\t\t\n\t\tthis.top = 0;\n\t\tthis.bottom = 0;\n\t\tthis.left = 0;\n\t\tthis.right = 0;\n\t\t\n\t\tthis.table = table;\n\t\tthis.start = {row:0, col:0};\n\t\tthis.end = {row:0, col:0};\n\n\t\tif(this.rangeManager.rowHeader){\n\t\t\tthis.left = 1;\n\t\t\tthis.right = 1;\n\t\t\tthis.start.col = 1;\n\t\t\tthis.end.col = 1;\n\t\t}\n\t\t\n\t\tthis.initElement();\n\t\t\n\t\tsetTimeout(() => {\n\t\t\tthis.initBounds(start, end);\n\t\t});\n\t}\n\t\n\tinitElement(){\n\t\tthis.element = document.createElement(\"div\");\n\t\tthis.element.classList.add(\"tabulator-range\");\n\t}\n\t\n\tinitBounds(start, end){\n\t\tthis._updateMinMax();\n\t\t\n\t\tif(start){\n\t\t\tthis.setBounds(start, end || start);\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t///////   Boundary Setup    ///////\n\t///////////////////////////////////\n\t\n\tsetStart(row, col) {\n\t\tif(this.start.row !== row || this.start.col !== col){\n\t\t\tthis.start.row = row;\n\t\t\tthis.start.col = col;\n\t\t\t\n\t\t\tthis.initializing.start = true;\n\t\t\tthis._updateMinMax();\n\t\t}\n\t}\n\t\n\tsetEnd(row, col) {\n\t\tif(this.end.row !== row || this.end.col !== col){\n\t\t\tthis.end.row = row;\n\t\t\tthis.end.col = col;\n\t\t\t\n\t\t\tthis.initializing.end = true;\n\t\t\tthis._updateMinMax();\n\t\t}\n\t}\n\t\n\tsetBounds(start, end, visibleRows){\n\t\tif(start){\n\t\t\tthis.setStartBound(start);\n\t\t}\n\t\t\n\t\tthis.setEndBound(end || start);\n\t\tthis.rangeManager.layoutElement(visibleRows);\n\t}\n\t\n\tsetStartBound(element){\n\t\tvar row, col;\n\t\t\n\t\tif (element.type === \"column\") {\n\t\t\tif(this.rangeManager.columnSelection){\n\t\t\t\tthis.setStart(0, element.getPosition() - 1);\n\t\t\t}\n\t\t}else {\n\t\t\trow = element.row.position - 1;\n\t\t\tcol = element.column.getPosition() - 1;\n\t\t\t\n\t\t\tif (element.column === this.rangeManager.rowHeader) {\n\t\t\t\tthis.setStart(row, 1);\n\t\t\t} else {\n\t\t\t\tthis.setStart(row, col);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tsetEndBound(element){\n\t\tvar rowsCount = this._getTableRows().length,\n\t\trow, col, isRowHeader;\n\t\t\n\t\tif (element.type === \"column\") {\n\t\t\tif(this.rangeManager.columnSelection){\n\t\t\t\tif (this.rangeManager.selecting === \"column\") {\n\t\t\t\t\tthis.setEnd(rowsCount - 1, element.getPosition() - 1);\n\t\t\t\t} else if (this.rangeManager.selecting === \"cell\") {\n\t\t\t\t\tthis.setEnd(0, element.getPosition() - 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\trow = element.row.position - 1;\n\t\t\tcol = element.column.getPosition() - 1;\n\t\t\tisRowHeader = element.column === this.rangeManager.rowHeader;\n\t\t\t\n\t\t\tif (this.rangeManager.selecting === \"row\") {\n\t\t\t\tthis.setEnd(row, this._getTableColumns().length - 1);\n\t\t\t} else if (this.rangeManager.selecting !== \"row\" && isRowHeader) {\n\t\t\t\tthis.setEnd(row, 0);\n\t\t\t} else if (this.rangeManager.selecting === \"column\") {\n\t\t\t\tthis.setEnd(rowsCount - 1, col);\n\t\t\t} else {\n\t\t\t\tthis.setEnd(row, col);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_updateMinMax() {\n\t\tthis.top = Math.min(this.start.row, this.end.row);\n\t\tthis.bottom = Math.max(this.start.row, this.end.row);\n\t\tthis.left = Math.min(this.start.col, this.end.col);\n\t\tthis.right = Math.max(this.start.col, this.end.col);\n\t\t\n\t\tif(this.initialized){\n\t\t\tthis.dispatchExternal(\"rangeChanged\", this.getComponent());\n\t\t}else {\n\t\t\tif(this.initializing.start && this.initializing.end){\n\t\t\t\tthis.initialized = true;\n\t\t\t\tthis.dispatchExternal(\"rangeAdded\", this.getComponent());\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_getTableColumns() {\n\t\treturn this.table.columnManager.getVisibleColumnsByIndex();\n\t}\n\t\n\t_getTableRows() {\n\t\treturn this.table.rowManager.getDisplayRows().filter(row=> row.type === \"row\");\n\t}\n\t\n\t///////////////////////////////////\n\t///////      Rendering      ///////\n\t///////////////////////////////////\n\t\n\tlayout() {\n\t\tvar _vDomTop = this.table.rowManager.renderer.vDomTop,\n\t\t_vDomBottom = this.table.rowManager.renderer.vDomBottom,\n\t\t_vDomLeft = this.table.columnManager.renderer.leftCol,\n\t\t_vDomRight = this.table.columnManager.renderer.rightCol,\t\t\n\t\ttop, bottom, left, right, topLeftCell, bottomRightCell, topLeftCellEl, bottomRightCellEl, topLeftRowEl, bottomRightRowEl;\n\n\t\tif(this.table.options.renderHorizontal === \"virtual\" && this.rangeManager.rowHeader) {\n\t\t\t_vDomRight += 1;\n\t\t}\n\t\t\n\t\tif (_vDomTop == null) {\n\t\t\t_vDomTop = 0;\n\t\t}\n\t\t\n\t\tif (_vDomBottom == null) {\n\t\t\t_vDomBottom = Infinity;\n\t\t}\n\t\t\n\t\tif (_vDomLeft == null) {\n\t\t\t_vDomLeft = 0;\n\t\t}\n\t\t\n\t\tif (_vDomRight == null) {\n\t\t\t_vDomRight = Infinity;\n\t\t}\n\t\t\n\t\tif (this.overlaps(_vDomLeft, _vDomTop, _vDomRight, _vDomBottom)) {\n\t\t\ttop = Math.max(this.top, _vDomTop);\n\t\t\tbottom = Math.min(this.bottom, _vDomBottom);\n\t\t\tleft = Math.max(this.left, _vDomLeft);\n\t\t\tright = Math.min(this.right, _vDomRight);\n\t\t\t\n\t\t\ttopLeftCell = this.rangeManager.getCell(top, left);\n\t\t\tbottomRightCell = this.rangeManager.getCell(bottom, right);\n\t\t\ttopLeftCellEl = topLeftCell.getElement();\n\t\t\tbottomRightCellEl = bottomRightCell.getElement();\n\t\t\ttopLeftRowEl = topLeftCell.row.getElement();\n\t\t\tbottomRightRowEl = bottomRightCell.row.getElement();\n\t\t\t\n\t\t\tthis.element.classList.add(\"tabulator-range-active\");\n\t\t\t// this.element.classList.toggle(\"tabulator-range-active\", this === this.rangeManager.activeRange);\n\n\t\t\tif(this.table.rtl){\n\t\t\t\tthis.element.style.right = topLeftRowEl.offsetWidth - topLeftCellEl.offsetLeft - topLeftCellEl.offsetWidth + \"px\";\n\t\t\t\tthis.element.style.width = topLeftCellEl.offsetLeft + topLeftCellEl.offsetWidth - bottomRightCellEl.offsetLeft + \"px\";\n\t\t\t}else {\n\t\t\t\tthis.element.style.left = topLeftRowEl.offsetLeft + topLeftCellEl.offsetLeft + \"px\";\n\t\t\t\tthis.element.style.width = bottomRightCellEl.offsetLeft + bottomRightCellEl.offsetWidth - topLeftCellEl.offsetLeft + \"px\";\n\t\t\t}\n\t\t\t\n\t\t\tthis.element.style.top = topLeftRowEl.offsetTop + \"px\";\n\t\t\tthis.element.style.height = bottomRightRowEl.offsetTop + bottomRightRowEl.offsetHeight - topLeftRowEl.offsetTop + \"px\";\n\t\t}\n\t}\n\t\n\tatTopLeft(cell) {\n\t\treturn cell.row.position - 1 === this.top && cell.column.getPosition() - 1 === this.left;\n\t}\n\t\n\tatBottomRight(cell) {\n\t\treturn cell.row.position - 1 === this.bottom && cell.column.getPosition() - 1 === this.right;\n\t}\n\t\n\toccupies(cell) {\n\t\treturn this.occupiesRow(cell.row) && this.occupiesColumn(cell.column);\n\t}\n\t\n\toccupiesRow(row) {\n\t\treturn this.top <= row.position - 1 && row.position - 1 <= this.bottom;\n\t}\n\t\n\toccupiesColumn(col) {\n\t\treturn this.left <= col.getPosition() - 1 && col.getPosition() - 1 <= this.right;\n\t}\n\t\n\toverlaps(left, top, right, bottom) {\n\t\tif ((this.left > right || left > this.right) || (this.top > bottom || top > this.bottom)){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\treturn true;\n\t}\n\t\n\tgetData() {\n\t\tvar data = [],\n\t\trows = this.getRows(),\n\t\tcolumns = this.getColumns();\n\t\t\n\t\trows.forEach((row) => {\n\t\t\tvar rowData = row.getData(),\n\t\t\tresult = {};\n\t\t\t\n\t\t\tcolumns.forEach((column) => {\n\t\t\t\tresult[column.field] = rowData[column.field];\n\t\t\t});\n\t\t\t\n\t\t\tdata.push(result);\n\t\t});\n\t\t\n\t\treturn data;\n\t}\n\t\n\tgetCells(structured, component) {\n\t\tvar cells = [],\n\t\trows = this.getRows(),\n\t\tcolumns = this.getColumns();\n\t\t\n\t\tif (structured) {\n\t\t\tcells = rows.map((row) => {\n\t\t\t\tvar arr = [];\n\t\t\t\t\n\t\t\t\trow.getCells().forEach((cell) => {\n\t\t\t\t\tif (columns.includes(cell.column)) {\n\t\t\t\t\t\tarr.push(component ? cell.getComponent() : cell);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn arr;\n\t\t\t});\n\t\t} else {\n\t\t\trows.forEach((row) => {\n\t\t\t\trow.getCells().forEach((cell) => {\n\t\t\t\t\tif (columns.includes(cell.column)) {\n\t\t\t\t\t\tcells.push(component ? cell.getComponent() : cell);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn cells;\n\t}\n\t\n\tgetStructuredCells() {\n\t\treturn this.getCells(true, true);\n\t}\n\t\n\tgetRows() {\n\t\treturn this._getTableRows().slice(this.top, this.bottom + 1);\n\t}\n\t\n\tgetColumns() {\n\t\treturn this._getTableColumns().slice(this.left, this.right + 1);\n\t}\n\t\n\tclearValues(){\n\t\tvar cells = this.getCells();\n\t\tvar clearValue = this.table.options.selectableRangeClearCellsValue;\n\t\t\n\t\tthis.table.blockRedraw();\n\t\t\n\t\tcells.forEach((cell) => {\n\t\t\tcell.setValue(clearValue);\n\t\t});\n\t\t\n\t\tthis.table.restoreRedraw();\n\t\t\n\t}\n\t\n\tgetBounds(component){\n\t\tvar cells = this.getCells(false, component),\n\t\toutput = {\n\t\t\tstart:null,\n\t\t\tend:null,\n\t\t};\n\t\t\n\t\tif(cells.length){\n\t\t\toutput.start = cells[0];\n\t\t\toutput.end = cells[cells.length - 1];\n\t\t}else {\n\t\t\tconsole.warn(\"No bounds defined on range\");\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetComponent() {\n\t\tif (!this.component) {\n\t\t\tthis.component = new RangeComponent(this);\n\t\t}\n\t\treturn this.component;\n\t}\n\t\n\tdestroy(notify) {\n\t\tthis.destroyed = true;\n\t\t\n\t\tthis.element.remove();\n\t\t\n\t\tif(notify){\n\t\t\tthis.rangeManager.rangeRemoved(this);\n\t\t}\n\t\t\n\t\tif(this.initialized){\n\t\t\tthis.dispatchExternal(\"rangeRemoved\", this.getComponent());\n\t\t}\n\t}\n\t\n\tdestroyedGuard(func){\n\t\tif(this.destroyed){\n\t\t\tconsole.warn(\"You cannot call the \"  + func + \" function on a destroyed range\");\n\t\t}\n\t\t\n\t\treturn !this.destroyed;\n\t}\n}\n\nvar bindings = {\r\n\trangeJumpUp:[\"ctrl + 38\", \"meta + 38\"],\r\n\trangeJumpDown:[\"ctrl + 40\", \"meta + 40\"],\r\n\trangeJumpLeft:[\"ctrl + 37\", \"meta + 37\"],\r\n\trangeJumpRight:[\"ctrl + 39\", \"meta + 39\"],\r\n\trangeExpandUp:\"shift + 38\",\r\n\trangeExpandDown:\"shift + 40\",\r\n\trangeExpandLeft:\"shift + 37\",\r\n\trangeExpandRight:\"shift + 39\",\r\n\trangeExpandJumpUp:[\"ctrl + shift + 38\", \"meta + shift + 38\"],\r\n\trangeExpandJumpDown:[\"ctrl + shift + 40\", \"meta + shift + 40\"],\r\n\trangeExpandJumpLeft:[\"ctrl + shift + 37\", \"meta + shift + 37\"],\r\n\trangeExpandJumpRight:[\"ctrl + shift + 39\", \"meta + shift + 39\"],\r\n};\n\nvar actions = {\r\n\trangeJumpLeft: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"left\", true, false);\r\n\t},\r\n\trangeJumpRight: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"right\", true, false);\r\n\t},\r\n\trangeJumpUp: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"up\", true, false);\r\n\t},\r\n\trangeJumpDown: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"down\", true, false);\r\n\t},\r\n\trangeExpandLeft: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"left\", false, true);\r\n\t},\r\n\trangeExpandRight: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"right\", false, true);\r\n\t},\r\n\trangeExpandUp: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"up\", false, true);\r\n\t},\r\n\trangeExpandDown: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"down\", false, true);\r\n\t},\r\n\trangeExpandJumpLeft: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"left\", true, true);\r\n\t},\r\n\trangeExpandJumpRight: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"right\", true, true);\r\n\t},\r\n\trangeExpandJumpUp: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"up\", true, true);\r\n\t},\r\n\trangeExpandJumpDown: function(e){\r\n\t\tthis.dispatch(\"keybinding-nav-range\", e, \"down\", true, true);\r\n\t},\r\n};\n\nvar pasteActions = {\r\n\trange:function(data){\r\n\t\tvar rows = [],\r\n\t\trange = this.table.modules.selectRange.activeRange,\r\n\t\tsingleCell = false,\r\n\t\tbounds, startCell, startRow, rowWidth, dataLength;\r\n\r\n\t\tdataLength = data.length;\r\n\t\t\r\n\t\tif(range){\r\n\t\t\tbounds = range.getBounds();\r\n\t\t\tstartCell = bounds.start;\r\n\t\t\t\r\n\t\t\tif(bounds.start === bounds.end){\r\n\t\t\t\tsingleCell = true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(startCell){\r\n\t\t\t\trows = this.table.rowManager.activeRows.slice();\r\n\t\t\t\tstartRow = rows.indexOf(startCell.row);\r\n\r\n\t\t\t\tif(singleCell){\r\n\t\t\t\t\trowWidth = data.length;\r\n\t\t\t\t}else {\r\n\t\t\t\t\trowWidth = (rows.indexOf(bounds.end.row) - startRow) + 1;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tif(startRow >-1){\r\n\t\t\t\t\tthis.table.blockRedraw();\r\n\t\t\t\t\t\r\n\t\t\t\t\trows = rows.slice(startRow, startRow + rowWidth);\r\n\t\t\t\t\t\r\n\t\t\t\t\trows.forEach((row, i) => {\r\n\t\t\t\t\t\trow.updateData(data[i % dataLength]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.table.restoreRedraw();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn rows;\r\n\t}\r\n};\n\nvar pasteParsers = {\r\n\trange:function(clipboard){\r\n\t\tvar data = [],\r\n\t\trows = [],\r\n\t\trange = this.table.modules.selectRange.activeRange,\r\n\t\tsingleCell = false,\r\n\t\tbounds, startCell, colWidth, columnMap, startCol;\r\n\t\t\r\n\t\tif(range){\r\n\t\t\tbounds = range.getBounds();\r\n\t\t\tstartCell = bounds.start;\r\n\r\n\t\t\tif(bounds.start === bounds.end){\r\n\t\t\t\tsingleCell = true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(startCell){\r\n\t\t\t\t//get data from clipboard into array of columns and rows.\r\n\t\t\t\tclipboard = clipboard.split(\"\\n\");\r\n\t\t\t\t\r\n\t\t\t\tclipboard.forEach(function(row){\r\n\t\t\t\t\tdata.push(row.split(\"\\t\"));\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif(data.length){\r\n\t\t\t\t\tcolumnMap = this.table.columnManager.getVisibleColumnsByIndex();\r\n\t\t\t\t\tstartCol = columnMap.indexOf(startCell.column);\r\n\r\n\t\t\t\t\tif(startCol > -1){\r\n\t\t\t\t\t\tif(singleCell){\r\n\t\t\t\t\t\t\tcolWidth = data[0].length;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tcolWidth = (columnMap.indexOf(bounds.end.column) - startCol) + 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcolumnMap = columnMap.slice(startCol, startCol + colWidth);\r\n\r\n\t\t\t\t\t\tdata.forEach((item) => {\r\n\t\t\t\t\t\t\tvar row = {};\r\n\t\t\t\t\t\t\tvar itemLength = item.length;\r\n\r\n\t\t\t\t\t\t\tcolumnMap.forEach(function(col, i){\r\n\t\t\t\t\t\t\t\trow[col.field] = item[i % itemLength];\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\trows.push(row);\t\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\treturn rows;\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n};\n\nvar columnLookups = {\r\n\trange:function(){\r\n\t\tvar columns = this.modules.selectRange.selectedColumns();\r\n\r\n\t\tif(this.columnManager.rowHeader){\r\n\t\t\tcolumns.unshift(this.columnManager.rowHeader);\r\n\t\t}\r\n\r\n\t\treturn columns;\r\n\t},\r\n};\n\nvar rowLookups = {\r\n\trange:function(){\r\n\t\treturn this.modules.selectRange.selectedRows();\r\n\t},\r\n};\n\nvar extensions = {\r\n\tkeybindings:{\r\n\t\tbindings:bindings,\r\n\t\tactions:actions\r\n\t},\r\n\tclipboard:{\r\n\t\tpasteActions:pasteActions,\r\n\t\tpasteParsers:pasteParsers\r\n\t},\r\n\texport:{\r\n\t\tcolumnLookups:columnLookups,\r\n\t\trowLookups:rowLookups,\r\n\t}\r\n};\n\nclass SelectRange extends Module {\n\t\n\tstatic moduleName = \"selectRange\";\n\tstatic moduleInitOrder = 1;\n\tstatic moduleExtensions = extensions;\n\t\n\tconstructor(table) {\n\t\tsuper(table);\n\t\t\n\t\tthis.selecting = \"cell\";\n\t\tthis.mousedown = false;\n\t\tthis.ranges = [];\n\t\tthis.overlay = null;\n\t\tthis.rowHeader = null;\n\t\tthis.layoutChangeTimeout = null;\n\t\tthis.columnSelection = false;\n\t\tthis.rowSelection = false;\n\t\tthis.maxRanges = 0;\n\t\tthis.activeRange = false;\n\t\tthis.blockKeydown = false;\n\t\t\n\t\tthis.keyDownEvent = this._handleKeyDown.bind(this);\n\t\tthis.mouseUpEvent = this._handleMouseUp.bind(this);\n\t\t\n\t\tthis.registerTableOption(\"selectableRange\", false); //enable selectable range\n\t\tthis.registerTableOption(\"selectableRangeColumns\", false); //enable selectable range\n\t\tthis.registerTableOption(\"selectableRangeRows\", false); //enable selectable range\n\t\tthis.registerTableOption(\"selectableRangeClearCells\", false); //allow clearing of active range\n\t\tthis.registerTableOption(\"selectableRangeClearCellsValue\", undefined); //value for cleared active range\n\t\tthis.registerTableOption(\"selectableRangeAutoFocus\", true); //focus on a cell after resetRanges\n\t\t\n\t\tthis.registerTableFunction(\"getRangesData\", this.getRangesData.bind(this));\n\t\tthis.registerTableFunction(\"getRanges\", this.getRanges.bind(this));\n\t\tthis.registerTableFunction(\"addRange\", this.addRangeFromComponent.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"cell\", \"getRanges\", this.cellGetRanges.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"getRanges\", this.rowGetRanges.bind(this));\n\t\tthis.registerComponentFunction(\"column\", \"getRanges\", this.colGetRanges.bind(this));\n\t}\n\t\n\t///////////////////////////////////\n\t///////    Initialization   ///////\n\t///////////////////////////////////\n\t\n\tinitialize() {\n\t\tif (this.options(\"selectableRange\")) {\t\n\t\t\tif(!this.options(\"selectableRows\")){\n\t\t\t\tthis.maxRanges = this.options(\"selectableRange\");\n\t\t\t\t\n\t\t\t\tthis.initializeTable();\n\t\t\t\tthis.initializeWatchers();\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"SelectRange functionality cannot be used in conjunction with row selection\");\n\t\t\t}\n\n\t\t\tif(this.options('columns').findIndex((column) => column.frozen) > 0) {\n\t\t\t\tconsole.warn(\"Having frozen column in arbitrary position with selectRange option may result in unpredictable behavior.\");\n\t\t\t}\n\n\t\t\tif(this.options('columns').filter((column) => column.frozen) > 1) {\n\t\t\t\tconsole.warn(\"Having multiple frozen columns with selectRange option may result in unpredictable behavior.\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\tinitializeTable() {\t\t\n\t\tthis.overlay = document.createElement(\"div\");\n\t\tthis.overlay.classList.add(\"tabulator-range-overlay\");\n\t\t\n\t\tthis.rangeContainer = document.createElement(\"div\");\n\t\tthis.rangeContainer.classList.add(\"tabulator-range-container\");\n\t\t\n\t\tthis.activeRangeCellElement = document.createElement(\"div\");\n\t\tthis.activeRangeCellElement.classList.add(\"tabulator-range-cell-active\");\n\t\t\n\t\tthis.overlay.appendChild(this.rangeContainer);\n\t\tthis.overlay.appendChild(this.activeRangeCellElement);\n\t\t\n\t\tthis.table.rowManager.element.addEventListener(\"keydown\", this.keyDownEvent);\n\t\t\n\t\tthis.resetRanges();\n\t\t\n\t\tthis.table.rowManager.element.appendChild(this.overlay);\n\t\tthis.table.columnManager.element.setAttribute(\"tabindex\", 0);\n\t\tthis.table.element.classList.add(\"tabulator-ranges\");\n\t}\n\t\n\tinitializeWatchers() {\n\t\tthis.columnSelection = this.options(\"selectableRangeColumns\");\n\t\tthis.rowSelection = this.options(\"selectableRangeRows\");\n\t\t\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"column-mousedown\", this.handleColumnMouseDown.bind(this));\n\t\tthis.subscribe(\"column-mousemove\", this.handleColumnMouseMove.bind(this));\n\t\tthis.subscribe(\"column-resized\", this.handleColumnResized.bind(this));\n\t\tthis.subscribe(\"column-moving\", this.handleColumnMoving.bind(this));\n\t\tthis.subscribe(\"column-moved\", this.handleColumnMoved.bind(this));\n\t\tthis.subscribe(\"column-width\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"column-height\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"column-resized\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"columns-loaded\", this.updateHeaderColumn.bind(this));\n\t\t\n\t\tthis.subscribe(\"cell-height\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"cell-rendered\", this.renderCell.bind(this));\n\t\tthis.subscribe(\"cell-mousedown\", this.handleCellMouseDown.bind(this));\n\t\tthis.subscribe(\"cell-mousemove\", this.handleCellMouseMove.bind(this));\n\t\tthis.subscribe(\"cell-click\", this.handleCellClick.bind(this));\n\t\tthis.subscribe(\"cell-editing\", this.handleEditingCell.bind(this));\n\t\t\n\t\tthis.subscribe(\"page-changed\", this.redraw.bind(this));\n\t\t\n\t\tthis.subscribe(\"scroll-vertical\", this.layoutChange.bind(this));\n\t\tthis.subscribe(\"scroll-horizontal\", this.layoutChange.bind(this));\n\t\t\n\t\tthis.subscribe(\"data-destroy\", this.tableDestroyed.bind(this));\n\t\tthis.subscribe(\"data-processed\", this.resetRanges.bind(this));\n\t\t\n\t\tthis.subscribe(\"table-layout\", this.layoutElement.bind(this));\n\t\tthis.subscribe(\"table-redraw\", this.redraw.bind(this));\n\t\tthis.subscribe(\"table-destroy\", this.tableDestroyed.bind(this));\n\t\t\n\t\tthis.subscribe(\"edit-editor-clear\", this.finishEditingCell.bind(this));\n\t\tthis.subscribe(\"edit-blur\", this.restoreFocus.bind(this));\n\t\t\n\t\tthis.subscribe(\"keybinding-nav-prev\", this.keyNavigate.bind(this, \"left\"));\n\t\tthis.subscribe(\"keybinding-nav-next\", this.keyNavigate.bind(this, \"right\"));\n\t\tthis.subscribe(\"keybinding-nav-left\", this.keyNavigate.bind(this, \"left\"));\n\t\tthis.subscribe(\"keybinding-nav-right\", this.keyNavigate.bind(this, \"right\"));\n\t\tthis.subscribe(\"keybinding-nav-up\", this.keyNavigate.bind(this, \"up\"));\n\t\tthis.subscribe(\"keybinding-nav-down\", this.keyNavigate.bind(this, \"down\"));\n\t\tthis.subscribe(\"keybinding-nav-range\", this.keyNavigateRange.bind(this));\n\t}\n\t\n\t\n\tinitializeColumn(column) {\n\t\tif(this.columnSelection && column.definition.headerSort && this.options(\"headerSortClickElement\") !== \"icon\"){\n\t\t\tconsole.warn(\"Using column headerSort with selectableRangeColumns option may result in unpredictable behavior. Consider using headerSortClickElement: 'icon'.\");\n\t\t}\n\t\t\n\t\tif (column.modules.edit) ;\n\t}\n\t\n\tupdateHeaderColumn(){\n\t\tvar frozenCols;\n\n\t\tif(this.rowSelection){\n\t\t\tthis.rowHeader = this.table.columnManager.getVisibleColumnsByIndex()[0];\n\t\t\t\n\t\t\tif(this.rowHeader){\n\t\t\t\tthis.rowHeader.definition.cssClass = this.rowHeader.definition.cssClass + \" tabulator-range-row-header\";\n\t\t\t\t\n\t\t\t\tif(this.rowHeader.definition.headerSort){\n\t\t\t\t\tconsole.warn(\"Using column headerSort with selectableRangeRows option may result in unpredictable behavior\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.rowHeader.definition.editor){\n\t\t\t\t\tconsole.warn(\"Using column editor with selectableRangeRows option may result in unpredictable behavior\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//warn if invalid frozen column configuration detected\n\t\tif(this.table.modules.frozenColumns && this.table.modules.frozenColumns.active){\n\t\t\tfrozenCols = this.table.modules.frozenColumns.getFrozenColumns();\n\n\t\t\tif(frozenCols.length > 1 || (frozenCols.length === 1 && frozenCols[0] !== this.rowHeader)){\n\t\t\t\tconsole.warn(\"Using frozen columns that are not the range header in combination with the selectRange option may result in unpredictable behavior\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t///////   Table Functions   ///////\n\t///////////////////////////////////\n\t\n\tgetRanges(){\n\t\treturn this.ranges.map((range) => range.getComponent());\n\t}\n\t\n\tgetRangesData() {\n\t\treturn this.ranges.map((range) => range.getData());\n\t}\n\t\n\taddRangeFromComponent(start, end){\n\t\tstart = start ? start._cell : null;\n\t\tend = end ? end._cell : null;\n\t\t\n\t\treturn this.addRange(start, end);\n\t}\n\t\n\t///////////////////////////////////\n\t/////// Component Functions ///////\n\t///////////////////////////////////\n\t\n\tcellGetRanges(cell){\n\t\tvar ranges = [];\n\t\t\n\t\tif (cell.column === this.rowHeader) {\n\t\t\tranges = this.ranges.filter((range) => range.occupiesRow(cell.row));\n\t\t} else {\n\t\t\tranges = this.ranges.filter((range) => range.occupies(cell));\n\t\t}\n\t\t\n\t\treturn ranges.map((range) => range.getComponent());\n\t}\n\t\n\trowGetRanges(row){\n\t\tvar ranges = this.ranges.filter((range) => range.occupiesRow(row));\n\t\t\n\t\treturn ranges.map((range) => range.getComponent());\n\t}\n\t\n\tcolGetRanges(col){\n\t\tvar ranges = this.ranges.filter((range) => range.occupiesColumn(col));\n\t\t\n\t\treturn ranges.map((range) => range.getComponent());\n\t}\n\t\n\t///////////////////////////////////\n\t////////// Event Handlers /////////\n\t///////////////////////////////////\n\t\n\t_handleMouseUp(e){\n\t\tthis.mousedown = false;\n\t\tdocument.removeEventListener(\"mouseup\", this.mouseUpEvent);\n\t}\n\t\n\t_handleKeyDown(e) {\n\t\tif (!this.blockKeydown && (!this.table.modules.edit || (this.table.modules.edit && !this.table.modules.edit.currentCell))) {\n\t\t\tif (e.key === \"Enter\") {\n\t\t\t\t// is editing a cell?\n\t\t\t\tif (this.table.modules.edit && this.table.modules.edit.currentCell) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.table.modules.edit.editCell(this.getActiveCell());\n\t\t\t\t\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\t\n\t\t\tif ((e.key === \"Backspace\" || e.key === \"Delete\") && this.options(\"selectableRangeClearCells\")) {\n\t\t\t\tif(this.activeRange){\n\t\t\t\t\tthis.activeRange.clearValues();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tinitializeFocus(cell){\n\t\tvar range;\n\n\t\tthis.restoreFocus();\n\t\t\n\t\ttry{\n\t\t\tif (document.selection) { // IE\n\t\t\t\trange = document.body.createTextRange();\n\t\t\t\trange.moveToElementText(cell.getElement());\n\t\t\t\trange.select();\n\t\t\t} else if (window.getSelection) {\n\t\t\t\trange = document.createRange();\n\t\t\t\trange.selectNode(cell.getElement());\n\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\twindow.getSelection().addRange(range);\n\t\t\t}\n\t\t}catch(e){}\n\t}\n\t\n\trestoreFocus(element){\n\t\tthis.table.rowManager.element.focus();\n\t\t\n\t\treturn true;\n\t}\n\t\n\t///////////////////////////////////\n\t////// Column Functionality ///////\n\t///////////////////////////////////\n\t\n\thandleColumnResized(column) {\n\t\tvar selected;\n\t\t\n\t\tif (this.selecting !== \"column\" && this.selecting !== \"all\") {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tselected = this.ranges.some((range) => range.occupiesColumn(column));\n\t\t\n\t\tif (!selected) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.ranges.forEach((range) => {\n\t\t\tvar selectedColumns = range.getColumns(true);\n\t\t\t\n\t\t\tselectedColumns.forEach((selectedColumn) => {\n\t\t\t\tif (selectedColumn !== column) {\n\t\t\t\t\tselectedColumn.setWidth(column.width);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\t\n\thandleColumnMoving(_event, column) {\n\t\tthis.resetRanges().setBounds(column);\n\t\tthis.overlay.style.visibility = \"hidden\";\n\t}\n\n\thandleColumnMoved(from, _to, _after) {\n\t\tthis.activeRange.setBounds(from);\n\t\tthis.layoutElement();\n\t}\n\n\thandleColumnMouseDown(event, column) {\n\t\tif (event.button === 2 && (this.selecting === \"column\" || this.selecting === \"all\") && this.activeRange.occupiesColumn(column)) {\n\t\t\treturn;\n\t\t}\n\n\t\t//If columns are movable, allow dragging columns only if they are not\n\t\t//selected. Dragging selected columns should move the columns instead.\n\t\tif(this.table.options.movableColumns && this.selecting === \"column\" && this.activeRange.occupiesColumn(column)){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.mousedown = true;\n\t\t\n\t\tdocument.addEventListener(\"mouseup\", this.mouseUpEvent);\n\t\t\n\t\tthis.newSelection(event, column);\n\t}\n\t\n\thandleColumnMouseMove(e, column) {\n\t\tif (column === this.rowHeader || !this.mousedown || this.selecting === 'all') {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.activeRange.setBounds(false, column, true);\n\t}\n\t\n\t///////////////////////////////////\n\t//////// Cell Functionality ///////\n\t///////////////////////////////////\n\t\n\trenderCell(cell) {\n\t\tvar el = cell.getElement(),\n\t\trangeIdx = this.ranges.findIndex((range) => range.occupies(cell));\n\t\t\n\t\tel.classList.toggle(\"tabulator-range-selected\", rangeIdx !== -1);\n\t\tel.classList.toggle(\"tabulator-range-only-cell-selected\", this.ranges.length === 1 && this.ranges[0].atTopLeft(cell) &&\tthis.ranges[0].atBottomRight(cell));\n\t\t\n\t\tel.dataset.range = rangeIdx;\n\t}\n\t\n\thandleCellMouseDown(event, cell) {\n\t\tif (event.button === 2 && (this.activeRange.occupies(cell) || ((this.selecting === \"row\" || this.selecting === \"all\") && this.activeRange.occupiesRow(cell.row)))) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.mousedown = true;\n\t\t\n\t\tdocument.addEventListener(\"mouseup\", this.mouseUpEvent);\n\t\t\n\t\tthis.newSelection(event, cell);\n\t}\n\t\n\thandleCellMouseMove(e, cell) {\n\t\tif (!this.mousedown || this.selecting === \"all\") {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.activeRange.setBounds(false, cell, true);\n\t}\n\t\n\thandleCellClick(e, cell){\n\t\tthis.initializeFocus(cell);\n\t}\n\t\n\thandleEditingCell(cell) {\n\t\tif(this.activeRange){\n\t\t\tthis.activeRange.setBounds(cell);\n\t\t}\n\t}\n\t\n\tfinishEditingCell() {\n\t\tthis.blockKeydown = true;\n\t\tthis.table.rowManager.element.focus();\n\t\t\n\t\tsetTimeout(() => {\n\t\t\tthis.blockKeydown = false;\n\t\t}, 10);\n\t}\n\t\n\t///////////////////////////////////\n\t///////     Navigation      ///////\n\t///////////////////////////////////\n\t\n\tkeyNavigate(dir, e){\n\t\tif(this.navigate(false, false, dir));\n\t\te.preventDefault();\n\t}\n\t\n\tkeyNavigateRange(e, dir, jump, expand){\n\t\tif(this.navigate(jump, expand, dir));\n\t\te.preventDefault();\n\t}\n\t\n\tnavigate(jump, expand, dir) {\n\t\tvar moved = false,\n\t\trange, rangeEdge, prevRect, nextRow, nextCol, row, column,\n\t\trowRect, rowManagerRect, columnRect, columnManagerRect;\n\t\t\n\t\t// Don't navigate while editing\n\t\tif (this.table.modules.edit && this.table.modules.edit.currentCell) {\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t// If there are more than 1 range, use the active range and destroy the others\n\t\tif (this.ranges.length > 1) {\n\t\t\tthis.ranges = this.ranges.filter((range) => {\n\t\t\t\tif (range === this.activeRange) {\n\t\t\t\t\trange.setEnd(range.start.row, range.start.col);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\trange.destroy();\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\t\n\t\trange = this.activeRange;\n\t\tprevRect = {\n\t\t\ttop: range.top,\n\t\t\tbottom: range.bottom,\n\t\t\tleft: range.left,\n\t\t\tright: range.right\n\t\t};\n\t\t\n\t\trangeEdge = expand ? range.end : range.start;\n\t\tnextRow = rangeEdge.row;\n\t\tnextCol = rangeEdge.col;\n\t\t\n\t\tif(jump){\n\t\t\tswitch(dir){\n\t\t\t\tcase \"left\":\n\t\t\t\t\tnextCol = this.findJumpCellLeft(range.start.row, rangeEdge.col);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tnextCol = this.findJumpCellRight(range.start.row, rangeEdge.col);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"up\":\n\t\t\t\t\tnextRow = this.findJumpCellUp(rangeEdge.row, range.start.col);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"down\":\n\t\t\t\t\tnextRow = this.findJumpCellDown(rangeEdge.row, range.start.col);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}else {\n\t\t\tif(expand){\n\t\t\t\tif ((this.selecting === 'row' && (dir === 'left' || dir === 'right')) || (this.selecting === 'column' && (dir === 'up' || dir === 'down'))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tswitch(dir){\n\t\t\t\tcase \"left\":\n\t\t\t\t\tnextCol = Math.max(nextCol - 1, 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"right\":\n\t\t\t\t\tnextCol = Math.min(nextCol + 1, this.getTableColumns().length - 1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"up\":\n\t\t\t\t\tnextRow = Math.max(nextRow - 1, 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"down\":\n\t\t\t\t\tnextRow = Math.min(nextRow + 1, this.getTableRows().length - 1);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(this.rowHeader && nextCol === 0) {\n\t\t\tnextCol = 1;\n\t\t}\n\t\t\n\t\tif(!expand){\n\t\t\trange.setStart(nextRow, nextCol);\n\t\t}\n\t\t\n\t\trange.setEnd(nextRow, nextCol);\n\t\t\n\t\tif(!expand){\n\t\t\tthis.selecting = \"cell\";\n\t\t}\n\n\t\tmoved = prevRect.top !== range.top || prevRect.bottom !== range.bottom || prevRect.left !== range.left || prevRect.right !== range.right;\n\n\t\tif (moved) {\n\t\t\trow = this.getRowByRangePos(range.end.row);\n\t\t\tcolumn = this.getColumnByRangePos(range.end.col);\n\t\t\trowRect = row.getElement().getBoundingClientRect();\n\t\t\tcolumnRect = column.getElement().getBoundingClientRect();\n\t\t\trowManagerRect = this.table.rowManager.getElement().getBoundingClientRect();\n\t\t\tcolumnManagerRect = this.table.columnManager.getElement().getBoundingClientRect();\n\t\t\t\n\t\t\tif(!(rowRect.top >= rowManagerRect.top && rowRect.bottom <= rowManagerRect.bottom)){\n\t\t\t\tif(row.getElement().parentNode && column.getElement().parentNode){\n\t\t\t\t\t// Use faster autoScroll when the elements are on the DOM\n\t\t\t\t\tthis.autoScroll(range, row.getElement(), column.getElement());\n\t\t\t\t}else {\n\t\t\t\t\trow.getComponent().scrollTo(undefined, false);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!(columnRect.left >= columnManagerRect.left + this.getRowHeaderWidth() && columnRect.right <= columnManagerRect.right)){\n\t\t\t\tif(row.getElement().parentNode && column.getElement().parentNode){\n\t\t\t\t\t// Use faster autoScroll when the elements are on the DOM\n\t\t\t\t\tthis.autoScroll(range, row.getElement(), column.getElement());\n\t\t\t\t}else {\n\t\t\t\t\tcolumn.getComponent().scrollTo(undefined, false);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.layoutElement();\n\t\t\t\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\trangeRemoved(removed){\n\t\tthis.ranges = this.ranges.filter((range) => range !== removed);\n\t\t\n\t\tif(this.activeRange === removed){\n\t\t\tif(this.ranges.length){\n\t\t\t\tthis.activeRange = this.ranges[this.ranges.length - 1];\n\t\t\t}else {\n\t\t\t\tthis.addRange();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.layoutElement();\n\t}\n\t\n\tfindJumpRow(column, rows, reverse, emptyStart, emptySide){\n\t\tif(reverse){\n\t\t\trows = rows.reverse();\n\t\t}\n\n\t\treturn this.findJumpItem(emptyStart, emptySide, rows, function(row){return row.getData()[column.getField()];});\n\t}\n\t\n\tfindJumpCol(row, columns, reverse, emptyStart, emptySide){\n\t\tif(reverse){\n\t\t\tcolumns = columns.reverse();\n\t\t}\n\n\t\treturn this.findJumpItem(emptyStart, emptySide, columns, function(column){return row.getData()[column.getField()];});\n\t}\n\n\tfindJumpItem(emptyStart, emptySide, items, valueResolver){\n\t\tvar nextItem;\n\n\t\tfor(let currentItem of items){\n\t\t\tlet currentValue = valueResolver(currentItem);\n\t\t\t\n\t\t\tif(emptyStart){\n\t\t\t\tnextItem = currentItem;\n\t\t\t\tif(currentValue){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(emptySide){\n\t\t\t\t\tnextItem = currentItem;\n\t\t\t\t\t\n\t\t\t\t\tif(currentValue){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tif(currentValue){\n\t\t\t\t\t\tnextItem = currentItem;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn nextItem;\n\t}\n\n\tfindJumpCellLeft(rowPos, colPos){\n\t\tvar row = this.getRowByRangePos(rowPos),\n\t\tcolumns = this.getTableColumns(),\n\t\tisStartingCellEmpty = this.isEmpty(row.getData()[columns[colPos].getField()]),\n\t\tisLeftOfStartingCellEmpty = columns[colPos - 1] ? this.isEmpty(row.getData()[columns[colPos - 1].getField()]) : false,\n\t\ttargetCols = this.rowHeader ? columns.slice(1, colPos) : columns.slice(0, colPos),\n\t\tjumpCol = this.findJumpCol(row, targetCols, true, isStartingCellEmpty, isLeftOfStartingCellEmpty);\n\t\t\n\t\tif(jumpCol){\n\t\t\treturn jumpCol.getPosition() - 1;\n\t\t}\n\t\t\n\t\treturn colPos;\n\t}\n\t\n\tfindJumpCellRight(rowPos, colPos){\n\t\tvar row = this.getRowByRangePos(rowPos),\n\t\tcolumns = this.getTableColumns(),\n\t\tisStartingCellEmpty = this.isEmpty(row.getData()[columns[colPos].getField()]),\n\t\tisRightOfStartingCellEmpty = columns[colPos + 1] ? this.isEmpty(row.getData()[columns[colPos + 1].getField()]) : false,\n\t\tjumpCol = this.findJumpCol(row, columns.slice(colPos + 1, columns.length), false, isStartingCellEmpty, isRightOfStartingCellEmpty);\n\t\t\n\t\tif(jumpCol){\n\t\t\treturn jumpCol.getPosition() - 1;\n\t\t}\n\t\t\n\t\treturn colPos;\n\t}\n\t\n\tfindJumpCellUp(rowPos, colPos) {\n\t\tvar column = this.getColumnByRangePos(colPos),\n\t\trows = this.getTableRows(),\n\t\tisStartingCellEmpty = this.isEmpty(rows[rowPos].getData()[column.getField()]),\n\t\tisTopOfStartingCellEmpty = rows[rowPos - 1] ? this.isEmpty(rows[rowPos - 1].getData()[column.getField()]) : false,\n\t\tjumpRow = this.findJumpRow(column, rows.slice(0, rowPos), true, isStartingCellEmpty, isTopOfStartingCellEmpty);\n\t\t\n\t\tif(jumpRow){\n\t\t\treturn jumpRow.position - 1;\n\t\t}\n\t\t\n\t\treturn rowPos;\n\t}\n\t\n\tfindJumpCellDown(rowPos, colPos) {\n\t\tvar column = this.getColumnByRangePos(colPos),\n\t\trows = this.getTableRows(),\n\t\tisStartingCellEmpty = this.isEmpty(rows[rowPos].getData()[column.getField()]),\n\t\tisBottomOfStartingCellEmpty = rows[rowPos + 1] ? this.isEmpty(rows[rowPos + 1].getData()[column.getField()]) : false,\n\t\tjumpRow = this.findJumpRow(column, rows.slice(rowPos + 1, rows.length), false, isStartingCellEmpty, isBottomOfStartingCellEmpty);\n\t\t\n\t\tif(jumpRow){\n\t\t\treturn jumpRow.position - 1;\n\t\t}\n\t\t\n\t\treturn rowPos;\n\t}\n\t\n\t///////////////////////////////////\n\t///////      Selection      ///////\n\t///////////////////////////////////\n\tnewSelection(event, element) {\n\t\tvar range;\n\t\t\n\t\tif (element.type === \"column\") {\n\t\t\tif(!this.columnSelection){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tif (element === this.rowHeader) {\n\t\t\t\trange = this.resetRanges();\n\t\t\t\tthis.selecting = \"all\";\n\t\t\t\t\n\t\t\t\tvar topLeftCell, bottomRightCell = this.getCell(-1, -1);\n\t\t\t\t\n\t\t\t\tif(this.rowHeader){\n\t\t\t\t\ttopLeftCell = this.getCell(0, 1);\n\t\t\t\t}else {\n\t\t\t\t\ttopLeftCell = this.getCell(0, 0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trange.setBounds(topLeftCell, bottomRightCell);\t\t\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tthis.selecting = \"column\";\n\t\t\t}\n\t\t} else if (element.column === this.rowHeader) {\n\t\t\tthis.selecting = \"row\";\n\t\t} else {\n\t\t\tthis.selecting = \"cell\";\n\t\t}\n\t\t\n\t\tif (event.shiftKey) {\n\t\t\tthis.activeRange.setBounds(false, element);\n\t\t} else if (event.ctrlKey) {\n\t\t\tthis.addRange().setBounds(element);\n\t\t} else {\n\t\t\tthis.resetRanges().setBounds(element);\n\t\t}\n\t}\n\t\n\tautoScroll(range, row, column) {\n\t\tvar tableHolder = this.table.rowManager.element,\n\t\trect, view, withinHorizontalView, withinVerticalView;\n\t\t\n\t\tif (typeof row === 'undefined') {\n\t\t\trow = this.getRowByRangePos(range.end.row).getElement();\n\t\t}\n\t\t\n\t\tif (typeof column === 'undefined') {\n\t\t\tcolumn = this.getColumnByRangePos(range.end.col).getElement();\n\t\t}\n\t\t\n\t\trect = {\n\t\t\tleft: column.offsetLeft,\n\t\t\tright: column.offsetLeft + column.offsetWidth,\n\t\t\ttop: row.offsetTop,\n\t\t\tbottom: row.offsetTop + row.offsetHeight,\n\t\t};\n\t\t\n\t\tview = {\n\t\t\tleft: tableHolder.scrollLeft + this.getRowHeaderWidth(),\n\t\t\tright: Math.ceil(tableHolder.scrollLeft + tableHolder.clientWidth),\n\t\t\ttop: tableHolder.scrollTop,\n\t\t\tbottom:\ttableHolder.scrollTop +\ttableHolder.offsetHeight - this.table.rowManager.scrollbarWidth,\n\t\t};\n\t\t\n\t\twithinHorizontalView = view.left < rect.left &&\trect.left < view.right && view.left < rect.right &&\trect.right < view.right;\n\t\t\n\t\twithinVerticalView = view.top < rect.top &&\trect.top < view.bottom && view.top < rect.bottom &&\trect.bottom < view.bottom;\n\t\t\n\t\tif (!withinHorizontalView) {\n\t\t\tif (rect.left < view.left) {\n\t\t\t\ttableHolder.scrollLeft = rect.left - this.getRowHeaderWidth();\n\t\t\t} else if (rect.right > view.right) {\n\t\t\t\ttableHolder.scrollLeft = Math.min(rect.right - tableHolder.clientWidth, rect.left - this.getRowHeaderWidth());\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (!withinVerticalView) {\n\t\t\tif (rect.top < view.top) {\n\t\t\t\ttableHolder.scrollTop = rect.top;\n\t\t\t} else if (rect.bottom > view.bottom) {\n\t\t\t\ttableHolder.scrollTop = rect.bottom - tableHolder.clientHeight;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////       Layout        ///////\n\t///////////////////////////////////\n\t\n\tlayoutChange(){\n\t\tthis.overlay.style.visibility = \"hidden\";\n\t\tclearTimeout(this.layoutChangeTimeout);\n\t\tthis.layoutChangeTimeout = setTimeout(this.layoutRanges.bind(this), 200);\n\t}\n\t\n\tredraw(force) {\n\t\tif (force) {\n\t\t\tthis.selecting = 'cell';\n\t\t\tthis.resetRanges();\n\t\t\tthis.layoutElement();\n\t\t}\n\t}\n\t\n\tlayoutElement(visibleRows) {\n\t\tvar rows;\n\t\t\n\t\tif (visibleRows) {\n\t\t\trows = this.table.rowManager.getVisibleRows(true);\n\t\t} else {\n\t\t\trows = this.table.rowManager.getRows();\n\t\t}\n\t\t\n\t\trows.forEach((row) => {\n\t\t\tif (row.type === \"row\") {\n\t\t\t\tthis.layoutRow(row);\n\t\t\t\trow.cells.forEach((cell) => this.renderCell(cell));\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.getTableColumns().forEach((column) => {\n\t\t\tthis.layoutColumn(column);\n\t\t});\n\t\t\n\t\tthis.layoutRanges();\n\t}\n\t\n\tlayoutRow(row) {\n\t\tvar el = row.getElement(),\n\t\tselected = false,\n\t\toccupied = this.ranges.some((range) => range.occupiesRow(row));\n\t\t\n\t\tif (this.selecting === \"row\") {\n\t\t\tselected = occupied;\n\t\t} else if (this.selecting === \"all\") {\n\t\t\tselected = true;\n\t\t}\n\t\t\n\t\tel.classList.toggle(\"tabulator-range-selected\", selected);\n\t\tel.classList.toggle(\"tabulator-range-highlight\", occupied);\n\t}\n\t\n\tlayoutColumn(column) {\n\t\tvar el = column.getElement(),\t\t\n\t\tselected = false,\n\t\toccupied = this.ranges.some((range) => range.occupiesColumn(column));\n\t\t\n\t\tif (this.selecting === \"column\") {\n\t\t\tselected = occupied;\n\t\t} else if (this.selecting === \"all\") {\n\t\t\tselected = true;\n\t\t}\n\t\t\n\t\tel.classList.toggle(\"tabulator-range-selected\", selected);\n\t\tel.classList.toggle(\"tabulator-range-highlight\", occupied);\n\t}\n\t\n\tlayoutRanges() {\n\t\tvar activeCell, activeCellEl, activeRowEl;\n\t\t\n\t\tif (!this.table.initialized) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tactiveCell = this.getActiveCell();\n\t\t\n\t\tif (!activeCell) {\n\t\t\treturn;\n\t\t}\n\n\t\tactiveCellEl = activeCell.getElement();\n\t\tactiveRowEl = activeCell.row.getElement();\n\n\t\tif(this.table.rtl){\n\t\t\tthis.activeRangeCellElement.style.right = activeRowEl.offsetWidth - activeCellEl.offsetLeft - activeCellEl.offsetWidth + \"px\";\n\t\t}else {\n\t\t\tthis.activeRangeCellElement.style.left = activeRowEl.offsetLeft + activeCellEl.offsetLeft + \"px\";\n\t\t}\n\n\t\tthis.activeRangeCellElement.style.top =\tactiveRowEl.offsetTop + \"px\";\n\t\tthis.activeRangeCellElement.style.width = activeCellEl.offsetWidth + \"px\";\n\t\tthis.activeRangeCellElement.style.height =  activeRowEl.offsetHeight  + \"px\";\n\t\t\n\t\tthis.ranges.forEach((range) => range.layout());\n\t\t\n\t\tthis.overlay.style.visibility = \"visible\";\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////  Helper Functions   ///////\n\t///////////////////////////////////\t\n\t\n\tgetCell(rowIdx, colIdx) {\n\t\tvar row;\n\t\t\n\t\tif (colIdx < 0) {\n\t\t\tcolIdx = this.getTableColumns().length + colIdx;\n\t\t\tif (colIdx < 0) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (rowIdx < 0) {\n\t\t\trowIdx = this.getTableRows().length + rowIdx;\n\t\t}\n\t\t\n\t\trow = this.table.rowManager.getRowFromPosition(rowIdx + 1);\n\t\t\n\t\treturn row ? row.getCells(false, true).filter((cell) => cell.column.visible)[colIdx] : null;\n\t}\n\t\n\t\n\tgetActiveCell() {\n\t\treturn this.getCell(this.activeRange.start.row, this.activeRange.start.col);\n\t}\n\t\n\tgetRowByRangePos(pos) {\n\t\treturn this.getTableRows()[pos];\n\t}\n\t\n\tgetColumnByRangePos(pos) {\n\t\treturn this.getTableColumns()[pos];\n\t}\n\t\n\tgetTableRows() {\n\t\treturn this.table.rowManager.getDisplayRows().filter(row=> row.type === \"row\");\n\t}\n\t\n\tgetTableColumns() {\n\t\treturn this.table.columnManager.getVisibleColumnsByIndex();\n\t}\n\t\n\taddRange(start, end) {\n\t\tvar  range;\n\t\t\n\t\tif(this.maxRanges !== true && this.ranges.length >= this.maxRanges){\n\t\t\tthis.ranges.shift().destroy();\n\t\t}\n\t\t\n\t\trange = new Range(this.table, this, start, end);\n\t\t\n\t\tthis.activeRange = range;\n\t\tthis.ranges.push(range);\n\t\tthis.rangeContainer.appendChild(range.element);\n\t\t\n\t\treturn range;\n\t}\n\t\n\tresetRanges() {\n\t\tvar range, cell, visibleCells;\n\t\t\n\t\tthis.ranges.forEach((range) => range.destroy());\n\t\tthis.ranges = [];\n\t\t\n\t\trange = this.addRange();\n\t\t\n\t\tif(this.table.rowManager.activeRows.length){\n\t\t\tvisibleCells = this.table.rowManager.activeRows[0].cells.filter((cell) => cell.column.visible);\n\t\t\tcell = visibleCells[this.rowHeader ? 1 : 0];\n\n\t\t\tif(cell){\n\t\t\t\trange.setBounds(cell);\n\t\t\t\tif(this.options(\"selectableRangeAutoFocus\")){\n\t\t\t\t\tthis.initializeFocus(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn range;\n\t}\n\t\n\ttableDestroyed(){\n\t\tdocument.removeEventListener(\"mouseup\", this.mouseUpEvent);\n\t\tthis.table.rowManager.element.removeEventListener(\"keydown\", this.keyDownEvent);\n\t}\n\t\n\tselectedRows(component) {\n\t\treturn component ? this.activeRange.getRows().map((row) => row.getComponent()) : this.activeRange.getRows();\n\t}\n\t\n\tselectedColumns(component) {\n\t\treturn component ? this.activeRange.getColumns().map((col) => col.getComponent()) : this.activeRange.getColumns();\n\t}\n\n\tgetRowHeaderWidth(){\n\t\tif(!this.rowHeader){\n\t\t\treturn 0;\n\t\t}\n\t\treturn this.rowHeader.getElement().offsetWidth;\n\t}\n\n\tisEmpty(value) {\n\t\treturn value === null || value === undefined || value === \"\";\n\t}\n}\n\n//sort numbers\nfunction number(a, b, aRow, bRow, column, dir, params){\n\tvar alignEmptyValues = params.alignEmptyValues;\n\tvar decimal = params.decimalSeparator;\n\tvar thousand = params.thousandSeparator;\n\tvar emptyAlign = 0;\n\n\ta = String(a);\n\tb = String(b);\n\n\tif(thousand){\n\t\ta = a.split(thousand).join(\"\");\n\t\tb = b.split(thousand).join(\"\");\n\t}\n\n\tif(decimal){\n\t\ta = a.split(decimal).join(\".\");\n\t\tb = b.split(decimal).join(\".\");\n\t}\n\n\ta = parseFloat(a);\n\tb = parseFloat(b);\n\n\t//handle non numeric values\n\tif(isNaN(a)){\n\t\temptyAlign =  isNaN(b) ? 0 : -1;\n\t}else if(isNaN(b)){\n\t\temptyAlign =  1;\n\t}else {\n\t\t//compare valid values\n\t\treturn a - b;\n\t}\n\n\t//fix empty values in position\n\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\temptyAlign *= -1;\n\t}\n\n\treturn emptyAlign;\n}\n\n//sort strings\nfunction string(a, b, aRow, bRow, column, dir, params){\n\tvar alignEmptyValues = params.alignEmptyValues;\n\tvar emptyAlign = 0;\n\tvar locale;\n\n\t//handle empty values\n\tif(!a){\n\t\temptyAlign =  !b ? 0 : -1;\n\t}else if(!b){\n\t\temptyAlign =  1;\n\t}else {\n\t\t//compare valid values\n\t\tswitch(typeof params.locale){\n\t\t\tcase \"boolean\":\n\t\t\t\tif(params.locale){\n\t\t\t\t\tlocale = this.langLocale();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"string\":\n\t\t\t\tlocale = params.locale;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn String(a).toLowerCase().localeCompare(String(b).toLowerCase(), locale);\n\t}\n\n\t//fix empty values in position\n\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\temptyAlign *= -1;\n\t}\n\n\treturn emptyAlign;\n}\n\n//sort datetime\nfunction datetime(a, b, aRow, bRow, column, dir, params){\n\tvar DT = this.table.dependencyRegistry.lookup([\"luxon\", \"DateTime\"], \"DateTime\");\n\tvar format = params.format || \"dd/MM/yyyy HH:mm:ss\",\n\talignEmptyValues = params.alignEmptyValues,\n\temptyAlign = 0;\n\n\tif(typeof DT != \"undefined\"){\n\t\tif(!DT.isDateTime(a)){\n\t\t\tif(format === \"iso\"){\n\t\t\t\ta = DT.fromISO(String(a));\n\t\t\t}else {\n\t\t\t\ta = DT.fromFormat(String(a), format);\n\t\t\t}\n\t\t}\n\n\t\tif(!DT.isDateTime(b)){\n\t\t\tif(format === \"iso\"){\n\t\t\t\tb = DT.fromISO(String(b));\n\t\t\t}else {\n\t\t\t\tb = DT.fromFormat(String(b), format);\n\t\t\t}\n\t\t}\n\n\t\tif(!a.isValid){\n\t\t\temptyAlign = !b.isValid ? 0 : -1;\n\t\t}else if(!b.isValid){\n\t\t\temptyAlign =  1;\n\t\t}else {\n\t\t\t//compare valid values\n\t\t\treturn a - b;\n\t\t}\n\n\t\t//fix empty values in position\n\t\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\t\temptyAlign *= -1;\n\t\t}\n\n\t\treturn emptyAlign;\n\n\t}else {\n\t\tconsole.error(\"Sort Error - 'datetime' sorter is dependant on luxon.js\");\n\t}\n}\n\n//sort date\nfunction date(a, b, aRow, bRow, column, dir, params){\n\tif(!params.format){\n\t\tparams.format = \"dd/MM/yyyy\";\n\t}\n\n\treturn datetime.call(this, a, b, aRow, bRow, column, dir, params);\n}\n\n//sort times\nfunction time(a, b, aRow, bRow, column, dir, params){\n\tif(!params.format){\n\t\tparams.format = \"HH:mm\";\n\t}\n\n\treturn datetime.call(this, a, b, aRow, bRow, column, dir, params);\n}\n\n//sort booleans\nfunction boolean(a, b, aRow, bRow, column, dir, params){\n\tvar el1 = a === true || a === \"true\" || a === \"True\" || a === 1 ? 1 : 0;\n\tvar el2 = b === true || b === \"true\" || b === \"True\" || b === 1 ? 1 : 0;\n\n\treturn el1 - el2;\n}\n\n//sort if element contains any data\nfunction array(a, b, aRow, bRow, column, dir, params){\n\tvar type = params.type || \"length\",\n\talignEmptyValues = params.alignEmptyValues,\n\temptyAlign = 0,\n\ttable = this.table,\n\tvalueMap;\n\n\tif(params.valueMap){\n\t\tif(typeof params.valueMap === \"string\"){\n\t\t\tvalueMap = function(value){\n\t\t\t\treturn value.map((item) => {\n\t\t\t\t\treturn Helpers.retrieveNestedData(table.options.nestedFieldSeparator, params.valueMap, item);\n\t\t\t\t});\n\t\t\t};\n\t\t}else {\n\t\t\tvalueMap = params.valueMap;\n\t\t}\n\t}\n\n\tfunction calc(value){\n\t\tvar result;\n\t\t\n\t\tif(valueMap){\n\t\t\tvalue = valueMap(value);\n\t\t}\n\n\t\tswitch(type){\n\t\t\tcase \"length\":\n\t\t\t\tresult = value.length;\n\t\t\t\tbreak;\n\n\t\t\tcase \"sum\":\n\t\t\t\tresult = value.reduce(function(c, d){\n\t\t\t\t\treturn c + d;\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tcase \"max\":\n\t\t\t\tresult = Math.max.apply(null, value) ;\n\t\t\t\tbreak;\n\n\t\t\tcase \"min\":\n\t\t\t\tresult = Math.min.apply(null, value) ;\n\t\t\t\tbreak;\n\n\t\t\tcase \"avg\":\n\t\t\t\tresult = value.reduce(function(c, d){\n\t\t\t\t\treturn c + d;\n\t\t\t\t}) / value.length;\n\t\t\t\tbreak;\n\n\t\t\tcase \"string\":\n\t\t\t\tresult = value.join(\"\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t//handle non array values\n\tif(!Array.isArray(a)){\n\t\temptyAlign = !Array.isArray(b) ? 0 : -1;\n\t}else if(!Array.isArray(b)){\n\t\temptyAlign = 1;\n\t}else {\n\t\tif(type === \"string\"){\n\t\t\treturn String(calc(a)).toLowerCase().localeCompare(String(calc(b)).toLowerCase());\n\t\t}else {\n\t\t\treturn calc(b) - calc(a);\n\t\t}\n\t}\n\n\t//fix empty values in position\n\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\temptyAlign *= -1;\n\t}\n\n\treturn emptyAlign;\n}\n\n//sort if element contains any data\nfunction exists(a, b, aRow, bRow, column, dir, params){\n\tvar el1 = typeof a == \"undefined\" ? 0 : 1;\n\tvar el2 = typeof b == \"undefined\" ? 0 : 1;\n\n\treturn el1 - el2;\n}\n\n//sort alpha numeric strings\nfunction alphanum(as, bs, aRow, bRow, column, dir, params){\n\tvar a, b, a1, b1, i= 0, L, rx = /(\\d+)|(\\D+)/g, rd = /\\d/;\n\tvar alignEmptyValues = params.alignEmptyValues;\n\tvar emptyAlign = 0;\n\n\t//handle empty values\n\tif(!as && as!== 0){\n\t\temptyAlign =  !bs && bs!== 0 ? 0 : -1;\n\t}else if(!bs && bs!== 0){\n\t\temptyAlign =  1;\n\t}else {\n\n\t\tif(isFinite(as) && isFinite(bs)) return as - bs;\n\t\ta = String(as).toLowerCase();\n\t\tb = String(bs).toLowerCase();\n\t\tif(a === b) return 0;\n\t\tif(!(rd.test(a) && rd.test(b))) return a > b ? 1 : -1;\n\t\ta = a.match(rx);\n\t\tb = b.match(rx);\n\t\tL = a.length > b.length ? b.length : a.length;\n\t\twhile(i < L){\n\t\t\ta1= a[i];\n\t\t\tb1= b[i++];\n\t\t\tif(a1 !== b1){\n\t\t\t\tif(isFinite(a1) && isFinite(b1)){\n\t\t\t\t\tif(a1.charAt(0) === \"0\") a1 = \".\" + a1;\n\t\t\t\t\tif(b1.charAt(0) === \"0\") b1 = \".\" + b1;\n\t\t\t\t\treturn a1 - b1;\n\t\t\t\t}\n\t\t\t\telse return a1 > b1 ? 1 : -1;\n\t\t\t}\n\t\t}\n\n\t\treturn a.length > b.length;\n\t}\n\n\t//fix empty values in position\n\tif((alignEmptyValues === \"top\" && dir === \"desc\") || (alignEmptyValues === \"bottom\" && dir === \"asc\")){\n\t\temptyAlign *= -1;\n\t}\n\n\treturn emptyAlign;\n}\n\nvar defaultSorters = {\n\tnumber:number,\n\tstring:string,\n\tdate:date,\n\ttime:time,\n\tdatetime:datetime,\n\tboolean:boolean,\n\tarray:array,\n\texists:exists,\n\talphanum:alphanum\n};\n\nclass Sort extends Module{\n\n\tstatic moduleName = \"sort\";\n\n\t//load defaults\n\tstatic sorters = defaultSorters;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.sortList = []; //holder current sort\n\t\tthis.changed = false; //has the sort changed since last render\n\t\t\n\t\tthis.registerTableOption(\"sortMode\", \"local\"); //local or remote sorting\n\t\t\n\t\tthis.registerTableOption(\"initialSort\", false); //initial sorting criteria\n\t\tthis.registerTableOption(\"columnHeaderSortMulti\", true); //multiple or single column sorting\n\t\tthis.registerTableOption(\"sortOrderReverse\", false); //reverse internal sort ordering\n\t\tthis.registerTableOption(\"headerSortElement\", \"<div class='tabulator-arrow'></div>\"); //header sort element\n\t\tthis.registerTableOption(\"headerSortClickElement\", \"header\"); //element which triggers sort when clicked\n\t\t\n\t\tthis.registerColumnOption(\"sorter\");\n\t\tthis.registerColumnOption(\"sorterParams\");\n\t\t\n\t\tthis.registerColumnOption(\"headerSort\", true);\n\t\tthis.registerColumnOption(\"headerSortStartingDir\");\n\t\tthis.registerColumnOption(\"headerSortTristate\");\n\t\t\n\t}\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"column-layout\", this.initializeColumn.bind(this));\n\t\tthis.subscribe(\"table-built\", this.tableBuilt.bind(this));\n\t\tthis.registerDataHandler(this.sort.bind(this), 20);\n\t\t\n\t\tthis.registerTableFunction(\"setSort\", this.userSetSort.bind(this));\n\t\tthis.registerTableFunction(\"getSorters\", this.getSort.bind(this));\n\t\tthis.registerTableFunction(\"clearSort\", this.clearSort.bind(this));\n\t\t\n\t\tif(this.table.options.sortMode === \"remote\"){\n\t\t\tthis.subscribe(\"data-params\", this.remoteSortParams.bind(this));\n\t\t}\n\t}\n\t\n\ttableBuilt(){\n\t\tif(this.table.options.initialSort){\n\t\t\tthis.setSort(this.table.options.initialSort);\n\t\t}\n\t}\n\t\n\tremoteSortParams(data, config, silent, params){\n\t\tvar sorters = this.getSort();\n\t\t\n\t\tsorters.forEach((item) => {\n\t\t\tdelete item.column;\n\t\t});\n\t\t\n\t\tparams.sort = sorters;\n\t\t\n\t\treturn params;\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\t\n\tuserSetSort(sortList, dir){\n\t\tthis.setSort(sortList, dir);\n\t\t// this.table.rowManager.sorterRefresh();\n\t\tthis.refreshSort();\n\t}\n\t\n\tclearSort(){\n\t\tthis.clear();\n\t\t// this.table.rowManager.sorterRefresh();\n\t\tthis.refreshSort();\n\t}\n\t\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\t//initialize column header for sorting\n\tinitializeColumn(column){\n\t\tvar sorter = false,\n\t\tcolEl,\n\t\tarrowEl;\n\t\t\n\t\tswitch(typeof column.definition.sorter){\n\t\t\tcase \"string\":\n\t\t\t\tif(Sort.sorters[column.definition.sorter]){\n\t\t\t\t\tsorter = Sort.sorters[column.definition.sorter];\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Sort Error - No such sorter found: \", column.definition.sorter);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"function\":\n\t\t\t\tsorter = column.definition.sorter;\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\tcolumn.modules.sort = {\n\t\t\tsorter:sorter, dir:\"none\",\n\t\t\tparams:column.definition.sorterParams || {},\n\t\t\tstartingDir:column.definition.headerSortStartingDir || \"asc\",\n\t\t\ttristate: column.definition.headerSortTristate,\n\t\t};\n\t\t\n\t\tif(column.definition.headerSort !== false){\n\t\t\t\n\t\t\tcolEl = column.getElement();\n\t\t\t\n\t\t\tcolEl.classList.add(\"tabulator-sortable\");\n\t\t\t\n\t\t\tarrowEl = document.createElement(\"div\");\n\t\t\tarrowEl.classList.add(\"tabulator-col-sorter\");\n\t\t\t\n\t\t\tswitch(this.table.options.headerSortClickElement){\n\t\t\t\tcase \"icon\":\n\t\t\t\t\tarrowEl.classList.add(\"tabulator-col-sorter-element\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"header\":\n\t\t\t\t\tcolEl.classList.add(\"tabulator-col-sorter-element\");\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tcolEl.classList.add(\"tabulator-col-sorter-element\");\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tswitch(this.table.options.headerSortElement){\n\t\t\t\tcase \"function\":\n\t\t\t\t//do nothing\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase \"object\":\n\t\t\t\t\tarrowEl.appendChild(this.table.options.headerSortElement);\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tdefault:\n\t\t\t\t\tarrowEl.innerHTML = this.table.options.headerSortElement;\n\t\t\t}\n\t\t\t\n\t\t\t//create sorter arrow\n\t\t\tcolumn.titleHolderElement.appendChild(arrowEl);\n\t\t\t\n\t\t\tcolumn.modules.sort.element = arrowEl;\n\t\t\t\n\t\t\tthis.setColumnHeaderSortIcon(column, \"none\");\n\t\t\t\n\t\t\tif(this.table.options.headerSortClickElement === \"icon\"){\n\t\t\t\tarrowEl.addEventListener(\"mousedown\", (e) => {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\t//sort on click\n\t\t\t(this.table.options.headerSortClickElement === \"icon\" ? arrowEl : colEl).addEventListener(\"click\", (e) => {\n\t\t\t\tvar dir = \"\",\n\t\t\t\tsorters=[],\n\t\t\t\tmatch = false;\n\t\t\t\t\n\t\t\t\tif(column.modules.sort){\n\t\t\t\t\tif(column.modules.sort.tristate){\n\t\t\t\t\t\tif(column.modules.sort.dir == \"none\"){\n\t\t\t\t\t\t\tdir = column.modules.sort.startingDir;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tif(column.modules.sort.dir == column.modules.sort.startingDir){\n\t\t\t\t\t\t\t\tdir = column.modules.sort.dir == \"asc\" ? \"desc\" : \"asc\";\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tdir = \"none\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tswitch(column.modules.sort.dir){\n\t\t\t\t\t\t\tcase \"asc\":\n\t\t\t\t\t\t\t\tdir = \"desc\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcase \"desc\":\n\t\t\t\t\t\t\t\tdir = \"asc\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tdir = column.modules.sort.startingDir;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (this.table.options.columnHeaderSortMulti && (e.shiftKey || e.ctrlKey)) {\n\t\t\t\t\t\tsorters = this.getSort();\n\t\t\t\t\t\t\n\t\t\t\t\t\tmatch = sorters.findIndex((sorter) => {\n\t\t\t\t\t\t\treturn sorter.field === column.getField();\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(match > -1){\n\t\t\t\t\t\t\tsorters[match].dir = dir;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tmatch = sorters.splice(match, 1)[0];\n\t\t\t\t\t\t\tif(dir != \"none\"){\n\t\t\t\t\t\t\t\tsorters.push(match);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tif(dir != \"none\"){\n\t\t\t\t\t\t\t\tsorters.push({column:column, dir:dir});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//add to existing sort\n\t\t\t\t\t\tthis.setSort(sorters);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(dir == \"none\"){\n\t\t\t\t\t\t\tthis.clear();\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t//sort by column only\n\t\t\t\t\t\t\tthis.setSort(column, dir);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// this.table.rowManager.sorterRefresh(!this.sortList.length);\n\t\t\t\t\tthis.refreshSort();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\t\n\trefreshSort(){\n\t\tif(this.table.options.sortMode === \"remote\"){\n\t\t\tthis.reloadData(null, false, false);\n\t\t}else {\n\t\t\tthis.refreshData(true);\n\t\t}\n\t\t\n\t\t//TODO - Persist left position of row manager\n\t\t// left = this.scrollLeft;\n\t\t// this.scrollHorizontal(left);\n\t}\n\t\n\t//check if the sorters have changed since last use\n\thasChanged(){\n\t\tvar changed = this.changed;\n\t\tthis.changed = false;\n\t\treturn changed;\n\t}\n\t\n\t//return current sorters\n\tgetSort(){\n\t\tvar self = this,\n\t\tsorters = [];\n\t\t\n\t\tself.sortList.forEach(function(item){\n\t\t\tif(item.column){\n\t\t\t\tsorters.push({column:item.column.getComponent(), field:item.column.getField(), dir:item.dir});\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn sorters;\n\t}\n\t\n\t//change sort list and trigger sort\n\tsetSort(sortList, dir){\n\t\tvar self = this,\n\t\tnewSortList = [];\n\t\t\n\t\tif(!Array.isArray(sortList)){\n\t\t\tsortList = [{column: sortList, dir:dir}];\n\t\t}\n\t\t\n\t\tsortList.forEach(function(item){\n\t\t\tvar column;\n\t\t\t\n\t\t\tcolumn = self.table.columnManager.findColumn(item.column);\n\t\t\t\n\t\t\tif(column){\n\t\t\t\titem.column = column;\n\t\t\t\tnewSortList.push(item);\n\t\t\t\tself.changed = true;\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Sort Warning - Sort field does not exist and is being ignored: \", item.column);\n\t\t\t}\n\t\t\t\n\t\t});\n\t\t\n\t\tself.sortList = newSortList;\n\t\t\n\t\tthis.dispatch(\"sort-changed\");\n\t}\n\t\n\t//clear sorters\n\tclear(){\n\t\tthis.setSort([]);\n\t}\n\t\n\t//find appropriate sorter for column\n\tfindSorter(column){\n\t\tvar row = this.table.rowManager.activeRows[0],\n\t\tsorter = \"string\",\n\t\tfield, value;\n\t\t\n\t\tif(row){\n\t\t\trow = row.getData();\n\t\t\tfield = column.getField();\n\t\t\t\n\t\t\tif(field){\n\t\t\t\t\n\t\t\t\tvalue = column.getFieldValue(row);\n\t\t\t\t\n\t\t\t\tswitch(typeof value){\n\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\tsorter = \"string\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"boolean\":\n\t\t\t\t\t\tsorter = \"boolean\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!isNaN(value) && value !== \"\"){\n\t\t\t\t\t\t\tsorter = \"number\";\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tif(value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)){\n\t\t\t\t\t\t\t\tsorter = \"alphanum\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn Sort.sorters[sorter];\n\t}\n\t\n\t//work through sort list sorting data\n\tsort(data, sortOnly){\n\t\tvar self = this,\n\t\tsortList = this.table.options.sortOrderReverse ? self.sortList.slice().reverse() : self.sortList,\n\t\tsortListActual = [],\n\t\trowComponents = [];\n\t\t\n\t\tif(this.subscribedExternal(\"dataSorting\")){\n\t\t\tthis.dispatchExternal(\"dataSorting\", self.getSort());\n\t\t}\n\t\t\n\t\tif(!sortOnly) {\n\t\t\tself.clearColumnHeaders();\n\t\t}\n\t\t\n\t\tif(this.table.options.sortMode !== \"remote\"){\n\t\t\t\n\t\t\t//build list of valid sorters and trigger column specific callbacks before sort begins\n\t\t\tsortList.forEach(function(item, i){\n\t\t\t\tvar sortObj;\n\t\t\t\t\n\t\t\t\tif(item.column){\n\t\t\t\t\tsortObj = item.column.modules.sort;\n\t\t\t\t\t\n\t\t\t\t\tif(sortObj){\n\t\t\t\t\t\t\n\t\t\t\t\t\t//if no sorter has been defined, take a guess\n\t\t\t\t\t\tif(!sortObj.sorter){\n\t\t\t\t\t\t\tsortObj.sorter = self.findSorter(item.column);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\titem.params = typeof sortObj.params === \"function\" ? sortObj.params(item.column.getComponent(), item.dir) : sortObj.params;\n\t\t\t\t\t\t\n\t\t\t\t\t\tsortListActual.push(item);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(!sortOnly) {\n\t\t\t\t\t\tself.setColumnHeader(item.column, item.dir);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t//sort data\n\t\t\tif (sortListActual.length) {\n\t\t\t\tself._sortItems(data, sortListActual);\n\t\t\t}\n\t\t\t\n\t\t}else if(!sortOnly) {\n\t\t\tsortList.forEach(function(item, i){\n\t\t\t\tself.setColumnHeader(item.column, item.dir);\n\t\t\t});\n\t\t}\n\n\t\t\n\t\tif(this.subscribedExternal(\"dataSorted\")){\n\t\t\tdata.forEach((row) => {\n\t\t\t\trowComponents.push(row.getComponent());\n\t\t\t});\n\t\t\t\n\t\t\tthis.dispatchExternal(\"dataSorted\", self.getSort(), rowComponents);\n\t\t}\n\t\t\n\t\treturn data;\n\t}\n\t\n\t//clear sort arrows on columns\n\tclearColumnHeaders(){\n\t\tthis.table.columnManager.getRealColumns().forEach((column) => {\n\t\t\tif(column.modules.sort){\n\t\t\t\tcolumn.modules.sort.dir = \"none\";\n\t\t\t\tcolumn.getElement().setAttribute(\"aria-sort\", \"none\");\n\t\t\t\tthis.setColumnHeaderSortIcon(column, \"none\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//set the column header sort direction\n\tsetColumnHeader(column, dir){\n\t\tcolumn.modules.sort.dir = dir;\n\t\tcolumn.getElement().setAttribute(\"aria-sort\", dir === \"asc\" ? \"ascending\" : \"descending\");\n\t\tthis.setColumnHeaderSortIcon(column, dir);\n\t}\n\t\n\tsetColumnHeaderSortIcon(column, dir){\n\t\tvar sortEl = column.modules.sort.element,\n\t\tarrowEl;\n\t\t\n\t\tif(column.definition.headerSort && typeof this.table.options.headerSortElement === \"function\"){\n\t\t\twhile(sortEl.firstChild) sortEl.removeChild(sortEl.firstChild);\n\t\t\t\n\t\t\tarrowEl = this.table.options.headerSortElement.call(this.table, column.getComponent(), dir);\n\t\t\t\n\t\t\tif(typeof arrowEl === \"object\"){\n\t\t\t\tsortEl.appendChild(arrowEl);\n\t\t\t}else {\n\t\t\t\tsortEl.innerHTML = arrowEl;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//sort each item in sort list\n\t_sortItems(data, sortList){\n\t\tvar sorterCount = sortList.length - 1;\n\t\t\n\t\tdata.sort((a, b) => {\n\t\t\tvar result;\n\t\t\t\n\t\t\tfor(var i = sorterCount; i>= 0; i--){\n\t\t\t\tlet sortItem = sortList[i];\n\t\t\t\t\n\t\t\t\tresult = this._sortRow(a, b, sortItem.column, sortItem.dir, sortItem.params);\n\t\t\t\t\n\t\t\t\tif(result !== 0){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn result;\n\t\t});\n\t}\n\t\n\t//process individual rows for a sort function on active data\n\t_sortRow(a, b, column, dir, params){\n\t\tvar el1Comp, el2Comp;\n\t\t\n\t\t//switch elements depending on search direction\n\t\tvar el1 = dir == \"asc\" ? a : b;\n\t\tvar el2 = dir == \"asc\" ? b : a;\n\t\t\n\t\ta = column.getFieldValue(el1.getData());\n\t\tb = column.getFieldValue(el2.getData());\n\t\t\n\t\ta = typeof a !== \"undefined\" ? a : \"\";\n\t\tb = typeof b !== \"undefined\" ? b : \"\";\n\t\t\n\t\tel1Comp = el1.getComponent();\n\t\tel2Comp = el2.getComponent();\n\t\t\n\t\treturn column.modules.sort.sorter.call(this, a, b, el1Comp, el2Comp, column.getComponent(), dir, params);\n\t}\n}\n\nclass GridCalculator{\r\n\tconstructor(columns, rows){\r\n\t\tthis.columnCount = columns;\r\n\t\tthis.rowCount = rows;\r\n\r\n\t\tthis.columnString = [];\r\n\t\tthis.columns = [];\r\n\t\tthis.rows = [];\r\n\t}\r\n\r\n\tgenColumns(data){\r\n\t\tvar colCount = Math.max(this.columnCount, Math.max(...data.map(item => item.length)));\r\n\r\n\t\tthis.columnString = [];\r\n\t\tthis.columns = [];\r\n\r\n\t\tfor(let i = 1; i <= colCount; i++){\r\n\t\t\tthis.incrementChar(this.columnString.length - 1);\r\n\t\t\tthis.columns.push(this.columnString.join(\"\"));\r\n\t\t}\r\n\r\n\t\treturn this.columns;\r\n\t}\r\n\r\n\tgenRows(data){\r\n\t\tvar rowCount = Math.max(this.rowCount, data.length);\r\n\r\n\t\tthis.rows = [];\r\n\r\n\t\tfor(let i = 1; i <= rowCount; i++){\r\n\t\t\tthis.rows.push(i);\r\n\t\t}\r\n\t\t\r\n\t\treturn this.rows;\r\n\t}\r\n\r\n\tincrementChar(i){\r\n\t\tlet char = this.columnString[i];\r\n\r\n\t\tif(char){\r\n\t\t\tif(char !== \"Z\"){\r\n\t\t\t\tthis.columnString[i] = String.fromCharCode(this.columnString[i].charCodeAt(0) + 1);\r\n\t\t\t}else {\r\n\t\t\t\tthis.columnString[i] = \"A\";\r\n\t\t\t\t\r\n\t\t\t\tif(i){\r\n\t\t\t\t\tthis.incrementChar(i-1);\r\n\t\t\t\t}else {\r\n\t\t\t\t\tthis.columnString.push(\"A\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tthis.columnString.push(\"A\");\r\n\t\t}\r\n\t}\r\n\r\n\tsetRowCount(count){\r\n\t\tthis.rowCount = count;\r\n\t}\r\n\r\n\tsetColumnCount(count){\r\n\t\tthis.columnCount = count;\r\n\t}\r\n}\n\nclass SheetComponent {\r\n\tconstructor(sheet) {\r\n\t\tthis._sheet = sheet;\r\n\r\n\t\treturn new Proxy(this, {\r\n\t\t\tget: function (target, name, receiver) {\r\n\t\t\t\tif (typeof target[name] !== \"undefined\") {\r\n\t\t\t\t\treturn target[name];\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn target._sheet.table.componentFunctionBinder.handle(\"sheet\", target._sheet, name);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\tgetTitle(){\r\n\t\treturn this._sheet.title;\r\n\t}\r\n\r\n\tgetKey(){\r\n\t\treturn this._sheet.key;\r\n\t}\r\n\r\n\tgetDefinition(){\r\n\t\treturn this._sheet.getDefinition();\r\n\t}\r\n\r\n\tgetData() {\r\n\t\treturn this._sheet.getData();\r\n\t}\r\n\r\n\tsetData(data) {\r\n\t\treturn this._sheet.setData(data);\r\n\t}\r\n\r\n\tclear(){\r\n\t\treturn this._sheet.clear();\r\n\t}\r\n\r\n\tremove(){\r\n\t\treturn this._sheet.remove();\r\n\t}\r\n\t\r\n\tactive(){\r\n\t\treturn this._sheet.active();\r\n\t}\r\n\r\n\tsetTitle(title){\r\n\t\treturn this._sheet.setTitle(title);\r\n\t}\r\n\r\n\tsetRows(rows){\r\n\t\treturn this._sheet.setRows(rows);\r\n\t}\r\n\r\n\tsetColumns(columns){\r\n\t\treturn this._sheet.setColumns(columns);\r\n\t}\r\n}\n\nclass Sheet extends CoreFeature{\r\n\tconstructor(spreadsheetManager, definition) {\r\n\t\tsuper(spreadsheetManager.table);\r\n\t\t\r\n\t\tthis.spreadsheetManager = spreadsheetManager;\r\n\t\tthis.definition = definition;\r\n\t\t\r\n\t\tthis.title = this.definition.title || \"\";\r\n\t\tthis.key = this.definition.key || this.definition.title;\r\n\t\tthis.rowCount = this.definition.rows;\r\n\t\tthis.columnCount = this.definition.columns;\r\n\t\tthis.data = this.definition.data || [];\r\n\t\tthis.element = null;\r\n\t\tthis.isActive = false;\r\n\t\t\r\n\t\tthis.grid = new GridCalculator(this.columnCount, this.rowCount);\r\n\t\t\r\n\t\tthis.defaultColumnDefinition = {width:100, headerHozAlign:\"center\", headerSort:false};\r\n\t\tthis.columnDefinition = Object.assign(this.defaultColumnDefinition, this.options(\"spreadsheetColumnDefinition\"));\r\n\t\t\r\n\t\tthis.columnDefs = [];\r\n\t\tthis.rowDefs = [];\r\n\t\tthis.columnFields = [];\r\n\t\tthis.columns = [];\r\n\t\tthis.rows = [];\r\n\t\t\r\n\t\tthis.scrollTop = null;\r\n\t\tthis.scrollLeft = null;\r\n\t\t\r\n\t\tthis.initialize();\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetAdded\", this.getComponent());\r\n\t}\r\n\t\r\n\t///////////////////////////////////\r\n\t///////// Initialization //////////\r\n\t///////////////////////////////////\r\n\t\r\n\tinitialize(){\r\n\t\tthis.initializeElement();\r\n\t\tthis.initializeColumns();\r\n\t\tthis.initializeRows();\r\n\t}\r\n\t\r\n\treinitialize(){\r\n\t\tthis.initializeColumns();\r\n\t\tthis.initializeRows();\r\n\t}\r\n\t\r\n\tinitializeElement(){\r\n\t\tthis.element = document.createElement(\"div\");\r\n\t\tthis.element.classList.add(\"tabulator-spreadsheet-tab\");\r\n\t\tthis.element.innerText = this.title;\r\n\t\t\r\n\t\tthis.element.addEventListener(\"click\", () => {\r\n\t\t\tthis.spreadsheetManager.loadSheet(this);\r\n\t\t});\r\n\t}\r\n\t\r\n\tinitializeColumns(){\r\n\t\tthis.grid.setColumnCount(this.columnCount);\r\n\t\tthis.columnFields = this.grid.genColumns(this.data);\r\n\t\t\r\n\t\tthis.columnDefs = [];\r\n\t\t\r\n\t\tthis.columnFields.forEach((ref) => {\r\n\t\t\tvar def = Object.assign({}, this.columnDefinition);\r\n\t\t\tdef.field = ref;\r\n\t\t\tdef.title = ref;\r\n\t\t\t\r\n\t\t\tthis.columnDefs.push(def);\r\n\t\t});\r\n\t}\r\n\t\r\n\tinitializeRows(){\r\n\t\tvar refs;\r\n\t\t\r\n\t\tthis.grid.setRowCount(this.rowCount);\r\n\t\t\r\n\t\trefs = this.grid.genRows(this.data);\r\n\t\t\r\n\t\tthis.rowDefs = [];\r\n\t\t\r\n\t\trefs.forEach((ref, i) => {\r\n\t\t\tvar def = {\"_id\":ref};\r\n\t\t\tvar data = this.data[i];\r\n\t\t\t\r\n\t\t\tif(data){\r\n\t\t\t\tdata.forEach((val, j) => {\r\n\t\t\t\t\tvar field = this.columnFields[j];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(field){\r\n\t\t\t\t\t\tdef[field] = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.rowDefs.push(def);\r\n\t\t});\r\n\t}\r\n\t\r\n\tunload(){\r\n\t\tthis.isActive = false;\r\n\t\tthis.scrollTop = this.table.rowManager.scrollTop;\r\n\t\tthis.scrollLeft = this.table.rowManager.scrollLeft;\r\n\t\tthis.data = this.getData(true);\r\n\t\tthis.element.classList.remove(\"tabulator-spreadsheet-tab-active\");\r\n\t}\r\n\t\r\n\tload(){\r\n\t\t\r\n\t\tvar wasInactive = !this.isActive;\r\n\t\t\r\n\t\tthis.isActive = true;\r\n\t\tthis.table.blockRedraw();\r\n\t\tthis.table.setData([]);\r\n\t\tthis.table.setColumns(this.columnDefs);\r\n\t\tthis.table.setData(this.rowDefs);\r\n\t\tthis.table.restoreRedraw();\r\n\t\t\r\n\t\tif(wasInactive && this.scrollTop !== null){\r\n\t\t\tthis.table.rowManager.element.scrollLeft = this.scrollLeft;\r\n\t\t\tthis.table.rowManager.element.scrollTop = this.scrollTop;\r\n\t\t}\r\n\t\t\r\n\t\tthis.element.classList.add(\"tabulator-spreadsheet-tab-active\");\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetLoaded\", this.getComponent());\r\n\t}\r\n\t\r\n\t///////////////////////////////////\r\n\t//////// Helper Functions /////////\r\n\t///////////////////////////////////\r\n\t\r\n\tgetComponent(){\r\n\t\treturn new SheetComponent(this);\r\n\t}\r\n\t\r\n\tgetDefinition(){\r\n\t\treturn {\r\n\t\t\ttitle:this.title,\r\n\t\t\tkey:this.key,\r\n\t\t\trows:this.rowCount,\r\n\t\t\tcolumns:this.columnCount,\r\n\t\t\tdata:this.getData(),\r\n\t\t};\r\n\t}\r\n\t\r\n\tgetData(full){\r\n\t\tvar output = [], \r\n\t\trowWidths,\r\n\t\toutputWidth, outputHeight;\r\n\t\t\r\n\t\t//map data to array format\r\n\t\tthis.rowDefs.forEach((rowData) => {\r\n\t\t\tvar row = [];\r\n\t\t\t\r\n\t\t\tthis.columnFields.forEach((field) => {\r\n\t\t\t\trow.push(rowData[field]);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\toutput.push(row);\r\n\t\t});\r\n\t\t\r\n\t\t//trim output\r\n\t\tif(!full && !this.options(\"spreadsheetOutputFull\")){\r\n\t\t\t\r\n\t\t\t//calculate used area of data\r\n\t\t\trowWidths = output.map(row => row.findLastIndex(val => typeof val !== 'undefined') + 1);\r\n\t\t\toutputWidth = Math.max(...rowWidths);\r\n\t\t\toutputHeight = rowWidths.findLastIndex(width => width > 0) + 1;\r\n\t\t\t\r\n\t\t\toutput = output.slice(0, outputHeight);\r\n\t\t\toutput = output.map(row => row.slice(0, outputWidth));\r\n\t\t}\r\n\t\t\r\n\t\treturn output;\r\n\t}\r\n\t\r\n\tsetData(data){\r\n\t\tthis.data = data;\r\n\t\tthis.reinitialize();\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetUpdated\", this.getComponent());\r\n\t\t\r\n\t\tif(this.isActive){\r\n\t\t\tthis.load();\r\n\t\t}\r\n\t}\r\n\t\r\n\tclear(){\r\n\t\tthis.setData([]);\r\n\t}\r\n\t\r\n\tsetTitle(title){\r\n\t\tthis.title = title;\r\n\t\tthis.element.innerText = title;\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetUpdated\", this.getComponent());\r\n\t}\r\n\t\r\n\tsetRows(rows){\r\n\t\tthis.rowCount = rows;\r\n\t\tthis.initializeRows();\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetUpdated\", this.getComponent());\r\n\t\t\r\n\t\tif(this.isActive){\r\n\t\t\tthis.load();\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetColumns(columns){\r\n\t\tthis.columnCount = columns;\r\n\t\tthis.reinitialize();\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetUpdated\", this.getComponent());\r\n\t\t\r\n\t\tif(this.isActive){\r\n\t\t\tthis.load();\r\n\t\t}\r\n\t}\r\n\t\r\n\tremove(){\r\n\t\tthis.spreadsheetManager.removeSheet(this);\r\n\t}\r\n\t\r\n\tdestroy(){\r\n\t\tif(this.element.parentNode){\r\n\t\t\tthis.element.parentNode.removeChild(this.element);\r\n\t\t}\r\n\t\t\r\n\t\tthis.dispatchExternal(\"sheetRemoved\", this.getComponent());\r\n\t}\r\n\t\r\n\tactive(){\r\n\t\tthis.spreadsheetManager.loadSheet(this);\r\n\t}\r\n}\n\nclass Spreadsheet extends Module{\r\n\t\r\n\tstatic moduleName = \"spreadsheet\";\r\n\t\r\n\tconstructor(table){\r\n\t\tsuper(table);\r\n\t\t\r\n\t\tthis.sheets = [];\r\n\t\tthis.element = null;\r\n\t\t\r\n\t\tthis.registerTableOption(\"spreadsheet\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetRows\", 50); \r\n\t\tthis.registerTableOption(\"spreadsheetColumns\", 50); \r\n\t\tthis.registerTableOption(\"spreadsheetColumnDefinition\", {}); \r\n\t\tthis.registerTableOption(\"spreadsheetOutputFull\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetData\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetSheets\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetSheetTabs\", false); \r\n\t\tthis.registerTableOption(\"spreadsheetSheetTabsElement\", false); \r\n\t\t\r\n\t\tthis.registerTableFunction(\"setSheets\", this.setSheets.bind(this));\r\n\t\tthis.registerTableFunction(\"addSheet\", this.addSheet.bind(this));\r\n\t\tthis.registerTableFunction(\"getSheets\", this.getSheets.bind(this));\r\n\t\tthis.registerTableFunction(\"getSheetDefinitions\", this.getSheetDefinitions.bind(this));\r\n\t\tthis.registerTableFunction(\"setSheetData\", this.setSheetData.bind(this));\r\n\t\tthis.registerTableFunction(\"getSheet\", this.getSheet.bind(this));\r\n\t\tthis.registerTableFunction(\"getSheetData\", this.getSheetData.bind(this));\r\n\t\tthis.registerTableFunction(\"clearSheet\", this.clearSheet.bind(this));\r\n\t\tthis.registerTableFunction(\"removeSheet\", this.removeSheetFunc.bind(this));\r\n\t\tthis.registerTableFunction(\"activeSheet\", this.activeSheetFunc.bind(this));\r\n\t}\r\n\t\r\n\t///////////////////////////////////\r\n\t////// Module Initialization //////\r\n\t///////////////////////////////////\r\n\t\r\n\t\r\n\tinitialize(){\r\n\t\tif(this.options(\"spreadsheet\")){\t\r\n\t\t\tthis.subscribe(\"table-initialized\", this.tableInitialized.bind(this));\r\n\t\t\tthis.subscribe(\"data-loaded\", this.loadRemoteData.bind(this));\r\n\t\t\t\r\n\t\t\tthis.table.options.index = \"_id\";\r\n\t\t\t\r\n\t\t\tif(this.options(\"spreadsheetData\") && this.options(\"spreadsheetSheets\")){\r\n\t\t\t\tconsole.warn(\"You cannot use spreadsheetData and spreadsheetSheets at the same time, ignoring spreadsheetData\");\r\n\t\t\t\t\r\n\t\t\t\tthis.table.options.spreadsheetData = false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.compatibilityCheck();\r\n\t\t\t\r\n\t\t\tif(this.options(\"spreadsheetSheetTabs\")){\r\n\t\t\t\tthis.initializeTabset();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tcompatibilityCheck(){\r\n\t\tif(this.options(\"data\")){\r\n\t\t\tconsole.warn(\"Do not use the data option when working with spreadsheets, use either spreadsheetData or spreadsheetSheets to pass data into the table\");\r\n\t\t}\r\n\t\t\r\n\t\tif(this.options(\"pagination\")){\r\n\t\t\tconsole.warn(\"The spreadsheet module is not compatible with the pagination module\");\r\n\t\t}\r\n\t\t\r\n\t\tif(this.options(\"groupBy\")){\r\n\t\t\tconsole.warn(\"The spreadsheet module is not compatible with the row grouping module\");\r\n\t\t}\r\n\t\t\r\n\t\tif(this.options(\"responsiveCollapse\")){\r\n\t\t\tconsole.warn(\"The spreadsheet module is not compatible with the responsive collapse module\");\r\n\t\t}\r\n\t}\r\n\tinitializeTabset(){\r\n\t\tthis.element = document.createElement(\"div\");\r\n\t\tthis.element.classList.add(\"tabulator-spreadsheet-tabs\");\r\n\t\tvar altContainer = this.options(\"spreadsheetSheetTabsElement\");\r\n\t\t\r\n\t\tif(altContainer && !(altContainer instanceof HTMLElement)){\r\n\t\t\taltContainer = document.querySelector(altContainer);\r\n\t\t\t\r\n\t\t\tif(!altContainer){\r\n\t\t\t\tconsole.warn(\"Unable to find element matching spreadsheetSheetTabsElement selector:\", this.options(\"spreadsheetSheetTabsElement\"));\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(altContainer){\r\n\t\t\taltContainer.appendChild(this.element);\r\n\t\t}else {\r\n\t\t\tthis.footerAppend(this.element);\r\n\t\t}\r\n\t}\r\n\t\r\n\ttableInitialized(){\r\n\t\tif(this.sheets.length){\r\n\t\t\tthis.loadSheet(this.sheets[0]);\r\n\t\t}else {\r\n\t\t\t\r\n\t\t\tif(this.options(\"spreadsheetSheets\")){\r\n\t\t\t\tthis.loadSheets(this.options(\"spreadsheetSheets\"));\r\n\t\t\t}else if(this.options(\"spreadsheetData\")){\r\n\t\t\t\tthis.loadData(this.options(\"spreadsheetData\"));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t///////////////////////////////////\r\n\t/////////// Ajax Parsing //////////\r\n\t///////////////////////////////////\r\n\r\n\tloadRemoteData(data, data1, data2){\r\n\t\tconsole.log(\"data\", data, data1, data2);\r\n\r\n\t\tif(Array.isArray(data)){\r\n\r\n\t\t\tthis.table.dataLoader.clearAlert();\r\n\t\t\tthis.dispatchExternal(\"dataLoaded\", data);\r\n\r\n\t\t\tif(!data.length || Array.isArray(data[0])){\r\n\t\t\t\tthis.loadData(data);\r\n\t\t\t}else {\r\n\t\t\t\tthis.loadSheets(data);\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tconsole.error(\"Spreadsheet Loading Error - Unable to process remote data due to invalid data type \\nExpecting: array \\nReceived: \", typeof data, \"\\nData:     \", data);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t///////////////////////////////////\r\n\t///////// Sheet Management ////////\r\n\t///////////////////////////////////\r\n\t\r\n\t\r\n\tloadData(data){\r\n\t\tvar def = {\r\n\t\t\tdata:data,\r\n\t\t};\r\n\t\t\r\n\t\tthis.loadSheet(this.newSheet(def));\r\n\t}\r\n\t\r\n\tdestroySheets(){\r\n\t\tthis.sheets.forEach((sheet) => {\r\n\t\t\tsheet.destroy();\r\n\t\t});\r\n\t\t\r\n\t\tthis.sheets = [];\r\n\t\tthis.activeSheet = null;\r\n\t}\r\n\t\r\n\tloadSheets(sheets){\t\r\n\t\tif(!Array.isArray(sheets)){\r\n\t\t\tsheets = [];\r\n\t\t}\r\n\t\t\r\n\t\tthis.destroySheets();\r\n\t\t\r\n\t\tsheets.forEach((def) => {\r\n\t\t\tthis.newSheet(def);\r\n\t\t});\r\n\t\t\r\n\t\tthis.loadSheet(this.sheets[0]);\r\n\t}\r\n\t\r\n\tloadSheet(sheet){\r\n\t\tif(this.activeSheet !== sheet){\r\n\t\t\tif(this.activeSheet){\r\n\t\t\t\tthis.activeSheet.unload();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.activeSheet = sheet;\r\n\t\t\t\r\n\t\t\tsheet.load();\r\n\t\t}\r\n\t}\r\n\t\r\n\tnewSheet(definition = {}){\r\n\t\tvar sheet;\r\n\t\t\r\n\t\tif(!definition.rows){\r\n\t\t\tdefinition.rows = this.options(\"spreadsheetRows\");\r\n\t\t}\r\n\t\t\r\n\t\tif(!definition.columns){\r\n\t\t\tdefinition.columns = this.options(\"spreadsheetColumns\");\r\n\t\t}\r\n\t\t\r\n\t\tsheet = new Sheet(this, definition);\r\n\t\t\r\n\t\tthis.sheets.push(sheet);\r\n\t\t\r\n\t\tif(this.element){\r\n\t\t\tthis.element.appendChild(sheet.element);\r\n\t\t}\r\n\t\t\r\n\t\treturn sheet;\r\n\t}\r\n\t\r\n\tremoveSheet(sheet){\r\n\t\tvar index = this.sheets.indexOf(sheet),\r\n\t\tprevSheet;\r\n\t\t\r\n\t\tif(this.sheets.length > 1){\r\n\t\t\tif(index > -1){\r\n\t\t\t\tthis.sheets.splice(index, 1);\r\n\t\t\t\tsheet.destroy();\r\n\t\t\t\t\r\n\t\t\t\tif(this.activeSheet === sheet){\r\n\t\t\t\t\t\r\n\t\t\t\t\tprevSheet = this.sheets[index - 1] || this.sheets[0];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(prevSheet){\r\n\t\t\t\t\t\tthis.loadSheet(prevSheet);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t\tthis.activeSheet = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tconsole.warn(\"Unable to remove sheet, at least one sheet must be active\");\r\n\t\t}\r\n\t}\r\n\t\r\n\tlookupSheet(key){\r\n\t\tif(!key){\r\n\t\t\treturn this.activeSheet;\r\n\t\t}else if(key instanceof Sheet){\r\n\t\t\treturn key;\r\n\t\t}else if(key instanceof SheetComponent){\r\n\t\t\treturn key._sheet;\r\n\t\t}else {\r\n\t\t\treturn this.sheets.find(sheet => sheet.key === key) || false;\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t///////////////////////////////////\r\n\t//////// Public Functions /////////\r\n\t///////////////////////////////////\r\n\t\r\n\tsetSheets(sheets){\r\n\t\tthis.loadSheets(sheets);\r\n\r\n\t\treturn this.getSheets();\r\n\t}\r\n\r\n\taddSheet(sheet){\r\n\t\treturn this.newSheet(sheet).getComponent();\r\n\t}\r\n\t\r\n\tgetSheetDefinitions(){\r\n\t\treturn this.sheets.map(sheet => sheet.getDefinition());\r\n\t}\r\n\t\r\n\tgetSheets(){\r\n\t\treturn this.sheets.map(sheet => sheet.getComponent());\r\n\t}\r\n\t\r\n\tgetSheet(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? sheet.getComponent() : false;\r\n\t}\r\n\t\r\n\tsetSheetData(key, data){\r\n\t\tif (key && !data){\r\n\t\t\tdata = key;\r\n\t\t\tkey = false;\r\n\t\t}\r\n\t\t\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? sheet.setData(data) : false;\t\r\n\t}\r\n\t\r\n\tgetSheetData(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? sheet.getData() : false;\t\r\n\t}\r\n\t\r\n\tclearSheet(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? sheet.clear() : false;\r\n\t}\r\n\t\r\n\tremoveSheetFunc(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\tif(sheet){\r\n\t\t\tthis.removeSheet(sheet);\r\n\t\t}\r\n\t}\r\n\t\r\n\tactiveSheetFunc(key){\r\n\t\tvar sheet = this.lookupSheet(key);\r\n\t\t\r\n\t\treturn sheet ? this.loadSheet(sheet) : false;\r\n\t}\r\n}\n\nclass Tooltip extends Module{\n\n\tstatic moduleName = \"tooltip\";\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.tooltipSubscriber = null,\n\t\tthis.headerSubscriber = null,\n\t\t\n\t\tthis.timeout = null;\n\t\tthis.popupInstance = null;\n\t\t\n\t\t// this.registerTableOption(\"tooltipGenerationMode\", undefined);  //deprecated\n\t\tthis.registerTableOption(\"tooltipDelay\", 300); \n\t\t\n\t\tthis.registerColumnOption(\"tooltip\");\n\t\tthis.registerColumnOption(\"headerTooltip\");\n\t}\n\t\n\tinitialize(){\n\t\tthis.deprecatedOptionsCheck();\n\t\t\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t}\n\t\n\tdeprecatedOptionsCheck(){\n\t\t// this.deprecationCheckMsg(\"tooltipGenerationMode\", \"This option is no longer needed as tooltips are always generated on hover now\");\n\t}\t\n\t\n\tinitializeColumn(column){\n\t\tif(column.definition.headerTooltip && !this.headerSubscriber){\n\t\t\tthis.headerSubscriber = true;\n\t\t\t\n\t\t\tthis.subscribe(\"column-mousemove\", this.mousemoveCheck.bind(this, \"headerTooltip\"));\n\t\t\tthis.subscribe(\"column-mouseout\", this.mouseoutCheck.bind(this, \"headerTooltip\"));\n\t\t}\n\t\t\n\t\tif(column.definition.tooltip && !this.tooltipSubscriber){\n\t\t\tthis.tooltipSubscriber = true;\n\t\t\t\n\t\t\tthis.subscribe(\"cell-mousemove\", this.mousemoveCheck.bind(this, \"tooltip\"));\n\t\t\tthis.subscribe(\"cell-mouseout\", this.mouseoutCheck.bind(this, \"tooltip\"));\n\t\t}\n\t}\n\t\n\tmousemoveCheck(action, e, component){\n\t\tvar tooltip = action === \"tooltip\" ? component.column.definition.tooltip : component.definition.headerTooltip;\n\t\t\n\t\tif(tooltip){\n\t\t\tthis.clearPopup();\n\t\t\tthis.timeout = setTimeout(this.loadTooltip.bind(this, e, component, tooltip), this.table.options.tooltipDelay);\n\t\t}\n\t}\n\n\tmouseoutCheck(action, e, component){\n\t\tif(!this.popupInstance){\n\t\t\tthis.clearPopup();\n\t\t}\n\t}\n\t\n\tclearPopup(action, e, component){\n\t\tclearTimeout(this.timeout);\n\t\tthis.timeout = null;\n\t\t\n\t\tif(this.popupInstance){\n\t\t\tthis.popupInstance.hide();\n\t\t}\n\t}\n\t\n\tloadTooltip(e, component, tooltip){\n\t\tvar contentsEl, renderedCallback, coords;\n\n\t\tfunction onRendered(callback){\n\t\t\trenderedCallback = callback;\n\t\t}\n\t\t\n\t\tif(typeof tooltip === \"function\"){\n\t\t\ttooltip = tooltip(e, component.getComponent(), onRendered);\n\t\t}\n\t\t\n\t\tif(tooltip instanceof HTMLElement){\n\t\t\tcontentsEl = tooltip;\n\t\t}else {\n\t\t\tcontentsEl = document.createElement(\"div\");\n\t\t\t\n\t\t\tif(tooltip === true){\n\t\t\t\tif(component instanceof Cell){\n\t\t\t\t\ttooltip = component.value;\n\t\t\t\t}else {\n\t\t\t\t\tif(component.definition.field){\n\t\t\t\t\t\tthis.langBind(\"columns|\" + component.definition.field, (value) => {\n\t\t\t\t\t\t\tcontentsEl.innerHTML = tooltip = value || component.definition.title;\n\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\ttooltip = component.definition.title;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tcontentsEl.innerHTML = tooltip;\n\t\t}\n\t\t\n\t\tif(tooltip || tooltip === 0 || tooltip === false){\n\t\t\tcontentsEl.classList.add(\"tabulator-tooltip\");\n\n\t\t\tcontentsEl.addEventListener(\"mousemove\", e => e.preventDefault());\n\t\t\t\n\t\t\tthis.popupInstance = this.popup(contentsEl);\n\t\t\t\n\t\t\tif(typeof renderedCallback === \"function\"){\n\t\t\t\tthis.popupInstance.renderCallback(renderedCallback);\n\t\t\t}\n\n\t\t\tcoords = this.popupInstance.containerEventCoords(e);\n\t\t\t\n\t\t\tthis.popupInstance.show(coords.x + 15, coords.y + 15).hideOnBlur(() => {\n\t\t\t\tthis.dispatchExternal(\"TooltipClosed\", component.getComponent());\n\t\t\t\tthis.popupInstance = null;\n\t\t\t});\n\t\t\t\n\t\t\tthis.dispatchExternal(\"TooltipOpened\", component.getComponent());\n\t\t}\n\t}\n}\n\nvar defaultValidators = {\n\t//is integer\n\tinteger: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\n\t\tvalue = Number(value);\n\n\t\treturn !isNaN(value) && isFinite(value) && Math.floor(value) === value;\n\t},\n\n\t//is float\n\tfloat: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\tvalue = Number(value);\n\n\t\treturn !isNaN(value) && isFinite(value) && value % 1 !== 0;\n\t},\n\n\t//must be a number\n\tnumeric: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn !isNaN(value);\n\t},\n\n\t//must be a string\n\tstring: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn isNaN(value);\n\t},\n\n\t//must be alphanumeric\n\talphanumeric: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\n\t\tvar reg = new RegExp(/^[a-z0-9]+$/i);\n\n\t\treturn reg.test(value);\n\t},\n\n\t//maximum value\n\tmax: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn parseFloat(value) <= parameters;\n\t},\n\n\t//minimum value\n\tmin: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn parseFloat(value) >= parameters;\n\t},\n\n\t//starts with  value\n\tstarts: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).toLowerCase().startsWith(String(parameters).toLowerCase());\n\t},\n\n\t//ends with  value\n\tends: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).toLowerCase().endsWith(String(parameters).toLowerCase());\n\t},\n\n\n\t//minimum string length\n\tminLength: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).length >= parameters;\n\t},\n\n\t//maximum string length\n\tmaxLength: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).length <= parameters;\n\t},\n\n\t//in provided value list\n\tin: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\n\t\tif(typeof parameters == \"string\"){\n\t\t\tparameters = parameters.split(\"|\");\n\t\t}\n\n\t\treturn parameters.indexOf(value) > -1;\n\t},\n\n\t//must match provided regex\n\tregex: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\tvar reg = new RegExp(parameters);\n\n\t\treturn reg.test(value);\n\t},\n\n\t//value must be unique in this column\n\tunique: function(cell, value, parameters){\n\t\tif(value === \"\" || value === null || typeof value === \"undefined\"){\n\t\t\treturn true;\n\t\t}\n\t\tvar unique = true;\n\n\t\tvar cellData = cell.getData();\n\t\tvar column = cell.getColumn()._getSelf();\n\n\t\tthis.table.rowManager.rows.forEach(function(row){\n\t\t\tvar data = row.getData();\n\n\t\t\tif(data !== cellData){\n\t\t\t\tif(value == column.getFieldValue(data)){\n\t\t\t\t\tunique = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn unique;\n\t},\n\n\t//must have a value\n\trequired:function(cell, value, parameters){\n\t\treturn value !== \"\" && value !== null && typeof value !== \"undefined\";\n\t},\n};\n\nclass Validate extends Module{\n\n\tstatic moduleName = \"validate\";\n\n\t//load defaults\n\tstatic validators = defaultValidators;\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.invalidCells = [];\n\t\t\n\t\tthis.registerTableOption(\"validationMode\", \"blocking\");\n\t\t\n\t\tthis.registerColumnOption(\"validator\");\n\t\t\n\t\tthis.registerTableFunction(\"getInvalidCells\", this.getInvalidCells.bind(this));\n\t\tthis.registerTableFunction(\"clearCellValidation\", this.userClearCellValidation.bind(this));\n\t\tthis.registerTableFunction(\"validate\", this.userValidate.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"cell\", \"isValid\", this.cellIsValid.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"clearValidation\", this.clearValidation.bind(this));\n\t\tthis.registerComponentFunction(\"cell\", \"validate\", this.cellValidate.bind(this));\n\t\t\n\t\tthis.registerComponentFunction(\"column\", \"validate\", this.columnValidate.bind(this));\n\t\tthis.registerComponentFunction(\"row\", \"validate\", this.rowValidate.bind(this));\n\t}\n\t\n\t\n\tinitialize(){\n\t\tthis.subscribe(\"cell-delete\", this.clearValidation.bind(this));\n\t\tthis.subscribe(\"column-layout\", this.initializeColumnCheck.bind(this));\n\t\t\n\t\tthis.subscribe(\"edit-success\", this.editValidate.bind(this));\n\t\tthis.subscribe(\"edit-editor-clear\", this.editorClear.bind(this));\n\t\tthis.subscribe(\"edit-edited-clear\", this.editedClear.bind(this));\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Event Handling //////////\n\t///////////////////////////////////\n\t\n\teditValidate(cell, value, previousValue){\n\t\tvar valid = this.table.options.validationMode !== \"manual\" ? this.validate(cell.column.modules.validate, cell, value) : true;\n\t\t\n\t\t// allow time for editor to make render changes then style cell\n\t\tif(valid !== true){\n\t\t\tsetTimeout(() => {\n\t\t\t\tcell.getElement().classList.add(\"tabulator-validation-fail\");\n\t\t\t\tthis.dispatchExternal(\"validationFailed\", cell.getComponent(), value, valid);\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn valid;\n\t}\n\t\n\teditorClear(cell, cancelled){\n\t\tif(cancelled){\n\t\t\tif(cell.column.modules.validate){\n\t\t\t\tthis.cellValidate(cell);\n\t\t\t}\n\t\t}\n\n\t\tcell.getElement().classList.remove(\"tabulator-validation-fail\");\n\t}\n\t\n\teditedClear(cell){\n\t\tif(cell.modules.validate){\n\t\t\tcell.modules.validate.invalid = false;\n\t\t}\n\t}\n\t\n\t///////////////////////////////////\n\t////////// Cell Functions /////////\n\t///////////////////////////////////\n\t\n\tcellIsValid(cell){\n\t\treturn cell.modules.validate ? (cell.modules.validate.invalid || true) : true;\n\t}\n\t\n\tcellValidate(cell){\n\t\treturn this.validate(cell.column.modules.validate, cell, cell.getValue());\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Column Functions ////////\n\t///////////////////////////////////\n\t\n\tcolumnValidate(column){\n\t\tvar invalid = [];\n\t\t\n\t\tcolumn.cells.forEach((cell) => {\n\t\t\tif(this.cellValidate(cell) !== true){\n\t\t\t\tinvalid.push(cell.getComponent());\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn invalid.length ? invalid : true;\n\t}\n\t\n\t///////////////////////////////////\n\t////////// Row Functions //////////\n\t///////////////////////////////////\n\t\n\trowValidate(row){\n\t\tvar invalid = [];\n\t\t\n\t\trow.cells.forEach((cell) => {\n\t\t\tif(this.cellValidate(cell) !== true){\n\t\t\t\tinvalid.push(cell.getComponent());\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn invalid.length ? invalid : true;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Table Functions /////////\n\t///////////////////////////////////\n\t\n\t\n\tuserClearCellValidation(cells){\n\t\tif(!cells){\n\t\t\tcells = this.getInvalidCells();\n\t\t}\n\t\t\n\t\tif(!Array.isArray(cells)){\n\t\t\tcells = [cells];\n\t\t}\n\t\t\n\t\tcells.forEach((cell) => {\n\t\t\tthis.clearValidation(cell._getSelf());\n\t\t});\n\t}\n\t\n\tuserValidate(cells){\n\t\tvar output = [];\n\t\t\n\t\t//clear row data\n\t\tthis.table.rowManager.rows.forEach((row) => {\n\t\t\trow = row.getComponent();\n\t\t\t\n\t\t\tvar valid = row.validate();\n\t\t\t\n\t\t\tif(valid !== true){\n\t\t\t\toutput = output.concat(valid);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn output.length ? output : true;\n\t}\n\t\n\t///////////////////////////////////\n\t///////// Internal Logic //////////\n\t///////////////////////////////////\n\t\n\tinitializeColumnCheck(column){\n\t\tif(typeof column.definition.validator !== \"undefined\"){\n\t\t\tthis.initializeColumn(column);\n\t\t}\n\t}\n\t\n\t//validate\n\tinitializeColumn(column){\n\t\tvar self = this,\n\t\tconfig = [],\n\t\tvalidator;\n\t\t\n\t\tif(column.definition.validator){\n\t\t\t\n\t\t\tif(Array.isArray(column.definition.validator)){\n\t\t\t\tcolumn.definition.validator.forEach((item) => {\n\t\t\t\t\tvalidator = self._extractValidator(item);\n\t\t\t\t\t\n\t\t\t\t\tif(validator){\n\t\t\t\t\t\tconfig.push(validator);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\tvalidator = this._extractValidator(column.definition.validator);\n\t\t\t\t\n\t\t\t\tif(validator){\n\t\t\t\t\tconfig.push(validator);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tcolumn.modules.validate = config.length ? config : false;\n\t\t}\n\t}\n\t\n\t_extractValidator(value){\n\t\tvar type, params, pos;\n\t\t\n\t\tswitch(typeof value){\n\t\t\tcase \"string\":\n\t\t\t\tpos = value.indexOf(':');\n\t\t\t\n\t\t\t\tif(pos > -1){\n\t\t\t\t\ttype = value.substring(0,pos);\n\t\t\t\t\tparams = value.substring(pos+1);\n\t\t\t\t}else {\n\t\t\t\t\ttype = value;\n\t\t\t\t}\n\t\t\t\n\t\t\t\treturn this._buildValidator(type, params);\n\t\t\t\n\t\t\tcase \"function\":\n\t\t\t\treturn this._buildValidator(value);\n\t\t\t\n\t\t\tcase \"object\":\n\t\t\t\treturn this._buildValidator(value.type, value.parameters);\n\t\t}\n\t}\n\t\n\t_buildValidator(type, params){\n\t\t\n\t\tvar func = typeof type == \"function\" ? type : Validate.validators[type];\n\t\t\n\t\tif(!func){\n\t\t\tconsole.warn(\"Validator Setup Error - No matching validator found:\", type);\n\t\t\treturn false;\n\t\t}else {\n\t\t\treturn {\n\t\t\t\ttype:typeof type == \"function\" ? \"function\" : type,\n\t\t\t\tfunc:func,\n\t\t\t\tparams:params,\n\t\t\t};\n\t\t}\n\t}\n\t\n\tvalidate(validators, cell, value){\n\t\tvar self = this,\n\t\tfailedValidators = [],\n\t\tinvalidIndex = this.invalidCells.indexOf(cell);\n\t\t\n\t\tif(validators){\n\t\t\tvalidators.forEach((item) => {\n\t\t\t\tif(!item.func.call(self, cell.getComponent(), value, item.params)){\n\t\t\t\t\tfailedValidators.push({\n\t\t\t\t\t\ttype:item.type,\n\t\t\t\t\t\tparameters:item.params\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tif(!cell.modules.validate){\n\t\t\tcell.modules.validate = {};\n\t\t}\n\t\t\n\t\tif(!failedValidators.length){\n\t\t\tcell.modules.validate.invalid = false;\n\t\t\tcell.getElement().classList.remove(\"tabulator-validation-fail\");\n\t\t\t\n\t\t\tif(invalidIndex > -1){\n\t\t\t\tthis.invalidCells.splice(invalidIndex, 1);\n\t\t\t}\n\t\t}else {\n\t\t\tcell.modules.validate.invalid = failedValidators;\n\t\t\t\n\t\t\tif(this.table.options.validationMode !== \"manual\"){\n\t\t\t\tcell.getElement().classList.add(\"tabulator-validation-fail\");\n\t\t\t}\n\t\t\t\n\t\t\tif(invalidIndex == -1){\n\t\t\t\tthis.invalidCells.push(cell);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn failedValidators.length ? failedValidators : true;\n\t}\n\t\n\tgetInvalidCells(){\n\t\tvar output = [];\n\t\t\n\t\tthis.invalidCells.forEach((cell) => {\n\t\t\toutput.push(cell.getComponent());\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tclearValidation(cell){\n\t\tvar invalidIndex;\n\t\t\n\t\tif(cell.modules.validate && cell.modules.validate.invalid){\n\t\t\t\n\t\t\tcell.getElement().classList.remove(\"tabulator-validation-fail\");\n\t\t\tcell.modules.validate.invalid = false;\n\t\t\t\n\t\t\tinvalidIndex = this.invalidCells.indexOf(cell);\n\t\t\t\n\t\t\tif(invalidIndex > -1){\n\t\t\t\tthis.invalidCells.splice(invalidIndex, 1);\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar allModules = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tAccessorModule: Accessor,\n\tAjaxModule: Ajax,\n\tClipboardModule: Clipboard,\n\tColumnCalcsModule: ColumnCalcs,\n\tDataTreeModule: DataTree,\n\tDownloadModule: Download,\n\tEditModule: Edit,\n\tExportModule: Export,\n\tFilterModule: Filter,\n\tFormatModule: Format,\n\tFrozenColumnsModule: FrozenColumns,\n\tFrozenRowsModule: FrozenRows,\n\tGroupRowsModule: GroupRows,\n\tHistoryModule: History,\n\tHtmlTableImportModule: HtmlTableImport,\n\tImportModule: Import,\n\tInteractionModule: Interaction,\n\tKeybindingsModule: Keybindings,\n\tMenuModule: Menu,\n\tMoveColumnsModule: MoveColumns,\n\tMoveRowsModule: MoveRows,\n\tMutatorModule: Mutator,\n\tPageModule: Page,\n\tPersistenceModule: Persistence,\n\tPopupModule: Popup,\n\tPrintModule: Print,\n\tReactiveDataModule: ReactiveData,\n\tResizeColumnsModule: ResizeColumns,\n\tResizeRowsModule: ResizeRows,\n\tResizeTableModule: ResizeTable,\n\tResponsiveLayoutModule: ResponsiveLayout,\n\tSelectRangeModule: SelectRange,\n\tSelectRowModule: SelectRow,\n\tSortModule: Sort,\n\tSpreadsheetModule: Spreadsheet,\n\tTooltipModule: Tooltip,\n\tValidateModule: Validate\n});\n\nvar defaultOptions = {\n\n\tdebugEventsExternal:false, //flag to console log events\n\tdebugEventsInternal:false, //flag to console log events\n\tdebugInvalidOptions:true, //allow toggling of invalid option warnings\n\tdebugInvalidComponentFuncs:true, //allow toggling of invalid component warnings\n\tdebugInitialization:true, //allow toggling of pre initialization function call warnings\n\tdebugDeprecation:true, //allow toggling of deprecation warnings\n\n\theight:false, //height of tabulator\n\tminHeight:false, //minimum height of tabulator\n\tmaxHeight:false, //maximum height of tabulator\n\n\tcolumnHeaderVertAlign:\"top\", //vertical alignment of column headers\n\n\tpopupContainer:false,\n\n\tcolumns:[],//store for colum header info\n\tcolumnDefaults:{}, //store column default props\n\trowHeader:false,\n\n\tdata:false, //default starting data\n\n\tautoColumns:false, //build columns from data row structure\n\tautoColumnsDefinitions:false,\n\n\tnestedFieldSeparator:\".\", //separator for nested data\n\n\tfooterElement:false, //hold footer element\n\n\tindex:\"id\", //filed for row index\n\n\ttextDirection:\"auto\",\n\n\taddRowPos:\"bottom\", //position to insert blank rows, top|bottom\n\n\theaderVisible:true, //hide header\n\n\trenderVertical:\"virtual\",\n\trenderHorizontal:\"basic\",\n\trenderVerticalBuffer:0, // set virtual DOM buffer size\n\n\tscrollToRowPosition:\"top\",\n\tscrollToRowIfVisible:true,\n\n\tscrollToColumnPosition:\"left\",\n\tscrollToColumnIfVisible:true,\n\n\trowFormatter:false,\n\trowFormatterPrint:null,\n\trowFormatterClipboard:null,\n\trowFormatterHtmlOutput:null,\n\n\trowHeight:null,\n\n\tplaceholder:false,\n\n\tdataLoader:true,\n\tdataLoaderLoading:false,\n\tdataLoaderError:false,\n\tdataLoaderErrorTimeout:3000,\n\tdataSendParams:{},\n\tdataReceiveParams:{},\n\n\tdependencies:{},\n};\n\nclass OptionsList {\n\tconstructor(table, msgType, defaults = {}){\n\t\tthis.table = table;\n\t\tthis.msgType = msgType;\n\t\tthis.registeredDefaults = Object.assign({}, defaults);\n\t}\n\t\n\tregister(option, value){\n\t\tthis.registeredDefaults[option] = value;\n\t}\n\t\n\tgenerate(defaultOptions, userOptions = {}){\n\t\tvar output = Object.assign({}, this.registeredDefaults),\n\t\twarn = this.table.options.debugInvalidOptions || userOptions.debugInvalidOptions === true;\n\t\t\n\t\tObject.assign(output, defaultOptions);\n\t\t\n\t\tfor (let key in userOptions){\n\t\t\tif(!output.hasOwnProperty(key)){\n\t\t\t\tif(warn){\n\t\t\t\t\tconsole.warn(\"Invalid \" + this.msgType + \" option:\", key);\n\t\t\t\t}\n\n\t\t\t\toutput[key] = userOptions.key;\n\t\t\t}\n\t\t}\n\t\n\t\t\n\t\tfor (let key in output){\n\t\t\tif(key in userOptions){\n\t\t\t\toutput[key] = userOptions[key];\n\t\t\t}else {\n\t\t\t\tif(Array.isArray(output[key])){\n\t\t\t\t\toutput[key] = Object.assign([], output[key]);\n\t\t\t\t}else if(typeof output[key] === \"object\" && output[key] !== null){\n\t\t\t\t\toutput[key] = Object.assign({}, output[key]);\n\t\t\t\t}else if (typeof output[key] === \"undefined\"){\n\t\t\t\t\tdelete output[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n}\n\nclass Renderer extends CoreFeature{\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.elementVertical = table.rowManager.element;\n\t\tthis.elementHorizontal = table.columnManager.element;\n\t\tthis.tableElement =  table.rowManager.tableElement;\n\n\t\tthis.verticalFillMode = \"fit\"; // used by row manager to determine how to size the render area (\"fit\" - fits container to the contents, \"fill\" - fills the container without resizing it)\n\t}\n\n\n\t///////////////////////////////////\n\t/////// Internal Bindings /////////\n\t///////////////////////////////////\n\n\tinitialize(){\n\t\t//initialize core functionality\n\t}\n\n\tclearRows(){\n\t\t//clear down existing rows layout\n\t}\n\n\tclearColumns(){\n\t\t//clear down existing columns layout\n\t}\n\n\n\treinitializeColumnWidths(columns){\n\t\t//resize columns to fit data\n\t}\n\n\n\trenderRows(){\n\t\t//render rows from a clean slate\n\t}\n\n\trenderColumns(){\n\t\t//render columns from a clean slate\n\t}\n\n\trerenderRows(callback){\n\t\t// rerender rows and keep position\n\t\tif(callback){\n\t\t\tcallback();\n\t\t}\n\t}\n\n\trerenderColumns(update, blockRedraw){\n\t\t//rerender columns\n\t}\n\n\trenderRowCells(row){\n\t\t//render the cells in a row\n\t}\n\n\trerenderRowCells(row, force){\n\t\t//rerender the cells in a row\n\t}\n\n\tscrollColumns(left, dir){\n\t\t//handle horizontal scrolling\n\t}\n\n\tscrollRows(top, dir){\n\t\t//handle vertical scrolling\n\t}\n\n\tresize(){\n\t\t//container has resized, carry out any needed recalculations (DO NOT RERENDER IN THIS FUNCTION)\n\t}\n\n\tscrollToRow(row){\n\t\t//scroll to a specific row\n\t}\n\n\tscrollToRowNearestTop(row){\n\t\t//determine weather the row is nearest the top or bottom of the table, return true for top or false for bottom\n\t}\n\n\tvisibleRows(includingBuffer){\n\t\t//return the visible rows\n\t\treturn [];\n\t}\n\n\t///////////////////////////////////\n\t//////// Helper Functions /////////\n\t///////////////////////////////////\n\n\trows(){\n\t\treturn this.table.rowManager.getDisplayRows();\n\t}\n\n\tstyleRow(row, index){\n\t\tvar rowEl = row.getElement();\n\n\t\tif(index % 2){\n\t\t\trowEl.classList.add(\"tabulator-row-even\");\n\t\t\trowEl.classList.remove(\"tabulator-row-odd\");\n\t\t}else {\n\t\t\trowEl.classList.add(\"tabulator-row-odd\");\n\t\t\trowEl.classList.remove(\"tabulator-row-even\");\n\t\t}\n\t}\n\n\t///////////////////////////////////\n\t/////// External Triggers /////////\n\t/////// (DO NOT OVERRIDE) /////////\n\t///////////////////////////////////\n\n\tclear(){\n\t\t//clear down existing layout\n\t\tthis.clearRows();\n\t\tthis.clearColumns();\n\t}\n\n\trender(){\n\t\t//render from a clean slate\n\t\tthis.renderRows();\n\t\tthis.renderColumns();\n\t}\n\n\trerender(callback){\n\t\t// rerender and keep position\n\t\tthis.rerenderRows();\n\t\tthis.rerenderColumns();\n\t}\n\n\tscrollToRowPosition(row, position, ifVisible){\n\t\tvar rowIndex = this.rows().indexOf(row),\n\t\trowEl = row.getElement(),\n\t\toffset = 0;\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif(rowIndex > -1){\n\n\t\t\t\tif(typeof ifVisible === \"undefined\"){\n\t\t\t\t\tifVisible = this.table.options.scrollToRowIfVisible;\n\t\t\t\t}\n\n\t\t\t\t//check row visibility\n\t\t\t\tif(!ifVisible){\n\t\t\t\t\tif(Helpers.elVisible(rowEl)){\n\t\t\t\t\t\toffset = Helpers.elOffset(rowEl).top - Helpers.elOffset(this.elementVertical).top;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(offset > 0 && offset < this.elementVertical.clientHeight - rowEl.offsetHeight){\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(typeof position === \"undefined\"){\n\t\t\t\t\tposition = this.table.options.scrollToRowPosition;\n\t\t\t\t}\n\n\t\t\t\tif(position === \"nearest\"){\n\t\t\t\t\tposition = this.scrollToRowNearestTop(row) ? \"top\" : \"bottom\";\n\t\t\t\t}\n\n\t\t\t\t//scroll to row\n\t\t\t\tthis.scrollToRow(row);\n\n\t\t\t\t//align to correct position\n\t\t\t\tswitch(position){\n\t\t\t\t\tcase \"middle\":\n\t\t\t\t\tcase \"center\":\n\n\t\t\t\t\t\tif(this.elementVertical.scrollHeight - this.elementVertical.scrollTop == this.elementVertical.clientHeight){\n\t\t\t\t\t\t\tthis.elementVertical.scrollTop = this.elementVertical.scrollTop + (rowEl.offsetTop - this.elementVertical.scrollTop) - ((this.elementVertical.scrollHeight - rowEl.offsetTop) / 2);\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tthis.elementVertical.scrollTop = this.elementVertical.scrollTop - (this.elementVertical.clientHeight / 2);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"bottom\":\n\n\t\t\t\t\t\tif(this.elementVertical.scrollHeight - this.elementVertical.scrollTop == this.elementVertical.clientHeight){\n\t\t\t\t\t\t\tthis.elementVertical.scrollTop = this.elementVertical.scrollTop - (this.elementVertical.scrollHeight - rowEl.offsetTop) + rowEl.offsetHeight;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tthis.elementVertical.scrollTop = this.elementVertical.scrollTop - this.elementVertical.clientHeight + rowEl.offsetHeight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"top\":\n\t\t\t\t\t\tthis.elementVertical.scrollTop = rowEl.offsetTop;\t\t\t\t\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tresolve();\n\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Scroll Error - Row not visible\");\n\t\t\t\treject(\"Scroll Error - Row not visible\");\n\t\t\t}\n\t\t});\n\t}\n}\n\nclass BasicHorizontal extends Renderer{\n\tconstructor(table){\n\t\tsuper(table);\n\t}\n\t\n\trenderRowCells(row, inFragment) {\n\t\tconst rowFrag = document.createDocumentFragment();\n\t\trow.cells.forEach((cell) => {\n\t\t\trowFrag.appendChild(cell.getElement());\n\t\t});\n\t\trow.element.appendChild(rowFrag);\n\t\t\n\t\tif(!inFragment){\n\t\t\trow.cells.forEach((cell) => {\n\t\t\t\tcell.cellRendered();\n\t\t\t});\n\t\t}\n\t}\n\t\n\treinitializeColumnWidths(columns){\n\t\tcolumns.forEach(function(column){\n\t\t\tcolumn.reinitializeWidth();\n\t\t});\n\t}\n}\n\nclass VirtualDomHorizontal extends Renderer{\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.leftCol = 0;\n\t\tthis.rightCol = 0;\n\t\tthis.scrollLeft = 0;\n\t\t\n\t\tthis.vDomScrollPosLeft = 0;\n\t\tthis.vDomScrollPosRight = 0;\n\t\t\n\t\tthis.vDomPadLeft = 0;\n\t\tthis.vDomPadRight = 0;\n\t\t\n\t\tthis.fitDataColAvg = 0;\n\t\t\n\t\tthis.windowBuffer = 200; //pixel margin to make column visible before it is shown on screen\n\t\t\n\t\tthis.visibleRows = null;\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.isFitData = false;\n\t\t\n\t\tthis.columns = [];\n\t}\n\t\n\tinitialize(){\n\t\tthis.compatibilityCheck();\n\t\tthis.layoutCheck();\n\t\tthis.vertScrollListen();\n\t}\n\t\n\tcompatibilityCheck(){\t\t\n\t\tif(this.options(\"layout\") == \"fitDataTable\"){\n\t\t\tconsole.warn(\"Horizontal Virtual DOM is not compatible with fitDataTable layout mode\");\n\t\t}\n\t\t\n\t\tif(this.options(\"responsiveLayout\")){\n\t\t\tconsole.warn(\"Horizontal Virtual DOM is not compatible with responsive columns\");\n\t\t}\n\t\t\n\t\tif(this.options(\"rtl\")){\n\t\t\tconsole.warn(\"Horizontal Virtual DOM is not currently compatible with RTL text direction\");\n\t\t}\n\t}\n\t\n\tlayoutCheck(){\n\t\tthis.isFitData = this.options(\"layout\").startsWith('fitData');\n\t}\n\t\n\tvertScrollListen(){\n\t\tthis.subscribe(\"scroll-vertical\", this.clearVisRowCache.bind(this));\n\t\tthis.subscribe(\"data-refreshed\", this.clearVisRowCache.bind(this));\n\t}\n\t\n\tclearVisRowCache(){\n\t\tthis.visibleRows = null;\n\t}\n\t\n\t//////////////////////////////////////\n\t///////// Public Functions ///////////\n\t//////////////////////////////////////\n\t\n\trenderColumns(row, force){\n\t\tthis.dataChange();\n\t}\n\t\n\t\n\tscrollColumns(left, dir){\n\t\tif(this.scrollLeft != left){\n\t\t\tthis.scrollLeft = left;\n\t\t\t\n\t\t\tthis.scroll(left - (this.vDomScrollPosLeft + this.windowBuffer));\n\t\t}\n\t}\n\t\n\tcalcWindowBuffer(){\n\t\tvar buffer = this.elementVertical.clientWidth;\n\t\t\n\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\tif(column.visible){\n\t\t\t\tvar width = column.getWidth();\n\t\t\t\t\n\t\t\t\tif(width > buffer){\n\t\t\t\t\tbuffer = width;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.windowBuffer = buffer * 2;\n\t}\n\t\n\trerenderColumns(update, blockRedraw){\t\t\n\t\tvar old = {\n\t\t\tcols:this.columns,\n\t\t\tleftCol:this.leftCol,\n\t\t\trightCol:this.rightCol,\n\t\t},\n\t\tcolPos = 0;\n\t\t\n\t\tif(update && !this.initialized){\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tthis.clear();\n\t\t\n\t\tthis.calcWindowBuffer();\n\t\t\n\t\tthis.scrollLeft = this.elementVertical.scrollLeft;\n\t\t\n\t\tthis.vDomScrollPosLeft = this.scrollLeft - this.windowBuffer;\n\t\tthis.vDomScrollPosRight = this.scrollLeft + this.elementVertical.clientWidth + this.windowBuffer;\n\t\t\n\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\tvar config = {},\n\t\t\twidth;\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\tif(!column.modules.frozen){\t\t\t\n\t\t\t\t\twidth = column.getWidth();\n\t\t\t\t\t\n\t\t\t\t\tconfig.leftPos = colPos;\n\t\t\t\t\tconfig.rightPos = colPos + width;\n\t\t\t\t\t\n\t\t\t\t\tconfig.width = width;\n\t\t\t\t\t\n\t\t\t\t\tif (this.isFitData) {\n\t\t\t\t\t\tconfig.fitDataCheck = column.modules.vdomHoz ? column.modules.vdomHoz.fitDataCheck : true;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif((colPos + width > this.vDomScrollPosLeft) && (colPos < this.vDomScrollPosRight)){\n\t\t\t\t\t\t//column is visible\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(this.leftCol == -1){\n\t\t\t\t\t\t\tthis.leftCol = this.columns.length;\n\t\t\t\t\t\t\tthis.vDomPadLeft = colPos;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.rightCol = this.columns.length;\n\t\t\t\t\t}else {\n\t\t\t\t\t\t// column is hidden\n\t\t\t\t\t\tif(this.leftCol !== -1){\n\t\t\t\t\t\t\tthis.vDomPadRight += width;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.columns.push(column);\n\t\t\t\t\t\n\t\t\t\t\tcolumn.modules.vdomHoz = config;\n\t\t\t\t\t\n\t\t\t\t\tcolPos += width;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.tableElement.style.paddingLeft = this.vDomPadLeft + \"px\";\n\t\tthis.tableElement.style.paddingRight = this.vDomPadRight + \"px\";\n\t\t\n\t\tthis.initialized = true;\n\t\t\n\t\tif(!blockRedraw){\n\t\t\tif(!update || this.reinitChanged(old)){\n\t\t\t\tthis.reinitializeRows();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.elementVertical.scrollLeft = this.scrollLeft;\n\t}\n\t\n\trenderRowCells(row){\n\t\tif(this.initialized){\n\t\t\tthis.initializeRow(row);\n\t\t}else {\n\t\t\tconst rowFrag = document.createDocumentFragment();\n\t\t\trow.cells.forEach((cell) => {\n\t\t\t\trowFrag.appendChild(cell.getElement());\n\t\t\t});\n\t\t\trow.element.appendChild(rowFrag);\n\t\t\t\n\t\t\trow.cells.forEach((cell) => {\n\t\t\t\tcell.cellRendered();\n\t\t\t});\n\t\t}\n\t}\n\t\n\trerenderRowCells(row, force){\n\t\tthis.reinitializeRow(row, force);\n\t}\n\t\n\treinitializeColumnWidths(columns){\n\t\tfor(let i = this.leftCol; i <= this.rightCol; i++){\n\t\t\tlet col = this.columns[i];\n\t\t\t\n\t\t\tif(col){\n\t\t\t\tcol.reinitializeWidth();\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//////////////////////////////////////\n\t//////// Internal Rendering //////////\n\t//////////////////////////////////////\n\t\n\tdeinitialize(){\n\t\tthis.initialized = false;\n\t}\n\t\n\tclear(){\n\t\tthis.columns = [];\n\t\t\n\t\tthis.leftCol = -1;\n\t\tthis.rightCol = 0;\n\t\t\n\t\tthis.vDomScrollPosLeft = 0;\n\t\tthis.vDomScrollPosRight = 0;\n\t\tthis.vDomPadLeft = 0;\n\t\tthis.vDomPadRight = 0;\n\t}\n\t\n\tdataChange(){\n\t\tvar change = false,\n\t\trow, rowEl;\n\t\t\n\t\tif(this.isFitData){\n\t\t\tthis.table.columnManager.columnsByIndex.forEach((column) => {\n\t\t\t\tif(!column.definition.width && column.visible){\n\t\t\t\t\tchange = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(change && this.table.rowManager.getDisplayRows().length){\n\t\t\t\tthis.vDomScrollPosRight = this.scrollLeft + this.elementVertical.clientWidth + this.windowBuffer;\n\t\t\t\t\n\t\t\t\trow = this.chain(\"rows-sample\", [1], [], () => {\n\t\t\t\t\treturn this.table.rowManager.getDisplayRows();\n\t\t\t\t})[0];\n\t\t\t\t\n\t\t\t\tif(row){\n\t\t\t\t\trowEl = row.getElement();\n\t\t\t\t\t\n\t\t\t\t\trow.generateCells();\n\t\t\t\t\t\n\t\t\t\t\tthis.tableElement.appendChild(rowEl);\n\t\t\t\t\t\n\t\t\t\t\tfor(let colEnd = 0; colEnd < row.cells.length; colEnd++){\n\t\t\t\t\t\tlet cell = row.cells[colEnd];\n\t\t\t\t\t\trowEl.appendChild(cell.getElement());\n\t\t\t\t\t\t\n\t\t\t\t\t\tcell.column.reinitializeWidth();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t\t\t\n\t\t\t\t\tthis.rerenderColumns(false, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tif(this.options(\"layout\") === \"fitColumns\"){\n\t\t\t\tthis.layoutRefresh();\n\t\t\t\tthis.rerenderColumns(false, true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\treinitChanged(old){\n\t\tvar match = true;\n\t\t\n\t\tif(old.cols.length !== this.columns.length || old.leftCol !== this.leftCol || old.rightCol !== this.rightCol){\n\t\t\treturn true;\n\t\t}\n\t\t\n\t\told.cols.forEach((col, i) => {\n\t\t\tif(col !== this.columns[i]){\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn !match;\n\t}\n\t\n\treinitializeRows(){\n\t\tvar visibleRows = this.getVisibleRows(),\n\t\totherRows = this.table.rowManager.getRows().filter(row => !visibleRows.includes(row));\n\t\t\n\t\tvisibleRows.forEach((row) => {\n\t\t\tthis.reinitializeRow(row, true);\n\t\t});\n\t\t\n\t\totherRows.forEach((row) =>{\n\t\t\trow.deinitialize();\n\t\t});\n\t}\n\t\n\tgetVisibleRows(){\n\t\tif (!this.visibleRows){\n\t\t\tthis.visibleRows = this.table.rowManager.getVisibleRows();\n\t\t}\n\t\t\n\t\treturn this.visibleRows;\t\n\t}\n\t\n\tscroll(diff){\n\t\tthis.vDomScrollPosLeft += diff;\n\t\tthis.vDomScrollPosRight += diff;\n\t\t\n\t\tif(Math.abs(diff) > (this.windowBuffer / 2)){\n\t\t\tthis.rerenderColumns();\n\t\t}else {\n\t\t\tif(diff > 0){\n\t\t\t\t//scroll right\n\t\t\t\tthis.addColRight();\n\t\t\t\tthis.removeColLeft();\n\t\t\t}else {\n\t\t\t\t//scroll left\n\t\t\t\tthis.addColLeft();\n\t\t\t\tthis.removeColRight();\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcolPositionAdjust (start, end, diff){\n\t\tfor(let i = start; i < end; i++){\n\t\t\tlet column = this.columns[i];\n\t\t\t\n\t\t\tcolumn.modules.vdomHoz.leftPos += diff;\n\t\t\tcolumn.modules.vdomHoz.rightPos += diff;\n\t\t}\n\t}\n\t\n\taddColRight(){\n\t\tvar changes = false,\n\t\tworking = true;\n\t\t\n\t\twhile(working){\n\t\t\t\n\t\t\tlet column = this.columns[this.rightCol + 1];\n\t\t\t\n\t\t\tif(column){\n\t\t\t\tif(column.modules.vdomHoz.leftPos <= this.vDomScrollPosRight){\n\t\t\t\t\tchanges = true;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\t\t\t\trow.getElement().insertBefore(cell.getElement(), row.getCell(this.columns[this.rightCol]).getElement().nextSibling);\n\t\t\t\t\t\t\tcell.cellRendered();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.fitDataColActualWidthCheck(column);\n\t\t\t\t\t\n\t\t\t\t\tthis.rightCol++; // Don't move this below the >= check below\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\trow.modules.vdomHoz.rightCol = this.rightCol;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif(this.rightCol >= (this.columns.length - 1)){\n\t\t\t\t\t\tthis.vDomPadRight = 0;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.vDomPadRight -= column.getWidth();\n\t\t\t\t\t}\t\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(changes){\n\t\t\tthis.tableElement.style.paddingRight = this.vDomPadRight + \"px\";\n\t\t}\n\t}\n\t\n\taddColLeft(){\n\t\tvar changes = false,\n\t\tworking = true;\n\t\t\n\t\twhile(working){\n\t\t\tlet column = this.columns[this.leftCol - 1];\n\t\t\t\n\t\t\tif(column){\n\t\t\t\tif(column.modules.vdomHoz.rightPos >= this.vDomScrollPosLeft){\n\t\t\t\t\tchanges = true;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\t\t\t\trow.getElement().insertBefore(cell.getElement(), row.getCell(this.columns[this.leftCol]).getElement());\n\t\t\t\t\t\t\tcell.cellRendered();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.leftCol--; // don't move this below the <= check below\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\trow.modules.vdomHoz.leftCol = this.leftCol;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif(this.leftCol <= 0){ // replicating logic in addColRight\n\t\t\t\t\t\tthis.vDomPadLeft = 0;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.vDomPadLeft -= column.getWidth();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlet diff = this.fitDataColActualWidthCheck(column);\n\t\t\t\t\t\n\t\t\t\t\tif(diff){\n\t\t\t\t\t\tthis.scrollLeft = this.elementVertical.scrollLeft = this.elementVertical.scrollLeft + diff;\n\t\t\t\t\t\tthis.vDomPadRight -= diff;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(changes){\n\t\t\tthis.tableElement.style.paddingLeft = this.vDomPadLeft + \"px\";\n\t\t}\n\t}\n\t\n\tremoveColRight(){\n\t\tvar changes = false,\n\t\tworking = true;\n\t\t\n\t\twhile(working){\n\t\t\tlet column = this.columns[this.rightCol];\n\t\t\t\n\t\t\tif(column){\n\t\t\t\tif(column.modules.vdomHoz.leftPos > this.vDomScrollPosRight){\n\t\t\t\t\tchanges = true;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\trow.getElement().removeChild(cell.getElement());\n\t\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\t\tconsole.warn(\"Could not removeColRight\", ex.message);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.vDomPadRight += column.getWidth();\n\t\t\t\t\tthis.rightCol --;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\trow.modules.vdomHoz.rightCol = this.rightCol;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(changes){\n\t\t\tthis.tableElement.style.paddingRight = this.vDomPadRight + \"px\";\n\t\t}\n\t}\n\t\n\tremoveColLeft(){\n\t\tvar changes = false,\n\t\tworking = true;\n\t\t\n\t\twhile(working){\n\t\t\tlet column = this.columns[this.leftCol];\n\t\t\t\n\t\t\tif(column){\n\t\t\t\tif(column.modules.vdomHoz.rightPos < this.vDomScrollPosLeft){\n\t\t\t\t\tchanges = true;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\t\t\t\t\t\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\trow.getElement().removeChild(cell.getElement());\n\t\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\t\tconsole.warn(\"Could not removeColLeft\", ex.message);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.vDomPadLeft += column.getWidth();\n\t\t\t\t\tthis.leftCol ++;\n\t\t\t\t\t\n\t\t\t\t\tthis.getVisibleRows().forEach((row) => {\n\t\t\t\t\t\tif(row.type !== \"group\"){\n\t\t\t\t\t\t\trow.modules.vdomHoz.leftCol = this.leftCol;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(changes){\n\t\t\tthis.tableElement.style.paddingLeft = this.vDomPadLeft + \"px\";\n\t\t}\n\t}\n\t\n\tfitDataColActualWidthCheck(column){\n\t\tvar newWidth, widthDiff;\n\t\t\n\t\tif(column.modules.vdomHoz.fitDataCheck){\n\t\t\tcolumn.reinitializeWidth();\n\t\t\t\n\t\t\tnewWidth = column.getWidth();\n\t\t\twidthDiff = newWidth - column.modules.vdomHoz.width;\n\t\t\t\n\t\t\tif(widthDiff){\n\t\t\t\tcolumn.modules.vdomHoz.rightPos += widthDiff;\n\t\t\t\tcolumn.modules.vdomHoz.width = newWidth;\n\t\t\t\tthis.colPositionAdjust(this.columns.indexOf(column) + 1, this.columns.length, widthDiff);\n\t\t\t}\n\t\t\t\n\t\t\tcolumn.modules.vdomHoz.fitDataCheck = false;\n\t\t}\n\t\t\n\t\treturn widthDiff;\n\t}\n\t\n\tinitializeRow(row){\n\t\tif(row.type !== \"group\"){\n\t\t\trow.modules.vdomHoz = {\n\t\t\t\tleftCol:this.leftCol,\n\t\t\t\trightCol:this.rightCol,\n\t\t\t};\n\t\t\t\n\t\t\tif(this.table.modules.frozenColumns){\n\t\t\t\tthis.table.modules.frozenColumns.leftColumns.forEach((column) => {\n\t\t\t\t\tthis.appendCell(row, column);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tfor(let i = this.leftCol; i <= this.rightCol; i++){\n\t\t\t\tthis.appendCell(row, this.columns[i]);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.table.modules.frozenColumns){\n\t\t\t\tthis.table.modules.frozenColumns.rightColumns.forEach((column) => {\n\t\t\t\t\tthis.appendCell(row, column);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\t\n\tappendCell(row, column){\n\t\tif(column && column.visible){\n\t\t\tlet cell = row.getCell(column);\n\t\t\t\n\t\t\trow.getElement().appendChild(cell.getElement());\n\t\t\tcell.cellRendered();\n\t\t}\n\t}\n\t\n\treinitializeRow(row, force){\n\t\tif(row.type !== \"group\"){\n\t\t\tif(force || !row.modules.vdomHoz || row.modules.vdomHoz.leftCol !== this.leftCol || row.modules.vdomHoz.rightCol !== this.rightCol){\n\t\t\t\t\n\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\twhile(rowEl.firstChild) rowEl.removeChild(rowEl.firstChild);\n\t\t\t\t\n\t\t\t\tthis.initializeRow(row);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ColumnManager extends CoreFeature {\n\t\n\tconstructor (table){\n\t\tsuper(table);\n\t\t\n\t\tthis.blockHozScrollEvent = false;\n\t\tthis.headersElement = null;\n\t\tthis.contentsElement = null;\n\t\tthis.rowHeader = null;\n\t\tthis.element = null ; //containing element\n\t\tthis.columns = []; // column definition object\n\t\tthis.columnsByIndex = []; //columns by index\n\t\tthis.columnsByField = {}; //columns by field\n\t\tthis.scrollLeft = 0;\n\t\tthis.optionsList = new OptionsList(this.table, \"column definition\", defaultColumnOptions);\n\t\t\n\t\tthis.redrawBlock = false; //prevent redraws to allow multiple data manipulations before continuing\n\t\tthis.redrawBlockUpdate = null; //store latest redraw update only status\n\t\t\n\t\tthis.renderer = null;\n\t}\n\t\n\t////////////// Setup Functions /////////////////\n\t\n\tinitialize(){\n\t\tthis.initializeRenderer();\n\t\t\n\t\tthis.headersElement = this.createHeadersElement();\n\t\tthis.contentsElement = this.createHeaderContentsElement();\n\t\tthis.element = this.createHeaderElement();\n\t\t\n\t\tthis.contentsElement.insertBefore(this.headersElement, this.contentsElement.firstChild);\n\t\tthis.element.insertBefore(this.contentsElement, this.element.firstChild);\n\t\t\n\t\tthis.initializeScrollWheelWatcher();\n\t\t\n\t\tthis.subscribe(\"scroll-horizontal\", this.scrollHorizontal.bind(this));\n\t\tthis.subscribe(\"scrollbar-vertical\", this.padVerticalScrollbar.bind(this));\n\t}\n\t\n\tpadVerticalScrollbar(width){\n\t\tif(this.table.rtl){\n\t\t\tthis.headersElement.style.marginLeft = width + \"px\";\n\t\t}else {\n\t\t\tthis.headersElement.style.marginRight = width + \"px\";\n\t\t}\n\t}\n\t\n\tinitializeRenderer(){\n\t\tvar renderClass;\n\t\t\n\t\tvar renderers = {\n\t\t\t\"virtual\": VirtualDomHorizontal,\n\t\t\t\"basic\": BasicHorizontal,\n\t\t};\n\t\t\n\t\tif(typeof this.table.options.renderHorizontal === \"string\"){\n\t\t\trenderClass = renderers[this.table.options.renderHorizontal];\n\t\t}else {\n\t\t\trenderClass = this.table.options.renderHorizontal;\n\t\t}\n\t\t\n\t\tif(renderClass){\n\t\t\tthis.renderer = new renderClass(this.table, this.element, this.tableElement);\n\t\t\tthis.renderer.initialize();\n\t\t}else {\n\t\t\tconsole.error(\"Unable to find matching renderer:\", this.table.options.renderHorizontal);\n\t\t}\n\t}\n\t\n\t\n\tcreateHeadersElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-headers\");\n\t\tel.setAttribute(\"role\", \"row\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tcreateHeaderContentsElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-header-contents\");\n\t\tel.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tcreateHeaderElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-header\");\n\t\tel.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\tif(!this.table.options.headerVisible){\n\t\t\tel.classList.add(\"tabulator-header-hidden\");\n\t\t}\n\t\t\n\t\treturn el;\n\t}\n\t\n\t//return containing element\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\t\n\t//return containing contents element\n\tgetContentsElement(){\n\t\treturn this.contentsElement;\n\t}\n\t\n\t\n\t//return header containing element\n\tgetHeadersElement(){\n\t\treturn this.headersElement;\n\t}\n\t\n\t//scroll horizontally to match table body\n\tscrollHorizontal(left){\n\t\tthis.contentsElement.scrollLeft = left;\n\t\t\n\t\tthis.scrollLeft = left;\n\t\t\n\t\tthis.renderer.scrollColumns(left);\n\t}\n\t\n\tinitializeScrollWheelWatcher(){\n\t\tthis.contentsElement.addEventListener(\"wheel\", (e) => {\n\t\t\tvar left;\n\t\t\t\n\t\t\tif(e.deltaX){\n\t\t\t\tleft = this.contentsElement.scrollLeft + e.deltaX;\n\t\t\t\t\n\t\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\t\t\t\tthis.table.columnManager.scrollHorizontal(left);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t///////////// Column Setup Functions /////////////\n\tgenerateColumnsFromRowData(data){\n\t\tvar cols = [],\n\t\tcollProgress = {},\n\t\trowSample = this.table.options.autoColumns === \"full\" ? data : [data[0]],\n\t\tdefinitions = this.table.options.autoColumnsDefinitions;\n\t\t\n\t\tif(data && data.length){\n\t\t\t\n\t\t\trowSample.forEach((row) => {\n\t\t\t\t\n\t\t\t\tObject.keys(row).forEach((key, index) => {\n\t\t\t\t\tlet value = row[key],\n\t\t\t\t\tcol;\n\t\t\t\t\t\n\t\t\t\t\tif(!collProgress[key]){\n\t\t\t\t\t\tcol = {\n\t\t\t\t\t\t\tfield:key,\n\t\t\t\t\t\t\ttitle:key,\n\t\t\t\t\t\t\tsorter:this.calculateSorterFromValue(value),\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tcols.splice(index, 0, col);\n\t\t\t\t\t\tcollProgress[key] = typeof value === \"undefined\" ? col : true;\n\t\t\t\t\t}else if(collProgress[key] !== true){\n\t\t\t\t\t\tif(typeof value !== \"undefined\"){\n\t\t\t\t\t\t\tcollProgress[key].sorter = this.calculateSorterFromValue(value);\n\t\t\t\t\t\t\tcollProgress[key] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\t\n\t\t\tif(definitions){\n\t\t\t\t\n\t\t\t\tswitch(typeof definitions){\n\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\tthis.table.options.columns = definitions.call(this.table, cols);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\tif(Array.isArray(definitions)){\n\t\t\t\t\t\t\tcols.forEach((col) => {\n\t\t\t\t\t\t\t\tvar match = definitions.find((def) => {\n\t\t\t\t\t\t\t\t\treturn def.field === col.field;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(match){\n\t\t\t\t\t\t\t\t\tObject.assign(col, match);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tcols.forEach((col) => {\n\t\t\t\t\t\t\t\tif(definitions[col.field]){\n\t\t\t\t\t\t\t\t\tObject.assign(col, definitions[col.field]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.table.options.columns = cols;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis.table.options.columns = cols;\n\t\t\t}\n\t\t\t\n\t\t\tthis.setColumns(this.table.options.columns);\n\t\t}\n\t}\n\t\n\tcalculateSorterFromValue(value){\n\t\tvar sorter;\n\t\t\n\t\tswitch(typeof value){\n\t\t\tcase \"undefined\":\n\t\t\t\tsorter = \"string\";\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"boolean\":\n\t\t\t\tsorter = \"boolean\";\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"number\":\n\t\t\t\tsorter = \"number\";\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"object\":\n\t\t\t\tif(Array.isArray(value)){\n\t\t\t\t\tsorter = \"array\";\n\t\t\t\t}else {\n\t\t\t\t\tsorter = \"string\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tif(!isNaN(value) && value !== \"\"){\n\t\t\t\t\tsorter = \"number\";\n\t\t\t\t}else {\n\t\t\t\t\tif(value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)){\n\t\t\t\t\t\tsorter = \"alphanum\";\n\t\t\t\t\t}else {\n\t\t\t\t\t\tsorter = \"string\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\treturn sorter;\n\t}\n\t\n\tsetColumns(cols, row){\n\t\twhile(this.headersElement.firstChild) this.headersElement.removeChild(this.headersElement.firstChild);\n\t\t\n\t\tthis.columns = [];\n\t\tthis.columnsByIndex = [];\n\t\tthis.columnsByField = {};\n\t\t\n\t\tthis.dispatch(\"columns-loading\");\n\t\tthis.dispatchExternal(\"columnsLoading\");\n\t\t\n\t\tif(this.table.options.rowHeader){\n\t\t\tthis.rowHeader = new Column(this.table.options.rowHeader === true ? {} : this.table.options.rowHeader, this, true);\n\t\t\tthis.columns.push(this.rowHeader);\n\t\t\tthis.headersElement.appendChild(this.rowHeader.getElement());\n\t\t\tthis.rowHeader.columnRendered();\n\t\t}\n\t\t\n\t\tcols.forEach((def, i) => {\n\t\t\tthis._addColumn(def);\n\t\t});\n\t\t\n\t\tthis._reIndexColumns();\n\t\t\n\t\tthis.dispatch(\"columns-loaded\");\n\n\t\tif(this.subscribedExternal(\"columnsLoaded\")){\n\t\t\tthis.dispatchExternal(\"columnsLoaded\", this.getComponents());\n\t\t}\n\t\t\n\t\tthis.rerenderColumns(false, true);\n\t\t\n\t\tthis.redraw(true);\n\t}\n\t\n\t_addColumn(definition, before, nextToColumn){\n\t\tvar column = new Column(definition, this),\n\t\tcolEl = column.getElement(),\n\t\tindex = nextToColumn ? this.findColumnIndex(nextToColumn) : nextToColumn;\n\t\t\n\t\t//prevent adding of rows in front of row header\n\t\tif(before && this.rowHeader && (!nextToColumn || nextToColumn === this.rowHeader)){\n\t\t\tbefore = false;\n\t\t\tnextToColumn = this.rowHeader;\n\t\t\tindex = 0;\n\t\t}\n\t\t\n\t\tif(nextToColumn && index > -1){\n\t\t\tvar topColumn = nextToColumn.getTopColumn();\n\t\t\tvar parentIndex = this.columns.indexOf(topColumn);\n\t\t\tvar nextEl = topColumn.getElement();\n\t\t\t\n\t\t\tif(before){\n\t\t\t\tthis.columns.splice(parentIndex, 0, column);\n\t\t\t\tnextEl.parentNode.insertBefore(colEl, nextEl);\n\t\t\t}else {\n\t\t\t\tthis.columns.splice(parentIndex + 1, 0, column);\n\t\t\t\tnextEl.parentNode.insertBefore(colEl, nextEl.nextSibling);\n\t\t\t}\n\t\t}else {\n\t\t\tif(before){\n\t\t\t\tthis.columns.unshift(column);\n\t\t\t\tthis.headersElement.insertBefore(column.getElement(), this.headersElement.firstChild);\n\t\t\t}else {\n\t\t\t\tthis.columns.push(column);\n\t\t\t\tthis.headersElement.appendChild(column.getElement());\n\t\t\t}\n\t\t}\n\t\t\n\t\tcolumn.columnRendered();\n\t\t\n\t\treturn column;\n\t}\n\t\n\tregisterColumnField(col){\n\t\tif(col.definition.field){\n\t\t\tthis.columnsByField[col.definition.field] = col;\n\t\t}\n\t}\n\t\n\tregisterColumnPosition(col){\n\t\tthis.columnsByIndex.push(col);\n\t}\n\t\n\t_reIndexColumns(){\n\t\tthis.columnsByIndex = [];\n\t\t\n\t\tthis.columns.forEach(function(column){\n\t\t\tcolumn.reRegisterPosition();\n\t\t});\n\t}\n\t\n\t//ensure column headers take up the correct amount of space in column groups\n\tverticalAlignHeaders(){\n\t\tvar minHeight = 0;\n\t\t\n\t\tif(!this.redrawBlock){\n\t\t\t\n\t\t\tthis.headersElement.style.height=\"\";\n\t\t\t\n\t\t\tthis.columns.forEach((column) => {\n\t\t\t\tcolumn.clearVerticalAlign();\n\t\t\t});\n\t\t\t\n\t\t\tthis.columns.forEach((column) => {\n\t\t\t\tvar height = column.getHeight();\n\t\t\t\t\n\t\t\t\tif(height > minHeight){\n\t\t\t\t\tminHeight = height;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.headersElement.style.height = minHeight + \"px\";\n\t\t\t\n\t\t\tthis.columns.forEach((column) => {\n\t\t\t\tcolumn.verticalAlign(this.table.options.columnHeaderVertAlign, minHeight);\n\t\t\t});\n\t\t\t\n\t\t\tthis.table.rowManager.adjustTableSize();\n\t\t}\n\t}\n\t\n\t//////////////// Column Details /////////////////\n\tfindColumn(subject){\n\t\tvar columns;\n\t\t\n\t\tif(typeof subject == \"object\"){\n\t\t\t\n\t\t\tif(subject instanceof Column){\n\t\t\t\t//subject is column element\n\t\t\t\treturn subject;\n\t\t\t}else if(subject instanceof ColumnComponent){\n\t\t\t\t//subject is public column component\n\t\t\t\treturn subject._getSelf() || false;\n\t\t\t}else if(typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement){\n\t\t\t\t\n\t\t\t\tcolumns = [];\n\t\t\t\t\n\t\t\t\tthis.columns.forEach((column) => {\n\t\t\t\t\tcolumns.push(column);\n\t\t\t\t\tcolumns = columns.concat(column.getColumns(true));\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t//subject is a HTML element of the column header\n\t\t\t\tlet match = columns.find((column) => {\n\t\t\t\t\treturn column.element === subject;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn match || false;\n\t\t\t}\n\t\t\t\n\t\t}else {\n\t\t\t//subject should be treated as the field name of the column\n\t\t\treturn this.columnsByField[subject] || false;\n\t\t}\n\t\t\n\t\t//catch all for any other type of input\n\t\treturn false;\n\t}\n\t\n\tgetColumnByField(field){\n\t\treturn this.columnsByField[field];\n\t}\n\t\n\tgetColumnsByFieldRoot(root){\n\t\tvar matches = [];\n\t\t\n\t\tObject.keys(this.columnsByField).forEach((field) => {\n\t\t\tvar fieldRoot = this.table.options.nestedFieldSeparator ? field.split(this.table.options.nestedFieldSeparator)[0] : field;\n\t\t\tif(fieldRoot === root){\n\t\t\t\tmatches.push(this.columnsByField[field]);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn matches;\n\t}\n\t\n\tgetColumnByIndex(index){\n\t\treturn this.columnsByIndex[index];\n\t}\n\t\n\tgetFirstVisibleColumn(){\n\t\tvar index = this.columnsByIndex.findIndex((col) => {\n\t\t\treturn col.visible;\n\t\t});\n\t\t\n\t\treturn index > -1 ? this.columnsByIndex[index] : false;\n\t}\n\t\n\tgetVisibleColumnsByIndex() {\n\t\treturn this.columnsByIndex.filter((col) => col.visible);\n\t}\n\t\n\tgetColumns(){\n\t\treturn this.columns;\n\t}\n\t\n\tfindColumnIndex(column){\n\t\treturn this.columnsByIndex.findIndex((col) => {\n\t\t\treturn column === col;\n\t\t});\n\t}\n\t\n\t//return all columns that are not groups\n\tgetRealColumns(){\n\t\treturn this.columnsByIndex;\n\t}\n\t\n\t//traverse across columns and call action\n\ttraverse(callback){\n\t\tthis.columnsByIndex.forEach((column,i) =>{\n\t\t\tcallback(column, i);\n\t\t});\n\t}\n\t\n\t//get definitions of actual columns\n\tgetDefinitions(active){\n\t\tvar output = [];\n\t\t\n\t\tthis.columnsByIndex.forEach((column) => {\n\t\t\tif(!active || (active && column.visible)){\n\t\t\t\toutput.push(column.getDefinition());\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\t//get full nested definition tree\n\tgetDefinitionTree(){\n\t\tvar output = [];\n\t\t\n\t\tthis.columns.forEach((column) => {\n\t\t\toutput.push(column.getDefinition(true));\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetComponents(structured){\n\t\tvar output = [],\n\t\tcolumns = structured ? this.columns : this.columnsByIndex;\n\t\t\n\t\tcolumns.forEach((column) => {\n\t\t\toutput.push(column.getComponent());\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetWidth(){\n\t\tvar width = 0;\n\t\t\n\t\tthis.columnsByIndex.forEach((column) => {\n\t\t\tif(column.visible){\n\t\t\t\twidth += column.getWidth();\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn width;\n\t}\n\t\n\tmoveColumn(from, to, after){\n\t\tto.element.parentNode.insertBefore(from.element, to.element);\n\t\t\n\t\tif(after){\n\t\t\tto.element.parentNode.insertBefore(to.element, from.element);\n\t\t}\n\t\t\n\t\tthis.moveColumnActual(from, to, after);\n\t\t\n\t\tthis.verticalAlignHeaders();\n\t\t\n\t\tthis.table.rowManager.reinitialize();\n\t}\n\t\n\tmoveColumnActual(from, to, after){\n\t\tif(from.parent.isGroup){\n\t\t\tthis._moveColumnInArray(from.parent.columns, from, to, after);\n\t\t}else {\n\t\t\tthis._moveColumnInArray(this.columns, from, to, after);\n\t\t}\n\t\t\n\t\tthis._moveColumnInArray(this.columnsByIndex, from, to, after, true);\n\t\t\n\t\tthis.rerenderColumns(true);\n\t\t\n\t\tthis.dispatch(\"column-moved\", from, to, after);\n\t\t\n\t\tif(this.subscribedExternal(\"columnMoved\")){\n\t\t\tthis.dispatchExternal(\"columnMoved\", from.getComponent(), this.table.columnManager.getComponents());\n\t\t}\n\t}\n\t\n\t_moveColumnInArray(columns, from, to, after, updateRows){\n\t\tvar\tfromIndex = columns.indexOf(from),\n\t\ttoIndex, rows = [];\n\t\t\n\t\tif (fromIndex > -1) {\n\t\t\t\n\t\t\tcolumns.splice(fromIndex, 1);\n\t\t\t\n\t\t\ttoIndex = columns.indexOf(to);\n\t\t\t\n\t\t\tif (toIndex > -1) {\n\t\t\t\t\n\t\t\t\tif(after){\n\t\t\t\t\ttoIndex = toIndex+1;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else {\n\t\t\t\ttoIndex = fromIndex;\n\t\t\t}\n\t\t\t\n\t\t\tcolumns.splice(toIndex, 0, from);\n\t\t\t\n\t\t\tif(updateRows){\n\t\t\t\t\n\t\t\t\trows = this.chain(\"column-moving-rows\", [from, to, after], null, []) || [];\n\t\t\t\t\n\t\t\t\trows = rows.concat(this.table.rowManager.rows);\n\t\t\t\t\n\t\t\t\trows.forEach(function(row){\n\t\t\t\t\tif(row.cells.length){\n\t\t\t\t\t\tvar cell = row.cells.splice(fromIndex, 1)[0];\n\t\t\t\t\t\trow.cells.splice(toIndex, 0, cell);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\t\n\tscrollToColumn(column, position, ifVisible){\n\t\tvar left = 0,\n\t\toffset = column.getLeftOffset(),\n\t\tadjust = 0,\n\t\tcolEl = column.getElement();\n\t\t\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t\n\t\t\tif(typeof position === \"undefined\"){\n\t\t\t\tposition = this.table.options.scrollToColumnPosition;\n\t\t\t}\n\t\t\t\n\t\t\tif(typeof ifVisible === \"undefined\"){\n\t\t\t\tifVisible = this.table.options.scrollToColumnIfVisible;\n\t\t\t}\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\t\n\t\t\t\t//align to correct position\n\t\t\t\tswitch(position){\n\t\t\t\t\tcase \"middle\":\n\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\tadjust = -this.element.clientWidth / 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\tadjust = colEl.clientWidth - this.headersElement.clientWidth;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//check column visibility\n\t\t\t\tif(!ifVisible){\n\t\t\t\t\tif(offset > 0 && offset + colEl.offsetWidth < this.element.clientWidth){\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//calculate scroll position\n\t\t\t\tleft = offset + adjust;\n\t\t\t\t\n\t\t\t\tleft = Math.max(Math.min(left, this.table.rowManager.element.scrollWidth - this.table.rowManager.element.clientWidth),0);\n\t\t\t\t\n\t\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\t\t\t\tthis.scrollHorizontal(left);\n\t\t\t\t\n\t\t\t\tresolve();\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Scroll Error - Column not visible\");\n\t\t\t\treject(\"Scroll Error - Column not visible\");\n\t\t\t}\n\t\t\t\n\t\t});\n\t}\n\t\n\t//////////////// Cell Management /////////////////\n\tgenerateCells(row){\n\t\tvar cells = [];\n\t\t\n\t\tthis.columnsByIndex.forEach((column) => {\n\t\t\tcells.push(column.generateCell(row));\n\t\t});\n\t\t\n\t\treturn cells;\n\t}\n\t\n\t//////////////// Column Management /////////////////\n\tgetFlexBaseWidth(){\n\t\tvar totalWidth = this.table.element.clientWidth, //table element width\n\t\tfixedWidth = 0;\n\t\t\n\t\t//adjust for vertical scrollbar if present\n\t\tif(this.table.rowManager.element.scrollHeight > this.table.rowManager.element.clientHeight){\n\t\t\ttotalWidth -= this.table.rowManager.element.offsetWidth - this.table.rowManager.element.clientWidth;\n\t\t}\n\t\t\n\t\tthis.columnsByIndex.forEach(function(column){\n\t\t\tvar width, minWidth, colWidth;\n\t\t\t\n\t\t\tif(column.visible){\n\t\t\t\t\n\t\t\t\twidth = column.definition.width || 0;\n\t\t\t\t\n\t\t\t\tminWidth = parseInt(column.minWidth);\n\t\t\t\t\n\t\t\t\tif(typeof(width) == \"string\"){\n\t\t\t\t\tif(width.indexOf(\"%\") > -1){\n\t\t\t\t\t\tcolWidth = (totalWidth / 100) * parseInt(width) ;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tcolWidth = parseInt(width);\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tcolWidth = width;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfixedWidth += colWidth > minWidth ? colWidth : minWidth;\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn fixedWidth;\n\t}\n\t\n\taddColumn(definition, before, nextToColumn){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar column = this._addColumn(definition, before, nextToColumn);\n\t\t\t\n\t\t\tthis._reIndexColumns();\n\t\t\t\n\t\t\tthis.dispatch(\"column-add\", definition, before, nextToColumn);\n\t\t\t\n\t\t\tif(this.layoutMode() != \"fitColumns\"){\n\t\t\t\tcolumn.reinitializeWidth();\n\t\t\t}\n\t\t\t\n\t\t\tthis.redraw(true);\n\t\t\t\n\t\t\tthis.table.rowManager.reinitialize();\n\t\t\t\n\t\t\tthis.rerenderColumns();\n\t\t\t\n\t\t\tresolve(column);\n\t\t});\n\t}\n\t\n\t//remove column from system\n\tderegisterColumn(column){\n\t\tvar field = column.getField(),\n\t\tindex;\n\t\t\n\t\t//remove from field list\n\t\tif(field){\n\t\t\tdelete this.columnsByField[field];\n\t\t}\n\t\t\n\t\t//remove from index list\n\t\tindex = this.columnsByIndex.indexOf(column);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.columnsByIndex.splice(index, 1);\n\t\t}\n\t\t\n\t\t//remove from column list\n\t\tindex = this.columns.indexOf(column);\n\t\t\n\t\tif(index > -1){\n\t\t\tthis.columns.splice(index, 1);\n\t\t}\n\t\t\n\t\tthis.verticalAlignHeaders();\n\t\t\n\t\tthis.redraw();\n\t}\n\t\n\trerenderColumns(update, silent){\n\t\tif(!this.redrawBlock){\n\t\t\tthis.renderer.rerenderColumns(update, silent);\n\t\t}else {\n\t\t\tif(update === false || (update === true && this.redrawBlockUpdate === null)){\n\t\t\t\tthis.redrawBlockUpdate = update;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tblockRedraw(){\n\t\tthis.redrawBlock = true;\n\t\tthis.redrawBlockUpdate = null;\n\t}\n\t\n\trestoreRedraw(){\n\t\tthis.redrawBlock = false;\n\t\tthis.verticalAlignHeaders();\n\t\tthis.renderer.rerenderColumns(this.redrawBlockUpdate);\n\t\t\n\t}\n\t\n\t//redraw columns\n\tredraw(force){\n\t\tif(Helpers.elVisible(this.element)){\n\t\t\tthis.verticalAlignHeaders();\n\t\t}\n\t\t\n\t\tif(force){\n\t\t\tthis.table.rowManager.resetScroll();\n\t\t\tthis.table.rowManager.reinitialize();\n\t\t}\n\t\t\n\t\tif(!this.confirm(\"table-redrawing\", force)){\n\t\t\tthis.layoutRefresh(force);\n\t\t}\n\t\t\n\t\tthis.dispatch(\"table-redraw\", force);\n\t\t\n\t\tthis.table.footerManager.redraw();\n\t}\n}\n\nclass BasicVertical extends Renderer{\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.verticalFillMode = \"fill\";\n\t\t\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\t\t\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\t}\n\t\n\tclearRows(){\n\t\tvar element = this.tableElement;\n\t\t\n\t\t// element.children.detach();\n\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\t\t\n\t\telement.scrollTop = 0;\n\t\telement.scrollLeft = 0;\n\t\t\n\t\telement.style.minWidth = \"\";\n\t\telement.style.minHeight = \"\";\n\t\telement.style.display = \"\";\n\t\telement.style.visibility = \"\";\n\t}\n\t\n\trenderRows() {\n\t\tvar element = this.tableElement,\n\t\tonlyGroupHeaders = true,\n\t\ttableFrag = document.createDocumentFragment(),\n\t\trows = this.rows();\n\t\t\n\t\trows.forEach((row, index) => {\n\t\t\tthis.styleRow(row, index);\n\t\t\trow.initialize(false, true);\n\t\t\t\n\t\t\tif (row.type !== \"group\") {\n\t\t\t\tonlyGroupHeaders = false;\n\t\t\t}\n\t\t\t\n\t\t\ttableFrag.appendChild(row.getElement());\n\t\t});\n\t\t\n\t\telement.appendChild(tableFrag);\n\t\t\n\t\trows.forEach((row) => {\n\t\t\trow.rendered();\n\t\t\t\n\t\t\tif(!row.heightInitialized) {\n\t\t\t\trow.calcHeight(true);\n\t\t\t}\n\t\t});\n\t\t\n\t\trows.forEach((row) => {\n\t\t\tif(!row.heightInitialized) {\n\t\t\t\trow.setCellHeight();\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(onlyGroupHeaders){\n\t\t\telement.style.minWidth = this.table.columnManager.getWidth() + \"px\";\n\t\t}else {\n\t\t\telement.style.minWidth = \"\";\n\t\t}\n\t}\n\t\n\t\n\trerenderRows(callback){\t\n\t\tthis.clearRows();\n\t\t\n\t\tif(callback){\n\t\t\tcallback();\n\t\t}\n\t\t\n\t\tthis.renderRows();\n\n\t\tif(!this.rows().length){\n\t\t\tthis.table.rowManager.tableEmpty();\n\t\t}\n\t}\n\t\n\tscrollToRowNearestTop(row){\n\t\tvar rowTop = Helpers.elOffset(row.getElement()).top;\n\t\t\n\t\treturn !(Math.abs(this.elementVertical.scrollTop - rowTop) > Math.abs(this.elementVertical.scrollTop + this.elementVertical.clientHeight - rowTop));\n\t}\n\t\n\tscrollToRow(row){\n\t\tvar rowEl = row.getElement();\n\t\t\n\t\tthis.elementVertical.scrollTop = Helpers.elOffset(rowEl).top - Helpers.elOffset(this.elementVertical).top + this.elementVertical.scrollTop;\n\t}\n\t\n\tvisibleRows(includingBuffer){\n\t\treturn this.rows();\n\t}\n\t\n}\n\nclass VirtualDomVertical extends Renderer{\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.verticalFillMode = \"fill\";\n\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\n\t\tthis.vDomRowHeight = 20; //approximation of row heights for padding\n\n\t\tthis.vDomTop = 0; //hold position for first rendered row in the virtual DOM\n\t\tthis.vDomBottom = 0; //hold position for last rendered row in the virtual DOM\n\n\t\tthis.vDomScrollPosTop = 0; //last scroll position of the vDom top;\n\t\tthis.vDomScrollPosBottom = 0; //last scroll position of the vDom bottom;\n\n\t\tthis.vDomTopPad = 0; //hold value of padding for top of virtual DOM\n\t\tthis.vDomBottomPad = 0; //hold value of padding for bottom of virtual DOM\n\n\t\tthis.vDomMaxRenderChain = 90; //the maximum number of dom elements that can be rendered in 1 go\n\n\t\tthis.vDomWindowBuffer = 0; //window row buffer before removing elements, to smooth scrolling\n\n\t\tthis.vDomWindowMinTotalRows = 20; //minimum number of rows to be generated in virtual dom (prevent buffering issues on tables with tall rows)\n\t\tthis.vDomWindowMinMarginRows = 5; //minimum number of rows to be generated in virtual dom margin\n\n\t\tthis.vDomTopNewRows = []; //rows to normalize after appending to optimize render speed\n\t\tthis.vDomBottomNewRows = []; //rows to normalize after appending to optimize render speed\n\t}\n\n\t//////////////////////////////////////\n\t///////// Public Functions ///////////\n\t//////////////////////////////////////\n\n\tclearRows(){\n\t\tvar element = this.tableElement;\n\n\t\t// element.children.detach();\n\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\n\t\telement.style.paddingTop = \"\";\n\t\telement.style.paddingBottom = \"\";\n\t\telement.style.minHeight = \"\";\n\t\telement.style.display = \"\";\n\t\telement.style.visibility = \"\";\n\n\t\tthis.elementVertical.scrollTop = 0;\n\t\tthis.elementVertical.scrollLeft = 0;\n\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\n\t\tthis.vDomTop = 0;\n\t\tthis.vDomBottom = 0;\n\t\tthis.vDomTopPad = 0;\n\t\tthis.vDomBottomPad = 0;\n\t\tthis.vDomScrollPosTop = 0;\n\t\tthis.vDomScrollPosBottom = 0;\n\t}\n\n\trenderRows(){\n\t\tthis._virtualRenderFill();\n\t}\n\n\trerenderRows(callback){\n\t\tvar scrollTop = this.elementVertical.scrollTop;\n\t\tvar topRow = false;\n\t\tvar topOffset = false;\n\n\t\tvar left = this.table.rowManager.scrollLeft;\n\n\t\tvar rows = this.rows();\n\n\t\tfor(var i = this.vDomTop; i <= this.vDomBottom; i++){\n\n\t\t\tif(rows[i]){\n\t\t\t\tvar diff = scrollTop - rows[i].getElement().offsetTop;\n\n\t\t\t\tif(topOffset === false || Math.abs(diff) < topOffset){\n\t\t\t\t\ttopOffset = diff;\n\t\t\t\t\ttopRow = i;\n\t\t\t\t}else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trows.forEach((row) => {\n\t\t\trow.deinitializeHeight();\n\t\t});\n\n\t\tif(callback){\n\t\t\tcallback();\n\t\t}\n\n\t\tif(this.rows().length){\n\t\t\tthis._virtualRenderFill((topRow === false ? this.rows.length - 1 : topRow), true, topOffset || 0);\n\t\t}else {\n\t\t\tthis.clear();\n\t\t\tthis.table.rowManager.tableEmpty();\n\t\t}\n\n\t\tthis.scrollColumns(left);\n\t}\n\n\tscrollColumns(left){\n\t\tthis.table.rowManager.scrollHorizontal(left);\n\t}\n\n\tscrollRows(top, dir){\n\t\tvar topDiff = top - this.vDomScrollPosTop;\n\t\tvar bottomDiff = top - this.vDomScrollPosBottom;\n\t\tvar margin = this.vDomWindowBuffer * 2;\n\t\tvar rows = this.rows();\n\n\t\tthis.scrollTop = top;\n\n\t\tif(-topDiff > margin || bottomDiff > margin){\n\t\t\t//if big scroll redraw table;\n\t\t\tvar left = this.table.rowManager.scrollLeft;\n\t\t\tthis._virtualRenderFill(Math.floor((this.elementVertical.scrollTop / this.elementVertical.scrollHeight) * rows.length));\n\t\t\tthis.scrollColumns(left);\n\t\t}else {\n\n\t\t\tif(dir){\n\t\t\t\t//scrolling up\n\t\t\t\tif(topDiff < 0){\n\t\t\t\t\tthis._addTopRow(rows, -topDiff);\n\t\t\t\t}\n\n\t\t\t\tif(bottomDiff < 0){\n\t\t\t\t\t//hide bottom row if needed\n\t\t\t\t\tif(this.vDomScrollHeight - this.scrollTop > this.vDomWindowBuffer){\n\t\t\t\t\t\tthis._removeBottomRow(rows, -bottomDiff);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.vDomScrollPosBottom = this.scrollTop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\n\t\t\t\tif(bottomDiff >= 0){\n\t\t\t\t\tthis._addBottomRow(rows, bottomDiff);\n\t\t\t\t}\n\n\t\t\t\t//scrolling down\n\t\t\t\tif(topDiff >= 0){\n\t\t\t\t\t//hide top row if needed\n\t\t\t\t\tif(this.scrollTop > this.vDomWindowBuffer){\n\t\t\t\t\t\tthis._removeTopRow(rows, topDiff);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.vDomScrollPosTop = this.scrollTop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresize(){\n\t\tthis.vDomWindowBuffer = this.table.options.renderVerticalBuffer || this.elementVertical.clientHeight;\n\t}\n\n\tscrollToRowNearestTop(row){\n\t\tvar rowIndex = this.rows().indexOf(row);\n\n\t\treturn !(Math.abs(this.vDomTop - rowIndex) > Math.abs(this.vDomBottom - rowIndex));\n\t}\n\n\tscrollToRow(row){\n\t\tvar index = this.rows().indexOf(row);\n\n\t\tif(index > -1){\n\t\t\tthis._virtualRenderFill(index, true);\n\t\t}\n\t}\n\n\tvisibleRows(includingBuffer){\n\t\tvar topEdge = this.elementVertical.scrollTop,\n\t\tbottomEdge = this.elementVertical.clientHeight + topEdge,\n\t\ttopFound = false,\n\t\ttopRow = 0,\n\t\tbottomRow = 0,\n\t\trows = this.rows();\n\n\t\tif(includingBuffer){\n\t\t\ttopRow = this.vDomTop;\n\t\t\tbottomRow = this.vDomBottom;\n\t\t}else {\n\t\t\tfor(var i = this.vDomTop; i <= this.vDomBottom; i++){\n\t\t\t\tif(rows[i]){\n\t\t\t\t\tif(!topFound){\n\t\t\t\t\t\tif((topEdge - rows[i].getElement().offsetTop) >= 0){\n\t\t\t\t\t\t\ttopRow = i;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\ttopFound = true;\n\n\t\t\t\t\t\t\tif(bottomEdge - rows[i].getElement().offsetTop >= 0){\n\t\t\t\t\t\t\t\tbottomRow = i;\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tif(bottomEdge - rows[i].getElement().offsetTop >= 0){\n\t\t\t\t\t\t\tbottomRow = i;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn rows.slice(topRow, bottomRow + 1);\n\t}\n\n\t//////////////////////////////////////\n\t//////// Internal Rendering //////////\n\t//////////////////////////////////////\n\n\t//full virtual render\n\t_virtualRenderFill(position, forceMove, offset) {\n\t\tvar\telement = this.tableElement,\n\t\tholder = this.elementVertical,\n\t\ttopPad = 0,\n\t\trowsHeight = 0,\n\t\trowHeight = 0,\n\t\theightOccupied = 0,\n\t\ttopPadHeight = 0,\n\t\ti = 0,\n\t\trows = this.rows(),\n\t\trowsCount = rows.length,\n\t\tindex = 0,\n\t\trow,\n\t\trowFragment,\n\t\trenderedRows = [],\n\t\ttotalRowsRendered = 0,\n\t\trowsToRender = 0,\n\t\tfixedHeight = this.table.rowManager.fixedHeight,\n\t\tcontainerHeight = this.elementVertical.clientHeight, \n\t\tavgRowHeight = this.table.options.rowHeight, \n\t\tresized = true;\n\n\t\tposition = position || 0;\n\n\t\toffset = offset || 0;\n\n\t\tif(!position){\n\t\t\tthis.clear();\n\t\t}else {\n\t\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\n\t\t\t//check if position is too close to bottom of table\n\t\t\theightOccupied = (rowsCount - position + 1) * this.vDomRowHeight;\n\n\t\t\tif(heightOccupied < containerHeight){\n\t\t\t\tposition -= Math.ceil((containerHeight - heightOccupied) / this.vDomRowHeight);\n\t\t\t\tif(position < 0){\n\t\t\t\t\tposition = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//calculate initial pad\n\t\t\ttopPad = Math.min(Math.max(Math.floor(this.vDomWindowBuffer / this.vDomRowHeight),  this.vDomWindowMinMarginRows), position);\n\t\t\tposition -= topPad;\n\t\t}\n\n\t\tif(rowsCount && Helpers.elVisible(this.elementVertical)){\n\t\t\tthis.vDomTop = position;\n\t\t\tthis.vDomBottom = position -1;\n\n\t\t\tif(fixedHeight || this.table.options.maxHeight) {\n\t\t\t\tif(avgRowHeight) {\n\t\t\t\t\trowsToRender = (containerHeight / avgRowHeight) + (this.vDomWindowBuffer / avgRowHeight);\n\t\t\t\t}\n\t\t\t\trowsToRender = Math.max(this.vDomWindowMinTotalRows, Math.ceil(rowsToRender));\n\t\t\t}\n\t\t\telse {\n\t\t\t\trowsToRender = rowsCount;\n\t\t\t}\n\n\t\t\twhile(((rowsToRender == rowsCount || rowsHeight <= containerHeight + this.vDomWindowBuffer) || totalRowsRendered < this.vDomWindowMinTotalRows) && this.vDomBottom < rowsCount -1) {\n\t\t\t\trenderedRows = [];\n\t\t\t\trowFragment = document.createDocumentFragment();\n\n\t\t\t\ti = 0;\n\n\t\t\t\twhile ((i < rowsToRender) && this.vDomBottom < rowsCount -1) {\t\n\t\t\t\t\tindex = this.vDomBottom + 1,\n\t\t\t\t\trow = rows[index];\n\n\t\t\t\t\tthis.styleRow(row, index);\n\n\t\t\t\t\trow.initialize(false, true);\n\t\t\t\t\tif(!row.heightInitialized && !this.table.options.rowHeight){\n\t\t\t\t\t\trow.clearCellHeight();\n\t\t\t\t\t}\n\n\t\t\t\t\trowFragment.appendChild(row.getElement());\n\t\t\t\t\trenderedRows.push(row);\n\t\t\t\t\tthis.vDomBottom ++;\n\t\t\t\t\ti++;\n\t\t\t\t}\n\n\t\t\t\tif(!renderedRows.length){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\telement.appendChild(rowFragment);\n\t\t\t\t\n\t\t\t\t// NOTE: The next 3 loops are separate on purpose\n\t\t\t\t// This is to batch up the dom writes and reads which drastically improves performance \n\n\t\t\t\trenderedRows.forEach((row) => {\n\t\t\t\t\trow.rendered();\n\n\t\t\t\t\tif(!row.heightInitialized) {\n\t\t\t\t\t\trow.calcHeight(true);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trenderedRows.forEach((row) => {\n\t\t\t\t\tif(!row.heightInitialized) {\n\t\t\t\t\t\trow.setCellHeight();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trenderedRows.forEach((row) => {\n\t\t\t\t\trowHeight = row.getHeight();\n\t\t\t\t\t\n\t\t\t\t\tif(totalRowsRendered < topPad){\n\t\t\t\t\t\ttopPadHeight += rowHeight;\n\t\t\t\t\t}else {\n\t\t\t\t\t\trowsHeight += rowHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(rowHeight > this.vDomWindowBuffer){\n\t\t\t\t\t\tthis.vDomWindowBuffer = rowHeight * 2;\n\t\t\t\t\t}\n\t\t\t\t\ttotalRowsRendered++;\n\t\t\t\t});\n\n\t\t\t\tresized = this.table.rowManager.adjustTableSize();\n\t\t\t\tcontainerHeight = this.elementVertical.clientHeight;\n\t\t\t\tif(resized && (fixedHeight || this.table.options.maxHeight))\n\t\t\t\t{\n\t\t\t\t\tavgRowHeight = rowsHeight / totalRowsRendered;\n\t\t\t\t\trowsToRender = Math.max(this.vDomWindowMinTotalRows, Math.ceil((containerHeight / avgRowHeight) + (this.vDomWindowBuffer / avgRowHeight)));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!position){\n\t\t\t\tthis.vDomTopPad = 0;\n\t\t\t\t//adjust row height to match average of rendered elements\n\t\t\t\tthis.vDomRowHeight = Math.floor((rowsHeight + topPadHeight) / totalRowsRendered);\n\t\t\t\tthis.vDomBottomPad = this.vDomRowHeight * (rowsCount - this.vDomBottom -1);\n\n\t\t\t\tthis.vDomScrollHeight = topPadHeight + rowsHeight + this.vDomBottomPad - containerHeight;\n\t\t\t}else {\n\t\t\t\tthis.vDomTopPad = !forceMove ? this.scrollTop - topPadHeight : (this.vDomRowHeight * this.vDomTop) + offset;\n\t\t\t\tthis.vDomBottomPad = this.vDomBottom == rowsCount-1 ? 0 : Math.max(this.vDomScrollHeight - this.vDomTopPad - rowsHeight - topPadHeight, 0);\n\t\t\t}\n\t\t\t\n\t\t\telement.style.paddingTop = this.vDomTopPad+\"px\";\n\t\t\telement.style.paddingBottom = this.vDomBottomPad+\"px\";\n\n\t\t\tif(forceMove){\n\t\t\t\tthis.scrollTop = this.vDomTopPad + (topPadHeight) + offset - (this.elementVertical.scrollWidth > this.elementVertical.clientWidth ? this.elementVertical.offsetHeight - containerHeight : 0);\n\t\t\t}\n\n\t\t\tthis.scrollTop = Math.min(this.scrollTop, this.elementVertical.scrollHeight - containerHeight);\n\n\t\t\t//adjust for horizontal scrollbar if present (and not at top of table)\n\t\t\tif(this.elementVertical.scrollWidth > this.elementVertical.clientWidth && forceMove){\n\t\t\t\tthis.scrollTop += this.elementVertical.offsetHeight - containerHeight;\n\t\t\t}\n\n\t\t\tthis.vDomScrollPosTop = this.scrollTop;\n\t\t\tthis.vDomScrollPosBottom = this.scrollTop;\n\n\t\t\tholder.scrollTop = this.scrollTop;\n\n\t\t\tthis.dispatch(\"render-virtual-fill\");\n\t\t}\n\t}\n\n\t_addTopRow(rows, fillableSpace){\n\t\tvar table = this.tableElement,\n\t\taddedRows = [],\n\t\tpaddingAdjust = 0,\n\t\tindex = this.vDomTop -1,\n\t\ti = 0,\n\t\tworking = true;\n\n\t\twhile(working){\n\t\t\tif(this.vDomTop){\n\t\t\t\tlet row = rows[index],\n\t\t\t\trowHeight, initialized;\n\n\t\t\t\tif(row && i < this.vDomMaxRenderChain){\n\t\t\t\t\trowHeight = row.getHeight() || this.vDomRowHeight;\n\t\t\t\t\tinitialized = row.initialized;\n\n\t\t\t\t\tif(fillableSpace >= rowHeight){\n\n\t\t\t\t\t\tthis.styleRow(row, index);\n\t\t\t\t\t\ttable.insertBefore(row.getElement(), table.firstChild);\n\n\t\t\t\t\t\tif(!row.initialized || !row.heightInitialized){\n\t\t\t\t\t\t\taddedRows.push(row);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trow.initialize();\n\n\t\t\t\t\t\tif(!initialized){\n\t\t\t\t\t\t\trowHeight = row.getElement().offsetHeight;\n\n\t\t\t\t\t\t\tif(rowHeight > this.vDomWindowBuffer){\n\t\t\t\t\t\t\t\tthis.vDomWindowBuffer = rowHeight * 2;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfillableSpace -= rowHeight;\n\t\t\t\t\t\tpaddingAdjust += rowHeight;\n\n\t\t\t\t\t\tthis.vDomTop--;\n\t\t\t\t\t\tindex--;\n\t\t\t\t\t\ti++;\n\n\t\t\t\t\t}else {\n\t\t\t\t\t\tworking = false;\n\t\t\t\t\t}\n\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let row of addedRows){\n\t\t\trow.clearCellHeight();\n\t\t}\n\n\t\tthis._quickNormalizeRowHeight(addedRows);\n\n\t\tif(paddingAdjust){\n\t\t\tthis.vDomTopPad -= paddingAdjust;\n\n\t\t\tif(this.vDomTopPad < 0){\n\t\t\t\tthis.vDomTopPad = index * this.vDomRowHeight;\n\t\t\t}\n\n\t\t\tif(index < 1){\n\t\t\t\tthis.vDomTopPad = 0;\n\t\t\t}\n\n\t\t\ttable.style.paddingTop = this.vDomTopPad + \"px\";\n\t\t\tthis.vDomScrollPosTop -= paddingAdjust;\n\t\t}\n\t}\n\n\t_removeTopRow(rows, fillableSpace){\n\t\tvar removableRows = [],\n\t\tpaddingAdjust = 0,\n\t\ti = 0,\n\t\tworking = true;\n\n\t\twhile(working){\n\t\t\tlet row = rows[this.vDomTop],\n\t\t\trowHeight;\n\n\t\t\tif(row && i < this.vDomMaxRenderChain){\n\t\t\t\trowHeight = row.getHeight() || this.vDomRowHeight;\n\n\t\t\t\tif(fillableSpace >= rowHeight){\n\t\t\t\t\tthis.vDomTop++;\n\n\t\t\t\t\tfillableSpace -= rowHeight;\n\t\t\t\t\tpaddingAdjust += rowHeight;\n\n\t\t\t\t\tremovableRows.push(row);\n\t\t\t\t\ti++;\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let row of removableRows){\n\t\t\tlet rowEl = row.getElement();\n\n\t\t\tif(rowEl.parentNode){\n\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t}\n\t\t}\n\n\t\tif(paddingAdjust){\n\t\t\tthis.vDomTopPad += paddingAdjust;\n\t\t\tthis.tableElement.style.paddingTop = this.vDomTopPad + \"px\";\n\t\t\tthis.vDomScrollPosTop += this.vDomTop ? paddingAdjust : paddingAdjust + this.vDomWindowBuffer;\n\t\t}\n\t}\n\n\t_addBottomRow(rows, fillableSpace){\n\t\tvar table = this.tableElement,\n\t\taddedRows = [],\n\t\tpaddingAdjust = 0,\n\t\tindex = this.vDomBottom + 1,\n\t\ti = 0,\n\t\tworking = true;\n\n\t\twhile(working){\n\t\t\tlet row = rows[index],\n\t\t\trowHeight, initialized;\n\n\t\t\tif(row && i < this.vDomMaxRenderChain){\n\t\t\t\trowHeight = row.getHeight() || this.vDomRowHeight;\n\t\t\t\tinitialized = row.initialized;\n\n\t\t\t\tif(fillableSpace >= rowHeight){\n\n\t\t\t\t\tthis.styleRow(row, index);\n\t\t\t\t\ttable.appendChild(row.getElement());\n\n\t\t\t\t\tif(!row.initialized || !row.heightInitialized){\n\t\t\t\t\t\taddedRows.push(row);\n\t\t\t\t\t}\n\n\t\t\t\t\trow.initialize();\n\n\t\t\t\t\tif(!initialized){\n\t\t\t\t\t\trowHeight = row.getElement().offsetHeight;\n\n\t\t\t\t\t\tif(rowHeight > this.vDomWindowBuffer){\n\t\t\t\t\t\t\tthis.vDomWindowBuffer = rowHeight * 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfillableSpace -= rowHeight;\n\t\t\t\t\tpaddingAdjust += rowHeight;\n\n\t\t\t\t\tthis.vDomBottom++;\n\t\t\t\t\tindex++;\n\t\t\t\t\ti++;\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let row of addedRows){\n\t\t\trow.clearCellHeight();\n\t\t}\n\n\t\tthis._quickNormalizeRowHeight(addedRows);\n\n\t\tif(paddingAdjust){\n\t\t\tthis.vDomBottomPad -= paddingAdjust;\n\n\t\t\tif(this.vDomBottomPad < 0 || index == rows.length -1){\n\t\t\t\tthis.vDomBottomPad = 0;\n\t\t\t}\n\n\t\t\ttable.style.paddingBottom = this.vDomBottomPad + \"px\";\n\t\t\tthis.vDomScrollPosBottom += paddingAdjust;\n\t\t}\n\t}\n\n\t_removeBottomRow(rows, fillableSpace){\n\t\tvar removableRows = [],\n\t\tpaddingAdjust = 0,\n\t\ti = 0,\n\t\tworking = true;\n\n\t\twhile(working){\n\t\t\tlet row = rows[this.vDomBottom],\n\t\t\trowHeight;\n\n\t\t\tif(row && i < this.vDomMaxRenderChain){\n\t\t\t\trowHeight = row.getHeight() || this.vDomRowHeight;\n\n\t\t\t\tif(fillableSpace >= rowHeight){\n\t\t\t\t\tthis.vDomBottom --;\n\n\t\t\t\t\tfillableSpace -= rowHeight;\n\t\t\t\t\tpaddingAdjust += rowHeight;\n\n\t\t\t\t\tremovableRows.push(row);\n\t\t\t\t\ti++;\n\t\t\t\t}else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tfor (let row of removableRows){\n\t\t\tlet rowEl = row.getElement();\n\n\t\t\tif(rowEl.parentNode){\n\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t}\n\t\t}\n\n\t\tif(paddingAdjust){\n\t\t\tthis.vDomBottomPad += paddingAdjust;\n\n\t\t\tif(this.vDomBottomPad < 0){\n\t\t\t\tthis.vDomBottomPad = 0;\n\t\t\t}\n\n\t\t\tthis.tableElement.style.paddingBottom = this.vDomBottomPad + \"px\";\n\t\t\tthis.vDomScrollPosBottom -= paddingAdjust;\n\t\t}\n\t}\n\n\t_quickNormalizeRowHeight(rows){\n\t\tfor(let row of rows){\n\t\t\trow.calcHeight();\n\t\t}\n\n\t\tfor(let row of rows){\n\t\t\trow.setCellHeight();\n\t\t}\n\t}\n}\n\nclass RowManager extends CoreFeature{\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.element = this.createHolderElement(); //containing element\n\t\tthis.tableElement = this.createTableElement(); //table element\n\t\tthis.heightFixer = this.createTableElement(); //table element\n\t\tthis.placeholder = null; //placeholder element\n\t\tthis.placeholderContents = null; //placeholder element\n\t\t\n\t\tthis.firstRender = false; //handle first render\n\t\tthis.renderMode = \"virtual\"; //current rendering mode\n\t\tthis.fixedHeight = false; //current rendering mode\n\t\t\n\t\tthis.rows = []; //hold row data objects\n\t\tthis.activeRowsPipeline = []; //hold calculation of active rows\n\t\tthis.activeRows = []; //rows currently available to on display in the table\n\t\tthis.activeRowsCount = 0; //count of active rows\n\t\t\n\t\tthis.displayRows = []; //rows currently on display in the table\n\t\tthis.displayRowsCount = 0; //count of display rows\n\t\t\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\t\t\n\t\tthis.redrawBlock = false; //prevent redraws to allow multiple data manipulations before continuing\n\t\tthis.redrawBlockRestoreConfig = false; //store latest redraw function calls for when redraw is needed\n\t\tthis.redrawBlockRenderInPosition = false; //store latest redraw function calls for when redraw is needed\n\t\t\n\t\tthis.dataPipeline = []; //hold data pipeline tasks\n\t\tthis.displayPipeline = []; //hold data display pipeline tasks\n\t\t\n\t\tthis.scrollbarWidth = 0;\n\t\t\n\t\tthis.renderer = null;\n\t}\n\t\n\t//////////////// Setup Functions /////////////////\n\t\n\tcreateHolderElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-tableholder\");\n\t\tel.setAttribute(\"tabindex\", 0);\n\t\t// el.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tcreateTableElement (){\n\t\tvar el = document.createElement(\"div\");\n\t\t\n\t\tel.classList.add(\"tabulator-table\");\n\t\tel.setAttribute(\"role\", \"rowgroup\");\n\t\t\n\t\treturn el;\n\t}\n\t\n\tinitializePlaceholder(){\n\t\tvar placeholder = this.table.options.placeholder;\n\t\t\n\t\tif(typeof placeholder === \"function\"){\n\t\t\tplaceholder = placeholder.call(this.table);\n\t\t}\n\t\t\n\t\tplaceholder = this.chain(\"placeholder\", [placeholder], placeholder, placeholder) || placeholder;\n\t\t\n\t\t//configure placeholder element\n\t\tif(placeholder){\t\n\t\t\tlet el = document.createElement(\"div\");\n\t\t\tel.classList.add(\"tabulator-placeholder\");\n\t\t\t\n\t\t\tif(typeof placeholder == \"string\"){\n\t\t\t\tlet contents = document.createElement(\"div\");\n\t\t\t\tcontents.classList.add(\"tabulator-placeholder-contents\");\n\t\t\t\tcontents.innerHTML = placeholder;\n\t\t\t\t\n\t\t\t\tel.appendChild(contents);\n\t\t\t\t\n\t\t\t\tthis.placeholderContents = contents;\n\t\t\t\t\n\t\t\t}else if(typeof HTMLElement !== \"undefined\" && placeholder instanceof HTMLElement){\n\t\t\t\t\n\t\t\t\tel.appendChild(placeholder);\n\t\t\t\tthis.placeholderContents = placeholder;\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Invalid placeholder provided, must be string or HTML Element\", placeholder);\n\t\t\t\t\n\t\t\t\tthis.el = null;\n\t\t\t}\n\t\t\t\n\t\t\tthis.placeholder = el;\n\t\t}\n\t}\n\t\n\t//return containing element\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\t\n\t//return table element\n\tgetTableElement(){\n\t\treturn this.tableElement;\n\t}\n\t\n\tinitialize(){\n\t\tthis.initializePlaceholder();\n\t\tthis.initializeRenderer();\n\t\t\n\t\t//initialize manager\n\t\tthis.element.appendChild(this.tableElement);\n\t\t\n\t\tthis.firstRender = true;\n\t\t\n\t\t//scroll header along with table body\n\t\tthis.element.addEventListener(\"scroll\", () => {\n\t\t\tvar left = this.element.scrollLeft,\n\t\t\tleftDir = this.scrollLeft > left,\n\t\t\ttop = this.element.scrollTop,\n\t\t\ttopDir = this.scrollTop > top;\n\t\t\t\n\t\t\t//handle horizontal scrolling\n\t\t\tif(this.scrollLeft != left){\n\t\t\t\tthis.scrollLeft = left;\n\t\t\t\t\n\t\t\t\tthis.dispatch(\"scroll-horizontal\", left, leftDir);\n\t\t\t\tthis.dispatchExternal(\"scrollHorizontal\", left, leftDir);\n\t\t\t\t\n\t\t\t\tthis._positionPlaceholder();\n\t\t\t}\n\t\t\t\n\t\t\t//handle vertical scrolling\n\t\t\tif(this.scrollTop != top){\n\t\t\t\tthis.scrollTop = top;\n\t\t\t\t\n\t\t\t\tthis.renderer.scrollRows(top, topDir);\n\t\t\t\t\n\t\t\t\tthis.dispatch(\"scroll-vertical\", top, topDir);\n\t\t\t\tthis.dispatchExternal(\"scrollVertical\", top, topDir);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t////////////////// Row Manipulation //////////////////\n\tfindRow(subject){\n\t\tif(typeof subject == \"object\"){\n\t\t\tif(subject instanceof Row){\n\t\t\t\t//subject is row element\n\t\t\t\treturn subject;\n\t\t\t}else if(subject instanceof RowComponent){\n\t\t\t\t//subject is public row component\n\t\t\t\treturn subject._getSelf() || false;\n\t\t\t}else if(typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement){\n\t\t\t\t//subject is a HTML element of the row\n\t\t\t\tlet match = this.rows.find((row) => {\n\t\t\t\t\treturn row.getElement() === subject;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn match || false;\n\t\t\t}else if(subject === null){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else if(typeof subject == \"undefined\"){\n\t\t\treturn false;\n\t\t}else {\n\t\t\t//subject should be treated as the index of the row\n\t\t\tlet match = this.rows.find((row) => {\n\t\t\t\treturn row.data[this.table.options.index] == subject;\n\t\t\t});\n\t\t\t\n\t\t\treturn match || false;\n\t\t}\n\t\t\n\t\t//catch all for any other type of input\n\t\treturn false;\n\t}\n\t\n\tgetRowFromDataObject(data){\n\t\tvar match = this.rows.find((row) => {\n\t\t\treturn row.data === data;\n\t\t});\n\t\t\n\t\treturn match || false;\n\t}\n\t\n\tgetRowFromPosition(position){\n\t\treturn this.getDisplayRows().find((row) => {\n\t\t\treturn row.type === \"row\" && row.getPosition() === position && row.isDisplayed();\n\t\t});\n\t}\n\t\n\tscrollToRow(row, position, ifVisible){\n\t\treturn this.renderer.scrollToRowPosition(row, position, ifVisible);\n\t}\n\t\n\t////////////////// Data Handling //////////////////\n\tsetData(data, renderInPosition, columnsChanged){\n\t\treturn new Promise((resolve, reject)=>{\n\t\t\tif(renderInPosition && this.getDisplayRows().length){\n\t\t\t\tif(this.table.options.pagination){\n\t\t\t\t\tthis._setDataActual(data, true);\n\t\t\t\t}else {\n\t\t\t\t\tthis.reRenderInPosition(() => {\n\t\t\t\t\t\tthis._setDataActual(data);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(this.table.options.autoColumns && columnsChanged && this.table.initialized){\n\t\t\t\t\tthis.table.columnManager.generateColumnsFromRowData(data);\n\t\t\t\t}\n\t\t\t\tthis.resetScroll();\n\t\t\t\t\n\t\t\t\tthis._setDataActual(data);\n\t\t\t}\n\t\t\t\n\t\t\tresolve();\n\t\t});\n\t}\n\t\n\t_setDataActual(data, renderInPosition){\n\t\tthis.dispatchExternal(\"dataProcessing\", data);\n\t\t\n\t\tthis._wipeElements();\n\t\t\n\t\tif(Array.isArray(data)){\n\t\t\tthis.dispatch(\"data-processing\", data);\n\t\t\t\n\t\t\tdata.forEach((def, i) => {\n\t\t\t\tif(def && typeof def === \"object\"){\n\t\t\t\t\tvar row = new Row(def, this);\n\t\t\t\t\tthis.rows.push(row);\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Data Loading Warning - Invalid row data detected and ignored, expecting object but received:\", def);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tthis.refreshActiveData(false, false, renderInPosition);\n\t\t\t\n\t\t\tthis.dispatch(\"data-processed\", data);\n\t\t\tthis.dispatchExternal(\"dataProcessed\", data);\n\t\t}else {\n\t\t\tconsole.error(\"Data Loading Error - Unable to process data due to invalid data type \\nExpecting: array \\nReceived: \", typeof data, \"\\nData:     \", data);\n\t\t}\n\t}\n\t\n\t_wipeElements(){\n\t\tthis.dispatch(\"rows-wipe\");\n\t\t\n\t\tthis.destroy();\n\t\t\n\t\tthis.adjustTableSize();\n\t\t\n\t\tthis.dispatch(\"rows-wiped\");\n\t}\n\t\n\tdestroy(){\n\t\tthis.rows.forEach((row) => {\n\t\t\trow.wipe();\n\t\t});\n\t\t\n\t\tthis.rows = [];\n\t\tthis.activeRows = [];\n\t\tthis.activeRowsPipeline = [];\n\t\tthis.activeRowsCount = 0;\n\t\tthis.displayRows = [];\n\t\tthis.displayRowsCount = 0;\n\t}\n\t\n\tdeleteRow(row, blockRedraw){\n\t\tvar allIndex = this.rows.indexOf(row),\n\t\tactiveIndex = this.activeRows.indexOf(row);\n\t\t\n\t\tif(activeIndex > -1){\n\t\t\tthis.activeRows.splice(activeIndex, 1);\n\t\t}\n\t\t\n\t\tif(allIndex > -1){\n\t\t\tthis.rows.splice(allIndex, 1);\n\t\t}\n\t\t\n\t\tthis.setActiveRows(this.activeRows);\n\t\t\n\t\tthis.displayRowIterator((rows) => {\n\t\t\tvar displayIndex = rows.indexOf(row);\n\t\t\t\n\t\t\tif(displayIndex > -1){\n\t\t\t\trows.splice(displayIndex, 1);\n\t\t\t}\n\t\t});\n\t\t\n\t\tif(!blockRedraw){\n\t\t\tthis.reRenderInPosition();\n\t\t}\n\t\t\n\t\tthis.regenerateRowPositions();\n\t\t\n\t\tthis.dispatchExternal(\"rowDeleted\", row.getComponent());\n\t\t\n\t\tif(!this.displayRowsCount){\n\t\t\tthis.tableEmpty();\n\t\t}\n\t\t\n\t\tif(this.subscribedExternal(\"dataChanged\")){\n\t\t\tthis.dispatchExternal(\"dataChanged\", this.getData());\n\t\t}\n\t}\n\t\n\taddRow(data, pos, index, blockRedraw){\n\t\tvar row = this.addRowActual(data, pos, index, blockRedraw);\n\t\treturn row;\n\t}\n\t\n\t//add multiple rows\n\taddRows(data, pos, index, refreshDisplayOnly){\n\t\tvar rows = [];\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tpos = this.findAddRowPos(pos);\n\t\t\t\n\t\t\tif(!Array.isArray(data)){\n\t\t\t\tdata = [data];\n\t\t\t}\n\t\t\t\n\t\t\tif((typeof index == \"undefined\" && pos) || (typeof index !== \"undefined\" && !pos)){\n\t\t\t\tdata.reverse();\n\t\t\t}\n\t\t\t\n\t\t\tdata.forEach((item, i) => {\n\t\t\t\tvar row = this.addRow(item, pos, index, true);\n\t\t\t\trows.push(row);\n\t\t\t\tthis.dispatch(\"row-added\", row, item, pos, index);\n\t\t\t});\n\t\t\t\n\t\t\tthis.refreshActiveData(refreshDisplayOnly ? \"displayPipeline\" : false, false, true);\n\t\t\t\n\t\t\tthis.regenerateRowPositions();\n\t\t\t\n\t\t\tif(this.displayRowsCount){\n\t\t\t\tthis._clearPlaceholder();\n\t\t\t}\n\t\t\t\n\t\t\tresolve(rows);\n\t\t});\n\t}\n\t\n\tfindAddRowPos(pos){\n\t\tif(typeof pos === \"undefined\"){\n\t\t\tpos = this.table.options.addRowPos;\n\t\t}\n\t\t\n\t\tif(pos === \"pos\"){\n\t\t\tpos = true;\n\t\t}\n\t\t\n\t\tif(pos === \"bottom\"){\n\t\t\tpos = false;\n\t\t}\n\t\t\n\t\treturn pos;\n\t}\n\t\n\taddRowActual(data, pos, index, blockRedraw){\n\t\tvar row = data instanceof Row ? data : new Row(data || {}, this),\n\t\ttop = this.findAddRowPos(pos),\n\t\tallIndex = -1,\n\t\tactiveIndex, chainResult;\n\t\t\n\t\tif(!index){\n\t\t\tchainResult = this.chain(\"row-adding-position\", [row, top], null, {index, top});\n\t\t\t\n\t\t\tindex = chainResult.index;\n\t\t\ttop = chainResult.top;\n\t\t}\n\t\t\n\t\tif(typeof index !== \"undefined\"){\n\t\t\tindex = this.findRow(index);\n\t\t}\n\t\t\n\t\tindex = this.chain(\"row-adding-index\", [row, index, top], null, index);\n\t\t\n\t\tif(index){\n\t\t\tallIndex = this.rows.indexOf(index);\n\t\t}\n\t\t\n\t\tif(index && allIndex > -1){\n\t\t\tactiveIndex = this.activeRows.indexOf(index);\n\t\t\t\n\t\t\tthis.displayRowIterator(function(rows){\n\t\t\t\tvar displayIndex = rows.indexOf(index);\n\t\t\t\t\n\t\t\t\tif(displayIndex > -1){\n\t\t\t\t\trows.splice((top ? displayIndex : displayIndex + 1), 0, row);\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(activeIndex > -1){\n\t\t\t\tthis.activeRows.splice((top ? activeIndex : activeIndex + 1), 0, row);\n\t\t\t}\n\t\t\t\n\t\t\tthis.rows.splice((top ? allIndex : allIndex + 1), 0, row);\n\t\t\t\n\t\t}else {\n\t\t\t\n\t\t\tif(top){\n\t\t\t\t\n\t\t\t\tthis.displayRowIterator(function(rows){\n\t\t\t\t\trows.unshift(row);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.activeRows.unshift(row);\n\t\t\t\tthis.rows.unshift(row);\n\t\t\t}else {\n\t\t\t\tthis.displayRowIterator(function(rows){\n\t\t\t\t\trows.push(row);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tthis.activeRows.push(row);\n\t\t\t\tthis.rows.push(row);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.setActiveRows(this.activeRows);\n\t\t\n\t\tthis.dispatchExternal(\"rowAdded\", row.getComponent());\n\t\t\n\t\tif(this.subscribedExternal(\"dataChanged\")){\n\t\t\tthis.dispatchExternal(\"dataChanged\", this.table.rowManager.getData());\n\t\t}\n\t\t\n\t\tif(!blockRedraw){\n\t\t\tthis.reRenderInPosition();\n\t\t}\n\t\t\n\t\treturn row;\n\t}\n\t\n\tmoveRow(from, to, after){\n\t\tthis.dispatch(\"row-move\", from, to, after);\n\t\t\n\t\tthis.moveRowActual(from, to, after);\n\t\t\n\t\tthis.regenerateRowPositions();\n\t\t\n\t\tthis.dispatch(\"row-moved\", from, to, after);\n\t\tthis.dispatchExternal(\"rowMoved\", from.getComponent());\n\t}\n\t\n\tmoveRowActual(from, to, after){\n\t\tthis.moveRowInArray(this.rows, from, to, after);\n\t\tthis.moveRowInArray(this.activeRows, from, to, after);\n\t\t\n\t\tthis.displayRowIterator((rows) => {\n\t\t\tthis.moveRowInArray(rows, from, to, after);\n\t\t});\n\t\t\n\t\tthis.dispatch(\"row-moving\", from, to, after);\n\t}\n\t\n\tmoveRowInArray(rows, from, to, after){\n\t\tvar\tfromIndex, toIndex, start, end;\n\t\t\n\t\tif(from !== to){\n\t\t\t\n\t\t\tfromIndex = rows.indexOf(from);\n\t\t\t\n\t\t\tif (fromIndex > -1) {\n\t\t\t\t\n\t\t\t\trows.splice(fromIndex, 1);\n\t\t\t\t\n\t\t\t\ttoIndex = rows.indexOf(to);\n\t\t\t\t\n\t\t\t\tif (toIndex > -1) {\n\t\t\t\t\t\n\t\t\t\t\tif(after){\n\t\t\t\t\t\trows.splice(toIndex+1, 0, from);\n\t\t\t\t\t}else {\n\t\t\t\t\t\trows.splice(toIndex, 0, from);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}else {\n\t\t\t\t\trows.splice(fromIndex, 0, from);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//restyle rows\n\t\t\tif(rows === this.getDisplayRows()){\n\t\t\t\t\n\t\t\t\tstart = fromIndex < toIndex ? fromIndex : toIndex;\n\t\t\t\tend = toIndex > fromIndex ? toIndex : fromIndex +1;\n\t\t\t\t\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tif(rows[i]){\n\t\t\t\t\t\tthis.styleRow(rows[i], i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tclearData(){\n\t\tthis.setData([]);\n\t}\n\t\n\tgetRowIndex(row){\n\t\treturn this.findRowIndex(row, this.rows);\n\t}\n\t\n\tgetDisplayRowIndex(row){\n\t\tvar index = this.getDisplayRows().indexOf(row);\n\t\treturn index > -1 ? index : false;\n\t}\n\t\n\tnextDisplayRow(row, rowOnly){\n\t\tvar index = this.getDisplayRowIndex(row),\n\t\tnextRow = false;\n\t\t\n\t\t\n\t\tif(index !== false && index < this.displayRowsCount -1){\n\t\t\tnextRow = this.getDisplayRows()[index+1];\n\t\t}\n\t\t\n\t\tif(nextRow && (!(nextRow instanceof Row) || nextRow.type != \"row\")){\n\t\t\treturn this.nextDisplayRow(nextRow, rowOnly);\n\t\t}\n\t\t\n\t\treturn nextRow;\n\t}\n\t\n\tprevDisplayRow(row, rowOnly){\n\t\tvar index = this.getDisplayRowIndex(row),\n\t\tprevRow = false;\n\t\t\n\t\tif(index){\n\t\t\tprevRow = this.getDisplayRows()[index-1];\n\t\t}\n\t\t\n\t\tif(rowOnly && prevRow && (!(prevRow instanceof Row) || prevRow.type != \"row\")){\n\t\t\treturn this.prevDisplayRow(prevRow, rowOnly);\n\t\t}\n\t\t\n\t\treturn prevRow;\n\t}\n\t\n\tfindRowIndex(row, list){\n\t\tvar rowIndex;\n\t\t\n\t\trow = this.findRow(row);\n\t\t\n\t\tif(row){\n\t\t\trowIndex = list.indexOf(row);\n\t\t\t\n\t\t\tif(rowIndex > -1){\n\t\t\t\treturn rowIndex;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\t\n\tgetData(active, transform){\n\t\tvar output = [],\n\t\trows = this.getRows(active);\n\t\t\n\t\trows.forEach(function(row){\n\t\t\tif(row.type == \"row\"){\n\t\t\t\toutput.push(row.getData(transform || \"data\"));\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetComponents(active){\n\t\tvar\toutput = [],\n\t\trows = this.getRows(active);\n\t\t\n\t\trows.forEach(function(row){\n\t\t\toutput.push(row.getComponent());\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\tgetDataCount(active){\n\t\tvar rows = this.getRows(active);\n\t\t\n\t\treturn rows.length;\n\t}\n\t\n\tscrollHorizontal(left){\n\t\tthis.scrollLeft = left;\n\t\tthis.element.scrollLeft = left;\n\t\t\n\t\tthis.dispatch(\"scroll-horizontal\", left);\n\t}\n\t\n\tregisterDataPipelineHandler(handler, priority){\n\t\tif(typeof priority !== \"undefined\"){\n\t\t\tthis.dataPipeline.push({handler, priority});\n\t\t\tthis.dataPipeline.sort((a, b) => {\n\t\t\t\treturn a.priority - b.priority;\n\t\t\t});\n\t\t}else {\n\t\t\tconsole.error(\"Data pipeline handlers must have a priority in order to be registered\");\n\t\t}\n\t}\n\t\n\tregisterDisplayPipelineHandler(handler, priority){\n\t\tif(typeof priority !== \"undefined\"){\n\t\t\tthis.displayPipeline.push({handler, priority});\n\t\t\tthis.displayPipeline.sort((a, b) => {\n\t\t\t\treturn a.priority - b.priority;\n\t\t\t});\n\t\t}else {\n\t\t\tconsole.error(\"Display pipeline handlers must have a priority in order to be registered\");\n\t\t}\n\t}\n\t\n\t//set active data set\n\trefreshActiveData(handler, skipStage, renderInPosition){\n\t\tvar table = this.table,\n\t\tstage = \"\",\n\t\tindex = 0,\n\t\tcascadeOrder = [\"all\", \"dataPipeline\", \"display\", \"displayPipeline\", \"end\"];\n\t\t\n\t\tif(!this.table.destroyed){\n\t\t\tif(typeof handler === \"function\"){\n\t\t\t\tindex = this.dataPipeline.findIndex((item) => {\n\t\t\t\t\treturn item.handler === handler;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tif(index > -1){\n\t\t\t\t\tstage = \"dataPipeline\";\n\t\t\t\t\t\n\t\t\t\t\tif(skipStage){\n\t\t\t\t\t\tif(index == this.dataPipeline.length - 1){\n\t\t\t\t\t\t\tstage = \"display\";\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tindex = this.displayPipeline.findIndex((item) => {\n\t\t\t\t\t\treturn item.handler === handler;\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tif(index > -1){\n\t\t\t\t\t\tstage = \"displayPipeline\";\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(skipStage){\n\t\t\t\t\t\t\tif(index == this.displayPipeline.length - 1){\n\t\t\t\t\t\t\t\tstage = \"end\";\n\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.error(\"Unable to refresh data, invalid handler provided\", handler);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tstage = handler || \"all\";\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t\t\n\t\t\tif(this.redrawBlock){\n\t\t\t\tif(!this.redrawBlockRestoreConfig || (this.redrawBlockRestoreConfig && ((this.redrawBlockRestoreConfig.stage === stage && index < this.redrawBlockRestoreConfig.index) || (cascadeOrder.indexOf(stage) < cascadeOrder.indexOf(this.redrawBlockRestoreConfig.stage))))){\n\t\t\t\t\tthis.redrawBlockRestoreConfig = {\n\t\t\t\t\t\thandler: handler,\n\t\t\t\t\t\tskipStage: skipStage,\n\t\t\t\t\t\trenderInPosition: renderInPosition,\n\t\t\t\t\t\tstage:stage,\n\t\t\t\t\t\tindex:index,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn;\n\t\t\t}else {\n\t\t\t\tif(Helpers.elVisible(this.element)){\n\t\t\t\t\tif(renderInPosition){\n\t\t\t\t\t\tthis.reRenderInPosition(this.refreshPipelines.bind(this, handler, stage, index, renderInPosition));\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.refreshPipelines(handler, stage, index, renderInPosition);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(!handler){\n\t\t\t\t\t\t\tthis.table.columnManager.renderer.renderColumns();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.renderTable();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(table.options.layoutColumnsOnNewData){\n\t\t\t\t\t\t\tthis.table.columnManager.redraw(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tthis.refreshPipelines(handler, stage, index, renderInPosition);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.dispatch(\"data-refreshed\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\trefreshPipelines(handler, stage, index, renderInPosition){\n\t\tthis.dispatch(\"data-refreshing\");\n\t\t\n\t\tif(!handler || !this.activeRowsPipeline[0]){\n\t\t\tthis.activeRowsPipeline[0] = this.rows.slice(0);\n\t\t}\n\t\t\n\t\t//cascade through data refresh stages\n\t\tswitch(stage){\n\t\t\tcase \"all\":\n\t\t\t//handle case where all data needs refreshing\n\t\t\t\n\t\t\tcase \"dataPipeline\":\n\t\t\t\tfor(let i = index; i < this.dataPipeline.length; i++){\n\t\t\t\t\tlet result = this.dataPipeline[i].handler(this.activeRowsPipeline[i].slice(0));\n\t\t\t\t\n\t\t\t\t\tthis.activeRowsPipeline[i + 1] = result || this.activeRowsPipeline[i].slice(0);\n\t\t\t\t}\n\t\t\t\n\t\t\t\tthis.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);\n\t\t\t\n\t\t\tcase \"display\":\n\t\t\t\tindex = 0;\n\t\t\t\tthis.resetDisplayRows();\n\t\t\t\n\t\t\tcase \"displayPipeline\":\n\t\t\t\tfor(let i = index; i < this.displayPipeline.length; i++){\n\t\t\t\t\tlet result = this.displayPipeline[i].handler((i ? this.getDisplayRows(i - 1) : this.activeRows).slice(0), renderInPosition);\n\t\t\t\t\n\t\t\t\t\tthis.setDisplayRows(result || this.getDisplayRows(i - 1).slice(0), i);\n\t\t\t\t}\n\t\t\t\n\t\t\tcase \"end\":\n\t\t\t//case to handle scenario when trying to skip past end stage\n\t\t\t\tthis.regenerateRowPositions();\n\t\t}\n\t\t\n\t\tif(this.getDisplayRows().length){\n\t\t\tthis._clearPlaceholder();\n\t\t}\n\t}\n\t\n\t//regenerate row positions\n\tregenerateRowPositions(){\n\t\tvar rows = this.getDisplayRows();\n\t\tvar index = 1;\n\t\t\n\t\trows.forEach((row) => {\n\t\t\tif (row.type === \"row\"){\n\t\t\t\trow.setPosition(index);\n\t\t\t\tindex++;\n\t\t\t}\n\t\t});\n\t}\n\t\n\tsetActiveRows(activeRows){\n\t\tthis.activeRows = this.activeRows = Object.assign([], activeRows);\n\t\tthis.activeRowsCount = this.activeRows.length;\n\t}\n\t\n\t//reset display rows array\n\tresetDisplayRows(){\n\t\tthis.displayRows = [];\n\t\t\n\t\tthis.displayRows.push(this.activeRows.slice(0));\n\t\t\n\t\tthis.displayRowsCount = this.displayRows[0].length;\n\t}\n\t\n\t//set display row pipeline data\n\tsetDisplayRows(displayRows, index){\n\t\tthis.displayRows[index] = displayRows;\n\t\t\n\t\tif(index == this.displayRows.length -1){\n\t\t\tthis.displayRowsCount = this.displayRows[this.displayRows.length -1].length;\n\t\t}\n\t}\n\t\n\tgetDisplayRows(index){\n\t\tif(typeof index == \"undefined\"){\n\t\t\treturn this.displayRows.length ? this.displayRows[this.displayRows.length -1] : [];\n\t\t}else {\n\t\t\treturn this.displayRows[index] || [];\n\t\t}\n\t}\n\t\n\tgetVisibleRows(chain, viewable){\n\t\tvar rows =  Object.assign([], this.renderer.visibleRows(!viewable));\n\t\t\n\t\tif(chain){\n\t\t\trows = this.chain(\"rows-visible\", [viewable], rows, rows);\n\t\t}\n\t\t\n\t\treturn rows;\n\t}\n\t\n\t//repeat action across display rows\n\tdisplayRowIterator(callback){\n\t\tthis.activeRowsPipeline.forEach(callback);\n\t\tthis.displayRows.forEach(callback);\n\t\t\n\t\tthis.displayRowsCount = this.displayRows[this.displayRows.length -1].length;\n\t}\n\t\n\t//return only actual rows (not group headers etc)\n\tgetRows(type){\n\t\tvar rows = [];\n\t\t\n\t\tswitch(type){\n\t\t\tcase \"active\":\n\t\t\t\trows = this.activeRows;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"display\":\n\t\t\t\trows = this.table.rowManager.getDisplayRows();\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"visible\":\n\t\t\t\trows = this.getVisibleRows(false, true);\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tdefault:\n\t\t\t\trows = this.chain(\"rows-retrieve\", type, null, this.rows) || this.rows;\n\t\t}\n\t\t\n\t\treturn rows;\n\t}\n\t\n\t///////////////// Table Rendering /////////////////\n\t//trigger rerender of table in current position\n\treRenderInPosition(callback){\n\t\tif(this.redrawBlock){\n\t\t\tif(callback){\n\t\t\t\tcallback();\n\t\t\t}else {\n\t\t\t\tthis.redrawBlockRenderInPosition = true;\n\t\t\t}\n\t\t}else {\n\t\t\tthis.dispatchExternal(\"renderStarted\");\n\t\t\t\n\t\t\tthis.renderer.rerenderRows(callback);\n\t\t\t\n\t\t\tif(!this.fixedHeight){\n\t\t\t\tthis.adjustTableSize();\n\t\t\t}\n\t\t\t\n\t\t\tthis.scrollBarCheck();\n\t\t\t\n\t\t\tthis.dispatchExternal(\"renderComplete\");\n\t\t}\n\t}\n\t\n\tscrollBarCheck(){\n\t\tvar scrollbarWidth = 0;\n\t\t\n\t\t//adjust for vertical scrollbar moving table when present\n\t\tif(this.element.scrollHeight > this.element.clientHeight){\n\t\t\tscrollbarWidth = this.element.offsetWidth - this.element.clientWidth;\n\t\t}\n\t\t\n\t\tif(scrollbarWidth !== this.scrollbarWidth){\n\t\t\tthis.scrollbarWidth = scrollbarWidth;\n\t\t\tthis.dispatch(\"scrollbar-vertical\", scrollbarWidth);\n\t\t}\n\t}\n\t\n\tinitializeRenderer(){\n\t\tvar renderClass;\n\t\t\n\t\tvar renderers = {\n\t\t\t\"virtual\": VirtualDomVertical,\n\t\t\t\"basic\": BasicVertical,\n\t\t};\n\t\t\n\t\tif(typeof this.table.options.renderVertical === \"string\"){\n\t\t\trenderClass = renderers[this.table.options.renderVertical];\n\t\t}else {\n\t\t\trenderClass = this.table.options.renderVertical;\n\t\t}\n\t\t\n\t\tif(renderClass){\n\t\t\tthis.renderMode = this.table.options.renderVertical;\n\t\t\t\n\t\t\tthis.renderer = new renderClass(this.table, this.element, this.tableElement);\n\t\t\tthis.renderer.initialize();\n\t\t\t\n\t\t\tif((this.table.element.clientHeight || this.table.options.height) && !(this.table.options.minHeight && this.table.options.maxHeight)){\n\t\t\t\tthis.fixedHeight = true;\n\t\t\t}else {\n\t\t\t\tthis.fixedHeight = false;\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.error(\"Unable to find matching renderer:\", this.table.options.renderVertical);\n\t\t}\n\t}\n\t\n\tgetRenderMode(){\n\t\treturn this.renderMode;\n\t}\n\t\n\trenderTable(){\n\t\tthis.dispatchExternal(\"renderStarted\");\n\t\t\n\t\tthis.element.scrollTop = 0;\n\t\t\n\t\tthis._clearTable();\n\t\t\n\t\tif(this.displayRowsCount){\n\t\t\tthis.renderer.renderRows();\n\t\t\t\n\t\t\tif(this.firstRender){\n\t\t\t\tthis.firstRender = false;\n\t\t\t\t\n\t\t\t\tif(!this.fixedHeight){\n\t\t\t\t\tthis.adjustTableSize();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.layoutRefresh(true);\n\t\t\t}\n\t\t}else {\n\t\t\tthis.renderEmptyScroll();\n\t\t}\n\t\t\n\t\tif(!this.fixedHeight){\n\t\t\tthis.adjustTableSize();\n\t\t}\n\t\t\n\t\tthis.dispatch(\"table-layout\");\n\t\t\n\t\tif(!this.displayRowsCount){\n\t\t\tthis._showPlaceholder();\n\t\t}\n\t\t\n\t\tthis.scrollBarCheck();\n\t\t\n\t\tthis.dispatchExternal(\"renderComplete\");\n\t}\n\t\n\t//show scrollbars on empty table div\n\trenderEmptyScroll(){\n\t\tif(this.placeholder){\n\t\t\tthis.tableElement.style.display = \"none\";\n\t\t}else {\n\t\t\tthis.tableElement.style.minWidth = this.table.columnManager.getWidth() + \"px\";\n\t\t\t// this.tableElement.style.minHeight = \"1px\";\n\t\t\t// this.tableElement.style.visibility = \"hidden\";\n\t\t}\n\t}\n\t\n\t_clearTable(){\t\n\t\tthis._clearPlaceholder();\n\t\t\n\t\tthis.scrollTop = 0;\n\t\tthis.scrollLeft = 0;\n\t\t\n\t\tthis.renderer.clearRows();\n\t}\n\t\n\ttableEmpty(){\n\t\tthis.renderEmptyScroll();\n\t\tthis._showPlaceholder();\n\t}\n\n\tcheckPlaceholder(){\n\t\tif(this.displayRowsCount){\n\t\t\tthis._clearPlaceholder();\n\t\t}else {\n\t\t\tthis.tableEmpty();\n\t\t}\n\t}\n\t\n\t_showPlaceholder(){\n\t\tif(this.placeholder){\n\t\t\tif(this.placeholder && this.placeholder.parentNode){\n\t\t\t\tthis.placeholder.parentNode.removeChild(this.placeholder);\n\t\t\t}\n\t\t\t\n\t\t\tthis.initializePlaceholder();\n\t\t\t\n\t\t\tthis.placeholder.setAttribute(\"tabulator-render-mode\", this.renderMode);\n\t\t\t\n\t\t\tthis.getElement().appendChild(this.placeholder);\n\t\t\tthis._positionPlaceholder();\n\n\t\t\tthis.adjustTableSize();\n\t\t}\n\t}\n\t\n\t_clearPlaceholder(){\n\t\tif(this.placeholder && this.placeholder.parentNode){\n\t\t\tthis.placeholder.parentNode.removeChild(this.placeholder);\n\t\t}\n\t\t\n\t\t// clear empty table placeholder min\n\t\tthis.tableElement.style.minWidth = \"\";\n\t\tthis.tableElement.style.display = \"\";\n\t}\n\t\n\t_positionPlaceholder(){\n\t\tif(this.placeholder && this.placeholder.parentNode){\n\t\t\tthis.placeholder.style.width = this.table.columnManager.getWidth() + \"px\";\n\t\t\tthis.placeholderContents.style.width = this.table.rowManager.element.clientWidth + \"px\";\n\t\t\tthis.placeholderContents.style.marginLeft = this.scrollLeft + \"px\";\n\t\t}\n\t}\n\t\n\tstyleRow(row, index){\n\t\tvar rowEl = row.getElement();\n\t\t\n\t\tif(index % 2){\n\t\t\trowEl.classList.add(\"tabulator-row-even\");\n\t\t\trowEl.classList.remove(\"tabulator-row-odd\");\n\t\t}else {\n\t\t\trowEl.classList.add(\"tabulator-row-odd\");\n\t\t\trowEl.classList.remove(\"tabulator-row-even\");\n\t\t}\n\t}\n\t\n\t//normalize height of active rows\n\tnormalizeHeight(force){\n\t\tthis.activeRows.forEach(function(row){\n\t\t\trow.normalizeHeight(force);\n\t\t});\n\t}\n\t\n\t//adjust the height of the table holder to fit in the Tabulator element\n\tadjustTableSize(){\n\t\tlet initialHeight = this.element.clientHeight, minHeight;\n\t\tlet resized = false;\n\t\t\n\t\tif(this.renderer.verticalFillMode === \"fill\"){\n\t\t\tlet otherHeight =  Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height + (this.table.footerManager && this.table.footerManager.active && !this.table.footerManager.external ? this.table.footerManager.getElement().getBoundingClientRect().height : 0));\n\t\t\t\n\t\t\tif(this.fixedHeight){\n\t\t\t\tminHeight = isNaN(this.table.options.minHeight) ? this.table.options.minHeight : this.table.options.minHeight + \"px\";\n\t\t\t\t\n\t\t\t\tconst height = \"calc(100% - \" + otherHeight + \"px)\";\n\t\t\t\tthis.element.style.minHeight = minHeight || \"calc(100% - \" + otherHeight + \"px)\";\n\t\t\t\tthis.element.style.height = height;\n\t\t\t\tthis.element.style.maxHeight = height;\n\t\t\t} else {\n\t\t\t\tthis.element.style.height = \"\";\n\t\t\t\tthis.element.style.height =\n\t\t\t\tthis.table.element.clientHeight - otherHeight + \"px\";\n\t\t\t\tthis.element.scrollTop = this.scrollTop;\n\t\t\t}\n\t\t\t\n\t\t\tthis.renderer.resize();\n\t\t\t\n\t\t\t//check if the table has changed size when dealing with variable height tables\n\t\t\tif(!this.fixedHeight && initialHeight != this.element.clientHeight){\n\t\t\t\tresized = true;\n\t\t\t\tif(this.subscribed(\"table-resize\")){\n\t\t\t\t\tthis.dispatch(\"table-resize\");\n\t\t\t\t}else {\n\t\t\t\t\tthis.redraw();\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.scrollBarCheck();\n\t\t}\n\t\t\n\t\tthis._positionPlaceholder();\n\t\treturn resized;\n\t}\n\t\n\t//reinitialize all rows\n\treinitialize(){\n\t\tthis.rows.forEach(function(row){\n\t\t\trow.reinitialize(true);\n\t\t});\n\t}\n\t\n\t//prevent table from being redrawn\n\tblockRedraw (){\n\t\tthis.redrawBlock = true;\n\t\tthis.redrawBlockRestoreConfig = false;\n\t}\n\t\n\t//restore table redrawing\n\trestoreRedraw (){\n\t\tthis.redrawBlock = false;\n\t\t\n\t\tif(this.redrawBlockRestoreConfig){\n\t\t\tthis.refreshActiveData(this.redrawBlockRestoreConfig.handler, this.redrawBlockRestoreConfig.skipStage, this.redrawBlockRestoreConfig.renderInPosition);\n\t\t\t\n\t\t\tthis.redrawBlockRestoreConfig = false;\n\t\t}else {\n\t\t\tif(this.redrawBlockRenderInPosition){\n\t\t\t\tthis.reRenderInPosition();\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.redrawBlockRenderInPosition = false;\n\t}\n\t\n\t//redraw table\n\tredraw (force){\n\t\tthis.adjustTableSize();\n\t\tthis.table.tableWidth = this.table.element.clientWidth;\n\t\t\n\t\tif(!force){\t\n\t\t\tthis.reRenderInPosition();\n\t\t\tthis.scrollHorizontal(this.scrollLeft);\n\t\t}else {\n\t\t\tthis.renderTable();\n\t\t}\n\t}\n\t\n\tresetScroll(){\n\t\tthis.element.scrollLeft = 0;\n\t\tthis.element.scrollTop = 0;\n\t\t\n\t\tif(this.table.browser === \"ie\"){\n\t\t\tvar event = document.createEvent(\"Event\");\n\t\t\tevent.initEvent(\"scroll\", false, true);\n\t\t\tthis.element.dispatchEvent(event);\n\t\t}else {\n\t\t\tthis.element.dispatchEvent(new Event('scroll'));\n\t\t}\n\t}\n}\n\nclass FooterManager extends CoreFeature{\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.active = false;\n\t\tthis.element = this.createElement(); //containing element\n\t\tthis.containerElement = this.createContainerElement(); //containing element\n\t\tthis.external = false;\n\t}\n\n\tinitialize(){\n\t\tthis.initializeElement();\n\t}\n\n\tcreateElement(){\n\t\tvar el = document.createElement(\"div\");\n\n\t\tel.classList.add(\"tabulator-footer\");\n\n\t\treturn el;\n\t}\n\n\t\n\tcreateContainerElement(){\n\t\tvar el = document.createElement(\"div\");\n\n\t\tel.classList.add(\"tabulator-footer-contents\");\n\n\t\tthis.element.appendChild(el);\n\n\t\treturn el;\n\t}\n\n\tinitializeElement(){\n\t\tif(this.table.options.footerElement){\n\n\t\t\tswitch(typeof this.table.options.footerElement){\n\t\t\t\tcase \"string\":\n\t\t\t\t\tif(this.table.options.footerElement[0] === \"<\"){\n\t\t\t\t\t\tthis.containerElement.innerHTML = this.table.options.footerElement;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.external = true;\n\t\t\t\t\t\tthis.containerElement = document.querySelector(this.table.options.footerElement);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis.element = this.table.options.footerElement;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\n\tappend(element){\n\t\tthis.activate();\n\n\t\tthis.containerElement.appendChild(element);\n\t\tthis.table.rowManager.adjustTableSize();\n\t}\n\n\tprepend(element){\n\t\tthis.activate();\n\n\t\tthis.element.insertBefore(element, this.element.firstChild);\n\t\tthis.table.rowManager.adjustTableSize();\n\t}\n\n\tremove(element){\n\t\telement.parentNode.removeChild(element);\n\t\tthis.deactivate();\n\t}\n\n\tdeactivate(force){\n\t\tif(!this.element.firstChild || force){\n\t\t\tif(!this.external){\n\t\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t\t}\n\t\t\tthis.active = false;\n\t\t}\n\t}\n\n\tactivate(){\n\t\tif(!this.active){\n\t\t\tthis.active = true;\n\t\t\tif(!this.external){\n\t\t\t\tthis.table.element.appendChild(this.getElement());\n\t\t\t\tthis.table.element.style.display = '';\n\t\t\t}\n\t\t}\n\t}\n\n\tredraw(){\n\t\tthis.dispatch(\"footer-redraw\");\n\t}\n}\n\nclass InteractionManager extends CoreFeature {\n\t\n\tconstructor (table){\n\t\tsuper(table);\n\t\t\n\t\tthis.el = null;\n\t\t\n\t\tthis.abortClasses = [\"tabulator-headers\", \"tabulator-table\"];\n\t\t\n\t\tthis.previousTargets = {};\n\t\t\n\t\tthis.listeners = [\n\t\t\t\"click\",\n\t\t\t\"dblclick\",\n\t\t\t\"contextmenu\",\n\t\t\t\"mouseenter\",\n\t\t\t\"mouseleave\",\n\t\t\t\"mouseover\",\n\t\t\t\"mouseout\",\n\t\t\t\"mousemove\",\n\t\t\t\"mouseup\",\n\t\t\t\"mousedown\",\n\t\t\t\"touchstart\",\n\t\t\t\"touchend\",\n\t\t];\n\t\t\n\t\tthis.componentMap = {\n\t\t\t\"tabulator-cell\":\"cell\",\n\t\t\t\"tabulator-row\":\"row\",\n\t\t\t\"tabulator-group\":\"group\",\n\t\t\t\"tabulator-col\":\"column\",\n\t\t};\n\t\t\n\t\tthis.pseudoTrackers = {\n\t\t\t\"row\":{\n\t\t\t\tsubscriber:null,\n\t\t\t\ttarget:null,\n\t\t\t},\n\t\t\t\"cell\":{\n\t\t\t\tsubscriber:null,\n\t\t\t\ttarget:null,\n\t\t\t},\n\t\t\t\"group\":{\n\t\t\t\tsubscriber:null,\n\t\t\t\ttarget:null,\n\t\t\t},\n\t\t\t\"column\":{\n\t\t\t\tsubscriber:null,\n\t\t\t\ttarget:null,\n\t\t\t},\n\t\t};\n\t\t\n\t\tthis.pseudoTracking = false;\n\t}\n\t\n\tinitialize(){\n\t\tthis.el = this.table.element;\n\t\t\n\t\tthis.buildListenerMap();\n\t\tthis.bindSubscriptionWatchers();\n\t}\n\t\n\tbuildListenerMap(){\n\t\tvar listenerMap = {};\n\t\t\n\t\tthis.listeners.forEach((listener) => {\n\t\t\tlistenerMap[listener] = {\n\t\t\t\thandler:null,\n\t\t\t\tcomponents:[],\n\t\t\t};\n\t\t});\n\t\t\n\t\tthis.listeners = listenerMap;\n\t}\n\t\n\tbindPseudoEvents(){\n\t\tObject.keys(this.pseudoTrackers).forEach((key) => {\n\t\t\tthis.pseudoTrackers[key].subscriber = this.pseudoMouseEnter.bind(this, key);\n\t\t\tthis.subscribe(key + \"-mouseover\", this.pseudoTrackers[key].subscriber);\n\t\t});\n\t\t\n\t\tthis.pseudoTracking = true;\n\t}\n\t\n\tpseudoMouseEnter(key, e, target){\n\t\tif(this.pseudoTrackers[key].target !== target){\n\t\t\t\n\t\t\tif(this.pseudoTrackers[key].target){\n\t\t\t\tthis.dispatch(key + \"-mouseleave\", e, this.pseudoTrackers[key].target);\n\t\t\t}\n\t\t\t\n\t\t\tthis.pseudoMouseLeave(key, e);\n\t\t\t\n\t\t\tthis.pseudoTrackers[key].target = target;\n\t\t\t\n\t\t\tthis.dispatch(key + \"-mouseenter\", e, target);\n\t\t}\n\t}\n\t\n\tpseudoMouseLeave(key, e){\n\t\tvar leaveList = Object.keys(this.pseudoTrackers),\n\t\tlinkedKeys = {\n\t\t\t\"row\":[\"cell\"],\n\t\t\t\"cell\":[\"row\"],\n\t\t};\n\t\t\n\t\tleaveList = leaveList.filter((item) => {\n\t\t\tvar links = linkedKeys[key];\n\t\t\treturn item !== key && (!links || (links && !links.includes(item)));\n\t\t});\n\t\t\n\t\t\n\t\tleaveList.forEach((key) => {\n\t\t\tvar target = this.pseudoTrackers[key].target;\n\t\t\t\n\t\t\tif(this.pseudoTrackers[key].target){\n\t\t\t\tthis.dispatch(key + \"-mouseleave\", e, target);\n\t\t\t\t\n\t\t\t\tthis.pseudoTrackers[key].target = null;\n\t\t\t}\n\t\t});\n\t}\n\t\n\t\n\tbindSubscriptionWatchers(){\n\t\tvar listeners = Object.keys(this.listeners),\n\t\tcomponents = Object.values(this.componentMap);\n\t\t\n\t\tfor(let comp of components){\n\t\t\tfor(let listener of listeners){\n\t\t\t\tlet key = comp + \"-\" + listener;\n\t\t\t\t\n\t\t\t\tthis.subscriptionChange(key, this.subscriptionChanged.bind(this, comp, listener));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.subscribe(\"table-destroy\", this.clearWatchers.bind(this));\n\t}\n\t\n\tsubscriptionChanged(component, key, added){\n\t\tvar listener = this.listeners[key].components,\n\t\tindex = listener.indexOf(component),\n\t\tchanged = false;\n\t\t\n\t\tif(added){\n\t\t\tif(index === -1){\n\t\t\t\tlistener.push(component);\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t}else {\n\t\t\tif(!this.subscribed(component + \"-\" + key)){\n\t\t\t\tif(index > -1){\n\t\t\t\t\tlistener.splice(index, 1);\n\t\t\t\t\tchanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif((key === \"mouseenter\" || key === \"mouseleave\") && !this.pseudoTracking){\n\t\t\tthis.bindPseudoEvents();\n\t\t}\n\t\t\n\t\tif(changed){\n\t\t\tthis.updateEventListeners();\n\t\t}\n\t}\n\t\n\tupdateEventListeners(){\n\t\tfor(let key in this.listeners){\n\t\t\tlet listener = this.listeners[key];\n\t\t\t\n\t\t\tif(listener.components.length){\n\t\t\t\tif(!listener.handler){\n\t\t\t\t\tlistener.handler = this.track.bind(this, key);\n\t\t\t\t\tthis.el.addEventListener(key, listener.handler);\n\t\t\t\t\t// this.el.addEventListener(key, listener.handler, {passive: true})\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tif(listener.handler){\n\t\t\t\t\tthis.el.removeEventListener(key, listener.handler);\n\t\t\t\t\tlistener.handler = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\ttrack(type, e){\n\t\tvar path = (e.composedPath && e.composedPath()) || e.path;\n\t\t\n\t\tvar targets = this.findTargets(path);\n\t\ttargets = this.bindComponents(type, targets);\n\t\t\n\t\tthis.triggerEvents(type, e, targets);\n\t\t\n\t\tif(this.pseudoTracking && (type == \"mouseover\" || type == \"mouseleave\") && !Object.keys(targets).length){\n\t\t\tthis.pseudoMouseLeave(\"none\", e);\n\t\t}\n\t}\n\t\n\tfindTargets(path){\n\t\tvar targets = {};\n\t\t\n\t\tlet componentMap = Object.keys(this.componentMap);\n\t\t\n\t\tfor (let el of path) {\n\t\t\tlet classList = el.classList ? [...el.classList] : [];\n\t\t\t\n\t\t\tlet abort = classList.filter((item) => {\n\t\t\t\treturn this.abortClasses.includes(item);\n\t\t\t});\n\t\t\t\n\t\t\tif(abort.length){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tlet elTargets = classList.filter((item) => {\n\t\t\t\treturn componentMap.includes(item);\n\t\t\t});\n\t\t\t\n\t\t\tfor (let target of elTargets) {\n\t\t\t\tif(!targets[this.componentMap[target]]){\n\t\t\t\t\ttargets[this.componentMap[target]] = el;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(targets.group && targets.group === targets.row){\n\t\t\tdelete targets.row;\n\t\t}\n\n\t\treturn targets;\n\t}\n\t\n\tbindComponents(type, targets){\n\t\t//ensure row component is looked up before cell\n\t\tvar keys = Object.keys(targets).reverse(),\n\t\tlistener = this.listeners[type],\n\t\tmatches = {},\n\t\toutput = {},\n\t\ttargetMatches = {};\n\t\n\t\tfor(let key of keys){\n\t\t\tlet component,\n\t\t\ttarget = targets[key],\n\t\t\tpreviousTarget = this.previousTargets[key];\n\t\t\t\n\t\t\tif(previousTarget && previousTarget.target === target){\n\t\t\t\tcomponent = previousTarget.component;\n\t\t\t}else {\n\t\t\t\tswitch(key){\n\t\t\t\t\tcase \"row\":\n\t\t\t\t\tcase \"group\":\n\t\t\t\t\t\tif(listener.components.includes(\"row\") || listener.components.includes(\"cell\") || listener.components.includes(\"group\")){\n\t\t\t\t\t\t\tlet rows = this.table.rowManager.getVisibleRows(true);\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tcomponent = rows.find((row) => {\n\t\t\t\t\t\t\t\treturn row.getElement() === target;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(targets[\"row\"] && targets[\"row\"].parentNode && targets[\"row\"].parentNode.closest(\".tabulator-row\")){\n\t\t\t\t\t\t\t\ttargets[key] = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"column\":\n\t\t\t\t\t\tif(listener.components.includes(\"column\")){\n\t\t\t\t\t\t\tcomponent = this.table.columnManager.findColumn(target);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\tcase \"cell\":\n\t\t\t\t\t\tif(listener.components.includes(\"cell\")){\n\t\t\t\t\t\t\tif(matches[\"row\"] instanceof Row){\n\t\t\t\t\t\t\t\tcomponent = matches[\"row\"].findCell(target);\n\t\t\t\t\t\t\t}else {\t\n\t\t\t\t\t\t\t\tif(targets[\"row\"]){\n\t\t\t\t\t\t\t\t\tconsole.warn(\"Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(component){\n\t\t\t\tmatches[key] = component;\n\t\t\t\ttargetMatches[key] = {\n\t\t\t\t\ttarget:target,\n\t\t\t\t\tcomponent:component,\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.previousTargets = targetMatches;\n\n\t\t//reverse order keys are set in so events trigger in correct sequence\n\t\tObject.keys(targets).forEach((key) => {\n\t\t\tlet value = matches[key];\n\t\t\toutput[key] = value;\n\t\t});\n\t\t\n\t\treturn output;\n\t}\n\t\n\ttriggerEvents(type, e, targets){\n\t\tvar listener = this.listeners[type];\n\n\t\tfor(let key in targets){\n\t\t\tif(targets[key] && listener.components.includes(key)){\n\t\t\t\tthis.dispatch(key + \"-\" + type, e, targets[key]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tclearWatchers(){\n\t\tfor(let key in this.listeners){\n\t\t\tlet listener = this.listeners[key];\n\t\t\t\n\t\t\tif(listener.handler){\n\t\t\t\tthis.el.removeEventListener(key, listener.handler);\n\t\t\t\tlistener.handler = null;\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ComponentFunctionBinder{\n\n\tconstructor(table){\n\t\tthis.table = table;\n\n\t\tthis.bindings = {};\n\t}\n\n\tbind(type, funcName, handler){\n\t\tif(!this.bindings[type]){\n\t\t\tthis.bindings[type] = {};\n\t\t}\n\n\t\tif(this.bindings[type][funcName]){\n\t\t\tconsole.warn(\"Unable to bind component handler, a matching function name is already bound\", type, funcName, handler);\n\t\t}else {\n\t\t\tthis.bindings[type][funcName] = handler;\n\t\t}\n\t}\n\n\thandle(type, component, name){\n\t\tif(this.bindings[type] && this.bindings[type][name] && typeof this.bindings[type][name].bind === 'function'){\n\t\t\treturn this.bindings[type][name].bind(null, component);\n\t\t}else {\n\t\t\tif(name !== \"then\" && typeof name === \"string\" && !name.startsWith(\"_\")){\n\t\t\t\tif(this.table.options.debugInvalidComponentFuncs){\n\t\t\t\t\tconsole.error(\"The \" + type + \" component does not have a \" + name + \" function, have you checked that you have the correct Tabulator module installed?\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass DataLoader extends CoreFeature{\n\tconstructor(table){\n\t\tsuper(table);\n\t\t\n\t\tthis.requestOrder = 0; //prevent requests coming out of sequence if overridden by another load request\n\t\tthis.loading = false;\n\t}\n\t\n\tinitialize(){}\n\t\n\tload(data, params, config, replace, silent, columnsChanged){\n\t\tvar requestNo = ++this.requestOrder;\n\n\t\tif(this.table.destroyed){\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\t\n\t\tthis.dispatchExternal(\"dataLoading\", data);\n\t\t\n\t\t//parse json data to array\n\t\tif (data && (data.indexOf(\"{\") == 0 || data.indexOf(\"[\") == 0)){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\t\n\t\tif(this.confirm(\"data-loading\", [data, params, config, silent])){\n\t\t\tthis.loading = true;\n\t\t\t\n\t\t\tif(!silent){\n\t\t\t\tthis.alertLoader();\n\t\t\t}\n\t\t\t\n\t\t\t//get params for request\n\t\t\tparams = this.chain(\"data-params\", [data, config, silent], params || {}, params || {});\n\t\t\t\n\t\t\tparams = this.mapParams(params, this.table.options.dataSendParams);\n\t\t\t\n\t\t\tvar result = this.chain(\"data-load\", [data, params, config, silent], false, Promise.resolve([]));\n\t\t\t\n\t\t\treturn result.then((response) => {\n\t\t\t\tif(!this.table.destroyed){\n\t\t\t\t\tif(!Array.isArray(response) && typeof response == \"object\"){\n\t\t\t\t\t\tresponse = this.mapParams(response, this.objectInvert(this.table.options.dataReceiveParams));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar rowData = this.chain(\"data-loaded\", [response], null, response);\n\t\t\t\t\t\n\t\t\t\t\tif(requestNo == this.requestOrder){\n\t\t\t\t\t\tthis.clearAlert();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(rowData !== false){\n\t\t\t\t\t\t\tthis.dispatchExternal(\"dataLoaded\", rowData);\n\t\t\t\t\t\t\tthis.table.rowManager.setData(rowData,  replace, typeof columnsChanged === \"undefined\" ? !replace : columnsChanged);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\tconsole.warn(\"Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made\");\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Data Load Response Blocked - Table has been destroyed\");\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(\"Data Load Error: \", error);\n\t\t\t\tthis.dispatchExternal(\"dataLoadError\", error);\n\t\t\t\t\n\t\t\t\tif(!silent){\n\t\t\t\t\tthis.alertError();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.clearAlert();\n\t\t\t\t}, this.table.options.dataLoaderErrorTimeout);\n\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t});\n\t\t}else {\n\t\t\tthis.dispatchExternal(\"dataLoaded\", data);\n\t\t\t\n\t\t\tif(!data){\n\t\t\t\tdata = [];\n\t\t\t}\n\t\t\t\n\t\t\tthis.table.rowManager.setData(data, replace, typeof columnsChanged === \"undefined\" ? !replace : columnsChanged);\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\t\n\tmapParams(params, map){\n\t\tvar output = {};\n\t\t\n\t\tfor(let key in params){\n\t\t\toutput[map.hasOwnProperty(key) ? map[key] : key] = params[key];\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tobjectInvert(obj){\n\t\tvar output = {};\n\t\t\n\t\tfor(let key in obj){\n\t\t\toutput[obj[key]] = key;\n\t\t}\n\t\t\n\t\treturn output;\n\t}\n\t\n\tblockActiveLoad(){\n\t\tthis.requestOrder++;\n\t}\n\t\n\talertLoader(){\n\t\tvar shouldLoad = typeof this.table.options.dataLoader === \"function\" ? this.table.options.dataLoader() : this.table.options.dataLoader;\n\t\t\n\t\tif(shouldLoad){\n\t\t\tthis.table.alertManager.alert(this.table.options.dataLoaderLoading || this.langText(\"data|loading\"));\n\t\t}\n\t}\n\t\n\talertError(){\n\t\tthis.table.alertManager.alert(this.table.options.dataLoaderError || this.langText(\"data|error\"), \"error\");\n\t}\n\t\n\tclearAlert(){\n\t\tthis.table.alertManager.clear();\n\t}\n}\n\nclass ExternalEventBus {\n\n\tconstructor(table, optionsList, debug){\n\t\tthis.table = table;\n\t\tthis.events = {};\n\t\tthis.optionsList = optionsList || {};\n\t\tthis.subscriptionNotifiers = {};\n\n\t\tthis.dispatch = debug ? this._debugDispatch.bind(this) : this._dispatch.bind(this);\n\t\tthis.debug = debug;\n\t}\n\n\tsubscriptionChange(key, callback){\n\t\tif(!this.subscriptionNotifiers[key]){\n\t\t\tthis.subscriptionNotifiers[key] = [];\n\t\t}\n\n\t\tthis.subscriptionNotifiers[key].push(callback);\n\n\t\tif(this.subscribed(key)){\n\t\t\tthis._notifySubscriptionChange(key, true);\n\t\t}\n\t}\n\n\tsubscribe(key, callback){\n\t\tif(!this.events[key]){\n\t\t\tthis.events[key] = [];\n\t\t}\n\n\t\tthis.events[key].push(callback);\n\n\t\tthis._notifySubscriptionChange(key, true);\n\t}\n\n\tunsubscribe(key, callback){\n\t\tvar index;\n\n\t\tif(this.events[key]){\n\t\t\tif(callback){\n\t\t\t\tindex = this.events[key].findIndex((item) => {\n\t\t\t\t\treturn item === callback;\n\t\t\t\t});\n\n\t\t\t\tif(index > -1){\n\t\t\t\t\tthis.events[key].splice(index, 1);\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Cannot remove event, no matching event found:\", key, callback);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tdelete this.events[key];\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Cannot remove event, no events set on:\", key);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._notifySubscriptionChange(key, false);\n\t}\n\n\tsubscribed(key){\n\t\treturn this.events[key] && this.events[key].length;\n\t}\n\n\t_notifySubscriptionChange(key, subscribed){\n\t\tvar notifiers = this.subscriptionNotifiers[key];\n\n\t\tif(notifiers){\n\t\t\tnotifiers.forEach((callback)=>{\n\t\t\t\tcallback(subscribed);\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatch(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args.shift(),\n\t\tresult;\n\n\t\tif(this.events[key]){\n\t\t\tthis.events[key].forEach((callback, i) => {\n\t\t\t\tlet callResult = callback.apply(this.table, args);\n\n\t\t\t\tif(!i){\n\t\t\t\t\tresult = callResult;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t_debugDispatch(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args[0];\n\n\t\targs[0] = \"ExternalEvent:\" + args[0];\n\n\t\tif(this.debug === true || this.debug.includes(key)){\n\t\t\tconsole.log(...args);\n\t\t}\n\n\t\treturn this._dispatch(...arguments);\n\t}\n}\n\nclass InternalEventBus {\n\n\tconstructor(debug){\n\t\tthis.events = {};\n\t\tthis.subscriptionNotifiers = {};\n\n\t\tthis.dispatch = debug ? this._debugDispatch.bind(this) : this._dispatch.bind(this);\n\t\tthis.chain = debug ? this._debugChain.bind(this) : this._chain.bind(this);\n\t\tthis.confirm = debug ? this._debugConfirm.bind(this) : this._confirm.bind(this);\n\t\tthis.debug = debug;\n\t}\n\n\tsubscriptionChange(key, callback){\n\t\tif(!this.subscriptionNotifiers[key]){\n\t\t\tthis.subscriptionNotifiers[key] = [];\n\t\t}\n\n\t\tthis.subscriptionNotifiers[key].push(callback);\n\n\t\tif(this.subscribed(key)){\n\t\t\tthis._notifySubscriptionChange(key, true);\n\t\t}\n\t}\n\n\tsubscribe(key, callback, priority = 10000){\n\t\tif(!this.events[key]){\n\t\t\tthis.events[key] = [];\n\t\t}\n\n\t\tthis.events[key].push({callback, priority});\n\n\t\tthis.events[key].sort((a, b) => {\n\t\t\treturn a.priority - b.priority;\n\t\t});\n\n\t\tthis._notifySubscriptionChange(key, true);\n\t}\n\n\tunsubscribe(key, callback){\n\t\tvar index;\n\n\t\tif(this.events[key]){\n\t\t\tif(callback){\n\t\t\t\tindex = this.events[key].findIndex((item) => {\n\t\t\t\t\treturn item.callback === callback;\n\t\t\t\t});\n\n\t\t\t\tif(index > -1){\n\t\t\t\t\tthis.events[key].splice(index, 1);\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Cannot remove event, no matching event found:\", key, callback);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Cannot remove event, no events set on:\", key);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._notifySubscriptionChange(key, false);\n\t}\n\n\tsubscribed(key){\n\t\treturn this.events[key] && this.events[key].length;\n\t}\n\n\t_chain(key, args, initialValue, fallback){\n\t\tvar value = initialValue;\n\n\t\tif(!Array.isArray(args)){\n\t\t\targs = [args];\n\t\t}\n\n\t\tif(this.subscribed(key)){\n\t\t\tthis.events[key].forEach((subscriber, i) => {\n\t\t\t\tvalue = subscriber.callback.apply(this, args.concat([value]));\n\t\t\t});\n\n\t\t\treturn value;\n\t\t}else {\n\t\t\treturn typeof fallback === \"function\" ? fallback() : fallback;\n\t\t}\n\t}\n\n\t_confirm(key, args){\n\t\tvar confirmed = false;\n\n\t\tif(!Array.isArray(args)){\n\t\t\targs = [args];\n\t\t}\n\n\t\tif(this.subscribed(key)){\n\t\t\tthis.events[key].forEach((subscriber, i) => {\n\t\t\t\tif(subscriber.callback.apply(this, args)){\n\t\t\t\t\tconfirmed = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn confirmed;\n\t}\n\n\t_notifySubscriptionChange(key, subscribed){\n\t\tvar notifiers = this.subscriptionNotifiers[key];\n\n\t\tif(notifiers){\n\t\t\tnotifiers.forEach((callback)=>{\n\t\t\t\tcallback(subscribed);\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatch(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args.shift();\n\n\t\tif(this.events[key]){\n\t\t\tthis.events[key].forEach((subscriber) => {\n\t\t\t\tsubscriber.callback.apply(this, args);\n\t\t\t});\n\t\t}\n\t}\n\n\t_debugDispatch(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args[0];\n\n\t\targs[0] = \"InternalEvent:\" + key;\n\n\t\tif(this.debug === true || this.debug.includes(key)){\n\t\t\tconsole.log(...args);\n\t\t}\n\n\t\treturn this._dispatch(...arguments);\n\t}\n\n\t_debugChain(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args[0];\n\n\t\targs[0] = \"InternalEvent:\" + key;\n\n\t\tif(this.debug === true || this.debug.includes(key)){\n\t\t\tconsole.log(...args);\n\t\t}\n\n\t\treturn this._chain(...arguments);\n\t}\n\n\t_debugConfirm(){\n\t\tvar args = Array.from(arguments),\n\t\tkey = args[0];\n\n\t\targs[0] = \"InternalEvent:\" + key;\n\n\t\tif(this.debug === true || this.debug.includes(key)){\n\t\t\tconsole.log(...args);\n\t\t}\n\n\t\treturn this._confirm(...arguments);\n\t}\n}\n\nclass DeprecationAdvisor extends CoreFeature{\n\t\n\tconstructor(table){\n\t\tsuper(table);\n\t}\n\t\n\t_warnUser(){\n\t\tif(this.options(\"debugDeprecation\")){\n\t\t\tconsole.warn(...arguments);\n\t\t}\n\t}\n\t\n\tcheck(oldOption, newOption, convert){\n\t\tvar msg = \"\";\n\t\t\n\t\tif(typeof this.options(oldOption) !== \"undefined\"){\n\t\t\tmsg = \"Deprecated Setup Option - Use of the %c\" + oldOption + \"%c option is now deprecated\";\n\t\t\t\n\t\t\tif(newOption){\n\t\t\t\tmsg = msg + \", Please use the %c\" + newOption + \"%c option instead\";\n\t\t\t\tthis._warnUser(msg, 'font-weight: bold;', 'font-weight: normal;', 'font-weight: bold;', 'font-weight: normal;');\n\n\t\t\t\tif(convert){\n\t\t\t\t\tthis.table.options[newOption] = this.table.options[oldOption];\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tthis._warnUser(msg, 'font-weight: bold;', 'font-weight: normal;');\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t}else {\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\tcheckMsg(oldOption, msg){\n\t\tif(typeof this.options(oldOption) !== \"undefined\"){\n\t\t\tthis._warnUser(\"%cDeprecated Setup Option - Use of the %c\" + oldOption + \" %c option is now deprecated, \" + msg, 'font-weight: normal;', 'font-weight: bold;', 'font-weight: normal;');\n\t\t\t\n\t\t\treturn false;\n\t\t}else {\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n\tmsg(msg){\n\t\tthis._warnUser(msg);\n\t}\n}\n\nclass DependencyRegistry extends CoreFeature{\r\n\t\r\n\tconstructor(table){\r\n\t\tsuper(table);\r\n\t\t\r\n\t\tthis.deps = {};\r\n\t\t\r\n\t\tthis.props = {\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n\t\r\n\tinitialize(){\r\n\t\tthis.deps = Object.assign({}, this.options(\"dependencies\"));\r\n\t}\r\n\t\r\n\tlookup(key, prop, silent){\r\n\t\tif(Array.isArray(key)){\r\n\t\t\tfor (const item of key) {\r\n\t\t\t\tvar match = this.lookup(item, prop, true);\r\n\r\n\t\t\t\tif(match){\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(match){\r\n\t\t\t\treturn match;\r\n\t\t\t}else {\r\n\t\t\t\tthis.error(key);\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tif(prop){\r\n\t\t\t\treturn this.lookupProp(key, prop, silent);\r\n\t\t\t}else {\r\n\t\t\t\treturn this.lookupKey(key, silent);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tlookupProp(key, prop, silent){\r\n\t\tvar dependency;\r\n\t\t\r\n\t\tif(this.props[key] && this.props[key][prop]){\r\n\t\t\treturn this.props[key][prop];\r\n\t\t}else {\r\n\t\t\tdependency = this.lookupKey(key, silent);\r\n\t\t\t\r\n\t\t\tif(dependency){\r\n\t\t\t\tif(!this.props[key]){\r\n\t\t\t\t\tthis.props[key] = {};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.props[key][prop] = dependency[prop] || dependency;\r\n\t\t\t\treturn this.props[key][prop];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tlookupKey(key, silent){\r\n\t\tvar dependency;\r\n\t\t\r\n\t\tif(this.deps[key]){\r\n\t\t\tdependency = this.deps[key];\r\n\t\t}else if(window[key]){\r\n\t\t\tthis.deps[key] = window[key];\r\n\t\t\tdependency = this.deps[key];\r\n\t\t}else {\r\n\t\t\tif(!silent){\r\n\t\t\t\tthis.error(key);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn dependency;\r\n\t}\r\n\r\n\terror(key){\r\n\t\tconsole.error(\"Unable to find dependency\", key, \"Please check documentation and ensure you have imported the required library into your project\");\r\n\t}\r\n}\n\n//resize columns to fit data they contain\nfunction fitData(columns, forced){\n\tif(forced){\n\t\tthis.table.columnManager.renderer.reinitializeColumnWidths(columns);\n\t}\n\t\n\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\tthis.table.modules.responsiveLayout.update();\n\t}\n}\n\n//resize columns to fit data they contain and stretch row to fill table, also used for fitDataTable\nfunction fitDataGeneral(columns, forced){\n\tcolumns.forEach(function(column){\n\t\tcolumn.reinitializeWidth();\n\t});\n\n\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\tthis.table.modules.responsiveLayout.update();\n\t}\n}\n\n//resize columns to fit data the contain and stretch last column to fill table\nfunction fitDataStretch(columns, forced){\n\tvar colsWidth = 0,\n\ttableWidth = this.table.rowManager.element.clientWidth,\n\tgap = 0,\n\tlastCol = false;\n\n\tcolumns.forEach((column, i) => {\n\t\tif(!column.widthFixed){\n\t\t\tcolumn.reinitializeWidth();\n\t\t}\n\n\t\tif(this.table.options.responsiveLayout ? column.modules.responsive.visible : column.visible){\n\t\t\tlastCol = column;\n\t\t}\n\n\t\tif(column.visible){\n\t\t\tcolsWidth += column.getWidth();\n\t\t}\n\t});\n\n\tif(lastCol){\n\t\tgap = tableWidth - colsWidth + lastCol.getWidth();\n\n\t\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\t\tlastCol.setWidth(0);\n\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t}\n\n\t\tif(gap > 0){\n\t\t\tlastCol.setWidth(gap);\n\t\t}else {\n\t\t\tlastCol.reinitializeWidth();\n\t\t}\n\t}else {\n\t\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t}\n\t}\n}\n\n//resize columns to fit\nfunction fitColumns(columns, forced){\n\tvar totalWidth = this.table.rowManager.element.getBoundingClientRect().width; //table element width\n\tvar fixedWidth = 0; //total width of columns with a defined width\n\tvar flexWidth = 0; //total width available to flexible columns\n\tvar flexGrowUnits = 0; //total number of widthGrow blocks across all columns\n\tvar flexColWidth = 0; //desired width of flexible columns\n\tvar flexColumns = []; //array of flexible width columns\n\tvar fixedShrinkColumns = []; //array of fixed width columns that can shrink\n\tvar flexShrinkUnits = 0; //total number of widthShrink blocks across all columns\n\tvar overflowWidth = 0; //horizontal overflow width\n\tvar gapFill = 0; //number of pixels to be added to final column to close and half pixel gaps\n\n\tfunction calcWidth(width){\n\t\tvar colWidth;\n\n\t\tif(typeof(width) == \"string\"){\n\t\t\tif(width.indexOf(\"%\") > -1){\n\t\t\t\tcolWidth = (totalWidth / 100) * parseInt(width);\n\t\t\t}else {\n\t\t\t\tcolWidth = parseInt(width);\n\t\t\t}\n\t\t}else {\n\t\t\tcolWidth = width;\n\t\t}\n\n\t\treturn colWidth;\n\t}\n\n\t//ensure columns resize to take up the correct amount of space\n\tfunction scaleColumns(columns, freeSpace, colWidth, shrinkCols){\n\t\tvar oversizeCols = [],\n\t\toversizeSpace = 0,\n\t\tremainingSpace = 0,\n\t\tnextColWidth = 0,\n\t\tremainingFlexGrowUnits = flexGrowUnits,\n\t\tgap = 0,\n\t\tchangeUnits = 0,\n\t\tundersizeCols = [];\n\n\t\tfunction calcGrow(col){\n\t\t\treturn (colWidth * (col.column.definition.widthGrow || 1));\n\t\t}\n\n\t\tfunction calcShrink(col){\n\t\t\treturn  (calcWidth(col.width) - (colWidth * (col.column.definition.widthShrink || 0)));\n\t\t}\n\n\t\tcolumns.forEach(function(col, i){\n\t\t\tvar width = shrinkCols ? calcShrink(col) : calcGrow(col);\n\t\t\tif(col.column.minWidth >= width){\n\t\t\t\toversizeCols.push(col);\n\t\t\t}else {\n\t\t\t\tif(col.column.maxWidth && col.column.maxWidth < width){\n\t\t\t\t\tcol.width = col.column.maxWidth;\n\t\t\t\t\tfreeSpace -= col.column.maxWidth;\n\n\t\t\t\t\tremainingFlexGrowUnits -= shrinkCols ? (col.column.definition.widthShrink || 1) : (col.column.definition.widthGrow || 1);\n\n\t\t\t\t\tif(remainingFlexGrowUnits){\n\t\t\t\t\t\tcolWidth = Math.floor(freeSpace/remainingFlexGrowUnits);\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tundersizeCols.push(col);\n\t\t\t\t\tchangeUnits += shrinkCols ? (col.column.definition.widthShrink || 1) : (col.column.definition.widthGrow || 1);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(oversizeCols.length){\n\t\t\toversizeCols.forEach(function(col){\n\t\t\t\toversizeSpace += shrinkCols ?  col.width - col.column.minWidth : col.column.minWidth;\n\t\t\t\tcol.width = col.column.minWidth;\n\t\t\t});\n\n\t\t\tremainingSpace = freeSpace - oversizeSpace;\n\n\t\t\tnextColWidth = changeUnits ? Math.floor(remainingSpace/changeUnits) : remainingSpace;\n\n\t\t\tgap = scaleColumns(undersizeCols, remainingSpace, nextColWidth, shrinkCols);\n\t\t}else {\n\t\t\tgap = changeUnits ? freeSpace - (Math.floor(freeSpace/changeUnits) * changeUnits) : freeSpace;\n\n\t\t\tundersizeCols.forEach(function(column){\n\t\t\t\tcolumn.width = shrinkCols ? calcShrink(column) : calcGrow(column);\n\t\t\t});\n\t\t}\n\n\t\treturn gap;\n\t}\n\n\tif(this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)){\n\t\tthis.table.modules.responsiveLayout.update();\n\t}\n\n\t//adjust for vertical scrollbar if present\n\tif(this.table.rowManager.element.scrollHeight > this.table.rowManager.element.clientHeight){\n\t\ttotalWidth -= this.table.rowManager.element.offsetWidth - this.table.rowManager.element.clientWidth;\n\t}\n\n\tcolumns.forEach(function(column){\n\t\tvar width, minWidth, colWidth;\n\n\t\tif(column.visible){\n\n\t\t\twidth = column.definition.width;\n\t\t\tminWidth =  parseInt(column.minWidth);\n\n\t\t\tif(width){\n\n\t\t\t\tcolWidth = calcWidth(width);\n\n\t\t\t\tfixedWidth += colWidth > minWidth ? colWidth : minWidth;\n\n\t\t\t\tif(column.definition.widthShrink){\n\t\t\t\t\tfixedShrinkColumns.push({\n\t\t\t\t\t\tcolumn:column,\n\t\t\t\t\t\twidth:colWidth > minWidth ? colWidth : minWidth\n\t\t\t\t\t});\n\t\t\t\t\tflexShrinkUnits += column.definition.widthShrink;\n\t\t\t\t}\n\n\t\t\t}else {\n\t\t\t\tflexColumns.push({\n\t\t\t\t\tcolumn:column,\n\t\t\t\t\twidth:0,\n\t\t\t\t});\n\t\t\t\tflexGrowUnits += column.definition.widthGrow || 1;\n\t\t\t}\n\t\t}\n\t});\n\n\t//calculate available space\n\tflexWidth = totalWidth - fixedWidth;\n\n\t//calculate correct column size\n\tflexColWidth = Math.floor(flexWidth / flexGrowUnits);\n\n\t//generate column widths\n\tgapFill = scaleColumns(flexColumns, flexWidth, flexColWidth, false);\n\n\t//increase width of last column to account for rounding errors\n\tif(flexColumns.length && gapFill > 0){\n\t\tflexColumns[flexColumns.length-1].width += gapFill;\n\t}\n\n\t//calculate space for columns to be shrunk into\n\tflexColumns.forEach(function(col){\n\t\tflexWidth -= col.width;\n\t});\n\n\toverflowWidth = Math.abs(gapFill) + flexWidth;\n\n\t//shrink oversize columns if there is no available space\n\tif(overflowWidth > 0 && flexShrinkUnits){\n\t\tgapFill = scaleColumns(fixedShrinkColumns, overflowWidth, Math.floor(overflowWidth / flexShrinkUnits), true);\n\t}\n\n\t//decrease width of last column to account for rounding errors\n\tif(gapFill && fixedShrinkColumns.length){\n\t\tfixedShrinkColumns[fixedShrinkColumns.length-1].width -= gapFill;\n\t}\n\n\tflexColumns.forEach(function(col){\n\t\tcol.column.setWidth(col.width);\n\t});\n\n\tfixedShrinkColumns.forEach(function(col){\n\t\tcol.column.setWidth(col.width);\n\t});\n}\n\nvar defaultModes = {\n\tfitData:fitData,\n\tfitDataFill:fitDataGeneral,\n\tfitDataTable:fitDataGeneral,\n\tfitDataStretch:fitDataStretch,\n\tfitColumns:fitColumns ,\n};\n\nclass Layout extends Module{\n\n\tstatic moduleName = \"layout\";\n\n\t//load defaults\n\tstatic modes = defaultModes;\n\n\tconstructor(table){\n\t\tsuper(table, \"layout\");\n\n\t\tthis.mode = null;\n\n\t\tthis.registerTableOption(\"layout\", \"fitData\"); //layout type\n\t\tthis.registerTableOption(\"layoutColumnsOnNewData\", false); //update column widths on setData\n\n\t\tthis.registerColumnOption(\"widthGrow\");\n\t\tthis.registerColumnOption(\"widthShrink\");\n\t}\n\n\t//initialize layout system\n\tinitialize(){\n\t\tvar layout = this.table.options.layout;\n\n\t\tif(Layout.modes[layout]){\n\t\t\tthis.mode = layout;\n\t\t}else {\n\t\t\tconsole.warn(\"Layout Error - invalid mode set, defaulting to 'fitData' : \" + layout);\n\t\t\tthis.mode = 'fitData';\n\t\t}\n\n\t\tthis.table.element.setAttribute(\"tabulator-layout\", this.mode);\n\t\tthis.subscribe(\"column-init\", this.initializeColumn.bind(this));\n\t}\n\n\tinitializeColumn(column){\n\t\tif(column.definition.widthGrow){\n\t\t\tcolumn.definition.widthGrow = Number(column.definition.widthGrow);\n\t\t}\n\t\tif(column.definition.widthShrink){\n\t\t\tcolumn.definition.widthShrink = Number(column.definition.widthShrink);\n\t\t}\n\t}\n\n\tgetMode(){\n\t\treturn this.mode;\n\t}\n\n\t//trigger table layout\n\tlayout(dataChanged){\n\n\t\tvar variableHeight = this.table.columnManager.columnsByIndex.find((column) => column.definition.variableHeight || column.definition.formatter === \"textarea\");\n\t\t\n\t\tthis.dispatch(\"layout-refreshing\");\n\t\tLayout.modes[this.mode].call(this, this.table.columnManager.columnsByIndex, dataChanged);\n\n\t\tif(variableHeight){\n\t\t\tthis.table.rowManager.normalizeHeight(true);\n\t\t}\n\n\t\tthis.dispatch(\"layout-refreshed\");\n\t}\n}\n\nvar defaultLangs = {\n\t\"default\":{ //hold default locale text\n\t\t\"groups\":{\n\t\t\t\"item\":\"item\",\n\t\t\t\"items\":\"items\",\n\t\t},\n\t\t\"columns\":{\n\t\t},\n\t\t\"data\":{\n\t\t\t\"loading\":\"Loading\",\n\t\t\t\"error\":\"Error\",\n\t\t},\n\t\t\"pagination\":{\n\t\t\t\"page_size\":\"Page Size\",\n\t\t\t\"page_title\":\"Show Page\",\n\t\t\t\"first\":\"First\",\n\t\t\t\"first_title\":\"First Page\",\n\t\t\t\"last\":\"Last\",\n\t\t\t\"last_title\":\"Last Page\",\n\t\t\t\"prev\":\"Prev\",\n\t\t\t\"prev_title\":\"Prev Page\",\n\t\t\t\"next\":\"Next\",\n\t\t\t\"next_title\":\"Next Page\",\n\t\t\t\"all\":\"All\",\n\t\t\t\"counter\":{\n\t\t\t\t\"showing\": \"Showing\",\n\t\t\t\t\"of\": \"of\",\n\t\t\t\t\"rows\": \"rows\",\n\t\t\t\t\"pages\": \"pages\",\n\t\t\t}\n\t\t},\n\t\t\"headerFilters\":{\n\t\t\t\"default\":\"filter column...\",\n\t\t\t\"columns\":{}\n\t\t}\n\t},\n};\n\nclass Localize extends Module{\n\n\tstatic moduleName = \"localize\";\n\n\t//load defaults\n\tstatic langs = defaultLangs;\n\n\tconstructor(table){\n\t\tsuper(table);\n\n\t\tthis.locale = \"default\"; //current locale\n\t\tthis.lang = false; //current language\n\t\tthis.bindings = {}; //update events to call when locale is changed\n\t\tthis.langList = {};\n\n\t\tthis.registerTableOption(\"locale\", false); //current system language\n\t\tthis.registerTableOption(\"langs\", {});\n\t}\n\n\tinitialize(){\n\t\tthis.langList = Helpers.deepClone(Localize.langs);\n\n\t\tif(this.table.options.columnDefaults.headerFilterPlaceholder !== false){\n\t\t\tthis.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);\n\t\t}\n\n\t\tfor(let locale in this.table.options.langs){\n\t\t\tthis.installLang(locale, this.table.options.langs[locale]);\n\t\t}\n\n\t\tthis.setLocale(this.table.options.locale);\n\n\t\tthis.registerTableFunction(\"setLocale\", this.setLocale.bind(this));\n\t\tthis.registerTableFunction(\"getLocale\", this.getLocale.bind(this));\n\t\tthis.registerTableFunction(\"getLang\", this.getLang.bind(this));\n\t}\n\n\t//set header placeholder\n\tsetHeaderFilterPlaceholder(placeholder){\n\t\tthis.langList.default.headerFilters.default = placeholder;\n\t}\n\n\t//setup a lang description object\n\tinstallLang(locale, lang){\n\t\tif(this.langList[locale]){\n\t\t\tthis._setLangProp(this.langList[locale], lang);\n\t\t}else {\n\t\t\tthis.langList[locale] = lang;\n\t\t}\n\t}\n\n\t_setLangProp(lang, values){\n\t\tfor(let key in values){\n\t\t\tif(lang[key] && typeof lang[key] == \"object\"){\n\t\t\t\tthis._setLangProp(lang[key], values[key]);\n\t\t\t}else {\n\t\t\t\tlang[key] = values[key];\n\t\t\t}\n\t\t}\n\t}\n\n\t//set current locale\n\tsetLocale(desiredLocale){\n\t\tdesiredLocale = desiredLocale || \"default\";\n\n\t\t//fill in any matching language values\n\t\tfunction traverseLang(trans, path){\n\t\t\tfor(var prop in trans){\n\t\t\t\tif(typeof trans[prop] == \"object\"){\n\t\t\t\t\tif(!path[prop]){\n\t\t\t\t\t\tpath[prop] = {};\n\t\t\t\t\t}\n\t\t\t\t\ttraverseLang(trans[prop], path[prop]);\n\t\t\t\t}else {\n\t\t\t\t\tpath[prop] = trans[prop];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//determining correct locale to load\n\t\tif(desiredLocale === true && navigator.language){\n\t\t\t//get local from system\n\t\t\tdesiredLocale = navigator.language.toLowerCase();\n\t\t}\n\n\t\tif(desiredLocale){\n\t\t\t//if locale is not set, check for matching top level locale else use default\n\t\t\tif(!this.langList[desiredLocale]){\n\t\t\t\tlet prefix = desiredLocale.split(\"-\")[0];\n\n\t\t\t\tif(this.langList[prefix]){\n\t\t\t\t\tconsole.warn(\"Localization Error - Exact matching locale not found, using closest match: \", desiredLocale, prefix);\n\t\t\t\t\tdesiredLocale = prefix;\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Localization Error - Matching locale not found, using default: \", desiredLocale);\n\t\t\t\t\tdesiredLocale = \"default\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.locale = desiredLocale;\n\n\t\t//load default lang template\n\t\tthis.lang = Helpers.deepClone(this.langList.default || {});\n\n\t\tif(desiredLocale != \"default\"){\n\t\t\ttraverseLang(this.langList[desiredLocale], this.lang);\n\t\t}\n\n\t\tthis.dispatchExternal(\"localized\", this.locale, this.lang);\n\n\t\tthis._executeBindings();\n\t}\n\n\t//get current locale\n\tgetLocale(locale){\n\t\treturn this.locale;\n\t}\n\n\t//get lang object for given local or current if none provided\n\tgetLang(locale){\n\t\treturn locale ? this.langList[locale] : this.lang;\n\t}\n\n\t//get text for current locale\n\tgetText(path, value){\n\t\tvar fillPath = value ? path + \"|\" + value : path,\n\t\tpathArray = fillPath.split(\"|\"),\n\t\ttext = this._getLangElement(pathArray, this.locale);\n\n\t\t// if(text === false){\n\t\t// \tconsole.warn(\"Localization Error - Matching localized text not found for given path: \", path);\n\t\t// }\n\n\t\treturn text || \"\";\n\t}\n\n\t//traverse langs object and find localized copy\n\t_getLangElement(path, locale){\n\t\tvar root = this.lang;\n\n\t\tpath.forEach(function(level){\n\t\t\tvar rootPath;\n\n\t\t\tif(root){\n\t\t\t\trootPath = root[level];\n\n\t\t\t\tif(typeof rootPath != \"undefined\"){\n\t\t\t\t\troot = rootPath;\n\t\t\t\t}else {\n\t\t\t\t\troot = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn root;\n\t}\n\n\t//set update binding\n\tbind(path, callback){\n\t\tif(!this.bindings[path]){\n\t\t\tthis.bindings[path] = [];\n\t\t}\n\n\t\tthis.bindings[path].push(callback);\n\n\t\tcallback(this.getText(path), this.lang);\n\t}\n\n\t//iterate through bindings and trigger updates\n\t_executeBindings(){\n\t\tfor(let path in this.bindings){\n\t\t\tthis.bindings[path].forEach((binding) => {\n\t\t\t\tbinding(this.getText(path), this.lang);\n\t\t\t});\n\t\t}\n\t}\n}\n\nclass Comms extends Module{\n\n\tstatic moduleName = \"comms\";\n\n\tconstructor(table){\n\t\tsuper(table);\n\t}\n\n\tinitialize(){\n\t\tthis.registerTableFunction(\"tableComms\", this.receive.bind(this));\n\t}\n\n\tgetConnections(selectors){\n\t\tvar connections = [],\n\t\tconnection;\n\n\t\tconnection = this.table.constructor.registry.lookupTable(selectors);\n\n\t\tconnection.forEach((con) =>{\n\t\t\tif(this.table !== con){\n\t\t\t\tconnections.push(con);\n\t\t\t}\n\t\t});\n\n\t\treturn connections;\n\t}\n\n\tsend(selectors, module, action, data){\n\t\tvar connections = this.getConnections(selectors);\n\n\t\tconnections.forEach((connection) => {\n\t\t\tconnection.tableComms(this.table.element, module, action, data);\n\t\t});\n\n\t\tif(!connections.length && selectors){\n\t\t\tconsole.warn(\"Table Connection Error - No tables matching selector found\", selectors);\n\t\t}\n\t}\n\n\treceive(table, module, action, data){\n\t\tif(this.table.modExists(module)){\n\t\t\treturn this.table.modules[module].commsReceived(table, action, data);\n\t\t}else {\n\t\t\tconsole.warn(\"Inter-table Comms Error - no such module:\", module);\n\t\t}\n\t}\n}\n\nvar coreModules = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tCommsModule: Comms,\n\tLayoutModule: Layout,\n\tLocalizeModule: Localize\n});\n\nclass TableRegistry {\n\tstatic registry = {\n\t\ttables:[],\n\t\t\n\t\tregister(table){\n\t\t\tTableRegistry.registry.tables.push(table);\n\t\t},\n\t\t\n\t\tderegister(table){\n\t\t\tvar index = TableRegistry.registry.tables.indexOf(table);\n\t\t\t\n\t\t\tif(index > -1){\n\t\t\t\tTableRegistry.registry.tables.splice(index, 1);\n\t\t\t}\n\t\t},\n\t\t\n\t\tlookupTable(query, silent){\n\t\t\tvar results = [],\n\t\t\tmatches, match;\n\t\t\t\n\t\t\tif(typeof query === \"string\"){\n\t\t\t\tmatches = document.querySelectorAll(query);\n\t\t\t\t\n\t\t\t\tif(matches.length){\n\t\t\t\t\tfor(var i = 0; i < matches.length; i++){\n\t\t\t\t\t\tmatch = TableRegistry.registry.matchElement(matches[i]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(match){\n\t\t\t\t\t\t\tresults.push(match);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else if((typeof HTMLElement !== \"undefined\" && query instanceof HTMLElement) || query instanceof TableRegistry){\n\t\t\t\tmatch = TableRegistry.registry.matchElement(query);\n\t\t\t\t\n\t\t\t\tif(match){\n\t\t\t\t\tresults.push(match);\n\t\t\t\t}\n\t\t\t}else if(Array.isArray(query)){\n\t\t\t\tquery.forEach(function(item){\n\t\t\t\t\tresults = results.concat(TableRegistry.registry.lookupTable(item));\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tif(!silent){\n\t\t\t\t\tconsole.warn(\"Table Connection Error - Invalid Selector\", query);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn results;\n\t\t},\n\t\t\n\t\tmatchElement(element){\n\t\t\treturn TableRegistry.registry.tables.find(function(table){\n\t\t\t\treturn element instanceof TableRegistry ? table === element : table.element === element;\n\t\t\t});\n\t\t}\n\t};\n\n\t\t\n\tstatic findTable(query){\n\t\tvar results = TableRegistry.registry.lookupTable(query, true);\n\t\treturn Array.isArray(results) && !results.length ? false : results;\n\t}\n}\n\nclass ModuleBinder extends TableRegistry {\n\t\n\tstatic moduleBindings = {};\n\tstatic moduleExtensions = {};\n\tstatic modulesRegistered = false;\n\t\n\tstatic defaultModules = false;\n\t\n\tconstructor(){\n\t\tsuper();\n\t}\n\t\n\tstatic initializeModuleBinder(defaultModules){\n\t\tif(!ModuleBinder.modulesRegistered){\n\t\t\tModuleBinder.modulesRegistered = true;\n\t\t\tModuleBinder._registerModules(coreModules, true);\n\t\t\t\n\t\t\tif(defaultModules){\n\t\t\t\tModuleBinder._registerModules(defaultModules);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tstatic _extendModule(name, property, values){\n\t\tif(ModuleBinder.moduleBindings[name]){\n\t\t\tvar source = ModuleBinder.moduleBindings[name][property];\n\t\t\t\n\t\t\tif(source){\n\t\t\t\tif(typeof values == \"object\"){\n\t\t\t\t\tfor(let key in values){\n\t\t\t\t\t\tsource[key] = values[key];\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tconsole.warn(\"Module Error - Invalid value type, it must be an object\");\n\t\t\t\t}\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Module Error - property does not exist:\", property);\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Module Error - module does not exist:\", name);\n\t\t}\n\t}\n\t\n\tstatic _registerModules(modules, core){\n\t\tvar mods = Object.values(modules);\n\t\t\n\t\tif(core){\n\t\t\tmods.forEach((mod) => {\n\t\t\t\tmod.prototype.moduleCore = true;\n\t\t\t});\n\t\t}\n\t\t\n\t\tModuleBinder._registerModule(mods);\n\t}\n\t\n\tstatic _registerModule(modules){\n\t\tif(!Array.isArray(modules)){\n\t\t\tmodules = [modules];\n\t\t}\n\t\t\n\t\tmodules.forEach((mod) => {\n\t\t\tModuleBinder._registerModuleBinding(mod);\n\t\t\tModuleBinder._registerModuleExtensions(mod);\n\t\t});\n\t}\n\t\n\tstatic _registerModuleBinding(mod){\n\t\tif(mod.moduleName){\n\t\t\tModuleBinder.moduleBindings[mod.moduleName] = mod;\n\t\t}else {\n\t\t\tconsole.error(\"Unable to bind module, no moduleName defined\", mod.moduleName);\n\t\t}\n\t}\n\t\n\tstatic _registerModuleExtensions(mod){\n\t\tvar extensions = mod.moduleExtensions;\n\t\t\n\t\tif(mod.moduleExtensions){\n\t\t\tfor (let modKey in extensions) {\n\t\t\t\tlet ext = extensions[modKey];\n\t\t\t\t\n\t\t\t\tif(ModuleBinder.moduleBindings[modKey]){\n\t\t\t\t\tfor (let propKey in ext) {\n\t\t\t\t\t\tModuleBinder._extendModule(modKey, propKey, ext[propKey]);\n\t\t\t\t\t}\n\t\t\t\t}else {\n\t\t\t\t\tif(!ModuleBinder.moduleExtensions[modKey]){\n\t\t\t\t\t\tModuleBinder.moduleExtensions[modKey] = {};\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tfor (let propKey in ext) {\n\t\t\t\t\t\tif(!ModuleBinder.moduleExtensions[modKey][propKey]){\n\t\t\t\t\t\t\tModuleBinder.moduleExtensions[modKey][propKey] = {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tObject.assign(ModuleBinder.moduleExtensions[modKey][propKey], ext[propKey]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tModuleBinder._extendModuleFromQueue(mod);\n\t}\n\t\n\tstatic _extendModuleFromQueue(mod){\n\t\tvar extensions = ModuleBinder.moduleExtensions[mod.moduleName];\n\t\t\n\t\tif(extensions){\n\t\t\tfor (let propKey in extensions) {\n\t\t\t\tModuleBinder._extendModule(mod.moduleName, propKey, extensions[propKey]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//ensure that module are bound to instantiated function\n\t_bindModules(){\n\t\tvar orderedStartMods = [],\n\t\torderedEndMods = [],\n\t\tunOrderedMods = [];\n\t\t\n\t\tthis.modules = {};\n\t\t\n\t\tfor(var name in ModuleBinder.moduleBindings){\n\t\t\tlet mod = ModuleBinder.moduleBindings[name];\n\t\t\tlet module = new mod(this);\n\t\t\t\n\t\t\tthis.modules[name] = module;\n\t\t\t\n\t\t\tif(mod.prototype.moduleCore){\n\t\t\t\tthis.modulesCore.push(module);\n\t\t\t}else {\n\t\t\t\tif(mod.moduleInitOrder){\n\t\t\t\t\tif(mod.moduleInitOrder < 0){\n\t\t\t\t\t\torderedStartMods.push(module);\n\t\t\t\t\t}else {\n\t\t\t\t\t\torderedEndMods.push(module);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}else {\n\t\t\t\t\tunOrderedMods.push(module);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\torderedStartMods.sort((a, b) => a.moduleInitOrder > b.moduleInitOrder ? 1 : -1);\n\t\torderedEndMods.sort((a, b) => a.moduleInitOrder > b.moduleInitOrder ? 1 : -1);\n\t\t\n\t\tthis.modulesRegular = orderedStartMods.concat(unOrderedMods.concat(orderedEndMods));\n\t}\n}\n\nclass Alert extends CoreFeature{\n\tconstructor(table){\n\t\tsuper(table);\n        \n\t\tthis.element = this._createAlertElement();\n\t\tthis.msgElement = this._createMsgElement();\n\t\tthis.type = null;\n        \n\t\tthis.element.appendChild(this.msgElement);\n\t}\n    \n\t_createAlertElement(){\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-alert\");\n\t\treturn el;\n\t}\n    \n\t_createMsgElement(){\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-alert-msg\");\n\t\tel.setAttribute(\"role\", \"alert\");\n\t\treturn el;\n\t}\n    \n\t_typeClass(){\n\t\treturn \"tabulator-alert-state-\" + this.type;\n\t}\n    \n\talert(content, type = \"msg\"){\n\t\tif(content){\n\t\t\tthis.clear();\n\n\t\t\tthis.dispatch(\"alert-show\", type);\n            \n\t\t\tthis.type = type;\n            \n\t\t\twhile(this.msgElement.firstChild) this.msgElement.removeChild(this.msgElement.firstChild);\n            \n\t\t\tthis.msgElement.classList.add(this._typeClass());\n            \n\t\t\tif(typeof content === \"function\"){\n\t\t\t\tcontent = content();\n\t\t\t}\n            \n\t\t\tif(content instanceof HTMLElement){\n\t\t\t\tthis.msgElement.appendChild(content);\n\t\t\t}else {\n\t\t\t\tthis.msgElement.innerHTML = content;\n\t\t\t}\n            \n\t\t\tthis.table.element.appendChild(this.element);\n\t\t}\n\t}\n    \n\tclear(){\n\t\tthis.dispatch(\"alert-hide\", this.type);\n\n\t\tif(this.element.parentNode){\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n        \n\t\tthis.msgElement.classList.remove(this._typeClass());\n\t}\n}\n\nclass Tabulator extends ModuleBinder{\n\n\t//default setup options\n\tstatic defaultOptions = defaultOptions;\n\n\tstatic extendModule(){\n\t\tTabulator.initializeModuleBinder();\n\t\tTabulator._extendModule(...arguments);\n\t}\n\n\tstatic registerModule(){\n\t\tTabulator.initializeModuleBinder();\n\t\tTabulator._registerModule(...arguments);\n\t}\n\n\tconstructor(element, options, modules){\n\t\tsuper();\n\n\t\tTabulator.initializeModuleBinder(modules);\n\n\t\tthis.options = {};\n\t\t\n\t\tthis.columnManager = null; // hold Column Manager\n\t\tthis.rowManager = null; //hold Row Manager\n\t\tthis.footerManager = null; //holder Footer Manager\n\t\tthis.alertManager = null; //hold Alert Manager\n\t\tthis.vdomHoz  = null; //holder horizontal virtual dom\n\t\tthis.externalEvents = null; //handle external event messaging\n\t\tthis.eventBus = null; //handle internal event messaging\n\t\tthis.interactionMonitor = false; //track user interaction\n\t\tthis.browser = \"\"; //hold current browser type\n\t\tthis.browserSlow = false; //handle reduced functionality for slower browsers\n\t\tthis.browserMobile = false; //check if running on mobile, prevent resize cancelling edit on keyboard appearance\n\t\tthis.rtl = false; //check if the table is in RTL mode\n\t\tthis.originalElement = null; //hold original table element if it has been replaced\n\t\t\n\t\tthis.componentFunctionBinder = new ComponentFunctionBinder(this); //bind component functions\n\t\tthis.dataLoader = false; //bind component functions\n\t\t\n\t\tthis.modules = {}; //hold all modules bound to this table\n\t\tthis.modulesCore = []; //hold core modules bound to this table (for initialization purposes)\n\t\tthis.modulesRegular = []; //hold regular modules bound to this table (for initialization purposes)\n\t\t\n\t\tthis.deprecationAdvisor = new DeprecationAdvisor(this);\n\t\tthis.optionsList = new OptionsList(this, \"table constructor\");\n\n\t\tthis.dependencyRegistry = new DependencyRegistry(this);\n\t\t\n\t\tthis.initialized = false;\n\t\tthis.destroyed = false;\n\t\t\n\t\tif(this.initializeElement(element)){\n\t\t\t\n\t\t\tthis.initializeCoreSystems(options);\n\t\t\t\n\t\t\t//delay table creation to allow event bindings immediately after the constructor\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._create();\n\t\t\t});\n\t\t}\n\t\t\n\t\tthis.constructor.registry.register(this); //register table for inter-device communication\n\t}\n\t\n\tinitializeElement(element){\n\t\tif(typeof HTMLElement !== \"undefined\" && element instanceof HTMLElement){\n\t\t\tthis.element = element;\n\t\t\treturn true;\n\t\t}else if(typeof element === \"string\"){\n\t\t\tthis.element = document.querySelector(element);\n\t\t\t\n\t\t\tif(this.element){\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tconsole.error(\"Tabulator Creation Error - no element found matching selector: \", element);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.error(\"Tabulator Creation Error - Invalid element provided:\", element);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tinitializeCoreSystems(options){\n\t\tthis.columnManager = new ColumnManager(this);\n\t\tthis.rowManager = new RowManager(this);\n\t\tthis.footerManager = new FooterManager(this);\n\t\tthis.dataLoader = new DataLoader(this);\n\t\tthis.alertManager = new Alert(this);\n\t\t\n\t\tthis._bindModules();\n\t\t\n\t\tthis.options = this.optionsList.generate(Tabulator.defaultOptions, options);\n\t\t\n\t\tthis._clearObjectPointers();\n\t\t\n\t\tthis._mapDeprecatedFunctionality();\n\t\t\n\t\tthis.externalEvents = new ExternalEventBus(this, this.options, this.options.debugEventsExternal);\n\t\tthis.eventBus = new InternalEventBus(this.options.debugEventsInternal);\n\t\t\n\t\tthis.interactionMonitor = new InteractionManager(this);\n\t\t\n\t\tthis.dataLoader.initialize();\n\t\tthis.footerManager.initialize();\n\n\t\tthis.dependencyRegistry.initialize();\n\t}\n\t\n\t//convert deprecated functionality to new functions\n\t_mapDeprecatedFunctionality(){\n\t\t//all previously deprecated functionality removed in the 6.0 release\n\t}\n\t\n\t_clearSelection(){\n\t\t\n\t\tthis.element.classList.add(\"tabulator-block-select\");\n\t\t\n\t\tif (window.getSelection) {\n\t\t\tif (window.getSelection().empty) {  // Chrome\n\t\t\t\twindow.getSelection().empty();\n\t\t\t} else if (window.getSelection().removeAllRanges) {  // Firefox\n\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t}\n\t\t} else if (document.selection) {  // IE?\n\t\t\tdocument.selection.empty();\n\t\t}\n\t\t\n\t\tthis.element.classList.remove(\"tabulator-block-select\");\n\t}\n\t\n\t//create table\n\t_create(){\n\t\tthis.externalEvents.dispatch(\"tableBuilding\");\n\t\tthis.eventBus.dispatch(\"table-building\");\n\t\t\n\t\tthis._rtlCheck();\n\t\t\n\t\tthis._buildElement();\n\t\t\n\t\tthis._initializeTable();\n\n\t\tthis.initialized = true;\n\t\t\n\t\tthis._loadInitialData()\n\t\t\t.finally(() => {\n\t\t\t\tthis.eventBus.dispatch(\"table-initialized\");\n\t\t\t\tthis.externalEvents.dispatch(\"tableBuilt\");\n\t\t\t});\t\n\t}\n\t\n\t_rtlCheck(){\n\t\tvar style = window.getComputedStyle(this.element);\n\t\t\n\t\tswitch(this.options.textDirection){\n\t\t\tcase\"auto\":\n\t\t\t\tif(style.direction !== \"rtl\"){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\n\t\t\tcase \"rtl\":\n\t\t\t\tthis.element.classList.add(\"tabulator-rtl\");\n\t\t\t\tthis.rtl = true;\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"ltr\":\n\t\t\t\tthis.element.classList.add(\"tabulator-ltr\");\n\t\t\t\n\t\t\tdefault:\n\t\t\t\tthis.rtl = false;\n\t\t}\n\t}\n\t\n\t//clear pointers to objects in default config object\n\t_clearObjectPointers(){\n\t\tthis.options.columns = this.options.columns.slice(0);\n\t\t\n\t\tif(Array.isArray(this.options.data) && !this.options.reactiveData){\n\t\t\tthis.options.data = this.options.data.slice(0);\n\t\t}\n\t}\n\t\n\t//build tabulator element\n\t_buildElement(){\n\t\tvar element = this.element,\n\t\toptions = this.options,\n\t\tnewElement;\n\t\t\n\t\tif(element.tagName === \"TABLE\"){\n\t\t\tthis.originalElement = this.element;\n\t\t\tnewElement = document.createElement(\"div\");\n\t\t\t\n\t\t\t//transfer attributes to new element\n\t\t\tvar attributes = element.attributes;\n\t\t\t\n\t\t\t// loop through attributes and apply them on div\n\t\t\tfor(var i in attributes){\n\t\t\t\tif(typeof attributes[i] == \"object\"){\n\t\t\t\t\tnewElement.setAttribute(attributes[i].name, attributes[i].value);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// replace table with div element\n\t\t\telement.parentNode.replaceChild(newElement, element);\n\t\t\t\n\t\t\tthis.element = element = newElement;\n\t\t}\n\t\t\n\t\telement.classList.add(\"tabulator\");\n\t\telement.setAttribute(\"role\", \"grid\");\n\t\t\n\t\t//empty element\n\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\t\t\n\t\t//set table height\n\t\tif(options.height){\n\t\t\toptions.height = isNaN(options.height) ? options.height : options.height + \"px\";\n\t\t\telement.style.height = options.height;\n\t\t}\n\t\t\n\t\t//set table min height\n\t\tif(options.minHeight !== false){\n\t\t\toptions.minHeight = isNaN(options.minHeight) ? options.minHeight : options.minHeight + \"px\";\n\t\t\telement.style.minHeight = options.minHeight;\n\t\t}\n\t\t\n\t\t//set table maxHeight\n\t\tif(options.maxHeight !== false){\n\t\t\toptions.maxHeight = isNaN(options.maxHeight) ? options.maxHeight : options.maxHeight + \"px\";\n\t\t\telement.style.maxHeight = options.maxHeight;\n\t\t}\n\t}\n\t\n\t//initialize core systems and modules\n\t_initializeTable(){\n\t\tvar element = this.element,\n\t\toptions = this.options;\n\t\t\n\t\tthis.interactionMonitor.initialize();\n\t\t\n\t\tthis.columnManager.initialize();\n\t\tthis.rowManager.initialize();\n\t\t\n\t\tthis._detectBrowser();\n\t\t\n\t\t//initialize core modules\n\t\tthis.modulesCore.forEach((mod) => {\n\t\t\tmod.initialize();\n\t\t});\n\t\t\n\t\t//build table elements\n\t\telement.appendChild(this.columnManager.getElement());\n\t\telement.appendChild(this.rowManager.getElement());\n\t\t\n\t\tif(options.footerElement){\n\t\t\tthis.footerManager.activate();\n\t\t}\n\t\t\n\t\tif(options.autoColumns && options.data){\n\t\t\t\n\t\t\tthis.columnManager.generateColumnsFromRowData(this.options.data);\n\t\t}\n\t\t\n\t\t//initialize regular modules\n\t\tthis.modulesRegular.forEach((mod) => {\n\t\t\tmod.initialize();\n\t\t});\n\t\t\n\t\tthis.columnManager.setColumns(options.columns);\n\t\t\n\t\tthis.eventBus.dispatch(\"table-built\");\n\t}\n\t\n\t_loadInitialData(){\n\t\treturn this.dataLoader.load(this.options.data)\n\t\t\t.finally(() => {\n\t\t\t\tthis.columnManager.verticalAlignHeaders();\n\t\t\t});\t\t\n\t}\n\t\n\t//deconstructor\n\tdestroy(){\n\t\tvar element = this.element;\n\t\t\n\t\tthis.destroyed = true;\n\t\t\n\t\tthis.constructor.registry.deregister(this); //deregister table from inter-device communication\n\t\t\n\t\tthis.eventBus.dispatch(\"table-destroy\");\n\t\t\n\t\t//clear row data\n\t\tthis.rowManager.destroy();\n\t\t\n\t\t//clear DOM\n\t\twhile(element.firstChild) element.removeChild(element.firstChild);\n\t\telement.classList.remove(\"tabulator\");\n\n\t\tthis.externalEvents.dispatch(\"tableDestroyed\");\n\t}\n\t\n\t_detectBrowser(){\n\t\tvar ua = navigator.userAgent||navigator.vendor||window.opera;\n\t\t\n\t\tif(ua.indexOf(\"Trident\") > -1){\n\t\t\tthis.browser = \"ie\";\n\t\t\tthis.browserSlow = true;\n\t\t}else if(ua.indexOf(\"Edge\") > -1){\n\t\t\tthis.browser = \"edge\";\n\t\t\tthis.browserSlow = true;\n\t\t}else if(ua.indexOf(\"Firefox\") > -1){\n\t\t\tthis.browser = \"firefox\";\n\t\t\tthis.browserSlow = false;\n\t\t}else if(ua.indexOf(\"Mac OS\") > -1){\n\t\t\tthis.browser = \"safari\";\n\t\t\tthis.browserSlow = false;\n\t\t}else {\n\t\t\tthis.browser = \"other\";\n\t\t\tthis.browserSlow = false;\n\t\t}\n\t\t\n\t\tthis.browserMobile = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(ua)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(ua.slice(0,4));\n\t}\n\t\n\tinitGuard(func, msg){\n\t\tvar stack, line;\n\t\t\n\t\tif(this.options.debugInitialization && !this.initialized){\n\t\t\tif(!func){\n\t\t\t\tstack = new Error().stack.split(\"\\n\");\n\t\t\t\t\n\t\t\t\tline = stack[0] == \"Error\" ? stack[2] : stack[1];\n\t\t\t\t\n\t\t\t\tif(line[0] == \" \"){\n\t\t\t\t\tfunc = line.trim().split(\" \")[1].split(\".\")[1];\n\t\t\t\t}else {\n\t\t\t\t\tfunc = line.trim().split(\"@\")[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconsole.warn(\"Table Not Initialized - Calling the \" + func + \" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function.\" + (msg ? \" \" + msg : \"\"));\n\t\t}\n\t\t\n\t\treturn this.initialized;\n\t}\n\t\n\t////////////////// Data Handling //////////////////\n\t//block table redrawing\n\tblockRedraw(){\n\t\tthis.initGuard();\n\n\t\tthis.eventBus.dispatch(\"redraw-blocking\");\n\t\t\n\t\tthis.rowManager.blockRedraw();\n\t\tthis.columnManager.blockRedraw();\n\n\t\tthis.eventBus.dispatch(\"redraw-blocked\");\n\t}\n\t\n\t//restore table redrawing\n\trestoreRedraw(){\n\t\tthis.initGuard();\n\n\t\tthis.eventBus.dispatch(\"redraw-restoring\");\n\n\t\tthis.rowManager.restoreRedraw();\n\t\tthis.columnManager.restoreRedraw();\n\n\t\tthis.eventBus.dispatch(\"redraw-restored\");\n\t}\n\t\n\t//load data\n\tsetData(data, params, config){\n\t\tthis.initGuard(false, \"To set initial data please use the 'data' property in the table constructor.\");\n\t\t\n\t\treturn this.dataLoader.load(data, params, config, false);\n\t}\n\t\n\t//clear data\n\tclearData(){\n\t\tthis.initGuard();\n\t\t\n\t\tthis.dataLoader.blockActiveLoad();\n\t\tthis.rowManager.clearData();\n\t}\n\t\n\t//get table data array\n\tgetData(active){\n\t\treturn this.rowManager.getData(active);\n\t}\n\t\n\t//get table data array count\n\tgetDataCount(active){\n\t\treturn this.rowManager.getDataCount(active);\n\t}\n\t\n\t//replace data, keeping table in position with same sort\n\treplaceData(data, params, config){\n\t\tthis.initGuard();\n\t\t\n\t\treturn this.dataLoader.load(data, params, config, true, true);\n\t}\n\t\n\t//update table data\n\tupdateData(data){\n\t\tvar responses = 0;\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.dataLoader.blockActiveLoad();\n\t\t\t\n\t\t\tif(typeof data === \"string\"){\n\t\t\t\tdata = JSON.parse(data);\n\t\t\t}\n\t\t\t\n\t\t\tif(data && data.length > 0){\n\t\t\t\tdata.forEach((item) => {\n\t\t\t\t\tvar row = this.rowManager.findRow(item[this.options.index]);\n\t\t\t\t\t\n\t\t\t\t\tif(row){\n\t\t\t\t\t\tresponses++;\n\t\t\t\t\t\t\n\t\t\t\t\t\trow.updateData(item)\n\t\t\t\t\t\t\t.then(()=>{\n\t\t\t\t\t\t\t\tresponses--;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(!responses){\n\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((e) => {\n\t\t\t\t\t\t\t\treject(\"Update Error - Unable to update row\", item, e);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\treject(\"Update Error - Unable to find row\", item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\t\treject(\"Update Error - No data provided\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\taddData(data, pos, index){\n\t\tthis.initGuard();\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.dataLoader.blockActiveLoad();\n\t\t\t\n\t\t\tif(typeof data === \"string\"){\n\t\t\t\tdata = JSON.parse(data);\n\t\t\t}\n\t\t\t\n\t\t\tif(data){\n\t\t\t\tthis.rowManager.addRows(data, pos, index)\n\t\t\t\t\t.then((rows) => {\n\t\t\t\t\t\tvar output = [];\n\t\t\t\t\t\n\t\t\t\t\t\trows.forEach(function(row){\n\t\t\t\t\t\t\toutput.push(row.getComponent());\n\t\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t\tresolve(output);\n\t\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\t\treject(\"Update Error - No data provided\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//update table data\n\tupdateOrAddData(data){\n\t\tvar rows = [],\n\t\tresponses = 0;\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.dataLoader.blockActiveLoad();\n\t\t\t\n\t\t\tif(typeof data === \"string\"){\n\t\t\t\tdata = JSON.parse(data);\n\t\t\t}\n\t\t\t\n\t\t\tif(data && data.length > 0){\n\t\t\t\tdata.forEach((item) => {\n\t\t\t\t\tvar row = this.rowManager.findRow(item[this.options.index]);\n\t\t\t\t\t\n\t\t\t\t\tresponses++;\n\t\t\t\t\t\n\t\t\t\t\tif(row){\n\t\t\t\t\t\trow.updateData(item)\n\t\t\t\t\t\t\t.then(()=>{\n\t\t\t\t\t\t\t\tresponses--;\n\t\t\t\t\t\t\t\trows.push(row.getComponent());\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(!responses){\n\t\t\t\t\t\t\t\t\tresolve(rows);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else {\n\t\t\t\t\t\tthis.rowManager.addRows(item)\n\t\t\t\t\t\t\t.then((newRows)=>{\n\t\t\t\t\t\t\t\tresponses--;\n\t\t\t\t\t\t\t\trows.push(newRows[0].getComponent());\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(!responses){\n\t\t\t\t\t\t\t\t\tresolve(rows);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\t\treject(\"Update Error - No data provided\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//get row object\n\tgetRow(index){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tif(row){\n\t\t\treturn row.getComponent();\n\t\t}else {\n\t\t\tconsole.warn(\"Find Error - No matching row found:\", index);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\t//get row object\n\tgetRowFromPosition(position){\n\t\tvar row = this.rowManager.getRowFromPosition(position);\n\t\t\n\t\tif(row){\n\t\t\treturn row.getComponent();\n\t\t}else {\n\t\t\tconsole.warn(\"Find Error - No matching row found:\", position);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\t//delete row from table\n\tdeleteRow(index){\n\t\tvar foundRows = [];\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(!Array.isArray(index)){\n\t\t\tindex = [index];\n\t\t}\n\t\t\n\t\t//find matching rows\n\t\tfor(let item of index){\n\t\t\tlet row = this.rowManager.findRow(item, true);\n\t\t\t\n\t\t\tif(row){\n\t\t\t\tfoundRows.push(row);\n\t\t\t}else {\n\t\t\t\tconsole.error(\"Delete Error - No matching row found:\", item);\n\t\t\t\treturn Promise.reject(\"Delete Error - No matching row found\");\n\t\t\t}\n\t\t}\n\t\t\n\t\t//sort rows into correct order to ensure smooth delete from table\n\t\tfoundRows.sort((a, b) => {\n\t\t\treturn this.rowManager.rows.indexOf(a) > this.rowManager.rows.indexOf(b) ? 1 : -1;\n\t\t});\n\t\t\n\t\t//delete rows\n\t\tfoundRows.forEach((row) =>{\n\t\t\trow.delete();\n\t\t});\n\t\t\n\t\tthis.rowManager.reRenderInPosition();\n\t\t\n\t\treturn Promise.resolve();\n\t}\n\t\n\t//add row to table\n\taddRow(data, pos, index){\n\t\tthis.initGuard();\n\t\t\n\t\tif(typeof data === \"string\"){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\t\n\t\treturn this.rowManager.addRows(data, pos, index, true)\n\t\t\t.then((rows)=>{\n\t\t\t\treturn rows[0].getComponent();\n\t\t\t});\n\t}\n\t\n\t//update a row if it exists otherwise create it\n\tupdateOrAddRow(index, data){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(typeof data === \"string\"){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\t\n\t\tif(row){\n\t\t\treturn row.updateData(data)\n\t\t\t\t.then(()=>{\n\t\t\t\t\treturn row.getComponent();\n\t\t\t\t});\n\t\t}else {\n\t\t\treturn this.rowManager.addRows(data)\n\t\t\t\t.then((rows)=>{\n\t\t\t\t\treturn rows[0].getComponent();\n\t\t\t\t});\n\t\t}\n\t}\n\t\n\t//update row data\n\tupdateRow(index, data){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(typeof data === \"string\"){\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\t\n\t\tif(row){\n\t\t\treturn row.updateData(data)\n\t\t\t\t.then(()=>{\n\t\t\t\t\treturn Promise.resolve(row.getComponent());\n\t\t\t\t});\n\t\t}else {\n\t\t\tconsole.warn(\"Update Error - No matching row found:\", index);\n\t\t\treturn Promise.reject(\"Update Error - No matching row found\");\n\t\t}\n\t}\n\t\n\t//scroll to row in DOM\n\tscrollToRow(index, position, ifVisible){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tif(row){\n\t\t\treturn this.rowManager.scrollToRow(row, position, ifVisible);\n\t\t}else {\n\t\t\tconsole.warn(\"Scroll Error - No matching row found:\", index);\n\t\t\treturn Promise.reject(\"Scroll Error - No matching row found\");\n\t\t}\n\t}\n\t\n\tmoveRow(from, to, after){\n\t\tvar fromRow = this.rowManager.findRow(from);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(fromRow){\n\t\t\tfromRow.moveToRow(to, after);\n\t\t}else {\n\t\t\tconsole.warn(\"Move Error - No matching row found:\", from);\n\t\t}\n\t}\n\t\n\tgetRows(active){\n\t\treturn this.rowManager.getComponents(active);\t\n\t}\n\t\n\t//get position of row in table\n\tgetRowPosition(index){\n\t\tvar row = this.rowManager.findRow(index);\n\t\t\n\t\tif(row){\n\t\t\treturn row.getPosition();\n\t\t}else {\n\t\t\tconsole.warn(\"Position Error - No matching row found:\", index);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\t/////////////// Column Functions  ///////////////\n\tsetColumns(definition){\n\t\tthis.initGuard(false, \"To set initial columns please use the 'columns' property in the table constructor\");\n\t\t\n\t\tthis.columnManager.setColumns(definition);\n\t}\n\t\n\tgetColumns(structured){\n\t\treturn this.columnManager.getComponents(structured);\n\t}\n\t\n\tgetColumn(field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tif(column){\n\t\t\treturn column.getComponent();\n\t\t}else {\n\t\t\tconsole.warn(\"Find Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tgetColumnDefinitions(){\n\t\treturn this.columnManager.getDefinitionTree();\n\t}\n\t\n\tshowColumn(field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\tcolumn.show();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Show Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\thideColumn(field){\n\t\tvar column = this.columnManager.findColumn(field); \n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\tcolumn.hide();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Hide Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\ttoggleColumn(field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\tif(column.visible){\n\t\t\t\tcolumn.hide();\n\t\t\t}else {\n\t\t\t\tcolumn.show();\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Column Visibility Toggle Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\taddColumn(definition, before, field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\treturn this.columnManager.addColumn(definition, before, column)\n\t\t\t.then((column) => {\n\t\t\t\treturn column.getComponent();\n\t\t\t});\n\t}\n\t\n\tdeleteColumn(field){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\treturn column.delete();\n\t\t}else {\n\t\t\tconsole.warn(\"Column Delete Error - No matching column found:\", field);\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\tupdateColumnDefinition(field, definition){\n\t\tvar column = this.columnManager.findColumn(field);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(column){\n\t\t\treturn column.updateDefinition(definition);\n\t\t}else {\n\t\t\tconsole.warn(\"Column Update Error - No matching column found:\", field);\n\t\t\treturn Promise.reject();\n\t\t}\n\t}\n\t\n\tmoveColumn(from, to, after){\n\t\tvar fromColumn = this.columnManager.findColumn(from),\n\t\ttoColumn = this.columnManager.findColumn(to);\n\t\t\n\t\tthis.initGuard();\n\t\t\n\t\tif(fromColumn){\n\t\t\tif(toColumn){\n\t\t\t\tthis.columnManager.moveColumn(fromColumn, toColumn, after);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Move Error - No matching column found:\", toColumn);\n\t\t\t}\n\t\t}else {\n\t\t\tconsole.warn(\"Move Error - No matching column found:\", from);\n\t\t}\n\t}\n\t\n\t//scroll to column in DOM\n\tscrollToColumn(field, position, ifVisible){\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar column = this.columnManager.findColumn(field);\n\t\t\t\n\t\t\tif(column){\n\t\t\t\treturn this.columnManager.scrollToColumn(column, position, ifVisible);\n\t\t\t}else {\n\t\t\t\tconsole.warn(\"Scroll Error - No matching column found:\", field);\n\t\t\t\treturn Promise.reject(\"Scroll Error - No matching column found\");\n\t\t\t}\n\t\t});\n\t}\n\t\n\t//////////// General Public Functions ////////////\n\t//redraw list without updating data\n\tredraw(force){\n\t\tthis.initGuard();\n\n\t\tthis.columnManager.redraw(force);\n\t\tthis.rowManager.redraw(force);\n\t}\n\t\n\tsetHeight(height){\n\t\tthis.options.height = isNaN(height) ? height : height + \"px\";\n\t\tthis.element.style.height = this.options.height;\n\t\tthis.rowManager.initializeRenderer();\n\t\tthis.rowManager.redraw(true);\n\t}\n\t\n\t//////////////////// Event Bus ///////////////////\n\t\n\ton(key, callback){\n\t\tthis.externalEvents.subscribe(key, callback);\n\t}\n\t\n\toff(key, callback){\n\t\tthis.externalEvents.unsubscribe(key, callback);\n\t}\n\t\n\tdispatchEvent(){\n\t\tvar args = Array.from(arguments);\n\t\targs.shift();\n\t\t\n\t\tthis.externalEvents.dispatch(...arguments);\n\t}\n\n\t//////////////////// Alerts ///////////////////\n\n\talert(contents, type){\n\t\tthis.initGuard();\n\n\t\tthis.alertManager.alert(contents, type);\n\t}\n\n\tclearAlert(){\n\t\tthis.initGuard();\n\n\t\tthis.alertManager.clear();\n\t}\n\t\n\t////////////// Extension Management //////////////\n\tmodExists(plugin, required){\n\t\tif(this.modules[plugin]){\n\t\t\treturn true;\n\t\t}else {\n\t\t\tif(required){\n\t\t\t\tconsole.error(\"Tabulator Module Not Installed: \" + plugin);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tmodule(key){\n\t\tvar mod = this.modules[key];\n\t\t\n\t\tif(!mod){\n\t\t\tconsole.error(\"Tabulator module not installed: \" + key);\n\t\t}\n\t\t\n\t\treturn mod;\n\t}\n}\n\nvar Tabulator$1 = Tabulator;\n\n//tabulator with all modules installed\n\nclass TabulatorFull extends Tabulator$1 {\n\tstatic extendModule(){\n\t\tTabulator$1.initializeModuleBinder(allModules);\n\t\tTabulator$1._extendModule(...arguments);\n\t}\n\n\tstatic registerModule(){\n\t\tTabulator$1.initializeModuleBinder(allModules);\n\t\tTabulator$1._registerModule(...arguments);\n\t}\n\n\tconstructor(element, options, modules){\n\t\tsuper(element, options, allModules);\n\t}\n}\n\nvar TabulatorFull$1 = TabulatorFull;\n\nclass PseudoRow {\n\n\tconstructor (type){\n\t\tthis.type = type;\n\t\tthis.element = this._createElement();\n\t}\n\n\t_createElement(){\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-row\");\n\t\treturn el;\n\t}\n\n\tgetElement(){\n\t\treturn this.element;\n\t}\n\n\tgetComponent(){\n\t\treturn false;\n\t}\n\n\tgetData(){\n\t\treturn {};\n\t}\n\n\tgetHeight(){\n\t\treturn this.element.outerHeight;\n\t}\n\n\tinitialize(){}\n\n\treinitialize(){}\n\n\tnormalizeHeight(){}\n\n\tgenerateCells(){}\n\n\treinitializeHeight(){}\n\n\tcalcHeight(){}\n\n\tsetCellHeight(){}\n\n\tclearCellHeight(){}\n\n\trendered(){}\n}\n\nexport { Accessor as AccessorModule, Ajax as AjaxModule, CalcComponent, CellComponent, Clipboard as ClipboardModule, ColumnCalcs as ColumnCalcsModule, ColumnComponent, DataTree as DataTreeModule, Download as DownloadModule, Edit as EditModule, Export as ExportModule, Filter as FilterModule, Format as FormatModule, FrozenColumns as FrozenColumnsModule, FrozenRows as FrozenRowsModule, GroupComponent, GroupRows as GroupRowsModule, History as HistoryModule, HtmlTableImport as HtmlTableImportModule, Import as ImportModule, Interaction as InteractionModule, Keybindings as KeybindingsModule, Menu as MenuModule, Module, MoveColumns as MoveColumnsModule, MoveRows as MoveRowsModule, Mutator as MutatorModule, Page as PageModule, Persistence as PersistenceModule, Popup as PopupModule, Print as PrintModule, PseudoRow, RangeComponent, ReactiveData as ReactiveDataModule, Renderer, ResizeColumns as ResizeColumnsModule, ResizeRows as ResizeRowsModule, ResizeTable as ResizeTableModule, ResponsiveLayout as ResponsiveLayoutModule, RowComponent, SelectRange as SelectRangeModule, SelectRow as SelectRowModule, SheetComponent, Sort as SortModule, Spreadsheet as SpreadsheetModule, Tabulator$1 as Tabulator, TabulatorFull$1 as TabulatorFull, Tooltip as TooltipModule, Validate as ValidateModule };\n//# sourceMappingURL=tabulator_esm.mjs.map\n","// Tabulator 6.3.1 버전에 맞춘 테이블 생성 함수\nimport { TabulatorFull as Tabulator } from 'tabulator-tables';\n\n/**\n * Tabulator 테이블을 생성하는 함수\n * @param {HTMLElement} element - 테이블이 렌더링될 DOM 요소\n * @param {Array} cols - 테이블에 표시할 컬럼 배열\n * @param {Array} data - 테이블에 표시할 데이터 배열\n * @param {Object} [customOptions] - 사용자 정의 옵션 (기본 옵션과 병합됨)\n * @returns {Tabulator} - 생성된 Tabulator 인스턴스\n */\nexport function createTable(element, cols, data, customOptions = {}) {\n  // cellStyle을 처리하는 함수\n  const applyCellStyle = (cell, style) => {\n    if (style && typeof style === 'object') {\n      const cellElement = cell.getElement();\n      Object.keys(style).forEach((styleKey) => {\n        cellElement.style[styleKey] = style[styleKey];\n      });\n    }\n    return cell.getValue() !== undefined && cell.getValue() !== null ? cell.getValue() : '';\n  };\n\n  // 컬럼 정의를 처리하여 cellStyle을 적용하고 제거\n  const processedCols = cols.map((col) => {\n    if (col.cellStyle && typeof col.cellStyle === 'object') {\n      const originalFormatter = col.formatter;\n      const { cellStyle, ...rest } = col; // Destructure only if cellStyle exists\n      return {\n        ...rest,\n        formatter: (cell) => {\n          applyCellStyle(cell, cellStyle);\n          return originalFormatter ? originalFormatter(cell) : cell.getValue();\n        },\n      };\n    }\n    return { ...col }; // Return a new object to avoid mutating the original\n  });\n\n  // 기본 옵션 정의 (Tabulator 6.3.1 기준)\n  const defaultOptions = {\n    // --- 기본 설정 ---\n    height: '50vh',                  // 테이블 높이. 픽셀(px), 퍼센트(%), 뷰포트 단위(vh) 가능. undefined면 컨테이너에 맞춤\n    layout: 'fitColumns',            // 레이아웃 모드. 'fitColumns'는 열 너비를 테이블 너비에 맞게 조정. 지원: 'fitData', 'fitDataFill', 'fitDataStretch'\n    layoutColumnsOnNewData: false,   // 새 데이터 로드 시 열 레이아웃 재계산 여부. false면 기존 레이아웃 유지\n    responsiveLayout: false,         // 반응형 레이아웃 활성화. 작은 화면에서 열 축소. 지원: 'hide', 'collapse'\n    responsiveLayoutCollapseStartOpen: true, // 반응형 축소 시 열림 상태. true면 처음부터 열림\n    autoResize: true,                // 창 크기 조정 시 자동 리사이즈. true면 브라우저 크기 변화에 반응\n    renderVertical: 'virtual',       // 수직 렌더링 모드. 'virtual'은 가상 DOM 사용, 'basic'은 전체 렌더링\n    renderHorizontal: 'virtual',     // 수평 렌더링 모드. 'virtual'은 가상 DOM 사용, 'basic'은 전체 렌더링\n\n    // --- 데이터 관련 ---\n    data: data || [],                // 테이블 데이터. 초기 데이터가 없으면 빈 배열\n    reactiveData: false,             // 데이터 반응형 처리. true면 데이터 변경 시 자동 갱신 (주의: 성능 영향)\n    dataTree: false,                 // 트리 구조 데이터 활성화. true면 계층적 데이터 표시\n    dataTreeStartExpanded: false,    // 트리 처음부터 확장 여부. false면 축소 상태로 시작\n    columns: processedCols,          // 열 정의. 필수 옵션으로 열 배열 전달\n    autoColumns: false,              // 데이터 기반 자동 열 생성. true면 열 정의 없이 데이터에서 추출\n    movableColumns: true,            // 열 이동 가능 여부. true면 드래그로 열 순서 변경 가능\n    resizableColumns: true,          // 열 크기 조정 가능 여부. true면 열 너비 조정 가능\n    headerVisible: true,             // 헤더 표시 여부. false면 헤더 숨김\n    headerSort: true,                // 헤더 정렬 가능 여부. true면 클릭으로 정렬\n    headerFilterLiveFilterDelay: 300, // 헤더 필터 입력 지연 시간 (ms). 입력 후 지연 시간 적용\n\n    // --- 행 관련 ---\n    movableRows: true,               // 행 이동 가능 여부. true면 드래그로 행 순서 변경 가능\n    resizableRows: false,            // 행 크기 조정 가능 여부. false면 행 높이 고정\n    selectable: true,                // 행 선택 가능 여부. true면 단일/다중 선택 가능 (숫자나 'highlight'도 가능)\n    selectableRollingSelection: true, // 연속 선택 유지. true면 Shift 키로 범위 선택 가능\n    selectablePersistence: true,     // 선택 상태 유지. true면 데이터 변경 후 선택 유지\n\n    // --- 페이지네이션 ---\n    pagination: 'local',             // 페이지네이션 모드. 'local'은 클라이언트 측, 'remote'은 서버 측. false면 비활성화\n    paginationSize: 50,              // 페이지당 행 수. 페이지 크기 설정\n    paginationButtonCount: 10,       // 표시할 페이지 버튼 수. 페이지 네비게이션 버튼 개수\n    paginationSizeSelector: [50, 100, 200, 300], // 페이지 크기 선택 옵션. 드롭다운으로 선택 가능\n    paginationInitialPage: 1,        // 초기 페이지 번호. 1부터 시작\n\n    // --- 플레이스홀더 ---\n    placeholder: '데이터가 없습니다.',      // 데이터 없을 때 표시 메시지. 문자열 또는 함수 가능\n\n    // --- 이벤트 핸들러 ---\n    columnMoved: (column, columns) => {\n      console.log('Column moved:', column.getField(), columns.map(col => col.getField()));\n    },                               // 열 이동 시 호출. 이동된 열과 전체 열 배열 로깅\n  };\n\n  // 사용자 정의 옵션과 기본 옵션 병합\n  const options = { ...defaultOptions, ...customOptions, data };\n\n  try {\n    const table = new Tabulator(element, options);\n    return table;\n  } catch (error) {\n    console.error('Tabulator 생성 실패:', error);\n    throw error; // 호출자에게 에러 전파\n  }\n}","/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported XLSX */\n/*global process:false, Buffer:false, ArrayBuffer:false, DataView:false, Deno:false */\nvar XLSX = {};\nXLSX.version = '0.20.3';\nvar current_codepage = 1200, current_ansi = 1252;\n/*:: declare var cptable:any; */\n/*global cptable:true, window */\nvar $cptable;\n\nvar VALID_ANSI = [ 874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 10000 ];\n/* ECMA-376 Part I 18.4.1 charset to codepage mapping */\nvar CS2CP = ({\n\t0:    1252, /* ANSI */\n\t1:   65001, /* DEFAULT */\n\t2:   65001, /* SYMBOL */\n\t77:  10000, /* MAC */\n\t128:   932, /* SHIFTJIS */\n\t129:   949, /* HANGUL */\n\t130:  1361, /* JOHAB */\n\t134:   936, /* GB2312 */\n\t136:   950, /* CHINESEBIG5 */\n\t161:  1253, /* GREEK */\n\t162:  1254, /* TURKISH */\n\t163:  1258, /* VIETNAMESE */\n\t177:  1255, /* HEBREW */\n\t178:  1256, /* ARABIC */\n\t186:  1257, /* BALTIC */\n\t204:  1251, /* RUSSIAN */\n\t222:   874, /* THAI */\n\t238:  1250, /* EASTEUROPE */\n\t255:  1252, /* OEM */\n\t69:   6969  /* MISC */\n}/*:any*/);\n\nvar set_ansi = function(cp/*:number*/) { if(VALID_ANSI.indexOf(cp) == -1) return; current_ansi = CS2CP[0] = cp; };\nfunction reset_ansi() { set_ansi(1252); }\n\nvar set_cp = function(cp/*:number*/) { current_codepage = cp; set_ansi(cp); };\nfunction reset_cp() { set_cp(1200); reset_ansi(); }\n\nfunction char_codes(data/*:string*/)/*:Array<number>*/ { var o/*:Array<number>*/ = []; for(var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\n\nfunction utf16leread(data/*:string*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i) + (data.charCodeAt(2*i+1)<<8));\n\treturn o.join(\"\");\n}\nfunction utf16lereadu(data/*:Uint8Array*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data[2*i] + (data[2*i+1]<<8));\n\treturn o.join(\"\");\n}\nfunction utf16beread(data/*:string*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i+1) + (data.charCodeAt(2*i)<<8));\n\treturn o.join(\"\");\n}\n\nvar debom = function(data/*:string*/)/*:string*/ {\n\tvar c1 = data.charCodeAt(0), c2 = data.charCodeAt(1);\n\tif(c1 == 0xFF && c2 == 0xFE) return utf16leread(data.slice(2));\n\tif(c1 == 0xFE && c2 == 0xFF) return utf16beread(data.slice(2));\n\tif(c1 == 0xFEFF) return data.slice(1);\n\treturn data;\n};\n\nvar _getchar = function _gc1(x/*:number*/)/*:string*/ { return String.fromCharCode(x); };\nvar _getansi = function _ga1(x/*:number*/)/*:string*/ { return String.fromCharCode(x); };\n\nfunction set_cptable(cptable) {\n\t$cptable = cptable;\n\tset_cp = function(cp/*:number*/) { current_codepage = cp; set_ansi(cp); };\n\tdebom = function(data/*:string*/) {\n\t\tif(data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return $cptable.utils.decode(1200, char_codes(data.slice(2))); }\n\t\treturn data;\n\t};\n\t_getchar = function _gc2(x/*:number*/)/*:string*/ {\n\t\tif(current_codepage === 1200) return String.fromCharCode(x);\n\t\treturn $cptable.utils.decode(current_codepage, [x&255,x>>8])[0];\n\t};\n\t_getansi = function _ga2(x/*:number*/)/*:string*/ {\n\t\treturn $cptable.utils.decode(current_ansi, [x])[0];\n\t};\n\tcpdoit();\n}\nvar DENSE = null;\nvar DIF_XL = true;\nvar Base64_map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\nfunction Base64_encode(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  for (var i = 0; i < input.length; ) {\n    c1 = input.charCodeAt(i++);\n    e1 = c1 >> 2;\n    c2 = input.charCodeAt(i++);\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input.charCodeAt(i++);\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n  return o;\n}\nfunction Base64_encode_pass(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  for (var i = 0; i < input.length; ) {\n    c1 = input.charCodeAt(i++);\n    if (c1 > 255)\n      c1 = 95;\n    e1 = c1 >> 2;\n    c2 = input.charCodeAt(i++);\n    if (c2 > 255)\n      c2 = 95;\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input.charCodeAt(i++);\n    if (c3 > 255)\n      c3 = 95;\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n  return o;\n}\nfunction Base64_encode_arr(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  for (var i = 0; i < input.length; ) {\n    c1 = input[i++];\n    e1 = c1 >> 2;\n    c2 = input[i++];\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input[i++];\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n  return o;\n}\nfunction Base64_decode(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  if (input.slice(0, 5) == \"data:\") {\n    var i = input.slice(0, 1024).indexOf(\";base64,\");\n    if (i > -1)\n      input = input.slice(i + 8);\n  }\n  input = input.replace(/[^\\w\\+\\/\\=]/g, \"\");\n  for (var i = 0; i < input.length; ) {\n    e1 = Base64_map.indexOf(input.charAt(i++));\n    e2 = Base64_map.indexOf(input.charAt(i++));\n    c1 = e1 << 2 | e2 >> 4;\n    o += String.fromCharCode(c1);\n    e3 = Base64_map.indexOf(input.charAt(i++));\n    c2 = (e2 & 15) << 4 | e3 >> 2;\n    if (e3 !== 64) {\n      o += String.fromCharCode(c2);\n    }\n    e4 = Base64_map.indexOf(input.charAt(i++));\n    c3 = (e3 & 3) << 6 | e4;\n    if (e4 !== 64) {\n      o += String.fromCharCode(c3);\n    }\n  }\n  return o;\n}\nvar has_buf = /*#__PURE__*/(function() { return typeof Buffer !== 'undefined' && typeof process !== 'undefined' && typeof process.versions !== 'undefined' && !!process.versions.node; })();\n\nvar Buffer_from = /*#__PURE__*/(function() {\n\tif(typeof Buffer !== 'undefined') {\n\t\tvar nbfs = !Buffer.from;\n\t\tif(!nbfs) try { Buffer.from(\"foo\", \"utf8\"); } catch(e) { nbfs = true; }\n\t\treturn nbfs ? function(buf, enc) { return (enc) ? new Buffer(buf, enc) : new Buffer(buf); } : Buffer.from.bind(Buffer);\n\t}\n\treturn function() {};\n})();\nvar buf_utf16le = /*#__PURE__*/(function() {\n\tif(typeof Buffer === 'undefined') return false;\n\tvar x = Buffer_from([65,0]);\n\tif(!x) return false;\n\tvar o = x.toString(\"utf16le\");\n\treturn o.length == 1;\n})();\n\n\nfunction new_raw_buf(len/*:number*/) {\n\t/* jshint -W056 */\n\tif(has_buf) return Buffer.alloc ? Buffer.alloc(len) : new Buffer(len);\n\treturn typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n\t/* jshint +W056 */\n}\n\nfunction new_unsafe_buf(len/*:number*/) {\n\t/* jshint -W056 */\n\tif(has_buf) return Buffer.allocUnsafe ? Buffer.allocUnsafe(len) : new Buffer(len);\n\treturn typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n\t/* jshint +W056 */\n}\n\nvar s2a = function s2a(s/*:string*/)/*:any*/ {\n\tif(has_buf) return Buffer_from(s, \"binary\");\n\treturn s.split(\"\").map(function(x/*:string*/)/*:number*/{ return x.charCodeAt(0) & 0xff; });\n};\n\nfunction s2ab(s/*:string*/)/*:any*/ {\n\tif(typeof ArrayBuffer === 'undefined') return s2a(s);\n\tvar buf = new ArrayBuffer(s.length), view = new Uint8Array(buf);\n\tfor (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\treturn buf;\n}\n\nfunction a2s(data/*:any*/)/*:string*/ {\n\tif(Array.isArray(data)) return data.map(function(c) { return String.fromCharCode(c); }).join(\"\");\n\tvar o/*:Array<string>*/ = []; for(var i = 0; i < data.length; ++i) o[i] = String.fromCharCode(data[i]); return o.join(\"\");\n}\n\nfunction a2u(data/*:Array<number>*/)/*:Uint8Array*/ {\n\tif(typeof Uint8Array === 'undefined') throw new Error(\"Unsupported\");\n\treturn new Uint8Array(data);\n}\n\nfunction ab2a(data/*:ArrayBuffer|Uint8Array*/)/*:Array<number>*/ {\n\tif(typeof ArrayBuffer == 'undefined') throw new Error(\"Unsupported\");\n\tif(data instanceof ArrayBuffer) return ab2a(new Uint8Array(data));\n\t/*:: if(data instanceof ArrayBuffer) throw new Error(\"unreachable\"); */\n\tvar o = new Array(data.length);\n\tfor(var i = 0; i < data.length; ++i) o[i] = data[i];\n\treturn o;\n}\n\nvar bconcat = has_buf ? function(bufs) { return Buffer.concat(bufs.map(function(buf) { return Buffer.isBuffer(buf) ? buf : Buffer_from(buf); })); } : function(bufs) {\n\tif(typeof Uint8Array !== \"undefined\") {\n\t\tvar i = 0, maxlen = 0;\n\t\tfor(i = 0; i < bufs.length; ++i) maxlen += bufs[i].length;\n\t\tvar o = new Uint8Array(maxlen);\n\t\tvar len = 0;\n\t\tfor(i = 0, maxlen = 0; i < bufs.length; maxlen += len, ++i) {\n\t\t\tlen = bufs[i].length;\n\t\t\tif(bufs[i] instanceof Uint8Array) o.set(bufs[i], maxlen);\n\t\t\telse if(typeof bufs[i] == \"string\") o.set(new Uint8Array(s2a(bufs[i])), maxlen);\n\t\t\telse o.set(new Uint8Array(bufs[i]), maxlen);\n\t\t}\n\t\treturn o;\n\t}\n\treturn [].concat.apply([], bufs.map(function(buf) { return Array.isArray(buf) ? buf : [].slice.call(buf); }));\n};\n\nfunction utf8decode(content/*:string*/) {\n\tvar out = [], widx = 0, L = content.length + 250;\n\tvar o = new_raw_buf(content.length + 255);\n\tfor(var ridx = 0; ridx < content.length; ++ridx) {\n\t\tvar c = content.charCodeAt(ridx);\n\t\tif(c < 0x80) o[widx++] = c;\n\t\telse if(c < 0x800) {\n\t\t\to[widx++] = (192|((c>>6)&31));\n\t\t\to[widx++] = (128|(c&63));\n\t\t} else if(c >= 0xD800 && c < 0xE000) {\n\t\t\tc = (c&1023)+64;\n\t\t\tvar d = content.charCodeAt(++ridx)&1023;\n\t\t\to[widx++] = (240|((c>>8)&7));\n\t\t\to[widx++] = (128|((c>>2)&63));\n\t\t\to[widx++] = (128|((d>>6)&15)|((c&3)<<4));\n\t\t\to[widx++] = (128|(d&63));\n\t\t} else {\n\t\t\to[widx++] = (224|((c>>12)&15));\n\t\t\to[widx++] = (128|((c>>6)&63));\n\t\t\to[widx++] = (128|(c&63));\n\t\t}\n\t\tif(widx > L) {\n\t\t\tout.push(o.slice(0, widx));\n\t\t\twidx = 0;\n\t\t\to = new_raw_buf(65535);\n\t\t\tL = 65530;\n\t\t}\n\t}\n\tout.push(o.slice(0, widx));\n\treturn bconcat(out);\n}\n\nvar chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/g;\n/*::\ndeclare type Block = any;\ndeclare type BufArray = {\n\tnewblk(sz:number):Block;\n\tnext(sz:number):Block;\n\tend():any;\n\tpush(buf:Block):void;\n};\n\ntype RecordHopperCB = {(d:any, Rn:string, RT:number):?boolean;};\n\ntype EvertType = {[string]:string};\ntype EvertNumType = {[string]:number};\ntype EvertArrType = {[string]:Array<string>};\n\ntype StringConv = {(string):string};\n\n*/\n/* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/*jshint -W041 */\nfunction _strrev(x/*:string*/)/*:string*/ { var o = \"\", i = x.length-1; while(i>=0) o += x.charAt(i--); return o; }\nfunction pad0(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad_(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+v;return t.length>=d?t:fill(' ',d-t.length)+t;}\nfunction rpad_(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+v; return t.length>=d?t:t+fill(' ',d-t.length);}\nfunction pad0r1(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+Math.round(v); return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad0r2(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nvar p2_32 = /*#__PURE__*/Math.pow(2,32);\nfunction pad0r(v/*:any*/,d/*:number*/)/*:string*/{if(v>p2_32||v<-p2_32) return pad0r1(v,d); var i = Math.round(v); return pad0r2(i,d); }\n/* yes, in 2022 this is still faster than string compare */\nfunction SSF_isgeneral(s/*:string*/, i/*:?number*/)/*:boolean*/ { i = i || 0; return s.length >= 7 + i && (s.charCodeAt(i)|32) === 103 && (s.charCodeAt(i+1)|32) === 101 && (s.charCodeAt(i+2)|32) === 110 && (s.charCodeAt(i+3)|32) === 101 && (s.charCodeAt(i+4)|32) === 114 && (s.charCodeAt(i+5)|32) === 97 && (s.charCodeAt(i+6)|32) === 108; }\nvar days/*:Array<Array<string> >*/ = [\n\t['Sun', 'Sunday'],\n\t['Mon', 'Monday'],\n\t['Tue', 'Tuesday'],\n\t['Wed', 'Wednesday'],\n\t['Thu', 'Thursday'],\n\t['Fri', 'Friday'],\n\t['Sat', 'Saturday']\n];\nvar months/*:Array<Array<string> >*/ = [\n\t['J', 'Jan', 'January'],\n\t['F', 'Feb', 'February'],\n\t['M', 'Mar', 'March'],\n\t['A', 'Apr', 'April'],\n\t['M', 'May', 'May'],\n\t['J', 'Jun', 'June'],\n\t['J', 'Jul', 'July'],\n\t['A', 'Aug', 'August'],\n\t['S', 'Sep', 'September'],\n\t['O', 'Oct', 'October'],\n\t['N', 'Nov', 'November'],\n\t['D', 'Dec', 'December']\n];\nfunction SSF_init_table(t/*:any*/) {\n\tif(!t) t = {};\n\tt[0]=  'General';\n\tt[1]=  '0';\n\tt[2]=  '0.00';\n\tt[3]=  '#,##0';\n\tt[4]=  '#,##0.00';\n\tt[9]=  '0%';\n\tt[10]= '0.00%';\n\tt[11]= '0.00E+00';\n\tt[12]= '# ?/?';\n\tt[13]= '# ??/??';\n\tt[14]= 'm/d/yy';\n\tt[15]= 'd-mmm-yy';\n\tt[16]= 'd-mmm';\n\tt[17]= 'mmm-yy';\n\tt[18]= 'h:mm AM/PM';\n\tt[19]= 'h:mm:ss AM/PM';\n\tt[20]= 'h:mm';\n\tt[21]= 'h:mm:ss';\n\tt[22]= 'm/d/yy h:mm';\n\tt[37]= '#,##0 ;(#,##0)';\n\tt[38]= '#,##0 ;[Red](#,##0)';\n\tt[39]= '#,##0.00;(#,##0.00)';\n\tt[40]= '#,##0.00;[Red](#,##0.00)';\n\tt[45]= 'mm:ss';\n\tt[46]= '[h]:mm:ss';\n\tt[47]= 'mmss.0';\n\tt[48]= '##0.0E+0';\n\tt[49]= '@';\n\tt[56]= '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"';\n\treturn t;\n}\n/* repeated to satiate webpack */\nvar table_fmt = {\n\t0:  'General',\n\t1:  '0',\n\t2:  '0.00',\n\t3:  '#,##0',\n\t4:  '#,##0.00',\n\t9:  '0%',\n\t10: '0.00%',\n\t11: '0.00E+00',\n\t12: '# ?/?',\n\t13: '# ??/??',\n\t14: 'm/d/yy',\n\t15: 'd-mmm-yy',\n\t16: 'd-mmm',\n\t17: 'mmm-yy',\n\t18: 'h:mm AM/PM',\n\t19: 'h:mm:ss AM/PM',\n\t20: 'h:mm',\n\t21: 'h:mm:ss',\n\t22: 'm/d/yy h:mm',\n\t37: '#,##0 ;(#,##0)',\n\t38: '#,##0 ;[Red](#,##0)',\n\t39: '#,##0.00;(#,##0.00)',\n\t40: '#,##0.00;[Red](#,##0.00)',\n\t45: 'mm:ss',\n\t46: '[h]:mm:ss',\n\t47: 'mmss.0',\n\t48: '##0.0E+0',\n\t49: '@',\n\t56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\n};\n\n/* Defaults determined by systematically testing in Excel 2019 */\n\n/* These formats appear to default to other formats in the table */\nvar SSF_default_map = {\n\t5:  37, 6:  38, 7:  39, 8:  40,         //  5 -> 37 ...  8 -> 40\n\n\t23:  0, 24:  0, 25:  0, 26:  0,         // 23 ->  0 ... 26 ->  0\n\n\t27: 14, 28: 14, 29: 14, 30: 14, 31: 14, // 27 -> 14 ... 31 -> 14\n\n\t50: 14, 51: 14, 52: 14, 53: 14, 54: 14, // 50 -> 14 ... 58 -> 14\n\t55: 14, 56: 14, 57: 14, 58: 14,\n\t59:  1, 60:  2, 61:  3, 62:  4,         // 59 ->  1 ... 62 ->  4\n\n\t67:  9, 68: 10,                         // 67 ->  9 ... 68 -> 10\n\t69: 12, 70: 13, 71: 14,                 // 69 -> 12 ... 71 -> 14\n\t72: 14, 73: 15, 74: 16, 75: 17,         // 72 -> 14 ... 75 -> 17\n\t76: 20, 77: 21, 78: 22,                 // 76 -> 20 ... 78 -> 22\n\t79: 45, 80: 46, 81: 47,                 // 79 -> 45 ... 81 -> 47\n\t82: 0                                   // 82 ->  0 ... 65536 -> 0 (omitted)\n};\n\n\n/* These formats technically refer to Accounting formats with no equivalent */\nvar SSF_default_str = {\n\t//  5 -- Currency,   0 decimal, black negative\n\t5:  '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t63: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\n\t//  6 -- Currency,   0 decimal, red   negative\n\t6:  '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t64: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\n\t//  7 -- Currency,   2 decimal, black negative\n\t7:  '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t65: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\n\t//  8 -- Currency,   2 decimal, red   negative\n\t8:  '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t66: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\n\t// 41 -- Accounting, 0 decimal, No Symbol\n\t41: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n\n\t// 42 -- Accounting, 0 decimal, $  Symbol\n\t42: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n\n\t// 43 -- Accounting, 2 decimal, No Symbol\n\t43: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n\n\t// 44 -- Accounting, 2 decimal, $  Symbol\n\t44: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)'\n};\n\nfunction SSF_frac(x/*:number*/, D/*:number*/, mixed/*:?boolean*/)/*:Array<number>*/ {\n\tvar sgn = x < 0 ? -1 : 1;\n\tvar B = x * sgn;\n\tvar P_2 = 0, P_1 = 1, P = 0;\n\tvar Q_2 = 1, Q_1 = 0, Q = 0;\n\tvar A = Math.floor(B);\n\twhile(Q_1 < D) {\n\t\tA = Math.floor(B);\n\t\tP = A * P_1 + P_2;\n\t\tQ = A * Q_1 + Q_2;\n\t\tif((B - A) < 0.00000005) break;\n\t\tB = 1 / (B - A);\n\t\tP_2 = P_1; P_1 = P;\n\t\tQ_2 = Q_1; Q_1 = Q;\n\t}\n\tif(Q > D) { if(Q_1 > D) { Q = Q_2; P = P_2; } else { Q = Q_1; P = P_1; } }\n\tif(!mixed) return [0, sgn * P, Q];\n\tvar q = Math.floor(sgn * P/Q);\n\treturn [q, sgn*P - q*Q, Q];\n}\nfunction SSF_normalize_xl_unsafe(v/*:number*/)/*:number*/ {\n\tvar s = v.toPrecision(16);\n\tif(s.indexOf(\"e\") > -1) {\n\t\tvar m = s.slice(0, s.indexOf(\"e\"));\n\t\tm = m.indexOf(\".\") > -1 ? m.slice(0, (m.slice(0,2) == \"0.\" ? 17 : 16)) : (m.slice(0,15) + fill(\"0\", m.length - 15));\n\t\treturn m + s.slice(s.indexOf(\"e\"));\n\t}\n\tvar n = s.indexOf(\".\") > -1 ? s.slice(0, (s.slice(0,2) == \"0.\" ? 17 : 16)) : (s.slice(0,15) + fill(\"0\", s.length - 15));\n\treturn Number(n);\n}\n\nfunction SSF_parse_date_code(v/*:number*/,opts/*:?any*/,b2/*:?boolean*/) {\n\tif(v > 2958465 || v < 0) return null;\n\tv = SSF_normalize_xl_unsafe(v);\n\tvar date = (v|0), time = Math.floor(86400 * (v - date)), dow=0;\n\tvar dout=[];\n\tvar out={D:date, T:time, u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};\n\tif(Math.abs(out.u) < 1e-6) out.u = 0;\n\tif(opts && opts.date1904) date += 1462;\n\tif(out.u > 0.9999) {\n\t\tout.u = 0;\n\t\tif(++time == 86400) { out.T = time = 0; ++date; ++out.D; }\n\t}\n\tif(date === 60) {dout = b2 ? [1317,10,29] : [1900,2,29]; dow=3;}\n\telse if(date === 0) {dout = b2 ? [1317,8,29] : [1900,1,0]; dow=6;}\n\telse {\n\t\tif(date > 60) --date;\n\t\t/* 1 = Jan 1 1900 in Gregorian */\n\t\tvar d = new Date(1900, 0, 1);\n\t\td.setDate(d.getDate() + date - 1);\n\t\tdout = [d.getFullYear(), d.getMonth()+1,d.getDate()];\n\t\tdow = d.getDay();\n\t\tif(date < 60) dow = (dow + 6) % 7;\n\t\tif(b2) dow = SSF_fix_hijri(d, dout);\n\t}\n\tout.y = dout[0]; out.m = dout[1]; out.d = dout[2];\n\tout.S = time % 60; time = Math.floor(time / 60);\n\tout.M = time % 60; time = Math.floor(time / 60);\n\tout.H = time;\n\tout.q = dow;\n\treturn out;\n}\n/* ECMA-376 18.8.30 numFmt*/\n/* Note: `toPrecision` uses standard form when prec > E and E >= -6 */\n/* exponent >= -9 and <= 9 */\nfunction SSF_strip_decimal(o/*:string*/)/*:string*/ {\n\treturn (o.indexOf(\".\") == -1) ? o : o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/, \"$1\");\n}\n\n/* General Exponential always shows 2 digits exp and trims the mantissa */\nfunction SSF_normalize_exp(o/*:string*/)/*:string*/ {\n\tif(o.indexOf(\"E\") == -1) return o;\n\treturn o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/,\"$1E\").replace(/(E[+-])(\\d)$/,\"$10$2\");\n}\n\n/* exponent >= -9 and <= 9 */\nfunction SSF_small_exp(v/*:number*/)/*:string*/ {\n\tvar w = (v<0?12:11);\n\tvar o = SSF_strip_decimal(v.toFixed(12)); if(o.length <= w) return o;\n\to = v.toPrecision(10); if(o.length <= w) return o;\n\treturn v.toExponential(5);\n}\n\n/* exponent >= 11 or <= -10 likely exponential */\nfunction SSF_large_exp(v/*:number*/)/*:string*/ {\n\tvar o = SSF_strip_decimal(v.toFixed(11));\n\treturn (o.length > (v<0?12:11) || o === \"0\" || o === \"-0\") ? v.toPrecision(6) : o;\n}\n\nfunction SSF_general_num(v/*:number*/)/*:string*/ {\n\tif(!isFinite(v)) return isNaN(v) ? \"#NUM!\" : \"#DIV/0!\";\n\tvar V = Math.floor(Math.log(Math.abs(v))*Math.LOG10E), o;\n\n\tif(V >= -4 && V <= -1) o = v.toPrecision(10+V);\n\telse if(Math.abs(V) <= 9) o = SSF_small_exp(v);\n\telse if(V === 10) o = v.toFixed(10).substr(0,12);\n\telse o = SSF_large_exp(v);\n\n\treturn SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));\n}\n\n\n/*\n\t\"General\" rules:\n\t- text is passed through (\"@\")\n\t- booleans are rendered as TRUE/FALSE\n\t- \"up to 11 characters\" displayed for numbers\n\t- Default date format (code 14) used for Dates\n\n\tThe longest 32-bit integer text is \"-2147483648\", exactly 11 chars\n\tTODO: technically the display depends on the width of the cell\n*/\nfunction SSF_general(v/*:any*/, opts/*:any*/) {\n\tswitch(typeof v) {\n\t\tcase 'string': return v;\n\t\tcase 'boolean': return v ? \"TRUE\" : \"FALSE\";\n\t\tcase 'number': return (v|0) === v ? v.toString(10) : SSF_general_num(v);\n\t\tcase 'undefined': return \"\";\n\t\tcase 'object':\n\t\t\tif(v == null) return \"\";\n\t\t\tif(v instanceof Date) return SSF_format(14, datenum(v, opts && opts.date1904), opts);\n\t}\n\tthrow new Error(\"unsupported value in General format: \" + v);\n}\n\nfunction SSF_fix_hijri(date/*:Date*/, o/*:[number, number, number]*/) {\n  /* TODO: properly adjust y/m/d and  */\n  o[0] -= 581;\n  var dow = date.getDay();\n  if(date < 60) dow = (dow + 6) % 7;\n  return dow;\n}\n//var THAI_DIGITS = \"\\u0E50\\u0E51\\u0E52\\u0E53\\u0E54\\u0E55\\u0E56\\u0E57\\u0E58\\u0E59\".split(\"\");\nfunction SSF_write_date(type/*:number*/, fmt/*:string*/, val, ss0/*:?number*/)/*:string*/ {\n\tvar o=\"\", ss=0, tt=0, y = val.y, out, outl = 0;\n\tswitch(type) {\n\t\tcase 98: /* 'b' buddhist year */\n\t\t\ty = val.y + 543;\n\t\t\t/* falls through */\n\t\tcase 121: /* 'y' year */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = y % 100; outl = 2; break;\n\t\t\tdefault: out = y % 10000; outl = 4; break;\n\t\t} break;\n\t\tcase 109: /* 'm' month */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.m; outl = fmt.length; break;\n\t\t\tcase 3: return months[val.m-1][1];\n\t\t\tcase 5: return months[val.m-1][0];\n\t\t\tdefault: return months[val.m-1][2];\n\t\t} break;\n\t\tcase 100: /* 'd' day */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.d; outl = fmt.length; break;\n\t\t\tcase 3: return days[val.q][0];\n\t\t\tdefault: return days[val.q][1];\n\t\t} break;\n\t\tcase 104: /* 'h' 12-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = 1+(val.H+11)%12; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 72: /* 'H' 24-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.H; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 77: /* 'M' minutes */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.M; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad minute format: ' + fmt;\n\t\t} break;\n\t\tcase 115: /* 's' seconds */\n\t\t\tif(fmt != 's' && fmt != 'ss' && fmt != '.0' && fmt != '.00' && fmt != '.000') throw 'bad second format: ' + fmt;\n\t\t\tif(val.u === 0 && (fmt == \"s\" || fmt == \"ss\")) return pad0(val.S, fmt.length);\n\t\t\t/*::if(!ss0) ss0 = 0; */\n\t\t\tif(ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\n\t\t\telse tt = ss0 === 1 ? 10 : 1;\n\t\t\tss = Math.round((tt)*(val.S + val.u));\n\t\t\tif(ss >= 60*tt) ss = 0;\n\t\t\tif(fmt === 's') return ss === 0 ? \"0\" : \"\"+ss/tt;\n\t\t\to = pad0(ss,2 + ss0);\n\t\t\tif(fmt === 'ss') return o.substr(0,2);\n\t\t\treturn \".\" + o.substr(2,fmt.length-1);\n\t\tcase 90: /* 'Z' absolute time */\n\t\tswitch(fmt) {\n\t\t\tcase '[h]': case '[hh]': out = val.D*24+val.H; break;\n\t\t\tcase '[m]': case '[mm]': out = (val.D*24+val.H)*60+val.M; break;\n\t\t\tcase '[s]': case '[ss]': out = ((val.D*24+val.H)*60+val.M)*60+(ss0 == 0 ? Math.round(val.S+val.u) : val.S); break;\n\t\t\tdefault: throw 'bad abstime format: ' + fmt;\n\t\t} outl = fmt.length === 3 ? 1 : 2; break;\n\t\tcase 101: /* 'e' era */\n\t\t\tout = y; outl = 1; break;\n\t}\n\tvar outstr = outl > 0 ? pad0(out, outl) : \"\";\n\treturn outstr;\n}\n\n\n/*jshint -W086 */\n/*jshint +W086 */\nfunction commaify(s/*:string*/)/*:string*/ {\n\tvar w = 3;\n\tif(s.length <= w) return s;\n\tvar j = (s.length % w), o = s.substr(0,j);\n\tfor(; j!=s.length; j+=w) o+=(o.length > 0 ? \",\" : \"\") + s.substr(j,w);\n\treturn o;\n}\nvar pct1 = /%/g;\nfunction write_num_pct(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\n\nfunction write_num_cm(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\n\nfunction write_num_exp(fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar o/*:string*/;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif(val == 0) return \"0.0E+0\";\n\t\telse if(val < 0) return \"-\" + write_num_exp(fmt, -val);\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(o.indexOf(\"e\") === -1) {\n\t\t\tvar fakee = Math.floor(Math.log(val)*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\twhile(o.substr(0,2) === \"0.\") {\n\t\t\t\to = o.charAt(0) + o.substr(2,period) + \".\" + o.substr(2+period);\n\t\t\t\to = o.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\");\n\t\t\t}\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\nfunction write_num_f1(r/*:Array<string>*/, aval/*:number*/, sign/*:string*/)/*:string*/ {\n\tvar den = parseInt(r[4],10), rr = Math.round(aval * den), base = Math.floor(rr/den);\n\tvar myn = (rr - base*den), myd = den;\n\treturn sign + (base === 0 ? \"\" : \"\"+base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn,r[1].length) + r[2] + \"/\" + r[3] + pad0(myd,r[4].length));\n}\nfunction write_num_f2(r/*:Array<string>*/, aval/*:number*/, sign/*:string*/)/*:string*/ {\n\treturn sign + (aval === 0 ? \"\" : \"\"+aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\nvar dec1 = /^#*0*\\.([0#]+)/;\nvar closeparen = /\\)[^)]*[0#]/;\nvar phone = /\\(###\\) ###\\\\?-####/;\nfunction hashq(str/*:string*/)/*:string*/ {\n\tvar o = \"\", cc;\n\tfor(var i = 0; i != str.length; ++i) switch((cc=str.charCodeAt(i))) {\n\t\tcase 35: break;\n\t\tcase 63: o+= \" \"; break;\n\t\tcase 48: o+= \"0\"; break;\n\t\tdefault: o+= String.fromCharCode(cc);\n\t}\n\treturn o;\n}\nfunction rnd(val/*:number*/, d/*:number*/)/*:string*/ { var dd = Math.pow(10,d); return \"\"+(Math.round(val * dd)/dd); }\nfunction dec(val/*:number*/, d/*:number*/)/*:number*/ {\n\tvar _frac = val - Math.floor(val), dd = Math.pow(10,d);\n\tif (d < ('' + Math.round(_frac * dd)).length) return 0;\n\treturn Math.round(_frac * dd);\n}\nfunction carry(val/*:number*/, d/*:number*/)/*:number*/ {\n\tif (d < ('' + Math.round((val-Math.floor(val))*Math.pow(10,d))).length) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nfunction flr(val/*:number*/)/*:string*/ {\n\tif(val < 2147483647 && val > -2147483648) return \"\"+(val >= 0 ? (val|0) : (val-1|0));\n\treturn \"\"+Math.floor(val);\n}\nfunction write_num_flt(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/ {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_flt('n', ffmt, val);\n\t\treturn '(' + write_num_flt('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_flt(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\n\tvar o;\n\tvar r/*:?Array<string>*/, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0r(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = pad0r(val,0); if(o === \"0\") o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1))) return write_num_f1(r, aval, sign);\n\tif(fmt.match(/^#+0+$/)) return sign + pad0r(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1))) {\n\t\to = rnd(val, r[1].length).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1])).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", hashq(/*::(*/r/*::||[\"\"])*/[1]).length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify(pad0r(aval,0));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\"+(Math.floor(val) + carry(val, r[1].length))) + \".\" + pad0(dec(val, r[1].length),r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/))) return write_num_flt(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone)) {\n\t\to = write_num_flt(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(/*::String(*/r[4]/*::)*/.length,7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", /*::String(*/r[1]/*::)*/, ff[1]);\n\t\tif(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + /*::String(*/r[2]/*::)*/ + \"/\" + /*::String(*/r[3]/*::)*/;\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/))) {\n\t\to = pad0r(val, 0);\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0?]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\tri = dec(val, r[1].length);\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(ri,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"###,##0.00\": return write_num_flt(type, \"#,##0.00\", val);\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": var x = commaify(pad0r(aval,0)); return x !== \"0\" ? sign + x : \"\";\n\t\tcase \"###,###.00\": return write_num_flt(type, \"###,##0.00\",val).replace(/^0\\./,\".\");\n\t\tcase \"#,###.00\": return write_num_flt(type, \"#,##0.00\",val).replace(/^0\\./,\".\");\n\t\tdefault:\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num_cm2(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\nfunction write_num_pct2(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\nfunction write_num_exp2(fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar o/*:string*/;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif(val == 0) return \"0.0E+0\";\n\t\telse if(val < 0) return \"-\" + write_num_exp2(fmt, -val);\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(!o.match(/[Ee]/)) {\n\t\t\tvar fakee = Math.floor(Math.log(val)*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nfunction write_num_int(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/ {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_int('n', ffmt, val);\n\t\treturn '(' + write_num_int('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_int(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\n\tvar o;\n\tvar r/*:?Array<string>*/, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = (\"\"+val); if(val === 0) o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1))) return write_num_f2(r, aval, sign);\n\tif(fmt.match(/^#+0+$/)) return sign + pad0(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1))) {\n\t\t/*:: if(!Array.isArray(r)) throw new Error(\"unreachable\"); */\n\t\to = (\"\"+val).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1]));\n\t\to = o.replace(/\\.(\\d*)$/,function($$, $1) {\n\t\t/*:: if(!Array.isArray(r)) throw new Error(\"unreachable\"); */\n\t\t\treturn \".\" + $1 + fill(\"0\", hashq(r[1]).length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn sign + (\"\"+aval).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify((\"\"+aval));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\"+val)) + \".\" + fill('0',r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/))) return write_num_int(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone)) {\n\t\to = write_num_int(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(/*::String(*/r[4]/*::)*/.length,7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", /*::String(*/r[1]/*::)*/, ff[1]);\n\t\tif(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + /*::String(*/r[2]/*::)*/ + \"/\" + /*::String(*/r[3]/*::)*/;\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/))) {\n\t\to = \"\" + val;\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\"+val).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(0,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": var x = commaify(\"\"+aval); return x !== \"0\" ? sign + x : \"\";\n\t\tdefault:\n\t\t\tif(fmt.match(/\\.[0#?]*$/)) return write_num_int(type, fmt.slice(0,fmt.lastIndexOf(\".\")), val) + hashq(fmt.slice(fmt.lastIndexOf(\".\")));\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/ {\n\treturn (val|0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n}\nfunction SSF_split_fmt(fmt/*:string*/)/*:Array<string>*/ {\n\tvar out/*:Array<string>*/ = [];\n\tvar in_str = false/*, cc*/;\n\tfor(var i = 0, j = 0; i < fmt.length; ++i) switch((/*cc=*/fmt.charCodeAt(i))) {\n\t\tcase 34: /* '\"' */\n\t\t\tin_str = !in_str; break;\n\t\tcase 95: case 42: case 92: /* '_' '*' '\\\\' */\n\t\t\t++i; break;\n\t\tcase 59: /* ';' */\n\t\t\tout[out.length] = fmt.substr(j,i-j);\n\t\t\tj = i+1;\n\t}\n\tout[out.length] = fmt.substr(j);\n\tif(in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n\treturn out;\n}\n\nvar SSF_abstime = /\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;\nfunction fmt_is_date(fmt/*:string*/)/*:boolean*/ {\n\tvar i = 0, /*cc = 0,*/ c = \"\", o = \"\";\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt.charAt(i))) {\n\t\t\tcase 'G': if(SSF_isgeneral(fmt, i)) i+= 6; i++; break;\n\t\t\tcase '\"': for(;(/*cc=*/fmt.charCodeAt(++i)) !== 34 && i < fmt.length;){/*empty*/} ++i; break;\n\t\t\tcase '\\\\': i+=2; break;\n\t\t\tcase '_': i+=2; break;\n\t\t\tcase '@': ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") return true;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g': return true;\n\t\t\tcase 'A': case 'a': case '上':\n\t\t\t\tif(fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\n\t\t\t\tif(fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\n\t\t\t\tif(fmt.substr(i, 5).toUpperCase() === \"上午/下午\") return true;\n\t\t\t\t++i; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif(o.match(SSF_abstime)) return true;\n\t\t\t\tbreak;\n\t\t\tcase '.':\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\twhile(i < fmt.length && (\"0#?.,E+-%\".indexOf(c=fmt.charAt(++i)) > -1 || (c=='\\\\' && fmt.charAt(i+1) == \"-\" && \"0#\".indexOf(fmt.charAt(i+2))>-1))){/* empty */}\n\t\t\t\tbreak;\n\t\t\tcase '?': while(fmt.charAt(++i) === c){/* empty */} break;\n\t\t\tcase '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break;\n\t\t\tcase '(': case ')': ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\twhile(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1){/* empty */} break;\n\t\t\tcase ' ': ++i; break;\n\t\t\tdefault: ++i; break;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction eval_fmt(fmt/*:string*/, v/*:any*/, opts/*:any*/, flen/*:number*/) {\n\tvar out = [], o = \"\", i = 0, c = \"\", lst='t', dt, j, cc;\n\tvar hr='H';\n\t/* Tokenize */\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt.charAt(i))) {\n\t\t\tcase 'G': /* General */\n\t\t\t\tif(!SSF_isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' +fmt);\n\t\t\t\tout[out.length] = {t:'G', v:'General'}; i+=7; break;\n\t\t\tcase '\"': /* Literal text */\n\t\t\t\tfor(o=\"\";(cc=fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n\t\t\t\tout[out.length] = {t:'t', v:o}; ++i; break;\n\t\t\tcase '\\\\': var w = fmt.charAt(++i), t = (w === \"(\" || w === \")\") ? w : 't';\n\t\t\t\tout[out.length] = {t:t, v:w}; ++i; break;\n\t\t\tcase '_': out[out.length] = {t:'t', v:\" \"}; i+=2; break;\n\t\t\tcase '@': /* Text Placeholder */\n\t\t\t\tout[out.length] = {t:'T', v:v}; ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") {\n\t\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts, fmt.charAt(i+1) === \"2\"); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'X', v:fmt.substr(i,2)}; lst = c; i+=2; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\tc = c.toLowerCase();\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\n\t\t\t\tif(v < 0) return \"\";\n\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\to = c; while(++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o+=c;\n\t\t\t\tif(c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n\t\t\t\tif(c === 'h') c = hr;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase 'A': case 'a': case '上':\n\t\t\t\tvar q={t:c, v:c};\n\t\t\t\tif(dt==null) dt=SSF_parse_date_code(v, opts);\n\t\t\t\tif(fmt.substr(i, 3).toUpperCase() === \"A/P\") { if(dt!=null) q.v = dt.H >= 12 ? fmt.charAt(i+2) : c; q.t = 'T'; hr='h';i+=3;}\n\t\t\t\telse if(fmt.substr(i,5).toUpperCase() === \"AM/PM\") { if(dt!=null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse if(fmt.substr(i,5).toUpperCase() === \"上午/下午\") { if(dt!=null) q.v = dt.H >= 12 ? \"下午\" : \"上午\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse { q.t = \"t\"; ++i; }\n\t\t\t\tif(dt==null && q.t === 'T') return \"\";\n\t\t\t\tout[out.length] = q; lst = c; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif(o.slice(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\t\t\t\tif(o.match(SSF_abstime)) {\n\t\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'Z', v:o.toLowerCase()};\n\t\t\t\t\tlst = o.charAt(1);\n\t\t\t\t} else if(o.indexOf(\"$\") > -1) {\n\t\t\t\t\to = (o.match(/\\$([^-\\[\\]]*)/)||[])[1]||\"$\";\n\t\t\t\t\tif(!fmt_is_date(fmt)) out[out.length] = {t:'t',v:o};\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t/* Numbers */\n\t\t\tcase '.':\n\t\t\t\tif(dt != null) {\n\t\t\t\t\to = c; while(++i < fmt.length && (c=fmt.charAt(i)) === \"0\") o += c;\n\t\t\t\t\tout[out.length] = {t:'s', v:o}; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\to = c; while(++i < fmt.length && \"0#?.,E+-%\".indexOf(c=fmt.charAt(i)) > -1) o += c;\n\t\t\t\tout[out.length] = {t:'n', v:o}; break;\n\t\t\tcase '?':\n\t\t\t\to = c; while(fmt.charAt(++i) === c) o+=c;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break; // **\n\t\t\tcase '(': case ')': out[out.length] = {t:(flen===1?'t':c), v:c}; ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\to = c; while(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) o+=fmt.charAt(i);\n\t\t\t\tout[out.length] = {t:'D', v:o}; break;\n\t\t\tcase ' ': out[out.length] = {t:c, v:c}; ++i; break;\n\t\t\tcase '$': out[out.length] = {t:'t', v:'$'}; ++i; break;\n\t\t\tdefault:\n\t\t\t\tif(\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n\t\t\t\tout[out.length] = {t:'t', v:c}; ++i; break;\n\t\t}\n\t}\n\n\t/* Scan for date/time parts */\n\tvar bt = 0, ss0 = 0, ssm;\n\tfor(i=out.length-1, lst='t'; i >= 0; --i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 'h': case 'H': out[i].t = hr; lst='h'; if(bt < 1) bt = 1; break;\n\t\t\tcase 's':\n\t\t\t\tif((ssm=out[i].v.match(/\\.0+$/))) { ss0=Math.max(ss0,ssm[0].length-1); bt = 4;}\n\t\t\t\tif(bt < 3) bt = 3;\n\t\t\t/* falls through */\n\t\t\tcase 'd': case 'y': case 'e': lst=out[i].t; break;\n\t\t\tcase 'M': lst=out[i].t; if(bt < 2) bt = 2; break;\n\t\t\tcase 'm': if(lst === 's') { out[i].t = 'M'; if(bt < 2) bt = 2; } break;\n\t\t\tcase 'X': /*if(out[i].v === \"B2\");*/\n\t\t\t\tbreak;\n\t\t\tcase 'Z':\n\t\t\t\tif(bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n\t\t\t\tif(bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n\t\t\t\tif(bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n\t\t}\n\t}\n\n\t/* time rounding depends on presence of minute / second / usec fields */\n\tvar _dt;\n\tswitch(bt) {\n\t\tcase 0: break;\n\t\tcase 1:\n\t\tcase 2:\n\t\tcase 3:\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tif(dt.M >=  60) { dt.M = 0; ++dt.H; }\n\t\t\tif(dt.H >=  24) { dt.H = 0; ++dt.D; _dt = SSF_parse_date_code(dt.D); _dt.u = dt.u; _dt.S = dt.S; _dt.M = dt.M; _dt.H = dt.H; dt = _dt; }\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tswitch(ss0) {\n\t\t\t\tcase 1: dt.u = Math.round(dt.u * 10)/10; break;\n\t\t\t\tcase 2: dt.u = Math.round(dt.u * 100)/100; break;\n\t\t\t\tcase 3: dt.u = Math.round(dt.u * 1000)/1000; break;\n\t\t\t}\n\t\t\tif(dt.u >=   1) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tif(dt.M >=  60) { dt.M = 0; ++dt.H; }\n\t\t\tif(dt.H >=  24) { dt.H = 0; ++dt.D; _dt = SSF_parse_date_code(dt.D); _dt.u = dt.u; _dt.S = dt.S; _dt.M = dt.M; _dt.H = dt.H; dt = _dt; }\n\t\t\tbreak;\n\t}\n\n\t/* replace fields */\n\tvar nstr = \"\", jj;\n\tfor(i=0; i < out.length; ++i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 't': case 'T': case ' ': case 'D': break;\n\t\t\tcase 'X': out[i].v = \"\"; out[i].t = \";\"; break;\n\t\t\tcase 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\n\t\t\t\t/*::if(!dt) throw \"unreachable\"; */\n\t\t\t\tout[i].v = SSF_write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n\t\t\t\tout[i].t = 't'; break;\n\t\t\tcase 'n': case '?':\n\t\t\t\tjj = i+1;\n\t\t\t\twhile(out[jj] != null && (\n\t\t\t\t\t(c=out[jj].t) === \"?\" || c === \"D\" ||\n\t\t\t\t\t((c === \" \" || c === \"t\") && out[jj+1] != null && (out[jj+1].t === '?' || out[jj+1].t === \"t\" && out[jj+1].v === '/')) ||\n\t\t\t\t\t(out[i].t === '(' && (c === ' ' || c === 'n' || c === ')')) ||\n\t\t\t\t\t(c === 't' && (out[jj].v === '/' || out[jj].v === ' ' && out[jj+1] != null && out[jj+1].t == '?'))\n\t\t\t\t)) {\n\t\t\t\t\tout[i].v += out[jj].v;\n\t\t\t\t\tout[jj] = {v:\"\", t:\";\"}; ++jj;\n\t\t\t\t}\n\t\t\t\tnstr += out[i].v;\n\t\t\t\ti = jj-1; break;\n\t\t\tcase 'G': out[i].t = 't'; out[i].v = SSF_general(v,opts); break;\n\t\t}\n\t}\n\tvar vv = \"\", myv, ostr;\n\tif(nstr.length > 0) {\n\t\tif(nstr.charCodeAt(0) == 40) /* '(' */ {\n\t\t\tmyv = (v<0&&nstr.charCodeAt(0) === 45 ? -v : v);\n\t\t\tostr = write_num('n', nstr, myv);\n\t\t} else {\n\t\t\tmyv = (v<0 && flen > 1 ? -v : v);\n\t\t\tostr = write_num('n', nstr, myv);\n\t\t\tif(myv < 0 && out[0] && out[0].t == 't') {\n\t\t\t\tostr = ostr.substr(1);\n\t\t\t\tout[0].v = \"-\" + out[0].v;\n\t\t\t}\n\t\t}\n\t\tjj=ostr.length-1;\n\t\tvar decpt = out.length;\n\t\tfor(i=0; i < out.length; ++i) if(out[i] != null && out[i].t != 't' && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\n\t\tvar lasti=out.length;\n\t\tif(decpt === out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tfor(i=out.length-1; i>= 0;--i) {\n\t\t\t\tif(out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\t\t\t\tif(jj>=out[i].v.length-1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj+1, out[i].v.length); }\n\t\t\t\telse if(jj < 0) out[i].v = \"\";\n\t\t\t\telse { out[i].v = ostr.substr(0, jj+1); jj = -1; }\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t}\n\t\telse if(decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tjj = ostr.indexOf(\".\")-1;\n\t\t\tfor(i=decpt; i>= 0; --i) {\n\t\t\t\tif(out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")-1:out[i].v.length-1;\n\t\t\t\tvv = out[i].v.substr(j+1);\n\t\t\t\tfor(; j>=0; --j) {\n\t\t\t\t\tif(jj>=0 && (out[i].v.charAt(j) === \"0\" || out[i].v.charAt(j) === \"#\")) vv = ostr.charAt(jj--) + vv;\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t\tjj = ostr.indexOf(\".\")+1;\n\t\t\tfor(i=decpt; i<out.length; ++i) {\n\t\t\t\tif(out[i] == null || ('n?('.indexOf(out[i].t) === -1 && i !== decpt)) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")+1:0;\n\t\t\t\tvv = out[i].v.substr(0,j);\n\t\t\t\tfor(; j<out[i].v.length; ++j) {\n\t\t\t\t\tif(jj<ostr.length) vv += ostr.charAt(jj++);\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t}\n\t}\n\tfor(i=0; i<out.length; ++i) if(out[i] != null && 'n?'.indexOf(out[i].t)>-1) {\n\t\tmyv = (flen >1 && v < 0 && i>0 && out[i-1].v === \"-\" ? -v:v);\n\t\tout[i].v = write_num(out[i].t, out[i].v, myv);\n\t\tout[i].t = 't';\n\t}\n\tvar retval = \"\";\n\tfor(i=0; i !== out.length; ++i) if(out[i] != null) retval += out[i].v;\n\treturn retval;\n}\n\nvar cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\nfunction chkcond(v, rr) {\n\tif(rr == null) return false;\n\tvar thresh = parseFloat(rr[2]);\n\tswitch(rr[1]) {\n\t\tcase \"=\":  if(v == thresh) return true; break;\n\t\tcase \">\":  if(v >  thresh) return true; break;\n\t\tcase \"<\":  if(v <  thresh) return true; break;\n\t\tcase \"<>\": if(v != thresh) return true; break;\n\t\tcase \">=\": if(v >= thresh) return true; break;\n\t\tcase \"<=\": if(v <= thresh) return true; break;\n\t}\n\treturn false;\n}\nfunction choose_fmt(f/*:string*/, v/*:any*/) {\n\tvar fmt = SSF_split_fmt(f);\n\tvar l = fmt.length, lat = fmt[l-1].indexOf(\"@\");\n\tif(l<4 && lat>-1) --l;\n\tif(fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\n\tif(typeof v !== \"number\") return [4, fmt.length === 4 || lat>-1?fmt[fmt.length-1]:\"@\"];\n\t/* NOTE: most spreadsheet software do not support NaN or infinities */\n\tif(typeof v === \"number\" && !isFinite(v)) v = 0;\n\tswitch(fmt.length) {\n\t\tcase 1: fmt = lat>-1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\n\t\tcase 2: fmt = lat>-1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\n\t\tcase 3: fmt = lat>-1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\n\t\tcase 4: break;\n\t}\n\tvar ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n\tif(fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\tif(fmt[0].match(/\\[[=<>]/) != null || fmt[1].match(/\\[[=<>]/) != null) {\n\t\tvar m1 = fmt[0].match(cfregex2);\n\t\tvar m2 = fmt[1].match(cfregex2);\n\t\treturn chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n\t}\n\treturn [l, ff];\n}\nfunction SSF_format(fmt/*:string|number*/,v/*:any*/,o/*:?any*/) {\n\tif(o == null) o = {};\n\tvar sfmt = \"\";\n\tswitch(typeof fmt) {\n\t\tcase \"string\":\n\t\t\tif(fmt == \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = fmt;\n\t\t\tbreak;\n\t\tcase \"number\":\n\t\t\tif(fmt == 14 && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = (o.table != null ? (o.table/*:any*/) : table_fmt)[fmt];\n\t\t\tif(sfmt == null) sfmt = (o.table && o.table[SSF_default_map[fmt]]) || table_fmt[SSF_default_map[fmt]];\n\t\t\tif(sfmt == null) sfmt = SSF_default_str[fmt] || \"General\";\n\t\t\tbreak;\n\t}\n\tif(SSF_isgeneral(sfmt,0)) return SSF_general(v, o);\n\tif(v instanceof Date) v = datenum(v, o.date1904);\n\tvar f = choose_fmt(sfmt, v);\n\tif(SSF_isgeneral(f[1])) return SSF_general(v, o);\n\tif(v === true) v = \"TRUE\"; else if(v === false) v = \"FALSE\";\n\telse if(v === \"\" || v == null) return \"\";\n\telse if(isNaN(v) && f[1].indexOf(\"0\") > -1) return \"#NUM!\";\n\telse if(!isFinite(v) && f[1].indexOf(\"0\") > -1) return \"#DIV/0!\";\n\treturn eval_fmt(f[1], v, o, f[0]);\n}\nfunction SSF_load(fmt/*:string*/, idx/*:?number*/)/*:number*/ {\n\tif(typeof idx != 'number') {\n\t\tidx = +idx || -1;\n/*::if(typeof idx != 'number') return 0x188; */\n\t\tfor(var i = 0; i < 0x0188; ++i) {\n/*::if(typeof idx != 'number') return 0x188; */\n\t\t\tif(table_fmt[i] == undefined) { if(idx < 0) idx = i; continue; }\n\t\t\tif(table_fmt[i] == fmt) { idx = i; break; }\n\t\t}\n/*::if(typeof idx != 'number') return 0x188; */\n\t\tif(idx < 0) idx = 0x187;\n\t}\n/*::if(typeof idx != 'number') return 0x188; */\n\ttable_fmt[idx] = fmt;\n\treturn idx;\n}\nfunction SSF_load_table(tbl/*:SSFTable*/)/*:void*/ {\n\tfor(var i=0; i!=0x0188; ++i)\n\t\tif(tbl[i] !== undefined) SSF_load(tbl[i], i);\n}\n\nfunction make_ssf() {\n\ttable_fmt = SSF_init_table();\n}\n\nvar SSF = {\n\tformat: SSF_format,\n\tload: SSF_load,\n\t_table: table_fmt,\n\tload_table: SSF_load_table,\n\tparse_date_code: SSF_parse_date_code,\n\tis_date: fmt_is_date,\n\tget_table: function get_table() { return SSF._table = table_fmt; }\n};\n\nvar SSFImplicit/*{[number]:string}*/ = ({\n\t\"5\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t\"6\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t\"7\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t\"8\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"23\": 'General', \"24\": 'General', \"25\": 'General', \"26\": 'General',\n\t\"27\": 'm/d/yy', \"28\": 'm/d/yy', \"29\": 'm/d/yy', \"30\": 'm/d/yy', \"31\": 'm/d/yy',\n\t\"32\": 'h:mm:ss', \"33\": 'h:mm:ss', \"34\": 'h:mm:ss', \"35\": 'h:mm:ss',\n\t\"36\": 'm/d/yy',\n\t\"41\": '_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)',\n\t\"42\": '_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)',\n\t\"43\": '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)',\n\t\"44\": '_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)',\n\t\"50\": 'm/d/yy', \"51\": 'm/d/yy', \"52\": 'm/d/yy', \"53\": 'm/d/yy', \"54\": 'm/d/yy',\n\t\"55\": 'm/d/yy', \"56\": 'm/d/yy', \"57\": 'm/d/yy', \"58\": 'm/d/yy',\n\t\"59\": '0',\n\t\"60\": '0.00',\n\t\"61\": '#,##0',\n\t\"62\": '#,##0.00',\n\t\"63\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t\"64\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t\"65\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t\"66\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"67\": '0%',\n\t\"68\": '0.00%',\n\t\"69\": '# ?/?',\n\t\"70\": '# ??/??',\n\t\"71\": 'm/d/yy',\n\t\"72\": 'm/d/yy',\n\t\"73\": 'd-mmm-yy',\n\t\"74\": 'd-mmm',\n\t\"75\": 'mmm-yy',\n\t\"76\": 'h:mm',\n\t\"77\": 'h:mm:ss',\n\t\"78\": 'm/d/yy h:mm',\n\t\"79\": 'mm:ss',\n\t\"80\": '[h]:mm:ss',\n\t\"81\": 'mmss.0'\n}/*:any*/);\n\n/* dateNF parse TODO: move to SSF */\nvar dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;\nfunction dateNF_regex(dateNF/*:string|number*/)/*:RegExp*/ {\n\tvar fmt = typeof dateNF == \"number\" ? table_fmt[dateNF] : dateNF;\n\tfmt = fmt.replace(dateNFregex, \"(\\\\d+)\");\n\tdateNFregex.lastIndex = 0;\n\treturn new RegExp(\"^\" + fmt + \"$\");\n}\nfunction dateNF_fix(str/*:string*/, dateNF/*:string*/, match/*:Array<string>*/)/*:string*/ {\n\tvar Y = -1, m = -1, d = -1, H = -1, M = -1, S = -1;\n\t(dateNF.match(dateNFregex)||[]).forEach(function(n, i) {\n\t\tvar v = parseInt(match[i+1], 10);\n\t\tswitch(n.toLowerCase().charAt(0)) {\n\t\t\tcase 'y': Y = v; break; case 'd': d = v; break;\n\t\t\tcase 'h': H = v; break; case 's': S = v; break;\n\t\t\tcase 'm': if(H >= 0) M = v; else m = v; break;\n\t\t}\n\t});\n\tdateNFregex.lastIndex = 0;\n\tif(S >= 0 && M == -1 && m >= 0) { M = m; m = -1; }\n\tvar datestr = ((\"\" + (Y>=0?Y: new Date().getFullYear())).slice(-4) + \"-\" + (\"00\" + (m>=1?m:1)).slice(-2) + \"-\" + (\"00\" + (d>=1?d:1)).slice(-2));\n\tif(datestr.length == 7) datestr = \"0\" + datestr;\n\tif(datestr.length == 8) datestr = \"20\" + datestr;\n\tvar timestr = ((\"00\" + (H>=0?H:0)).slice(-2) + \":\" + (\"00\" + (M>=0?M:0)).slice(-2) + \":\" + (\"00\" + (S>=0?S:0)).slice(-2));\n\tif(H == -1 && M == -1 && S == -1) return datestr;\n\tif(Y == -1 && m == -1 && d == -1) return timestr;\n\treturn datestr + \"T\" + timestr;\n}\n\n/* table of bad formats written by third-party tools */\nvar bad_formats = {\n\t\"d.m\": \"d\\\\.m\" // Issue #2571 Google Sheets writes invalid format 'd.m', correct format is 'd\".\"m' or 'd\\\\.m'\n};\n\nfunction SSF__load(fmt, idx) {\n\treturn SSF_load(bad_formats[fmt] || fmt, idx);\n}\n\n/*::\ndeclare var ReadShift:any;\ndeclare var CheckField:any;\ndeclare var prep_blob:any;\ndeclare var __readUInt32LE:any;\ndeclare var __readInt32LE:any;\ndeclare var __toBuffer:any;\ndeclare var __utf16le:any;\ndeclare var bconcat:any;\ndeclare var s2a:any;\ndeclare var chr0:any;\ndeclare var chr1:any;\ndeclare var has_buf:boolean;\ndeclare var new_buf:any;\ndeclare var new_raw_buf:any;\ndeclare var new_unsafe_buf:any;\ndeclare var Buffer_from:any;\n*/\n/* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint eqnull:true */\n/*exported CFB */\n/*global Uint8Array:false, Uint16Array:false */\n\n/*::\ntype SectorEntry = {\n\tname?:string;\n\tnodes?:Array<number>;\n\tdata:RawBytes;\n};\ntype SectorList = {\n\t[k:string|number]:SectorEntry;\n\tname:?string;\n\tfat_addrs:Array<number>;\n\tssz:number;\n}\ntype CFBFiles = {[n:string]:CFBEntry};\n*/\n/* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported CRC32 */\nvar CRC32 = /*#__PURE__*/(function() {\nvar CRC32 = {};\nCRC32.version = '1.2.0';\n/*::\ntype CRC32TableType = Array<number> | Int32Array;\n*/\n/*global Int32Array */\nfunction signed_crc_table()/*:any*/ {\n\tvar c = 0, table/*:Array<number>*/ = new Array(256);\n\n\tfor(var n =0; n != 256; ++n){\n\t\tc = n;\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\ttable[n] = c;\n\t}\n\n\treturn typeof Int32Array !== 'undefined' ? new Int32Array(table) : table;\n}\n\nvar T0 = signed_crc_table();\nfunction slice_by_16_tables(T) {\n\tvar c = 0, v = 0, n = 0, table/*:Array<number>*/ = typeof Int32Array !== 'undefined' ? new Int32Array(4096) : new Array(4096) ;\n\n\tfor(n = 0; n != 256; ++n) table[n] = T[n];\n\tfor(n = 0; n != 256; ++n) {\n\t\tv = T[n];\n\t\tfor(c = 256 + n; c < 4096; c += 256) v = table[c] = (v >>> 8) ^ T[v & 0xFF];\n\t}\n\tvar out = [];\n\tfor(n = 1; n != 16; ++n) out[n - 1] = typeof Int32Array !== 'undefined' && typeof table.subarray == \"function\" ? table.subarray(n * 256, n * 256 + 256) : table.slice(n * 256, n * 256 + 256);\n\treturn out;\n}\nvar TT = slice_by_16_tables(T0);\nvar T1 = TT[0],  T2 = TT[1],  T3 = TT[2],  T4 = TT[3],  T5 = TT[4];\nvar T6 = TT[5],  T7 = TT[6],  T8 = TT[7],  T9 = TT[8],  Ta = TT[9];\nvar Tb = TT[10], Tc = TT[11], Td = TT[12], Te = TT[13], Tf = TT[14];\nfunction crc32_bstr(bstr/*:string*/, seed/*:?number*/)/*:number*/ {\n\tvar C = seed/*:: ? 0 : 0 */ ^ -1;\n\tfor(var i = 0, L = bstr.length; i < L;) C = (C>>>8) ^ T0[(C^bstr.charCodeAt(i++))&0xFF];\n\treturn ~C;\n}\n\nfunction crc32_buf(B/*:Uint8Array|Array<number>*/, seed/*:number*/)/*:number*/ {\n\tvar C = seed/*:: ? 0 : 0 */ ^ -1, L = B.length - 15, i = 0;\n\tfor(; i < L;) C =\n\t\tTf[B[i++] ^ (C & 255)] ^\n\t\tTe[B[i++] ^ ((C >> 8) & 255)] ^\n\t\tTd[B[i++] ^ ((C >> 16) & 255)] ^\n\t\tTc[B[i++] ^ (C >>> 24)] ^\n\t\tTb[B[i++]] ^ Ta[B[i++]] ^ T9[B[i++]] ^ T8[B[i++]] ^\n\t\tT7[B[i++]] ^ T6[B[i++]] ^ T5[B[i++]] ^ T4[B[i++]] ^\n\t\tT3[B[i++]] ^ T2[B[i++]] ^ T1[B[i++]] ^ T0[B[i++]];\n\tL += 15;\n\twhile(i < L) C = (C>>>8) ^ T0[(C^B[i++])&0xFF];\n\treturn ~C;\n}\n\nfunction crc32_str(str/*:string*/, seed/*:number*/)/*:number*/ {\n\tvar C = seed ^ -1;\n\tfor(var i = 0, L = str.length, c = 0, d = 0; i < L;) {\n\t\tc = str.charCodeAt(i++);\n\t\tif(c < 0x80) {\n\t\t\tC = (C>>>8) ^ T0[(C^c)&0xFF];\n\t\t} else if(c < 0x800) {\n\t\t\tC = (C>>>8) ^ T0[(C ^ (192|((c>>6)&31)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(c&63)))&0xFF];\n\t\t} else if(c >= 0xD800 && c < 0xE000) {\n\t\t\tc = (c&1023)+64; d = str.charCodeAt(i++)&1023;\n\t\t\tC = (C>>>8) ^ T0[(C ^ (240|((c>>8)&7)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((c>>2)&63)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((d>>6)&15)|((c&3)<<4)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(d&63)))&0xFF];\n\t\t} else {\n\t\t\tC = (C>>>8) ^ T0[(C ^ (224|((c>>12)&15)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((c>>6)&63)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(c&63)))&0xFF];\n\t\t}\n\t}\n\treturn ~C;\n}\nCRC32.table = T0;\nCRC32.bstr = crc32_bstr;\nCRC32.buf = crc32_buf;\nCRC32.str = crc32_str;\nreturn CRC32;\n})();\n/* [MS-CFB] v20171201 */\nvar CFB = /*#__PURE__*/(function _CFB(){\nvar exports/*:CFBModule*/ = /*::(*/{}/*:: :any)*/;\nexports.version = '1.2.2';\n/* [MS-CFB] 2.6.4 */\nfunction namecmp(l/*:string*/, r/*:string*/)/*:number*/ {\n\tvar L = l.split(\"/\"), R = r.split(\"/\");\n\tfor(var i = 0, c = 0, Z = Math.min(L.length, R.length); i < Z; ++i) {\n\t\tif((c = L[i].length - R[i].length)) return c;\n\t\tif(L[i] != R[i]) return L[i] < R[i] ? -1 : 1;\n\t}\n\treturn L.length - R.length;\n}\nfunction dirname(p/*:string*/)/*:string*/ {\n\tif(p.charAt(p.length - 1) == \"/\") return (p.slice(0,-1).indexOf(\"/\") === -1) ? p : dirname(p.slice(0, -1));\n\tvar c = p.lastIndexOf(\"/\");\n\treturn (c === -1) ? p : p.slice(0, c+1);\n}\n\nfunction filename(p/*:string*/)/*:string*/ {\n\tif(p.charAt(p.length - 1) == \"/\") return filename(p.slice(0, -1));\n\tvar c = p.lastIndexOf(\"/\");\n\treturn (c === -1) ? p : p.slice(c+1);\n}\n/* -------------------------------------------------------------------------- */\n/* DOS Date format:\n   high|YYYYYYYm.mmmddddd.HHHHHMMM.MMMSSSSS|low\n   add 1980 to stored year\n   stored second should be doubled\n*/\n\n/* write JS date to buf as a DOS date */\nfunction write_dos_date(buf/*:CFBlob*/, date/*:Date|string*/) {\n\tif(typeof date === \"string\") date = new Date(date);\n\tvar hms/*:number*/ = date.getHours();\n\thms = hms << 6 | date.getMinutes();\n\thms = hms << 5 | (date.getSeconds()>>>1);\n\tbuf.write_shift(2, hms);\n\tvar ymd/*:number*/ = (date.getFullYear() - 1980);\n\tymd = ymd << 4 | (date.getMonth()+1);\n\tymd = ymd << 5 | date.getDate();\n\tbuf.write_shift(2, ymd);\n}\n\n/* read four bytes from buf and interpret as a DOS date */\nfunction parse_dos_date(buf/*:CFBlob*/)/*:Date*/ {\n\tvar hms = buf.read_shift(2) & 0xFFFF;\n\tvar ymd = buf.read_shift(2) & 0xFFFF;\n\tvar val = new Date();\n\tvar d = ymd & 0x1F; ymd >>>= 5;\n\tvar m = ymd & 0x0F; ymd >>>= 4;\n\tval.setMilliseconds(0);\n\tval.setFullYear(ymd + 1980);\n\tval.setMonth(m-1);\n\tval.setDate(d);\n\tvar S = hms & 0x1F; hms >>>= 5;\n\tvar M = hms & 0x3F; hms >>>= 6;\n\tval.setHours(hms);\n\tval.setMinutes(M);\n\tval.setSeconds(S<<1);\n\treturn val;\n}\nfunction parse_extra_field(blob/*:CFBlob*/)/*:any*/ {\n\tprep_blob(blob, 0);\n\tvar o = /*::(*/{}/*:: :any)*/;\n\tvar flags = 0;\n\twhile(blob.l <= blob.length - 4) {\n\t\tvar type = blob.read_shift(2);\n\t\tvar sz = blob.read_shift(2), tgt = blob.l + sz;\n\t\tvar p = {};\n\t\tswitch(type) {\n\t\t\t/* UNIX-style Timestamps */\n\t\t\tcase 0x5455: {\n\t\t\t\tflags = blob.read_shift(1);\n\t\t\t\tif(flags & 1) p.mtime = blob.read_shift(4);\n\t\t\t\t/* for some reason, CD flag corresponds to LFH */\n\t\t\t\tif(sz > 5) {\n\t\t\t\t\tif(flags & 2) p.atime = blob.read_shift(4);\n\t\t\t\t\tif(flags & 4) p.ctime = blob.read_shift(4);\n\t\t\t\t}\n\t\t\t\tif(p.mtime) p.mt = new Date(p.mtime*1000);\n\t\t\t} break;\n\t\t\t/* ZIP64 Extended Information Field */\n\t\t\tcase 0x0001: {\n\t\t\t\tvar sz1 = blob.read_shift(4), sz2 = blob.read_shift(4);\n\t\t\t\tp.usz = (sz2 * Math.pow(2,32) + sz1);\n\t\t\t\tsz1 = blob.read_shift(4); sz2 = blob.read_shift(4);\n\t\t\t\tp.csz = (sz2 * Math.pow(2,32) + sz1);\n\t\t\t\t// NOTE: volume fields are skipped\n\t\t\t} break;\n\t\t}\n\t\tblob.l = tgt;\n\t\to[type] = p;\n\t}\n\treturn o;\n}\nvar fs/*:: = require('fs'); */;\nfunction get_fs() { return fs || (fs = _fs); }\nfunction parse(file/*:RawBytes*/, options/*:CFBReadOpts*/)/*:CFBContainer*/ {\nif(file[0] == 0x50 && file[1] == 0x4b) return parse_zip(file, options);\nif((file[0] | 0x20) == 0x6d && (file[1]|0x20) == 0x69) return parse_mad(file, options);\nif(file.length < 512) throw new Error(\"CFB file size \" + file.length + \" < 512\");\nvar mver = 3;\nvar ssz = 512;\nvar nmfs = 0; // number of mini FAT sectors\nvar difat_sec_cnt = 0;\nvar dir_start = 0;\nvar minifat_start = 0;\nvar difat_start = 0;\n\nvar fat_addrs/*:Array<number>*/ = []; // locations of FAT sectors\n\n/* [MS-CFB] 2.2 Compound File Header */\nvar blob/*:CFBlob*/ = /*::(*/file.slice(0,512)/*:: :any)*/;\nprep_blob(blob, 0);\n\n/* major version */\nvar mv = check_get_mver(blob);\nmver = mv[0];\nswitch(mver) {\n\tcase 3: ssz = 512; break; case 4: ssz = 4096; break;\n\tcase 0: if(mv[1] == 0) return parse_zip(file, options);\n\t/* falls through */\n\tdefault: throw new Error(\"Major Version: Expected 3 or 4 saw \" + mver);\n}\n\n/* reprocess header */\nif(ssz !== 512) { blob = /*::(*/file.slice(0,ssz)/*:: :any)*/; prep_blob(blob, 28 /* blob.l */); }\n/* Save header for final object */\nvar header/*:RawBytes*/ = file.slice(0,ssz);\n\ncheck_shifts(blob, mver);\n\n// Number of Directory Sectors\nvar dir_cnt/*:number*/ = blob.read_shift(4, 'i');\nif(mver === 3 && dir_cnt !== 0) throw new Error('# Directory Sectors: Expected 0 saw ' + dir_cnt);\n\n// Number of FAT Sectors\nblob.l += 4;\n\n// First Directory Sector Location\ndir_start = blob.read_shift(4, 'i');\n\n// Transaction Signature\nblob.l += 4;\n\n// Mini Stream Cutoff Size\nblob.chk('00100000', 'Mini Stream Cutoff Size: ');\n\n// First Mini FAT Sector Location\nminifat_start = blob.read_shift(4, 'i');\n\n// Number of Mini FAT Sectors\nnmfs = blob.read_shift(4, 'i');\n\n// First DIFAT sector location\ndifat_start = blob.read_shift(4, 'i');\n\n// Number of DIFAT Sectors\ndifat_sec_cnt = blob.read_shift(4, 'i');\n\n// Grab FAT Sector Locations\nfor(var q = -1, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\n\tq = blob.read_shift(4, 'i');\n\tif(q<0) break;\n\tfat_addrs[j] = q;\n}\n\n/** Break the file up into sectors */\nvar sectors/*:Array<RawBytes>*/ = sectorify(file, ssz);\n\nsleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);\n\n/** Chains */\nvar sector_list/*:SectorList*/ = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n\nif(dir_start < sector_list.length) sector_list[dir_start].name = \"!Directory\";\nif(nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\nsector_list[fat_addrs[0]].name = \"!FAT\";\nsector_list.fat_addrs = fat_addrs;\nsector_list.ssz = ssz;\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nvar files/*:CFBFiles*/ = {}, Paths/*:Array<string>*/ = [], FileIndex/*:CFBFileIndex*/ = [], FullPaths/*:Array<string>*/ = [];\nread_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);\n\nbuild_full_paths(FileIndex, FullPaths, Paths);\nPaths.shift();\n\nvar o = {\n\tFileIndex: FileIndex,\n\tFullPaths: FullPaths\n};\n\n// $FlowIgnore\nif(options && options.raw) o.raw = {header: header, sectors: sectors};\nreturn o;\n} // parse\n\n/* [MS-CFB] 2.2 Compound File Header -- read up to major version */\nfunction check_get_mver(blob/*:CFBlob*/)/*:[number, number]*/ {\n\tif(blob[blob.l] == 0x50 && blob[blob.l + 1] == 0x4b) return [0, 0];\n\t// header signature 8\n\tblob.chk(HEADER_SIGNATURE, 'Header Signature: ');\n\n\t// clsid 16\n\t//blob.chk(HEADER_CLSID, 'CLSID: ');\n\tblob.l += 16;\n\n\t// minor version 2\n\tvar mver/*:number*/ = blob.read_shift(2, 'u');\n\n\treturn [blob.read_shift(2,'u'), mver];\n}\nfunction check_shifts(blob/*:CFBlob*/, mver/*:number*/)/*:void*/ {\n\tvar shift = 0x09;\n\n\t// Byte Order\n\t//blob.chk('feff', 'Byte Order: '); // note: some writers put 0xffff\n\tblob.l += 2;\n\n\t// Sector Shift\n\tswitch((shift = blob.read_shift(2))) {\n\t\tcase 0x09: if(mver != 3) throw new Error('Sector Shift: Expected 9 saw ' + shift); break;\n\t\tcase 0x0c: if(mver != 4) throw new Error('Sector Shift: Expected 12 saw ' + shift); break;\n\t\tdefault: throw new Error('Sector Shift: Expected 9 or 12 saw ' + shift);\n\t}\n\n\t// Mini Sector Shift\n\tblob.chk('0600', 'Mini Sector Shift: ');\n\n\t// Reserved\n\tblob.chk('000000000000', 'Reserved: ');\n}\n\n/** Break the file up into sectors */\nfunction sectorify(file/*:RawBytes*/, ssz/*:number*/)/*:Array<RawBytes>*/ {\n\tvar nsectors = Math.ceil(file.length/ssz)-1;\n\tvar sectors/*:Array<RawBytes>*/ = [];\n\tfor(var i=1; i < nsectors; ++i) sectors[i-1] = file.slice(i*ssz,(i+1)*ssz);\n\tsectors[nsectors-1] = file.slice(nsectors*ssz);\n\treturn sectors;\n}\n\n/* [MS-CFB] 2.6.4 Red-Black Tree */\nfunction build_full_paths(FI/*:CFBFileIndex*/, FP/*:Array<string>*/, Paths/*:Array<string>*/)/*:void*/ {\n\tvar i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\n\tvar dad/*:Array<number>*/ = [], q/*:Array<number>*/ = [];\n\n\tfor(; i < pl; ++i) { dad[i]=q[i]=i; FP[i]=Paths[i]; }\n\n\tfor(; j < q.length; ++j) {\n\t\ti = q[j];\n\t\tL = FI[i].L; R = FI[i].R; C = FI[i].C;\n\t\tif(dad[i] === i) {\n\t\t\tif(L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\n\t\t\tif(R !== -1 && dad[R] !== R) dad[i] = dad[R];\n\t\t}\n\t\tif(C !== -1 /*NOSTREAM*/) dad[C] = i;\n\t\tif(L !== -1 && i != dad[i]) { dad[L] = dad[i]; if(q.lastIndexOf(L) < j) q.push(L); }\n\t\tif(R !== -1 && i != dad[i]) { dad[R] = dad[i]; if(q.lastIndexOf(R) < j) q.push(R); }\n\t}\n\tfor(i=1; i < pl; ++i) if(dad[i] === i) {\n\t\tif(R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\n\t\telse if(L !== -1 && dad[L] !== L) dad[i] = dad[L];\n\t}\n\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type === 0 /* unknown */) continue;\n\t\tj = i;\n\t\tif(j != dad[j]) do {\n\t\t\tj = dad[j];\n\t\t\tFP[i] = FP[j] + \"/\" + FP[i];\n\t\t} while (j !== 0 && -1 !== dad[j] && j != dad[j]);\n\t\tdad[i] = -1;\n\t}\n\n\tFP[0] += \"/\";\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type !== 2 /* stream */) FP[i] += \"/\";\n\t}\n}\n\nfunction get_mfat_entry(entry/*:CFBEntry*/, payload/*:RawBytes*/, mini/*:?RawBytes*/)/*:CFBlob*/ {\n\tvar start = entry.start, size = entry.size;\n\t//return (payload.slice(start*MSSZ, start*MSSZ + size)/*:any*/);\n\tvar o = [];\n\tvar idx = start;\n\twhile(mini && size > 0 && idx >= 0) {\n\t\to.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));\n\t\tsize -= MSSZ;\n\t\tidx = __readInt32LE(mini, idx * 4);\n\t}\n\tif(o.length === 0) return (new_buf(0)/*:any*/);\n\treturn (bconcat(o).slice(0, entry.size)/*:any*/);\n}\n\n/** Chase down the rest of the DIFAT chain to build a comprehensive list\n    DIFAT chains by storing the next sector number as the last 32 bits */\nfunction sleuth_fat(idx/*:number*/, cnt/*:number*/, sectors/*:Array<RawBytes>*/, ssz/*:number*/, fat_addrs)/*:void*/ {\n\tvar q/*:number*/ = ENDOFCHAIN;\n\tif(idx === ENDOFCHAIN) {\n\t\tif(cnt !== 0) throw new Error(\"DIFAT chain shorter than expected\");\n\t} else if(idx !== -1 /*FREESECT*/) {\n\t\tvar sector = sectors[idx], m = (ssz>>>2)-1;\n\t\tif(!sector) return;\n\t\tfor(var i = 0; i < m; ++i) {\n\t\t\tif((q = __readInt32LE(sector,i*4)) === ENDOFCHAIN) break;\n\t\t\tfat_addrs.push(q);\n\t\t}\n\t\tif(cnt >= 1) sleuth_fat(__readInt32LE(sector,ssz-4),cnt - 1, sectors, ssz, fat_addrs);\n\t}\n}\n\n/** Follow the linked list of sectors for a given starting point */\nfunction get_sector_list(sectors/*:Array<RawBytes>*/, start/*:number*/, fat_addrs/*:Array<number>*/, ssz/*:number*/, chkd/*:?Array<boolean>*/)/*:SectorEntry*/ {\n\tvar buf/*:Array<number>*/ = [], buf_chain/*:Array<any>*/ = [];\n\tif(!chkd) chkd = [];\n\tvar modulus = ssz - 1, j = 0, jj = 0;\n\tfor(j=start; j>=0;) {\n\t\tchkd[j] = true;\n\t\tbuf[buf.length] = j;\n\t\tbuf_chain.push(sectors[j]);\n\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\tjj = ((j*4) & modulus);\n\t\tif(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\n\t\tif(!sectors[addr]) break;\n\t\tj = __readInt32LE(sectors[addr], jj);\n\t}\n\treturn {nodes: buf, data:__toBuffer([buf_chain])};\n}\n\n/** Chase down the sector linked lists */\nfunction make_sector_list(sectors/*:Array<RawBytes>*/, dir_start/*:number*/, fat_addrs/*:Array<number>*/, ssz/*:number*/)/*:SectorList*/ {\n\tvar sl = sectors.length, sector_list/*:SectorList*/ = ([]/*:any*/);\n\tvar chkd/*:Array<boolean>*/ = [], buf/*:Array<number>*/ = [], buf_chain/*:Array<RawBytes>*/ = [];\n\tvar modulus = ssz - 1, i=0, j=0, k=0, jj=0;\n\tfor(i=0; i < sl; ++i) {\n\t\tbuf = ([]/*:Array<number>*/);\n\t\tk = (i + dir_start); if(k >= sl) k-=sl;\n\t\tif(chkd[k]) continue;\n\t\tbuf_chain = [];\n\t\tvar seen = [];\n\t\tfor(j=k; j>=0;) {\n\t\t\tseen[j] = true;\n\t\t\tchkd[j] = true;\n\t\t\tbuf[buf.length] = j;\n\t\t\tbuf_chain.push(sectors[j]);\n\t\t\tvar addr/*:number*/ = fat_addrs[Math.floor(j*4/ssz)];\n\t\t\tjj = ((j*4) & modulus);\n\t\t\tif(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\n\t\t\tif(!sectors[addr]) break;\n\t\t\tj = __readInt32LE(sectors[addr], jj);\n\t\t\tif(seen[j]) break;\n\t\t}\n\t\tsector_list[k] = ({nodes: buf, data:__toBuffer([buf_chain])}/*:SectorEntry*/);\n\t}\n\treturn sector_list;\n}\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nfunction read_directory(dir_start/*:number*/, sector_list/*:SectorList*/, sectors/*:Array<RawBytes>*/, Paths/*:Array<string>*/, nmfs, files, FileIndex, mini) {\n\tvar minifat_store = 0, pl = (Paths.length?2:0);\n\tvar sector = sector_list[dir_start].data;\n\tvar i = 0, namelen = 0, name;\n\tfor(; i < sector.length; i+= 128) {\n\t\tvar blob/*:CFBlob*/ = /*::(*/sector.slice(i, i+128)/*:: :any)*/;\n\t\tprep_blob(blob, 64);\n\t\tnamelen = blob.read_shift(2);\n\t\tname = __utf16le(blob,0,namelen-pl);\n\t\tPaths.push(name);\n\t\tvar o/*:CFBEntry*/ = ({\n\t\t\tname:  name,\n\t\t\ttype:  blob.read_shift(1),\n\t\t\tcolor: blob.read_shift(1),\n\t\t\tL:     blob.read_shift(4, 'i'),\n\t\t\tR:     blob.read_shift(4, 'i'),\n\t\t\tC:     blob.read_shift(4, 'i'),\n\t\t\tclsid: blob.read_shift(16),\n\t\t\tstate: blob.read_shift(4, 'i'),\n\t\t\tstart: 0,\n\t\t\tsize: 0\n\t\t});\n\t\tvar ctime/*:number*/ = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(ctime !== 0) o.ct = read_date(blob, blob.l-8);\n\t\tvar mtime/*:number*/ = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(mtime !== 0) o.mt = read_date(blob, blob.l-8);\n\t\to.start = blob.read_shift(4, 'i');\n\t\to.size = blob.read_shift(4, 'i');\n\t\tif(o.size < 0 && o.start < 0) { o.size = o.type = 0; o.start = ENDOFCHAIN; o.name = \"\"; }\n\t\tif(o.type === 5) { /* root */\n\t\t\tminifat_store = o.start;\n\t\t\tif(nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n\t\t\t/*minifat_size = o.size;*/\n\t\t} else if(o.size >= 4096 /* MSCSZ */) {\n\t\t\to.storage = 'fat';\n\t\t\tif(sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n\t\t\tsector_list[o.start].name = o.name;\n\t\t\to.content = (sector_list[o.start].data.slice(0,o.size)/*:any*/);\n\t\t} else {\n\t\t\to.storage = 'minifat';\n\t\t\tif(o.size < 0) o.size = 0;\n\t\t\telse if(minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {\n\t\t\t\to.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini]||{}).data);\n\t\t\t}\n\t\t}\n\t\tif(o.content) prep_blob(o.content, 0);\n\t\tfiles[name] = o;\n\t\tFileIndex.push(o);\n\t}\n}\n\nfunction read_date(blob/*:RawBytes|CFBlob*/, offset/*:number*/)/*:Date*/ {\n\treturn new Date(( ( (__readUInt32LE(blob,offset+4)/1e7)*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7 ) - 11644473600)*1000);\n}\n\nfunction read_file(filename/*:string*/, options/*:CFBReadOpts*/) {\n\tget_fs();\n\treturn parse(fs.readFileSync(filename), options);\n}\n\nfunction read(blob/*:RawBytes|string*/, options/*:CFBReadOpts*/) {\n\tvar type = options && options.type;\n\tif(!type) {\n\t\tif(has_buf && Buffer.isBuffer(blob)) type = \"buffer\";\n\t}\n\tswitch(type || \"base64\") {\n\t\tcase \"file\": /*:: if(typeof blob !== 'string') throw \"Must pass a filename when type='file'\"; */return read_file(blob, options);\n\t\tcase \"base64\": /*:: if(typeof blob !== 'string') throw \"Must pass a base64-encoded binary string when type='file'\"; */return parse(s2a(Base64_decode(blob)), options);\n\t\tcase \"binary\": /*:: if(typeof blob !== 'string') throw \"Must pass a binary string when type='file'\"; */return parse(s2a(blob), options);\n\t}\n\treturn parse(/*::typeof blob == 'string' ? new Buffer(blob, 'utf-8') : */blob, options);\n}\n\nfunction init_cfb(cfb/*:CFBContainer*/, opts/*:?any*/)/*:void*/ {\n\tvar o = opts || {}, root = o.root || \"Root Entry\";\n\tif(!cfb.FullPaths) cfb.FullPaths = [];\n\tif(!cfb.FileIndex) cfb.FileIndex = [];\n\tif(cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error(\"inconsistent CFB structure\");\n\tif(cfb.FullPaths.length === 0) {\n\t\tcfb.FullPaths[0] = root + \"/\";\n\t\tcfb.FileIndex[0] = ({ name: root, type: 5 }/*:any*/);\n\t}\n\tif(o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;\n\tseed_cfb(cfb);\n}\nfunction seed_cfb(cfb/*:CFBContainer*/)/*:void*/ {\n\tvar nm = \"\\u0001Sh33tJ5\";\n\tif(CFB.find(cfb, \"/\" + nm)) return;\n\tvar p = new_buf(4); p[0] = 55; p[1] = p[3] = 50; p[2] = 54;\n\tcfb.FileIndex.push(({ name: nm, type: 2, content:p, size:4, L:69, R:69, C:69 }/*:any*/));\n\tcfb.FullPaths.push(cfb.FullPaths[0] + nm);\n\trebuild_cfb(cfb);\n}\nfunction rebuild_cfb(cfb/*:CFBContainer*/, f/*:?boolean*/)/*:void*/ {\n\tinit_cfb(cfb);\n\tvar gc = false, s = false;\n\tfor(var i = cfb.FullPaths.length - 1; i >= 0; --i) {\n\t\tvar _file = cfb.FileIndex[i];\n\t\tswitch(_file.type) {\n\t\t\tcase 0:\n\t\t\t\tif(s) gc = true;\n\t\t\t\telse { cfb.FileIndex.pop(); cfb.FullPaths.pop(); }\n\t\t\t\tbreak;\n\t\t\tcase 1: case 2: case 5:\n\t\t\t\ts = true;\n\t\t\t\tif(isNaN(_file.R * _file.L * _file.C)) gc = true;\n\t\t\t\tif(_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;\n\t\t\t\tbreak;\n\t\t\tdefault: gc = true; break;\n\t\t}\n\t}\n\tif(!gc && !f) return;\n\n\tvar now = new Date(1987, 1, 19), j = 0;\n\t// Track which names exist\n\tvar fullPaths = Object.create ? Object.create(null) : {};\n\tvar data/*:Array<[string, CFBEntry]>*/ = [];\n\tfor(i = 0; i < cfb.FullPaths.length; ++i) {\n\t\tfullPaths[cfb.FullPaths[i]] = true;\n\t\tif(cfb.FileIndex[i].type === 0) continue;\n\t\tdata.push([cfb.FullPaths[i], cfb.FileIndex[i]]);\n\t}\n\tfor(i = 0; i < data.length; ++i) {\n\t\tvar dad = dirname(data[i][0]);\n\t\ts = fullPaths[dad];\n\t\twhile(!s) {\n\t\t\twhile(dirname(dad) && !fullPaths[dirname(dad)]) dad = dirname(dad);\n\n\t\t\tdata.push([dad, ({\n\t\t\t\tname: filename(dad).replace(\"/\",\"\"),\n\t\t\t\ttype: 1,\n\t\t\t\tclsid: HEADER_CLSID,\n\t\t\t\tct: now, mt: now,\n\t\t\t\tcontent: null\n\t\t\t}/*:any*/)]);\n\n\t\t\t// Add name to set\n\t\t\tfullPaths[dad] = true;\n\n\t\t\tdad = dirname(data[i][0]);\n\t\t\ts = fullPaths[dad];\n\t\t}\n\t}\n\n\tdata.sort(function(x,y) { return namecmp(x[0], y[0]); });\n\tcfb.FullPaths = []; cfb.FileIndex = [];\n\tfor(i = 0; i < data.length; ++i) { cfb.FullPaths[i] = data[i][0]; cfb.FileIndex[i] = data[i][1]; }\n\tfor(i = 0; i < data.length; ++i) {\n\t\tvar elt = cfb.FileIndex[i];\n\t\tvar nm = cfb.FullPaths[i];\n\n\t\telt.name =  filename(nm).replace(\"/\",\"\");\n\t\telt.L = elt.R = elt.C = -(elt.color = 1);\n\t\telt.size = elt.content ? elt.content.length : 0;\n\t\telt.start = 0;\n\t\telt.clsid = (elt.clsid || HEADER_CLSID);\n\t\tif(i === 0) {\n\t\t\telt.C = data.length > 1 ? 1 : -1;\n\t\t\telt.size = 0;\n\t\t\telt.type = 5;\n\t\t} else if(nm.slice(-1) == \"/\") {\n\t\t\tfor(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==nm) break;\n\t\t\telt.C = j >= data.length ? -1 : j;\n\t\t\tfor(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==dirname(nm)) break;\n\t\t\telt.R = j >= data.length ? -1 : j;\n\t\t\telt.type = 1;\n\t\t} else {\n\t\t\tif(dirname(cfb.FullPaths[i+1]||\"\") == dirname(nm)) elt.R = i + 1;\n\t\t\telt.type = 2;\n\t\t}\n\t}\n\n}\n\nfunction _write(cfb/*:CFBContainer*/, options/*:CFBWriteOpts*/)/*:RawBytes|string*/ {\n\tvar _opts = options || {};\n\t/* MAD is order-sensitive, skip rebuild and sort */\n\tif(_opts.fileType == 'mad') return write_mad(cfb, _opts);\n\trebuild_cfb(cfb);\n\tswitch(_opts.fileType) {\n\t\tcase 'zip': return write_zip(cfb, _opts);\n\t\t//case 'mad': return write_mad(cfb, _opts);\n\t}\n\tvar L = (function(cfb/*:CFBContainer*/)/*:Array<number>*/{\n\t\tvar mini_size = 0, fat_size = 0;\n\t\tfor(var i = 0; i < cfb.FileIndex.length; ++i) {\n\t\t\tvar file = cfb.FileIndex[i];\n\t\t\tif(!file.content) continue;\n\t\t\tvar flen = file.content.length;\n\t\t\tif(flen > 0){\n\t\t\t\tif(flen < 0x1000) mini_size += (flen + 0x3F) >> 6;\n\t\t\t\telse fat_size += (flen + 0x01FF) >> 9;\n\t\t\t}\n\t\t}\n\t\tvar dir_cnt = (cfb.FullPaths.length +3) >> 2;\n\t\tvar mini_cnt = (mini_size + 7) >> 3;\n\t\tvar mfat_cnt = (mini_size + 0x7F) >> 7;\n\t\tvar fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;\n\t\tvar fat_cnt = (fat_base + 0x7F) >> 7;\n\t\tvar difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\n\t\twhile(((fat_base + fat_cnt + difat_cnt + 0x7F) >> 7) > fat_cnt) difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\n\t\tvar L =  [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];\n\t\tcfb.FileIndex[0].size = mini_size << 6;\n\t\tL[7] = (cfb.FileIndex[0].start=L[0]+L[1]+L[2]+L[3]+L[4]+L[5])+((L[6]+7) >> 3);\n\t\treturn L;\n\t})(cfb);\n\tvar o = new_buf(L[7] << 9);\n\tvar i = 0, T = 0;\n\t{\n\t\tfor(i = 0; i < 8; ++i) o.write_shift(1, HEADER_SIG[i]);\n\t\tfor(i = 0; i < 8; ++i) o.write_shift(2, 0);\n\t\to.write_shift(2, 0x003E);\n\t\to.write_shift(2, 0x0003);\n\t\to.write_shift(2, 0xFFFE);\n\t\to.write_shift(2, 0x0009);\n\t\to.write_shift(2, 0x0006);\n\t\tfor(i = 0; i < 3; ++i) o.write_shift(2, 0);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, L[2]);\n\t\to.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, 1<<12);\n\t\to.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1: ENDOFCHAIN);\n\t\to.write_shift(4, L[3]);\n\t\to.write_shift(-4, L[1] ? L[0] - 1: ENDOFCHAIN);\n\t\to.write_shift(4, L[1]);\n\t\tfor(i = 0; i < 109; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\t}\n\tif(L[1]) {\n\t\tfor(T = 0; T < L[1]; ++T) {\n\t\t\tfor(; i < 236 + T * 127; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\t\t\to.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);\n\t\t}\n\t}\n\tvar chainit = function(w/*:number*/)/*:void*/ {\n\t\tfor(T += w; i<T-1; ++i) o.write_shift(-4, i+1);\n\t\tif(w) { ++i; o.write_shift(-4, ENDOFCHAIN); }\n\t};\n\tT = i = 0;\n\tfor(T+=L[1]; i<T; ++i) o.write_shift(-4, consts.DIFSECT);\n\tfor(T+=L[2]; i<T; ++i) o.write_shift(-4, consts.FATSECT);\n\tchainit(L[3]);\n\tchainit(L[4]);\n\tvar j/*:number*/ = 0, flen/*:number*/ = 0;\n\tvar file/*:CFBEntry*/ = cfb.FileIndex[0];\n\tfor(; j < cfb.FileIndex.length; ++j) {\n\t\tfile = cfb.FileIndex[j];\n\t\tif(!file.content) continue;\n\t\t/*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\t\tflen = file.content.length;\n\t\tif(flen < 0x1000) continue;\n\t\tfile.start = T;\n\t\tchainit((flen + 0x01FF) >> 9);\n\t}\n\tchainit((L[6] + 7) >> 3);\n\twhile(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\tT = i = 0;\n\tfor(j = 0; j < cfb.FileIndex.length; ++j) {\n\t\tfile = cfb.FileIndex[j];\n\t\tif(!file.content) continue;\n\t\t/*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\t\tflen = file.content.length;\n\t\tif(!flen || flen >= 0x1000) continue;\n\t\tfile.start = T;\n\t\tchainit((flen + 0x3F) >> 6);\n\t}\n\twhile(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\tfor(i = 0; i < L[4]<<2; ++i) {\n\t\tvar nm = cfb.FullPaths[i];\n\t\tif(!nm || nm.length === 0) {\n\t\t\tfor(j = 0; j < 17; ++j) o.write_shift(4, 0);\n\t\t\tfor(j = 0; j < 3; ++j) o.write_shift(4, -1);\n\t\t\tfor(j = 0; j < 12; ++j) o.write_shift(4, 0);\n\t\t\tcontinue;\n\t\t}\n\t\tfile = cfb.FileIndex[i];\n\t\tif(i === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;\n\t\tvar _nm/*:string*/ = (i === 0 && _opts.root) || file.name;\n\t\tif(_nm.length > 31) {\n\t\t\tconsole.error(\"Name \" + _nm + \" will be truncated to \" + _nm.slice(0,31));\n\t\t\t_nm = _nm.slice(0, 31);\n\t\t}\n\t\tflen = 2*(_nm.length+1);\n\t\to.write_shift(64, _nm, \"utf16le\");\n\t\to.write_shift(2, flen);\n\t\to.write_shift(1, file.type);\n\t\to.write_shift(1, file.color);\n\t\to.write_shift(-4, file.L);\n\t\to.write_shift(-4, file.R);\n\t\to.write_shift(-4, file.C);\n\t\tif(!file.clsid) for(j = 0; j < 4; ++j) o.write_shift(4, 0);\n\t\telse o.write_shift(16, file.clsid, \"hex\");\n\t\to.write_shift(4, file.state || 0);\n\t\to.write_shift(4, 0); o.write_shift(4, 0);\n\t\to.write_shift(4, 0); o.write_shift(4, 0);\n\t\to.write_shift(4, file.start);\n\t\to.write_shift(4, file.size); o.write_shift(4, 0);\n\t}\n\tfor(i = 1; i < cfb.FileIndex.length; ++i) {\n\t\tfile = cfb.FileIndex[i];\n\t\t/*:: if(!file.content) throw new Error(\"unreachable\"); */\n\t\tif(file.size >= 0x1000) {\n\t\t\to.l = (file.start+1) << 9;\n\t\t\tif (has_buf && Buffer.isBuffer(file.content)) {\n\t\t\t\tfile.content.copy(o, o.l, 0, file.size);\n\t\t\t\t// o is a 0-filled Buffer so just set next offset\n\t\t\t\to.l += (file.size + 511) & -512;\n\t\t\t} else {\n\t\t\t\tfor(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\t\t\t\tfor(; j & 0x1FF; ++j) o.write_shift(1, 0);\n\t\t\t}\n\t\t}\n\t}\n\tfor(i = 1; i < cfb.FileIndex.length; ++i) {\n\t\tfile = cfb.FileIndex[i];\n\t\t/*:: if(!file.content) throw new Error(\"unreachable\"); */\n\t\tif(file.size > 0 && file.size < 0x1000) {\n\t\t\tif (has_buf && Buffer.isBuffer(file.content)) {\n\t\t\t\tfile.content.copy(o, o.l, 0, file.size);\n\t\t\t\t// o is a 0-filled Buffer so just set next offset\n\t\t\t\to.l += (file.size + 63) & -64;\n\t\t\t} else {\n\t\t\t\tfor(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\t\t\t\tfor(; j & 0x3F; ++j) o.write_shift(1, 0);\n\t\t\t}\n\t\t}\n\t}\n\tif (has_buf) {\n\t\to.l = o.length;\n\t} else {\n\t\t// When using Buffer, already 0-filled\n\t\twhile(o.l < o.length) o.write_shift(1, 0);\n\t}\n\treturn o;\n}\n/* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\nfunction find(cfb/*:CFBContainer*/, path/*:string*/)/*:?CFBEntry*/ {\n\tvar UCFullPaths/*:Array<string>*/ = cfb.FullPaths.map(function(x) { return x.toUpperCase(); });\n\tvar UCPaths/*:Array<string>*/ = UCFullPaths.map(function(x) { var y = x.split(\"/\"); return y[y.length - (x.slice(-1) == \"/\" ? 2 : 1)]; });\n\tvar k/*:boolean*/ = false;\n\tif(path.charCodeAt(0) === 47 /* \"/\" */) { k = true; path = UCFullPaths[0].slice(0, -1) + path; }\n\telse k = path.indexOf(\"/\") !== -1;\n\tvar UCPath/*:string*/ = path.toUpperCase();\n\tvar w/*:number*/ = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n\tif(w !== -1) return cfb.FileIndex[w];\n\n\tvar m = !UCPath.match(chr1);\n\tUCPath = UCPath.replace(chr0,'');\n\tif(m) UCPath = UCPath.replace(chr1,'!');\n\tfor(w = 0; w < UCFullPaths.length; ++w) {\n\t\tif((m ? UCFullPaths[w].replace(chr1,'!') : UCFullPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\n\t\tif((m ? UCPaths[w].replace(chr1,'!') : UCPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\n\t}\n\treturn null;\n}\n/** CFB Constants */\nvar MSSZ = 64; /* Mini Sector Size = 1<<6 */\n//var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n/* 2.1 Compound File Sector Numbers and Types */\nvar ENDOFCHAIN = -2;\n/* 2.2 Compound File Header */\nvar HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\nvar HEADER_SIG = [0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1];\nvar HEADER_CLSID = '00000000000000000000000000000000';\nvar consts = {\n\t/* 2.1 Compund File Sector Numbers and Types */\n\tMAXREGSECT: -6,\n\tDIFSECT: -4,\n\tFATSECT: -3,\n\tENDOFCHAIN: ENDOFCHAIN,\n\tFREESECT: -1,\n\t/* 2.2 Compound File Header */\n\tHEADER_SIGNATURE: HEADER_SIGNATURE,\n\tHEADER_MINOR_VERSION: '3e00',\n\tMAXREGSID: -6,\n\tNOSTREAM: -1,\n\tHEADER_CLSID: HEADER_CLSID,\n\t/* 2.6.1 Compound File Directory Entry */\n\tEntryTypes: ['unknown','storage','stream','lockbytes','property','root']\n};\n\nfunction write_file(cfb/*:CFBContainer*/, filename/*:string*/, options/*:CFBWriteOpts*/)/*:void*/ {\n\tget_fs();\n\tvar o = _write(cfb, options);\n\t/*:: if(typeof Buffer == 'undefined' || !Buffer.isBuffer(o) || !(o instanceof Buffer)) throw new Error(\"unreachable\"); */\n\tfs.writeFileSync(filename, o);\n}\n\nfunction a2s(o/*:RawBytes*/)/*:string*/ {\n\tvar out = new Array(o.length);\n\tfor(var i = 0; i < o.length; ++i) out[i] = String.fromCharCode(o[i]);\n\treturn out.join(\"\");\n}\n\nfunction write(cfb/*:CFBContainer*/, options/*:CFBWriteOpts*/)/*:RawBytes|string*/ {\n\tvar o = _write(cfb, options);\n\tswitch(options && options.type || \"buffer\") {\n\t\tcase \"file\": get_fs(); fs.writeFileSync(options.filename, (o/*:any*/)); return o;\n\t\tcase \"binary\": return typeof o == \"string\" ? o : a2s(o);\n\t\tcase \"base64\": return Base64_encode(typeof o == \"string\" ? o : a2s(o));\n\t\tcase \"buffer\": if(has_buf) return Buffer.isBuffer(o) ? o : Buffer_from(o);\n\t\t\t/* falls through */\n\t\tcase \"array\": return typeof o == \"string\" ? s2a(o) : o;\n\t}\n\treturn o;\n}\n/* node < 8.1 zlib does not expose bytesRead, so default to pure JS */\nvar _zlib;\nfunction use_zlib(zlib) { try {\n\tvar InflateRaw = zlib.InflateRaw;\n\tvar InflRaw = new InflateRaw();\n\tInflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);\n\tif(InflRaw.bytesRead) _zlib = zlib;\n\telse throw new Error(\"zlib does not expose bytesRead\");\n} catch(e) {console.error(\"cannot use native zlib: \" + (e.message || e)); } }\n\nfunction _inflateRawSync(payload, usz) {\n\tif(!_zlib) return _inflate(payload, usz);\n\tvar InflateRaw = _zlib.InflateRaw;\n\tvar InflRaw = new InflateRaw();\n\tvar out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);\n\tpayload.l += InflRaw.bytesRead;\n\treturn out;\n}\n\nfunction _deflateRawSync(payload) {\n\treturn _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);\n}\nvar CLEN_ORDER = [ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ];\n\n/*  LEN_ID = [ 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285 ]; */\nvar LEN_LN = [   3,   4,   5,   6,   7,   8,   9,  10,  11,  13 , 15,  17,  19,  23,  27,  31,  35,  43,  51,  59,  67,  83,  99, 115, 131, 163, 195, 227, 258 ];\n\n/*  DST_ID = [  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13,  14,  15,  16,  17,  18,  19,   20,   21,   22,   23,   24,   25,   26,    27,    28,    29 ]; */\nvar DST_LN = [  1,  2,  3,  4,  5,  7,  9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577 ];\n\nfunction bit_swap_8(n) { var t = (((((n<<1)|(n<<11)) & 0x22110) | (((n<<5)|(n<<15)) & 0x88440))); return ((t>>16) | (t>>8) |t)&0xFF; }\n\nvar use_typed_arrays = typeof Uint8Array !== 'undefined';\n\nvar bitswap8 = use_typed_arrays ? new Uint8Array(1<<8) : [];\nfor(var q = 0; q < (1<<8); ++q) bitswap8[q] = bit_swap_8(q);\n\nfunction bit_swap_n(n, b) {\n\tvar rev = bitswap8[n & 0xFF];\n\tif(b <= 8) return rev >>> (8-b);\n\trev = (rev << 8) | bitswap8[(n>>8)&0xFF];\n\tif(b <= 16) return rev >>> (16-b);\n\trev = (rev << 8) | bitswap8[(n>>16)&0xFF];\n\treturn rev >>> (24-b);\n}\n\n/* helpers for unaligned bit reads */\nfunction read_bits_2(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 6 ? 0 : buf[h+1]<<8))>>>w)& 0x03; }\nfunction read_bits_3(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 5 ? 0 : buf[h+1]<<8))>>>w)& 0x07; }\nfunction read_bits_4(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 4 ? 0 : buf[h+1]<<8))>>>w)& 0x0F; }\nfunction read_bits_5(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 3 ? 0 : buf[h+1]<<8))>>>w)& 0x1F; }\nfunction read_bits_7(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 1 ? 0 : buf[h+1]<<8))>>>w)& 0x7F; }\n\n/* works up to n = 3 * 8 + 1 = 25 */\nfunction read_bits_n(buf, bl, n) {\n\tvar w = (bl&7), h = (bl>>>3), f = ((1<<n)-1);\n\tvar v = buf[h] >>> w;\n\tif(n < 8 - w) return v & f;\n\tv |= buf[h+1]<<(8-w);\n\tif(n < 16 - w) return v & f;\n\tv |= buf[h+2]<<(16-w);\n\tif(n < 24 - w) return v & f;\n\tv |= buf[h+3]<<(24-w);\n\treturn v & f;\n}\n\n/* helpers for unaligned bit writes */\nfunction write_bits_3(buf, bl, v) { var w = bl & 7, h = bl >>> 3;\n\tif(w <= 5) buf[h] |= (v & 7) << w;\n\telse {\n\t\tbuf[h] |= (v << w) & 0xFF;\n\t\tbuf[h+1] = (v&7) >> (8-w);\n\t}\n\treturn bl + 3;\n}\n\nfunction write_bits_1(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv = (v&1) << w;\n\tbuf[h] |= v;\n\treturn bl + 1;\n}\nfunction write_bits_8(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv <<= w;\n\tbuf[h] |=  v & 0xFF; v >>>= 8;\n\tbuf[h+1] = v;\n\treturn bl + 8;\n}\nfunction write_bits_16(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv <<= w;\n\tbuf[h] |=  v & 0xFF; v >>>= 8;\n\tbuf[h+1] = v & 0xFF;\n\tbuf[h+2] = v >>> 8;\n\treturn bl + 16;\n}\n\n/* until ArrayBuffer#realloc is a thing, fake a realloc */\nfunction realloc(b, sz/*:number*/) {\n\tvar L = b.length, M = 2*L > sz ? 2*L : sz + 5, i = 0;\n\tif(L >= sz) return b;\n\tif(has_buf) {\n\t\tvar o = new_unsafe_buf(M);\n\t\t// $FlowIgnore\n\t\tif(b.copy) b.copy(o);\n\t\telse for(; i < b.length; ++i) o[i] = b[i];\n\t\treturn o;\n\t} else if(use_typed_arrays) {\n\t\tvar a = new Uint8Array(M);\n\t\tif(a.set) a.set(b);\n\t\telse for(; i < L; ++i) a[i] = b[i];\n\t\treturn a;\n\t}\n\tb.length = M;\n\treturn b;\n}\n\n/* zero-filled arrays for older browsers */\nfunction zero_fill_array(n) {\n\tvar o = new Array(n);\n\tfor(var i = 0; i < n; ++i) o[i] = 0;\n\treturn o;\n}\n\n/* build tree (used for literals and lengths) */\nfunction build_tree(clens, cmap, MAX/*:number*/)/*:number*/ {\n\tvar maxlen = 1, w = 0, i = 0, j = 0, ccode = 0, L = clens.length;\n\n\tvar bl_count  = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n\tfor(i = 0; i < 32; ++i) bl_count[i] = 0;\n\n\tfor(i = L; i < MAX; ++i) clens[i] = 0;\n\tL = clens.length;\n\n\tvar ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L); // []\n\n\t/* build code tree */\n\tfor(i = 0; i < L; ++i) {\n\t\tbl_count[(w = clens[i])]++;\n\t\tif(maxlen < w) maxlen = w;\n\t\tctree[i] = 0;\n\t}\n\tbl_count[0] = 0;\n\tfor(i = 1; i <= maxlen; ++i) bl_count[i+16] = (ccode = (ccode + bl_count[i-1])<<1);\n\tfor(i = 0; i < L; ++i) {\n\t\tccode = clens[i];\n\t\tif(ccode != 0) ctree[i] = bl_count[ccode+16]++;\n\t}\n\n\t/* cmap[maxlen + 4 bits] = (off&15) + (lit<<4) reverse mapping */\n\tvar cleni = 0;\n\tfor(i = 0; i < L; ++i) {\n\t\tcleni = clens[i];\n\t\tif(cleni != 0) {\n\t\t\tccode = bit_swap_n(ctree[i], maxlen)>>(maxlen-cleni);\n\t\t\tfor(j = (1<<(maxlen + 4 - cleni)) - 1; j>=0; --j)\n\t\t\t\tcmap[ccode|(j<<cleni)] = (cleni&15) | (i<<4);\n\t\t}\n\t}\n\treturn maxlen;\n}\n\n/* Fixed Huffman */\nvar fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);\nvar fix_dmap = use_typed_arrays ? new Uint16Array(32)  : zero_fill_array(32);\nif(!use_typed_arrays) {\n\tfor(var i = 0; i < 512; ++i) fix_lmap[i] = 0;\n\tfor(i = 0; i < 32; ++i) fix_dmap[i] = 0;\n}\n(function() {\n\tvar dlens/*:Array<number>*/ = [];\n\tvar i = 0;\n\tfor(;i<32; i++) dlens.push(5);\n\tbuild_tree(dlens, fix_dmap, 32);\n\n\tvar clens/*:Array<number>*/ = [];\n\ti = 0;\n\tfor(; i<=143; i++) clens.push(8);\n\tfor(; i<=255; i++) clens.push(9);\n\tfor(; i<=279; i++) clens.push(7);\n\tfor(; i<=287; i++) clens.push(8);\n\tbuild_tree(clens, fix_lmap, 288);\n})();var _deflateRaw = /*#__PURE__*/(function _deflateRawIIFE() {\n\tvar DST_LN_RE = use_typed_arrays ? new Uint8Array(0x8000) : [];\n\tvar j = 0, k = 0;\n\tfor(; j < DST_LN.length - 1; ++j) {\n\t\tfor(; k < DST_LN[j+1]; ++k) DST_LN_RE[k] = j;\n\t}\n\tfor(;k < 32768; ++k) DST_LN_RE[k] = 29;\n\n\tvar LEN_LN_RE = use_typed_arrays ? new Uint8Array(0x103) : [];\n\tfor(j = 0, k = 0; j < LEN_LN.length - 1; ++j) {\n\t\tfor(; k < LEN_LN[j+1]; ++k) LEN_LN_RE[k] = j;\n\t}\n\n\tfunction write_stored(data, out) {\n\t\tvar boff = 0;\n\t\twhile(boff < data.length) {\n\t\t\tvar L = Math.min(0xFFFF, data.length - boff);\n\t\t\tvar h = boff + L == data.length;\n\t\t\tout.write_shift(1, +h);\n\t\t\tout.write_shift(2, L);\n\t\t\tout.write_shift(2, (~L) & 0xFFFF);\n\t\t\twhile(L-- > 0) out[out.l++] = data[boff++];\n\t\t}\n\t\treturn out.l;\n\t}\n\n\t/* Fixed Huffman */\n\tfunction write_huff_fixed(data, out) {\n\t\tvar bl = 0;\n\t\tvar boff = 0;\n\t\tvar addrs = use_typed_arrays ? new Uint16Array(0x8000) : [];\n\t\twhile(boff < data.length) {\n\t\t\tvar L = /* data.length - boff; */ Math.min(0xFFFF, data.length - boff);\n\n\t\t\t/* write a stored block for short data */\n\t\t\tif(L < 10) {\n\t\t\t\tbl = write_bits_3(out, bl, +!!(boff + L == data.length)); // jshint ignore:line\n\t\t\t\tif(bl & 7) bl += 8 - (bl & 7);\n\t\t\t\tout.l = (bl / 8) | 0;\n\t\t\t\tout.write_shift(2, L);\n\t\t\t\tout.write_shift(2, (~L) & 0xFFFF);\n\t\t\t\twhile(L-- > 0) out[out.l++] = data[boff++];\n\t\t\t\tbl = out.l * 8;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tbl = write_bits_3(out, bl, +!!(boff + L == data.length) + 2); // jshint ignore:line\n\t\t\tvar hash = 0;\n\t\t\twhile(L-- > 0) {\n\t\t\t\tvar d = data[boff];\n\t\t\t\thash = ((hash << 5) ^ d) & 0x7FFF;\n\n\t\t\t\tvar match = -1, mlen = 0;\n\n\t\t\t\tif((match = addrs[hash])) {\n\t\t\t\t\tmatch |= boff & ~0x7FFF;\n\t\t\t\t\tif(match > boff) match -= 0x8000;\n\t\t\t\t\tif(match < boff) while(data[match + mlen] == data[boff + mlen] && mlen < 250) ++mlen;\n\t\t\t\t}\n\n\t\t\t\tif(mlen > 2) {\n\t\t\t\t\t/* Copy Token  */\n\t\t\t\t\td = LEN_LN_RE[mlen];\n\t\t\t\t\tif(d <= 22) bl = write_bits_8(out, bl, bitswap8[d+1]>>1) - 1;\n\t\t\t\t\telse {\n\t\t\t\t\t\twrite_bits_8(out, bl, 3);\n\t\t\t\t\t\tbl += 5;\n\t\t\t\t\t\twrite_bits_8(out, bl, bitswap8[d-23]>>5);\n\t\t\t\t\t\tbl += 3;\n\t\t\t\t\t}\n\t\t\t\t\tvar len_eb = (d < 8) ? 0 : ((d - 4)>>2);\n\t\t\t\t\tif(len_eb > 0) {\n\t\t\t\t\t\twrite_bits_16(out, bl, mlen - LEN_LN[d]);\n\t\t\t\t\t\tbl += len_eb;\n\t\t\t\t\t}\n\n\t\t\t\t\td = DST_LN_RE[boff - match];\n\t\t\t\t\tbl = write_bits_8(out, bl, bitswap8[d]>>3);\n\t\t\t\t\tbl -= 3;\n\n\t\t\t\t\tvar dst_eb = d < 4 ? 0 : (d-2)>>1;\n\t\t\t\t\tif(dst_eb > 0) {\n\t\t\t\t\t\twrite_bits_16(out, bl, boff - match - DST_LN[d]);\n\t\t\t\t\t\tbl += dst_eb;\n\t\t\t\t\t}\n\t\t\t\t\tfor(var q = 0; q < mlen; ++q) {\n\t\t\t\t\t\taddrs[hash] = boff & 0x7FFF;\n\t\t\t\t\t\thash = ((hash << 5) ^ data[boff]) & 0x7FFF;\n\t\t\t\t\t\t++boff;\n\t\t\t\t\t}\n\t\t\t\t\tL-= mlen - 1;\n\t\t\t\t} else {\n\t\t\t\t\t/* Literal Token */\n\t\t\t\t\tif(d <= 143) d = d + 48;\n\t\t\t\t\telse bl = write_bits_1(out, bl, 1);\n\t\t\t\t\tbl = write_bits_8(out, bl, bitswap8[d]);\n\t\t\t\t\taddrs[hash] = boff & 0x7FFF;\n\t\t\t\t\t++boff;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbl = write_bits_8(out, bl, 0) - 1;\n\t\t}\n\t\tout.l = ((bl + 7)/8)|0;\n\t\treturn out.l;\n\t}\n\treturn function _deflateRaw(data, out) {\n\t\tif(data.length < 8) return write_stored(data, out);\n\t\treturn write_huff_fixed(data, out);\n\t};\n})();\n\nfunction _deflate(data) {\n\tvar buf = new_buf(50+Math.floor(data.length*1.1));\n\tvar off = _deflateRaw(data, buf);\n\treturn buf.slice(0, off);\n}\n/* modified inflate function also moves original read head */\n\nvar dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\nvar dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\nvar dyn_cmap = use_typed_arrays ? new Uint16Array(128)   : zero_fill_array(128);\nvar dyn_len_1 = 1, dyn_len_2 = 1;\n\n/* 5.5.3 Expanding Huffman Codes */\nfunction dyn(data, boff/*:number*/) {\n\t/* nomenclature from RFC1951 refers to bit values; these are offset by the implicit constant */\n\tvar _HLIT = read_bits_5(data, boff) + 257; boff += 5;\n\tvar _HDIST = read_bits_5(data, boff) + 1; boff += 5;\n\tvar _HCLEN = read_bits_4(data, boff) + 4; boff += 4;\n\tvar w = 0;\n\n\t/* grab and store code lengths */\n\tvar clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);\n\tvar ctree = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];\n\tvar maxlen = 1;\n\tvar bl_count =  use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n\tvar next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n\tvar L = clens.length; /* 19 */\n\tfor(var i = 0; i < _HCLEN; ++i) {\n\t\tclens[CLEN_ORDER[i]] = w = read_bits_3(data, boff);\n\t\tif(maxlen < w) maxlen = w;\n\t\tbl_count[w]++;\n\t\tboff += 3;\n\t}\n\n\t/* build code tree */\n\tvar ccode = 0;\n\tbl_count[0] = 0;\n\tfor(i = 1; i <= maxlen; ++i) next_code[i] = ccode = (ccode + bl_count[i-1])<<1;\n\tfor(i = 0; i < L; ++i) if((ccode = clens[i]) != 0) ctree[i] = next_code[ccode]++;\n\t/* cmap[7 bits from stream] = (off&7) + (lit<<3) */\n\tvar cleni = 0;\n\tfor(i = 0; i < L; ++i) {\n\t\tcleni = clens[i];\n\t\tif(cleni != 0) {\n\t\t\tccode = bitswap8[ctree[i]]>>(8-cleni);\n\t\t\tfor(var j = (1<<(7-cleni))-1; j>=0; --j) dyn_cmap[ccode|(j<<cleni)] = (cleni&7) | (i<<3);\n\t\t}\n\t}\n\n\t/* read literal and dist codes at once */\n\tvar hcodes/*:Array<number>*/ = [];\n\tmaxlen = 1;\n\tfor(; hcodes.length < _HLIT + _HDIST;) {\n\t\tccode = dyn_cmap[read_bits_7(data, boff)];\n\t\tboff += ccode & 7;\n\t\tswitch((ccode >>>= 3)) {\n\t\t\tcase 16:\n\t\t\t\tw = 3 + read_bits_2(data, boff); boff += 2;\n\t\t\t\tccode = hcodes[hcodes.length - 1];\n\t\t\t\twhile(w-- > 0) hcodes.push(ccode);\n\t\t\t\tbreak;\n\t\t\tcase 17:\n\t\t\t\tw = 3 + read_bits_3(data, boff); boff += 3;\n\t\t\t\twhile(w-- > 0) hcodes.push(0);\n\t\t\t\tbreak;\n\t\t\tcase 18:\n\t\t\t\tw = 11 + read_bits_7(data, boff); boff += 7;\n\t\t\t\twhile(w -- > 0) hcodes.push(0);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\thcodes.push(ccode);\n\t\t\t\tif(maxlen < ccode) maxlen = ccode;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* build literal / length trees */\n\tvar h1 = hcodes.slice(0, _HLIT), h2 = hcodes.slice(_HLIT);\n\tfor(i = _HLIT; i < 286; ++i) h1[i] = 0;\n\tfor(i = _HDIST; i < 30; ++i) h2[i] = 0;\n\tdyn_len_1 = build_tree(h1, dyn_lmap, 286);\n\tdyn_len_2 = build_tree(h2, dyn_dmap, 30);\n\treturn boff;\n}\n\n/* return [ data, bytesRead ] */\nfunction inflate(data, usz/*:number*/) {\n\t/* shortcircuit for empty buffer [0x03, 0x00] */\n\tif(data[0] == 3 && !(data[1] & 0x3)) { return [new_raw_buf(usz), 2]; }\n\n\t/* bit offset */\n\tvar boff = 0;\n\n\t/* header includes final bit and type bits */\n\tvar header = 0;\n\n\tvar outbuf = new_unsafe_buf(usz ? usz : (1<<18));\n\tvar woff = 0;\n\tvar OL = outbuf.length>>>0;\n\tvar max_len_1 = 0, max_len_2 = 0;\n\n\twhile((header&1) == 0) {\n\t\theader = read_bits_3(data, boff); boff += 3;\n\t\tif((header >>> 1) == 0) {\n\t\t\t/* Stored block */\n\t\t\tif(boff & 7) boff += 8 - (boff&7);\n\t\t\t/* 2 bytes sz, 2 bytes bit inverse */\n\t\t\tvar sz = data[boff>>>3] | data[(boff>>>3)+1]<<8;\n\t\t\tboff += 32;\n\t\t\t/* push sz bytes */\n\t\t\tif(sz > 0) {\n\t\t\t\tif(!usz && OL < woff + sz) { outbuf = realloc(outbuf, woff + sz); OL = outbuf.length; }\n\t\t\t\twhile(sz-- > 0) { outbuf[woff++] = data[boff>>>3]; boff += 8; }\n\t\t\t}\n\t\t\tcontinue;\n\t\t} else if((header >> 1) == 1) {\n\t\t\t/* Fixed Huffman */\n\t\t\tmax_len_1 = 9; max_len_2 = 5;\n\t\t} else {\n\t\t\t/* Dynamic Huffman */\n\t\t\tboff = dyn(data, boff);\n\t\t\tmax_len_1 = dyn_len_1; max_len_2 = dyn_len_2;\n\t\t}\n\t\tfor(;;) { // while(true) is apparently out of vogue in modern JS circles\n\t\t\tif(!usz && (OL < woff + 32767)) { outbuf = realloc(outbuf, woff + 32767); OL = outbuf.length; }\n\t\t\t/* ingest code and move read head */\n\t\t\tvar bits = read_bits_n(data, boff, max_len_1);\n\t\t\tvar code = (header>>>1) == 1 ? fix_lmap[bits] : dyn_lmap[bits];\n\t\t\tboff += code & 15; code >>>= 4;\n\t\t\t/* 0-255 are literals, 256 is end of block token, 257+ are copy tokens */\n\t\t\tif(((code>>>8)&0xFF) === 0) outbuf[woff++] = code;\n\t\t\telse if(code == 256) break;\n\t\t\telse {\n\t\t\t\tcode -= 257;\n\t\t\t\tvar len_eb = (code < 8) ? 0 : ((code-4)>>2); if(len_eb > 5) len_eb = 0;\n\t\t\t\tvar tgt = woff + LEN_LN[code];\n\t\t\t\t/* length extra bits */\n\t\t\t\tif(len_eb > 0) {\n\t\t\t\t\ttgt += read_bits_n(data, boff, len_eb);\n\t\t\t\t\tboff += len_eb;\n\t\t\t\t}\n\n\t\t\t\t/* dist code */\n\t\t\t\tbits = read_bits_n(data, boff, max_len_2);\n\t\t\t\tcode = (header>>>1) == 1 ? fix_dmap[bits] : dyn_dmap[bits];\n\t\t\t\tboff += code & 15; code >>>= 4;\n\t\t\t\tvar dst_eb = (code < 4 ? 0 : (code-2)>>1);\n\t\t\t\tvar dst = DST_LN[code];\n\t\t\t\t/* dist extra bits */\n\t\t\t\tif(dst_eb > 0) {\n\t\t\t\t\tdst += read_bits_n(data, boff, dst_eb);\n\t\t\t\t\tboff += dst_eb;\n\t\t\t\t}\n\n\t\t\t\t/* in the common case, manual byte copy is faster than TA set / Buffer copy */\n\t\t\t\tif(!usz && OL < tgt) { outbuf = realloc(outbuf, tgt + 100); OL = outbuf.length; }\n\t\t\t\twhile(woff < tgt) { outbuf[woff] = outbuf[woff - dst]; ++woff; }\n\t\t\t}\n\t\t}\n\t}\n\tif(usz) return [outbuf, (boff+7)>>>3];\n\treturn [outbuf.slice(0, woff), (boff+7)>>>3];\n}\n\nfunction _inflate(payload, usz) {\n\tvar data = payload.slice(payload.l||0);\n\tvar out = inflate(data, usz);\n\tpayload.l += out[1];\n\treturn out[0];\n}\n\nfunction warn_or_throw(wrn, msg) {\n\tif(wrn) { if(typeof console !== 'undefined') console.error(msg); }\n\telse throw new Error(msg);\n}\n\nfunction parse_zip(file/*:RawBytes*/, options/*:CFBReadOpts*/)/*:CFBContainer*/ {\n\tvar blob/*:CFBlob*/ = /*::(*/file/*:: :any)*/;\n\tprep_blob(blob, 0);\n\n\tvar FileIndex/*:CFBFileIndex*/ = [], FullPaths/*:Array<string>*/ = [];\n\tvar o = {\n\t\tFileIndex: FileIndex,\n\t\tFullPaths: FullPaths\n\t};\n\tinit_cfb(o, { root: options.root });\n\n\t/* find end of central directory, start just after signature */\n\tvar i = blob.length - 4;\n\twhile((blob[i] != 0x50 || blob[i+1] != 0x4b || blob[i+2] != 0x05 || blob[i+3] != 0x06) && i >= 0) --i;\n\tblob.l = i + 4;\n\n\t/* parse end of central directory */\n\tblob.l += 4;\n\tvar fcnt = blob.read_shift(2);\n\tblob.l += 6;\n\tvar start_cd = blob.read_shift(4);\n\n\t/* parse central directory */\n\tblob.l = start_cd;\n\n\tfor(i = 0; i < fcnt; ++i) {\n\t\t/* trust local file header instead of CD entry */\n\t\tblob.l += 20;\n\t\tvar csz = blob.read_shift(4);\n\t\tvar usz = blob.read_shift(4);\n\t\tvar namelen = blob.read_shift(2);\n\t\tvar efsz = blob.read_shift(2);\n\t\tvar fcsz = blob.read_shift(2);\n\t\tblob.l += 8;\n\t\tvar offset = blob.read_shift(4);\n\t\tvar EF = parse_extra_field(/*::(*/blob.slice(blob.l+namelen, blob.l+namelen+efsz)/*:: :any)*/);\n\t\tblob.l += namelen + efsz + fcsz;\n\n\t\tvar L = blob.l;\n\t\tblob.l = offset + 4;\n\t\t/* ZIP64 lengths */\n\t\tif(EF && EF[0x0001]) {\n\t\t\tif((EF[0x0001]||{}).usz) usz = EF[0x0001].usz;\n\t\t\tif((EF[0x0001]||{}).csz) csz = EF[0x0001].csz;\n\t\t}\n\t\tparse_local_file(blob, csz, usz, o, EF);\n\t\tblob.l = L;\n\t}\n\n\treturn o;\n}\n\n\n/* head starts just after local file header signature */\nfunction parse_local_file(blob/*:CFBlob*/, csz/*:number*/, usz/*:number*/, o/*:CFBContainer*/, EF) {\n\t/* [local file header] */\n\tblob.l += 2;\n\tvar flags = blob.read_shift(2);\n\tvar meth = blob.read_shift(2);\n\tvar date = parse_dos_date(blob);\n\n\tif(flags & 0x2041) throw new Error(\"Unsupported ZIP encryption\");\n\tvar crc32 = blob.read_shift(4);\n\tvar _csz = blob.read_shift(4);\n\tvar _usz = blob.read_shift(4);\n\n\tvar namelen = blob.read_shift(2);\n\tvar efsz = blob.read_shift(2);\n\n\t// TODO: flags & (1<<11) // UTF8\n\tvar name = \"\"; for(var i = 0; i < namelen; ++i) name += String.fromCharCode(blob[blob.l++]);\n\tif(efsz) {\n\t\tvar ef = parse_extra_field(/*::(*/blob.slice(blob.l, blob.l + efsz)/*:: :any)*/);\n\t\tif((ef[0x5455]||{}).mt) date = ef[0x5455].mt;\n\t\tif((ef[0x0001]||{}).usz) _usz = ef[0x0001].usz;\n\t\tif((ef[0x0001]||{}).csz) _csz = ef[0x0001].csz;\n\t\tif(EF) {\n\t\t\tif((EF[0x5455]||{}).mt) date = EF[0x5455].mt;\n\t\t\tif((EF[0x0001]||{}).usz) _usz = EF[0x0001].usz;\n\t\t\tif((EF[0x0001]||{}).csz) _csz = EF[0x0001].csz;\n\t\t}\n\t}\n\tblob.l += efsz;\n\n\t/* [encryption header] */\n\n\t/* [file data] */\n\tvar data = blob.slice(blob.l, blob.l + _csz);\n\tswitch(meth) {\n\t\tcase 8: data = _inflateRawSync(blob, _usz); break;\n\t\tcase 0: blob.l += _csz; break; // TODO: scan for magic number\n\t\tdefault: throw new Error(\"Unsupported ZIP Compression method \" + meth);\n\t}\n\n\t/* [data descriptor] */\n\tvar wrn = false;\n\tif(flags & 8) {\n\t\tcrc32 = blob.read_shift(4);\n\t\tif(crc32 == 0x08074b50) { crc32 = blob.read_shift(4); wrn = true; }\n\t\t_csz = blob.read_shift(4);\n\t\t_usz = blob.read_shift(4);\n\t}\n\n\tif(_csz != csz) warn_or_throw(wrn, \"Bad compressed size: \" + csz + \" != \" + _csz);\n\tif(_usz != usz) warn_or_throw(wrn, \"Bad uncompressed size: \" + usz + \" != \" + _usz);\n\t//var _crc32 = CRC32.buf(data, 0);\n\t//if((crc32>>0) != (_crc32>>0)) warn_or_throw(wrn, \"Bad CRC32 checksum: \" + crc32 + \" != \" + _crc32);\n\tcfb_add(o, name, data, {unsafe: true, mt: date});\n}\nfunction write_zip(cfb/*:CFBContainer*/, options/*:CFBWriteOpts*/)/*:RawBytes*/ {\n\tvar _opts = options || {};\n\tvar out = [], cdirs = [];\n\tvar o/*:CFBlob*/ = new_buf(1);\n\tvar method = (_opts.compression ? 8 : 0), flags = 0;\n\tvar desc = false;\n\tif(desc) flags |= 8;\n\tvar i = 0, j = 0;\n\n\tvar start_cd = 0, fcnt = 0;\n\tvar root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\n\tvar crcs = [];\n\tvar sz_cd = 0;\n\n\tfor(i = 1; i < cfb.FullPaths.length; ++i) {\n\t\tfp = cfb.FullPaths[i].slice(root.length); fi = cfb.FileIndex[i];\n\t\tif(!fi.size || !fi.content || (Array.isArray(fi.content) && fi.content.length == 0) || fp == \"\\u0001Sh33tJ5\") continue;\n\t\tvar start = start_cd;\n\n\n\t\t/* TODO: CP437 filename */\n\t\tvar namebuf = new_buf(fp.length);\n\t\tfor(j = 0; j < fp.length; ++j) namebuf.write_shift(1, fp.charCodeAt(j) & 0x7F);\n\t\tnamebuf = namebuf.slice(0, namebuf.l);\n\t\tcrcs[fcnt] = typeof fi.content == \"string\" ? CRC32.bstr(fi.content, 0) : CRC32.buf(/*::((*/fi.content/*::||[]):any)*/, 0);\n\n\t\tvar outbuf = typeof fi.content == \"string\" ? s2a(fi.content) : fi.content/*::||[]*/;\n\t\tif(method == 8) outbuf = _deflateRawSync(outbuf);\n\n\t\t/* local file header */\n\t\to = new_buf(30);\n\t\to.write_shift(4, 0x04034b50);\n\t\to.write_shift(2, 20);\n\t\to.write_shift(2, flags);\n\t\to.write_shift(2, method);\n\t\t/* TODO: last mod file time/date */\n\t\tif(fi.mt) write_dos_date(o, fi.mt);\n\t\telse o.write_shift(4, 0);\n\t\to.write_shift(-4, (flags & 8) ? 0 : crcs[fcnt]);\n\t\to.write_shift(4,  (flags & 8) ? 0 : outbuf.length);\n\t\to.write_shift(4,  (flags & 8) ? 0 : /*::(*/fi.content/*::||[])*/.length);\n\t\to.write_shift(2, namebuf.length);\n\t\to.write_shift(2, 0);\n\n\t\tstart_cd += o.length;\n\t\tout.push(o);\n\t\tstart_cd += namebuf.length;\n\t\tout.push(namebuf);\n\n\t\t/* TODO: extra fields? */\n\n\t\t/* TODO: encryption header ? */\n\n\t\tstart_cd += outbuf.length;\n\t\tout.push(outbuf);\n\n\t\t/* data descriptor */\n\t\tif(flags & 8) {\n\t\t\to = new_buf(12);\n\t\t\to.write_shift(-4, crcs[fcnt]);\n\t\t\to.write_shift(4, outbuf.length);\n\t\t\to.write_shift(4, /*::(*/fi.content/*::||[])*/.length);\n\t\t\tstart_cd += o.l;\n\t\t\tout.push(o);\n\t\t}\n\n\t\t/* central directory */\n\t\to = new_buf(46);\n\t\to.write_shift(4, 0x02014b50);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 20);\n\t\to.write_shift(2, flags);\n\t\to.write_shift(2, method);\n\t\to.write_shift(4, 0); /* TODO: last mod file time/date */\n\t\to.write_shift(-4, crcs[fcnt]);\n\n\t\to.write_shift(4, outbuf.length);\n\t\to.write_shift(4, /*::(*/fi.content/*::||[])*/.length);\n\t\to.write_shift(2, namebuf.length);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, start);\n\n\t\tsz_cd += o.l;\n\t\tcdirs.push(o);\n\t\tsz_cd += namebuf.length;\n\t\tcdirs.push(namebuf);\n\t\t++fcnt;\n\t}\n\n\t/* end of central directory */\n\to = new_buf(22);\n\to.write_shift(4, 0x06054b50);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, fcnt);\n\to.write_shift(2, fcnt);\n\to.write_shift(4, sz_cd);\n\to.write_shift(4, start_cd);\n\to.write_shift(2, 0);\n\n\treturn bconcat(([bconcat((out/*:any*/)), bconcat(cdirs), o]/*:any*/));\n}\nvar ContentTypeMap = ({\n\t\"htm\": \"text/html\",\n\t\"xml\": \"text/xml\",\n\n\t\"gif\": \"image/gif\",\n\t\"jpg\": \"image/jpeg\",\n\t\"png\": \"image/png\",\n\n\t\"mso\": \"application/x-mso\",\n\t\"thmx\": \"application/vnd.ms-officetheme\",\n\t\"sh33tj5\": \"application/octet-stream\"\n}/*:any*/);\n\nfunction get_content_type(fi/*:CFBEntry*/, fp/*:string*/)/*:string*/ {\n\tif(fi.ctype) return fi.ctype;\n\n\tvar ext = fi.name || \"\", m = ext.match(/\\.([^\\.]+)$/);\n\tif(m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\n\tif(fp) {\n\t\tm = (ext = fp).match(/[\\.\\\\]([^\\.\\\\])+$/);\n\t\tif(m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\t}\n\n\treturn \"application/octet-stream\";\n}\n\n/* 76 character chunks TODO: intertwine encoding */\nfunction write_base64_76(bstr/*:string*/)/*:string*/ {\n\tvar data = Base64_encode(bstr);\n\tvar o = [];\n\tfor(var i = 0; i < data.length; i+= 76) o.push(data.slice(i, i+76));\n\treturn o.join(\"\\r\\n\") + \"\\r\\n\";\n}\n\n/*\nRules for QP:\n\t- escape =## applies for all non-display characters and literal \"=\"\n\t- space or tab at end of line must be encoded\n\t- \\r\\n newlines can be preserved, but bare \\r and \\n must be escaped\n\t- lines must not exceed 76 characters, use soft breaks =\\r\\n\n\nTODO: Some files from word appear to write line extensions with bare equals:\n\n```\n<table class=3DMsoTableGrid border=3D1 cellspacing=3D0 cellpadding=3D0 width=\n=\"70%\"\n```\n*/\nfunction write_quoted_printable(text/*:string*/)/*:string*/ {\n\tvar encoded = text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF=]/g, function(c) {\n\t\tvar w = c.charCodeAt(0).toString(16).toUpperCase();\n\t\treturn \"=\" + (w.length == 1 ? \"0\" + w : w);\n\t});\n\n\tencoded = encoded.replace(/ $/mg, \"=20\").replace(/\\t$/mg, \"=09\");\n\n\tif(encoded.charAt(0) == \"\\n\") encoded = \"=0D\" + encoded.slice(1);\n\tencoded = encoded.replace(/\\r(?!\\n)/mg, \"=0D\").replace(/\\n\\n/mg, \"\\n=0A\").replace(/([^\\r\\n])\\n/mg, \"$1=0A\");\n\n\tvar o/*:Array<string>*/ = [], split = encoded.split(\"\\r\\n\");\n\tfor(var si = 0; si < split.length; ++si) {\n\t\tvar str = split[si];\n\t\tif(str.length == 0) { o.push(\"\"); continue; }\n\t\tfor(var i = 0; i < str.length;) {\n\t\t\tvar end = 76;\n\t\t\tvar tmp = str.slice(i, i + end);\n\t\t\tif(tmp.charAt(end - 1) == \"=\") end --;\n\t\t\telse if(tmp.charAt(end - 2) == \"=\") end -= 2;\n\t\t\telse if(tmp.charAt(end - 3) == \"=\") end -= 3;\n\t\t\ttmp = str.slice(i, i + end);\n\t\t\ti += end;\n\t\t\tif(i < str.length) tmp += \"=\";\n\t\t\to.push(tmp);\n\t\t}\n\t}\n\n\treturn o.join(\"\\r\\n\");\n}\nfunction parse_quoted_printable(data/*:Array<string>*/)/*:RawBytes*/ {\n\tvar o = [];\n\n\t/* unify long lines */\n\tfor(var di = 0; di < data.length; ++di) {\n\t\tvar line = data[di];\n\t\twhile(di <= data.length && line.charAt(line.length - 1) == \"=\") line = line.slice(0, line.length - 1) + data[++di];\n\t\to.push(line);\n\t}\n\n\t/* decode */\n\tfor(var oi = 0; oi < o.length; ++oi) o[oi] = o[oi].replace(/[=][0-9A-Fa-f]{2}/g, function($$) { return String.fromCharCode(parseInt($$.slice(1), 16)); });\n\treturn s2a(o.join(\"\\r\\n\"));\n}\n\n\nfunction parse_mime(cfb/*:CFBContainer*/, data/*:Array<string>*/, root/*:string*/)/*:void*/ {\n\tvar fname = \"\", cte = \"\", ctype = \"\", fdata;\n\tvar di = 0;\n\tfor(;di < 10; ++di) {\n\t\tvar line = data[di];\n\t\tif(!line || line.match(/^\\s*$/)) break;\n\t\tvar m = line.match(/^([^:]*?):\\s*([^\\s].*)$/);\n\t\tif(m) switch(m[1].toLowerCase()) {\n\t\t\tcase \"content-location\": fname = m[2].trim(); break;\n\t\t\tcase \"content-type\": ctype = m[2].trim(); break;\n\t\t\tcase \"content-transfer-encoding\": cte = m[2].trim(); break;\n\t\t}\n\t}\n\t++di;\n\tswitch(cte.toLowerCase()) {\n\t\tcase 'base64': fdata = s2a(Base64_decode(data.slice(di).join(\"\"))); break;\n\t\tcase 'quoted-printable': fdata = parse_quoted_printable(data.slice(di)); break;\n\t\tdefault: throw new Error(\"Unsupported Content-Transfer-Encoding \" + cte);\n\t}\n\tvar file = cfb_add(cfb, fname.slice(root.length), fdata, {unsafe: true});\n\tif(ctype) file.ctype = ctype;\n}\n\nfunction parse_mad(file/*:RawBytes*/, options/*:CFBReadOpts*/)/*:CFBContainer*/ {\n\tif(a2s(file.slice(0,13)).toLowerCase() != \"mime-version:\") throw new Error(\"Unsupported MAD header\");\n\tvar root = (options && options.root || \"\");\n\t// $FlowIgnore\n\tvar data = (has_buf && Buffer.isBuffer(file) ? file.toString(\"binary\") : a2s(file)).split(\"\\r\\n\");\n\tvar di = 0, row = \"\";\n\n\t/* if root is not specified, scan for the common prefix */\n\tfor(di = 0; di < data.length; ++di) {\n\t\trow = data[di];\n\t\tif(!/^Content-Location:/i.test(row)) continue;\n\t\trow = row.slice(row.indexOf(\"file\"));\n\t\tif(!root) root = row.slice(0, row.lastIndexOf(\"/\") + 1);\n\t\tif(row.slice(0, root.length) == root) continue;\n\t\twhile(root.length > 0) {\n\t\t\troot = root.slice(0, root.length - 1);\n\t\t\troot = root.slice(0, root.lastIndexOf(\"/\") + 1);\n\t\t\tif(row.slice(0,root.length) == root) break;\n\t\t}\n\t}\n\n\tvar mboundary = (data[1] || \"\").match(/boundary=\"(.*?)\"/);\n\tif(!mboundary) throw new Error(\"MAD cannot find boundary\");\n\tvar boundary = \"--\" + (mboundary[1] || \"\");\n\n\tvar FileIndex/*:CFBFileIndex*/ = [], FullPaths/*:Array<string>*/ = [];\n\tvar o = {\n\t\tFileIndex: FileIndex,\n\t\tFullPaths: FullPaths\n\t};\n\tinit_cfb(o);\n\tvar start_di, fcnt = 0;\n\tfor(di = 0; di < data.length; ++di) {\n\t\tvar line = data[di];\n\t\tif(line !== boundary && line !== boundary + \"--\") continue;\n\t\tif(fcnt++) parse_mime(o, data.slice(start_di, di), root);\n\t\tstart_di = di;\n\t}\n\treturn o;\n}\n\nfunction write_mad(cfb/*:CFBContainer*/, options/*:CFBWriteOpts*/)/*:string*/ {\n\tvar opts = options || {};\n\tvar boundary = opts.boundary || \"SheetJS\";\n\tboundary = '------=' + boundary;\n\n\tvar out = [\n\t\t'MIME-Version: 1.0',\n\t\t'Content-Type: multipart/related; boundary=\"' + boundary.slice(2) + '\"',\n\t\t'',\n\t\t'',\n\t\t''\n\t];\n\n\tvar root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\n\tfor(var i = 1; i < cfb.FullPaths.length; ++i) {\n\t\tfp = cfb.FullPaths[i].slice(root.length);\n\t\tfi = cfb.FileIndex[i];\n\t\tif(!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n\n\t\t/* Normalize filename */\n\t\tfp = fp.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF]/g, function(c) {\n\t\t\treturn \"_x\" + c.charCodeAt(0).toString(16) + \"_\";\n\t\t}).replace(/[\\u0080-\\uFFFF]/g, function(u) {\n\t\t\treturn \"_u\" + u.charCodeAt(0).toString(16) + \"_\";\n\t\t});\n\n\t\t/* Extract content as binary string */\n\t\tvar ca = fi.content;\n\t\t// $FlowIgnore\n\t\tvar cstr = has_buf && Buffer.isBuffer(ca) ? ca.toString(\"binary\") : a2s(ca);\n\n\t\t/* 4/5 of first 1024 chars ascii -> quoted printable, else base64 */\n\t\tvar dispcnt = 0, L = Math.min(1024, cstr.length), cc = 0;\n\t\tfor(var csl = 0; csl <= L; ++csl) if((cc=cstr.charCodeAt(csl)) >= 0x20 && cc < 0x80) ++dispcnt;\n\t\tvar qp = dispcnt >= L * 4 / 5;\n\n\t\tout.push(boundary);\n\t\tout.push('Content-Location: ' + (opts.root || 'file:///C:/SheetJS/') + fp);\n\t\tout.push('Content-Transfer-Encoding: ' + (qp ? 'quoted-printable' : 'base64'));\n\t\tout.push('Content-Type: ' + get_content_type(fi, fp));\n\t\tout.push('');\n\n\t\tout.push(qp ? write_quoted_printable(cstr) : write_base64_76(cstr));\n\t}\n\tout.push(boundary + '--\\r\\n');\n\treturn out.join(\"\\r\\n\");\n}\nfunction cfb_new(opts/*:?any*/)/*:CFBContainer*/ {\n\tvar o/*:CFBContainer*/ = ({}/*:any*/);\n\tinit_cfb(o, opts);\n\treturn o;\n}\n\nfunction cfb_add(cfb/*:CFBContainer*/, name/*:string*/, content/*:?RawBytes*/, opts/*:?any*/)/*:CFBEntry*/ {\n\tvar unsafe = opts && opts.unsafe;\n\tif(!unsafe) init_cfb(cfb);\n\tvar file = !unsafe && CFB.find(cfb, name);\n\tif(!file) {\n\t\tvar fpath/*:string*/ = cfb.FullPaths[0];\n\t\tif(name.slice(0, fpath.length) == fpath) fpath = name;\n\t\telse {\n\t\t\tif(fpath.slice(-1) != \"/\") fpath += \"/\";\n\t\t\tfpath = (fpath + name).replace(\"//\",\"/\");\n\t\t}\n\t\tfile = ({name: filename(name), type: 2}/*:any*/);\n\t\tcfb.FileIndex.push(file);\n\t\tcfb.FullPaths.push(fpath);\n\t\tif(!unsafe) CFB.utils.cfb_gc(cfb);\n\t}\n\t/*:: if(!file) throw new Error(\"unreachable\"); */\n\tfile.content = (content/*:any*/);\n\tfile.size = content ? content.length : 0;\n\tif(opts) {\n\t\tif(opts.CLSID) file.clsid = opts.CLSID;\n\t\tif(opts.mt) file.mt = opts.mt;\n\t\tif(opts.ct) file.ct = opts.ct;\n\t}\n\treturn file;\n}\n\nfunction cfb_del(cfb/*:CFBContainer*/, name/*:string*/)/*:boolean*/ {\n\tinit_cfb(cfb);\n\tvar file = CFB.find(cfb, name);\n\tif(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\n\t\tcfb.FileIndex.splice(j, 1);\n\t\tcfb.FullPaths.splice(j, 1);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction cfb_mov(cfb/*:CFBContainer*/, old_name/*:string*/, new_name/*:string*/)/*:boolean*/ {\n\tinit_cfb(cfb);\n\tvar file = CFB.find(cfb, old_name);\n\tif(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\n\t\tcfb.FileIndex[j].name = filename(new_name);\n\t\tcfb.FullPaths[j] = new_name;\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction cfb_gc(cfb/*:CFBContainer*/)/*:void*/ { rebuild_cfb(cfb, true); }\n\nexports.find = find;\nexports.read = read;\nexports.parse = parse;\nexports.write = write;\nexports.writeFile = write_file;\nexports.utils = {\n\tcfb_new: cfb_new,\n\tcfb_add: cfb_add,\n\tcfb_del: cfb_del,\n\tcfb_mov: cfb_mov,\n\tcfb_gc: cfb_gc,\n\tReadShift: ReadShift,\n\tCheckField: CheckField,\n\tprep_blob: prep_blob,\n\tbconcat: bconcat,\n\tuse_zlib: use_zlib,\n\t_deflateRaw: _deflate,\n\t_inflateRaw: _inflate,\n\tconsts: consts\n};\n\nreturn exports;\n})();\n\nvar _fs;\nfunction set_fs(fs) { _fs = fs; }\n\n/* normalize data for blob ctor */\nfunction blobify(data) {\n\tif(typeof data === \"string\") return s2ab(data);\n\tif(Array.isArray(data)) return a2u(data);\n\treturn data;\n}\n/* write or download file */\nfunction write_dl(fname/*:string*/, payload/*:any*/, enc/*:?string*/) {\n\t/*global IE_SaveFile, Blob, navigator, saveAs, document, File, chrome */\n\tif(typeof _fs !== 'undefined' && _fs.writeFileSync) return enc ? _fs.writeFileSync(fname, payload, enc) : _fs.writeFileSync(fname, payload);\n\tif(typeof Deno !== 'undefined') {\n\t\t/* in this spot, it's safe to assume typed arrays and TextEncoder/TextDecoder exist */\n\t\tif(enc && typeof payload == \"string\") switch(enc) {\n\t\t\tcase \"utf8\": payload = new TextEncoder(enc).encode(payload); break;\n\t\t\tcase \"binary\": payload = s2ab(payload); break;\n\t\t\t/* TODO: binary equivalent */\n\t\t\tdefault: throw new Error(\"Unsupported encoding \" + enc);\n\t\t}\n\t\treturn Deno.writeFileSync(fname, payload);\n\t}\n\tvar data = (enc == \"utf8\") ? utf8write(payload) : payload;\n\t/*:: declare var IE_SaveFile: any; */\n\tif(typeof IE_SaveFile !== 'undefined') return IE_SaveFile(data, fname);\n\tif(typeof Blob !== 'undefined') {\n\t\tvar blob = new Blob([blobify(data)], {type:\"application/octet-stream\"});\n\t\t/*:: declare var navigator: any; */\n\t\tif(typeof navigator !== 'undefined' && navigator.msSaveBlob) return navigator.msSaveBlob(blob, fname);\n\t\t/*:: declare var saveAs: any; */\n\t\tif(typeof saveAs !== 'undefined') return saveAs(blob, fname);\n\t\tif(typeof URL !== 'undefined' && typeof document !== 'undefined' && document.createElement && URL.createObjectURL) {\n\t\t\tvar url = URL.createObjectURL(blob);\n\t\t\t/*:: declare var chrome: any; */\n\t\t\tif(typeof chrome === 'object' && typeof (chrome.downloads||{}).download == \"function\") {\n\t\t\t\tif(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\t\t\treturn chrome.downloads.download({ url: url, filename: fname, saveAs: true });\n\t\t\t}\n\t\t\tvar a = document.createElement(\"a\");\n\t\t\tif(a.download != null) {\n\t\t\t\t/*:: if(document.body == null) throw new Error(\"unreachable\"); */\n\t\t\t\ta.download = fname; a.href = url; document.body.appendChild(a); a.click();\n\t\t\t\t/*:: if(document.body == null) throw new Error(\"unreachable\"); */ document.body.removeChild(a);\n\t\t\t\tif(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\t\t\treturn url;\n\t\t\t}\n\t\t} else if(typeof URL !== 'undefined' && !URL.createObjectURL && typeof chrome === 'object') {\n\t\t\t/* manifest v3 extensions -- no URL.createObjectURL */\n\t\t\tvar b64 = \"data:application/octet-stream;base64,\" + Base64_encode_arr(new Uint8Array(blobify(data)));\n\t\t\treturn chrome.downloads.download({ url: b64, filename: fname, saveAs: true });\n\t\t}\n\t}\n\t// $FlowIgnore\n\tif(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\n\t\t// $FlowIgnore\n\t\tvar out = File(fname); out.open(\"w\"); out.encoding = \"binary\";\n\t\tif(Array.isArray(payload)) payload = a2s(payload);\n\t\tout.write(payload); out.close(); return payload;\n\t} catch(e) { if(!e.message || e.message.indexOf(\"onstruct\") == -1) throw e; }\n\tthrow new Error(\"cannot save file \" + fname);\n}\n\n/* read binary data from file */\nfunction read_binary(path/*:string*/) {\n\tif(typeof _fs !== 'undefined') return _fs.readFileSync(path);\n\tif(typeof Deno !== 'undefined') return Deno.readFileSync(path);\n\t// $FlowIgnore\n\tif(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\n\t\t// $FlowIgnore\n\t\tvar infile = File(path); infile.open(\"r\"); infile.encoding = \"binary\";\n\t\tvar data = infile.read(); infile.close();\n\t\treturn data;\n\t} catch(e) { if(!e.message || e.message.indexOf(\"onstruct\") == -1) throw e; }\n\tthrow new Error(\"Cannot access file \" + path);\n}\nfunction keys(o/*:any*/)/*:Array<any>*/ {\n\tvar ks = Object.keys(o), o2 = [];\n\tfor(var i = 0; i < ks.length; ++i) if(Object.prototype.hasOwnProperty.call(o, ks[i])) o2.push(ks[i]);\n\treturn o2;\n}\n\nfunction evert_key(obj/*:any*/, key/*:string*/)/*:EvertType*/ {\n\tvar o = ([]/*:any*/), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) if(o[obj[K[i]][key]] == null) o[obj[K[i]][key]] = K[i];\n\treturn o;\n}\n\nfunction evert(obj/*:any*/)/*:EvertType*/ {\n\tvar o = ([]/*:any*/), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\n\treturn o;\n}\n\nfunction evert_num(obj/*:any*/)/*:EvertNumType*/ {\n\tvar o = ([]/*:any*/), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i],10);\n\treturn o;\n}\n\nfunction evert_arr(obj/*:any*/)/*:EvertArrType*/ {\n\tvar o/*:EvertArrType*/ = ([]/*:any*/), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) {\n\t\tif(o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n\t\to[obj[K[i]]].push(K[i]);\n\t}\n\treturn o;\n}\n\nvar dnthresh  = /*#__PURE__*/Date.UTC(1899, 11, 30, 0, 0, 0); // -2209161600000\nvar dnthresh1 = /*#__PURE__*/Date.UTC(1899, 11, 31, 0, 0, 0); // -2209075200000\nvar dnthresh2 = /*#__PURE__*/Date.UTC(1904, 0, 1, 0, 0, 0); // -2209075200000\nfunction datenum(v/*:Date*/, date1904/*:?boolean*/)/*:number*/ {\n\tvar epoch = /*#__PURE__*/v.getTime();\n\tvar res = (epoch - dnthresh) / (24 * 60 * 60 * 1000);\n\tif(date1904) { res -= 1462; return res < -1402 ? res - 1 : res; }\n\treturn res < 60 ? res - 1 : res;\n}\nfunction numdate(v/*:number*/)/*:Date|number*/ {\n\tif(v >= 60 && v < 61) return v;\n\tvar out = new Date();\n\tout.setTime((v>60 ? v : (v+1)) * 24 * 60 * 60 * 1000 + dnthresh);\n\treturn out;\n}\n\n/* ISO 8601 Duration */\nfunction parse_isodur(s) {\n\tvar sec = 0, mt = 0, time = false;\n\tvar m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n\tif(!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n\tfor(var i = 1; i != m.length; ++i) {\n\t\tif(!m[i]) continue;\n\t\tmt = 1;\n\t\tif(i > 3) time = true;\n\t\tswitch(m[i].slice(m[i].length-1)) {\n\t\t\tcase 'Y':\n\t\t\t\tthrow new Error(\"Unsupported ISO Duration Field: \" + m[i].slice(m[i].length-1));\n\t\t\tcase 'D': mt *= 24;\n\t\t\t\t/* falls through */\n\t\t\tcase 'H': mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M':\n\t\t\t\tif(!time) throw new Error(\"Unsupported ISO Duration Field: M\");\n\t\t\t\telse mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'S': break;\n\t\t}\n\t\tsec += mt * parseInt(m[i], 10);\n\t}\n\treturn sec;\n}\n\n/* Blame https://bugs.chromium.org/p/v8/issues/detail?id=7863 for the regexide */\nvar pdre1 = /^(\\d+):(\\d+)(:\\d+)?(\\.\\d+)?$/; // HH:MM[:SS[.UUU]]\nvar pdre2 = /^(\\d+)-(\\d+)-(\\d+)$/; // YYYY-mm-dd\nvar pdre3 = /^(\\d+)-(\\d+)-(\\d+)[T ](\\d+):(\\d+)(:\\d+)?(\\.\\d+)?$/; // YYYY-mm-dd(T or space)HH:MM[:SS[.UUU]], sans \"Z\"\n/* parses a date string as a UTC date */\nfunction parseDate(str/*:string*/, date1904/*:boolean*/)/*:Date*/ {\n\tif(str instanceof Date) return str;\n\tvar m = str.match(pdre1);\n\tif(m) return new Date((date1904 ? dnthresh2 : dnthresh1) + ((parseInt(m[1], 10)*60 + parseInt(m[2], 10))*60 + (m[3] ? parseInt(m[3].slice(1), 10) : 0))*1000 + (m[4] ? parseInt((m[4]+\"000\").slice(1,4), 10) : 0));\n\tm = str.match(pdre2);\n\tif(m) return new Date(Date.UTC(+m[1], +m[2]-1, +m[3], 0, 0, 0, 0));\n\t/* TODO: 1900-02-29T00:00:00.000 should return a flag to treat as a date code (affects xlml) */\n\tm = str.match(pdre3);\n\tif(m) return new Date(Date.UTC(+m[1], +m[2]-1, +m[3], +m[4], +m[5], ((m[6] && parseInt(m[6].slice(1), 10))|| 0), ((m[7] && parseInt((m[7] + \"0000\").slice(1,4), 10))||0)));\n\tvar d = new Date(str);\n\treturn d;\n}\n\nfunction cc2str(arr/*:Array<number>*/, debomit)/*:string*/ {\n\tif(has_buf && Buffer.isBuffer(arr)) {\n\t\tif(debomit && buf_utf16le) {\n\t\t\t// TODO: temporary patch\n\t\t\tif(arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(arr.slice(2).toString(\"utf16le\"));\n\t\t\tif(arr[1] == 0xFE && arr[2] == 0xFF) return utf8write(utf16beread(arr.slice(2).toString(\"binary\")));\n\t\t}\n\t\treturn arr.toString(\"binary\");\n\t}\n\n\tif(typeof TextDecoder !== \"undefined\") try {\n\t\tif(debomit) {\n\t\t\tif(arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(new TextDecoder(\"utf-16le\").decode(arr.slice(2)));\n\t\t\tif(arr[0] == 0xFE && arr[1] == 0xFF) return utf8write(new TextDecoder(\"utf-16be\").decode(arr.slice(2)));\n\t\t}\n\t\tvar rev = {\n\t\t\t\"\\u20ac\": \"\\x80\", \"\\u201a\": \"\\x82\", \"\\u0192\": \"\\x83\", \"\\u201e\": \"\\x84\",\n\t\t\t\"\\u2026\": \"\\x85\", \"\\u2020\": \"\\x86\", \"\\u2021\": \"\\x87\", \"\\u02c6\": \"\\x88\",\n\t\t\t\"\\u2030\": \"\\x89\", \"\\u0160\": \"\\x8a\", \"\\u2039\": \"\\x8b\", \"\\u0152\": \"\\x8c\",\n\t\t\t\"\\u017d\": \"\\x8e\", \"\\u2018\": \"\\x91\", \"\\u2019\": \"\\x92\", \"\\u201c\": \"\\x93\",\n\t\t\t\"\\u201d\": \"\\x94\", \"\\u2022\": \"\\x95\", \"\\u2013\": \"\\x96\", \"\\u2014\": \"\\x97\",\n\t\t\t\"\\u02dc\": \"\\x98\", \"\\u2122\": \"\\x99\", \"\\u0161\": \"\\x9a\", \"\\u203a\": \"\\x9b\",\n\t\t\t\"\\u0153\": \"\\x9c\", \"\\u017e\": \"\\x9e\", \"\\u0178\": \"\\x9f\"\n\t\t};\n\t\tif(Array.isArray(arr)) arr = new Uint8Array(arr);\n\t\treturn new TextDecoder(\"latin1\").decode(arr).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g, function(c) { return rev[c] || c; });\n\t} catch(e) {}\n\n\tvar o = [], i = 0;\n\t// this cascade is for the browsers and runtimes of antiquity (and for modern runtimes that lack TextEncoder)\n\ttry {\n\t\tfor(i = 0; i < arr.length - 65536; i+=65536) o.push(String.fromCharCode.apply(0, arr.slice(i, i + 65536)));\n\t\to.push(String.fromCharCode.apply(0, arr.slice(i)));\n\t} catch(e) { try {\n\t\t\tfor(; i < arr.length - 16384; i+=16384) o.push(String.fromCharCode.apply(0, arr.slice(i, i + 16384)));\n\t\t\to.push(String.fromCharCode.apply(0, arr.slice(i)));\n\t\t} catch(e) {\n\t\t\tfor(; i != arr.length; ++i) o.push(String.fromCharCode(arr[i]));\n\t\t}\n\t}\n\treturn o.join(\"\");\n}\n\nfunction dup(o/*:any*/)/*:any*/ {\n\tif(typeof JSON != 'undefined' && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));\n\tif(typeof o != 'object' || o == null) return o;\n\tif(o instanceof Date) return new Date(o.getTime());\n\tvar out = {};\n\tfor(var k in o) if(Object.prototype.hasOwnProperty.call(o, k)) out[k] = dup(o[k]);\n\treturn out;\n}\n\nfunction fill(c/*:string*/,l/*:number*/)/*:string*/ { var o = \"\"; while(o.length < l) o+=c; return o; }\n\n/* TODO: stress test */\nfunction fuzzynum(s/*:string*/)/*:number*/ {\n\tvar v/*:number*/ = Number(s);\n\tif(!isNaN(v)) return isFinite(v) ? v : NaN;\n\tif(!/\\d/.test(s)) return v;\n\tvar wt = 1;\n\tvar ss = s.replace(/([\\d]),([\\d])/g,\"$1$2\").replace(/[$]/g,\"\").replace(/[%]/g, function() { wt *= 100; return \"\";});\n\tif(!isNaN(v = Number(ss))) return v / wt;\n\tss = ss.replace(/[(]([^()]*)[)]/,function($$, $1) { wt = -wt; return $1;});\n\tif(!isNaN(v = Number(ss))) return v / wt;\n\treturn v;\n}\n\n/* NOTE: Chrome rejects bare times like 1:23 PM */\nvar FDRE1 = /^(0?\\d|1[0-2])(?:|:([0-5]?\\d)(?:|(\\.\\d+)(?:|:([0-5]?\\d))|:([0-5]?\\d)(|\\.\\d+)))\\s+([ap])m?$/;\nvar FDRE2 = /^([01]?\\d|2[0-3])(?:|:([0-5]?\\d)(?:|(\\.\\d+)(?:|:([0-5]?\\d))|:([0-5]?\\d)(|\\.\\d+)))$/;\nvar FDISO = /^(\\d+)-(\\d+)-(\\d+)[T ](\\d+):(\\d+)(:\\d+)(\\.\\d+)?[Z]?$/; // YYYY-mm-dd(T or space)HH:MM:SS[.UUU][Z]\n\n/* TODO: 1904 adjustment */\nvar utc_append_works = new Date(\"6/9/69 00:00 UTC\").valueOf() == -17798400000;\nfunction fuzzytime1(M) /*:Date*/ {\n\tif(!M[2]) return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), 0, 0, 0));\n\tif(M[3]) {\n\t\t\tif(M[4]) return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], +M[4], parseFloat(M[3])*1000));\n\t\t\telse return new Date(Date.UTC(1899,11,31,(M[7] == \"p\" ? 12 : 0), +M[1], +M[2], parseFloat(M[3])*1000));\n\t}\n\telse if(M[5]) return new Date(Date.UTC(1899,11,31, (+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], +M[5], M[6] ? parseFloat(M[6]) * 1000 : 0));\n\telse return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], 0, 0));\n}\nfunction fuzzytime2(M) /*:Date*/ {\n\tif(!M[2]) return new Date(Date.UTC(1899,11,31,+M[1], 0, 0, 0));\n\tif(M[3]) {\n\t\t\tif(M[4]) return new Date(Date.UTC(1899,11,31,+M[1], +M[2], +M[4], parseFloat(M[3])*1000));\n\t\t\telse return new Date(Date.UTC(1899,11,31,0, +M[1], +M[2], parseFloat(M[3])*1000));\n\t}\n\telse if(M[5]) return new Date(Date.UTC(1899,11,31, +M[1], +M[2], +M[5], M[6] ? parseFloat(M[6]) * 1000 : 0));\n\telse return new Date(Date.UTC(1899,11,31,+M[1], +M[2], 0, 0));\n}\nvar lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\nfunction fuzzydate(s/*:string*/)/*:Date*/ {\n\t// See issue 2863 -- this is technically not supported in Excel but is otherwise useful\n\tif(FDISO.test(s)) return s.indexOf(\"Z\") == -1 ? local_to_utc(new Date(s)) : new Date(s);\n\tvar lower = s.toLowerCase();\n\tvar lnos = lower.replace(/\\s+/g, \" \").trim();\n\tvar M = lnos.match(FDRE1);\n\tif(M) return fuzzytime1(M);\n\tM = lnos.match(FDRE2);\n\tif(M) return fuzzytime2(M);\n\tM = lnos.match(pdre3);\n\tif(M) return new Date(Date.UTC(+M[1], +M[2]-1, +M[3], +M[4], +M[5], ((M[6] && parseInt(M[6].slice(1), 10))|| 0), ((M[7] && parseInt((M[7] + \"0000\").slice(1,4), 10))||0)));\n\tvar o = new Date(utc_append_works && s.indexOf(\"UTC\") == -1 ? s + \" UTC\": s), n = new Date(NaN);\n\tvar y = o.getYear(), m = o.getMonth(), d = o.getDate();\n\tif(isNaN(d)) return n;\n\tif(lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\n\t\tlower = lower.replace(/[^a-z]/g,\"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,\"\");\n\t\tif(lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\n\t} else if(lower.replace(/[ap]m?/, \"\").match(/[a-z]/)) return n;\n\tif(y < 0 || y > 8099 || s.match(/[^-0-9:,\\/\\\\\\ ]/)) return n;\n\treturn o;\n}\n\nvar split_regex = /*#__PURE__*/(function() {\n\tvar safe_split_regex = \"abacaba\".split(/(:?b)/i).length == 5;\n\treturn function split_regex(str/*:string*/, re, def/*:string*/)/*:Array<string>*/ {\n\t\tif(safe_split_regex || typeof re == \"string\") return str.split(re);\n\t\tvar p = str.split(re), o = [p[0]];\n\t\tfor(var i = 1; i < p.length; ++i) { o.push(def); o.push(p[i]); }\n\t\treturn o;\n\t};\n})();\n\nfunction utc_to_local(utc) {\n\treturn new Date(utc.getUTCFullYear(), utc.getUTCMonth(), utc.getUTCDate(), utc.getUTCHours(), utc.getUTCMinutes(), utc.getUTCSeconds(), utc.getUTCMilliseconds());\n}\nfunction local_to_utc(local) {\n\treturn new Date(Date.UTC(local.getFullYear(), local.getMonth(), local.getDate(), local.getHours(), local.getMinutes(), local.getSeconds(), local.getMilliseconds()));\n}\n\nfunction remove_doctype(str) {\n\tvar preamble = str.slice(0, 1024);\n\tvar si = preamble.indexOf(\"<!DOCTYPE\");\n\tif(si == -1) return str;\n\tvar m = str.match(/<[\\w]/);\n\tif(!m) return str;\n\treturn str.slice(0, si) + str.slice(m.index);\n}\n\n/* str.match(/<!--[\\s\\S]*?-->/g) --> str_match_ng(str, \"<!--\", \"-->\") */\nfunction str_match_ng(str, s, e) {\n  var out = [];\n\n  var si = str.indexOf(s);\n  while(si > -1) {\n    var ei = str.indexOf(e, si + s.length);\n\t\tif(ei == -1) break;\n\n\t\tout.push(str.slice(si, ei + e.length));\n\t\tsi = str.indexOf(s, ei + e.length);\n\t}\n\n  return out.length > 0 ? out : null;\n}\n\n/* str.replace(/<!--[\\s\\S]*?-->/g, \"\") --> str_remove_ng(str, \"<!--\", \"-->\") */\nfunction str_remove_ng(str, s, e) {\n  var out = [], last = 0;\n\n  var si = str.indexOf(s);\n\tif(si == -1) return str;\n  while(si > -1) {\n\t\tout.push(str.slice(last, si));\n    var ei = str.indexOf(e, si + s.length);\n\t\tif(ei == -1) break;\n\n\t\tif((si = str.indexOf(s, (last = ei + e.length))) == -1) out.push(str.slice(last));\n\t}\n\n  return out.join(\"\");\n}\n\n/* str.match(/<tag\\b[^>]*?>([\\s\\S]*?)</tag>/) --> str_match_xml(str, \"tag\") */\nvar xml_boundary = { \" \": 1, \"\\t\": 1, \"\\r\": 1, \"\\n\": 1, \">\": 1 };\nfunction str_match_xml(str, tag) {\n\tvar si = str.indexOf('<' + tag), w = tag.length + 1, L = str.length;\n\twhile(si >= 0 && si <= L - w && !xml_boundary[str.charAt(si + w)]) si = str.indexOf('<' + tag, si+1);\n\tif(si === -1) return null;\n\tvar sf = str.indexOf(\">\", si + tag.length);\n\tif(sf === -1) return null;\n\tvar et = \"</\" + tag + \">\";\n\tvar ei = str.indexOf(et, sf);\n\tif(ei == -1) return null;\n\treturn [str.slice(si, ei + et.length), str.slice(sf + 1, ei)];\n}\n\n/* str.match(/<(?:\\w+:)?tag\\b[^<>]*?>([\\s\\S]*?)<\\/(?:\\w+:)?tag>/) --> str_match_xml(str, \"tag\") */\nvar str_match_xml_ns = /*#__PURE__*/(function() {\n\tvar str_match_xml_ns_cache = {};\n\treturn function str_match_xml_ns(str, tag) {\n\t\tvar res = str_match_xml_ns_cache[tag];\n\t\tif(!res) str_match_xml_ns_cache[tag] = res = [\n\t\t\tnew RegExp('<(?:\\\\w+:)?'+tag+'\\\\b[^<>]*>', \"g\"),\n\t\t\tnew RegExp('</(?:\\\\w+:)?'+tag+'>', \"g\")\n\t\t];\n\t\tres[0].lastIndex = res[1].lastIndex = 0;\n\t\tvar m = res[0].exec(str);\n\t\tif(!m) return null;\n\t\tvar si = m.index;\n\t\tvar sf = res[0].lastIndex;\n\t\tres[1].lastIndex = res[0].lastIndex;\n\t\tm = res[1].exec(str);\n\t\tif(!m) return null;\n\t\tvar ei = m.index;\n\t\tvar ef = res[1].lastIndex;\n\t\treturn [str.slice(si, ef), str.slice(sf, ei)];\n\t};\n})();\n\n/* str.match(/<(?:\\w+:)?tag\\b[^<>]*?>([\\s\\S]*?)<\\/(?:\\w+:)?tag>/g) --> str_match_xml_ns_g(str, \"tag\") */\nvar str_match_xml_ns_g = /*#__PURE__*/(function() {\n\tvar str_match_xml_ns_cache = {};\n\treturn function str_match_xml_ns(str, tag) {\n\t\tvar out = [];\n\t\tvar res = str_match_xml_ns_cache[tag];\n\t\tif(!res) str_match_xml_ns_cache[tag] = res = [\n\t\t\tnew RegExp('<(?:\\\\w+:)?'+tag+'\\\\b[^<>]*>', \"g\"),\n\t\t\tnew RegExp('</(?:\\\\w+:)?'+tag+'>', \"g\")\n\t\t];\n\t\tres[0].lastIndex = res[1].lastIndex = 0;\n\t\tvar m;\n\t\twhile((m = res[0].exec(str))) {\n\t\t\tvar si = m.index;\n\t\t\tres[1].lastIndex = res[0].lastIndex;\n\t\t\tm = res[1].exec(str);\n\t\t\tif(!m) return null;\n\t\t\tvar ef = res[1].lastIndex;\n\t\t\tout.push(str.slice(si, ef));\n\t\t\tres[0].lastIndex = res[1].lastIndex;\n\t\t}\n\t\treturn out.length == 0 ? null : out;\n\t};\n})();\nvar str_remove_xml_ns_g = /*#__PURE__*/(function() {\n\tvar str_remove_xml_ns_cache = {};\n\treturn function str_remove_xml_ns_g(str, tag) {\n\t\tvar out = [];\n\t\tvar res = str_remove_xml_ns_cache[tag];\n\t\tif(!res) str_remove_xml_ns_cache[tag] = res = [\n\t\t\tnew RegExp('<(?:\\\\w+:)?'+tag+'\\\\b[^<>]*>', \"g\"),\n\t\t\tnew RegExp('</(?:\\\\w+:)?'+tag+'>', \"g\")\n\t\t];\n\t\tres[0].lastIndex = res[1].lastIndex = 0;\n\t\tvar m;\n\t\tvar si = 0, ef = 0;\n\t\twhile((m = res[0].exec(str))) {\n\t\t\tsi = m.index;\n\t\t\tout.push(str.slice(ef, si));\n\t\t\tef = si;\n\t\t\tres[1].lastIndex = res[0].lastIndex;\n\t\t\tm = res[1].exec(str);\n\t\t\tif(!m) return null;\n\t\t\tef = res[1].lastIndex;\n\t\t\tres[0].lastIndex = res[1].lastIndex;\n\t\t}\n\t\tout.push(str.slice(ef));\n\t\treturn out.length == 0 ? \"\" : out.join(\"\");\n\t};\n})();\n\n/* str.match(/<(?:\\w+:)?tag\\b[^>]*?>([\\s\\S]*?)<\\/(?:\\w+:)?tag>/gi) --> str_match_xml_ns_ig(str, \"tag\") */\nvar str_match_xml_ig = /*#__PURE__*/(function() {\n\tvar str_match_xml_ns_cache = {};\n\treturn function str_match_xml_ns(str, tag) {\n\t\tvar out = [];\n\t\tvar res = str_match_xml_ns_cache[tag];\n\t\tif(!res) str_match_xml_ns_cache[tag] = res = [\n\t\t\tnew RegExp('<'+tag+'\\\\b[^<>]*>', \"ig\"),\n\t\t\tnew RegExp('</'+tag+'>', \"ig\")\n\t\t];\n\t\tres[0].lastIndex = res[1].lastIndex = 0;\n\t\tvar m;\n\t\twhile((m = res[0].exec(str))) {\n\t\t\tvar si = m.index;\n\t\t\tres[1].lastIndex = res[0].lastIndex;\n\t\t\tm = res[1].exec(str);\n\t\t\tif(!m) return null;\n\t\t\tvar ef = res[1].lastIndex;\n\t\t\tout.push(str.slice(si, ef));\n\t\t\tres[0].lastIndex = res[1].lastIndex;\n\t\t}\n\t\treturn out.length == 0 ? null : out;\n\t};\n})();\nfunction getdatastr(data)/*:?string*/ {\n\tif(!data) return null;\n\tif(data.content && data.type) return cc2str(data.content, true);\n\tif(data.data) return debom(data.data);\n\tif(data.asNodeBuffer && has_buf) return debom(data.asNodeBuffer().toString('binary'));\n\tif(data.asBinary) return debom(data.asBinary());\n\tif(data._data && data._data.getContent) return debom(cc2str(Array.prototype.slice.call(data._data.getContent(),0)));\n\treturn null;\n}\n\nfunction getdatabin(data) {\n\tif(!data) return null;\n\tif(data.data) return char_codes(data.data);\n\tif(data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n\tif(data._data && data._data.getContent) {\n\t\tvar o = data._data.getContent();\n\t\tif(typeof o == \"string\") return char_codes(o);\n\t\treturn Array.prototype.slice.call(o);\n\t}\n\tif(data.content && data.type) return data.content;\n\treturn null;\n}\n\nfunction getdata(data) { return (data && data.name.slice(-4) === \".bin\") ? getdatabin(data) : getdatastr(data); }\n\n/* Part 2 Section 10.1.2 \"Mapping Content Types\" Names are case-insensitive */\n/* OASIS does not comment on filename case sensitivity */\nfunction safegetzipfile(zip, file/*:string*/) {\n\tvar k = zip.FullPaths || keys(zip.files);\n\tvar f = file.toLowerCase().replace(/[\\/]/g, '\\\\'), g = f.replace(/\\\\/g,'\\/');\n\tfor(var i=0; i<k.length; ++i) {\n\t\tvar n = k[i].replace(/^Root Entry[\\/]/,\"\").toLowerCase();\n\t\tif(f == n || g == n) return zip.files ? zip.files[k[i]] : zip.FileIndex[i];\n\t}\n\treturn null;\n}\n\nfunction getzipfile(zip, file/*:string*/) {\n\tvar o = safegetzipfile(zip, file);\n\tif(o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n\treturn o;\n}\n\nfunction getzipdata(zip, file/*:string*/, safe/*:?boolean*/)/*:any*/ {\n\tif(!safe) return getdata(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipdata(zip, file); } catch(e) { return null; }\n}\n\nfunction getzipstr(zip, file/*:string*/, safe/*:?boolean*/)/*:?string*/ {\n\tif(!safe) return getdatastr(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipstr(zip, file); } catch(e) { return null; }\n}\n\nfunction getzipbin(zip, file/*:string*/, safe/*:?boolean*/)/*:any*/ {\n\tif(!safe) return getdatabin(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipbin(zip, file); } catch(e) { return null; }\n}\n\nfunction zipentries(zip) {\n\tvar k = zip.FullPaths || keys(zip.files), o = [];\n\tfor(var i = 0; i < k.length; ++i) if(k[i].slice(-1) != '/') o.push(k[i].replace(/^Root Entry[\\/]/, \"\"));\n\treturn o.sort();\n}\n\nfunction zip_add_file(zip, path, content) {\n\tif(zip.FullPaths) {\n\t\tif(Array.isArray(content) && typeof content[0] == \"string\") {\n\t\t\tcontent = content.join(\"\");\n\t\t}\n\t\tif(typeof content == \"string\") {\n\t\t\tvar res;\n\t\t\tif(has_buf) res = Buffer_from(content);\n\t\t\t/* TODO: investigate performance in Edge 13 */\n\t\t\t//else if(typeof TextEncoder !== \"undefined\") res = new TextEncoder().encode(content);\n\t\t\telse res = utf8decode(content);\n\t\t\treturn CFB.utils.cfb_add(zip, path, res);\n\t\t}\n\t\tCFB.utils.cfb_add(zip, path, content);\n\t}\n\telse zip.file(path, content);\n}\n\nfunction zip_new() { return CFB.utils.cfb_new(); }\n\nfunction zip_read(d, o) {\n\tswitch(o.type) {\n\t\tcase \"base64\": return CFB.read(d, { type: \"base64\" });\n\t\tcase \"binary\": return CFB.read(d, { type: \"binary\" });\n\t\tcase \"buffer\": case \"array\": return CFB.read(d, { type: \"buffer\" });\n\t}\n\tthrow new Error(\"Unrecognized type \" + o.type);\n}\n\nfunction resolve_path(path/*:string*/, base/*:string*/)/*:string*/ {\n\tif(path.charAt(0) == \"/\") return path.slice(1);\n\tvar result = base.split('/');\n\tif(base.slice(-1) != \"/\") result.pop(); // folder path\n\tvar target = path.split('/');\n\twhile (target.length !== 0) {\n\t\tvar step = target.shift();\n\t\tif (step === '..') result.pop();\n\t\telse if (step !== '.') result.push(step);\n\t}\n\treturn result.join('/');\n}\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\nvar attregexg=/\\s([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\nvar tagregex1=/<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?<>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\"<>\\s=]+))*\\s*[\\/\\?]?>/mg, tagregex2 = /<[^<>]*>/g;\nvar tagregex = /*#__PURE__*/XML_HEADER.match(tagregex1) ? tagregex1 : tagregex2;\nvar nsregex=/<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\nfunction parsexmltag(tag/*:string*/, skip_root/*:?boolean*/, skip_LC/*:?boolean*/)/*:any*/ {\n\tvar z = ({}/*:any*/);\n\tvar eq = 0, c = 0;\n\tfor(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\tif(!skip_root) z[0] = tag.slice(0, eq);\n\tif(eq === tag.length) return z;\n\tvar m = tag.match(attregexg), j=0, v=\"\", i=0, q=\"\", cc=\"\", quot = 1;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\tcc = m[i].slice(1);\n\t\tfor(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\n\t\tq = cc.slice(0,c).trim();\n\t\twhile(cc.charCodeAt(c+1) == 32) ++c;\n\t\tquot = ((eq=cc.charCodeAt(c+1)) == 34 || eq == 39) ? 1 : 0;\n\t\tv = cc.slice(c+1+quot, cc.length-quot);\n\t\tfor(j=0;j!=q.length;++j) if(q.charCodeAt(j) === 58) break;\n\t\tif(j===q.length) {\n\t\t\tif(q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\n\t\t\tz[q] = v;\n\t\t\tif(!skip_LC) z[q.toLowerCase()] = v;\n\t\t}\n\t\telse {\n\t\t\tvar k = (j===5 && q.slice(0,5)===\"xmlns\"?\"xmlns\":\"\")+q.slice(j+1);\n\t\t\tif(z[k] && q.slice(j-3,j) == \"ext\") continue; // from ods\n\t\t\tz[k] = v;\n\t\t\tif(!skip_LC) z[k.toLowerCase()] = v;\n\t\t}\n\t}\n\treturn z;\n}\nfunction parsexmltagraw(tag/*:string*/, skip_root/*:?boolean*/, skip_LC/*:?boolean*/)/*:any*/ {\n\tvar z = ({}/*:any*/);\n\tvar eq = 0, c = 0;\n\tfor(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\tif(!skip_root) z[0] = tag.slice(0, eq);\n\tif(eq === tag.length) return z;\n\tvar m = tag.match(attregexg), j=0, v=\"\", i=0, q=\"\", cc=\"\", quot = 1;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\tcc = m[i].slice(1);\n\t\tfor(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\n\t\tq = cc.slice(0,c).trim();\n\t\twhile(cc.charCodeAt(c+1) == 32) ++c;\n\t\tquot = ((eq=cc.charCodeAt(c+1)) == 34 || eq == 39) ? 1 : 0;\n\t\tv = cc.slice(c+1+quot, cc.length-quot);\n\t\tif(q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\n\t\tz[q] = v;\n\t\tif(!skip_LC) z[q.toLowerCase()] = v;\n\t}\n\treturn z;\n}\nfunction strip_ns(x/*:string*/)/*:string*/ { return x.replace(nsregex2, \"<$1\"); }\n\nvar encodings = {\n\t'&quot;': '\"',\n\t'&apos;': \"'\",\n\t'&gt;': '>',\n\t'&lt;': '<',\n\t'&amp;': '&'\n};\nvar rencoding = /*#__PURE__*/evert(encodings);\n//var rencstr = \"&<>'\\\"\".split(\"\");\n\n// TODO: CP remap (need to read file version to determine OS)\nvar unescapexml/*:StringConv*/ = /*#__PURE__*/(function() {\n\t/* 22.4.2.4 bstr (Basic String) */\n\tvar encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/ig, coderegex = /_x([\\da-fA-F]{4})_/ig;\n\tfunction raw_unescapexml(text/*:string*/)/*:string*/ {\n\t\tvar s = text + '', i = s.indexOf(\"<![CDATA[\");\n\t\tif(i == -1) return s.replace(encregex, function($$, $1) { return encodings[$$]||String.fromCharCode(parseInt($1,$$.indexOf(\"x\")>-1?16:10))||$$; }).replace(coderegex,function(m,c) {return String.fromCharCode(parseInt(c,16));});\n\t\tvar j = s.indexOf(\"]]>\");\n\t\treturn raw_unescapexml(s.slice(0, i)) + s.slice(i+9,j) + raw_unescapexml(s.slice(j+3));\n\t}\n\treturn function unescapexml(text/*:string*/, xlsx/*:boolean*/) {\n\t\tvar out = raw_unescapexml(text);\n\t\treturn xlsx ? out.replace(/\\r\\n/g, \"\\n\") : out;\n\t};\n})();\n\nvar decregex=/[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f\\uFFFE-\\uFFFF]/g;\nfunction escapexml(text/*:string*/)/*:string*/{\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(charegex,function(s) { return \"_x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \"_\";});\n}\nfunction escapexmltag(text/*:string*/)/*:string*/{ return escapexml(text).replace(/ /g,\"_x0020_\"); }\n\nvar htmlcharegex = /[\\u0000-\\u001f]/g;\nfunction escapehtml(text/*:string*/)/*:string*/{\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(/\\n/g, \"<br/>\").replace(htmlcharegex,function(s) { return \"&#x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \";\"; });\n}\n\nfunction escapexlml(text/*:string*/)/*:string*/{\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(htmlcharegex,function(s) { return \"&#x\" + (s.charCodeAt(0).toString(16)).toUpperCase() + \";\"; });\n}\n\n/* TODO: handle codepages */\nvar xlml_fixstr/*:StringConv*/ = /*#__PURE__*/(function() {\n\tvar entregex = /&#(\\d+);/g;\n\tfunction entrepl($$/*:string*/,$1/*:string*/)/*:string*/ { return String.fromCharCode(parseInt($1,10)); }\n\treturn function xlml_fixstr(str/*:string*/)/*:string*/ { return str.replace(entregex,entrepl); };\n})();\nfunction xlml_unfixstr(str/*:string*/)/*:string*/ { return str.replace(/(\\r\\n|[\\r\\n])/g,\"\\&#10;\"); }\n\n/* note: xsd:boolean valid values: true / 1 / false / 0 */\nfunction parsexmlbool(value/*:any*/)/*:boolean*/ {\n\tswitch(value) {\n\t\tcase 1: case true:  case '1': case 'true':  return true;\n\t\tcase 0: case false: case '0': case 'false': return false;\n\t\t//default: throw new Error(\"Invalid xsd:boolean \" + value);\n\t}\n\treturn false;\n}\n\nfunction utf8reada(orig/*:string*/)/*:string*/ {\n\tvar out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\n\twhile (i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tif (c < 128) { out += String.fromCharCode(c); continue; }\n\t\td = orig.charCodeAt(i++);\n\t\tif (c>191 && c<224) { f = ((c & 31) << 6); f |= (d & 63); out += String.fromCharCode(f); continue; }\n\t\te = orig.charCodeAt(i++);\n\t\tif (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\n\t\tf = orig.charCodeAt(i++);\n\t\tw = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63))-65536;\n\t\tout += String.fromCharCode(0xD800 + ((w>>>10)&1023));\n\t\tout += String.fromCharCode(0xDC00 + (w&1023));\n\t}\n\treturn out;\n}\n\nfunction utf8readb(data) {\n\tvar out = new_raw_buf(2*data.length), w, i, j = 1, k = 0, ww=0, c;\n\tfor(i = 0; i < data.length; i+=j) {\n\t\tj = 1;\n\t\tif((c=data.charCodeAt(i)) < 128) w = c;\n\t\telse if(c < 224) { w = (c&31)*64+(data.charCodeAt(i+1)&63); j=2; }\n\t\telse if(c < 240) { w=(c&15)*4096+(data.charCodeAt(i+1)&63)*64+(data.charCodeAt(i+2)&63); j=3; }\n\t\telse { j = 4;\n\t\t\tw = (c & 7)*262144+(data.charCodeAt(i+1)&63)*4096+(data.charCodeAt(i+2)&63)*64+(data.charCodeAt(i+3)&63);\n\t\t\tw -= 65536; ww = 0xD800 + ((w>>>10)&1023); w = 0xDC00 + (w&1023);\n\t\t}\n\t\tif(ww !== 0) { out[k++] = ww&255; out[k++] = ww>>>8; ww = 0; }\n\t\tout[k++] = w%256; out[k++] = w>>>8;\n\t}\n\treturn out.slice(0,k).toString('ucs2');\n}\n\nfunction utf8readc(data) { return Buffer_from(data, 'binary').toString('utf8'); }\n\nvar utf8corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\nvar utf8read = has_buf && (/*#__PURE__*/utf8readc(utf8corpus) == /*#__PURE__*/utf8reada(utf8corpus) && utf8readc || /*#__PURE__*/utf8readb(utf8corpus) == /*#__PURE__*/utf8reada(utf8corpus) && utf8readb) || utf8reada;\n\nvar utf8write/*:StringConv*/ = has_buf ? function(data) { return Buffer_from(data, 'utf8').toString(\"binary\"); } : function(orig/*:string*/)/*:string*/ {\n\tvar out/*:Array<string>*/ = [], i = 0, c = 0, d = 0;\n\twhile(i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tswitch(true) {\n\t\t\tcase c < 128: out.push(String.fromCharCode(c)); break;\n\t\t\tcase c < 2048:\n\t\t\t\tout.push(String.fromCharCode(192 + (c >> 6)));\n\t\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t\t\tbreak;\n\t\t\tcase c >= 55296 && c < 57344:\n\t\t\t\tc -= 55296; d = orig.charCodeAt(i++) - 56320 + (c<<10);\n\t\t\t\tout.push(String.fromCharCode(240 + ((d >>18) & 7)));\n\t\t\t\tout.push(String.fromCharCode(144 + ((d >>12) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + ((d >> 6) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + (d & 63)));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tout.push(String.fromCharCode(224 + (c >> 12)));\n\t\t\t\tout.push(String.fromCharCode(128 + ((c >> 6) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t}\n\t}\n\treturn out.join(\"\");\n};\n\nvar htmldecode/*:{(s:string):string}*/ = /*#__PURE__*/(function() {\n\tvar entities/*:Array<[RegExp, string]>*/ = [\n\t\t['nbsp', ' '], ['middot', '·'],\n\t\t['quot', '\"'], ['apos', \"'\"], ['gt',   '>'], ['lt',   '<'], ['amp',  '&']\n\t].map(function(x/*:[string, string]*/) { return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]]; });\n\treturn function htmldecode(str/*:string*/)/*:string*/ {\n\t\tvar o = str\n\t\t\t\t// Remove new lines and spaces from start of content\n\t\t\t\t.replace(/^[\\t\\n\\r ]+/, \"\")\n\t\t\t\t// Remove new lines and spaces from end of content\n\t\t\t\t.replace(/(^|[^\\t\\n\\r ])[\\t\\n\\r ]+$/,\"$1\")\n\t\t\t\t// Added line which removes any white space characters after and before html tags\n\t\t\t\t.replace(/>\\s+/g,\">\").replace(/\\b\\s+</g,\"<\")\n\t\t\t\t// Replace remaining new lines and spaces with space\n\t\t\t\t.replace(/[\\t\\n\\r ]+/g, \" \")\n\t\t\t\t// Replace <br> tags with new lines\n\t\t\t\t.replace(/<\\s*[bB][rR]\\s*\\/?>/g,\"\\n\")\n\t\t\t\t// Strip HTML elements\n\t\t\t\t.replace(/<[^<>]*>/g,\"\");\n\t\tfor(var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\n\t\treturn o;\n\t};\n})();\n\nvar vtvregex = /<\\/?(?:vt:)?variant>/g, vtmregex = /<(?:vt:)([^<\"'>]*)>([\\s\\S]*)</;\nfunction parseVector(data/*:string*/, opts)/*:Array<{v:string,t:string}>*/ {\n\tvar h = parsexmltag(data);\n\n\tvar matches/*:Array<string>*/ = str_match_xml_ns_g(data, h.baseType)||[];\n\tvar res/*:Array<any>*/ = [];\n\tif(matches.length != h.size) {\n\t\tif(opts.WTF) throw new Error(\"unexpected vector length \" + matches.length + \" != \" + h.size);\n\t\treturn res;\n\t}\n\tmatches.forEach(function(x/*:string*/) {\n\t\tvar v = x.replace(vtvregex,\"\").match(vtmregex);\n\t\tif(v) res.push({v:utf8read(v[2]), t:v[1]});\n\t});\n\treturn res;\n}\n\nvar wtregex = /(^\\s|\\s$|\\n)/;\nfunction writetag(f/*:string*/,g/*:string*/)/*:string*/ { return '<' + f + (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>'; }\n\nfunction wxt_helper(h)/*:string*/ { return keys(h).map(function(k) { return \" \" + k + '=\"' + h[k] + '\"';}).join(\"\"); }\nfunction writextag(f/*:string*/,g/*:?string*/,h) { return '<' + f + ((h != null) ? wxt_helper(h) : \"\") + ((g != null) ? (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';}\n\nfunction write_w3cdtf(d/*:Date*/, t/*:?boolean*/)/*:string*/ { try { return d.toISOString().replace(/\\.\\d*/,\"\"); } catch(e) { if(t) throw e; } return \"\"; }\n\nfunction write_vt(s, xlsx/*:?boolean*/)/*:string*/ {\n\tswitch(typeof s) {\n\t\tcase 'string':\n\t\t\tvar o = writextag('vt:lpwstr', escapexml(s));\n\t\t\tif(xlsx) o = o.replace(/&quot;/g, \"_x0022_\");\n\t\t\treturn o;\n\t\tcase 'number': return writextag((s|0)==s?'vt:i4':'vt:r8', escapexml(String(s)));\n\t\tcase 'boolean': return writextag('vt:bool',s?'true':'false');\n\t}\n\tif(s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n\tthrow new Error(\"Unable to serialize \" + s);\n}\n\nfunction xlml_normalize(d)/*:string*/ {\n\tif(has_buf &&/*::typeof Buffer !== \"undefined\" && d != null && d instanceof Buffer &&*/ Buffer.isBuffer(d)) return d.toString('utf8');\n\tif(typeof d === 'string') return d;\n\t/* duktape */\n\tif(typeof Uint8Array !== 'undefined' && d instanceof Uint8Array) return utf8read(a2s(ab2a(d)));\n\tthrow new Error(\"Bad input format: expected Buffer or string\");\n}\n/* UOS uses CJK in tags, ODS uses invalid XML */\nvar xlmlregex = /<([\\/]?)([^\\s?><!\\/:\"]*:|)([^\\s?<>:\\/\"]+)(?:\\s+[^<>=?\"'\\s]+=\"[^\"]*?\")*\\s*[\\/]?>/mg;\n\nvar XMLNS = ({\n\tCORE_PROPS: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n\tCUST_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",\n\tEXT_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",\n\tCT: 'http://schemas.openxmlformats.org/package/2006/content-types',\n\tRELS: 'http://schemas.openxmlformats.org/package/2006/relationships',\n\tTCMNT: 'http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments',\n\t'dc': 'http://purl.org/dc/elements/1.1/',\n\t'dcterms': 'http://purl.org/dc/terms/',\n\t'dcmitype': 'http://purl.org/dc/dcmitype/',\n\t'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n\t'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n\t'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n\t'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n\t'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n\t'xsd': 'http://www.w3.org/2001/XMLSchema'\n}/*:any*/);\n\nvar XMLNS_main = [\n\t'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n\t'http://purl.oclc.org/ooxml/spreadsheetml/main',\n\t'http://schemas.microsoft.com/office/excel/2006/main',\n\t'http://schemas.microsoft.com/office/excel/2006/2'\n];\n\nvar XLMLNS = ({\n\t'o':    'urn:schemas-microsoft-com:office:office',\n\t'x':    'urn:schemas-microsoft-com:office:excel',\n\t'ss':   'urn:schemas-microsoft-com:office:spreadsheet',\n\t'dt':   'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882',\n\t'mv':   'http://macVmlSchemaUri',\n\t'v':    'urn:schemas-microsoft-com:vml',\n\t'html': 'http://www.w3.org/TR/REC-html40'\n}/*:any*/);\nfunction read_double_le(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ {\n\tvar s = 1 - 2 * (b[idx + 7] >>> 7);\n\tvar e = ((b[idx + 7] & 0x7f) << 4) + ((b[idx + 6] >>> 4) & 0x0f);\n\tvar m = (b[idx+6]&0x0f);\n\tfor(var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\n\tif(e == 0x7ff) return m == 0 ? (s * Infinity) : NaN;\n\tif(e == 0) e = -1022;\n\telse { e -= 1023; m += Math.pow(2,52); }\n\treturn s * Math.pow(2, e - 52) * m;\n}\n\nfunction write_double_le(b/*:RawBytes|CFBlob*/, v/*:number*/, idx/*:number*/) {\n\tvar bs = ((((v < 0) || (1/v == -Infinity)) ? 1 : 0) << 7), e = 0, m = 0;\n\tvar av = bs ? (-v) : v;\n\tif(!isFinite(av)) { e = 0x7ff; m = isNaN(v) ? 0x6969 : 0; }\n\telse if(av == 0) e = m = 0;\n\telse {\n\t\te = Math.floor(Math.log(av) / Math.LN2);\n\t\tm = av * Math.pow(2, 52 - e);\n\t\tif((e <= -1023) && (!isFinite(m) || (m < Math.pow(2,52)))) { e = -1022; }\n\t\telse { m -= Math.pow(2,52); e+=1023; }\n\t}\n\tfor(var i = 0; i <= 5; ++i, m/=256) b[idx + i] = m & 0xff;\n\tb[idx + 6] = ((e & 0x0f) << 4) | (m & 0xf);\n\tb[idx + 7] = (e >> 4) | bs;\n}\n\nvar ___toBuffer = function(bufs/*:Array<Array<RawBytes> >*/)/*:RawBytes*/ { var x=[],w=10240; for(var i=0;i<bufs[0].length;++i) if(bufs[0][i]) for(var j=0,L=bufs[0][i].length;j<L;j+=w) x.push.apply(x, bufs[0][i].slice(j,j+w)); return x; };\nvar __toBuffer = has_buf ? function(bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0].map(function(x) { return Buffer.isBuffer(x) ? x : Buffer_from(x); })) : ___toBuffer(bufs);} : ___toBuffer;\n\nvar ___utf16le = function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/)/*:string*/ { var ss/*:Array<string>*/=[]; for(var i=s; i<e; i+=2) ss.push(String.fromCharCode(__readUInt16LE(b,i))); return ss.join(\"\").replace(chr0,''); };\nvar __utf16le = has_buf ? function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/)/*:string*/ { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/ || !buf_utf16le) return ___utf16le(b,s,e); return b.toString('utf16le',s,e).replace(chr0,'')/*.replace(chr1,'!')*/; } : ___utf16le;\n\nvar ___hexlify = function(b/*:RawBytes|CFBlob*/,s/*:number*/,l/*:number*/)/*:string*/ { var ss/*:Array<string>*/=[]; for(var i=s; i<s+l; ++i) ss.push((\"0\" + b[i].toString(16)).slice(-2)); return ss.join(\"\"); };\nvar __hexlify = has_buf ? function(b/*:RawBytes|CFBlob*/,s/*:number*/,l/*:number*/)/*:string*/ { return Buffer.isBuffer(b)/*:: && b instanceof Buffer*/ ? b.toString('hex',s,s+l) : ___hexlify(b,s,l); } : ___hexlify;\n\nvar ___utf8 = function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/) { var ss=[]; for(var i=s; i<e; i++) ss.push(String.fromCharCode(__readUInt8(b,i))); return ss.join(\"\"); };\nvar __utf8 = has_buf ? function utf8_b(b/*:RawBytes|CFBlob*/, s/*:number*/, e/*:number*/) { return (Buffer.isBuffer(b)/*:: && (b instanceof Buffer)*/) ? b.toString('utf8',s,e) : ___utf8(b,s,e); } : ___utf8;\n\nvar ___lpstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpstr = ___lpstr;\n\nvar ___cpstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __cpstr = ___cpstr;\n\nvar ___lpwstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = 2*__readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpwstr = ___lpwstr;\n\nvar ___lpp4 = function lpp4_(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? __utf16le(b, i+4,i+4+len) : \"\";};\nvar __lpp4 = ___lpp4;\n\nvar ___8lpp4 = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len) : \"\";};\nvar __8lpp4 = ___8lpp4;\n\nvar ___double = function(b/*:RawBytes|CFBlob*/, idx/*:number*/) { return read_double_le(b, idx);};\nvar __double = ___double;\n\nvar is_buf = function is_buf_a(a) { return Array.isArray(a) || (typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array); };\n\nif(has_buf/*:: && typeof Buffer !== 'undefined'*/) {\n\t__lpstr = function lpstr_b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__cpstr = function cpstr_b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___cpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__lpwstr = function lpwstr_b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/ || !buf_utf16le) return ___lpwstr(b, i); var len = 2*b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len-1);};\n\t__lpp4 = function lpp4_b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/ || !buf_utf16le) return ___lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len);};\n\t__8lpp4 = function lpp4_8b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___8lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf8',i+4,i+4+len);};\n\t__double = function double_(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(Buffer.isBuffer(b)/*::&& b instanceof Buffer*/) return b.readDoubleLE(i); return ___double(b,i); };\n\tis_buf = function is_buf_b(a) { return Buffer.isBuffer(a) || Array.isArray(a) || (typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array); };\n}\n\n/* from js-xls */\nfunction cpdoit() {\n\t__utf16le = function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/) { return $cptable.utils.decode(1200, b.slice(s,e)).replace(chr0, ''); };\n\t__utf8 = function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/) { return $cptable.utils.decode(65001, b.slice(s,e)); };\n\t__lpstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(current_ansi, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__cpstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(current_codepage, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__lpwstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = 2*__readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(1200, b.slice(i+4,i+4+len-1)) : \"\";};\n\t__lpp4 = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(1200, b.slice(i+4,i+4+len)) : \"\";};\n\t__8lpp4 = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(65001, b.slice(i+4,i+4+len)) : \"\";};\n}\nif(typeof $cptable !== 'undefined') cpdoit();\n\nvar __readUInt8 = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return b[idx]; };\nvar __readUInt16LE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return (b[idx+1]*(1<<8))+b[idx]; };\nvar __readInt16LE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { var u = (b[idx+1]*(1<<8))+b[idx]; return (u < 0x8000) ? u : ((0xffff - u + 1) * -1); };\nvar __readUInt32LE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]; };\nvar __readInt32LE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return (b[idx+3]<<24)|(b[idx+2]<<16)|(b[idx+1]<<8)|b[idx]; };\nvar __readInt32BE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return (b[idx]<<24)|(b[idx+1]<<16)|(b[idx+2]<<8)|b[idx+3]; };\n\nfunction ReadShift(size/*:number*/, t/*:?string*/)/*:number|string*/ {\n\tvar o=\"\", oI/*:: :number = 0*/, oR, oo=[], w, vv, i, loc;\n\tswitch(t) {\n\t\tcase 'dbcs':\n\t\t\tloc = this.l;\n\t\t\tif(has_buf && Buffer.isBuffer(this)  && buf_utf16le) o = this.slice(this.l, this.l+2*size).toString(\"utf16le\");\n\t\t\telse for(i = 0; i < size; ++i) { o+=String.fromCharCode(__readUInt16LE(this, loc)); loc+=2; }\n\t\t\tsize *= 2;\n\t\t\tbreak;\n\n\t\tcase 'utf8': o = __utf8(this, this.l, this.l + size); break;\n\t\tcase 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\n\n\t\tcase 'wstr':\n\t\t\tif(typeof $cptable !== 'undefined') o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l+2*size));\n\t\t\telse return ReadShift.call(this, size, 'dbcs');\n\t\t\tsize = 2 * size; break;\n\n\t\t/* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\t\tcase 'lpstr-ansi': o = __lpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\n\t\tcase 'lpstr-cp': o = __cpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\n\t\t/* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\t\tcase 'lpwstr': o = __lpwstr(this, this.l); size = 4 + 2 * __readUInt32LE(this, this.l); break;\n\t\t/* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */\n\t\tcase 'lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __lpp4(this, this.l); if(size & 0x02) size += 2; break;\n\t\t/* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */\n\t\tcase '8lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __8lpp4(this, this.l); if(size & 0x03) size += 4 - (size & 0x03); break;\n\n\t\tcase 'cstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt8(this, this.l + size++))!==0) oo.push(_getchar(w));\n\t\t\to = oo.join(\"\"); break;\n\t\tcase '_wstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt16LE(this,this.l +size))!==0){oo.push(_getchar(w));size+=2;}\n\t\t\tsize+=2; o = oo.join(\"\"); break;\n\n\t\t/* sbcs and dbcs support continue records in the SST way TODO codepages */\n\t\tcase 'dbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i < size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt16LE(this, loc)));\n\t\t\t\tloc+=2;\n\t\t\t} o = oo.join(\"\"); size *= 2; break;\n\n\t\tcase 'cpstr':\n\t\t\tif(typeof $cptable !== 'undefined') {\n\t\t\t\to = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + size));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t/* falls through */\n\t\tcase 'sbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i != size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt8(this, loc)));\n\t\t\t\tloc+=1;\n\t\t\t} o = oo.join(\"\"); break;\n\n\t\tdefault:\n\tswitch(size) {\n\t\tcase 1: oI = __readUInt8(this, this.l); this.l++; return oI;\n\t\tcase 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\n\t\tcase 4: case -4:\n\t\t\tif(t === 'i' || ((this[this.l+3] & 0x80)===0)) { oI = ((size > 0) ? __readInt32LE : __readInt32BE)(this, this.l); this.l += 4; return oI; }\n\t\t\telse { oR = __readUInt32LE(this, this.l); this.l += 4; } return oR;\n\t\tcase 8: case -8:\n\t\t\tif(t === 'f') {\n\t\t\t\tif(size == 8) oR = __double(this, this.l);\n\t\t\t\telse oR = __double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]], 0);\n\t\t\t\tthis.l += 8; return oR;\n\t\t\t} else size = 8;\n\t\t/* falls through */\n\t\tcase 16: o = __hexlify(this, this.l, size); break;\n\t}}\n\tthis.l+=size; return o;\n}\n\nvar __writeUInt32LE = function(b/*:RawBytes|CFBlob*/, val/*:number*/, idx/*:number*/)/*:void*/ { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); b[idx+2] = ((val >>> 16) & 0xFF); b[idx+3] = ((val >>> 24) & 0xFF); };\nvar __writeInt32LE  = function(b/*:RawBytes|CFBlob*/, val/*:number*/, idx/*:number*/)/*:void*/ { b[idx] = (val & 0xFF); b[idx+1] = ((val >> 8) & 0xFF); b[idx+2] = ((val >> 16) & 0xFF); b[idx+3] = ((val >> 24) & 0xFF); };\nvar __writeUInt16LE = function(b/*:RawBytes|CFBlob*/, val/*:number*/, idx/*:number*/)/*:void*/ { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); };\n\nfunction WriteShift(t/*:number*/, val/*:string|number*/, f/*:?string*/)/*:any*/ {\n\tvar size = 0, i = 0;\n\tif(f === 'dbcs') {\n\t\t/*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n\t\tfor(i = 0; i != val.length; ++i) __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);\n\t\tsize = 2 * val.length;\n\t} else if(f === 'sbcs' || f == 'cpstr') {\n\t\tif(typeof $cptable !== 'undefined' && current_ansi == 874) {\n\t\t\t/* TODO: use tables directly, don't encode */\n\t\t\t/*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n\t\t\tfor(i = 0; i != val.length; ++i) {\n\t\t\t\tvar cpp = $cptable.utils.encode(current_ansi, val.charAt(i));\n\t\t\t\tthis[this.l + i] = cpp[0];\n\t\t\t}\n\t\t\tsize = val.length;\n\t\t} else if(typeof $cptable !== 'undefined' && f == 'cpstr') {\n\t\t\tcpp = $cptable.utils.encode(current_codepage, val);\n\t\t\t/* replace null bytes with _ when relevant */\n      if(cpp.length == val.length) for(i = 0; i < val.length; ++i) if(cpp[i] == 0 && val.charCodeAt(i) != 0) cpp[i] = 0x5F;\n      if(cpp.length == 2 * val.length) for(i = 0; i < val.length; ++i) if(cpp[2*i] == 0 && cpp[2*i+1] == 0 && val.charCodeAt(i) != 0) cpp[2*i] = 0x5F;\n\t\t\tfor(i = 0; i < cpp.length; ++i) this[this.l + i] = cpp[i];\n\t\t\tsize = cpp.length;\n\t\t} else {\n\t\t\t/*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n\t\t\tval = val.replace(/[^\\x00-\\x7F]/g, \"_\");\n\t\t\t/*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n\t\t\tfor(i = 0; i != val.length; ++i) this[this.l + i] = (val.charCodeAt(i) & 0xFF);\n\t\t\tsize = val.length;\n\t\t}\n\t} else if(f === 'hex') {\n\t\tfor(; i < t; ++i) {\n\t\t\t/*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n\t\t\tthis[this.l++] = (parseInt(val.slice(2*i, 2*i+2), 16)||0);\n\t\t} return this;\n\t} else if(f === 'utf16le') {\n\t\t\t/*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n\t\t\tvar end/*:number*/ = Math.min(this.l + t, this.length);\n\t\t\tfor(i = 0; i < Math.min(val.length, t); ++i) {\n\t\t\t\tvar cc = val.charCodeAt(i);\n\t\t\t\tthis[this.l++] = (cc & 0xff);\n\t\t\t\tthis[this.l++] = (cc >> 8);\n\t\t\t}\n\t\t\twhile(this.l < end) this[this.l++] = 0;\n\t\t\treturn this;\n\t} else /*:: if(typeof val === 'number') */ switch(t) {\n\t\tcase  1: size = 1; this[this.l] = val&0xFF; break;\n\t\tcase  2: size = 2; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; break;\n\t\tcase  3: size = 3; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; val >>>= 8; this[this.l+2] = val&0xFF; break;\n\t\tcase  4: size = 4; __writeUInt32LE(this, val, this.l); break;\n\t\tcase  8: size = 8; if(f === 'f') { write_double_le(this, val, this.l); break; }\n\t\t/* falls through */\n\t\tcase 16: break;\n\t\tcase -4: size = 4; __writeInt32LE(this, val, this.l); break;\n\t}\n\tthis.l += size; return this;\n}\n\nfunction CheckField(hexstr/*:string*/, fld/*:string*/)/*:void*/ {\n\tvar m = __hexlify(this,this.l,hexstr.length>>1);\n\tif(m !== hexstr) throw new Error(fld + 'Expected ' + hexstr + ' saw ' + m);\n\tthis.l += hexstr.length>>1;\n}\n\nfunction prep_blob(blob, pos/*:number*/)/*:void*/ {\n\tblob.l = pos;\n\tblob.read_shift = /*::(*/ReadShift/*:: :any)*/;\n\tblob.chk = CheckField;\n\tblob.write_shift = WriteShift;\n}\n\nfunction parsenoop(blob, length/*:: :number, opts?:any */) { blob.l += length; }\n\nfunction new_buf(sz/*:number*/)/*:Block*/ {\n\tvar o = new_raw_buf(sz);\n\tprep_blob(o, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.1.4 Record */\nfunction recordhopper(data, cb/*:RecordHopperCB*/, opts/*:?any*/) {\n\tif(!data) return;\n\tvar tmpbyte, cntbyte, length;\n\tprep_blob(data, data.l || 0);\n\tvar L = data.length, RT = 0, tgt = 0;\n\twhile(data.l < L) {\n\t\tRT = data.read_shift(1);\n\t\tif(RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F)<<7);\n\t\tvar R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n\t\ttmpbyte = data.read_shift(1);\n\t\tlength = tmpbyte & 0x7F;\n\t\tfor(cntbyte = 1; cntbyte <4 && (tmpbyte & 0x80); ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F)<<(7*cntbyte);\n\t\ttgt = data.l + length;\n\t\tvar d = R.f && R.f(data, length, opts);\n\t\tdata.l = tgt;\n\t\tif(cb(d, R, RT)) return;\n\t}\n}\n\n/* control buffer usage for fixed-length buffers */\nfunction buf_array()/*:BufArray*/ {\n\tvar bufs/*:Array<Block>*/ = [], blksz = has_buf ? 16384 : 2048;\n\tvar has_buf_copy = has_buf && (typeof new_buf(blksz).copy == \"function\");\n\tvar newblk = function ba_newblk(sz/*:number*/)/*:Block*/ {\n\t\tvar o/*:Block*/ = (new_buf(sz)/*:any*/);\n\t\tprep_blob(o, 0);\n\t\treturn o;\n\t};\n\n\tvar curbuf/*:Block*/ = newblk(blksz);\n\n\tvar endbuf = function ba_endbuf() {\n\t\tif(!curbuf) return;\n\t\t// workaround for new Buffer(3).slice(0,0) bug in bun 0.1.3\n\t\tif(curbuf.l) {\n\t\t\tif(curbuf.length > curbuf.l) { curbuf = curbuf.slice(0, curbuf.l); curbuf.l = curbuf.length; }\n\t\t\tif(curbuf.length > 0) bufs.push(curbuf);\n\t\t}\n\t\tcurbuf = null;\n\t};\n\n\tvar next = function ba_next(sz/*:number*/)/*:Block*/ {\n\t\tif(curbuf && (sz < (curbuf.length - curbuf.l))) return curbuf;\n\t\tendbuf();\n\t\treturn (curbuf = newblk(Math.max(sz+1, blksz)));\n\t};\n\n\tvar end = function ba_end() {\n\t\tendbuf();\n\t\treturn bconcat(bufs);\n\t};\n\tvar end2 = function() {\n\t\tendbuf(); return bufs;\n\t};\n\n\tvar push = function ba_push(buf) {\n\t\tendbuf(); curbuf = buf; if(curbuf.l == null) curbuf.l = curbuf.length; next(blksz);\n\t};\n\n\treturn ({ next:next, push:push, end:end, _bufs:bufs, end2:end2 }/*:any*/);\n}\n\nfunction write_record(ba/*:BufArray*/, type/*:number*/, payload, length/*:?number*/) {\n\tvar t/*:number*/ = +type, l;\n\tif(isNaN(t)) return; // TODO: throw something here?\n\tif(!length) length = XLSBRecordEnum[t].p || (payload||[]).length || 0;\n\tl = 1 + (t >= 0x80 ? 1 : 0) + 1/* + length*/;\n\tif(length >= 0x80) ++l; if(length >= 0x4000) ++l; if(length >= 0x200000) ++l;\n\tvar o = ba.next(l);\n\tif(t <= 0x7F) o.write_shift(1, t);\n\telse {\n\t\to.write_shift(1, (t & 0x7F) + 0x80);\n\t\to.write_shift(1, (t >> 7));\n\t}\n\tfor(var i = 0; i != 4; ++i) {\n\t\tif(length >= 0x80) { o.write_shift(1, (length & 0x7F)+0x80); length >>= 7; }\n\t\telse { o.write_shift(1, length); break; }\n\t}\n\tif(/*:: length != null &&*/length > 0 && is_buf(payload)) ba.push(payload);\n}\n/* XLS ranges enforced */\nfunction shift_cell_xls(cell/*:CellAddress*/, tgt/*:any*/, opts/*:?any*/)/*:CellAddress*/ {\n\tvar out = dup(cell);\n\tif(tgt.s) {\n\t\tif(out.cRel) out.c += tgt.s.c;\n\t\tif(out.rRel) out.r += tgt.s.r;\n\t} else {\n\t\tif(out.cRel) out.c += tgt.c;\n\t\tif(out.rRel) out.r += tgt.r;\n\t}\n\tif(!opts || opts.biff < 12) {\n\t\twhile(out.c >= 0x100) out.c -= 0x100;\n\t\twhile(out.r >= 0x10000) out.r -= 0x10000;\n\t}\n\treturn out;\n}\n\nfunction shift_range_xls(cell, range, opts) {\n\tvar out = dup(cell);\n\tout.s = shift_cell_xls(out.s, range.s, opts);\n\tout.e = shift_cell_xls(out.e, range.s, opts);\n\treturn out;\n}\n\nfunction encode_cell_xls(c/*:CellAddress*/, biff/*:number*/)/*:string*/ {\n\tif(c.cRel && c.c < 0) { c = dup(c); while(c.c < 0) c.c += (biff > 8) ? 0x4000 : 0x100; }\n\tif(c.rRel && c.r < 0) { c = dup(c); while(c.r < 0) c.r += (biff > 8) ? 0x100000 : ((biff > 5) ? 0x10000 : 0x4000); }\n\tvar s = encode_cell(c);\n\tif(!c.cRel && c.cRel != null) s = fix_col(s);\n\tif(!c.rRel && c.rRel != null) s = fix_row(s);\n\treturn s;\n}\n\nfunction encode_range_xls(r, opts)/*:string*/ {\n\tif(r.s.r == 0 && !r.s.rRel) {\n\t\tif(r.e.r == (opts.biff >= 12 ? 0xFFFFF : (opts.biff >= 8 ? 0x10000 : 0x4000)) && !r.e.rRel) {\n\t\t\treturn (r.s.cRel ? \"\" : \"$\") + encode_col(r.s.c) + \":\" + (r.e.cRel ? \"\" : \"$\") + encode_col(r.e.c);\n\t\t}\n\t}\n\tif(r.s.c == 0 && !r.s.cRel) {\n\t\tif(r.e.c == (opts.biff >= 12 ? 0x3FFF : 0xFF) && !r.e.cRel) {\n\t\t\treturn (r.s.rRel ? \"\" : \"$\") + encode_row(r.s.r) + \":\" + (r.e.rRel ? \"\" : \"$\") + encode_row(r.e.r);\n\t\t}\n\t}\n\treturn encode_cell_xls(r.s, opts.biff) + \":\" + encode_cell_xls(r.e, opts.biff);\n}\nfunction decode_row(rowstr/*:string*/)/*:number*/ { return parseInt(unfix_row(rowstr),10) - 1; }\nfunction encode_row(row/*:number*/)/*:string*/ { return \"\" + (row + 1); }\nfunction fix_row(cstr/*:string*/)/*:string*/ { return cstr.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\"); }\nfunction unfix_row(cstr/*:string*/)/*:string*/ { return cstr.replace(/\\$(\\d+)$/,\"$1\"); }\n\nfunction decode_col(colstr/*:string*/)/*:number*/ { var c = unfix_col(colstr), d = 0, i = 0; for(; i !== c.length; ++i) d = 26*d + c.charCodeAt(i) - 64; return d - 1; }\nfunction encode_col(col/*:number*/)/*:string*/ { if(col < 0) throw new Error(\"invalid column \" + col); var s=\"\"; for(++col; col; col=Math.floor((col-1)/26)) s = String.fromCharCode(((col-1)%26) + 65) + s; return s; }\nfunction fix_col(cstr/*:string*/)/*:string*/ { return cstr.replace(/^([A-Z])/,\"$$$1\"); }\nfunction unfix_col(cstr/*:string*/)/*:string*/ { return cstr.replace(/^\\$([A-Z])/,\"$1\"); }\n\nfunction split_cell(cstr/*:string*/)/*:Array<string>*/ { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\"); }\nfunction decode_cell(cstr/*:string*/)/*:CellAddress*/ {\n\tvar R = 0, C = 0;\n\tfor(var i = 0; i < cstr.length; ++i) {\n\t\tvar cc = cstr.charCodeAt(i);\n\t\tif(cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);\n\t\telse if(cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n\t}\n\treturn { c: C - 1, r:R - 1 };\n}\nfunction encode_cell(cell/*:CellAddress*/)/*:string*/ {\n\tvar col = cell.c + 1;\n\tvar s=\"\";\n\tfor(; col; col=((col-1)/26)|0) s = String.fromCharCode(((col-1)%26) + 65) + s;\n\treturn s + (cell.r + 1);\n}\nfunction decode_range(range/*:string*/)/*:Range*/ {\n\tvar idx = range.indexOf(\":\");\n\tif(idx == -1) return { s: decode_cell(range), e: decode_cell(range) };\n\treturn { s: decode_cell(range.slice(0, idx)), e: decode_cell(range.slice(idx + 1)) };\n}\n/*# if only one arg, it is assumed to be a Range.  If 2 args, both are cell addresses */\nfunction encode_range(cs/*:CellAddrSpec|Range*/,ce/*:?CellAddrSpec*/)/*:string*/ {\n\tif(typeof ce === 'undefined' || typeof ce === 'number') {\n/*:: if(!(cs instanceof Range)) throw \"unreachable\"; */\n\t\treturn encode_range(cs.s, cs.e);\n\t}\n/*:: if((cs instanceof Range)) throw \"unreachable\"; */\n\tif(typeof cs !== 'string') cs = encode_cell((cs/*:any*/));\n\tif(typeof ce !== 'string') ce = encode_cell((ce/*:any*/));\n/*:: if(typeof cs !== 'string') throw \"unreachable\"; */\n/*:: if(typeof ce !== 'string') throw \"unreachable\"; */\n\treturn cs == ce ? cs : cs + \":\" + ce;\n}\nfunction fix_range(a1/*:string*/)/*:string*/ {\n\tvar s = decode_range(a1);\n\treturn \"$\" + encode_col(s.s.c) + \"$\" + encode_row(s.s.r) + \":$\" + encode_col(s.e.c) + \"$\" + encode_row(s.e.r);\n}\n\n// List of invalid characters needs to be tested further\nfunction formula_quote_sheet_name(sname/*:string*/, opts)/*:string*/ {\n\tif(!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error(\"empty sheet name\");\n\tif (/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(sname)) return \"'\" + sname.replace(/'/g, \"''\") + \"'\";\n\treturn sname;\n}\n\nfunction safe_decode_range(range/*:string*/)/*:Range*/ {\n\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\tvar idx = 0, i = 0, cc = 0;\n\tvar len = range.length;\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.s.c = --idx;\n\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.s.r = --idx;\n\n\tif(i === len || cc != 10) { o.e.c=o.s.c; o.e.r=o.s.r; return o; }\n\t++i;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.e.c = --idx;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.e.r = --idx;\n\treturn o;\n}\n\nfunction safe_format_cell(cell/*:Cell*/, v/*:any*/) {\n\tvar q = (cell.t == 'd' && v instanceof Date);\n\tif(cell.z != null) try { return (cell.w = SSF_format(cell.z, q ? datenum(v) : v)); } catch(e) { }\n\ttry { return (cell.w = SSF_format((cell.XF||{}).numFmtId||(q ? 14 : 0),  q ? datenum(v) : v)); } catch(e) { return ''+v; }\n}\n\nfunction format_cell(cell/*:Cell*/, v/*:any*/, o/*:any*/) {\n\tif(cell == null || cell.t == null || cell.t == 'z') return \"\";\n\tif(cell.w !== undefined) return cell.w;\n\tif(cell.t == 'd' && !cell.z && o && o.dateNF) cell.z = o.dateNF;\n\tif(cell.t == \"e\") return BErr[cell.v] || cell.v;\n\tif(v == undefined) return safe_format_cell(cell, cell.v);\n\treturn safe_format_cell(cell, v);\n}\n\nfunction sheet_to_workbook(sheet/*:Worksheet*/, opts)/*:Workbook*/ {\n\tvar n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\n\tvar sheets = {}; sheets[n] = sheet;\n\treturn { SheetNames: [n], Sheets: sheets };\n}\n\nfunction sheet_new(opts) {\n\tvar out = {};\n\tvar o = opts || {};\n\tif(o.dense) out[\"!data\"] = [];\n\treturn out;\n}\n\nfunction sheet_add_aoa(_ws/*:?Worksheet*/, data/*:AOA*/, opts/*:?any*/)/*:Worksheet*/ {\n\tvar o = opts || {};\n\tvar dense = _ws ? (_ws[\"!data\"] != null) : o.dense;\n\tif(DENSE != null && dense == null) dense = DENSE;\n\tvar ws/*:Worksheet*/ = _ws || (dense ? ({\"!data\": []}) : ({}/*:any*/));\n\tif(dense && !ws[\"!data\"]) ws[\"!data\"] = [];\n\tvar _R = 0, _C = 0;\n\tif(ws && o.origin != null) {\n\t\tif(typeof o.origin == 'number') _R = o.origin;\n\t\telse {\n\t\t\tvar _origin/*:CellAddress*/ = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r; _C = _origin.c;\n\t\t}\n\t}\n\tvar range/*:Range*/ = ({s: {c:10000000, r:10000000}, e: {c:0, r:0}}/*:any*/);\n\tif(ws[\"!ref\"]){\n\t\tvar _range = safe_decode_range(ws['!ref']);\n\t\trange.s.c = _range.s.c;\n\t\trange.s.r = _range.s.r;\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif(_R == -1) range.e.r = _R = (ws[\"!ref\"] ? _range.e.r + 1 : 0);\n\t} else {\n\t\trange.s.c = range.e.c = range.s.r = range.e.r = 0;\n\t}\n\tvar row = [], seen = false;\n\tfor(var R = 0; R != data.length; ++R) {\n\t\tif(!data[R]) continue;\n\t\tif(!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\n\t\tvar __R = _R + R;\n\t\tif(dense) {\n\t\t\tif(!ws[\"!data\"][__R]) ws[\"!data\"][__R] = [];\n\t\t\trow = ws[\"!data\"][__R];\n\t\t}\n\t\tvar data_R = data[R];\n\t\tfor(var C = 0; C != data_R.length; ++C) {\n\t\t\tif(typeof data_R[C] === 'undefined') continue;\n\t\t\tvar cell/*:Cell*/ = ({v: data_R[C], t:\"\" }/*:any*/);\n\t\t\tvar __C = _C + C;\n\t\t\tif(range.s.r > __R) range.s.r = __R;\n\t\t\tif(range.s.c > __C) range.s.c = __C;\n\t\t\tif(range.e.r < __R) range.e.r = __R;\n\t\t\tif(range.e.c < __C) range.e.c = __C;\n\t\t\tseen = true;\n\t\t\tif(data_R[C] && typeof data_R[C] === 'object' && !Array.isArray(data_R[C]) && !(data_R[C] instanceof Date)) cell = data_R[C];\n\t\t\telse {\n\t\t\t\tif(Array.isArray(cell.v)) { cell.f = data_R[C][1]; cell.v = cell.v[0]; }\n\t\t\t\tif(cell.v === null) {\n\t\t\t\t\tif(cell.f) cell.t = 'n';\n\t\t\t\t\telse if(o.nullError) { cell.t = 'e'; cell.v = 0; }\n\t\t\t\t\telse if(!o.sheetStubs) continue;\n\t\t\t\t\telse cell.t = 'z';\n\t\t\t\t}\n\t\t\t\telse if(typeof cell.v === 'number') {\n\t\t\t\t\tif(isFinite(cell.v)) cell.t = 'n';\n\t\t\t\t\telse if(isNaN(cell.v)) { cell.t = 'e'; cell.v = 0x0F; /* #VALUE! */ }\n\t\t\t\t\telse { cell.t = 'e'; cell.v = 0x07; /*# DIV/0 */ }\n\t\t\t\t}\n\t\t\t\telse if(typeof cell.v === 'boolean') cell.t = 'b';\n\t\t\t\telse if(cell.v instanceof Date) {\n\t\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\t\tif(!o.UTC) cell.v = local_to_utc(cell.v);\n\t\t\t\t\tif(o.cellDates) { cell.t = 'd'; cell.w = SSF_format(cell.z, datenum(cell.v, o.date1904)); }\n\t\t\t\t\telse { cell.t = 'n'; cell.v = datenum(cell.v, o.date1904); cell.w = SSF_format(cell.z, cell.v); }\n\t\t\t\t}\n\t\t\t\telse cell.t = 's';\n\t\t\t}\n\t\t\tif(dense) {\n\t\t\t\tif(row[__C] && row[__C].z) cell.z = row[__C].z;\n\t\t\t\trow[__C] = cell;\n\t\t\t} else {\n\t\t\t\tvar cell_ref = encode_col(__C) + (__R + 1)/*:any*/;\n\t\t\t\tif(ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;\n\t\t\t\tws[cell_ref] = cell;\n\t\t\t}\n\t\t}\n\t}\n\tif(seen && range.s.c < 10400000) ws['!ref'] = encode_range(range);\n\treturn ws;\n}\nfunction aoa_to_sheet(data/*:AOA*/, opts/*:?any*/)/*:Worksheet*/ { return sheet_add_aoa(null, data, opts); }\nfunction parse_Int32LE(data) {\n\treturn data.read_shift(4, 'i');\n}\nfunction write_UInt32LE(x/*:number*/, o) {\n\tif (!o) o = new_buf(4);\n\to.write_shift(4, x);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.168 */\nfunction parse_XLWideString(data/*::, length*/)/*:string*/ {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLWideString(data/*:string*/, o) {\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(4 + 2 * data.length); }\n\to.write_shift(4, data.length);\n\tif (data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.91 */\n//function parse_LPWideString(data/*::, length*/)/*:string*/ {\n//\tvar cchCharacters = data.read_shift(2);\n//\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, \"utf16le\");\n//}\n\n/* [MS-XLSB] 2.5.143 */\nfunction parse_StrRun(data) {\n\treturn { ich: data.read_shift(2), ifnt: data.read_shift(2) };\n}\nfunction write_StrRun(run, o) {\n\tif (!o) o = new_buf(4);\n\to.write_shift(2, run.ich || 0);\n\to.write_shift(2, run.ifnt || 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.121 */\nfunction parse_RichStr(data, length/*:number*/)/*:XLString*/ {\n\tvar start = data.l;\n\tvar flags = data.read_shift(1);\n\tvar str = parse_XLWideString(data);\n\tvar rgsStrRun = [];\n\tvar z = ({ t: str, h: str }/*:any*/);\n\tif ((flags & 1) !== 0) { /* fRichStr */\n\t\t/* TODO: formatted string */\n\t\tvar dwSizeStrRun = data.read_shift(4);\n\t\tfor (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\n\t\tz.r = rgsStrRun;\n\t}\n\telse z.r = [{ ich: 0, ifnt: 0 }];\n\t//if((flags & 2) !== 0) { /* fExtStr */\n\t//\t/* TODO: phonetic string */\n\t//}\n\tdata.l = start + length;\n\treturn z;\n}\nfunction write_RichStr(str/*:XLString*/, o/*:?Block*/)/*:Block*/ {\n\t/* TODO: formatted string */\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(15 + 4 * str.t.length); }\n\to.write_shift(1, 0);\n\twrite_XLWideString(str.t, o);\n\treturn _null ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.328 BrtCommentText (RichStr w/1 run) */\nvar parse_BrtCommentText = parse_RichStr;\nfunction write_BrtCommentText(str/*:XLString*/, o/*:?Block*/)/*:Block*/ {\n\t/* TODO: formatted string */\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(23 + 4 * str.t.length); }\n\to.write_shift(1, 1);\n\twrite_XLWideString(str.t, o);\n\to.write_shift(4, 1);\n\twrite_StrRun({ ich: 0, ifnt: 0 }, o);\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.9 */\nfunction parse_XLSBCell(data)/*:any*/ {\n\tvar col = data.read_shift(4);\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) << 16;\n\tdata.l++; //var fPhShow = data.read_shift(1);\n\treturn { c: col, iStyleRef: iStyleRef };\n}\nfunction write_XLSBCell(cell/*:any*/, o/*:?Block*/) {\n\tif (o == null) o = new_buf(8);\n\to.write_shift(-4, cell.c);\n\to.write_shift(3, cell.iStyleRef || cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n/* Short XLSB Cell does not include column */\nfunction parse_XLSBShortCell(data)/*:any*/ {\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) <<16;\n\tdata.l++; //var fPhShow = data.read_shift(1);\n\treturn { c:-1, iStyleRef: iStyleRef };\n}\nfunction write_XLSBShortCell(cell/*:any*/, o/*:?Block*/) {\n\tif(o == null) o = new_buf(4);\n\to.write_shift(3, cell.iStyleRef || cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.21 */\nvar parse_XLSBCodeName = parse_XLWideString;\nvar write_XLSBCodeName = write_XLWideString;\n\n/* [MS-XLSB] 2.5.166 */\nfunction parse_XLNullableWideString(data/*::, length*/)/*:string*/ {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLNullableWideString(data/*:string*/, o) {\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(127); }\n\to.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n\tif (data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.165 */\nvar parse_XLNameWideString = parse_XLWideString;\n//var write_XLNameWideString = write_XLWideString;\n\n/* [MS-XLSB] 2.5.114 */\nvar parse_RelID = parse_XLNullableWideString;\nvar write_RelID = write_XLNullableWideString;\n\n\n/* [MS-XLS] 2.5.217 ; [MS-XLSB] 2.5.122 */\nfunction parse_RkNumber(data)/*:number*/ {\n\tvar b = data.slice(data.l, data.l + 4);\n\tvar fX100 = (b[0] & 1), fInt = (b[0] & 2);\n\tdata.l += 4;\n\tvar RK = fInt === 0 ? __double([0, 0, 0, 0, (b[0] & 0xFC), b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n\treturn fX100 ? (RK / 100) : RK;\n}\nfunction write_RkNumber(data/*:number*/, o) {\n\tif (o == null) o = new_buf(4);\n\tvar fX100 = 0, fInt = 0, d100 = data * 100;\n\tif ((data == (data | 0)) && (data >= -(1 << 29)) && (data < (1 << 29))) { fInt = 1; }\n\telse if ((d100 == (d100 | 0)) && (d100 >= -(1 << 29)) && (d100 < (1 << 29))) { fInt = 1; fX100 = 1; }\n\tif (fInt) o.write_shift(-4, ((fX100 ? d100 : data) << 2) + (fX100 + 2));\n\telse throw new Error(\"unsupported RkNumber \" + data); // TODO\n}\n\n\n/* [MS-XLSB] 2.5.117 RfX */\nfunction parse_RfX(data /*::, length*/)/*:Range*/ {\n\tvar cell/*:Range*/ = ({ s: {}, e: {} }/*:any*/);\n\tcell.s.r = data.read_shift(4);\n\tcell.e.r = data.read_shift(4);\n\tcell.s.c = data.read_shift(4);\n\tcell.e.c = data.read_shift(4);\n\treturn cell;\n}\nfunction write_RfX(r/*:Range*/, o) {\n\tif (!o) o = new_buf(16);\n\to.write_shift(4, r.s.r);\n\to.write_shift(4, r.e.r);\n\to.write_shift(4, r.s.c);\n\to.write_shift(4, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.153 UncheckedRfX */\nvar parse_UncheckedRfX = parse_RfX;\nvar write_UncheckedRfX = write_RfX;\n\n/* [MS-XLSB] 2.5.155 UncheckedSqRfX */\n//function parse_UncheckedSqRfX(data) {\n//\tvar cnt = data.read_shift(4);\n//\tvar out = [];\n//\tfor(var i = 0; i < cnt; ++i) {\n//\t\tvar rng = parse_UncheckedRfX(data);\n//\t\tout.push(encode_range(rng));\n//\t}\n//\treturn out.join(\",\");\n//}\n//function write_UncheckedSqRfX(sqrfx/*:string*/) {\n//\tvar parts = sqrfx.split(/\\s*,\\s*/);\n//\tvar o = new_buf(4); o.write_shift(4, parts.length);\n//\tvar out = [o];\n//\tparts.forEach(function(rng) {\n//\t\tout.push(write_UncheckedRfX(safe_decode_range(rng)));\n//\t});\n//\treturn bconcat(out);\n//}\n\n/* [MS-XLS] 2.5.342 ; [MS-XLSB] 2.5.171 */\n/* TODO: error checking, NaN and Infinity values are not valid Xnum */\nfunction parse_Xnum(data/*::, length*/) {\n\tif(data.length - data.l < 8) throw \"XLS Xnum Buffer underflow\";\n\treturn data.read_shift(8, 'f');\n}\nfunction write_Xnum(data, o) { return (o || new_buf(8)).write_shift(8, data, 'f'); }\n\n/* [MS-XLSB] 2.4.324 BrtColor */\nfunction parse_BrtColor(data/*::, length*/) {\n\tvar out = {};\n\tvar d = data.read_shift(1);\n\n\t//var fValidRGB = d & 1;\n\tvar xColorType = d >>> 1;\n\n\tvar index = data.read_shift(1);\n\tvar nTS = data.read_shift(2, 'i');\n\tvar bR = data.read_shift(1);\n\tvar bG = data.read_shift(1);\n\tvar bB = data.read_shift(1);\n\tdata.l++; //var bAlpha = data.read_shift(1);\n\n\tswitch (xColorType) {\n\t\tcase 0: out.auto = 1; break;\n\t\tcase 1:\n\t\t\tout.index = index;\n\t\t\tvar icv = XLSIcv[index];\n\t\t\t/* automatic pseudo index 81 */\n\t\t\tif (icv) out.rgb = rgb2Hex(icv);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/* if(!fValidRGB) throw new Error(\"invalid\"); */\n\t\t\tout.rgb = rgb2Hex([bR, bG, bB]);\n\t\t\tbreak;\n\t\tcase 3: out.theme = index; break;\n\t}\n\tif (nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;\n\n\treturn out;\n}\nfunction write_BrtColor(color, o) {\n\tif (!o) o = new_buf(8);\n\tif (!color || color.auto) { o.write_shift(4, 0); o.write_shift(4, 0); return o; }\n\tif (color.index != null) {\n\t\to.write_shift(1, 0x02);\n\t\to.write_shift(1, color.index);\n\t} else if (color.theme != null) {\n\t\to.write_shift(1, 0x06);\n\t\to.write_shift(1, color.theme);\n\t} else {\n\t\to.write_shift(1, 0x05);\n\t\to.write_shift(1, 0);\n\t}\n\tvar nTS = color.tint || 0;\n\tif (nTS > 0) nTS *= 32767;\n\telse if (nTS < 0) nTS *= 32768;\n\to.write_shift(2, nTS);\n\tif (!color.rgb || color.theme != null) {\n\t\to.write_shift(2, 0);\n\t\to.write_shift(1, 0);\n\t\to.write_shift(1, 0);\n\t} else {\n\t\tvar rgb = (color.rgb || 'FFFFFF');\n\t\tif (typeof rgb == 'number') rgb = (\"000000\" + rgb.toString(16)).slice(-6);\n\t\to.write_shift(1, parseInt(rgb.slice(0, 2), 16));\n\t\to.write_shift(1, parseInt(rgb.slice(2, 4), 16));\n\t\to.write_shift(1, parseInt(rgb.slice(4, 6), 16));\n\t\to.write_shift(1, 0xFF);\n\t}\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.52 */\nfunction parse_FontFlags(data/*::, length, opts*/) {\n\tvar d = data.read_shift(1);\n\tdata.l++;\n\tvar out = {\n\t\tfBold: d & 0x01,\n\t\tfItalic: d & 0x02,\n\t\tfUnderline: d & 0x04,\n\t\tfStrikeout: d & 0x08,\n\t\tfOutline: d & 0x10,\n\t\tfShadow: d & 0x20,\n\t\tfCondense: d & 0x40,\n\t\tfExtend: d & 0x80\n\t};\n\treturn out;\n}\nfunction write_FontFlags(font, o) {\n\tif (!o) o = new_buf(2);\n\tvar grbit =\n\t\t(font.italic ? 0x02 : 0) |\n\t\t(font.strike ? 0x08 : 0) |\n\t\t(font.outline ? 0x10 : 0) |\n\t\t(font.shadow ? 0x20 : 0) |\n\t\t(font.condense ? 0x40 : 0) |\n\t\t(font.extend ? 0x80 : 0);\n\to.write_shift(1, grbit);\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n/* [MS-OLEDS] 2.3.1 and 2.3.2 */\nfunction parse_ClipboardFormatOrString(o, w/*:number*/)/*:string*/ {\n\t// $FlowIgnore\n\tvar ClipFmt = { 2: \"BITMAP\", 3: \"METAFILEPICT\", 8: \"DIB\", 14: \"ENHMETAFILE\" };\n\tvar m/*:number*/ = o.read_shift(4);\n\tswitch (m) {\n\t\tcase 0x00000000: return \"\";\n\t\tcase 0xffffffff: case 0xfffffffe: return ClipFmt[o.read_shift(4)] || \"\";\n\t}\n\tif (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n\to.l -= 4;\n\treturn o.read_shift(0, w == 1 ? \"lpstr\" : \"lpwstr\");\n}\nfunction parse_ClipboardFormatOrAnsiString(o) { return parse_ClipboardFormatOrString(o, 1); }\nfunction parse_ClipboardFormatOrUnicodeString(o) { return parse_ClipboardFormatOrString(o, 2); }\n\n/* [MS-OLEPS] 2.2 PropertyType */\n// Note: some tree shakers cannot handle VT_VECTOR | $CONST, hence extra vars\n//var VT_EMPTY    = 0x0000;\n//var VT_NULL     = 0x0001;\nvar VT_I2       = 0x0002;\nvar VT_I4       = 0x0003;\n//var VT_R4       = 0x0004;\n//var VT_R8       = 0x0005;\n//var VT_CY       = 0x0006;\n//var VT_DATE     = 0x0007;\n//var VT_BSTR     = 0x0008;\n//var VT_ERROR    = 0x000A;\nvar VT_BOOL     = 0x000B;\nvar VT_VARIANT  = 0x000C;\n//var VT_DECIMAL  = 0x000E;\n//var VT_I1       = 0x0010;\n//var VT_UI1      = 0x0011;\n//var VT_UI2      = 0x0012;\nvar VT_UI4      = 0x0013;\n//var VT_I8       = 0x0014;\n//var VT_UI8      = 0x0015;\n//var VT_INT      = 0x0016;\n//var VT_UINT     = 0x0017;\n//var VT_LPSTR    = 0x001E;\n//var VT_LPWSTR   = 0x001F;\nvar VT_FILETIME = 0x0040;\nvar VT_BLOB     = 0x0041;\n//var VT_STREAM   = 0x0042;\n//var VT_STORAGE  = 0x0043;\n//var VT_STREAMED_Object  = 0x0044;\n//var VT_STORED_Object    = 0x0045;\n//var VT_BLOB_Object      = 0x0046;\nvar VT_CF       = 0x0047;\n//var VT_CLSID    = 0x0048;\n//var VT_VERSIONED_STREAM = 0x0049;\n//var VT_VECTOR   = 0x1000;\nvar VT_VECTOR_VARIANT = 0x100C;\nvar VT_VECTOR_LPSTR   = 0x101E;\n//var VT_ARRAY    = 0x2000;\n\nvar VT_STRING   = 0x0050; // 2.3.3.1.11 VtString\nvar VT_USTR     = 0x0051; // 2.3.3.1.12 VtUnalignedString\nvar VT_CUSTOM   = [VT_STRING, VT_USTR];\n\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\nvar DocSummaryPIDDSI = {\n\t0x01: { n: 'CodePage', t: VT_I2 },\n\t0x02: { n: 'Category', t: VT_STRING },\n\t0x03: { n: 'PresentationFormat', t: VT_STRING },\n\t0x04: { n: 'ByteCount', t: VT_I4 },\n\t0x05: { n: 'LineCount', t: VT_I4 },\n\t0x06: { n: 'ParagraphCount', t: VT_I4 },\n\t0x07: { n: 'SlideCount', t: VT_I4 },\n\t0x08: { n: 'NoteCount', t: VT_I4 },\n\t0x09: { n: 'HiddenCount', t: VT_I4 },\n\t0x0a: { n: 'MultimediaClipCount', t: VT_I4 },\n\t0x0b: { n: 'ScaleCrop', t: VT_BOOL },\n\t0x0c: { n: 'HeadingPairs', t: VT_VECTOR_VARIANT /* VT_VECTOR | VT_VARIANT */ },\n\t0x0d: { n: 'TitlesOfParts', t: VT_VECTOR_LPSTR /* VT_VECTOR | VT_LPSTR */ },\n\t0x0e: { n: 'Manager', t: VT_STRING },\n\t0x0f: { n: 'Company', t: VT_STRING },\n\t0x10: { n: 'LinksUpToDate', t: VT_BOOL },\n\t0x11: { n: 'CharacterCount', t: VT_I4 },\n\t0x13: { n: 'SharedDoc', t: VT_BOOL },\n\t0x16: { n: 'HyperlinksChanged', t: VT_BOOL },\n\t0x17: { n: 'AppVersion', t: VT_I4, p: 'version' },\n\t0x18: { n: 'DigSig', t: VT_BLOB },\n\t0x1A: { n: 'ContentType', t: VT_STRING },\n\t0x1B: { n: 'ContentStatus', t: VT_STRING },\n\t0x1C: { n: 'Language', t: VT_STRING },\n\t0x1D: { n: 'Version', t: VT_STRING },\n\t0xFF: {},\n\t/* [MS-OLEPS] 2.18 */\n\t0x80000000: { n: 'Locale', t: VT_UI4 },\n\t0x80000003: { n: 'Behavior', t: VT_UI4 },\n\t0x72627262: {}\n};\n\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\nvar SummaryPIDSI = {\n\t0x01: { n: 'CodePage', t: VT_I2 },\n\t0x02: { n: 'Title', t: VT_STRING },\n\t0x03: { n: 'Subject', t: VT_STRING },\n\t0x04: { n: 'Author', t: VT_STRING },\n\t0x05: { n: 'Keywords', t: VT_STRING },\n\t0x06: { n: 'Comments', t: VT_STRING },\n\t0x07: { n: 'Template', t: VT_STRING },\n\t0x08: { n: 'LastAuthor', t: VT_STRING },\n\t0x09: { n: 'RevNumber', t: VT_STRING },\n\t0x0A: { n: 'EditTime', t: VT_FILETIME },\n\t0x0B: { n: 'LastPrinted', t: VT_FILETIME },\n\t0x0C: { n: 'CreatedDate', t: VT_FILETIME },\n\t0x0D: { n: 'ModifiedDate', t: VT_FILETIME },\n\t0x0E: { n: 'PageCount', t: VT_I4 },\n\t0x0F: { n: 'WordCount', t: VT_I4 },\n\t0x10: { n: 'CharCount', t: VT_I4 },\n\t0x11: { n: 'Thumbnail', t: VT_CF },\n\t0x12: { n: 'Application', t: VT_STRING },\n\t0x13: { n: 'DocSecurity', t: VT_I4 },\n\t0xFF: {},\n\t/* [MS-OLEPS] 2.18 */\n\t0x80000000: { n: 'Locale', t: VT_UI4 },\n\t0x80000003: { n: 'Behavior', t: VT_UI4 },\n\t0x72627262: {}\n};\n\n/* [MS-XLS] 2.4.63 Country/Region codes */\nvar CountryEnum = {\n\t0x0001: \"US\", // United States\n\t0x0002: \"CA\", // Canada\n\t0x0003: \"\", // Latin America (except Brazil)\n\t0x0007: \"RU\", // Russia\n\t0x0014: \"EG\", // Egypt\n\t0x001E: \"GR\", // Greece\n\t0x001F: \"NL\", // Netherlands\n\t0x0020: \"BE\", // Belgium\n\t0x0021: \"FR\", // France\n\t0x0022: \"ES\", // Spain\n\t0x0024: \"HU\", // Hungary\n\t0x0027: \"IT\", // Italy\n\t0x0029: \"CH\", // Switzerland\n\t0x002B: \"AT\", // Austria\n\t0x002C: \"GB\", // United Kingdom\n\t0x002D: \"DK\", // Denmark\n\t0x002E: \"SE\", // Sweden\n\t0x002F: \"NO\", // Norway\n\t0x0030: \"PL\", // Poland\n\t0x0031: \"DE\", // Germany\n\t0x0034: \"MX\", // Mexico\n\t0x0037: \"BR\", // Brazil\n\t0x003d: \"AU\", // Australia\n\t0x0040: \"NZ\", // New Zealand\n\t0x0042: \"TH\", // Thailand\n\t0x0051: \"JP\", // Japan\n\t0x0052: \"KR\", // Korea\n\t0x0054: \"VN\", // Viet Nam\n\t0x0056: \"CN\", // China\n\t0x005A: \"TR\", // Turkey\n\t0x0069: \"JS\", // Ramastan\n\t0x00D5: \"DZ\", // Algeria\n\t0x00D8: \"MA\", // Morocco\n\t0x00DA: \"LY\", // Libya\n\t0x015F: \"PT\", // Portugal\n\t0x0162: \"IS\", // Iceland\n\t0x0166: \"FI\", // Finland\n\t0x01A4: \"CZ\", // Czech Republic\n\t0x0376: \"TW\", // Taiwan\n\t0x03C1: \"LB\", // Lebanon\n\t0x03C2: \"JO\", // Jordan\n\t0x03C3: \"SY\", // Syria\n\t0x03C4: \"IQ\", // Iraq\n\t0x03C5: \"KW\", // Kuwait\n\t0x03C6: \"SA\", // Saudi Arabia\n\t0x03CB: \"AE\", // United Arab Emirates\n\t0x03CC: \"IL\", // Israel\n\t0x03CE: \"QA\", // Qatar\n\t0x03D5: \"IR\", // Iran\n\t0xFFFF: \"US\"  // United States\n};\n\n/* [MS-XLS] 2.5.127 */\nvar XLSFillPattern = [\n\tnull,\n\t'solid',\n\t'mediumGray',\n\t'darkGray',\n\t'lightGray',\n\t'darkHorizontal',\n\t'darkVertical',\n\t'darkDown',\n\t'darkUp',\n\t'darkGrid',\n\t'darkTrellis',\n\t'lightHorizontal',\n\t'lightVertical',\n\t'lightDown',\n\t'lightUp',\n\t'lightGrid',\n\t'lightTrellis',\n\t'gray125',\n\t'gray0625'\n];\n\nfunction rgbify(arr/*:Array<number>*/)/*:Array<[number, number, number]>*/ { return arr.map(function(x) { return [(x>>16)&255,(x>>8)&255,x&255]; }); }\n\n/* [MS-XLS] 2.5.161 */\n/* [MS-XLSB] 2.5.75 Icv */\nvar _XLSIcv = /*#__PURE__*/ rgbify([\n\t/* Color Constants */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t/* Overridable Defaults */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t0x800000,\n\t0x008000,\n\t0x000080,\n\t0x808000,\n\t0x800080,\n\t0x008080,\n\t0xC0C0C0,\n\t0x808080,\n\t0x9999FF,\n\t0x993366,\n\t0xFFFFCC,\n\t0xCCFFFF,\n\t0x660066,\n\t0xFF8080,\n\t0x0066CC,\n\t0xCCCCFF,\n\n\t0x000080,\n\t0xFF00FF,\n\t0xFFFF00,\n\t0x00FFFF,\n\t0x800080,\n\t0x800000,\n\t0x008080,\n\t0x0000FF,\n\t0x00CCFF,\n\t0xCCFFFF,\n\t0xCCFFCC,\n\t0xFFFF99,\n\t0x99CCFF,\n\t0xFF99CC,\n\t0xCC99FF,\n\t0xFFCC99,\n\n\t0x3366FF,\n\t0x33CCCC,\n\t0x99CC00,\n\t0xFFCC00,\n\t0xFF9900,\n\t0xFF6600,\n\t0x666699,\n\t0x969696,\n\t0x003366,\n\t0x339966,\n\t0x003300,\n\t0x333300,\n\t0x993300,\n\t0x993366,\n\t0x333399,\n\t0x333333,\n\n\t/* Other entries to appease BIFF8/12 */\n\t0x000000, /* 0x40 icvForeground ?? */\n\t0xFFFFFF, /* 0x41 icvBackground ?? */\n\t0x000000, /* 0x42 icvFrame ?? */\n\t0x000000, /* 0x43 icv3D ?? */\n\t0x000000, /* 0x44 icv3DText ?? */\n\t0x000000, /* 0x45 icv3DHilite ?? */\n\t0x000000, /* 0x46 icv3DShadow ?? */\n\t0x000000, /* 0x47 icvHilite ?? */\n\t0x000000, /* 0x48 icvCtlText ?? */\n\t0x000000, /* 0x49 icvCtlScrl ?? */\n\t0x000000, /* 0x4A icvCtlInv ?? */\n\t0x000000, /* 0x4B icvCtlBody ?? */\n\t0x000000, /* 0x4C icvCtlFrame ?? */\n\t0x000000, /* 0x4D icvCtlFore ?? */\n\t0x000000, /* 0x4E icvCtlBack ?? */\n\t0x000000, /* 0x4F icvCtlNeutral */\n\t0x000000, /* 0x50 icvInfoBk ?? */\n\t0x000000 /* 0x51 icvInfoText ?? */\n]);\nvar XLSIcv = /*#__PURE__*/dup(_XLSIcv);\n\n/* [MS-XLSB] 2.5.97.2 */\nvar BErr = {\n\t0x00: \"#NULL!\",\n\t0x07: \"#DIV/0!\",\n\t0x0F: \"#VALUE!\",\n\t0x17: \"#REF!\",\n\t0x1D: \"#NAME?\",\n\t0x24: \"#NUM!\",\n\t0x2A: \"#N/A\",\n\t0x2B: \"#GETTING_DATA\",\n\t0xFF: \"#WTF?\"\n};\n//var RBErr = evert_num(BErr);\nvar RBErr = {\n\t\"#NULL!\":        0x00,\n\t\"#DIV/0!\":       0x07,\n\t\"#VALUE!\":       0x0F,\n\t\"#REF!\":         0x17,\n\t\"#NAME?\":        0x1D,\n\t\"#NUM!\":         0x24,\n\t\"#N/A\":          0x2A,\n\t\"#GETTING_DATA\": 0x2B,\n\t\"#WTF?\":         0xFF\n};\n\nvar XLSLblBuiltIn = [\n\t\"_xlnm.Consolidate_Area\",\n\t\"_xlnm.Auto_Open\",\n\t\"_xlnm.Auto_Close\",\n\t\"_xlnm.Extract\",\n\t\"_xlnm.Database\",\n\t\"_xlnm.Criteria\",\n\t\"_xlnm.Print_Area\",\n\t\"_xlnm.Print_Titles\",\n\t\"_xlnm.Recorder\",\n\t\"_xlnm.Data_Form\",\n\t\"_xlnm.Auto_Activate\",\n\t\"_xlnm.Auto_Deactivate\",\n\t\"_xlnm.Sheet_Title\",\n\t\"_xlnm._FilterDatabase\"\n];\n\n/* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n/* 12.3 Part Summary <SpreadsheetML> */\n/* 14.2 Part Summary <DrawingML> */\n/* [MS-XLSX] 2.1 Part Enumerations ; [MS-XLSB] 2.1.7 Part Enumeration */\nvar ct2type/*{[string]:string}*/ = ({\n\t/* Workbook */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.binary.macroEnabled.main\": \"workbooks\",\n\t\"application/vnd.ms-excel.addin.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\": \"workbooks\",\n\n\t/* Worksheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\": \"sheets\",\n\t\"application/vnd.ms-excel.worksheet\": \"sheets\",\n\t\"application/vnd.ms-excel.binIndexWs\": \"TODO\", /* Binary Index */\n\n\t/* Chartsheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"charts\",\n\t\"application/vnd.ms-excel.chartsheet\": \"charts\",\n\n\t/* Macrosheet */\n\t\"application/vnd.ms-excel.macrosheet+xml\": \"macros\",\n\t\"application/vnd.ms-excel.macrosheet\": \"macros\",\n\t\"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n\t\"application/vnd.ms-excel.binIndexMs\": \"TODO\", /* Binary Index */\n\n\t/* Dialogsheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"dialogs\",\n\t\"application/vnd.ms-excel.dialogsheet\": \"dialogs\",\n\n\t/* Shared Strings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\": \"strs\",\n\t\"application/vnd.ms-excel.sharedStrings\": \"strs\",\n\n\t/* Styles */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\": \"styles\",\n\t\"application/vnd.ms-excel.styles\": \"styles\",\n\n\t/* File Properties */\n\t\"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n\t\"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n\t\"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n\t/* Custom Data Properties */\n\t\"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\": \"TODO\",\n\n\t/* Comments */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n\t\"application/vnd.ms-excel.comments\": \"comments\",\n\t\"application/vnd.ms-excel.threadedcomments+xml\": \"threadedcomments\",\n\t\"application/vnd.ms-excel.person+xml\": \"people\",\n\n\t/* Metadata (Stock/Geography and Dynamic Array) */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"metadata\",\n\t\"application/vnd.ms-excel.sheetMetadata\": \"metadata\",\n\n\t/* PivotTable */\n\t\"application/vnd.ms-excel.pivotTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n\t/* Chart Objects */\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n\n\t/* Chart Colors */\n\t\"application/vnd.ms-office.chartcolorstyle+xml\": \"TODO\",\n\n\t/* Chart Style */\n\t\"application/vnd.ms-office.chartstyle+xml\": \"TODO\",\n\n\t/* Chart Advanced */\n\t\"application/vnd.ms-office.chartex+xml\": \"TODO\",\n\n\t/* Calculation Chain */\n\t\"application/vnd.ms-excel.calcChain\": \"calcchains\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n\t/* Printer Settings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n\t/* ActiveX */\n\t\"application/vnd.ms-office.activeX\": \"TODO\",\n\t\"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n\t/* Custom Toolbars */\n\t\"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n\t/* External Data Connections */\n\t\"application/vnd.ms-excel.connections\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n\t/* External Links */\n\t\"application/vnd.ms-excel.externalLink\": \"links\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\n\n\t/* PivotCache */\n\t\"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n\t\"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n\t/* Query Table */\n\t\"application/vnd.ms-excel.queryTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n\t/* Shared Workbook */\n\t\"application/vnd.ms-excel.userNames\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionLog\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n\t/* Single Cell Table */\n\t\"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n\t/* Slicer */\n\t\"application/vnd.ms-excel.slicer\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache\": \"TODO\",\n\t\"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n\t/* Sort Map */\n\t\"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n\t/* Table */\n\t\"application/vnd.ms-excel.table\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n\t/* Themes */\n\t\"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n\t/* Theme Override */\n\t\"application/vnd.openxmlformats-officedocument.themeOverride+xml\": \"TODO\",\n\n\t/* Timeline */\n\t\"application/vnd.ms-excel.Timeline+xml\": \"TODO\", /* verify */\n\t\"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\", /* verify */\n\n\t/* VBA */\n\t\"application/vnd.ms-office.vbaProject\": \"vba\",\n\t\"application/vnd.ms-office.vbaProjectSignature\": \"TODO\",\n\n\t/* Volatile Dependencies */\n\t\"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n\t/* Control Properties */\n\t\"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n\t/* Data Model */\n\t\"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n\t/* Survey */\n\t\"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n\t/* Drawing */\n\t\"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n\t/* VML */\n\t\"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n\n\t\"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n\t\"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n\n\t/* Image */\n\t\"image/png\": \"TODO\",\n\n\t\"sheet\": \"js\"\n}/*:any*/);\n\nvar CT_LIST = {\n\tworkbooks: {\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n\t\txlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n\t\txlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n\t\txlam: \"application/vnd.ms-excel.addin.macroEnabled.main+xml\",\n\t\txltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n\t},\n\tstrs: { /* Shared Strings */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n\t\txlsb: \"application/vnd.ms-excel.sharedStrings\"\n\t},\n\tcomments: { /* Comments */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",\n\t\txlsb: \"application/vnd.ms-excel.comments\"\n\t},\n\tsheets: { /* Worksheet */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n\t\txlsb: \"application/vnd.ms-excel.worksheet\"\n\t},\n\tcharts: { /* Chartsheet */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",\n\t\txlsb: \"application/vnd.ms-excel.chartsheet\"\n\t},\n\tdialogs: { /* Dialogsheet */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",\n\t\txlsb: \"application/vnd.ms-excel.dialogsheet\"\n\t},\n\tmacros: { /* Macrosheet (Excel 4.0 Macros) */\n\t\txlsx: \"application/vnd.ms-excel.macrosheet+xml\",\n\t\txlsb: \"application/vnd.ms-excel.macrosheet\"\n\t},\n\tmetadata: { /* Metadata (Stock/Geography and Dynamic Array) */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\",\n\t\txlsb: \"application/vnd.ms-excel.sheetMetadata\"\n\t},\n\tstyles: { /* Styles */\n\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n\t\txlsb: \"application/vnd.ms-excel.styles\"\n\t}\n};\n\nfunction new_ct()/*:any*/ {\n\treturn ({\n\t\tworkbooks:[], sheets:[], charts:[], dialogs:[], macros:[],\n\t\trels:[], strs:[], comments:[], threadedcomments:[], links:[],\n\t\tcoreprops:[], extprops:[], custprops:[], themes:[], styles:[],\n\t\tcalcchains:[], vba: [], drawings: [], metadata: [], people:[],\n\t\tTODO:[], xmlns: \"\" }/*:any*/);\n}\n\nfunction parse_ct(data/*:?string*/) {\n\tvar ct = new_ct();\n\tif(!data || !data.match) return ct;\n\tvar ctext = {};\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0].replace(nsregex,\"<\")) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Types': ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/)||[\"\",\"\"])[1] ]; break;\n\t\t\tcase '<Default': ctext[y.Extension.toLowerCase()] = y.ContentType; break;\n\t\t\tcase '<Override':\n\t\t\t\tif(ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\tif(ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n\tct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n\tct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n\tct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n\tct.defaults = ctext;\n\tdelete ct.calcchains;\n\treturn ct;\n}\n\nfunction write_ct(ct, opts, raw)/*:string*/ {\n\tvar type2ct/*{[string]:Array<string>}*/ = evert_arr(ct2type);\n\n\tvar o/*:Array<string>*/ = [], v;\n\n\tif(!raw) {\n\t\to[o.length] = (XML_HEADER);\n\t\to[o.length] = writextag('Types', null, {\n\t\t\t'xmlns': XMLNS.CT,\n\t\t\t'xmlns:xsd': XMLNS.xsd,\n\t\t\t'xmlns:xsi': XMLNS.xsi\n\t\t});\n\t\to = o.concat([\n\t\t\t['xml', 'application/xml'],\n\t\t\t['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'],\n\t\t\t['vml', 'application/vnd.openxmlformats-officedocument.vmlDrawing'],\n\t\t\t['data', 'application/vnd.openxmlformats-officedocument.model+data'],\n\t\t\t/* from test files */\n\t\t\t['bmp', 'image/bmp'],\n\t\t\t['png', 'image/png'],\n\t\t\t['gif', 'image/gif'],\n\t\t\t['emf', 'image/x-emf'],\n\t\t\t['wmf', 'image/x-wmf'],\n\t\t\t['jpg', 'image/jpeg'], ['jpeg', 'image/jpeg'],\n\t\t\t['tif', 'image/tiff'], ['tiff', 'image/tiff'],\n\t\t\t['pdf', 'application/pdf'],\n\t\t\t['rels', 'application/vnd.openxmlformats-package.relationships+xml']\n\t\t].map(function(x) {\n\t\t\treturn writextag('Default', null, {'Extension':x[0], 'ContentType': x[1]});\n\t\t}));\n\t}\n\n\t/* only write first instance */\n\tvar f1 = function(w) {\n\t\tif(ct[w] && ct[w].length > 0) {\n\t\t\tv = ct[w][0];\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n\t\t\t}));\n\t\t}\n\t};\n\n\t/* book type-specific */\n\tvar f2 = function(w) {\n\t\t(ct[w]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n\t\t\t}));\n\t\t});\n\t};\n\n\t/* standard type */\n\tvar f3 = function(t) {\n\t\t(ct[t]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': type2ct[t][0]\n\t\t\t}));\n\t\t});\n\t};\n\n\tf1('workbooks');\n\tf2('sheets');\n\tf2('charts');\n\tf3('themes');\n\t['strs', 'styles'].forEach(f1);\n\t['coreprops', 'extprops', 'custprops'].forEach(f3);\n\tf3('vba');\n\tf3('comments');\n\tf3('threadedcomments');\n\tf3('drawings');\n\tf2('metadata');\n\tf3('people');\n\tif(!raw && o.length>2){ o[o.length] = ('</Types>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 9.3 Relationships */\nvar RELS = ({\n\tWB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tSHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tHLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\n\tVML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\n\tXPATH: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath\",\n\tXMISS: \"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing\",\n\tXLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",\n\tCXML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml\",\n\tCXMLP: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps\",\n\tCMNT: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",\n\tCORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\n\tEXT_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n\tCUST_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties',\n\tSST: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",\n\tSTY: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\n\tTHEME: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\n\tCHART: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",\n\tCHARTEX: \"http://schemas.microsoft.com/office/2014/relationships/chartEx\",\n\tCS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",\n\tWS: [\n\t\t\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\n\t\t\"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"\n\t],\n\tDS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\",\n\tMS: \"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\",\n\tIMG: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",\n\tDRAW: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",\n\tXLMETA: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",\n\tTCMNT: \"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",\n\tPEOPLE: \"http://schemas.microsoft.com/office/2017/10/relationships/person\",\n\tCONN: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections\",\n\tVBA: \"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"\n}/*:any*/);\n\n/* 9.3.3 Representing Relationships */\nfunction get_rels_path(file/*:string*/)/*:string*/ {\n\tvar n = file.lastIndexOf(\"/\");\n\treturn file.slice(0,n+1) + '_rels/' + file.slice(n+1) + \".rels\";\n}\n\nfunction parse_rels(data/*:?string*/, currentFilePath/*:string*/) {\n\tvar rels = {\"!id\":{}};\n\tif (!data) return rels;\n\tif (currentFilePath.charAt(0) !== '/') {\n\t\tcurrentFilePath = '/'+currentFilePath;\n\t}\n\tvar hash = {};\n\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\t/* 9.3.2.2 OPC_Relationships */\n\t\tif (y[0] === '<Relationship') {\n\t\t\tvar rel = {}; rel.Type = y.Type; rel.Target = unescapexml(y.Target); rel.Id = y.Id; if(y.TargetMode) rel.TargetMode = y.TargetMode;\n\t\t\tvar canonictarget = y.TargetMode === 'External' ? y.Target : resolve_path(y.Target, currentFilePath);\n\t\t\trels[canonictarget] = rel;\n\t\t\thash[y.Id] = rel;\n\t\t}\n\t});\n\trels[\"!id\"] = hash;\n\treturn rels;\n}\n\n\n/* TODO */\nfunction write_rels(rels)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('Relationships', null, {\n\t\t//'xmlns:ns0': XMLNS.RELS,\n\t\t'xmlns': XMLNS.RELS\n\t})];\n\tkeys(rels['!id']).forEach(function(rid) {\n\t\to[o.length] = (writextag('Relationship', null, rels['!id'][rid]));\n\t});\n\tif(o.length>2){ o[o.length] = ('</Relationships>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\nfunction add_rels(rels, rId/*:number*/, f, type, relobj, targetmode/*:?string*/)/*:number*/ {\n\tif(!relobj) relobj = {};\n\tif(!rels['!id']) rels['!id'] = {};\n\tif(!rels['!idx']) rels['!idx'] = 1;\n\tif(rId < 0) for(rId = rels['!idx']; rels['!id']['rId' + rId]; ++rId){/* empty */}\n\trels['!idx'] = rId + 1;\n\trelobj.Id = 'rId' + rId;\n\trelobj.Type = type;\n\trelobj.Target = f;\n\tif(targetmode) relobj.TargetMode = targetmode;\n\telse if([RELS.HLINK, RELS.XPATH, RELS.XMISS].indexOf(relobj.Type) > -1) relobj.TargetMode = \"External\";\n\tif(rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n\trels['!id'][relobj.Id] = relobj;\n\trels[('/' + relobj.Target).replace(\"//\",\"/\")] = relobj;\n\treturn rId;\n}\nvar CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\nfunction parse_manifest(d, opts) {\n  var str = xlml_normalize(d);\n  var Rn;\n  var FEtag;\n  while (Rn = xlmlregex.exec(str))\n    switch (Rn[3]) {\n      case \"manifest\":\n        break;\n      case \"file-entry\":\n        FEtag = parsexmltag(Rn[0], false);\n        if (FEtag.path == \"/\" && FEtag.type !== CT_ODS)\n          throw new Error(\"This OpenDocument is not a spreadsheet\");\n        break;\n      case \"encryption-data\":\n      case \"algorithm\":\n      case \"start-key-generation\":\n      case \"key-derivation\":\n        throw new Error(\"Unsupported ODS Encryption\");\n      default:\n        if (opts && opts.WTF)\n          throw Rn;\n    }\n}\nfunction write_manifest(manifest) {\n  var o = [XML_HEADER];\n  o.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\n  o.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\n  for (var i = 0; i < manifest.length; ++i)\n    o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\n  o.push(\"</manifest:manifest>\");\n  return o.join(\"\");\n}\nfunction write_rdf_type(file, res, tag) {\n  return [\n    '  <rdf:Description rdf:about=\"' + file + '\">\\n',\n    '    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + \"#\" + res + '\"/>\\n',\n    \"  </rdf:Description>\\n\"\n  ].join(\"\");\n}\nfunction write_rdf_has(base, file) {\n  return [\n    '  <rdf:Description rdf:about=\"' + base + '\">\\n',\n    '    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n',\n    \"  </rdf:Description>\\n\"\n  ].join(\"\");\n}\nfunction write_rdf(rdf) {\n  var o = [XML_HEADER];\n  o.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\n  for (var i = 0; i != rdf.length; ++i) {\n    o.push(write_rdf_type(rdf[i][0], rdf[i][1]));\n    o.push(write_rdf_has(\"\", rdf[i][0]));\n  }\n  o.push(write_rdf_type(\"\", \"Document\", \"pkg\"));\n  o.push(\"</rdf:RDF>\");\n  return o.join(\"\");\n}\nfunction write_meta_ods(wb, opts) {\n  return '<office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"><office:meta><meta:generator>SheetJS ' + XLSX.version + \"</meta:generator></office:meta></office:document-meta>\";\n}\n/* ECMA-376 Part II 11.1 Core Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar CORE_PROPS/*:Array<Array<string> >*/ = [\n\t[\"cp:category\", \"Category\"],\n\t[\"cp:contentStatus\", \"ContentStatus\"],\n\t[\"cp:keywords\", \"Keywords\"],\n\t[\"cp:lastModifiedBy\", \"LastAuthor\"],\n\t[\"cp:lastPrinted\", \"LastPrinted\"],\n\t[\"cp:revision\", \"RevNumber\"],\n\t[\"cp:version\", \"Version\"],\n\t[\"dc:creator\", \"Author\"],\n\t[\"dc:description\", \"Comments\"],\n\t[\"dc:identifier\", \"Identifier\"],\n\t[\"dc:language\", \"Language\"],\n\t[\"dc:subject\", \"Subject\"],\n\t[\"dc:title\", \"Title\"],\n\t[\"dcterms:created\", \"CreatedDate\", 'date'],\n\t[\"dcterms:modified\", \"ModifiedDate\", 'date']\n];\n\nfunction parse_core_props(data) {\n\tvar p = {};\n\tdata = utf8read(data);\n\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i], cur = str_match_xml(data, f[0]);\n\t\tif(cur != null && cur.length > 0) p[f[1]] = unescapexml(cur[1]);\n\t\tif(f[2] === 'date' && p[f[1]]) p[f[1]] = parseDate(p[f[1]]);\n\t}\n\n\treturn p;\n}\n\nfunction cp_doit(f, g, h, o, p) {\n\tif(p[f] != null || g == null || g === \"\") return;\n\tp[f] = g;\n\tg = escapexml(g);\n\to[o.length] = (h ? writextag(f,g,h) : writetag(f,g));\n}\n\nfunction write_core_props(cp, _opts) {\n\tvar opts = _opts || {};\n\tvar o = [XML_HEADER, writextag('cp:coreProperties', null, {\n\t\t//'xmlns': XMLNS.CORE_PROPS,\n\t\t'xmlns:cp': XMLNS.CORE_PROPS,\n\t\t'xmlns:dc': XMLNS.dc,\n\t\t'xmlns:dcterms': XMLNS.dcterms,\n\t\t'xmlns:dcmitype': XMLNS.dcmitype,\n\t\t'xmlns:xsi': XMLNS.xsi\n\t})], p = {};\n\tif(!cp && !opts.Props) return o.join(\"\");\n\n\tif(cp) {\n\t\tif(cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\t\tif(cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\t}\n\n\tfor(var i = 0; i != CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i];\n\t\tvar v = opts.Props && opts.Props[f[1]] != null ? opts.Props[f[1]] : cp ? cp[f[1]] : null;\n\t\tif(v === true) v = \"1\";\n\t\telse if(v === false) v = \"0\";\n\t\telse if(typeof v == \"number\") v = String(v);\n\t\tif(v != null) cp_doit(f[0], v, null, o, p);\n\t}\n\tif(o.length>2){ o[o.length] = ('</cp:coreProperties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.3 Extended File Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar EXT_PROPS/*:Array<Array<string> >*/ = [\n\t[\"Application\", \"Application\", \"string\"],\n\t[\"AppVersion\", \"AppVersion\", \"string\"],\n\t[\"Company\", \"Company\", \"string\"],\n\t[\"DocSecurity\", \"DocSecurity\", \"string\"],\n\t[\"Manager\", \"Manager\", \"string\"],\n\t[\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\n\t[\"SharedDoc\", \"SharedDoc\", \"bool\"],\n\t[\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\n\t[\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\n\t[\"HeadingPairs\", \"HeadingPairs\", \"raw\"],\n\t[\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]\n];\n\nvar PseudoPropsPairs = [\n\t\"Worksheets\",  \"SheetNames\",\n\t\"NamedRanges\", \"DefinedNames\",\n\t\"Chartsheets\", \"ChartNames\"\n];\nfunction load_props_pairs(HP/*:string|Array<Array<any>>*/, TOP, props, opts) {\n\tvar v = [];\n\tif(typeof HP == \"string\") v = parseVector(HP, opts);\n\telse for(var j = 0; j < HP.length; ++j) v = v.concat(HP[j].map(function(hp) { return {v:hp}; }));\n\tvar parts = (typeof TOP == \"string\") ? parseVector(TOP, opts).map(function (x) { return x.v; }) : TOP;\n\tvar idx = 0, len = 0;\n\tif(parts.length > 0) for(var i = 0; i !== v.length; i += 2) {\n\t\tlen = +(v[i+1].v);\n\t\tswitch(v[i].v) {\n\t\t\tcase \"Worksheets\":\n\t\t\tcase \"工作表\":\n\t\t\tcase \"Листы\":\n\t\t\tcase \"أوراق العمل\":\n\t\t\tcase \"ワークシート\":\n\t\t\tcase \"גליונות עבודה\":\n\t\t\tcase \"Arbeitsblätter\":\n\t\t\tcase \"Çalışma Sayfaları\":\n\t\t\tcase \"Feuilles de calcul\":\n\t\t\tcase \"Fogli di lavoro\":\n\t\t\tcase \"Folhas de cálculo\":\n\t\t\tcase \"Planilhas\":\n\t\t\tcase \"Regneark\":\n\t\t\tcase \"Hojas de cálculo\":\n\t\t\tcase \"Werkbladen\":\n\t\t\t\tprops.Worksheets = len;\n\t\t\t\tprops.SheetNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\n\t\t\tcase \"Named Ranges\":\n\t\t\tcase \"Rangos con nombre\":\n\t\t\tcase \"名前付き一覧\":\n\t\t\tcase \"Benannte Bereiche\":\n\t\t\tcase \"Navngivne områder\":\n\t\t\t\tprops.NamedRanges = len;\n\t\t\t\tprops.DefinedNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\n\t\t\tcase \"Charts\":\n\t\t\tcase \"Diagramme\":\n\t\t\t\tprops.Chartsheets = len;\n\t\t\t\tprops.ChartNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\t\t}\n\t\tidx += len;\n\t}\n}\n\nfunction parse_ext_props(data, p, opts) {\n\tvar q = {}; if(!p) p = {};\n\tdata = utf8read(data);\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tvar xml = (str_match_xml_ns(data, f[0])||[])[1];\n\t\tswitch(f[2]) {\n\t\t\tcase \"string\": if(xml) p[f[1]] = unescapexml(xml); break;\n\t\t\tcase \"bool\": p[f[1]] = xml === \"true\"; break;\n\t\t\tcase \"raw\":\n\t\t\t\tvar cur = str_match_xml(data, f[0]);\n\t\t\t\tif(cur && cur.length > 0) q[f[1]] = cur[1];\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(q.HeadingPairs && q.TitlesOfParts) load_props_pairs(q.HeadingPairs, q.TitlesOfParts, p, opts);\n\n\treturn p;\n}\n\nfunction write_ext_props(cp/*::, opts*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [], W = writextag;\n\tif(!cp) cp = {};\n\tcp.Application = \"SheetJS\";\n\to[o.length] = (XML_HEADER);\n\to[o.length] = (writextag('Properties', null, {\n\t\t'xmlns': XMLNS.EXT_PROPS,\n\t\t'xmlns:vt': XMLNS.vt\n\t}));\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tif(cp[f[1]] === undefined) return;\n\t\tvar v;\n\t\tswitch(f[2]) {\n\t\t\tcase 'string': v = escapexml(String(cp[f[1]])); break;\n\t\t\tcase 'bool': v = cp[f[1]] ? 'true' : 'false'; break;\n\t\t}\n\t\tif(v !== undefined) o[o.length] = (W(f[0], v));\n\t});\n\n\t/* TODO: HeadingPairs, TitlesOfParts */\n\to[o.length] = (W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>')+W('vt:variant', W('vt:i4', String(cp.Worksheets))), {size:2, baseType:\"variant\"})));\n\to[o.length] = (W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function(s) { return \"<vt:lpstr>\" + escapexml(s) + \"</vt:lpstr>\"; }).join(\"\"), {size: cp.Worksheets, baseType:\"lpstr\"})));\n\tif(o.length>2){ o[o.length] = ('</Properties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.2 Custom File Properties Part */\nvar custregex = /<[^<>]+>[^<]*/g;\nfunction parse_cust_props(data/*:string*/, opts) {\n\tvar p = {}, name = \"\";\n\tvar m = data.match(custregex);\n\tif(m) for(var i = 0; i != m.length; ++i) {\n\t\tvar x = m[i], y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Properties': break;\n\t\t\tcase '<property': name = unescapexml(y.name); break;\n\t\t\tcase '</property>': name = null; break;\n\t\t\tdefault: if (x.indexOf('<vt:') === 0) {\n\t\t\t\tvar toks = x.split('>');\n\t\t\t\tvar type = toks[0].slice(4), text = toks[1];\n\t\t\t\t/* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\t\t\t\tswitch(type) {\n\t\t\t\t\tcase 'lpstr': case 'bstr': case 'lpwstr':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'bool':\n\t\t\t\t\t\tp[name] = parsexmlbool(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'i1': case 'i2': case 'i4': case 'i8': case 'int': case 'uint':\n\t\t\t\t\t\tp[name] = parseInt(text, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'r4': case 'r8': case 'decimal':\n\t\t\t\t\t\tp[name] = parseFloat(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'filetime': case 'date':\n\t\t\t\t\t\tp[name] = parseDate(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cy': case 'error':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(type.slice(-1) == '/') break;\n\t\t\t\t\t\tif(opts.WTF && typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n\t\t\t\t}\n\t\t\t} else if(x.slice(0,2) === \"</\") {/* empty */\n\t\t\t} else if(opts.WTF) throw new Error(x);\n\t\t}\n\t}\n\treturn p;\n}\n\nfunction write_cust_props(cp/*::, opts*/)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('Properties', null, {\n\t\t'xmlns': XMLNS.CUST_PROPS,\n\t\t'xmlns:vt': XMLNS.vt\n\t})];\n\tif(!cp) return o.join(\"\");\n\tvar pid = 1;\n\tkeys(cp).forEach(function custprop(k) { ++pid;\n\t\to[o.length] = (writextag('property', write_vt(cp[k], true), {\n\t\t\t'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n\t\t\t'pid': pid,\n\t\t\t'name': escapexml(k)\n\t\t}));\n\t});\n\tif(o.length>2){ o[o.length] = '</Properties>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* Common Name -> XLML Name */\nvar XLMLDocPropsMap = {\n\tTitle: 'Title',\n\tSubject: 'Subject',\n\tAuthor: 'Author',\n\tKeywords: 'Keywords',\n\tComments: 'Description',\n\tLastAuthor: 'LastAuthor',\n\tRevNumber: 'Revision',\n\tApplication: 'AppName',\n\t/* TotalTime: 'TotalTime', */\n\tLastPrinted: 'LastPrinted',\n\tCreatedDate: 'Created',\n\tModifiedDate: 'LastSaved',\n\t/* Pages */\n\t/* Words */\n\t/* Characters */\n\tCategory: 'Category',\n\t/* PresentationFormat */\n\tManager: 'Manager',\n\tCompany: 'Company',\n\t/* Guid */\n\t/* HyperlinkBase */\n\t/* Bytes */\n\t/* Lines */\n\t/* Paragraphs */\n\t/* CharactersWithSpaces */\n\tAppVersion: 'Version',\n\n\tContentStatus: 'ContentStatus', /* NOTE: missing from schema */\n\tIdentifier: 'Identifier', /* NOTE: missing from schema */\n\tLanguage: 'Language' /* NOTE: missing from schema */\n};\nvar evert_XLMLDPM;\n\nfunction xlml_set_prop(Props, tag/*:string*/, val) {\n\tif(!evert_XLMLDPM) evert_XLMLDPM = evert(XLMLDocPropsMap);\n\ttag = evert_XLMLDPM[tag] || tag;\n\tProps[tag] = val;\n}\n\nfunction xlml_write_docprops(Props, opts) {\n\tvar o/*:Array<string>*/ = [];\n\tkeys(XLMLDocPropsMap).map(function(m) {\n\t\tfor(var i = 0; i < CORE_PROPS.length; ++i) if(CORE_PROPS[i][1] == m) return CORE_PROPS[i];\n\t\tfor(i = 0; i < EXT_PROPS.length; ++i) if(EXT_PROPS[i][1] == m) return EXT_PROPS[i];\n\t\tthrow m;\n\t}).forEach(function(p) {\n\t\tif(Props[p[1]] == null) return;\n\t\tvar m = opts && opts.Props && opts.Props[p[1]] != null ? opts.Props[p[1]] : Props[p[1]];\n\t\tswitch(p[2]) {\n\t\t\tcase 'date': m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"Z\"); break;\n\t\t}\n\t\tif(typeof m == 'number') m = String(m);\n\t\telse if(m === true || m === false) { m = m ? \"1\" : \"0\"; }\n\t\telse if(m instanceof Date) m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"\");\n\t\to.push(writetag(XLMLDocPropsMap[p[1]] || p[1], m));\n\t});\n\treturn writextag('DocumentProperties', o.join(\"\"), {xmlns:XLMLNS.o });\n}\nfunction xlml_write_custprops(Props, Custprops/*::, opts*/) {\n\tvar BLACKLIST = [\"Worksheets\",\"SheetNames\"];\n\tvar T = 'CustomDocumentProperties';\n\tvar o/*:Array<string>*/ = [];\n\tif(Props) keys(Props).forEach(function(k) {\n\t\t/*:: if(!Props) return; */\n\t\tif(!Object.prototype.hasOwnProperty.call(Props, k)) return;\n\t\tfor(var i = 0; i < CORE_PROPS.length; ++i) if(k == CORE_PROPS[i][1]) return;\n\t\tfor(i = 0; i < EXT_PROPS.length; ++i) if(k == EXT_PROPS[i][1]) return;\n\t\tfor(i = 0; i < BLACKLIST.length; ++i) if(k == BLACKLIST[i]) return;\n\n\t\tvar m = Props[k];\n\t\tvar t = \"string\";\n\t\tif(typeof m == 'number') { t = \"float\"; m = String(m); }\n\t\telse if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\n\t\telse m = String(m);\n\t\to.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\n\t});\n\tif(Custprops) keys(Custprops).forEach(function(k) {\n\t\t/*:: if(!Custprops) return; */\n\t\tif(!Object.prototype.hasOwnProperty.call(Custprops, k)) return;\n\t\tif(Props && Object.prototype.hasOwnProperty.call(Props, k)) return;\n\t\tvar m = Custprops[k];\n\t\tvar t = \"string\";\n\t\tif(typeof m == 'number') { t = \"float\"; m = String(m); }\n\t\telse if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\n\t\telse if(m instanceof Date) { t = \"dateTime.tz\"; m = m.toISOString(); }\n\t\telse m = String(m);\n\t\to.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\n\t});\n\treturn '<' + T + ' xmlns=\"' + XLMLNS.o + '\">' + o.join(\"\") + '</' + T + '>';\n}\n/* [MS-DTYP] 2.3.3 FILETIME */\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\nfunction parse_FILETIME(blob) {\n\tvar dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\n\treturn new Date(((dwHighDateTime/1e7*Math.pow(2,32) + dwLowDateTime/1e7) - 11644473600)*1000).toISOString().replace(/\\.000/,\"\");\n}\nfunction write_FILETIME(time/*:string|Date*/) {\n\tvar date = (typeof time == \"string\") ? new Date(Date.parse(time)) : time;\n\tvar t = date.getTime() / 1000 + 11644473600;\n\tvar l = t % Math.pow(2,32), h = (t - l) / Math.pow(2,32);\n\tl *= 1e7; h *= 1e7;\n\tvar w = (l / Math.pow(2,32)) | 0;\n\tif(w > 0) { l = l % Math.pow(2,32); h += w; }\n\tvar o = new_buf(8); o.write_shift(4, l); o.write_shift(4, h); return o;\n}\n\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\nfunction parse_lpstr(blob, type, pad/*:?number*/) {\n\tvar start = blob.l;\n\tvar str = blob.read_shift(0, 'lpstr-cp');\n\tif(pad) while((blob.l - start) & 3) ++blob.l;\n\treturn str;\n}\n\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\nfunction parse_lpwstr(blob, type, pad) {\n\tvar str = blob.read_shift(0, 'lpwstr');\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\n\treturn str;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\nfunction parse_VtStringBase(blob, stringType, pad) {\n\tif(stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\n\treturn parse_lpstr(blob, stringType, pad);\n}\n\nfunction parse_VtString(blob, t/*:number*/, pad/*:?boolean*/) { return parse_VtStringBase(blob, t, pad === false ? 0: 4); }\nfunction parse_VtUnalignedString(blob, t/*:number*/) { if(!t) throw new Error(\"VtUnalignedString must have positive length\"); return parse_VtStringBase(blob, t, 0); }\n\n/* [MS-OSHARED] 2.3.3.1.7 VtVecLpwstrValue */\nfunction parse_VtVecLpwstrValue(blob)/*:Array<string>*/ {\n\tvar length = blob.read_shift(4);\n\tvar ret/*:Array<string>*/ = [];\n\tfor(var i = 0; i != length; ++i) {\n\t\tvar start = blob.l;\n\t\tret[i] = blob.read_shift(0, 'lpwstr').replace(chr0,'');\n\t\tif((blob.l - start) & 0x02) blob.l += 2;\n\t}\n\treturn ret;\n}\n\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\nfunction parse_VtVecUnalignedLpstrValue(blob)/*:Array<string>*/ {\n\tvar length = blob.read_shift(4);\n\tvar ret/*:Array<string>*/ = [];\n\tfor(var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr-cp').replace(chr0,'');\n\treturn ret;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\nfunction parse_VtHeadingPair(blob) {\n\tvar start = blob.l;\n\tvar headingString = parse_TypedPropertyValue(blob, VT_USTR);\n\tif(blob[blob.l] == 0x00 && blob[blob.l+1] == 0x00 && ((blob.l - start) & 0x02)) blob.l += 2;\n\tvar headerParts = parse_TypedPropertyValue(blob, VT_I4);\n\treturn [headingString, headerParts];\n}\n\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\nfunction parse_VtVecHeadingPairValue(blob) {\n\tvar cElements = blob.read_shift(4);\n\tvar out = [];\n\tfor(var i = 0; i < cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n\treturn out;\n}\n\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\nfunction parse_dictionary(blob,CodePage) {\n\tvar cnt = blob.read_shift(4);\n\tvar dict/*:{[number]:string}*/ = ({}/*:any*/);\n\tfor(var j = 0; j != cnt; ++j) {\n\t\tvar pid = blob.read_shift(4);\n\t\tvar len = blob.read_shift(4);\n\t\tdict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ?'utf16le':'utf8')).replace(chr0,'').replace(chr1,'!');\n\t\tif(CodePage === 0x4B0 && (len % 2)) blob.l += 2;\n\t}\n\tif(blob.l & 3) blob.l = (blob.l>>2+1)<<2;\n\treturn dict;\n}\n\n/* [MS-OLEPS] 2.9 BLOB */\nfunction parse_BLOB(blob) {\n\tvar size = blob.read_shift(4);\n\tvar bytes = blob.slice(blob.l,blob.l+size);\n\tblob.l += size;\n\tif((size & 3) > 0) blob.l += (4 - (size & 3)) & 3;\n\treturn bytes;\n}\n\n/* [MS-OLEPS] 2.11 ClipboardData */\nfunction parse_ClipboardData(blob) {\n\t// TODO\n\tvar o = {};\n\to.Size = blob.read_shift(4);\n\t//o.Format = blob.read_shift(4);\n\tblob.l += o.Size + 3 - (o.Size - 1) % 4;\n\treturn o;\n}\n\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\nfunction parse_TypedPropertyValue(blob, type/*:number*/, _opts)/*:any*/ {\n\tvar t = blob.read_shift(2), ret, opts = _opts||{};\n\tblob.l += 2;\n\tif(type !== VT_VARIANT)\n\tif(t !== type && VT_CUSTOM.indexOf(type)===-1 && !((type & 0xFFFE) == 0x101E && (t & 0xFFFE) == 0x101E)) throw new Error('Expected type ' + type + ' saw ' + t);\n\tswitch(type === VT_VARIANT ? t : type) {\n\t\tcase 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if(!opts.raw) blob.l += 2; return ret;\n\t\tcase 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\n\t\tcase 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\n\t\tcase 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\n\t\tcase 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/(^|[^\\u0000])\\u0000+$/,\"$1\"); break;\n\t\tcase 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/(^|[^\\u0000])\\u0000+$/,\"$1\"); break;\n\t\tcase 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\n\t\tcase 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\n\t\tcase 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\n\t\tcase 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw).replace(chr0,'');\n\t\tcase 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t/*, 4*/).replace(chr0,'');\n\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPairValue(blob);\n\t\tcase 0x101E /*VT_VECTOR|VT_LPSTR*/:\n\t\tcase 0x101F /*VT_VECTOR|VT_LPWSTR*/:\n\t\t\treturn t == 0x101F ? parse_VtVecLpwstrValue(blob) : parse_VtVecUnalignedLpstrValue(blob);\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n\t}\n}\nfunction write_TypedPropertyValue(type/*:number*/, value) {\n\tvar o = new_buf(4), p = new_buf(4);\n\to.write_shift(4, type == 0x50 ? 0x1F : type);\n\tswitch(type) {\n\t\tcase 0x03 /*VT_I4*/: p.write_shift(-4, value); break;\n\t\tcase 0x05 /*VT_I4*/: p = new_buf(8); p.write_shift(8, value, 'f'); break;\n\t\tcase 0x0B /*VT_BOOL*/: p.write_shift(4, value ? 0x01 : 0x00); break;\n\t\tcase 0x40 /*VT_FILETIME*/: /*:: if(typeof value !== \"string\" && !(value instanceof Date)) throw \"unreachable\"; */ p = write_FILETIME(value); break;\n\t\tcase 0x1F /*VT_LPWSTR*/:\n\t\tcase 0x50 /*VT_STRING*/:\n\t\t\t/*:: if(typeof value !== \"string\") throw \"unreachable\"; */\n\t\t\tp = new_buf(4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n\t\t\tp.write_shift(4, value.length + 1);\n\t\t\tp.write_shift(0, value, \"dbcs\");\n\t\t\twhile(p.l != p.length) p.write_shift(1, 0);\n\t\t\tbreak;\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + value);\n\t}\n\treturn bconcat([o, p]);\n}\n\n/* [MS-OLEPS] 2.20 PropertySet */\nfunction parse_PropertySet(blob, PIDSI) {\n\tvar start_addr = blob.l;\n\tvar size = blob.read_shift(4);\n\tvar NumProps = blob.read_shift(4);\n\tvar Props = [], i = 0;\n\tvar CodePage = 0;\n\tvar Dictionary = -1, DictObj/*:{[number]:string}*/ = ({}/*:any*/);\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tvar PropID = blob.read_shift(4);\n\t\tvar Offset = blob.read_shift(4);\n\t\tProps[i] = [PropID, Offset + start_addr];\n\t}\n\tProps.sort(function(x,y) { return x[1] - y[1]; });\n\tvar PropH = {};\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tif(blob.l !== Props[i][1]) {\n\t\t\tvar fail = true;\n\t\t\tif(i>0 && PIDSI) switch(PIDSI[Props[i-1][0]].t) {\n\t\t\t\tcase 0x02 /*VT_I2*/: if(blob.l+2 === Props[i][1]) { blob.l+=2; fail = false; } break;\n\t\t\t\tcase 0x50 /*VT_STRING*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t}\n\t\t\tif((!PIDSI||i==0) && blob.l <= Props[i][1]) { fail=false; blob.l = Props[i][1]; }\n\t\t\tif(fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n\t\t}\n\t\tif(PIDSI) {\n\t\t\tif(Props[i][0] == 0 && Props.length > i+1 && Props[i][1] == Props[i+1][1]) continue; // R9\n\t\t\tvar piddsi = PIDSI[Props[i][0]];\n\t\t\tPropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {raw:true});\n\t\t\tif(piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + (\"0000\" + String(PropH[piddsi.n] & 0xFFFF)).slice(-4);\n\t\t\tif(piddsi.n == \"CodePage\") switch(PropH[piddsi.n]) {\n\t\t\t\tcase 0: PropH[piddsi.n] = 1252;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 874:\n\t\t\t\tcase 932:\n\t\t\t\tcase 936:\n\t\t\t\tcase 949:\n\t\t\t\tcase 950:\n\t\t\t\tcase 1250:\n\t\t\t\tcase 1251:\n\t\t\t\tcase 1253:\n\t\t\t\tcase 1254:\n\t\t\t\tcase 1255:\n\t\t\t\tcase 1256:\n\t\t\t\tcase 1257:\n\t\t\t\tcase 1258:\n\t\t\t\tcase 10000:\n\t\t\t\tcase 1200:\n\t\t\t\tcase 1201:\n\t\t\t\tcase 1252:\n\t\t\t\tcase 65000: case -536:\n\t\t\t\tcase 65001: case -535:\n\t\t\t\t\tset_cp(CodePage = (PropH[piddsi.n]>>>0) & 0xFFFF); break;\n\t\t\t\tdefault: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n\t\t\t}\n\t\t} else {\n\t\t\tif(Props[i][0] === 0x1) {\n\t\t\t\tCodePage = PropH.CodePage = (parse_TypedPropertyValue(blob, VT_I2)/*:number*/);\n\t\t\t\tset_cp(CodePage);\n\t\t\t\tif(Dictionary !== -1) {\n\t\t\t\t\tvar oldpos = blob.l;\n\t\t\t\t\tblob.l = Props[Dictionary][1];\n\t\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t\t\tblob.l = oldpos;\n\t\t\t\t}\n\t\t\t} else if(Props[i][0] === 0) {\n\t\t\t\tif(CodePage === 0) { Dictionary = i; blob.l = Props[i+1][1]; continue; }\n\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t} else {\n\t\t\t\tvar name = DictObj[Props[i][0]];\n\t\t\t\tvar val;\n\t\t\t\t/* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\t\t\t\tswitch(blob[blob.l]) {\n\t\t\t\t\tcase 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\n\t\t\t\t\tcase 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/(^|[^\\u0000])\\u0000+$/,\"$1\"); break;\n\t\t\t\t\tcase 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/(^|[^\\u0000])\\u0000+$/,\"$1\"); break;\n\t\t\t\t\tcase 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\n\t\t\t\t\tcase 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\n\t\t\t\t\tcase 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\n\t\t\t\t\tcase 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\n\t\t\t\t\tcase 0x40 /*VT_FILETIME*/: blob.l += 4; val = parseDate(parse_FILETIME(blob)); break;\n\t\t\t\t\tdefault: throw new Error(\"unparsed value: \" + blob[blob.l]);\n\t\t\t\t}\n\t\t\t\tPropH[name] = val;\n\t\t\t}\n\t\t}\n\t}\n\tblob.l = start_addr + size; /* step ahead to skip padding */\n\treturn PropH;\n}\nvar XLSPSSkip = [ \"CodePage\", \"Thumbnail\", \"_PID_LINKBASE\", \"_PID_HLINKS\", \"SystemIdentifier\", \"FMTID\" ];\nfunction guess_property_type(val/*:any*/)/*:number*/ {\n\tswitch(typeof val) {\n\t\tcase \"boolean\": return 0x0B;\n\t\tcase \"number\": return ((val|0)==val) ? 0x03 : 0x05;\n\t\tcase \"string\": return 0x1F;\n\t\tcase \"object\": if(val instanceof Date) return 0x40; break;\n\t}\n\treturn -1;\n}\nfunction write_PropertySet(entries, RE, PIDSI) {\n\tvar hdr = new_buf(8), piao = [], prop = [];\n\tvar sz = 8, i = 0;\n\n\tvar pr = new_buf(8), pio = new_buf(8);\n\tpr.write_shift(4, 0x0002);\n\tpr.write_shift(4, 0x04B0);\n\tpio.write_shift(4, 0x0001);\n\tprop.push(pr); piao.push(pio);\n\tsz += 8 + pr.length;\n\n\tif(!RE) {\n\t\tpio = new_buf(8);\n\t\tpio.write_shift(4, 0);\n\t\tpiao.unshift(pio);\n\n\t\tvar bufs = [new_buf(4)];\n\t\tbufs[0].write_shift(4, entries.length);\n\t\tfor(i = 0; i < entries.length; ++i) {\n\t\t\tvar value = entries[i][0];\n\t\t\tpr = new_buf(4 + 4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n\t\t\tpr.write_shift(4, i+2);\n\t\t\tpr.write_shift(4, value.length + 1);\n\t\t\tpr.write_shift(0, value, \"dbcs\");\n\t\t\twhile(pr.l != pr.length) pr.write_shift(1, 0);\n\t\t\tbufs.push(pr);\n\t\t}\n\t\tpr = bconcat(bufs);\n\t\tprop.unshift(pr);\n\t\tsz += 8 + pr.length;\n\t}\n\n\tfor(i = 0; i < entries.length; ++i) {\n\t\tif(RE && !RE[entries[i][0]]) continue;\n\t\tif(XLSPSSkip.indexOf(entries[i][0]) > -1 || PseudoPropsPairs.indexOf(entries[i][0]) > -1) continue;\n\t\tif(entries[i][1] == null) continue;\n\n\t\tvar val = entries[i][1], idx = 0;\n\t\tif(RE) {\n\t\t\tidx = +RE[entries[i][0]];\n\t\t\tvar pinfo = (PIDSI/*:: || {}*/)[idx]/*:: || {} */;\n\t\t\tif(pinfo.p == \"version\" && typeof val == \"string\") {\n\t\t\t\t/*:: if(typeof val !== \"string\") throw \"unreachable\"; */\n\t\t\t\tvar arr = val.split(\".\");\n\t\t\t\tval = ((+arr[0])<<16) + ((+arr[1])||0);\n\t\t\t}\n\t\t\tpr = write_TypedPropertyValue(pinfo.t, val);\n\t\t} else {\n\t\t\tvar T = guess_property_type(val);\n\t\t\tif(T == -1) { T = 0x1F; val = String(val); }\n\t\t\tpr = write_TypedPropertyValue(T, val);\n\t\t}\n\t\tprop.push(pr);\n\n\t\tpio = new_buf(8);\n\t\tpio.write_shift(4, !RE ? 2+i : idx);\n\t\tpiao.push(pio);\n\n\t\tsz += 8 + pr.length;\n\t}\n\n\tvar w = 8 * (prop.length + 1);\n\tfor(i = 0; i < prop.length; ++i) { piao[i].write_shift(4, w); w += prop[i].length; }\n\thdr.write_shift(4, sz);\n\thdr.write_shift(4, prop.length);\n\treturn bconcat([hdr].concat(piao).concat(prop));\n}\n\n/* [MS-OLEPS] 2.21 PropertySetStream */\nfunction parse_PropertySetStream(file, PIDSI, clsid) {\n\tvar blob = file.content;\n\tif(!blob) return ({}/*:any*/);\n\tprep_blob(blob, 0);\n\n\tvar NumSets, FMTID0, FMTID1, Offset0, Offset1 = 0;\n\tblob.chk('feff', 'Byte Order: ');\n\n\t/*var vers = */blob.read_shift(2); // TODO: check version\n\tvar SystemIdentifier = blob.read_shift(4);\n\tvar CLSID = blob.read_shift(16);\n\tif(CLSID !== CFB.utils.consts.HEADER_CLSID && CLSID !== clsid) throw new Error(\"Bad PropertySet CLSID \" + CLSID);\n\tNumSets = blob.read_shift(4);\n\tif(NumSets !== 1 && NumSets !== 2) throw new Error(\"Unrecognized #Sets: \" + NumSets);\n\tFMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\n\n\tif(NumSets === 1 && Offset0 !== blob.l) throw new Error(\"Length mismatch: \" + Offset0 + \" !== \" + blob.l);\n\telse if(NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\n\tvar PSet0 = parse_PropertySet(blob, PIDSI);\n\n\tvar rval = ({ SystemIdentifier: SystemIdentifier }/*:any*/);\n\tfor(var y in PSet0) rval[y] = PSet0[y];\n\t//rval.blob = blob;\n\trval.FMTID = FMTID0;\n\t//rval.PSet0 = PSet0;\n\tif(NumSets === 1) return rval;\n\tif(Offset1 - blob.l == 2) blob.l += 2;\n\tif(blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n\tvar PSet1;\n\ttry { PSet1 = parse_PropertySet(blob, null); } catch(e) {/* empty */}\n\tfor(y in PSet1) rval[y] = PSet1[y];\n\trval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\treturn rval;\n}\nfunction write_PropertySetStream(entries, clsid, RE, PIDSI/*:{[key:string|number]:any}*/, entries2/*:?any*/, clsid2/*:?any*/) {\n\tvar hdr = new_buf(entries2 ? 68 : 48);\n\tvar bufs = [hdr];\n\thdr.write_shift(2, 0xFFFE);\n\thdr.write_shift(2, 0x0000); /* TODO: type 1 props */\n\thdr.write_shift(4, 0x32363237);\n\thdr.write_shift(16, CFB.utils.consts.HEADER_CLSID, \"hex\");\n\thdr.write_shift(4, (entries2 ? 2 : 1));\n\thdr.write_shift(16, clsid, \"hex\");\n\thdr.write_shift(4, (entries2 ? 68 : 48));\n\tvar ps0 = write_PropertySet(entries, RE, PIDSI);\n\tbufs.push(ps0);\n\n\tif(entries2) {\n\t\tvar ps1 = write_PropertySet(entries2, null, null);\n\t\thdr.write_shift(16, clsid2, \"hex\");\n\t\thdr.write_shift(4, 68 + ps0.length);\n\t\tbufs.push(ps1);\n\t}\n\treturn bconcat(bufs);\n}\n\nfunction parsenoop2(blob, length) { blob.read_shift(length); return null; }\nfunction writezeroes(n, o) { if(!o) o=new_buf(n); for(var j=0; j<n; ++j) o.write_shift(1, 0); return o; }\n\nfunction parslurp(blob, length, cb) {\n\tvar arr = [], target = blob.l + length;\n\twhile(blob.l < target) arr.push(cb(blob, target - blob.l));\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\n\treturn arr;\n}\n\nfunction parsebool(blob, length/*:number*/) { return blob.read_shift(length) === 0x1; }\nfunction writebool(v/*:any*/, o) { if(!o) o=new_buf(2); o.write_shift(2, +!!v); return o; }\n\nfunction parseuint16(blob/*::, length:?number, opts:?any*/) { return blob.read_shift(2, 'u'); }\nfunction writeuint16(v/*:number*/, o) { if(!o) o=new_buf(2); o.write_shift(2, v); return o; }\nfunction parseuint16a(blob, length/*:: :?number, opts:?any*/) { return parslurp(blob,length,parseuint16);}\n\n/* --- 2.5 Structures --- */\n\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\nfunction parse_Bes(blob/*::, length*/) {\n\tvar v = blob.read_shift(1), t = blob.read_shift(1);\n\treturn t === 0x01 ? v : v === 0x01;\n}\nfunction write_Bes(v, t/*:string*/, o) {\n\tif(!o) o = new_buf(2);\n\to.write_shift(1, ((t == 'e') ? +v : +!!v));\n\to.write_shift(1, ((t == 'e') ? 1 : 0));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);\n\tvar encoding = 'sbcs-cont';\n\tvar cp = current_codepage;\n\tif(opts && opts.biff >= 8) current_codepage = 1200;\n\tif(!opts || opts.biff == 8 ) {\n\t\tvar fHighByte = blob.read_shift(1);\n\t\tif(fHighByte) { encoding = 'dbcs-cont'; }\n\t} else if(opts.biff == 12) {\n\t\tencoding = 'wstr';\n\t}\n\tif(opts.biff >= 2 && opts.biff <= 5) encoding = 'cpstr';\n\tvar o = cch ? blob.read_shift(cch, encoding) : \"\";\n\tcurrent_codepage = cp;\n\treturn o;\n}\n\n/* 2.5.293 XLUnicodeRichExtendedString */\nfunction parse_XLUnicodeRichExtendedString(blob) {\n\tvar cp = current_codepage;\n\tcurrent_codepage = 1200;\n\tvar cch = blob.read_shift(2), flags = blob.read_shift(1);\n\tvar /*fHighByte = flags & 0x1,*/ fExtSt = flags & 0x4, fRichSt = flags & 0x8;\n\tvar width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\tvar cRun = 0, cbExtRst;\n\tvar z = {};\n\tif(fRichSt) cRun = blob.read_shift(2);\n\tif(fExtSt) cbExtRst = blob.read_shift(4);\n\tvar encoding = width == 2 ? 'dbcs-cont' : 'sbcs-cont';\n\tvar msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n\tif(fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\tif(fExtSt) blob.l += cbExtRst; //TODO: parse this\n\tz.t = msg;\n\tif(!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\n\tcurrent_codepage = cp;\n\treturn z;\n}\nfunction write_XLUnicodeRichExtendedString(xlstr/*:: :XLString, opts*/) {\n\tvar str = (xlstr.t||\"\"), nfmts = 1;\n\n\tvar hdr = new_buf(3 + (nfmts > 1 ? 2 : 0));\n\thdr.write_shift(2, str.length);\n\thdr.write_shift(1, (nfmts > 1 ? 0x08 : 0x00) | 0x01);\n\tif(nfmts > 1) hdr.write_shift(2, nfmts);\n\n\tvar otext = new_buf(2 * str.length);\n\totext.write_shift(2 * str.length, str, 'utf16le');\n\n\tvar out = [hdr, otext];\n\n\treturn bconcat(out);\n}\n\n/* 2.5.296 XLUnicodeStringNoCch */\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\n\tvar retval;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'cpstr');\n\t\tif(opts.biff >= 12) return blob.read_shift(cch, 'dbcs-cont');\n\t}\n\tvar fHighByte = blob.read_shift(1);\n\tif(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\n\telse { retval = blob.read_shift(cch, 'dbcs-cont'); }\n\treturn retval;\n}\n\n/* 2.5.294 XLUnicodeString */\nfunction parse_XLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn parse_XLUnicodeStringNoCch(blob, cch, opts);\n}\n/* BIFF5 override */\nfunction parse_XLUnicodeString2(blob, length, opts) {\n\tif(opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, (opts.biff <= 4 || !blob.lens ) ? 'cpstr' : 'sbcs-cont');\n}\n/* TODO: BIFF5 and lower, codepage awareness */\nfunction write_XLUnicodeString(str, opts, o) {\n\tif(!o) o = new_buf(3 + 2 * str.length);\n\to.write_shift(2, str.length);\n\to.write_shift(1, 1);\n\to.write_shift(31, str, 'utf16le');\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.61 ControlInfo */\nfunction parse_ControlInfo(blob/*::, length, opts*/) {\n\tvar flags = blob.read_shift(1);\n\tblob.l++;\n\tvar accel = blob.read_shift(2);\n\tblob.l += 2;\n\treturn [flags, accel];\n}\n\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\nfunction parse_URLMoniker(blob/*::, length, opts*/) {\n\tvar len = blob.read_shift(4), start = blob.l;\n\tvar extra = false;\n\tif(len > 24) {\n\t\t/* look ahead */\n\t\tblob.l += len - 24;\n\t\tif(blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n\t\tblob.l = start;\n\t}\n\tvar url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,\"\");\n\tif(extra) blob.l += 24;\n\treturn url;\n}\n\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\nfunction parse_FileMoniker(blob/*::, length*/) {\n\tvar cAnti = blob.read_shift(2);\n\tvar preamble = \"\"; while(cAnti-- > 0) preamble += \"../\";\n\tvar ansiPath = blob.read_shift(0, 'lpstr-ansi');\n\tblob.l += 2; //var endServer = blob.read_shift(2);\n\tif(blob.read_shift(2) != 0xDEAD) throw new Error(\"Bad FileMoniker\");\n\tvar sz = blob.read_shift(4);\n\tif(sz === 0) return preamble + ansiPath.replace(/\\\\/g,\"/\");\n\tvar bytes = blob.read_shift(4);\n\tif(blob.read_shift(2) != 3) throw new Error(\"Bad FileMoniker\");\n\tvar unicodePath = blob.read_shift(bytes>>1, 'utf16le').replace(chr0,\"\");\n\treturn preamble + unicodePath;\n}\n\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\nfunction parse_HyperlinkMoniker(blob, length) {\n\tvar clsid = blob.read_shift(16); length -= 16;\n\tswitch(clsid) {\n\t\tcase \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\n\t\tcase \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\n\t\tdefault: throw new Error(\"Unsupported Moniker \" + clsid);\n\t}\n}\n\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\nfunction parse_HyperlinkString(blob/*::, length*/) {\n\tvar len = blob.read_shift(4);\n\tvar o = len > 0 ? blob.read_shift(len, 'utf16le').replace(chr0, \"\") : \"\";\n\treturn o;\n}\nfunction write_HyperlinkString(str/*:string*/, o) {\n\tif(!o) o = new_buf(6 + str.length * 2);\n\to.write_shift(4, 1 + str.length);\n\tfor(var i = 0; i < str.length; ++i) o.write_shift(2, str.charCodeAt(i));\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object */\nfunction parse_Hyperlink(blob, length)/*:Hyperlink*/ {\n\tvar end = blob.l + length;\n\tvar sVer = blob.read_shift(4);\n\tif(sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n\tvar flags = blob.read_shift(2);\n\tblob.l += 2;\n\tvar displayName, targetFrameName, moniker, oleMoniker, Loc=\"\", guid, fileTime;\n\tif(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n\tif(flags & 0x0008) Loc = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0020) guid = blob.read_shift(16);\n\tif(flags & 0x0040) fileTime = parse_FILETIME(blob/*, 8*/);\n\tblob.l = end;\n\tvar target = targetFrameName||moniker||oleMoniker||\"\";\n\tif(target && Loc) target+=\"#\"+Loc;\n\tif(!target) target = \"#\" + Loc;\n\tif((flags & 0x0002) && target.charAt(0) == \"/\" && target.charAt(1) != \"/\") target = \"file://\" + target;\n\tvar out = ({Target:target}/*:any*/);\n\tif(guid) out.guid = guid;\n\tif(fileTime) out.time = fileTime;\n\tif(displayName) out.Tooltip = displayName;\n\treturn out;\n}\nfunction write_Hyperlink(hl) {\n\tvar out = new_buf(512), i = 0;\n\tvar Target = hl.Target;\n\tif(Target.slice(0,7) == \"file://\") Target = Target.slice(7);\n\tvar hashidx = Target.indexOf(\"#\");\n\tvar F = hashidx > -1 ? 0x1f : 0x17;\n\tswitch(Target.charAt(0)) { case \"#\": F=0x1c; break; case \".\": F&=~2; break; }\n\tout.write_shift(4,2); out.write_shift(4, F);\n\tvar data = [8,6815827,6619237,4849780,83]; for(i = 0; i < data.length; ++i) out.write_shift(4, data[i]);\n\tif(F == 0x1C) {\n\t\tTarget = Target.slice(1);\n\t\twrite_HyperlinkString(Target, out);\n\t} else if(F & 0x02) {\n\t\tdata = \"e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\t\tfor(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\t\tvar Pretarget = hashidx > -1 ? Target.slice(0, hashidx) : Target;\n\t\tout.write_shift(4, 2*(Pretarget.length + 1));\n\t\tfor(i = 0; i < Pretarget.length; ++i) out.write_shift(2, Pretarget.charCodeAt(i));\n\t\tout.write_shift(2, 0);\n\t\tif(F & 0x08) write_HyperlinkString(hashidx > -1 ? Target.slice(hashidx+1): \"\", out);\n\t} else {\n\t\tdata = \"03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\".split(\" \");\n\t\tfor(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\t\tvar P = 0;\n\t\twhile(Target.slice(P*3,P*3+3)==\"../\"||Target.slice(P*3,P*3+3)==\"..\\\\\") ++P;\n\t\tout.write_shift(2, P);\n\t\tout.write_shift(4, Target.length - 3 * P + 1);\n\t\tfor(i = 0; i < Target.length - 3 * P; ++i) out.write_shift(1, Target.charCodeAt(i + 3 * P) & 0xFF);\n\t\tout.write_shift(1, 0);\n\t\tout.write_shift(2, 0xFFFF);\n\t\tout.write_shift(2, 0xDEAD);\n\t\tfor(i = 0; i < 6; ++i) out.write_shift(4, 0);\n\t}\n\treturn out.slice(0, out.l);\n}\n\n/* 2.5.178 LongRGBA */\nfunction parse_LongRGBA(blob/*::, length*/) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }\n\n/* 2.5.177 LongRGB */\nfunction parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\n\n\n/* [MS-XLS] 2.5.19 */\nfunction parse_XLSCell(blob, length, opts)/*:Cell*/ {\n\tvar rw = blob.read_shift(2); // 0-indexed\n\tvar col = blob.read_shift(2);\n\tvar ret = ({r:rw, c:col, ixfe:0}/*:any*/);\n\tif(opts && opts.biff == 2 || length == 7) {\n\t\t/* TODO: pass back flags */\n\t\tvar flags = blob.read_shift(1);\n\t\tret.ixfe = flags & 0x3F;\n\t\tblob.l += 2;\n\t\t/*\n\t\tvar ifntifmt = blob.read_shift(1);\n\t\tvar ifmt = ifntifmt & 0x3f, ifnt = ifntifmt >> 6;\n\t\tvar flags3 = blob.read_shift(1);\n\t\t*/\n\t} else ret.ixfe = blob.read_shift(2);\n\treturn ret;\n}\nfunction write_XLSCell(R/*:number*/, C/*:number*/, ixfe/*:?number*/, o) {\n\tif(!o) o = new_buf(6);\n\to.write_shift(2, R);\n\to.write_shift(2, C);\n\to.write_shift(2, ixfe||0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.134 */\nfunction parse_frtHeader(blob) {\n\tvar rt = blob.read_shift(2);\n\tvar flags = blob.read_shift(2); // TODO: parse these flags\n\tblob.l += 8;\n\treturn {type: rt, flags: flags};\n}\n\n\n\nfunction parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\n\n/* [MS-XLS] 2.5.344 */\nfunction parse_XTI(blob, length, opts) {\n\tvar w = opts.biff > 8 ? 4 : 2;\n\tvar iSupBook = blob.read_shift(w), itabFirst = blob.read_shift(w,'i'), itabLast = blob.read_shift(w,'i');\n\treturn [iSupBook, itabFirst, itabLast];\n}\n\n/* [MS-XLS] 2.5.218 */\nfunction parse_RkRec(blob) {\n\tvar ixfe = blob.read_shift(2);\n\tvar RK = parse_RkNumber(blob);\n\treturn [ixfe, RK];\n}\n\n/* [MS-XLS] 2.5.1 */\nfunction parse_AddinUdf(blob, length, opts) {\n\tblob.l += 4; length -= 4;\n\tvar l = blob.l + length;\n\tvar udfName = parse_ShortXLUnicodeString(blob, length, opts);\n\tvar cb = blob.read_shift(2);\n\tl -= blob.l;\n\tif(cb !== l) throw new Error(\"Malformed AddinUdf: padding = \" + l + \" != \" + cb);\n\tblob.l += cb;\n\treturn udfName;\n}\n\n/* [MS-XLS] 2.5.209 TODO: Check sizes */\nfunction parse_Ref8U(blob/*::, length*/) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(2);\n\tvar colLast = blob.read_shift(2);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\nfunction write_Ref8U(r/*:Range*/, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(2, r.s.r);\n\to.write_shift(2, r.e.r);\n\to.write_shift(2, r.s.c);\n\to.write_shift(2, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.211 */\nfunction parse_RefU(blob/*::, length*/) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(1);\n\tvar colLast = blob.read_shift(1);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\n\n/* [MS-XLS] 2.5.207 */\nvar parse_Ref = parse_RefU;\n\n/* [MS-XLS] 2.5.143 */\nfunction parse_FtCmo(blob/*::, length*/) {\n\tblob.l += 4;\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tblob.l+=12;\n\treturn [id, ot, flags];\n}\n\n/* [MS-XLS] 2.5.149 */\nfunction parse_FtNts(blob) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.l += 16; // GUID TODO\n\tout.fSharedNote = blob.read_shift(2);\n\tblob.l += 4;\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.142 */\nfunction parse_FtCf(blob) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.cf = blob.read_shift(2);\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.140 - 2.5.154 and friends */\nfunction parse_FtSkip(blob) { blob.l += 2; blob.l += blob.read_shift(2); }\nvar FtTab = {\n\t0x00: parse_FtSkip,      /* FtEnd */\n\t0x04: parse_FtSkip,      /* FtMacro */\n\t0x05: parse_FtSkip,      /* FtButton */\n\t0x06: parse_FtSkip,      /* FtGmo */\n\t0x07: parse_FtCf,        /* FtCf */\n\t0x08: parse_FtSkip,      /* FtPioGrbit */\n\t0x09: parse_FtSkip,      /* FtPictFmla */\n\t0x0A: parse_FtSkip,      /* FtCbls */\n\t0x0B: parse_FtSkip,      /* FtRbo */\n\t0x0C: parse_FtSkip,      /* FtSbs */\n\t0x0D: parse_FtNts,       /* FtNts */\n\t0x0E: parse_FtSkip,      /* FtSbsFmla */\n\t0x0F: parse_FtSkip,      /* FtGboData */\n\t0x10: parse_FtSkip,      /* FtEdoData */\n\t0x11: parse_FtSkip,      /* FtRboData */\n\t0x12: parse_FtSkip,      /* FtCblsData */\n\t0x13: parse_FtSkip,      /* FtLbsData */\n\t0x14: parse_FtSkip,      /* FtCblsFmla */\n\t0x15: parse_FtCmo\n};\nfunction parse_FtArray(blob, length/*::, ot*/) {\n\tvar tgt = blob.l + length;\n\tvar fts = [];\n\twhile(blob.l < tgt) {\n\t\tvar ft = blob.read_shift(2);\n\t\tblob.l-=2;\n\t\ttry {\n\t\t\tfts[ft] = FtTab[ft](blob, tgt - blob.l);\n\t\t} catch(e) { blob.l = tgt; return fts; }\n\t}\n\tif(blob.l != tgt) blob.l = tgt; //throw new Error(\"bad Object Ft-sequence\");\n\treturn fts;\n}\n\n/* --- 2.4 Records --- */\n\n/* [MS-XLS] 2.4.21 */\nfunction parse_BOF(blob, length) {\n\tvar o = {BIFFVer:0, dt:0};\n\to.BIFFVer = blob.read_shift(2); length -= 2;\n\tif(length >= 2) { o.dt = blob.read_shift(2); blob.l -= 2; }\n\tswitch(o.BIFFVer) {\n\t\tcase 0x0600: /* BIFF8 */\n\t\tcase 0x0500: /* BIFF5 */\n\t\tcase 0x0400: /* BIFF4 */\n\t\tcase 0x0300: /* BIFF3 */\n\t\tcase 0x0200: /* BIFF2 */\n\t\tcase 0x0002: case 0x0007: /* BIFF2 */\n\t\t\tbreak;\n\t\tdefault: if(length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n\t}\n\n\tblob.read_shift(length);\n\treturn o;\n}\nfunction write_BOF(wb/*:Workbook*/, t/*:number*/, o) {\n\tvar h = 0x0600, w = 16;\n\tswitch(o.bookType) {\n\t\tcase 'biff8': break;\n\t\tcase 'biff5': h = 0x0500; w = 8; break;\n\t\tcase 'biff4': h = 0x0004; w = 6; break;\n\t\tcase 'biff3': h = 0x0003; w = 6; break;\n\t\tcase 'biff2': h = 0x0002; w = 4; break;\n\t\tcase 'xla': break;\n\t\tdefault: throw new Error(\"unsupported BIFF version\");\n\t}\n\tvar out = new_buf(w);\n\tout.write_shift(2, h);\n\tout.write_shift(2, t);\n\tif(w > 4) out.write_shift(2, 0x7262);\n\tif(w > 6) out.write_shift(2, 0x07CD);\n\tif(w > 8) {\n\t\tout.write_shift(2, 0xC009);\n\t\tout.write_shift(2, 0x0001);\n\t\tout.write_shift(2, 0x0706);\n\t\tout.write_shift(2, 0x0000);\n\t}\n\treturn out;\n}\n\n\n/* [MS-XLS] 2.4.146 */\nfunction parse_InterfaceHdr(blob, length) {\n\tif(length === 0) return 0x04b0;\n\tif((blob.read_shift(2))!==0x04b0){/* empty */}\n\treturn 0x04b0;\n}\n\n\n/* [MS-XLS] 2.4.349 */\nfunction parse_WriteAccess(blob, length, opts) {\n\tif(opts.enc) { blob.l += length; return \"\"; }\n\tvar l = blob.l;\n\t// TODO: make sure XLUnicodeString doesnt overrun\n\tvar UserName = parse_XLUnicodeString2(blob, 0, opts);\n\tblob.read_shift(length + l - blob.l);\n\treturn UserName;\n}\nfunction write_WriteAccess(s/*:string*/, opts) {\n\tvar b8 = !opts || opts.biff == 8;\n\tvar o = new_buf(b8 ? 112 : 54);\n\to.write_shift(opts.biff == 8 ? 2 : 1, 7);\n\tif(b8) o.write_shift(1, 0);\n\to.write_shift(4, 0x33336853);\n\to.write_shift(4, (0x00534A74 | (b8 ? 0 : 0x20000000)));\n\twhile(o.l < o.length) o.write_shift(1, (b8 ? 0 : 32));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.351 */\nfunction parse_WsBool(blob, length, opts) {\n\tvar flags = opts && opts.biff == 8 || length == 2 ? blob.read_shift(2) : (blob.l += length, 0);\n\treturn { fDialog: flags & 0x10, fBelow: flags & 0x40, fRight: flags & 0x80 };\n}\n\n/* [MS-XLS] 2.4.28 */\nfunction parse_BoundSheet8(blob, length, opts) {\n\tvar name = \"\";\n\tif(opts.biff == 4) {\n\t\tname = parse_ShortXLUnicodeString(blob, 0, opts);\n\t\tif(name.length === 0) name = \"Sheet1\";\n\t\treturn { name:name };\n\t}\n\tvar pos = blob.read_shift(4);\n\tvar hidden = blob.read_shift(1) & 0x03;\n\tvar dt = blob.read_shift(1);\n\tswitch(dt) {\n\t\tcase 0: dt = 'Worksheet'; break;\n\t\tcase 1: dt = 'Macrosheet'; break;\n\t\tcase 2: dt = 'Chartsheet'; break;\n\t\tcase 6: dt = 'VBAModule'; break;\n\t}\n\tname = parse_ShortXLUnicodeString(blob, 0, opts);\n\tif(name.length === 0) name = \"Sheet1\";\n\treturn { pos:pos, hs:hidden, dt:dt, name:name };\n}\nfunction write_BoundSheet8(data, opts) {\n\tvar w = (!opts || opts.biff >= 8 ? 2 : 1);\n\tvar o = new_buf(8 + w * data.name.length);\n\to.write_shift(4, data.pos);\n\to.write_shift(1, data.hs || 0);\n\to.write_shift(1, data.dt);\n\to.write_shift(1, data.name.length);\n\tif(opts.biff >= 8) o.write_shift(1, 1);\n\to.write_shift(w * data.name.length, data.name, opts.biff < 8 ? 'sbcs' : 'utf16le');\n\tvar out = o.slice(0, o.l);\n\tout.l = o.l; return out;\n}\n\n/* [MS-XLS] 2.4.265 TODO */\nfunction parse_SST(blob, length)/*:SST*/ {\n\tvar end = blob.l + length;\n\tvar cnt = blob.read_shift(4);\n\tvar ucnt = blob.read_shift(4);\n\tvar strs/*:SST*/ = ([]/*:any*/);\n\tfor(var i = 0; i != ucnt && blob.l < end; ++i) {\n\t\tstrs.push(parse_XLUnicodeRichExtendedString(blob));\n\t}\n\tstrs.Count = cnt; strs.Unique = ucnt;\n\treturn strs;\n}\nfunction write_SST(sst, opts) {\n\tvar header = new_buf(8);\n\theader.write_shift(4, sst.Count);\n\theader.write_shift(4, sst.Unique);\n\tvar strs = [];\n\tfor(var j = 0; j < sst.length; ++j) strs[j] = write_XLUnicodeRichExtendedString(sst[j], opts);\n\tvar o = bconcat([header].concat(strs));\n\t/*::(*/o/*:: :any)*/.parts = [header.length].concat(strs.map(function(str) { return str.length; }));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.107 */\nfunction parse_ExtSST(blob, length) {\n\tvar extsst = {};\n\textsst.dsst = blob.read_shift(2);\n\tblob.l += length-2;\n\treturn extsst;\n}\n\n\n/* [MS-XLS] 2.4.221 TODO: check BIFF2-4 */\nfunction parse_Row(blob) {\n\tvar z = ({}/*:any*/);\n\tz.r = blob.read_shift(2);\n\tz.c = blob.read_shift(2);\n\tz.cnt = blob.read_shift(2) - z.c;\n\tvar miyRw = blob.read_shift(2);\n\tblob.l += 4; // reserved(2), unused(2)\n\tvar flags = blob.read_shift(1); // various flags\n\tblob.l += 3; // reserved(8), ixfe(12), flags(4)\n\tif(flags & 0x07) z.level = flags & 0x07;\n\t// collapsed: flags & 0x10\n\tif(flags & 0x20) z.hidden = true;\n\tif(flags & 0x40) z.hpt = miyRw / 20;\n\treturn z;\n}\n\n\n/* [MS-XLS] 2.4.125 */\nfunction parse_ForceFullCalculation(blob) {\n\tvar header = parse_frtHeader(blob);\n\tif(header.type != 0x08A3) throw new Error(\"Invalid Future Record \" + header.type);\n\tvar fullcalc = blob.read_shift(4);\n\treturn fullcalc !== 0x0;\n}\n\n\n\n\n\n/* [MS-XLS] 2.4.215 rt */\nfunction parse_RecalcId(blob) {\n\tblob.read_shift(2);\n\treturn blob.read_shift(4);\n}\n\n/* [MS-XLS] 2.4.87 */\nfunction parse_DefaultRowHeight(blob, length, opts) {\n\tvar f = 0;\n\tif(!(opts && opts.biff == 2)) {\n\t\tf = blob.read_shift(2);\n\t}\n\tvar miyRw = blob.read_shift(2);\n\tif((opts && opts.biff == 2)) {\n\t\tf = 1 - (miyRw >> 15); miyRw &= 0x7fff;\n\t}\n\tvar fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};\n\treturn [fl, miyRw];\n}\n\n/* [MS-XLS] 2.4.345 TODO */\nfunction parse_Window1(blob) {\n\tvar xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\n\tvar ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\n\treturn { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\n\t\tFirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };\n}\nfunction write_Window1(/*::opts*/) {\n\tvar o = new_buf(18);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0x7260);\n\to.write_shift(2, 0x44c0);\n\to.write_shift(2, 0x38);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 1);\n\to.write_shift(2, 0x01f4);\n\treturn o;\n}\n/* [MS-XLS] 2.4.346 TODO */\nfunction parse_Window2(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff < 5) return {};\n\tvar f = blob.read_shift(2);\n\treturn { RTL: f & 0x40 };\n}\nfunction write_Window2(view) {\n\tvar o = new_buf(18), f = 0x6b6;\n\tif(view && view.RTL) f |= 0x40;\n\to.write_shift(2, f);\n\to.write_shift(4, 0);\n\to.write_shift(4, 64);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.189 TODO */\nfunction parse_Pane(/*blob, length, opts*/) {\n}\n\n/* [MS-XLS] 2.4.122 TODO */\nfunction parse_Font(blob, length, opts) {\n\tvar o/*:any*/ = {\n\t\tdyHeight: blob.read_shift(2),\n\t\tfl: blob.read_shift(2)\n\t};\n\tswitch((opts && opts.biff) || 8) {\n\t\tcase 2: break;\n\t\tcase 3: case 4: blob.l += 2; break;\n\t\tdefault: blob.l += 10; break;\n\t}\n\to.name = parse_ShortXLUnicodeString(blob, 0, opts);\n\treturn o;\n}\nfunction write_Font(data, opts) {\n\tvar name = data.name || \"Arial\";\n\tvar b5 = (opts && (opts.biff == 5)), w = (b5 ? (15 + name.length) : (16 + 2 * name.length));\n\tvar o = new_buf(w);\n\to.write_shift(2, (data.sz || 12) * 20);\n\to.write_shift(4, 0);\n\to.write_shift(2, 400);\n\to.write_shift(4, 0);\n\to.write_shift(2, 0);\n\to.write_shift(1, name.length);\n\tif(!b5) o.write_shift(1, 1);\n\to.write_shift((b5 ? 1 : 2) * name.length, name, (b5 ? \"sbcs\" : \"utf16le\"));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.149 */\nfunction parse_LabelSst(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, length, opts);\n\tcell.isst = blob.read_shift(4);\n\treturn cell;\n}\nfunction write_LabelSst(R/*:number*/, C/*:number*/, v/*:number*/, os/*:number*/ /*::, opts*/) {\n\tvar o = new_buf(10);\n\twrite_XLSCell(R, C, os, o);\n\to.write_shift(4, v);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.148 */\nfunction parse_Label(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 2) opts.biff = 5;\n\tvar target = blob.l + length;\n\tvar cell = parse_XLSCell(blob, length, opts);\n\tvar str = parse_XLUnicodeString(blob, target - blob.l, opts);\n\tcell.val = str;\n\treturn cell;\n}\nfunction write_Label(R/*:number*/, C/*:number*/, v/*:string*/, os/*:number*/, opts) {\n\tvar b8 = !opts || opts.biff == 8;\n\tvar o = new_buf(6 + 2 + (+b8) + (1 + b8) * v.length);\n\twrite_XLSCell(R, C, os, o);\n\to.write_shift(2, v.length);\n\tif(b8) o.write_shift(1, 1);\n\to.write_shift((1 + b8) * v.length, v, b8 ? 'utf16le' : 'sbcs');\n\treturn o;\n}\n\n\n/* [MS-XLS] 2.4.126 Number Formats */\nfunction parse_Format(blob, length, opts) {\n\tvar numFmtId = blob.read_shift(2);\n\tvar fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n\treturn [numFmtId, fmtstr];\n}\nfunction write_Format(i/*:number*/, f/*:string*/, opts, o) {\n\tvar b5 = (opts && (opts.biff == 5));\n\tif(!o) o = new_buf(b5 ? (3 + f.length) : (5 + 2 * f.length));\n\to.write_shift(2, i);\n\to.write_shift((b5 ? 1 : 2), f.length);\n\tif(!b5) o.write_shift(1, 1);\n\to.write_shift((b5 ? 1 : 2) * f.length, f, (b5 ? 'sbcs' : 'utf16le'));\n\tvar out = (o.length > o.l) ? o.slice(0, o.l) : o;\n\tif(out.l == null) out.l = out.length;\n\treturn out;\n}\nvar parse_BIFF2Format = parse_XLUnicodeString2;\nfunction write_BIFF2Format(f/*:string*/) {\n\tvar o = new_buf(1 + f.length);\n\to.write_shift(1, f.length);\n\to.write_shift(f.length, f, \"sbcs\");\n\treturn o;\n}\nfunction write_BIFF4Format(f/*:string*/) {\n\tvar o = new_buf(3 + f.length);\n\to.l += 2;\n\to.write_shift(1, f.length);\n\to.write_shift(f.length, f, \"sbcs\");\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.90 */\nfunction parse_Dimensions(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar r = blob.read_shift(w), R = blob.read_shift(w);\n\tvar c = blob.read_shift(2), C = blob.read_shift(2);\n\tblob.l = end;\n\treturn {s: {r:r, c:c}, e: {r:R, c:C}};\n}\nfunction write_Dimensions(range, opts) {\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar o = new_buf(2*w + 6);\n\to.write_shift(w, range.s.r);\n\to.write_shift(w, range.e.r + 1);\n\to.write_shift(2, range.s.c);\n\to.write_shift(2, range.e.c + 1);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.220 */\nfunction parse_RK(blob) {\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrec = parse_RkRec(blob);\n\treturn {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};\n}\n\n/* [MS-XLS] 2.4.175 */\nfunction parse_MulRk(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrecs = [];\n\twhile(blob.l < target) rkrecs.push(parse_RkRec(blob));\n\tif(blob.l !== target) throw new Error(\"MulRK read error\");\n\tvar lastcol = blob.read_shift(2);\n\tif(rkrecs.length != lastcol - col + 1) throw new Error(\"MulRK length mismatch\");\n\treturn {r:rw, c:col, C:lastcol, rkrec:rkrecs};\n}\n/* [MS-XLS] 2.4.174 */\nfunction parse_MulBlank(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar ixfes = [];\n\twhile(blob.l < target) ixfes.push(blob.read_shift(2));\n\tif(blob.l !== target) throw new Error(\"MulBlank read error\");\n\tvar lastcol = blob.read_shift(2);\n\tif(ixfes.length != lastcol - col + 1) throw new Error(\"MulBlank length mismatch\");\n\treturn {r:rw, c:col, C:lastcol, ixfe:ixfes};\n}\n\n/* [MS-XLS] 2.5.20 2.5.249 TODO: interpret values here */\nfunction parse_CellStyleXF(blob, length, style, opts) {\n\tvar o = {};\n\tvar a = blob.read_shift(4), b = blob.read_shift(4);\n\tvar c = blob.read_shift(4), d = blob.read_shift(2);\n\to.patternType = XLSFillPattern[c >> 26];\n\n\tif(!opts.cellStyles) return o;\n\to.alc = a & 0x07;\n\to.fWrap = (a >> 3) & 0x01;\n\to.alcV = (a >> 4) & 0x07;\n\to.fJustLast = (a >> 7) & 0x01;\n\to.trot = (a >> 8) & 0xFF;\n\to.cIndent = (a >> 16) & 0x0F;\n\to.fShrinkToFit = (a >> 20) & 0x01;\n\to.iReadOrder = (a >> 22) & 0x02;\n\to.fAtrNum = (a >> 26) & 0x01;\n\to.fAtrFnt = (a >> 27) & 0x01;\n\to.fAtrAlc = (a >> 28) & 0x01;\n\to.fAtrBdr = (a >> 29) & 0x01;\n\to.fAtrPat = (a >> 30) & 0x01;\n\to.fAtrProt = (a >> 31) & 0x01;\n\n\to.dgLeft = b & 0x0F;\n\to.dgRight = (b >> 4) & 0x0F;\n\to.dgTop = (b >> 8) & 0x0F;\n\to.dgBottom = (b >> 12) & 0x0F;\n\to.icvLeft = (b >> 16) & 0x7F;\n\to.icvRight = (b >> 23) & 0x7F;\n\to.grbitDiag = (b >> 30) & 0x03;\n\n\to.icvTop = c & 0x7F;\n\to.icvBottom = (c >> 7) & 0x7F;\n\to.icvDiag = (c >> 14) & 0x7F;\n\to.dgDiag = (c >> 21) & 0x0F;\n\n\to.icvFore = d & 0x7F;\n\to.icvBack = (d >> 7) & 0x7F;\n\to.fsxButton = (d >> 14) & 0x01;\n\treturn o;\n}\n//function parse_CellXF(blob, length, opts) {return parse_CellStyleXF(blob,length,0, opts);}\n//function parse_StyleXF(blob, length, opts) {return parse_CellStyleXF(blob,length,1, opts);}\n\n/* [MS-XLS] 2.4.353 TODO: actually do this right */\nfunction parse_XF(blob, length, opts) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(2); o.numFmtId = blob.read_shift(2); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\tlength -= 6;\n\to.data = parse_CellStyleXF(blob, length, o.fStyle, opts);\n\treturn o;\n}\nfunction write_XF(data, ixfeP, opts, o) {\n\tvar b5 = (opts && (opts.biff == 5));\n\tif(!o) o = new_buf(b5 ? 16 : 20);\n\to.write_shift(2, 0);\n\tif(data.style) {\n\t\to.write_shift(2, (data.numFmtId||0));\n\t\to.write_shift(2, 0xFFF4);\n\t} else {\n\t\to.write_shift(2, (data.numFmtId||0));\n\t\to.write_shift(2, (ixfeP<<4));\n\t}\n\tvar f = 0;\n\tif(data.numFmtId > 0 && b5) f |= 0x0400;\n\to.write_shift(4, f);\n\to.write_shift(4, 0);\n\tif(!b5) o.write_shift(4, 0);\n\to.write_shift(2, 0);\n\treturn o;\n}\nfunction parse_BIFF2XF(blob/*::, length, opts*/) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(1); blob.l++; o.flags = blob.read_shift(1);\n\to.numFmtId = o.flags & 0x3F; o.flags>>=6;\n\to.fStyle = 0;\n\to.data = {}; // TODO\n\treturn o;\n}\nfunction write_BIFF2XF(xf) {\n\tvar o = new_buf(4);\n\to.l+=2;\n\to.write_shift(1, xf.numFmtId);\n\to.l++;\n\treturn o;\n}\nfunction write_BIFF3XF(xf) {\n\tvar o = new_buf(12);\n\to.l++;\n\to.write_shift(1, xf.numFmtId);\n\to.l += 10;\n\treturn o;\n}\n/* TODO: check other fields */\nvar write_BIFF4XF = write_BIFF3XF;\nfunction parse_BIFF3XF(blob/*::, length, opts*/) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(1); o.numFmtId = blob.read_shift(1); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\to.data = {}; // TODO\n\treturn o;\n}\nfunction parse_BIFF4XF(blob/*::, length, opts*/) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(1); o.numFmtId = blob.read_shift(1); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\to.data = {}; // TODO\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.134 */\nfunction parse_Guts(blob) {\n\tblob.l += 4;\n\tvar out = [blob.read_shift(2), blob.read_shift(2)];\n\tif(out[0] !== 0) out[0]--;\n\tif(out[1] !== 0) out[1]--;\n\tif(out[0] > 7 || out[1] > 7) throw new Error(\"Bad Gutters: \" + out.join(\"|\"));\n\treturn out;\n}\nfunction write_Guts(guts/*:Array<number>*/) {\n\tvar o = new_buf(8);\n\to.write_shift(4, 0);\n\to.write_shift(2, guts[0] ? guts[0] + 1 : 0);\n\to.write_shift(2, guts[1] ? guts[1] + 1 : 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.24 */\nfunction parse_BoolErr(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tvar val = parse_Bes(blob, 2);\n\tcell.val = val;\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\n\treturn cell;\n}\nfunction write_BoolErr(R/*:number*/, C/*:number*/, v, os/*:number*/, opts, t/*:string*/) {\n\tvar o = new_buf(8);\n\twrite_XLSCell(R, C, os, o);\n\twrite_Bes(v, t, o);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.180 Number */\nfunction parse_Number(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 2) opts.biff = 5;\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tvar xnum = parse_Xnum(blob, 8);\n\tcell.val = xnum;\n\treturn cell;\n}\nfunction write_Number(R/*:number*/, C/*:number*/, v, os/*:: :number, opts*/) {\n\tvar o = new_buf(14);\n\twrite_XLSCell(R, C, os, o);\n\twrite_Xnum(v, o);\n\treturn o;\n}\n\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n/* [MS-XLS] 2.4.271 */\nfunction parse_SupBook(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar ctab = blob.read_shift(2);\n\tvar cch = blob.read_shift(2);\n\topts.sbcch = cch;\n\tif(cch == 0x0401 || cch == 0x3A01) return [cch, ctab];\n\tif(cch < 0x01 || cch >0xff) throw new Error(\"Unexpected SupBook type: \"+cch);\n\tvar virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n\t/* TODO: 2.5.277 Virtual Path */\n\tvar rgst = [];\n\twhile(end > blob.l) rgst.push(parse_XLUnicodeString(blob));\n\treturn [cch, ctab, virtPath, rgst];\n}\n\n/* [MS-XLS] 2.4.105 TODO */\nfunction parse_ExternName(blob, length, opts) {\n\tvar flags = blob.read_shift(2);\n\tvar body;\n\tvar o = ({\n\t\tfBuiltIn: flags & 0x01,\n\t\tfWantAdvise: (flags >>> 1) & 0x01,\n\t\tfWantPict: (flags >>> 2) & 0x01,\n\t\tfOle: (flags >>> 3) & 0x01,\n\t\tfOleLink: (flags >>> 4) & 0x01,\n\t\tcf: (flags >>> 5) & 0x3FF,\n\t\tfIcon: flags >>> 15 & 0x01\n\t}/*:any*/);\n\tif(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2, opts);\n\t//else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\to.body = body || blob.read_shift(length-2);\n\tif(typeof body === \"string\") o.Name = body;\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.150 TODO */\nfunction parse_Lbl(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar flags = blob.read_shift(2);\n\tvar chKey = blob.read_shift(1);\n\tvar cch = blob.read_shift(1);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar itab = 0;\n\tif(!opts || opts.biff >= 5) {\n\t\tif(opts.biff != 5) blob.l += 2;\n\t\titab = blob.read_shift(2);\n\t\tif(opts.biff == 5) blob.l += 2;\n\t\tblob.l += 4;\n\t}\n\tvar name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tif(flags & 0x20) name = XLSLblBuiltIn[name.charCodeAt(0)];\n\tvar npflen = target - blob.l; if(opts && opts.biff == 2) --npflen;\n\t/*jshint -W018 */\n\tvar rgce = (target == blob.l || cce === 0 || !(npflen > 0)) ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n\t/*jshint +W018 */\n\treturn {\n\t\tchKey: chKey,\n\t\tName: name,\n\t\titab: itab,\n\t\trgce: rgce\n\t};\n}\n\n/* [MS-XLS] 2.4.106 TODO: legacy record filename encoding */\nfunction parse_ExternSheet(blob, length, opts) {\n\tif(opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);\n\t/* see issue 2907 */\n\tif(!(opts.biff > 8) && (length == blob[blob.l] + (blob[blob.l+1] == 0x03 ? 1 : 0) + 1)) return parse_BIFF5ExternSheet(blob, length, opts);\n\tvar o = [], target = blob.l + length, len = blob.read_shift(opts.biff > 8 ? 4 : 2);\n\twhile(len-- !== 0) o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts));\n\t\t// [iSupBook, itabFirst, itabLast];\n\tif(blob.l != target) throw new Error(\"Bad ExternSheet: \" + blob.l + \" != \" + target);\n\treturn o;\n}\nfunction parse_BIFF5ExternSheet(blob, length, opts) {\n\tif(blob[blob.l + 1] == 0x03) blob[blob.l]++;\n\tvar o = parse_ShortXLUnicodeString(blob, length, opts);\n\treturn o.charCodeAt(0) == 0x03 ? o.slice(1) : o;\n}\n\n/* [MS-XLS] 2.4.176 TODO: check older biff */\nfunction parse_NameCmt(blob, length, opts) {\n\tif(opts.biff < 8) { blob.l += length; return; }\n\tvar cchName = blob.read_shift(2);\n\tvar cchComment = blob.read_shift(2);\n\tvar name = parse_XLUnicodeStringNoCch(blob, cchName, opts);\n\tvar comment = parse_XLUnicodeStringNoCch(blob, cchComment, opts);\n\treturn [name, comment];\n}\n\n/* [MS-XLS] 2.4.260 */\nfunction parse_ShrFmla(blob, length, opts) {\n\tvar ref = parse_RefU(blob, 6);\n\tblob.l++;\n\tvar cUse = blob.read_shift(1);\n\tlength -= 8;\n\treturn [parse_SharedParsedFormula(blob, length, opts), cUse, ref];\n}\n\n/* [MS-XLS] 2.4.4 TODO */\nfunction parse_Array(blob, length, opts) {\n\tvar ref = parse_Ref(blob, 6);\n\t/* TODO: fAlwaysCalc */\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l ++; length -= 7; break;\n\t\tcase 3: case 4: blob.l += 2; length -= 8; break;\n\t\tdefault: blob.l += 6; length -= 12;\n\t}\n\treturn [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n}\n\n/* [MS-XLS] 2.4.173 */\nfunction parse_MTRSettings(blob) {\n\tvar fMTREnabled = blob.read_shift(4) !== 0x00;\n\tvar fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n\tvar cUserThreadCount = blob.read_shift(4);\n\treturn [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n}\n\n/* [MS-XLS] 2.5.186 */\nfunction parse_NoteSh(blob, length, opts) {\n\tvar row = blob.read_shift(2), col = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), idObj = blob.read_shift(2);\n\tvar stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n\treturn [{r:row,c:col}, stAuthor, idObj, flags];\n}\n\n/* [MS-XLS] 2.4.179 */\nfunction parse_Note(blob, length, opts) {\n\tif(opts && (opts.biff < 8)) {\n\t\tvar row = blob.read_shift(2), col = blob.read_shift(2);\n\t\tif(row == 0xFFFF || row == -1) return; // TODO: test continuation\n\t\tvar cch = blob.read_shift(2);\n\t\tvar cmnt = blob.read_shift(Math.min(cch,2048), 'cpstr');\n\t\treturn [{r:row, c:col}, cmnt];\n\t}\n\t/* TODO: Support revisions */\n\treturn parse_NoteSh(blob, length, opts);\n}\nfunction write_NOTE_BIFF2(text/*:string*/, R/*:number*/, C/*:number*/, len/*?:number*/) {\n\tvar o = new_buf(6 + (len || text.length));\n\to.write_shift(2, R);\n\to.write_shift(2, C);\n\to.write_shift(2, len || text.length);\n\to.write_shift(text.length, text, \"sbcs\");\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.168 */\nfunction parse_MergeCells(blob, length)/*:Array<Range>*/ {\n\tvar merges/*:Array<Range>*/ = [];\n\tvar cmcs = blob.read_shift(2);\n\twhile (cmcs--) merges.push(parse_Ref8U(blob,length));\n\treturn merges;\n}\nfunction write_MergeCells(merges/*:Array<Range>*/) {\n\tvar o = new_buf(2 + merges.length * 8);\n\to.write_shift(2, merges.length);\n\tfor(var i = 0; i < merges.length; ++i) write_Ref8U(merges[i], o);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.181 TODO: parse all the things! */\nfunction parse_Obj(blob, length, opts) {\n\tif(opts && opts.biff < 8) return parse_BIFF5Obj(blob, length, opts);\n\tvar cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\tvar fts = parse_FtArray(blob, length-22, cmo[1]);\n\treturn { cmo: cmo, ft:fts };\n}\n/* from older spec */\nvar parse_BIFF5OT = {\n0x08: function(blob, length) {\n\tvar tgt = blob.l + length;\n\tblob.l += 10; // todo\n\tvar cf = blob.read_shift(2);\n\tblob.l += 4;\n\tblob.l += 2; //var cbPictFmla = blob.read_shift(2);\n\tblob.l += 2;\n\tblob.l += 2; //var grbit = blob.read_shift(2);\n\tblob.l += 4;\n\tvar cchName = blob.read_shift(1);\n\tblob.l += cchName; // TODO: stName\n\tblob.l = tgt; // TODO: fmla\n\treturn { fmt:cf };\n}\n};\n\nfunction parse_BIFF5Obj(blob, length, opts) {\n\tblob.l += 4; //var cnt = blob.read_shift(4);\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar grbit = blob.read_shift(2);\n\tblob.l += 2; //var colL = blob.read_shift(2);\n\tblob.l += 2; //var dxL = blob.read_shift(2);\n\tblob.l += 2; //var rwT = blob.read_shift(2);\n\tblob.l += 2; //var dyT = blob.read_shift(2);\n\tblob.l += 2; //var colR = blob.read_shift(2);\n\tblob.l += 2; //var dxR = blob.read_shift(2);\n\tblob.l += 2; //var rwB = blob.read_shift(2);\n\tblob.l += 2; //var dyB = blob.read_shift(2);\n\tblob.l += 2; //var cbMacro = blob.read_shift(2);\n\tblob.l += 6;\n\tlength -= 36;\n\tvar fts = [];\n\tfts.push((parse_BIFF5OT[ot]||parsenoop)(blob, length, opts));\n\treturn { cmo: [id, ot, grbit], ft:fts };\n}\n\n/* [MS-XLS] 2.4.329 TODO: parse properly */\nfunction parse_TxO(blob, length, opts) {\n\tvar s = blob.l;\n\tvar texts = \"\";\ntry {\n\tblob.l += 4;\n\tvar ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];\n\tvar controlInfo; // eslint-disable-line no-unused-vars\n\tif([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;\n\telse controlInfo = parse_ControlInfo(blob, 6, opts); // eslint-disable-line no-unused-vars\n\tvar cchText = blob.read_shift(2);\n\t/*var cbRuns = */blob.read_shift(2);\n\t/*var ifntEmpty = */parseuint16(blob, 2);\n\tvar len = blob.read_shift(2);\n\tblob.l += len;\n\t//var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n\tfor(var i = 1; i < blob.lens.length-1; ++i) {\n\t\tif(blob.l-s != blob.lens[i]) throw new Error(\"TxO: bad continue record\");\n\t\tvar hdr = blob[blob.l];\n\t\tvar t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);\n\t\ttexts += t;\n\t\tif(texts.length >= (hdr ? cchText : 2*cchText)) break;\n\t}\n\tif(texts.length !== cchText && texts.length !== cchText*2) {\n\t\tthrow new Error(\"cchText: \" + cchText + \" != \" + texts.length);\n\t}\n\n\tblob.l = s + length;\n\t/* [MS-XLS] 2.5.272 TxORuns */\n//\tvar rgTxoRuns = [];\n//\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n//\tvar cchText2 = blob.read_shift(2);\n//\tif(cchText2 !== cchText) throw new Error(\"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText);\n//\tblob.l += 6;\n//\tif(s + length != blob.l) throw new Error(\"TxO \" + (s + length) + \", at \" + blob.l);\n\treturn { t: texts };\n} catch(e) { blob.l = s + length; return { t: texts }; }\n}\n\n/* [MS-XLS] 2.4.140 */\nfunction parse_HLink(blob, length) {\n\tvar ref = parse_Ref8U(blob, 8);\n\tblob.l += 16; /* CLSID */\n\tvar hlink = parse_Hyperlink(blob, length-24);\n\treturn [ref, hlink];\n}\nfunction write_HLink(hl) {\n\tvar O = new_buf(24);\n\tvar ref = decode_cell(hl[0]);\n\tO.write_shift(2, ref.r); O.write_shift(2, ref.r);\n\tO.write_shift(2, ref.c); O.write_shift(2, ref.c);\n\tvar clsid = \"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\tfor(var i = 0; i < 16; ++i) O.write_shift(1, parseInt(clsid[i], 16));\n\treturn bconcat([O, write_Hyperlink(hl[1])]);\n}\n\n\n/* [MS-XLS] 2.4.141 */\nfunction parse_HLinkTooltip(blob, length) {\n\tblob.read_shift(2);\n\tvar ref = parse_Ref8U(blob, 8);\n\tvar wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');\n\twzTooltip = wzTooltip.replace(chr0,\"\");\n\treturn [ref, wzTooltip];\n}\nfunction write_HLinkTooltip(hl) {\n\tvar TT = hl[1].Tooltip;\n\tvar O = new_buf(10 + 2 * (TT.length + 1));\n\tO.write_shift(2, 0x0800);\n\tvar ref = decode_cell(hl[0]);\n\tO.write_shift(2, ref.r); O.write_shift(2, ref.r);\n\tO.write_shift(2, ref.c); O.write_shift(2, ref.c);\n\tfor(var i = 0; i < TT.length; ++i) O.write_shift(2, TT.charCodeAt(i));\n\tO.write_shift(2, 0);\n\treturn O;\n}\n\n/* [MS-XLS] 2.4.63 */\nfunction parse_Country(blob)/*:[string|number, string|number]*/ {\n\tvar o = [0,0], d;\n\td = blob.read_shift(2); o[0] = CountryEnum[d] || d;\n\td = blob.read_shift(2); o[1] = CountryEnum[d] || d;\n\treturn o;\n}\nfunction write_Country(o) {\n\tif(!o) o = new_buf(4);\n\to.write_shift(2, 0x01);\n\to.write_shift(2, 0x01);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.50 ClrtClient */\nfunction parse_ClrtClient(blob) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.188 */\nfunction parse_Palette(blob) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.354 */\nfunction parse_XFCRC(blob) {\n\tblob.l += 2;\n\tvar o = {cxfs:0, crc:0};\n\to.cxfs = blob.read_shift(2);\n\to.crc = blob.read_shift(4);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.53 TODO: parse flags */\n/* [MS-XLSB] 2.4.323 TODO: parse flags */\nfunction parse_ColInfo(blob, length, opts) {\n\tif(!opts.cellStyles) return parsenoop(blob, length);\n\tvar w = opts && opts.biff >= 12 ? 4 : 2;\n\tvar colFirst = blob.read_shift(w);\n\tvar colLast = blob.read_shift(w);\n\tvar coldx = blob.read_shift(w);\n\tvar ixfe = blob.read_shift(w);\n\tvar flags = blob.read_shift(2);\n\tif(w == 2) blob.l += 2;\n\tvar o = ({s:colFirst, e:colLast, w:coldx, ixfe:ixfe, flags:flags}/*:any*/);\n\tif(opts.biff >= 5 || !opts.biff) o.level = (flags >> 8) & 0x7;\n\treturn o;\n}\nfunction write_ColInfo(col, idx) {\n\tvar o = new_buf(12);\n\to.write_shift(2, idx);\n\to.write_shift(2, idx);\n\to.write_shift(2, col.width * 256);\n\to.write_shift(2, 0);\n\tvar f = 0;\n\tif(col.hidden) f |= 1;\n\to.write_shift(1, f);\n\tf = col.level || 0;\n\to.write_shift(1, f);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.257 */\nfunction parse_Setup(blob, length) {\n\tvar o = {};\n\tif(length < 32) return o;\n\tblob.l += 16;\n\to.header = parse_Xnum(blob, 8);\n\to.footer = parse_Xnum(blob, 8);\n\tblob.l += 2;\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.261 */\nfunction parse_ShtProps(blob, length, opts) {\n\tvar def = {area:false};\n\tif(opts.biff != 5) { blob.l += length; return def; }\n\tvar d = blob.read_shift(1); blob.l += 3;\n\tif((d & 0x10)) def.area = true;\n\treturn def;\n}\n\n/* [MS-XLS] 2.4.241 */\nfunction write_RRTabId(n/*:number*/) {\n\tvar out = new_buf(2 * n);\n\tfor(var i = 0; i < n; ++i) out.write_shift(2, i+1);\n\treturn out;\n}\n\nvar parse_Blank = parse_XLSCell; /* [MS-XLS] 2.4.20 Just the cell */\nvar parse_Scl = parseuint16a; /* [MS-XLS] 2.4.247 num, den */\nvar parse_String = parse_XLUnicodeString; /* [MS-XLS] 2.4.268 */\n\n/* --- Specific to versions before BIFF8 --- */\nfunction parse_ImData(blob) {\n\tvar cf = blob.read_shift(2);\n\tvar env = blob.read_shift(2);\n\tvar lcb = blob.read_shift(4);\n\tvar o = {fmt:cf, env:env, len:lcb, data:blob.slice(blob.l,blob.l+lcb)};\n\tblob.l += lcb;\n\treturn o;\n}\n\nfunction write_BIFF2Cell(out, r/*:number*/, c/*:number*/, ixfe/*:number*/, ifmt/*:number*/) {\n\tif(!out) out = new_buf(7);\n\tout.write_shift(2, r);\n\tout.write_shift(2, c);\n\tout.write_shift(1, ixfe||0/* & 0x3F */);\n\tout.write_shift(1, ifmt||0/* & 0x3F */);\n\tout.write_shift(1, 0);\n\treturn out;\n}\n\n/* BIFF2_??? where ??? is the name from [XLS] */\nfunction parse_BIFF2STR(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 5) opts.biff = 2;\n\tvar cell = parse_XLSCell(blob, 7, opts);\n\tvar str = parse_XLUnicodeString2(blob, length-7, opts);\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n\nfunction parse_BIFF2NUM(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 7, opts);\n\tvar num = parse_Xnum(blob, 8);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\nfunction write_BIFF2NUM(r/*:number*/, c/*:number*/, val/*:number*/, ixfe, ifmt) {\n\tvar out = new_buf(15);\n\twrite_BIFF2Cell(out, r, c, ixfe||0, ifmt||0);\n\tout.write_shift(8, val, 'f');\n\treturn out;\n}\n\nfunction parse_BIFF2INT(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 7, opts);\n\tvar num = blob.read_shift(2);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\nfunction write_BIFF2INT(r/*:number*/, c/*:number*/, val/*:number*/, ixfe/*:number*/, ifmt/*:number*/) {\n\tvar out = new_buf(9);\n\twrite_BIFF2Cell(out, r, c, ixfe||0, ifmt||0);\n\tout.write_shift(2, val);\n\treturn out;\n}\n\nfunction parse_BIFF2STRING(blob) {\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, 'sbcs-cont');\n}\n\nfunction parse_BIFF2BOOLERR(blob, length, opts) {\n\tvar bestart = blob.l + 7;\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tblob.l = bestart;\n\tvar val = parse_Bes(blob, 2);\n\tcell.val = val;\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\n\treturn cell;\n}\n\n/* TODO: convert to BIFF8 font struct */\nfunction parse_BIFF2FONTXTRA(blob, length) {\n\tblob.l += 6; // unknown\n\tblob.l += 2; // font weight \"bls\"\n\tblob.l += 1; // charset\n\tblob.l += 3; // unknown\n\tblob.l += 1; // font family\n\tblob.l += length - 13;\n}\n\n/* TODO: parse rich text runs */\nfunction parse_RString(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tvar cch = blob.read_shift(2);\n\tvar str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tblob.l = end;\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n\nfunction parse_BIFF4SheetInfo(blob/*::, length, opts*/) {\n\tvar flags = blob.read_shift(4);\n\tvar cch = blob.read_shift(1), name = blob.read_shift(cch, \"sbcs\");\n\tif(name.length === 0) name = \"Sheet1\";\n\treturn { flags: flags, name:name };\n}var DBF_SUPPORTED_VERSIONS = [0x02, 0x03, 0x30, 0x31, 0x83, 0x8B, 0x8C, 0xF5];\nvar DBF = /*#__PURE__*/(function() {\nvar dbf_codepage_map = {\n\t/* Code Pages Supported by Visual FoxPro */\n\t0x01:   437,           0x02:   850,\n\t0x03:  1252,           0x04: 10000,\n\t0x64:   852,           0x65:   866,\n\t0x66:   865,           0x67:   861,\n\t0x68:   895,           0x69:   620,\n\t0x6A:   737,           0x6B:   857,\n\t0x78:   950,           0x79:   949,\n\t0x7A:   936,           0x7B:   932,\n\t0x7C:   874,           0x7D:  1255,\n\t0x7E:  1256,           0x96: 10007,\n\t0x97: 10029,           0x98: 10006,\n\t0xC8:  1250,           0xC9:  1251,\n\t0xCA:  1254,           0xCB:  1253,\n\n\t/* shapefile DBF extension */\n\t0x00: 20127,           0x08:   865,\n\t0x09:   437,           0x0A:   850,\n\t0x0B:   437,           0x0D:   437,\n\t0x0E:   850,           0x0F:   437,\n\t0x10:   850,           0x11:   437,\n\t0x12:   850,           0x13:   932,\n\t0x14:   850,           0x15:   437,\n\t0x16:   850,           0x17:   865,\n\t0x18:   437,           0x19:   437,\n\t0x1A:   850,           0x1B:   437,\n\t0x1C:   863,           0x1D:   850,\n\t0x1F:   852,           0x22:   852,\n\t0x23:   852,           0x24:   860,\n\t0x25:   850,           0x26:   866,\n\t0x37:   850,           0x40:   852,\n\t0x4D:   936,           0x4E:   949,\n\t0x4F:   950,           0x50:   874,\n\t0x57:  1252,           0x58:  1252,\n\t0x59:  1252,           0x6C:   863,\n\t0x86:   737,           0x87:   852,\n\t0x88:   857,           0xCC:  1257,\n\n\t0xFF: 16969\n};\nvar dbf_reverse_map = evert({\n\t0x01:   437,           0x02:   850,\n\t0x03:  1252,           0x04: 10000,\n\t0x64:   852,           0x65:   866,\n\t0x66:   865,           0x67:   861,\n\t0x68:   895,           0x69:   620,\n\t0x6A:   737,           0x6B:   857,\n\t0x78:   950,           0x79:   949,\n\t0x7A:   936,           0x7B:   932,\n\t0x7C:   874,           0x7D:  1255,\n\t0x7E:  1256,           0x96: 10007,\n\t0x97: 10029,           0x98: 10006,\n\t0xC8:  1250,           0xC9:  1251,\n\t0xCA:  1254,           0xCB:  1253,\n\t0x00: 20127\n});\n/* TODO: find an actual specification */\nfunction dbf_to_aoa(buf, opts)/*:AOA*/ {\n\tvar out/*:AOA*/ = [];\n\tvar d/*:Block*/ = (new_raw_buf(1)/*:any*/);\n\tswitch(opts.type) {\n\t\tcase 'base64': d = s2a(Base64_decode(buf)); break;\n\t\tcase 'binary': d = s2a(buf); break;\n\t\tcase 'buffer':\n\t\tcase 'array': d = buf; break;\n\t}\n\tprep_blob(d, 0);\n\n\t/* header */\n\tvar ft = d.read_shift(1);\n\tvar memo = !!(ft & 0x88);\n\tvar vfp = false, l7 = false;\n\tswitch(ft) {\n\t\tcase 0x02: break; // dBASE II\n\t\tcase 0x03: break; // dBASE III\n\t\tcase 0x30: vfp = true; memo = true; break; // VFP\n\t\tcase 0x31: vfp = true; memo = true; break; // VFP with autoincrement\n\t\t// 0x43 dBASE IV SQL table files\n\t\t// 0x63 dBASE IV SQL system files\n\t\tcase 0x83: break; // dBASE III with memo\n\t\tcase 0x8B: break; // dBASE IV with memo\n\t\tcase 0x8C: l7 = true; break; // dBASE Level 7 with memo\n\t\t// case 0xCB dBASE IV SQL table files with memo\n\t\tcase 0xF5: break; // FoxPro 2.x with memo\n\t\t// case 0xFB FoxBASE\n\t\tdefault: throw new Error(\"DBF Unsupported Version: \" + ft.toString(16));\n\t}\n\n\tvar nrow = 0, fpos = 0x0209;\n\tif(ft == 0x02) nrow = d.read_shift(2);\n\td.l += 3; // dBASE II stores DDMMYY date, others use YYMMDD\n\tif(ft != 0x02) nrow = d.read_shift(4);\n\tif(nrow > 1048576) nrow = 1e6;\n\n\tif(ft != 0x02) fpos = d.read_shift(2); // header length\n\tvar rlen = d.read_shift(2); // record length\n\n\tvar /*flags = 0,*/ current_cp = opts.codepage || 1252;\n\tif(ft != 0x02) { // 20 reserved bytes\n\t\td.l+=16;\n\t\t/*flags = */d.read_shift(1);\n\t\t//if(memo && ((flags & 0x02) === 0)) throw new Error(\"DBF Flags \" + flags.toString(16) + \" ft \" + ft.toString(16));\n\n\t\t/* codepage present in FoxPro and dBASE Level 7 */\n\t\tif(d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];\n\t\td.l+=1;\n\n\t\td.l+=2;\n\t}\n\tif(l7) d.l += 36; // Level 7: 32 byte \"Language driver name\", 4 byte reserved\n\n/*:: type DBFField = { name:string; len:number; type:string; } */\n\tvar fields/*:Array<DBFField>*/ = [], field/*:DBFField*/ = ({}/*:any*/);\n\tvar hend = Math.min(d.length, (ft == 0x02 ? 0x209 : (fpos - 10 - (vfp ? 264 : 0))));\n\tvar ww = l7 ? 32 : 11;\n\twhile(d.l < hend && d[d.l] != 0x0d) {\n\t\tfield = ({}/*:any*/);\n\t\tfield.name = (typeof $cptable !== \"undefined\" ? $cptable.utils.decode(current_cp, d.slice(d.l, d.l+ww)) : a2s(d.slice(d.l, d.l + ww))).replace(/[\\u0000\\r\\n][\\S\\s]*$/g,\"\");\n\t\td.l += ww;\n\t\tfield.type = String.fromCharCode(d.read_shift(1));\n\t\tif(ft != 0x02 && !l7) field.offset = d.read_shift(4);\n\t\tfield.len = d.read_shift(1);\n\t\tif(ft == 0x02) field.offset = d.read_shift(2);\n\t\tfield.dec = d.read_shift(1);\n\t\tif(field.name.length) fields.push(field);\n\t\tif(ft != 0x02) d.l += l7 ? 13 : 14;\n\t\tswitch(field.type) {\n\t\t\tcase 'B': // Double (VFP) / Binary (dBASE L7)\n\t\t\t\tif((!vfp || field.len != 8) && opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n\t\t\t\tbreak;\n\t\t\tcase 'G': // General (FoxPro and dBASE L7)\n\t\t\tcase 'P': // Picture (FoxPro and dBASE L7)\n\t\t\t\tif(opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n\t\t\t\tbreak;\n\t\t\tcase '+': // Autoincrement (dBASE L7 only)\n\t\t\tcase '0': // _NullFlags (VFP only)\n\t\t\tcase '@': // Timestamp (dBASE L7 only)\n\t\t\tcase 'C': // Character (dBASE II)\n\t\t\tcase 'D': // Date (dBASE III)\n\t\t\tcase 'F': // Float (dBASE IV)\n\t\t\tcase 'I': // Long (VFP and dBASE L7)\n\t\t\tcase 'L': // Logical (dBASE II)\n\t\t\tcase 'M': // Memo (dBASE III)\n\t\t\tcase 'N': // Number (dBASE II)\n\t\t\tcase 'O': // Double (dBASE L7 only)\n\t\t\tcase 'T': // Datetime (VFP only)\n\t\t\tcase 'Y': // Currency (VFP only)\n\t\t\t\tbreak;\n\t\t\tdefault: throw new Error('Unknown Field Type: ' + field.type);\n\t\t}\n\t}\n\n\tif(d[d.l] !== 0x0D) d.l = fpos-1;\n\tif(d.read_shift(1) !== 0x0D) throw new Error(\"DBF Terminator not found \" + d.l + \" \" + d[d.l]);\n\td.l = fpos;\n\n\t/* data */\n\tvar R = 0, C = 0;\n\tout[0] = [];\n\tfor(C = 0; C != fields.length; ++C) out[0][C] = fields[C].name;\n\twhile(nrow-- > 0) {\n\t\tif(d[d.l] === 0x2A) {\n\t\t\t// TODO: record marked as deleted -- create a hidden row?\n\t\t\td.l+=rlen;\n\t\t\tcontinue;\n\t\t}\n\t\t++d.l;\n\t\tout[++R] = []; C = 0;\n\t\tfor(C = 0; C != fields.length; ++C) {\n\t\t\tvar dd = d.slice(d.l, d.l+fields[C].len); d.l+=fields[C].len;\n\t\t\tprep_blob(dd, 0);\n\t\t\tvar s = typeof $cptable !== \"undefined\" ? $cptable.utils.decode(current_cp, dd) : a2s(dd);\n\t\t\tswitch(fields[C].type) {\n\t\t\t\tcase 'C':\n\t\t\t\t\t// NOTE: it is conventional to write '  /  /  ' for empty dates\n\t\t\t\t\tif(s.trim().length) out[R][C] = s.replace(/([^\\s])\\s+$/,\"$1\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tif(s.length === 8) {\n\t\t\t\t\t\tout[R][C] = new Date(Date.UTC(+s.slice(0,4), +s.slice(4,6)-1, +s.slice(6,8), 0, 0, 0, 0));\n\t\t\t\t\t\tif(!(opts && opts.UTC)) { out[R][C] = utc_to_local(out[R][C]); }\n\t\t\t\t\t}\n\t\t\t\t\telse out[R][C] = s;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'F': out[R][C] = parseFloat(s.trim()); break;\n\t\t\t\tcase '+': case 'I': out[R][C] = l7 ? dd.read_shift(-4, 'i') ^ 0x80000000 : dd.read_shift(4, 'i'); break;\n\t\t\t\tcase 'L': switch(s.trim().toUpperCase()) {\n\t\t\t\t\tcase 'Y': case 'T': out[R][C] = true; break;\n\t\t\t\t\tcase 'N': case 'F': out[R][C] = false; break;\n\t\t\t\t\tcase '': case '\\x00': case '?': break;\n\t\t\t\t\tdefault: throw new Error(\"DBF Unrecognized L:|\" + s + \"|\");\n\t\t\t\t\t} break;\n\t\t\t\tcase 'M': /* TODO: handle memo files */\n\t\t\t\t\tif(!memo) throw new Error(\"DBF Unexpected MEMO for type \" + ft.toString(16));\n\t\t\t\t\tout[R][C] = \"##MEMO##\" + (l7 ? parseInt(s.trim(), 10): dd.read_shift(4));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'N':\n\t\t\t\t\ts = s.replace(/\\u0000/g,\"\").trim();\n\t\t\t\t\t// NOTE: dBASE II interprets \"  .  \" as 0\n\t\t\t\t\tif(s && s != \".\") out[R][C] = +s || 0; break;\n\t\t\t\tcase '@':\n\t\t\t\t\t// NOTE: dBASE specs appear to be incorrect\n\t\t\t\t\tout[R][C] = new Date(dd.read_shift(-8, 'f') - 0x388317533400);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'T': {\n\t\t\t\t\tvar hi = dd.read_shift(4), lo = dd.read_shift(4);\n\t\t\t\t\tif(hi == 0 && lo == 0) break;\n\t\t\t\t\tout[R][C] = new Date((hi - 0x253D8C) * 0x5265C00 + lo);\n\t\t\t\t\tif(!(opts && opts.UTC)) out[R][C] = utc_to_local(out[R][C]);\n\t\t\t\t} break;\n\t\t\t\tcase 'Y': out[R][C] = dd.read_shift(4,'i')/1e4 + (dd.read_shift(4, 'i')/1e4)*Math.pow(2,32); break;\n\t\t\t\tcase 'O': out[R][C] = -dd.read_shift(-8, 'f'); break;\n\t\t\t\tcase 'B': if(vfp && fields[C].len == 8) { out[R][C] = dd.read_shift(8,'f'); break; }\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 'G': case 'P': dd.l += fields[C].len; break;\n\t\t\t\tcase '0':\n\t\t\t\t\tif(fields[C].name === '_NullFlags') break;\n\t\t\t\t\t/* falls through */\n\t\t\t\tdefault: throw new Error(\"DBF Unsupported data type \" + fields[C].type);\n\t\t\t}\n\t\t}\n\t}\n\tif(ft != 0x02) if(d.l < d.length && d[d.l++] != 0x1A) throw new Error(\"DBF EOF Marker missing \" + (d.l-1) + \" of \" + d.length + \" \" + d[d.l-1].toString(16));\n\tif(opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);\n\topts.DBF = fields;\n\treturn out;\n}\n\nfunction dbf_to_sheet(buf, opts)/*:Worksheet*/ {\n\tvar o = opts || {};\n\tif(!o.dateNF) o.dateNF = \"yyyymmdd\";\n\tvar ws = aoa_to_sheet(dbf_to_aoa(buf, o), o);\n\tws[\"!cols\"] = o.DBF.map(function(field) { return {\n\t\twch: field.len,\n\t\tDBF: field\n\t};});\n\tdelete o.DBF;\n\treturn ws;\n}\n\nfunction dbf_to_workbook(buf, opts)/*:Workbook*/ {\n\ttry {\n\t\tvar o = sheet_to_workbook(dbf_to_sheet(buf, opts), opts);\n\t\to.bookType = \"dbf\";\n\t\treturn o;\n\t} catch(e) { if(opts && opts.WTF) throw e; }\n\treturn ({SheetNames:[],Sheets:{}});\n}\n\nvar _RLEN = { 'B': 8, 'C': 250, 'L': 1, 'D': 8, '?': 0, '': 0 };\nfunction sheet_to_dbf(ws/*:Worksheet*/, opts/*:WriteOpts*/) {\n\tif(!ws[\"!ref\"]) throw new Error(\"Cannot export empty sheet to DBF\");\n\tvar o = opts || {};\n\tvar old_cp = current_codepage;\n\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\tif(o.type == \"string\") throw new Error(\"Cannot write DBF to JS string\");\n\tvar ba = buf_array();\n\tvar aoa/*:AOA*/ = sheet_to_json(ws, {header:1, raw:true, cellDates:true});\n\tvar headers = aoa[0], data = aoa.slice(1), cols = ws[\"!cols\"] || [];\n\tvar i = 0, j = 0, hcnt = 0, rlen = 1;\n\tfor(i = 0; i < headers.length; ++i) {\n\t\tif(((cols[i]||{}).DBF||{}).name) { headers[i] = cols[i].DBF.name; ++hcnt; continue; }\n\t\tif(headers[i] == null) continue;\n\t\t++hcnt;\n\t\tif(typeof headers[i] === 'number') headers[i] = headers[i].toString(10);\n\t\tif(typeof headers[i] !== 'string') throw new Error(\"DBF Invalid column name \" + headers[i] + \" |\" + (typeof headers[i]) + \"|\");\n\t\tif(headers.indexOf(headers[i]) !== i) for(j=0; j<1024;++j)\n\t\t\tif(headers.indexOf(headers[i] + \"_\" + j) == -1) { headers[i] += \"_\" + j; break; }\n\t}\n\tvar range = safe_decode_range(ws['!ref']);\n\tvar coltypes/*:Array<string>*/ = [];\n\tvar colwidths/*:Array<number>*/ = [];\n\tvar coldecimals/*:Array<number>*/ = [];\n\tfor(i = 0; i <= range.e.c - range.s.c; ++i) {\n\t\tvar guess = '', _guess = '', maxlen = 0;\n\t\tvar col/*:Array<any>*/ = [];\n\t\tfor(j=0; j < data.length; ++j) {\n\t\t\tif(data[j][i] != null) col.push(data[j][i]);\n\t\t}\n\t\tif(col.length == 0 || headers[i] == null) { coltypes[i] = '?'; continue; }\n\t\tfor(j = 0; j < col.length; ++j) {\n\t\t\tswitch(typeof col[j]) {\n\t\t\t\t/* TODO: check if L2 compat is desired */\n\t\t\t\tcase 'number': _guess = 'B'; break;\n\t\t\t\tcase 'string': _guess = 'C'; break;\n\t\t\t\tcase 'boolean': _guess = 'L'; break;\n\t\t\t\tcase 'object': _guess = col[j] instanceof Date ? 'D' : 'C'; break;\n\t\t\t\tdefault: _guess = 'C';\n\t\t\t}\n\t\t\t/* TODO: cache the values instead of encoding twice */\n\t\t\tmaxlen = Math.max(maxlen, (typeof $cptable !== \"undefined\" && typeof col[j] == \"string\" ? $cptable.utils.encode(current_ansi, col[j]): String(col[j])).length);\n\t\t\tguess = guess && guess != _guess ? 'C' : _guess;\n\t\t\t//if(guess == 'C') break;\n\t\t}\n\t\tif(maxlen > 250) maxlen = 250;\n\t\t_guess = ((cols[i]||{}).DBF||{}).type;\n\t\t/* TODO: more fine grained control over DBF type resolution */\n\t\tif(_guess == 'C') {\n\t\t\tif(cols[i].DBF.len > maxlen) maxlen = cols[i].DBF.len;\n\t\t}\n\t\tif(guess == 'B' && _guess == 'N') {\n\t\t\tguess = 'N';\n\t\t\tcoldecimals[i] = cols[i].DBF.dec;\n\t\t\tmaxlen = cols[i].DBF.len;\n\t\t}\n\t\tcolwidths[i] = guess == 'C' || _guess == 'N' ? maxlen : (_RLEN[guess] || 0);\n\t\trlen += colwidths[i];\n\t\tcoltypes[i] = guess;\n\t}\n\n\tvar h = ba.next(32);\n\th.write_shift(4, 0x13021130);\n\th.write_shift(4, data.length);\n\th.write_shift(2, 296 + 32 * hcnt);\n\th.write_shift(2, rlen);\n\tfor(i=0; i < 4; ++i) h.write_shift(4, 0);\n\tvar cp = +dbf_reverse_map[/*::String(*/current_codepage/*::)*/] || 0x03;\n\th.write_shift(4, 0x00000000 | (cp<<8));\n\tif(dbf_codepage_map[cp] != +o.codepage) {\n\t\tif(o.codepage) console.error(\"DBF Unsupported codepage \" + current_codepage + \", using 1252\");\n\t\tcurrent_codepage = 1252;\n\t}\n\n\tfor(i = 0, j = 0; i < headers.length; ++i) {\n\t\tif(headers[i] == null) continue;\n\t\tvar hf = ba.next(32);\n\t\t/* TODO: test how applications handle non-ASCII field names */\n\t\tvar _f = (headers[i].slice(-10) + \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\").slice(0, 11);\n\t\thf.write_shift(1, _f, \"sbcs\");\n\t\thf.write_shift(1, coltypes[i] == '?' ? 'C' : coltypes[i], \"sbcs\");\n\t\thf.write_shift(4, j);\n\t\thf.write_shift(1, colwidths[i] || _RLEN[coltypes[i]] || 0);\n\t\thf.write_shift(1, coldecimals[i] || 0);\n\t\thf.write_shift(1, 0x02);\n\t\thf.write_shift(4, 0);\n\t\thf.write_shift(1, 0);\n\t\thf.write_shift(4, 0);\n\t\thf.write_shift(4, 0);\n\t\tj += (colwidths[i] || _RLEN[coltypes[i]] || 0);\n\t}\n\n\tvar hb = ba.next(264);\n\thb.write_shift(4, 0x0000000D);\n\tfor(i=0; i < 65;++i) hb.write_shift(4, 0x00000000);\n\tfor(i=0; i < data.length; ++i) {\n\t\tvar rout = ba.next(rlen);\n\t\trout.write_shift(1, 0);\n\t\tfor(j=0; j<headers.length; ++j) {\n\t\t\tif(headers[j] == null) continue;\n\t\t\tswitch(coltypes[j]) {\n\t\t\t\tcase 'L': rout.write_shift(1, data[i][j] == null ? 0x3F : data[i][j] ? 0x54 : 0x46); break;\n\t\t\t\tcase 'B': rout.write_shift(8, data[i][j]||0, 'f'); break;\n\t\t\t\tcase 'N':\n\t\t\t\t\tvar _n = \"0\";\n\t\t\t\t\tif(typeof data[i][j] == \"number\") _n = data[i][j].toFixed(coldecimals[j]||0);\n\t\t\t\t\tif(_n.length > colwidths[j]) _n = _n.slice(0, colwidths[j]); // addresses decimal > width\n\t\t\t\t\tfor(hcnt=0; hcnt < colwidths[j]-_n.length; ++hcnt) rout.write_shift(1, 0x20);\n\t\t\t\t\trout.write_shift(1, _n, \"sbcs\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tif(!data[i][j]) rout.write_shift(8, \"00000000\", \"sbcs\");\n\t\t\t\t\telse {\n\t\t\t\t\t\trout.write_shift(4, (\"0000\"+data[i][j].getFullYear()).slice(-4), \"sbcs\");\n\t\t\t\t\t\trout.write_shift(2, (\"00\"+(data[i][j].getMonth()+1)).slice(-2), \"sbcs\");\n\t\t\t\t\t\trout.write_shift(2, (\"00\"+data[i][j].getDate()).slice(-2), \"sbcs\");\n\t\t\t\t\t} break;\n\t\t\t\tcase 'C':\n\t\t\t\t\tvar _l = rout.l;\n\t\t\t\t\tvar _s = String(data[i][j] != null ? data[i][j] : \"\").slice(0, colwidths[j]);\n\t\t\t\t\trout.write_shift(1, _s, \"cpstr\");\n\t\t\t\t\t_l += colwidths[j] - rout.l;\n\t\t\t\t\tfor(hcnt=0; hcnt < _l; ++hcnt) rout.write_shift(1, 0x20); break;\n\t\t\t}\n\t\t}\n\t\t// data\n\t}\n\tcurrent_codepage = old_cp;\n\tba.next(1).write_shift(1, 0x1A);\n\treturn ba.end();\n}\n\treturn {\n\t\tto_workbook: dbf_to_workbook,\n\t\tto_sheet: dbf_to_sheet,\n\t\tfrom_sheet: sheet_to_dbf\n\t};\n})();\n\nvar SYLK = /*#__PURE__*/(function() {\n\t/* TODO: stress test sequences */\n\tvar sylk_escapes = ({\n\t\tAA:'À', BA:'Á', CA:'Â', DA:195, HA:'Ä', JA:197,\n\t\tAE:'È', BE:'É', CE:'Ê',         HE:'Ë',\n\t\tAI:'Ì', BI:'Í', CI:'Î',         HI:'Ï',\n\t\tAO:'Ò', BO:'Ó', CO:'Ô', DO:213, HO:'Ö',\n\t\tAU:'Ù', BU:'Ú', CU:'Û',         HU:'Ü',\n\t\tAa:'à', Ba:'á', Ca:'â', Da:227, Ha:'ä', Ja:229,\n\t\tAe:'è', Be:'é', Ce:'ê',         He:'ë',\n\t\tAi:'ì', Bi:'í', Ci:'î',         Hi:'ï',\n\t\tAo:'ò', Bo:'ó', Co:'ô', Do:245, Ho:'ö',\n\t\tAu:'ù', Bu:'ú', Cu:'û',         Hu:'ü',\n\t\tKC:'Ç', Kc:'ç', q:'æ',  z:'œ',  a:'Æ',  j:'Œ',\n\t\tDN:209, Dn:241, Hy:255,\n\t\tS:169,  c:170,  R:174,  \"B \":180,\n\t\t0:176,  1:177,  2:178,\n\t\t3:179,  5:181,  6:182,\n\t\t7:183,  Q:185,  k:186,  b:208,  i:216,  l:222,  s:240,  y:248,\n\t\t\"!\":161, '\"':162, \"#\":163, \"(\":164, \"%\":165, \"'\":167, \"H \":168,\n\t\t\"+\":171, \";\":187, \"<\":188, \"=\":189, \">\":190, \"?\":191, \"{\":223\n\t}/*:any*/);\n\tvar sylk_char_regex = new RegExp(\"\\u001BN(\" + keys(sylk_escapes).join(\"|\").replace(/\\|\\|\\|/, \"|\\\\||\").replace(/([?()+])/g,\"\\\\$1\").replace(\"{\", \"\\\\{\") + \"|\\\\|)\", \"gm\");\n\ttry {\n\t\tsylk_char_regex = new RegExp(\"\\u001BN(\" + keys(sylk_escapes).join(\"|\").replace(/\\|\\|\\|/, \"|\\\\||\").replace(/([?()+])/g,\"\\\\$1\") + \"|\\\\|)\", \"gm\");\n\t} catch(e) {}\n\tvar sylk_char_fn = function(_, $1){ var o = sylk_escapes[$1]; return typeof o == \"number\" ? _getansi(o) : o; };\n\tvar decode_sylk_char = function($$, $1, $2) { var newcc = (($1.charCodeAt(0) - 0x20)<<4) | ($2.charCodeAt(0) - 0x30); return newcc == 59 ? $$ : _getansi(newcc); };\n\tsylk_escapes[\"|\"] = 254;\n\t/* TODO: evert the escape map */\n\tvar encode_sylk_str = function($$) { return $$.replace(/\\n/g, \"\\x1b :\").replace(/\\r/g, \"\\x1b =\"); };\n\t/* https://oss.sheetjs.com/notes/sylk/ for more details */\n\tfunction sylk_to_aoa(d/*:RawData*/, opts)/*:[AOA, Worksheet]*/ {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return sylk_to_aoa_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return sylk_to_aoa_str(d, opts);\n\t\t\tcase 'buffer': return sylk_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array': return sylk_to_aoa_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\tfunction sylk_to_aoa_str(str/*:string*/, opts)/*:[AOA, Worksheet]*/ {\n\t\tvar records = str.split(/[\\n\\r]+/), R = -1, C = -1, ri = 0, rj = 0, arr/*:AOA*/ = [];\n\t\tvar formats/*:Array<string>*/ = [];\n\t\tvar next_cell_format/*:string|null*/ = null;\n\t\tvar sht = {}, rowinfo/*:Array<RowInfo>*/ = [], colinfo/*:Array<ColInfo>*/ = [], cw/*:Array<string>*/ = [];\n\t\tvar Mval = 0, j;\n\t\tvar wb = { Workbook: { WBProps: {}, Names: [] } };\n\t\tif(+opts.codepage >= 0) set_cp(+opts.codepage);\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tMval = 0;\n\t\t\tvar rstr=records[ri].trim().replace(/\\x1B([\\x20-\\x2F])([\\x30-\\x3F])/g, decode_sylk_char).replace(sylk_char_regex, sylk_char_fn);\n\t\t\tvar record=rstr.replace(/;;/g, \"\\u0000\").split(\";\").map(function(x) { return x.replace(/\\u0000/g, \";\"); });\n\t\t\tvar RT=record[0], val;\n\t\t\tif(rstr.length > 0) switch(RT) {\n\t\t\tcase 'ID': break; /* header */\n\t\t\tcase 'E': break; /* EOF */\n\t\t\tcase 'B': break; /* dimensions */\n\t\t\tcase 'O': /* workbook options */\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'V': {\n\t\t\t\t\tvar d1904 = parseInt(record[rj].slice(1), 10);\n\t\t\t\t\t// NOTE: it is technically an error if d1904 >= 5 or < 0\n\t\t\t\t\tif(d1904 >= 1 && d1904 <= 4) wb.Workbook.WBProps.date1904 = true;\n\t\t\t\t} break;\n\t\t\t} break;\n\t\t\tcase 'W': break; /* window */\n\t\t\tcase 'P':\n\t\t\t\tswitch(record[1].charAt(0)){\n\t\t\t\t\tcase 'P': formats.push(rstr.slice(3).replace(/;;/g, \";\")); break;\n\t\t\t\t} break;\n\t\t\tcase 'NN': { /* defined name */\n\t\t\t\tvar nn = {Sheet: 0};\n\t\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\t\tcase 'N': nn.Name = record[rj].slice(1); break;\n\t\t\t\t\tcase 'E': nn.Ref = (opts && opts.sheet || \"Sheet1\") + \"!\" + rc_to_a1(record[rj].slice(1)); break;\n\t\t\t\t}\n\t\t\t\twb.Workbook.Names.push(nn);\n\t\t\t} break;\n\t\t\t// case 'NE': // ??\n\t\t\t// case 'NU': // ??\n\t\t\tcase 'C': /* cell */\n\t\t\tvar C_seen_K = false, C_seen_X = false, C_seen_S = false, C_seen_E = false, _R = -1, _C = -1, formula = \"\", cell_t = \"z\";\n\t\t\tvar cmnt = \"\";\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'A': cmnt = record[rj].slice(1); break; // TODO: comment\n\t\t\t\tcase 'X': C = parseInt(record[rj].slice(1), 10)-1; C_seen_X = true; break;\n\t\t\t\tcase 'Y':\n\t\t\t\t\tR = parseInt(record[rj].slice(1), 10)-1; if(!C_seen_X) C = 0;\n\t\t\t\t\tfor(j = arr.length; j <= R; ++j) arr[j] = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'K':\n\t\t\t\t\tval = record[rj].slice(1);\n\t\t\t\t\tif(val.charAt(0) === '\"') { val = val.slice(1,val.length - 1); cell_t = \"s\"; }\n\t\t\t\t\telse if(val === 'TRUE' || val === 'FALSE') { val = val === 'TRUE'; cell_t = \"b\"; }\n\t\t\t\t\telse if(val.charAt(0) == \"#\" && RBErr[val] != null) { cell_t = \"e\"; val = RBErr[val]; }\n\t\t\t\t\telse if(!isNaN(fuzzynum(val))) {\n\t\t\t\t\t\tval = fuzzynum(val); cell_t = \"n\";\n\t\t\t\t\t\tif(next_cell_format !== null && fmt_is_date(next_cell_format) && opts.cellDates) {\n\t\t\t\t\t\t\tval = numdate(wb.Workbook.WBProps.date1904 ? val + 1462 : val); cell_t = typeof val == \"number\" ? \"n\" : \"d\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof $cptable !== 'undefined' && typeof val == \"string\" && ((opts||{}).type != \"string\") && (opts||{}).codepage) val = $cptable.utils.decode(opts.codepage, val);\n\t\t\t\t\tC_seen_K = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'E':\n\t\t\t\t\tC_seen_E = true;\n\t\t\t\t\tformula = rc_to_a1(record[rj].slice(1), {r:R,c:C});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'S':\n\t\t\t\t\tC_seen_S = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'G': break; // unknown\n\t\t\t\tcase 'R': _R = parseInt(record[rj].slice(1), 10)-1; break;\n\t\t\t\tcase 'C': _C = parseInt(record[rj].slice(1), 10)-1; break;\n\t\t\t\t// case 'P': // ??\n\t\t\t\t// case 'D': // ??\n\t\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t\tif(C_seen_K) {\n\t\t\t\tif(!arr[R][C]) arr[R][C] = { t: cell_t, v: val };\n\t\t\t\telse { arr[R][C].t = cell_t; arr[R][C].v = val; }\n\t\t\t\tif(next_cell_format) arr[R][C].z = next_cell_format;\n\t\t\t\tif(opts.cellText !== false && next_cell_format) arr[R][C].w = SSF_format(arr[R][C].z, arr[R][C].v, { date1904: wb.Workbook.WBProps.date1904 });\n\t\t\t\tnext_cell_format = null;\n\t\t\t}\n\t\t\tif(C_seen_S) {\n\t\t\t\tif(C_seen_E) throw new Error(\"SYLK shared formula cannot have own formula\");\n\t\t\t\tvar shrbase = _R > -1 && arr[_R][_C];\n\t\t\t\tif(!shrbase || !shrbase[1]) throw new Error(\"SYLK shared formula cannot find base\");\n\t\t\t\tformula = shift_formula_str(shrbase[1], {r: R - _R, c: C - _C});\n\t\t\t}\n\t\t\tif(formula) {\n\t\t\t\tif(!arr[R][C]) arr[R][C] = { t: 'n', f: formula };\n\t\t\t\telse arr[R][C].f = formula;\n\t\t\t}\n\t\t\tif(cmnt) {\n\t\t\t\tif(!arr[R][C]) arr[R][C] = { t: 'z' };\n\t\t\t\tarr[R][C].c = [{a:\"SheetJSYLK\", t: cmnt}];\n\t\t\t}\n\t\t\tbreak;\n\t\t\tcase 'F': /* Format */\n\t\t\tvar F_seen = 0;\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'X': C = parseInt(record[rj].slice(1), 10)-1; ++F_seen; break;\n\t\t\t\tcase 'Y':\n\t\t\t\t\tR = parseInt(record[rj].slice(1), 10)-1; /*C = 0;*/\n\t\t\t\t\tfor(j = arr.length; j <= R; ++j) arr[j] = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'M': Mval = parseInt(record[rj].slice(1), 10) / 20; break;\n\t\t\t\tcase 'F': break; /* ??? */\n\t\t\t\tcase 'G': break; /* hide grid */\n\t\t\t\tcase 'P':\n\t\t\t\t\tnext_cell_format = formats[parseInt(record[rj].slice(1), 10)];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'S': break; /* cell style */\n\t\t\t\tcase 'D': break; /* column */\n\t\t\t\tcase 'N': break; /* font */\n\t\t\t\tcase 'W':\n\t\t\t\t\tcw = record[rj].slice(1).split(\" \");\n\t\t\t\t\tfor(j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {\n\t\t\t\t\t\tMval = parseInt(cw[2], 10);\n\t\t\t\t\t\tcolinfo[j-1] = Mval === 0 ? {hidden:true}: {wch:Mval};\n\t\t\t\t\t} break;\n\t\t\t\tcase 'C': /* default column format */\n\t\t\t\t\tC = parseInt(record[rj].slice(1), 10)-1;\n\t\t\t\t\tif(!colinfo[C]) colinfo[C] = {};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'R': /* row properties */\n\t\t\t\t\tR = parseInt(record[rj].slice(1), 10)-1;\n\t\t\t\t\tif(!rowinfo[R]) rowinfo[R] = {};\n\t\t\t\t\tif(Mval > 0) { rowinfo[R].hpt = Mval; rowinfo[R].hpx = pt2px(Mval); }\n\t\t\t\t\telse if(Mval === 0) rowinfo[R].hidden = true;\n\t\t\t\t\tbreak;\n\t\t\t\t// case 'K': // ??\n\t\t\t\t// case 'E': // ??\n\t\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t\tif(F_seen < 1) next_cell_format = null; break;\n\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t}\n\t\tif(rowinfo.length > 0) sht['!rows'] = rowinfo;\n\t\tif(colinfo.length > 0) sht['!cols'] = colinfo;\n\t\tcolinfo.forEach(function(col) { process_col(col); });\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn [arr, sht, wb];\n\t}\n\n\tfunction sylk_to_workbook(d/*:RawData*/, opts)/*:Workbook*/ {\n\t\tvar aoasht = sylk_to_aoa(d, opts);\n\t\tvar aoa = aoasht[0], ws = aoasht[1], wb = aoasht[2];\n\t\tvar _opts = dup(opts); _opts.date1904 = (((wb||{}).Workbook || {}).WBProps || {}).date1904;\n\t\tvar o = aoa_to_sheet(aoa, _opts);\n\t\tkeys(ws).forEach(function(k) { o[k] = ws[k]; });\n\t\tvar outwb = sheet_to_workbook(o, opts);\n\t\tkeys(wb).forEach(function(k) { outwb[k] = wb[k]; });\n\t\toutwb.bookType = \"sylk\";\n\t\treturn outwb;\n\t}\n\n\tfunction write_ws_cell_sylk(cell/*:Cell*/, ws/*:Worksheet*/, R/*:number*/, C/*:number*/, opts, date1904/*:boolean*/)/*:string*/ {\n\t\tvar o = \"C;Y\" + (R+1) + \";X\" + (C+1) + \";K\";\n\t\tswitch(cell.t) {\n\t\t\tcase 'n':\n\t\t\t\to += isFinite(cell.v) ? (cell.v||0) : BErr[isNaN(cell.v) ? 0x24 : 0x07];\n\t\t\t\tif(cell.f && !cell.F) o += \";E\" + a1_to_rc(cell.f, {r:R, c:C}); break;\n\t\t\tcase 'b': o += cell.v ? \"TRUE\" : \"FALSE\"; break;\n\t\t\tcase 'e': o += cell.w || BErr[cell.v] || cell.v; break;\n\t\t\tcase 'd': o += datenum(parseDate(cell.v, date1904), date1904); break;\n\t\t\tcase 's': o += '\"' + (cell.v == null ? \"\" : String(cell.v)).replace(/\"/g,\"\").replace(/;/g, \";;\") + '\"'; break;\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction write_ws_cmnt_sylk(cmnt/*:Comment*/, R/*:number*/, C/*:number*/)/*:string*/ {\n\t\tvar o = \"C;Y\" + (R+1) + \";X\" + (C+1) + \";A\";\n\t\t/* TODO: max length? */\n\t\to += encode_sylk_str(cmnt.map(function(c) { return c.t; }).join(\"\"));\n\t\treturn o;\n\t}\n\n\tfunction write_ws_cols_sylk(out, cols) {\n\t\tcols.forEach(function(col, i) {\n\t\t\tvar rec = \"F;W\" + (i+1) + \" \" + (i+1) + \" \";\n\t\t\tif(col.hidden) rec += \"0\";\n\t\t\telse {\n\t\t\t\tif(typeof col.width == 'number' && !col.wpx) col.wpx = width2px(col.width);\n\t\t\t\tif(typeof col.wpx == 'number' && !col.wch) col.wch = px2char(col.wpx);\n\t\t\t\tif(typeof col.wch == 'number') rec += Math.round(col.wch);\n\t\t\t}\n\t\t\tif(rec.charAt(rec.length - 1) != \" \") out.push(rec);\n\t\t});\n\t}\n\n\tfunction write_ws_rows_sylk(out/*:Array<string>*/, rows/*:Array<RowInfo>*/) {\n\t\trows.forEach(function(row, i) {\n\t\t\tvar rec = \"F;\";\n\t\t\tif(row.hidden) rec += \"M0;\";\n\t\t\telse if(row.hpt) rec += \"M\" + 20 * row.hpt + \";\";\n\t\t\telse if(row.hpx) rec += \"M\" + 20 * px2pt(row.hpx) + \";\";\n\t\t\tif(rec.length > 2) out.push(rec + \"R\" + (i+1));\n\t\t});\n\t}\n\n\tfunction sheet_to_sylk(ws/*:Worksheet*/, opts/*:?any*/, wb/*:?WorkBook*/)/*:string*/ {\n\t\tif(!opts) opts = {}; opts._formats = [\"General\"];\n\t\t/* TODO: codepage */\n\t\tvar preamble/*:Array<string>*/ = [\"ID;PSheetJS;N;E\"], o/*:Array<string>*/ = [];\n\t\tvar r = safe_decode_range(ws['!ref']||\"A1\"), cell/*:Cell*/;\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tvar RS = \"\\r\\n\";\n\t\tvar d1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\n\t\tvar _lastfmt = \"General\";\n\t\tpreamble.push(\"P;PGeneral\");\n\t\t/* Excel has been inconsistent in comment placement */\n\t\tvar R = r.s.r, C = r.s.c, p = [];\n\t\tif(ws[\"!ref\"]) for(R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tif(dense && !ws[\"!data\"][R]) continue;\n\t\t\tp = [];\n\t\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tcell = dense ? ws[\"!data\"][R][C] : ws[encode_col(C) + encode_row(R)];\n\t\t\t\tif(!cell || !cell.c) continue;\n\t\t\t\tp.push(write_ws_cmnt_sylk(cell.c, R, C));\n\t\t\t}\n\t\t\tif(p.length) o.push(p.join(RS));\n\t\t}\n\t\tif(ws[\"!ref\"]) for(R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tif(dense && !ws[\"!data\"][R]) continue;\n\t\t\tp = [];\n\t\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tcell = dense ? ws[\"!data\"][R][C] : ws[encode_col(C) + encode_row(R)];\n\t\t\t\tif(!cell || (cell.v == null && (!cell.f || cell.F))) continue;\n\t\t\t\tif((cell.z||(cell.t == \"d\" ? table_fmt[14] : \"General\")) != _lastfmt) {\n\t\t\t\t\tvar ifmt = opts._formats.indexOf(cell.z);\n\t\t\t\t\tif(ifmt == -1) { opts._formats.push(cell.z); ifmt = opts._formats.length - 1; preamble.push(\"P;P\" + cell.z.replace(/;/g, \";;\")); }\n\t\t\t\t\tp.push(\"F;P\" + ifmt + \";Y\" + (R+1) + \";X\" + (C+1));\n\t\t\t\t}\n\t\t\t\tp.push(write_ws_cell_sylk(cell, ws, R, C, opts, d1904));\n\t\t\t}\n\t\t\to.push(p.join(RS));\n\t\t}\n\n\t\tpreamble.push(\"F;P0;DG0G8;M255\");\n\t\tif(ws['!cols']) write_ws_cols_sylk(preamble, ws['!cols']);\n\t\tif(ws['!rows']) write_ws_rows_sylk(preamble, ws['!rows']);\n\n\t\tif(ws[\"!ref\"]) preamble.push(\"B;Y\" + (r.e.r - r.s.r + 1) + \";X\" + (r.e.c - r.s.c + 1) + \";D\" + [r.s.c,r.s.r,r.e.c,r.e.r].join(\" \"));\n\t\tpreamble.push(\"O;L;D;B\" + (d1904 ? \";V4\" : \"\") + \";K47;G100 0.001\");\n\n\t\tdelete opts._formats;\n\t\treturn preamble.join(RS) + RS + o.join(RS) + RS + \"E\" + RS;\n\t}\n\n\treturn {\n\t\tto_workbook: sylk_to_workbook,\n\t\tfrom_sheet: sheet_to_sylk\n\t};\n})();\n\nvar DIF = /*#__PURE__*/(function() {\n\tfunction dif_to_aoa(d/*:RawData*/, opts)/*:AOA*/ {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return dif_to_aoa_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return dif_to_aoa_str(d, opts);\n\t\t\tcase 'buffer': return dif_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array': return dif_to_aoa_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\tfunction dif_to_aoa_str(str/*:string*/, opts)/*:AOA*/ {\n\t\tvar records = str.split('\\n'), R = -1, C = -1, ri = 0, arr/*:AOA*/ = [];\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tif (records[ri].trim() === 'BOT') { arr[++R] = []; C = 0; continue; }\n\t\t\tif (R < 0) continue;\n\t\t\tvar metadata = records[ri].trim().split(\",\");\n\t\t\tvar type = metadata[0], value = metadata[1];\n\t\t\t++ri;\n\t\t\tvar data = records[ri] || \"\";\n\t\t\twhile(((data.match(/[\"]/g)||[]).length & 1) && ri < records.length - 1) data += \"\\n\" + records[++ri];\n\t\t\tdata = data.trim();\n\t\t\tswitch (+type) {\n\t\t\t\tcase -1:\n\t\t\t\t\tif (data === 'BOT') { arr[++R] = []; C = 0; continue; }\n\t\t\t\t\telse if (data !== 'EOD') throw new Error(\"Unrecognized DIF special command \" + data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0:\n\t\t\t\t\tif(data === 'TRUE') arr[R][C] = true;\n\t\t\t\t\telse if(data === 'FALSE') arr[R][C] = false;\n\t\t\t\t\telse if(!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);\n\t\t\t\t\telse if(!isNaN(fuzzydate(value).getDate())) {\n\t\t\t\t\t\tarr[R][C] = parseDate(value);\n\t\t\t\t\t\tif(!(opts && opts.UTC)) { arr[R][C] = utc_to_local(arr[R][C]); }\n\t\t\t\t\t}\n\t\t\t\t\telse arr[R][C] = value;\n\t\t\t\t\t++C; break;\n\t\t\t\tcase 1:\n\t\t\t\t\tdata = data.slice(1,data.length-1);\n\t\t\t\t\tdata = data.replace(/\"\"/g, '\"');\n\t\t\t\t\tif(DIF_XL && data && data.match(/^=\".*\"$/)) data = data.slice(2, -1);\n\t\t\t\t\tarr[R][C++] = data !== '' ? data : null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (data === 'EOD') break;\n\t\t}\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn arr;\n\t}\n\n\tfunction dif_to_sheet(str/*:string*/, opts)/*:Worksheet*/ { return aoa_to_sheet(dif_to_aoa(str, opts), opts); }\n\tfunction dif_to_workbook(str/*:string*/, opts)/*:Workbook*/ {\n\t\tvar o = sheet_to_workbook(dif_to_sheet(str, opts), opts);\n\t\to.bookType = \"dif\";\n\t\treturn o;\n\t}\n\n\tfunction make_value(v/*:number*/, s/*:string*/)/*:string*/ { return \"0,\" + String(v) + \"\\r\\n\" + s; }\n\tfunction make_value_str(s/*:string*/)/*:string*/ { return \"1,0\\r\\n\\\"\" + s.replace(/\"/g,'\"\"') + '\"'; }\n\tfunction sheet_to_dif(ws/*:Worksheet*//*::, opts:?any*/)/*:string*/ {\n\t\tvar _DIF_XL = DIF_XL;\n\t\tif(!ws[\"!ref\"]) throw new Error(\"Cannot export empty sheet to DIF\");\n\t\tvar r = safe_decode_range(ws['!ref']);\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tvar o/*:Array<string>*/ = [\n\t\t\t\"TABLE\\r\\n0,1\\r\\n\\\"sheetjs\\\"\\r\\n\",\n\t\t\t\"VECTORS\\r\\n0,\" + (r.e.r - r.s.r + 1) + \"\\r\\n\\\"\\\"\\r\\n\",\n\t\t\t\"TUPLES\\r\\n0,\" + (r.e.c - r.s.c + 1) + \"\\r\\n\\\"\\\"\\r\\n\",\n\t\t\t\"DATA\\r\\n0,0\\r\\n\\\"\\\"\\r\\n\"\n\t\t];\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tvar row = dense ? ws[\"!data\"][R] : [];\n\t\t\tvar p = \"-1,0\\r\\nBOT\\r\\n\";\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar cell/*:Cell*/ = dense ? (row && row[C]) : ws[encode_cell({r:R,c:C})];\n\t\t\t\tif(cell == null) { p +=(\"1,0\\r\\n\\\"\\\"\\r\\n\"); continue;}\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\tif(_DIF_XL) {\n\t\t\t\t\t\t\tif(cell.w != null) p +=(\"0,\" + cell.w + \"\\r\\nV\");\n\t\t\t\t\t\t\telse if(cell.v != null) p +=(make_value(cell.v, \"V\")); // TODO: should this call SSF_format?\n\t\t\t\t\t\t\telse if(cell.f != null && !cell.F) p +=(make_value_str(\"=\" + cell.f));\n\t\t\t\t\t\t\telse p +=(\"1,0\\r\\n\\\"\\\"\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(cell.v == null) p +=(\"1,0\\r\\n\\\"\\\"\");\n\t\t\t\t\t\t\telse p +=(make_value(cell.v, \"V\"));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tp +=(cell.v ? make_value(1, \"TRUE\") : make_value(0, \"FALSE\"));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 's':\n\t\t\t\t\t\tp +=(make_value_str((!_DIF_XL || isNaN(+cell.v)) ? cell.v : '=\"' + cell.v + '\"'));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\tif(!cell.w) cell.w = SSF_format(cell.z || table_fmt[14], datenum(parseDate(cell.v)));\n\t\t\t\t\t\tif(_DIF_XL) p +=(make_value(cell.w, \"V\"));\n\t\t\t\t\t\telse p +=(make_value_str(cell.w));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault: p +=(\"1,0\\r\\n\\\"\\\"\");\n\t\t\t\t}\n\t\t\t\tp += \"\\r\\n\";\n\t\t\t}\n\t\t\to.push(p);\n\t\t}\n\t\treturn o.join(\"\") + \"-1,0\\r\\nEOD\";\n\t}\n\treturn {\n\t\tto_workbook: dif_to_workbook,\n\t\tto_sheet: dif_to_sheet,\n\t\tfrom_sheet: sheet_to_dif\n\t};\n})();\n\nvar ETH = /*#__PURE__*/(function() {\n\tfunction decode(s/*:string*/)/*:string*/ { return s.replace(/\\\\b/g,\"\\\\\").replace(/\\\\c/g,\":\").replace(/\\\\n/g,\"\\n\"); }\n\tfunction encode(s/*:string*/)/*:string*/ { return s.replace(/\\\\/g, \"\\\\b\").replace(/:/g, \"\\\\c\").replace(/\\n/g,\"\\\\n\"); }\n\n\tfunction eth_to_aoa(str/*:string*/, opts)/*:AOA*/ {\n\t\tvar records = str.split('\\n'), R = -1, C = -1, ri = 0, arr/*:AOA*/ = [];\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tvar record = records[ri].trim().split(\":\");\n\t\t\tif(record[0] !== 'cell') continue;\n\t\t\tvar addr = decode_cell(record[1]);\n\t\t\tif(arr.length <= addr.r) for(R = arr.length; R <= addr.r; ++R) if(!arr[R]) arr[R] = [];\n\t\t\tR = addr.r; C = addr.c;\n\t\t\tswitch(record[2]) {\n\t\t\t\tcase 't': arr[R][C] = decode(record[3]); break;\n\t\t\t\tcase 'v': arr[R][C] = +record[3]; break;\n\t\t\t\tcase 'vtf': var _f = record[record.length - 1];\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 'vtc':\n\t\t\t\t\tswitch(record[3]) {\n\t\t\t\t\t\tcase 'nl': arr[R][C] = +record[4] ? true : false; break;\n\t\t\t\t\t\tdefault: arr[R][C] = record[record.length-1].charAt(0) == \"#\" ? ({t: \"e\", v: RBErr[record[record.length-1]] }) : +record[4]; break;\n\t\t\t\t\t}\n\t\t\t\t\tif(record[2] == 'vtf') arr[R][C] = [arr[R][C], _f];\n\t\t\t}\n\t\t}\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn arr;\n\t}\n\n\tfunction eth_to_sheet(d/*:string*/, opts)/*:Worksheet*/ { return aoa_to_sheet(eth_to_aoa(d, opts), opts); }\n\tfunction eth_to_workbook(d/*:string*/, opts)/*:Workbook*/ { return sheet_to_workbook(eth_to_sheet(d, opts), opts); }\n\n\tvar header = [\n\t\t\"socialcalc:version:1.5\",\n\t\t\"MIME-Version: 1.0\",\n\t\t\"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"\n\t].join(\"\\n\");\n\n\tvar sep = [\n\t\t\"--SocialCalcSpreadsheetControlSave\",\n\t\t\"Content-type: text/plain; charset=UTF-8\"\n\t].join(\"\\n\") + \"\\n\";\n\n\t/* TODO: the other parts */\n\tvar meta = [\n\t\t\"# SocialCalc Spreadsheet Control Save\",\n\t\t\"part:sheet\"\n\t].join(\"\\n\");\n\n\tvar end = \"--SocialCalcSpreadsheetControlSave--\";\n\n\tfunction sheet_to_eth_data(ws/*:Worksheet*/)/*:string*/ {\n\t\tif(!ws || !ws['!ref']) return \"\";\n\t\tvar o/*:Array<string>*/ = [], oo/*:Array<string>*/ = [], cell, coord = \"\";\n\t\tvar r = decode_range(ws['!ref']);\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tcoord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[\"!data\"][R]||[])[C] : ws[coord];\n\t\t\t\tif(!cell || cell.v == null || cell.t === 'z') continue;\n\t\t\t\too = [\"cell\", coord, 't'];\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 's': oo.push(encode(cell.v)); break;\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\too[2] = 'vt'+(cell.f?'f':'c'); oo[3]='nl'; oo[4]=cell.v?\"1\":\"0\";\n\t\t\t\t\t\too[5] = encode(cell.f||(cell.v?'TRUE':'FALSE'));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\tvar t = datenum(parseDate(cell.v));\n\t\t\t\t\t\too[2] = 'vtc'; oo[3] = 'nd'; oo[4] = \"\"+t;\n\t\t\t\t\t\too[5] = cell.w || SSF_format(cell.z || table_fmt[14], t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\tif(isFinite(cell.v)) {\n\t\t\t\t\t\t\tif(!cell.f) { oo[2]='v'; oo[3]=cell.v; }\n\t\t\t\t\t\t\telse { oo[2]='vtf'; oo[3]='n'; oo[4]=cell.v; oo[5]=encode(cell.f); }\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\too[2] = 'vt' + (cell.f ? 'f' : 'c');\n\t\t\t\t\t\t\too[3] = \"e\" + BErr[isNaN(cell.v) ? 0x24 : 0x07];\n\t\t\t\t\t\t\too[4] = \"0\";\n\t\t\t\t\t\t\too[5] = cell.f || oo[3].slice(1);\n\t\t\t\t\t\t\too[6] = \"e\";\n\t\t\t\t\t\t\too[7] = oo[3].slice(1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'e': continue;\n\t\t\t\t}\n\t\t\t\to.push(oo.join(\":\"));\n\t\t\t}\n\t\t}\n\t\to.push(\"sheet:c:\" + (r.e.c-r.s.c+1) + \":r:\" + (r.e.r-r.s.r+1) + \":tvf:1\");\n\t\to.push(\"valueformat:1:text-wiki\");\n\t\t//o.push(\"copiedfrom:\" + ws['!ref']); // clipboard only\n\t\treturn o.join(\"\\n\");\n\t}\n\n\tfunction sheet_to_eth(ws/*:Worksheet*//*::, opts:?any*/)/*:string*/ {\n\t\treturn [header, sep, meta, sep, sheet_to_eth_data(ws), end].join(\"\\n\");\n\t\t// return [\"version:1.5\", sheet_to_eth_data(ws)].join(\"\\n\"); // clipboard form\n\t}\n\n\treturn {\n\t\tto_workbook: eth_to_workbook,\n\t\tto_sheet: eth_to_sheet,\n\t\tfrom_sheet: sheet_to_eth\n\t};\n})();\n\nvar PRN = /*#__PURE__*/(function() {\n\tfunction set_text_arr(data/*:string*/, arr/*:AOA*/, R/*:number*/, C/*:number*/, o/*:any*/) {\n\t\tif(o.raw) arr[R][C] = data;\n\t\telse if(data === \"\"){/* empty */}\n\t\telse if(data === 'TRUE') arr[R][C] = true;\n\t\telse if(data === 'FALSE') arr[R][C] = false;\n\t\telse if(!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);\n\t\telse if(!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);\n\t\telse if(data.charCodeAt(0) == 35 /* # */ && RBErr[data] != null) arr[R][C] = ({ t: 'e', v: RBErr[data], w: data });\n\t\telse arr[R][C] = data;\n\t}\n\n\tfunction prn_to_aoa_str(f/*:string*/, opts)/*:AOA*/ {\n\t\tvar o = opts || {};\n\t\tvar arr/*:AOA*/ = ([]/*:any*/);\n\t\tif(!f || f.length === 0) return arr;\n\t\tvar lines = f.split(/[\\r\\n]/);\n\t\tvar L = lines.length - 1;\n\t\twhile(L >= 0 && lines[L].length === 0) --L;\n\t\tvar start = 10, idx = 0;\n\t\tvar R = 0;\n\t\tfor(; R <= L; ++R) {\n\t\t\tidx = lines[R].indexOf(\" \");\n\t\t\tif(idx == -1) idx = lines[R].length; else idx++;\n\t\t\tstart = Math.max(start, idx);\n\t\t}\n\t\tfor(R = 0; R <= L; ++R) {\n\t\t\tarr[R] = [];\n\t\t\t/* TODO: confirm that widths are always 10 */\n\t\t\tvar C = 0;\n\t\t\tset_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);\n\t\t\tfor(C = 1; C <= (lines[R].length - start)/10 + 1; ++C)\n\t\t\t\tset_text_arr(lines[R].slice(start+(C-1)*10,start+C*10).trim(),arr,R,C,o);\n\t\t}\n\t\tif(o.sheetRows) arr = arr.slice(0, o.sheetRows);\n\t\treturn arr;\n\t}\n\n\t// List of accepted CSV separators\n\tvar guess_seps = {\n\t\t0x2C: ',',\n\t\t0x09: \"\\t\",\n\t\t0x3B: ';',\n\t\t0x7C: '|'\n\t};\n\n\t// CSV separator weights to be used in case of equal numbers\n\tvar guess_sep_weights = {\n\t\t0x2C: 3,\n\t\t0x09: 2,\n\t\t0x3B: 1,\n\t\t0x7C: 0\n\t};\n\n\tfunction guess_sep(str) {\n\t\tvar cnt = {}, instr = false, end = 0, cc = 0;\n\t\tfor(;end < str.length;++end) {\n\t\t\tif((cc=str.charCodeAt(end)) == 0x22) instr = !instr;\n\t\t\telse if(!instr && cc in guess_seps) cnt[cc] = (cnt[cc]||0)+1;\n\t\t}\n\n\t\tcc = [];\n\t\tfor(end in cnt) if ( Object.prototype.hasOwnProperty.call(cnt, end) ) {\n\t\t\tcc.push([ cnt[end], end ]);\n\t\t}\n\n\t\tif ( !cc.length ) {\n\t\t\tcnt = guess_sep_weights;\n\t\t\tfor(end in cnt) if ( Object.prototype.hasOwnProperty.call(cnt, end) ) {\n\t\t\t\tcc.push([ cnt[end], end ]);\n\t\t\t}\n\t\t}\n\n\t\tcc.sort(function(a, b) { return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]]; });\n\n\t\treturn guess_seps[cc.pop()[1]] || 0x2C;\n\t}\n\n\tfunction dsv_to_sheet_str(str/*:string*/, opts)/*:Worksheet*/ {\n\t\tvar o = opts || {};\n\t\tvar sep = \"\";\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar ws/*:Worksheet*/ = ({}/*:any*/);\n\t\tif(o.dense) ws[\"!data\"] = [];\n\t\tvar range/*:Range*/ = ({s: {c:0, r:0}, e: {c:0, r:0}}/*:any*/);\n\n\t\tif(str.slice(0,4) == \"sep=\") {\n\t\t\t// If the line ends in \\r\\n\n\t\t\tif(str.charCodeAt(5) == 13 && str.charCodeAt(6) == 10 ) {\n\t\t\t\tsep = str.charAt(4); str = str.slice(7);\n\t\t\t}\n\t\t\t// If line ends in \\r OR \\n\n\t\t\telse if(str.charCodeAt(5) == 13 || str.charCodeAt(5) == 10 ) {\n\t\t\t\tsep = str.charAt(4); str = str.slice(6);\n\t\t\t}\n\t\t\telse sep = guess_sep(str.slice(0,1024));\n\t\t}\n\t\telse if(o && o.FS) sep = o.FS;\n\t\telse sep = guess_sep(str.slice(0,1024));\n\t\tvar R = 0, C = 0, v = 0;\n\t\tvar start = 0, end = 0, sepcc = sep.charCodeAt(0), instr = false, cc=0, startcc=str.charCodeAt(0);\n\t\tvar _re/*:?RegExp*/ = o.dateNF != null ? dateNF_regex(o.dateNF) : null;\n\t\tfunction finish_cell() {\n\t\t\t/* TODO: fuzzy parsers should pass back assumed number format */\n\t\t\tvar s = str.slice(start, end); if(s.slice(-1) == \"\\r\") s = s.slice(0, -1);\n\t\t\tvar cell = ({}/*:any*/);\n\t\t\tif(s.charAt(0) == '\"' && s.charAt(s.length - 1) == '\"') s = s.slice(1,-1).replace(/\"\"/g,'\"');\n\t\t\tif(o.cellText !== false) cell.w = s;\n\t\t\tif(s.length === 0) cell.t = 'z';\n\t\t\telse if(o.raw) { cell.t = 's'; cell.v = s; }\n\t\t\telse if(s.trim().length === 0) { cell.t = 's'; cell.v = s; }\n\t\t\telse if(s.charCodeAt(0) == 0x3D) {\n\t\t\t\tif(s.charCodeAt(1) == 0x22 && s.charCodeAt(s.length - 1) == 0x22) { cell.t = 's'; cell.v = s.slice(2,-1).replace(/\"\"/g,'\"'); }\n\t\t\t\telse if(fuzzyfmla(s)) { cell.t = 's'; cell.f = s.slice(1); cell.v = s; }\n\t\t\t\telse { cell.t = 's'; cell.v = s; } }\n\t\t\telse if(s == \"TRUE\") { cell.t = 'b'; cell.v = true; }\n\t\t\telse if(s == \"FALSE\") { cell.t = 'b'; cell.v = false; }\n\t\t\telse if(!isNaN(v = fuzzynum(s))) { cell.t = 'n'; cell.v = v; }\n\t\t\telse if(!isNaN((v = fuzzydate(s)).getDate()) || _re && s.match(_re)) {\n\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\tif(_re && s.match(_re)){ var news=dateNF_fix(s, o.dateNF, (s.match(_re)||[])); v = parseDate(news); if(o && o.UTC === false) v = utc_to_local(v); }\n\t\t\t\telse if(o && o.UTC === false) v = utc_to_local(v);\n\t\t\t\telse if(o.cellText !== false && o.dateNF) cell.w = SSF_format(cell.z, v);\n\t\t\t\tif(o.cellDates) { cell.t = 'd'; cell.v = v; }\n\t\t\t\telse { cell.t = 'n'; cell.v = datenum(v); }\n\t\t\t\tif(!o.cellNF) delete cell.z;\n\t\t\t} else if(s.charCodeAt(0) == 35 /* # */ && RBErr[s] != null) {\n\t\t\t\tcell.t = 'e'; cell.w = s; cell.v = RBErr[s];\n\t\t\t} else {\n\t\t\t\tcell.t = 's';\n\t\t\t\tcell.v = s;\n\t\t\t}\n\t\t\tif(cell.t == 'z'){}\n\t\t\telse if(o.dense) { if(!ws[\"!data\"][R]) ws[\"!data\"][R] = []; ws[\"!data\"][R][C] = cell; }\n\t\t\telse ws[encode_cell({c:C,r:R})] = cell;\n\t\t\tstart = end+1; startcc = str.charCodeAt(start);\n\t\t\tif(range.e.c < C) range.e.c = C;\n\t\t\tif(range.e.r < R) range.e.r = R;\n\t\t\tif(cc == sepcc) ++C; else { C = 0; ++R; if(o.sheetRows && o.sheetRows <= R) return true; }\n\t\t}\n\t\touter: for(;end < str.length;++end) switch((cc=str.charCodeAt(end))) {\n\t\t\tcase 0x22: if(startcc === 0x22) instr = !instr; break;\n\t\t\tcase 0x0d:\n\t\t\t\tif(instr) break;\n\t\t\t\tif(str.charCodeAt(end+1) == 0x0a) ++end;\n\t\t\t\t/* falls through */\n\t\t\tcase sepcc: case 0x0a: if(!instr && finish_cell()) break outer; break;\n\t\t\tdefault: break;\n\t\t}\n\t\tif(end - start > 0) finish_cell();\n\n\t\tws['!ref'] = encode_range(range);\n\t\treturn ws;\n\t}\n\n\tfunction prn_to_sheet_str(str/*:string*/, opts)/*:Worksheet*/ {\n\t\tif(!(opts && opts.PRN)) return dsv_to_sheet_str(str, opts);\n\t\tif(opts.FS) return dsv_to_sheet_str(str, opts);\n\t\tif(str.slice(0,4) == \"sep=\") return dsv_to_sheet_str(str, opts);\n\t\tif(str.indexOf(\"\\t\") >= 0 || str.indexOf(\",\") >= 0 || str.indexOf(\";\") >= 0) return dsv_to_sheet_str(str, opts);\n\t\treturn aoa_to_sheet(prn_to_aoa_str(str, opts), opts);\n\t}\n\n\tfunction prn_to_sheet(d/*:RawData*/, opts)/*:Worksheet*/ {\n\t\tvar str = \"\", bytes = opts.type == 'string' ? [0,0,0,0] : firstbyte(d, opts);\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': str = Base64_decode(d); break;\n\t\t\tcase 'binary': str = d; break;\n\t\t\tcase 'buffer':\n\t\t\t\tif(opts.codepage == 65001) str = d.toString('utf8'); // TODO: test if buf\n\t\t\t\telse if(opts.codepage && typeof $cptable !== 'undefined') str = $cptable.utils.decode(opts.codepage, d);\n\t\t\t\telse str = has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d);\n\t\t\t\tbreak;\n\t\t\tcase 'array': str = cc2str(d); break;\n\t\t\tcase 'string': str = d; break;\n\t\t\tdefault: throw new Error(\"Unrecognized type \" + opts.type);\n\t\t}\n\t\tif(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str.slice(3));\n\t\telse if(opts.type != 'string' && opts.type != 'buffer' && opts.codepage == 65001) str = utf8read(str);\n\t\telse if((opts.type == 'binary') && typeof $cptable !== 'undefined' && opts.codepage)  str = $cptable.utils.decode(opts.codepage, $cptable.utils.encode(28591,str));\n\t\tif(str.slice(0,19) == \"socialcalc:version:\") return ETH.to_sheet(opts.type == 'string' ? str : utf8read(str), opts);\n\t\treturn prn_to_sheet_str(str, opts);\n\t}\n\n\tfunction prn_to_workbook(d/*:RawData*/, opts)/*:Workbook*/ { return sheet_to_workbook(prn_to_sheet(d, opts), opts); }\n\n\tfunction sheet_to_prn(ws/*:Worksheet*//*::, opts:?any*/)/*:string*/ {\n\t\tvar o/*:Array<string>*/ = [];\n\t\tif(!ws[\"!ref\"]) return \"\";\n\t\tvar r = safe_decode_range(ws['!ref']), cell/*:Cell*/;\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tvar oo/*:Array<string>*/ = [];\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[\"!data\"][R]||[])[C] : ws[coord];\n\t\t\t\tif(!cell || cell.v == null) { oo.push(\"          \"); continue; }\n\t\t\t\tvar w = (cell.w || (format_cell(cell), cell.w) || \"\").slice(0,10);\n\t\t\t\twhile(w.length < 10) w += \" \";\n\t\t\t\too.push(w + (C === 0 ? \" \" : \"\"));\n\t\t\t}\n\t\t\to.push(oo.join(\"\"));\n\t\t}\n\t\treturn o.join(\"\\n\");\n\t}\n\n\treturn {\n\t\tto_workbook: prn_to_workbook,\n\t\tto_sheet: prn_to_sheet,\n\t\tfrom_sheet: sheet_to_prn\n\t};\n})();\n\n/* Excel defaults to SYLK but warns if data is not valid */\nfunction read_wb_ID(d, opts) {\n\tvar o = opts || {}, OLD_WTF = !!o.WTF; o.WTF = true;\n\ttry {\n\t\tvar out = SYLK.to_workbook(d, o);\n\t\to.WTF = OLD_WTF;\n\t\treturn out;\n\t} catch(e) {\n\t\to.WTF = OLD_WTF;\n\t\tif((e.message.indexOf(\"SYLK bad record ID\") == -1) && OLD_WTF) throw e;\n\t\treturn PRN.to_workbook(d, opts);\n\t}\n}\n\nvar WK_ = /*#__PURE__*/(function() {\n\tfunction lotushopper(data, cb/*:RecordHopperCB*/, opts/*:any*/) {\n\t\tif(!data) return;\n\t\tprep_blob(data, data.l || 0);\n\t\tvar Enum = opts.Enum || WK1Enum;\n\t\twhile(data.l < data.length) {\n\t\t\tvar RT = data.read_shift(2);\n\t\t\tvar R = Enum[RT] || Enum[0xFFFF];\n\t\t\tvar length = data.read_shift(2);\n\t\t\tvar tgt = data.l + length;\n\t\t\tvar d = R.f && R.f(data, length, opts);\n\t\t\tdata.l = tgt;\n\t\t\tif(cb(d, R, RT)) return;\n\t\t}\n\t}\n\n\tfunction lotus_to_workbook(d/*:RawData*/, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return lotus_to_workbook_buf(s2a(Base64_decode(d)), opts);\n\t\t\tcase 'binary': return lotus_to_workbook_buf(s2a(d), opts);\n\t\t\tcase 'buffer':\n\t\t\tcase 'array': return lotus_to_workbook_buf(d, opts);\n\t\t}\n\t\tthrow \"Unsupported type \" + opts.type;\n\t}\n\n\t/* NOTE: this list intentionally starts at 1 */\n\tvar LOTUS_DATE_FMTS = [\n\t\t\"mmmm\",\n\t\t\"dd-mmm-yyyy\",\n\t\t\"dd-mmm\",\n\t\t\"mmm-yyyy\",\n\t\t\"@\", // \"text\"?\n\t\t\"mm/dd\",\n\t\t\"hh:mm:ss AM/PM\", // 7\n\t\t\"hh:mm AM/PM\",\n\t\t\"mm/dd/yyyy\",\n\t\t\"mm/dd\",\n\t\t\"hh:mm:ss\",\n\t\t\"hh:mm\" // 12\n\t];\n\n\tfunction lotus_to_workbook_buf(d, opts)/*:Workbook*/ {\n\t\tif(!d) return d;\n\t\tvar o = opts || {};\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar s/*:Worksheet*/ = ({}/*:any*/), n = \"Sheet1\", next_n = \"\", sidx = 0;\n\t\tvar sheets = {}, snames = [], realnames = [], sdata = [];\n\t\tif(o.dense) sdata = s[\"!data\"] = [];\n\n\t\tvar refguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\tvar sheetRows = o.sheetRows || 0;\n\t\tvar lastcell = {};\n\n\t\tif(d[4] == 0x51 && d[5] == 0x50 && d[6] == 0x57) return qpw_to_workbook_buf(d, opts);\n\t\tif(d[2] == 0x00) {\n\t\t\tif(d[3] == 0x08 || d[3] == 0x09) {\n\t\t\t\tif(d.length >= 16 && d[14] == 0x05 && d[15] === 0x6c) throw new Error(\"Unsupported Works 3 for Mac file\");\n\t\t\t}\n\t\t}\n\n\t\tif(d[2] == 0x02) {\n\t\t\to.Enum = WK1Enum;\n\t\t\tlotushopper(d, function(val, R, RT) { switch(RT) {\n\t\t\t\tcase 0x00: /* BOF */\n\t\t\t\t\to.vers = val;\n\t\t\t\t\tif(val >= 0x1000) o.qpro = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xFF: /* BOF (works 3+) */\n\t\t\t\t\to.vers = val;\n\t\t\t\t\to.works = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x06: refguess = val; break; /* RANGE */\n\t\t\t\tcase 0xCC: if(val) next_n = val; break; /* SHEETNAMECS */\n\t\t\t\tcase 0xDE: next_n = val; break; /* SHEETNAMELP */\n\t\t\t\tcase 0x0F: /* LABEL */\n\t\t\t\tcase 0x33: /* STRING */\n\t\t\t\t\tif((!o.qpro && !o.works || RT == 0x33) && val[1].v.charCodeAt(0) < 0x30) val[1].v = val[1].v.slice(1);\n\t\t\t\t\tif(o.works || o.works2) val[1].v = val[1].v.replace(/\\r\\n/g, \"\\n\");\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 0x0D: /* INTEGER */\n\t\t\t\tcase 0x0E: /* NUMBER */\n\t\t\t\tcase 0x10: /* FORMULA */\n\t\t\t\t\t/* TODO: actual translation of the format code */\n\t\t\t\t\tif((val[2] & 0x70) == 0x70 && (val[2] & 0x0F) > 1 && (val[2] & 0x0F) < 15) {\n\t\t\t\t\t\tval[1].z = o.dateNF || LOTUS_DATE_FMTS[(val[2] & 0x0F)-1] || table_fmt[14];\n\t\t\t\t\t\tif(o.cellDates) { val[1].v = numdate(val[1].v); val[1].t = typeof val[1].v == \"number\" ? 'n' : 'd'; }\n\t\t\t\t\t}\n\n\t\t\t\t\tif(o.qpro) {\n\t\t\t\t\t\tif(val[3] > sidx) {\n\t\t\t\t\t\t\ts[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t\t\tsheets[n] = s;\n\t\t\t\t\t\t\tsnames.push(n);\n\t\t\t\t\t\t\ts = ({}/*:any*/); if(o.dense) sdata = s[\"!data\"] = [];\n\t\t\t\t\t\t\trefguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\t\t\t\t\t\tsidx = val[3]; n = next_n || \"Sheet\" + (sidx + 1); next_n = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar tmpcell = o.dense ? (sdata[val[0].r]||[])[val[0].c] : s[encode_cell(val[0])];\n\t\t\t\t\tif(tmpcell) {\n\t\t\t\t\t\ttmpcell.t = val[1].t; tmpcell.v = val[1].v;\n\t\t\t\t\t\tif(val[1].z != null) tmpcell.z = val[1].z;\n\t\t\t\t\t\tif(val[1].f != null) tmpcell.f = val[1].f;\n\t\t\t\t\t\tlastcell = tmpcell;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(o.dense) {\n\t\t\t\t\t\tif(!sdata[val[0].r]) sdata[val[0].r] = [];\n\t\t\t\t\t\tsdata[val[0].r][val[0].c] = val[1];\n\t\t\t\t\t} else s[encode_cell(val[0])] = val[1];\n\t\t\t\t\tlastcell = val[1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x5405: o.works2 = true; break;\n\t\t\t\tcase 0x5402: {\n\t\t\t\t\t/* TODO: enumerate all extended number formats */\n\t\t\t\t\tif(val == 0x14a1) {\n\t\t\t\t\t\tlastcell.z = \"hh:mm:ss\";\n\t\t\t\t\t\tif(o.cellDates && lastcell.t == \"n\") {\n\t\t\t\t\t\t\tlastcell.v = numdate(lastcell.v); lastcell.t = typeof lastcell.v == \"number\" ? 'n' : 'd';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t}}, o);\n\t\t} else if(d[2] == 0x1A || d[2] == 0x0E) {\n\t\t\to.Enum = WK3Enum;\n\t\t\tif(d[2] == 0x0E) { o.qpro = true; d.l = 0; }\n\t\t\tlotushopper(d, function(val, R, RT) { switch(RT) {\n\t\t\t\tcase 0xCC: n = val; break; /* SHEETNAMECS */\n\t\t\t\tcase 0x16: /* LABEL16 */\n\t\t\t\t\tif(val[1].v.charCodeAt(0) < 0x30) val[1].v = val[1].v.slice(1);\n\t\t\t\t\t// TODO: R9 appears to encode control codes this way -- verify against other versions\n\t\t\t\t\tval[1].v = val[1].v.replace(/\\x0F./g, function($$) { return String.fromCharCode($$.charCodeAt(1) - 0x20); }).replace(/\\r\\n/g, \"\\n\");\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 0x17: /* NUMBER17 */\n\t\t\t\tcase 0x18: /* NUMBER18 */\n\t\t\t\tcase 0x19: /* FORMULA19 */\n\t\t\t\tcase 0x25: /* NUMBER25 */\n\t\t\t\tcase 0x27: /* NUMBER27 */\n\t\t\t\tcase 0x28: /* FORMULA28 */\n\t\t\t\t\tif(val[3] > sidx) {\n\t\t\t\t\t\ts[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t\tsheets[n] = s;\n\t\t\t\t\t\tsnames.push(n);\n\t\t\t\t\t\ts = ({}/*:any*/); if(o.dense) sdata = s[\"!data\"] = [];\n\t\t\t\t\t\trefguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\t\t\t\t\tsidx = val[3]; n = \"Sheet\" + (sidx + 1);\n\t\t\t\t\t}\n\t\t\t\t\tif(sheetRows > 0 && val[0].r >= sheetRows) break;\n\t\t\t\t\tif(o.dense) {\n\t\t\t\t\t\tif(!sdata[val[0].r]) sdata[val[0].r] = [];\n\t\t\t\t\t\tsdata[val[0].r][val[0].c] = val[1];\n\t\t\t\t\t} else s[encode_cell(val[0])] = val[1];\n\t\t\t\t\tif(refguess.e.c < val[0].c) refguess.e.c = val[0].c;\n\t\t\t\t\tif(refguess.e.r < val[0].r) refguess.e.r = val[0].r;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x1B: /* XFORMAT */\n\t\t\t\t\tif(val[0x36b0]) realnames[val[0x36b0][0]] = val[0x36b0][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0601: /* SHEETINFOQP */\n\t\t\t\t\trealnames[val[0]] = val[1]; if(val[0] == sidx) n = val[1]; break;\n\t\t\t\tdefault: break;\n\t\t\t}}, o);\n\t\t} else throw new Error(\"Unrecognized LOTUS BOF \" + d[2]);\n\t\ts[\"!ref\"] = encode_range(refguess);\n\t\tsheets[next_n || n] = s;\n\t\tsnames.push(next_n || n);\n\t\tif(!realnames.length) return { SheetNames: snames, Sheets: sheets };\n\t\tvar osheets = {}, rnames = [];\n\t\t/* TODO: verify no collisions */\n\t\tfor(var i = 0; i < realnames.length; ++i) if(sheets[snames[i]]) {\n\t\t\trnames.push(realnames[i] || snames[i]);\n\t\t\tosheets[realnames[i]] = sheets[realnames[i]] || sheets[snames[i]];\n\t\t} else {\n\t\t\trnames.push(realnames[i]);\n\t\t\tosheets[realnames[i]] = ({ \"!ref\": \"A1\" });\n\t\t}\n\t\treturn { SheetNames: rnames, Sheets: osheets };\n\t}\n\n\tfunction sheet_to_wk1(ws/*:Worksheet*/, opts/*:WriteOpts*/) {\n\t\tvar o = opts || {};\n\t\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\t\tif(o.type == \"string\") throw new Error(\"Cannot write WK1 to JS string\");\n\t\tvar ba = buf_array();\n\t\tif(!ws[\"!ref\"]) throw new Error(\"Cannot export empty sheet to WK1\");\n\t\tvar range = safe_decode_range(ws[\"!ref\"]);\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tvar cols = [];\n\n\t\twrite_biff_rec(ba, 0x00, write_BOF_WK1(0x0406));\n\t\twrite_biff_rec(ba, 0x06, write_RANGE(range));\n\t\tvar max_R = Math.min(range.e.r, 8191);\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\t\tfor(var R = range.s.r; R <= max_R; ++R) {\n\t\t\tvar rr = encode_row(R);\n\t\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\tvar cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[cols[C] + rr];\n\t\t\t\tif(!cell || cell.t == \"z\") continue;\n\t\t\t\t/* TODO: formula records */\n\t\t\t\tswitch(cell.t) {\n\t\t\t\tcase \"n\":\n\t\t\t\t\tif((cell.v|0)==cell.v && cell.v >= -32768 && cell.v <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, cell));\n\t\t\t\t\telse write_biff_rec(ba, 0x0e, write_NUMBER(R, C, cell));\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"d\":\n\t\t\t\t\tvar dc = datenum(cell.v);\n\t\t\t\t\tif((dc|0)==dc && dc >= -32768 && dc <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, {t:\"n\", v:dc, z:cell.z || table_fmt[14]}));\n\t\t\t\t\telse write_biff_rec(ba, 0x0e, write_NUMBER(R, C, {t:\"n\", v:dc, z:cell.z || table_fmt[14]}));\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvar str = format_cell(cell);\n\t\t\t\t\twrite_biff_rec(ba, 0x0F, write_LABEL(R, C, str.slice(0, 239)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twrite_biff_rec(ba, 0x01);\n\t\treturn ba.end();\n\t}\n\n\tfunction book_to_wk3(wb/*:Workbook*/, opts/*:WriteOpts*/) {\n\t\tvar o = opts || {};\n\t\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\t\tif(o.type == \"string\") throw new Error(\"Cannot write WK3 to JS string\");\n\t\tvar ba = buf_array();\n\n\t\twrite_biff_rec(ba, 0x00, write_BOF_WK3(wb));\n\n\t\tfor(var i = 0, cnt = 0; i < wb.SheetNames.length; ++i) if((wb.Sheets[wb.SheetNames[i]] || {})[\"!ref\"]) write_biff_rec(ba, 0x1b, write_XFORMAT_SHEETNAME(wb.SheetNames[i], cnt++));\n\n\t\tvar wsidx = 0;\n\t\tfor(i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tvar ws = wb.Sheets[wb.SheetNames[i]];\n\t\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\t\tvar range = safe_decode_range(ws[\"!ref\"]);\n\t\t\tvar dense = ws[\"!data\"] != null;\n\t\t\tvar cols = [];\n\t\t\tvar max_R = Math.min(range.e.r, 8191);\n\t\t\tfor(var R = range.s.r; R <= max_R; ++R) {\n\t\t\t\tvar rr = encode_row(R);\n\t\t\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\t\t\tvar ref = cols[C] + rr;\n\t\t\t\t\tvar cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[ref];\n\t\t\t\t\tif(!cell || cell.t == \"z\") continue;\n\t\t\t\t\t/* TODO: FORMULA19 NUMBER18 records */\n\t\t\t\t\tif(cell.t == \"n\") {\n\t\t\t\t\t\twrite_biff_rec(ba, 0x17, write_NUMBER_17(R, C, wsidx, cell.v));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar str = format_cell(cell);\n\t\t\t\t\t\t/* TODO: max len? */\n\t\t\t\t\t\twrite_biff_rec(ba, 0x16, write_LABEL_16(R, C, wsidx, str.slice(0, 239)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t++wsidx;\n\t\t}\n\n\t\twrite_biff_rec(ba, 0x01);\n\t\treturn ba.end();\n\t}\n\n\n\tfunction write_BOF_WK1(v/*:number*/) {\n\t\tvar out = new_buf(2);\n\t\tout.write_shift(2, v);\n\t\treturn out;\n\t}\n\n\tfunction write_BOF_WK3(wb/*:Workbook*/) {\n\t\tvar out = new_buf(26);\n\t\tout.write_shift(2, 0x1000);\n\t\tout.write_shift(2, 0x0004);\n\t\tout.write_shift(4, 0x0000);\n\t\tvar rows = 0, cols = 0, wscnt = 0;\n\t\tfor(var i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tvar name = wb.SheetNames[i];\n\t\t\tvar ws = wb.Sheets[name];\n\t\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\t\t++wscnt;\n\t\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\t\tif(rows < range.e.r) rows = range.e.r;\n\t\t\tif(cols < range.e.c) cols = range.e.c;\n\t\t}\n\t\tif(rows > 8191) rows = 8191;\n\t\tout.write_shift(2, rows);\n\t\tout.write_shift(1, wscnt);\n\t\tout.write_shift(1, cols);\n\t\tout.write_shift(2, 0x00);\n\t\tout.write_shift(2, 0x00);\n\t\tout.write_shift(1, 0x01);\n\t\tout.write_shift(1, 0x02);\n\t\tout.write_shift(4, 0);\n\t\tout.write_shift(4, 0);\n\t\treturn out;\n\t}\n\n\tfunction parse_RANGE(blob, length, opts) {\n\t\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\t\tif(length == 8 && opts.qpro) {\n\t\t\to.s.c = blob.read_shift(1);\n\t\t\tblob.l++;\n\t\t\to.s.r = blob.read_shift(2);\n\t\t\to.e.c = blob.read_shift(1);\n\t\t\tblob.l++;\n\t\t\to.e.r = blob.read_shift(2);\n\t\t\treturn o;\n\t\t}\n\t\to.s.c = blob.read_shift(2);\n\t\to.s.r = blob.read_shift(2);\n\t\tif(length == 12 && opts.qpro) blob.l += 2;\n\t\to.e.c = blob.read_shift(2);\n\t\to.e.r = blob.read_shift(2);\n\t\tif(length == 12 && opts.qpro) blob.l += 2;\n\t\tif(o.s.c == 0xFFFF) o.s.c = o.e.c = o.s.r = o.e.r = 0;\n\t\treturn o;\n\t}\n\tfunction write_RANGE(range) {\n\t\tvar out = new_buf(8);\n\t\tout.write_shift(2, range.s.c);\n\t\tout.write_shift(2, range.s.r);\n\t\tout.write_shift(2, range.e.c);\n\t\tout.write_shift(2, range.e.r);\n\t\treturn out;\n\t}\n\n\tfunction parse_cell(blob, length, opts) {\n\t\tvar o = [{c:0,r:0}, {t:'n',v:0}, 0, 0];\n\t\tif(opts.qpro && opts.vers != 0x5120) {\n\t\t\to[0].c = blob.read_shift(1);\n\t\t\to[3] = blob.read_shift(1);\n\t\t\to[0].r = blob.read_shift(2);\n\t\t\tblob.l+=2;\n\t\t} else if(opts.works) { // TODO: verify with more complex works3-4 examples\n\t\t\to[0].c = blob.read_shift(2); o[0].r = blob.read_shift(2);\n\t\t\to[2] = blob.read_shift(2);\n\t\t} else {\n\t\t\to[2] = blob.read_shift(1);\n\t\t\to[0].c = blob.read_shift(2); o[0].r = blob.read_shift(2);\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction get_wk1_fmt(cell)/*:number*/ {\n\t\t/* TODO: some fuzzy matching on the number format */\n\t\tif(cell.z && fmt_is_date(cell.z)) {\n\t\t\treturn 0xf0 | (LOTUS_DATE_FMTS.indexOf(cell.z) + 1 || 2);\n\t\t}\n\t\treturn 0xFF;\n\t}\n\tfunction parse_LABEL(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].t = 's';\n\t\tif((opts.vers & 0xFFFE) == 0x5120) { // WQ1 / WQ2\n\t\t\tblob.l++;\n\t\t\tvar len = blob.read_shift(1);\n\t\t\to[1].v = blob.read_shift(len, 'utf8');\n\t\t\treturn o;\n\t\t}\n\t\tif(opts.qpro) blob.l++;\n\t\to[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n\t\treturn o;\n\t}\n\tfunction write_LABEL(R, C, s) {\n\t\t/* TODO: encoding */\n\t\tvar o = new_buf(7 + s.length);\n\t\to.write_shift(1, 0xFF);\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, 0x27); // ??\n\t\tfor(var i = 0; i < o.length; ++i) {\n\t\t\tvar cc = s.charCodeAt(i);\n\t\t\to.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n\t\t}\n\t\to.write_shift(1, 0);\n\t\treturn o;\n\t}\n\tfunction parse_STRING(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].t = 's';\n\t\tif(opts.vers == 0x5120) {\n\t\t\tvar len = blob.read_shift(1);\n\t\t\to[1].v = blob.read_shift(len, 'utf8');\n\t\t\treturn o;\n\t\t}\n\t\to[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n\t\treturn o;\n\t}\n\n\tfunction parse_INTEGER(blob, length, opts) {\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].v = blob.read_shift(2, 'i');\n\t\treturn o;\n\t}\n\tfunction write_INTEGER(R, C, cell) {\n\t\tvar o = new_buf(7);\n\t\to.write_shift(1, get_wk1_fmt(cell));\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(2, cell.v, 'i');\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER(blob, length, opts) {\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].v = blob.read_shift(8, 'f');\n\t\treturn o;\n\t}\n\tfunction write_NUMBER(R, C, cell) {\n\t\tvar o = new_buf(13);\n\t\to.write_shift(1, get_wk1_fmt(cell));\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(8, cell.v, 'f');\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\t/* TODO: formula */\n\t\to[1].v = blob.read_shift(8, 'f');\n\t\tif(opts.qpro) blob.l = tgt;\n\t\telse {\n\t\t\tvar flen = blob.read_shift(2);\n\t\t\twk1_fmla_to_csf(blob.slice(blob.l, blob.l + flen), o);\n\t\t\tblob.l += flen;\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction wk1_parse_rc(B, V, col) {\n\t\tvar rel = V & 0x8000;\n\t\tV &= ~0x8000;\n\t\tV = (rel ? B : 0) + ((V >= 0x2000) ? V - 0x4000 : V);\n\t\treturn (rel ? \"\" : \"$\") + (col ? encode_col(V) : encode_row(V));\n\t}\n\t/* var oprec = [\n\t\t8, 8, 8, 8, 8, 8, 8, 8, 6, 4, 4, 5, 5, 7, 3, 3,\n\t\t3, 3, 3, 3, 1, 1, 2, 6, 8, 8, 8, 8, 8, 8, 8, 8\n\t]; */\n\t/* TODO: flesh out */\n\tvar FuncTab = {\n\t\t0x1F: [\"NA\", 0],\n\t\t// 0x20: [\"ERR\", 0],\n\t\t0x21: [\"ABS\", 1],\n\t\t0x22: [\"TRUNC\", 1],\n\t\t0x23: [\"SQRT\", 1],\n\t\t0x24: [\"LOG\", 1],\n\t\t0x25: [\"LN\", 1],\n\t\t0x26: [\"PI\", 0],\n\t\t0x27: [\"SIN\", 1],\n\t\t0x28: [\"COS\", 1],\n\t\t0x29: [\"TAN\", 1],\n\t\t0x2A: [\"ATAN2\", 2],\n\t\t0x2B: [\"ATAN\", 1],\n\t\t0x2C: [\"ASIN\", 1],\n\t\t0x2D: [\"ACOS\", 1],\n\t\t0x2E: [\"EXP\", 1],\n\t\t0x2F: [\"MOD\", 2],\n\t\t// 0x30\n\t\t0x31: [\"ISNA\", 1],\n\t\t0x32: [\"ISERR\", 1],\n\t\t0x33: [\"FALSE\", 0],\n\t\t0x34: [\"TRUE\", 0],\n\t\t0x35: [\"RAND\", 0],\n\t\t0x36: [\"DATE\", 3],\n\t\t// 0x37 NOW\n\t\t// 0x38 PMT\n\t\t// 0x39 PV\n\t\t// 0x3A FV\n\t\t// 0x3B IF\n\t\t// 0x3C DAY\n\t\t// 0x3D MONTH\n\t\t// 0x3E YEAR\n\t\t0x3F: [\"ROUND\", 2],\n\t\t0x40: [\"TIME\", 3],\n\t\t// 0x41 HOUR\n\t\t// 0x42 MINUTE\n\t\t// 0x43 SECOND\n\t\t0x44: [\"ISNUMBER\", 1],\n\t\t0x45: [\"ISTEXT\", 1],\n\t\t0x46: [\"LEN\", 1],\n\t\t0x47: [\"VALUE\", 1],\n\t\t// 0x48: [\"FIXED\", ?? 1],\n\t\t0x49: [\"MID\", 3],\n\t\t0x4A: [\"CHAR\", 1],\n\t\t// 0x4B\n\t\t// 0x4C FIND\n\t\t// 0x4D DATEVALUE\n\t\t// 0x4E TIMEVALUE\n\t\t// 0x4F CELL\n\t\t0x50: [\"SUM\", 69],\n\t\t0x51: [\"AVERAGEA\", 69],\n\t\t0x52: [\"COUNTA\", 69],\n\t\t0x53: [\"MINA\", 69],\n\t\t0x54: [\"MAXA\", 69],\n\t\t// 0x55 VLOOKUP\n\t\t// 0x56 NPV\n\t\t// 0x57 VAR\n\t\t// 0x58 STD\n\t\t// 0x59 IRR\n\t\t// 0x5A HLOOKUP\n\t\t// 0x5B DSUM\n\t\t// 0x5C DAVERAGE\n\t\t// 0x5D DCOUNTA\n\t\t// 0x5E DMIN\n\t\t// 0x5F DMAX\n\t\t// 0x60 DVARP\n\t\t// 0x61 DSTDEVP\n\t\t// 0x62 INDEX\n\t\t// 0x63 COLS\n\t\t// 0x64 ROWS\n\t\t// 0x65 REPEAT\n\t\t0x66: [\"UPPER\", 1],\n\t\t0x67: [\"LOWER\", 1],\n\t\t// 0x68 LEFT\n\t\t// 0x69 RIGHT\n\t\t// 0x6A REPLACE\n\t\t0x6B: [\"PROPER\", 1],\n\t\t// 0x6C CELL\n\t\t0x6D: [\"TRIM\", 1],\n\t\t// 0x6E CLEAN\n\t\t0x6F: [\"T\", 1]\n\t\t// 0x70 V\n\t};\n\tvar BinOpTab = [\n\t\t  \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t  \"\",  \"+\",  \"-\",  \"*\",  \"/\",  \"^\",  \"=\", \"<>\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t\"<=\", \">=\",  \"<\",  \">\",   \"\",   \"\",   \"\",   \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t \"&\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\"  // eslint-disable-line no-mixed-spaces-and-tabs\n\t];\n\n\tfunction wk1_fmla_to_csf(blob, o) {\n\t\tprep_blob(blob, 0);\n\t\tvar out = [], argc = 0, R = \"\", C = \"\", argL = \"\", argR = \"\";\n\t\twhile(blob.l < blob.length) {\n\t\t\tvar cc = blob[blob.l++];\n\t\t\tswitch(cc) {\n\t\t\t\tcase 0x00: out.push(blob.read_shift(8, 'f')); break;\n\t\t\t\tcase 0x01: {\n\t\t\t\t\tC = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tR = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tout.push(C + R);\n\t\t\t\t} break;\n\t\t\t\tcase 0x02: {\n\t\t\t\t\tvar c = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tvar r = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tC = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tR = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tout.push(c + r + \":\" + C + R);\n\t\t\t\t} break;\n\t\t\t\tcase 0x03:\n\t\t\t\t\tif(blob.l < blob.length) { console.error(\"WK1 premature formula end\"); return; }\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x04: out.push(\"(\" + out.pop() + \")\"); break;\n\t\t\t\tcase 0x05: out.push(blob.read_shift(2)); break;\n\t\t\t\tcase 0x06: {\n\t\t\t\t\t/* TODO: text encoding */\n\t\t\t\t\tvar Z = \"\"; while((cc = blob[blob.l++])) Z += String.fromCharCode(cc);\n\t\t\t\t\tout.push('\"' + Z.replace(/\"/g, '\"\"') + '\"');\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x08: out.push(\"-\" + out.pop()); break;\n\t\t\t\tcase 0x17: out.push(\"+\" + out.pop()); break;\n\t\t\t\tcase 0x16: out.push(\"NOT(\" + out.pop() + \")\"); break;\n\n\t\t\t\tcase 0x14: case 0x15: {\n\t\t\t\t\targR = out.pop(); argL = out.pop();\n\t\t\t\t\tout.push([\"AND\", \"OR\"][cc - 0x14] + \"(\" + argL + \",\" + argR + \")\");\n\t\t\t\t} break;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif(cc < 0x20 && BinOpTab[cc]) {\n\t\t\t\t\t\targR = out.pop(); argL = out.pop();\n\t\t\t\t\t\tout.push(argL + BinOpTab[cc] + argR);\n\t\t\t\t\t} else if(FuncTab[cc]) {\n\t\t\t\t\t\targc = FuncTab[cc][1];\n\t\t\t\t\t\tif(argc == 69) argc = blob[blob.l++];\n\t\t\t\t\t\tif(argc > out.length) { console.error(\"WK1 bad formula parse 0x\" + cc.toString(16) + \":|\" + out.join(\"|\") + \"|\"); return; }\n\t\t\t\t\t\tvar args = out.slice(-argc);\n\t\t\t\t\t\tout.length -= argc;\n\t\t\t\t\t\tout.push(FuncTab[cc][0] + \"(\" + args.join(\",\") + \")\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(cc <= 0x07) return console.error(\"WK1 invalid opcode \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x18) return console.error(\"WK1 unsupported op \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x1E) return console.error(\"WK1 invalid opcode \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x73) return console.error(\"WK1 unsupported function opcode \" + cc.toString(16));\n\t\t\t\t\t// possible future functions ??\n\t\t\t\t\telse return console.error(\"WK1 unrecognized opcode \" + cc.toString(16));\n\t\t\t}\n\t\t}\n\t\tif(out.length == 1) o[1].f = \"\" + out[0];\n\t\telse console.error(\"WK1 bad formula parse |\" + out.join(\"|\") + \"|\");\n\t}\n\n\tfunction parse_cell_3(blob/*::, length*/) {\n\t\tvar o = [{c:0,r:0}, {t:'n',v:0}, 0];\n\t\to[0].r = blob.read_shift(2); o[3] = blob[blob.l++]; o[0].c = blob[blob.l++];\n\t\treturn o;\n\t}\n\n\tfunction parse_LABEL_16(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\to[1].t = 's';\n\t\to[1].v = blob.read_shift(length - 4, 'cstr');\n\t\treturn o;\n\t}\n\tfunction write_LABEL_16(R, C, wsidx, s) {\n\t\t/* TODO: encoding */\n\t\tvar o = new_buf(6 + s.length);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, wsidx);\n\t\to.write_shift(1, C);\n\t\to.write_shift(1, 0x27);\n\t\tfor(var i = 0; i < s.length; ++i) {\n\t\t\tvar cc = s.charCodeAt(i);\n\t\t\to.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n\t\t}\n\t\to.write_shift(1, 0);\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_18(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\to[1].v = blob.read_shift(2);\n\t\tvar v = o[1].v >> 1;\n\t\tif(o[1].v & 0x1) {\n\t\t\tswitch(v & 0x07) {\n\t\t\t\tcase 0: v = (v >> 3) * 5000; break;\n\t\t\t\tcase 1: v = (v >> 3) * 500; break;\n\t\t\t\tcase 2: v = (v >> 3) / 20; break;\n\t\t\t\tcase 3: v = (v >> 3) / 200; break;\n\t\t\t\tcase 4: v = (v >> 3) / 2000; break;\n\t\t\t\tcase 5: v = (v >> 3) / 20000; break;\n\t\t\t\tcase 6: v = (v >> 3) / 16; break;\n\t\t\t\tcase 7: v = (v >> 3) / 64; break;\n\t\t\t}\n\t\t}\n\t\to[1].v = v;\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_17(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(4);\n\t\tvar v2 = blob.read_shift(4);\n\t\tvar e = blob.read_shift(2);\n\t\tif(e == 0xFFFF) {\n\t\t\tif(v1 === 0 && v2 === 0xC0000000) { o[1].t = \"e\"; o[1].v = 0x0F; } // ERR -> #VALUE!\n\t\t\telse if(v1 === 0 && v2 === 0xD0000000) { o[1].t = \"e\"; o[1].v = 0x2A; } // NA -> #N/A\n\t\t\telse o[1].v = 0;\n\t\t\treturn o;\n\t\t}\n\t\tvar s = e & 0x8000; e = (e&0x7FFF) - 16446;\n\t\to[1].v = (1 - s*2) * (v2 * Math.pow(2, e+32) + v1 * Math.pow(2, e));\n\t\treturn o;\n\t}\n\tfunction write_NUMBER_17(R, C, wsidx, v) {\n\t\tvar o = new_buf(14);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, wsidx);\n\t\to.write_shift(1, C);\n\t\tif(v == 0) {\n\t\t\to.write_shift(4, 0);\n\t\t\to.write_shift(4, 0);\n\t\t\to.write_shift(2, 0xFFFF);\n\t\t\treturn o;\n\t\t}\n\t\tvar s = 0, e = 0, v1 = 0, v2 = 0;\n\t\tif(v < 0) { s = 1; v = -v; }\n\t\te = Math.log2(v) | 0;\n\t\tv /= Math.pow(2, e-31);\n\t\tv2 = (v)>>>0;\n\t\tif((v2&0x80000000) == 0) { v/=2; ++e; v2 = v >>> 0; }\n\t\tv -= v2;\n\t\tv2 |= 0x80000000;\n\t\tv2 >>>= 0;\n\t\tv *= Math.pow(2, 32);\n\t\tv1 = v>>>0;\n\t\to.write_shift(4, v1);\n\t\to.write_shift(4, v2);\n\t\te += 0x3FFF + (s ? 0x8000 : 0);\n\t\to.write_shift(2, e);\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA_19(blob, length) {\n\t\tvar o = parse_NUMBER_17(blob, 14);\n\t\tblob.l += length - 14; /* TODO: WK3 formula */\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_25(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(4);\n\t\to[1].v = v1 >> 6;\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_27(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(8,'f');\n\t\to[1].v = v1;\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA_28(blob, length) {\n\t\tvar o = parse_NUMBER_27(blob, 12);\n\t\tblob.l += length - 12; /* TODO: formula */\n\t\treturn o;\n\t}\n\n\tfunction parse_SHEETNAMECS(blob, length) {\n\t\treturn blob[blob.l + length - 1] == 0 ? blob.read_shift(length, 'cstr') : \"\";\n\t}\n\n\tfunction parse_SHEETNAMELP(blob, length) {\n\t\tvar len = blob[blob.l++];\n\t\tif(len > length - 1) len = length - 1;\n\t\tvar o = \"\"; while(o.length < len) o += String.fromCharCode(blob[blob.l++]);\n\t\treturn o;\n\t}\n\n\tfunction parse_SHEETINFOQP(blob, length, opts) {\n\t\tif(!opts.qpro || length < 21) return;\n\t\tvar id = blob.read_shift(1);\n\t\tblob.l += 17;\n\t\tblob.l += 1; //var len = blob.read_shift(1);\n\t\tblob.l += 2;\n\t\tvar nm = blob.read_shift(length - 21, 'cstr');\n\t\treturn [id, nm];\n\t}\n\n\tfunction parse_XFORMAT(blob, length) {\n\t\tvar o = {}, tgt = blob.l + length;\n\t\twhile(blob.l < tgt) {\n\t\t\tvar dt = blob.read_shift(2);\n\t\t\tif(dt == 0x36b0) {\n\t\t\t\to[dt] = [0, \"\"];\n\t\t\t\to[dt][0] = blob.read_shift(2);\n\t\t\t\twhile(blob[blob.l]) { o[dt][1] += String.fromCharCode(blob[blob.l]); blob.l++; } blob.l++;\n\t\t\t}\n\t\t\t// TODO: 0x3a99 ??\n\t\t}\n\t\treturn o;\n\t}\n\tfunction write_XFORMAT_SHEETNAME(name, wsidx) {\n\t\tvar out = new_buf(5 + name.length);\n\t\tout.write_shift(2, 0x36b0);\n\t\tout.write_shift(2, wsidx);\n\t\tfor(var i = 0; i < name.length; ++i) {\n\t\t\tvar cc = name.charCodeAt(i);\n\t\t\tout[out.l++] = cc > 0x7F ? 0x5F : cc;\n\t\t}\n\t\tout[out.l++] = 0;\n\t\treturn out;\n\t}\n\n\tvar WK1Enum = {\n\t\t0x0000: { n:\"BOF\", f:parseuint16 },\n\t\t0x0001: { n:\"EOF\" },\n\t\t0x0002: { n:\"CALCMODE\" },\n\t\t0x0003: { n:\"CALCORDER\" },\n\t\t0x0004: { n:\"SPLIT\" },\n\t\t0x0005: { n:\"SYNC\" },\n\t\t0x0006: { n:\"RANGE\", f:parse_RANGE },\n\t\t0x0007: { n:\"WINDOW1\" },\n\t\t0x0008: { n:\"COLW1\" },\n\t\t0x0009: { n:\"WINTWO\" },\n\t\t0x000A: { n:\"COLW2\" },\n\t\t0x000B: { n:\"NAME\" },\n\t\t0x000C: { n:\"BLANK\" },\n\t\t0x000D: { n:\"INTEGER\", f:parse_INTEGER },\n\t\t0x000E: { n:\"NUMBER\", f:parse_NUMBER },\n\t\t0x000F: { n:\"LABEL\", f:parse_LABEL },\n\t\t0x0010: { n:\"FORMULA\", f:parse_FORMULA },\n\t\t0x0018: { n:\"TABLE\" },\n\t\t0x0019: { n:\"ORANGE\" },\n\t\t0x001A: { n:\"PRANGE\" },\n\t\t0x001B: { n:\"SRANGE\" },\n\t\t0x001C: { n:\"FRANGE\" },\n\t\t0x001D: { n:\"KRANGE1\" },\n\t\t0x0020: { n:\"HRANGE\" },\n\t\t0x0023: { n:\"KRANGE2\" },\n\t\t0x0024: { n:\"PROTEC\" },\n\t\t0x0025: { n:\"FOOTER\" },\n\t\t0x0026: { n:\"HEADER\" },\n\t\t0x0027: { n:\"SETUP\" },\n\t\t0x0028: { n:\"MARGINS\" },\n\t\t0x0029: { n:\"LABELFMT\" },\n\t\t0x002A: { n:\"TITLES\" },\n\t\t0x002B: { n:\"SHEETJS\" },\n\t\t0x002D: { n:\"GRAPH\" },\n\t\t0x002E: { n:\"NGRAPH\" },\n\t\t0x002F: { n:\"CALCCOUNT\" },\n\t\t0x0030: { n:\"UNFORMATTED\" },\n\t\t0x0031: { n:\"CURSORW12\" },\n\t\t0x0032: { n:\"WINDOW\" },\n\t\t0x0033: { n:\"STRING\", f:parse_STRING },\n\t\t0x0037: { n:\"PASSWORD\" },\n\t\t0x0038: { n:\"LOCKED\" },\n\t\t0x003C: { n:\"QUERY\" },\n\t\t0x003D: { n:\"QUERYNAME\" },\n\t\t0x003E: { n:\"PRINT\" },\n\t\t0x003F: { n:\"PRINTNAME\" },\n\t\t0x0040: { n:\"GRAPH2\" },\n\t\t0x0041: { n:\"GRAPHNAME\" },\n\t\t0x0042: { n:\"ZOOM\" },\n\t\t0x0043: { n:\"SYMSPLIT\" },\n\t\t0x0044: { n:\"NSROWS\" },\n\t\t0x0045: { n:\"NSCOLS\" },\n\t\t0x0046: { n:\"RULER\" },\n\t\t0x0047: { n:\"NNAME\" },\n\t\t0x0048: { n:\"ACOMM\" },\n\t\t0x0049: { n:\"AMACRO\" },\n\t\t0x004A: { n:\"PARSE\" },\n\t\t// 0x0064\n\t\t0x0066: { n:\"PRANGES??\" },\n\t\t0x0067: { n:\"RRANGES??\" },\n\t\t0x0068: { n:\"FNAME??\" },\n\t\t0x0069: { n:\"MRANGES??\" },\n\t\t// 0x0096\n\t\t// 0x0099\n\t\t// 0x009A\n\t\t// 0x009B\n\t\t// 0x009C\n\t\t// 0x00C0\n\t\t// 0x00C7\n\t\t// 0x00C9\n\t\t0x00CC: { n:\"SHEETNAMECS\", f:parse_SHEETNAMECS },\n\t\t// 0x00CD\n\t\t0x00DE: { n:\"SHEETNAMELP\", f:parse_SHEETNAMELP },\n\t\t0x00FF: { n:\"BOF\", f:parseuint16 },\n\t\t0x5402: { n:\"WKSNF\", f:parseuint16 },\n\t\t0xFFFF: { n:\"\" }\n\t};\n\n\tvar WK3Enum = {\n\t\t0x0000: { n:\"BOF\" },\n\t\t0x0001: { n:\"EOF\" },\n\t\t0x0002: { n:\"PASSWORD\" },\n\t\t0x0003: { n:\"CALCSET\" },\n\t\t0x0004: { n:\"WINDOWSET\" },\n\t\t0x0005: { n:\"SHEETCELLPTR\" },\n\t\t0x0006: { n:\"SHEETLAYOUT\" },\n\t\t0x0007: { n:\"COLUMNWIDTH\" },\n\t\t0x0008: { n:\"HIDDENCOLUMN\" },\n\t\t0x0009: { n:\"USERRANGE\" },\n\t\t0x000A: { n:\"SYSTEMRANGE\" },\n\t\t0x000B: { n:\"ZEROFORCE\" },\n\t\t0x000C: { n:\"SORTKEYDIR\" },\n\t\t0x000D: { n:\"FILESEAL\" },\n\t\t0x000E: { n:\"DATAFILLNUMS\" },\n\t\t0x000F: { n:\"PRINTMAIN\" },\n\t\t0x0010: { n:\"PRINTSTRING\" },\n\t\t0x0011: { n:\"GRAPHMAIN\" },\n\t\t0x0012: { n:\"GRAPHSTRING\" },\n\t\t0x0013: { n:\"??\" },\n\t\t0x0014: { n:\"ERRCELL\" },\n\t\t0x0015: { n:\"NACELL\" },\n\t\t0x0016: { n:\"LABEL16\", f:parse_LABEL_16},\n\t\t0x0017: { n:\"NUMBER17\", f:parse_NUMBER_17 },\n\t\t0x0018: { n:\"NUMBER18\", f:parse_NUMBER_18 },\n\t\t0x0019: { n:\"FORMULA19\", f:parse_FORMULA_19},\n\t\t0x001A: { n:\"FORMULA1A\" },\n\t\t0x001B: { n:\"XFORMAT\", f:parse_XFORMAT },\n\t\t0x001C: { n:\"DTLABELMISC\" },\n\t\t0x001D: { n:\"DTLABELCELL\" },\n\t\t0x001E: { n:\"GRAPHWINDOW\" },\n\t\t0x001F: { n:\"CPA\" },\n\t\t0x0020: { n:\"LPLAUTO\" },\n\t\t0x0021: { n:\"QUERY\" },\n\t\t0x0022: { n:\"HIDDENSHEET\" },\n\t\t0x0023: { n:\"??\" },\n\t\t0x0025: { n:\"NUMBER25\", f:parse_NUMBER_25 },\n\t\t0x0026: { n:\"??\" },\n\t\t0x0027: { n:\"NUMBER27\", f:parse_NUMBER_27 },\n\t\t0x0028: { n:\"FORMULA28\", f:parse_FORMULA_28 },\n\t\t0x008E: { n:\"??\" },\n\t\t0x0093: { n:\"??\" },\n\t\t0x0096: { n:\"??\" },\n\t\t0x0097: { n:\"??\" },\n\t\t0x0098: { n:\"??\" },\n\t\t0x0099: { n:\"??\" },\n\t\t0x009A: { n:\"??\" },\n\t\t0x009B: { n:\"??\" },\n\t\t0x009C: { n:\"??\" },\n\t\t0x00A3: { n:\"??\" },\n\t\t0x00AE: { n:\"??\" },\n\t\t0x00AF: { n:\"??\" },\n\t\t0x00B0: { n:\"??\" },\n\t\t0x00B1: { n:\"??\" },\n\t\t0x00B8: { n:\"??\" },\n\t\t0x00B9: { n:\"??\" },\n\t\t0x00BA: { n:\"??\" },\n\t\t0x00BB: { n:\"??\" },\n\t\t0x00BC: { n:\"??\" },\n\t\t0x00C3: { n:\"??\" },\n\t\t0x00C9: { n:\"??\" },\n\t\t0x00CC: { n:\"SHEETNAMECS\", f:parse_SHEETNAMECS },\n\t\t0x00CD: { n:\"??\" },\n\t\t0x00CE: { n:\"??\" },\n\t\t0x00CF: { n:\"??\" },\n\t\t0x00D0: { n:\"??\" },\n\t\t0x0100: { n:\"??\" },\n\t\t0x0103: { n:\"??\" },\n\t\t0x0104: { n:\"??\" },\n\t\t0x0105: { n:\"??\" },\n\t\t0x0106: { n:\"??\" },\n\t\t0x0107: { n:\"??\" },\n\t\t0x0109: { n:\"??\" },\n\t\t0x010A: { n:\"??\" },\n\t\t0x010B: { n:\"??\" },\n\t\t0x010C: { n:\"??\" },\n\t\t0x010E: { n:\"??\" },\n\t\t0x010F: { n:\"??\" },\n\t\t0x0180: { n:\"??\" },\n\t\t0x0185: { n:\"??\" },\n\t\t0x0186: { n:\"??\" },\n\t\t0x0189: { n:\"??\" },\n\t\t0x018C: { n:\"??\" },\n\t\t0x0200: { n:\"??\" },\n\t\t0x0202: { n:\"??\" },\n\t\t0x0201: { n:\"??\" },\n\t\t0x0204: { n:\"??\" },\n\t\t0x0205: { n:\"??\" },\n\t\t0x0280: { n:\"??\" },\n\t\t0x0281: { n:\"??\" },\n\t\t0x0282: { n:\"??\" },\n\t\t0x0283: { n:\"??\" },\n\t\t0x0284: { n:\"??\" },\n\t\t0x0285: { n:\"??\" },\n\t\t0x0286: { n:\"??\" },\n\t\t0x0287: { n:\"??\" },\n\t\t0x0288: { n:\"??\" },\n\t\t0x0292: { n:\"??\" },\n\t\t0x0293: { n:\"??\" },\n\t\t0x0294: { n:\"??\" },\n\t\t0x0295: { n:\"??\" },\n\t\t0x0296: { n:\"??\" },\n\t\t0x0299: { n:\"??\" },\n\t\t0x029A: { n:\"??\" },\n\t\t0x0300: { n:\"??\" },\n\t\t0x0304: { n:\"??\" },\n\t\t0x0601: { n:\"SHEETINFOQP\", f:parse_SHEETINFOQP },\n\t\t0x0640: { n:\"??\" },\n\t\t0x0642: { n:\"??\" },\n\t\t0x0701: { n:\"??\" },\n\t\t0x0702: { n:\"??\" },\n\t\t0x0703: { n:\"??\" },\n\t\t0x0704: { n:\"??\" },\n\t\t0x0780: { n:\"??\" },\n\t\t0x0800: { n:\"??\" },\n\t\t0x0801: { n:\"??\" },\n\t\t0x0804: { n:\"??\" },\n\t\t0x0A80: { n:\"??\" },\n\t\t0x2AF6: { n:\"??\" },\n\t\t0x3231: { n:\"??\" },\n\t\t0x6E49: { n:\"??\" },\n\t\t0x6F44: { n:\"??\" },\n\t\t0xFFFF: { n:\"\" }\n\t};\n\n\t/* TODO: fill out and verify this table across QP versions */\n\tvar QPWNFTable = {\n\t\t0x05: \"dd-mmm-yy\",\n\t\t0x06: \"dd-mmm\",\n\t\t0x07: \"mmm-yy\",\n\t\t0x08: \"mm/dd/yy\", // Long Date Intl\n\t\t0x0A: \"hh:mm:ss AM/PM\",\n\t\t0x0B: \"hh:mm AM/PM\",\n\t\t0x0E: \"dd-mmm-yyyy\",\n\t\t0x0F: \"mmm-yyyy\",\n\n\t\t/* It is suspected that the the low nybble specifies decimal places */\n\t\t0x0022: \"0.00\",\n\t\t0x0032: \"0.00;[Red]0.00\",\n\t\t0x0042: \"0.00;\\(0.00\\)\",\n\t\t0x0052: \"0.00;[Red]\\(0.00\\)\",\n\t\t0x00A2: '\"$\"#,##0.00;\\\\(\"$\"#,##0.00\\\\)',\n\t\t0x0120: '0%',\n\t\t0x0130: '0E+00',\n\t\t0x0140: '# ?/?'\n\t};\n\n\tfunction parse_qpw_str(p) {\n\t\tvar cch = p.read_shift(2);\n\t\tvar flags = p.read_shift(1);\n\t\t/* TODO: find examples with nonzero flags */\n\t\tif(flags != 0) throw \"unsupported QPW string type \" + flags.toString(16);\n\t\treturn p.read_shift(cch, \"sbcs-cont\");\n\t}\n\n\t/* QPW uses a different set of record types */\n\tfunction qpw_to_workbook_buf(d, opts)/*:Workbook*/ {\n\t\tprep_blob(d, 0);\n\t\tvar o = opts || {};\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar s/*:Worksheet*/ = ({}/*:any*/); if(o.dense) s[\"!data\"] = [];\n\t\tvar SST = [], sname = \"\", formulae = [];\n\t\tvar range = {s:{r:-1,c:-1}, e:{r:-1,c:-1}};\n\t\tvar cnt = 0, type = 0, C = 0, R = 0;\n\t\tvar wb = { SheetNames: [], Sheets: {} };\n\t\tvar FMTS = [];\n\t\touter: while(d.l < d.length) {\n\t\t\tvar RT = d.read_shift(2), length = d.read_shift(2);\n\t\t\tvar p = d.slice(d.l, d.l + length);\n\t\t\tprep_blob(p, 0);\n\t\t\tswitch(RT) {\n\t\t\t\tcase 0x01: /* BOF */\n\t\t\t\t\tif(p.read_shift(4) != 0x39575051) throw \"Bad QPW9 BOF!\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x02: /* EOF */ break outer;\n\n\t\t\t\tcase 0x08: /* NF */ break; // TODO: this is tied to custom number formats\n\n\t\t\t\tcase 0x0A: /* FORMATS */ {\n\t\t\t\t\tvar fcnt = p.read_shift(4);\n\t\t\t\t\tvar step = ((p.length - p.l)/ fcnt)|0;\n\t\t\t\t\tfor(var ifmt = 0; ifmt < fcnt; ++ifmt) {\n\t\t\t\t\t\tvar end = p.l + step;\n\t\t\t\t\t\tvar fmt = {};\n\t\t\t\t\t\tp.l += 2;\n\t\t\t\t\t\tfmt.numFmtId = p.read_shift(2);\n\t\t\t\t\t\tif(QPWNFTable[fmt.numFmtId]) fmt.z = QPWNFTable[fmt.numFmtId];\n\t\t\t\t\t\tp.l = end;\n\t\t\t\t\t\tFMTS.push(fmt);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\n\t\t\t\t/* TODO: The behavior here should be consistent with Numbers: QP Notebook ~ .TN.SheetArchive, QP Sheet ~ .TST.TableModelArchive */\n\t\t\t\tcase 0x0401: /* BON */ break;\n\t\t\t\tcase 0x0402: /* EON */ /* TODO: backfill missing sheets based on BON cnt */ break;\n\n\t\t\t\tcase 0x0407: { /* SST */\n\t\t\t\t\tp.l += 12;\n\t\t\t\t\twhile(p.l < p.length) {\n\t\t\t\t\t\tcnt = p.read_shift(2);\n\t\t\t\t\t\ttype = p.read_shift(1);\n\t\t\t\t\t\tSST.push(p.read_shift(cnt, 'cstr'));\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0408: { /* FORMULAE */\n\t\t\t\t\t//p.l += 12;\n\t\t\t\t\t//while(p.l < p.length) {\n\t\t\t\t\t//\tcnt = p.read_shift(2);\n\t\t\t\t\t//\tformulae.push(p.slice(p.l, p.l + cnt + 1)); p.l += cnt + 1;\n\t\t\t\t\t//}\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x0601: { /* BOS */\n\t\t\t\t\tvar sidx = p.read_shift(2);\n\t\t\t\t\ts = ({}/*:any*/); if(o.dense) s[\"!data\"] = [];\n\t\t\t\t\trange.s.c = p.read_shift(2);\n\t\t\t\t\trange.e.c = p.read_shift(2);\n\t\t\t\t\trange.s.r = p.read_shift(4);\n\t\t\t\t\trange.e.r = p.read_shift(4);\n\t\t\t\t\tp.l += 4;\n\t\t\t\t\tif(p.l + 2 < p.length) {\n\t\t\t\t\t\tcnt = p.read_shift(2);\n\t\t\t\t\t\ttype = p.read_shift(1);\n\t\t\t\t\t\tsname = cnt == 0 ? \"\" : p.read_shift(cnt, 'cstr');\n\t\t\t\t\t}\n\t\t\t\t\tif(!sname) sname = encode_col(sidx);\n\t\t\t\t\t/* TODO: backfill empty sheets */\n\t\t\t\t} break;\n\t\t\t\tcase 0x0602: { /* EOS */\n\t\t\t\t\t/* NOTE: QP valid range A1:IV1000000 */\n\t\t\t\t\tif(range.s.c > 0xFF || range.s.r > 999999) break;\n\t\t\t\t\tif(range.e.c < range.s.c) range.e.c = range.s.c;\n\t\t\t\t\tif(range.e.r < range.s.r) range.e.r = range.s.r;\n\t\t\t\t\ts[\"!ref\"] = encode_range(range);\n\t\t\t\t\tbook_append_sheet(wb, s, sname); // TODO: a barrel roll\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x0A01: { /* COL (like XLS Row, modulo the layout transposition) */\n\t\t\t\t\tC = p.read_shift(2);\n\t\t\t\t\tif(range.e.c < C) range.e.c = C;\n\t\t\t\t\tif(range.s.c > C) range.s.c = C;\n\t\t\t\t\tR = p.read_shift(4);\n\t\t\t\t\tif(range.s.r > R) range.s.r = R;\n\t\t\t\t\tR = p.read_shift(4);\n\t\t\t\t\tif(range.e.r < R) range.e.r = R;\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x0C01: { /* MulCells (like XLS MulRK, but takes advantage of common column data patterns) */\n\t\t\t\t\tR = p.read_shift(4), cnt = p.read_shift(4);\n\t\t\t\t\tif(range.s.r > R) range.s.r = R;\n\t\t\t\t\tif(range.e.r < R + cnt - 1) range.e.r = R + cnt - 1;\n\t\t\t\t\tvar CC = encode_col(C);\n\t\t\t\t\twhile(p.l < p.length) {\n\t\t\t\t\t\tvar cell = { t: \"z\" };\n\t\t\t\t\t\tvar flags = p.read_shift(1), fmtidx = -1;\n\t\t\t\t\t\tif(flags & 0x80) fmtidx = p.read_shift(2);\n\t\t\t\t\t\tvar mul = (flags & 0x40) ? p.read_shift(2) - 1: 0;\n\t\t\t\t\t\tswitch(flags & 0x1F) {\n\t\t\t\t\t\t\tcase 0: break;\n\t\t\t\t\t\t\tcase 1: break;\n\t\t\t\t\t\t\tcase 2: cell = { t: \"n\", v: p.read_shift(2) }; break;\n\t\t\t\t\t\t\tcase 3: cell = { t: \"n\", v: p.read_shift(2, 'i') }; break;\n\t\t\t\t\t\t\tcase 4: cell = { t: \"n\", v: parse_RkNumber(p) }; break;\n\t\t\t\t\t\t\tcase 5: cell = { t: \"n\", v: p.read_shift(8, 'f') }; break;\n\t\t\t\t\t\t\tcase 7: cell = { t: \"s\", v: SST[type = p.read_shift(4) - 1] }; break;\n\t\t\t\t\t\t\tcase 8:\n\t\t\t\t\t\t\t\tcell = { t: \"n\", v: p.read_shift(8, 'f') };\n\t\t\t\t\t\t\t\tp.l += 2; /* cell.f = formulae[p.read_shift(4)]; */ p.l += 4;\n\t\t\t\t\t\t\t\tif(isNaN(cell.v)) cell = { t: \"e\", v: 0x0F }; // #VALUE!\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault: throw \"Unrecognized QPW cell type \" + (flags & 0x1F);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(fmtidx != -1 && (FMTS[fmtidx - 1]||{}).z) cell.z = FMTS[fmtidx-1].z;\n\t\t\t\t\t\tvar delta = 0;\n\t\t\t\t\t\tif(flags & 0x20) switch(flags & 0x1F) {\n\t\t\t\t\t\t\tcase 2: delta = p.read_shift(2); break;\n\t\t\t\t\t\t\tcase 3: delta = p.read_shift(2, 'i'); break;\n\t\t\t\t\t\t\tcase 7: delta = p.read_shift(2); break;\n\t\t\t\t\t\t\tdefault: throw \"Unsupported delta for QPW cell type \" + (flags & 0x1F);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!(!o.sheetStubs && cell.t == \"z\")) {\n\t\t\t\t\t\t\tvar newcell = dup(cell);\n\t\t\t\t\t\t\tif(cell.t == \"n\" && cell.z && fmt_is_date(cell.z) && o.cellDates) {\n\t\t\t\t\t\t\t\tnewcell.v = numdate(cell.v); newcell.t = typeof newcell.v == \"number\" ? 'n' : 'd';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(s[\"!data\"] != null) {\n\t\t\t\t\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\t\t\t\t\ts[\"!data\"][R][C] = newcell;\n\t\t\t\t\t\t\t} else s[CC + encode_row(R)] = newcell;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t++R; --cnt;\n\t\t\t\t\t\twhile(mul-- > 0 && cnt >= 0) {\n\t\t\t\t\t\t\tif(flags & 0x20) switch(flags & 0x1F) {\n\t\t\t\t\t\t\t\tcase 2: cell = { t: \"n\", v: (cell.v + delta) & 0xFFFF }; break;\n\t\t\t\t\t\t\t\tcase 3: cell = { t: \"n\", v: (cell.v + delta) & 0xFFFF }; if(cell.v > 0x7FFF) cell.v -= 0x10000; break;\n\t\t\t\t\t\t\t\tcase 7: cell = { t: \"s\", v: SST[type = (type + delta) >>> 0] }; break;\n\t\t\t\t\t\t\t\tdefault: throw \"Cannot apply delta for QPW cell type \" + (flags & 0x1F);\n\t\t\t\t\t\t\t} else switch(flags & 0x1F) {\n\t\t\t\t\t\t\t\tcase 1: cell = { t: \"z\" }; break;\n\t\t\t\t\t\t\t\tcase 2: cell = { t: \"n\", v: p.read_shift(2) }; break;\n\t\t\t\t\t\t\t\tcase 7: cell = { t: \"s\", v: SST[type = p.read_shift(4) - 1] }; break;\n\t\t\t\t\t\t\t\tdefault: throw \"Cannot apply repeat for QPW cell type \" + (flags & 0x1F);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(fmtidx != -1);\n\t\t\t\t\t\t\tif(!(!o.sheetStubs && cell.t == \"z\")) {\n\t\t\t\t\t\t\t\tif(s[\"!data\"] != null) {\n\t\t\t\t\t\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\t\t\t\t\t\ts[\"!data\"][R][C] = cell;\n\t\t\t\t\t\t\t\t} else s[CC + encode_row(R)] = cell;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t++R; --cnt;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x0C02: { /* String (result of string formula expression) */\n\t\t\t\t\tC = p.read_shift(2);\n\t\t\t\t\tR = p.read_shift(4);\n\t\t\t\t\tvar str = parse_qpw_str(p);\n\t\t\t\t\t/* TODO: QP10 record has an additional unknown character after the string */\n\t\t\t\t\tif(s[\"!data\"] != null) {\n\t\t\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\t\t\ts[\"!data\"][R][C] = { t:\"s\", v:str };\n\t\t\t\t\t} else s[encode_col(C) + encode_row(R)] = { t:\"s\", v:str };\n\t\t\t\t} break;\n\n\t\t\t\tdefault: break;\n\t\t\t}\n\t\t\td.l += length;\n\t\t}\n\t\treturn wb;\n\t}\n\n\treturn {\n\t\tsheet_to_wk1: sheet_to_wk1,\n\t\tbook_to_wk3: book_to_wk3,\n\t\tto_workbook: lotus_to_workbook\n\t};\n})();\n/* 18.4.7 rPr CT_RPrElt */\nfunction parse_rpr(rpr) {\n\tvar font = {}, m = rpr.match(tagregex), i = 0;\n\tvar pass = false;\n\tif(m) for(;i!=m.length; ++i) {\n\t\tvar y = parsexmltag(m[i]);\n\t\tswitch(y[0].replace(/<\\w*:/g,\"<\")) {\n\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<condense': break;\n\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<extend': break;\n\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<shadow':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<shadow>':\n\t\t\tcase '<shadow/>': font.shadow = 1; break;\n\t\t\tcase '</shadow>': break;\n\n\t\t\t/* 18.4.1 charset CT_IntProperty TODO */\n\t\t\tcase '<charset':\n\t\t\t\tif(y.val == '1') break;\n\t\t\t\tfont.cp = CS2CP[parseInt(y.val, 10)];\n\t\t\t\tbreak;\n\n\t\t\t/* 18.4.2 outline CT_BooleanProperty TODO */\n\t\t\tcase '<outline':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<outline>':\n\t\t\tcase '<outline/>': font.outline = 1; break;\n\t\t\tcase '</outline>': break;\n\n\t\t\t/* 18.4.5 rFont CT_FontName */\n\t\t\tcase '<rFont': font.name = y.val; break;\n\n\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\tcase '<sz': font.sz = y.val; break;\n\n\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\tcase '<strike':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<strike>':\n\t\t\tcase '<strike/>': font.strike = 1; break;\n\t\t\tcase '</strike>': break;\n\n\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\tcase '<u':\n\t\t\t\tif(!y.val) break;\n\t\t\t\tswitch(y.val) {\n\t\t\t\t\tcase 'double': font.uval = \"double\"; break;\n\t\t\t\t\tcase 'singleAccounting': font.uval = \"single-accounting\"; break;\n\t\t\t\t\tcase 'doubleAccounting': font.uval = \"double-accounting\"; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '<u>':\n\t\t\tcase '<u/>': font.u = 1; break;\n\t\t\tcase '</u>': break;\n\n\t\t\t/* 18.8.2 b */\n\t\t\tcase '<b':\n\t\t\t\tif(y.val == '0') break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<b>':\n\t\t\tcase '<b/>': font.b = 1; break;\n\t\t\tcase '</b>': break;\n\n\t\t\t/* 18.8.26 i */\n\t\t\tcase '<i':\n\t\t\t\tif(y.val == '0') break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<i>':\n\t\t\tcase '<i/>': font.i = 1; break;\n\t\t\tcase '</i>': break;\n\n\t\t\t/* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\t\t\tcase '<color':\n\t\t\t\tif(y.rgb) font.color = y.rgb.slice(2,8);\n\t\t\t\tbreak;\n\t\t\tcase '<color>': case '<color/>': case '</color>': break;\n\n\t\t\t/* 18.8.18 family ST_FontFamily */\n\t\t\tcase '<family': font.family = y.val; break;\n\t\t\tcase '<family>': case '<family/>': case '</family>': break;\n\n\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\t\t\tcase '<vertAlign': font.valign = y.val; break;\n\t\t\tcase '<vertAlign>': case '<vertAlign/>': case '</vertAlign>': break;\n\n\t\t\t/* 18.8.35 scheme CT_FontScheme TODO */\n\t\t\tcase '<scheme': break;\n\t\t\tcase '<scheme>': case '<scheme/>': case '</scheme>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault:\n\t\t\t\tif(y[0].charCodeAt(1) !== 47 && !pass) throw new Error('Unrecognized rich format ' + y[0]);\n\t\t}\n\t}\n\treturn font;\n}\n\nvar parse_rs = /*#__PURE__*/(function() {\n\t/* 18.4.4 r CT_RElt */\n\tfunction parse_r(r) {\n\t\t/* 18.4.12 t ST_Xstring */\n\t\tvar t = str_match_xml_ns(r, \"t\")/*, cp = 65001*/;\n\t\tif(!t) return {t:\"s\", v:\"\"};\n\n\t\tvar o/*:Cell*/ = ({t:'s', v:unescapexml(t[1])}/*:any*/);\n\t\tvar rpr = str_match_xml_ns(r, \"rPr\");\n\t\tif(rpr) o.s = parse_rpr(rpr[1]);\n\t\treturn o;\n\t}\n\tvar rregex = /<(?:\\w+:)?r>/g, rend = /<\\/(?:\\w+:)?r>/;\n\treturn function parse_rs(rs) {\n\t\treturn rs.replace(rregex,\"\").split(rend).map(parse_r).filter(function(r) { return r.v; });\n\t};\n})();\n\n\n/* Parse a list of <r> tags */\nvar rs_to_html = /*#__PURE__*/(function parse_rs_factory() {\n\tvar nlregex = /(\\r\\n|\\n)/g;\n\tfunction parse_rpr2(font, intro, outro) {\n\t\tvar style/*:Array<string>*/ = [];\n\n\t\tif(font.u) style.push(\"text-decoration: underline;\");\n\t\tif(font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\n\t\tif(font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\n\t\tif(font.outline) style.push(\"text-effect: outline;\");\n\t\tif(font.shadow) style.push(\"text-shadow: auto;\");\n\t\tintro.push('<span style=\"' + style.join(\"\") + '\">');\n\n\t\tif(font.b) { intro.push(\"<b>\"); outro.push(\"</b>\"); }\n\t\tif(font.i) { intro.push(\"<i>\"); outro.push(\"</i>\"); }\n\t\tif(font.strike) { intro.push(\"<s>\"); outro.push(\"</s>\"); }\n\n\t\tvar align = font.valign || \"\";\n\t\tif(align == \"superscript\" || align == \"super\") align = \"sup\";\n\t\telse if(align == \"subscript\") align = \"sub\";\n\t\tif(align != \"\") { intro.push(\"<\" + align + \">\"); outro.push(\"</\" + align + \">\"); }\n\n\t\toutro.push(\"</span>\");\n\t\treturn font;\n\t}\n\n\t/* 18.4.4 r CT_RElt */\n\tfunction r_to_html(r) {\n\t\tvar terms/*:[Array<string>, string, Array<string>]*/ = [[],r.v,[]];\n\t\tif(!r.v) return \"\";\n\n\t\tif(r.s) parse_rpr2(r.s, terms[0], terms[2]);\n\n\t\treturn terms[0].join(\"\") + terms[1].replace(nlregex,'<br/>') + terms[2].join(\"\");\n\t}\n\n\treturn function parse_rs(rs) {\n\t\treturn rs.map(r_to_html).join(\"\");\n\t};\n})();\n\n/* 18.4.8 si CT_Rst */\nvar sitregex = /<(?:\\w+:)?t\\b[^<>]*>([^<]*)<\\/(?:\\w+:)?t>/g, sirregex = /<(?:\\w+:)?r\\b[^<>]*>/;\nfunction parse_si(x, opts) {\n\tvar html = opts ? opts.cellHTML : true;\n\tvar z = {};\n\tif(!x) return { t: \"\" };\n\t//var y;\n\t/* 18.4.12 t ST_Xstring (Plaintext String) */\n\t// TODO: is whitespace actually valid here?\n\tif(x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\n\t\tz.t = unescapexml(utf8read(x.slice(x.indexOf(\">\")+1).split(/<\\/(?:\\w+:)?t>/)[0]||\"\"), true);\n\t\tz.r = utf8read(x);\n\t\tif(html) z.h = escapehtml(z.t);\n\t}\n\t/* 18.4.4 r CT_RElt (Rich Text Run) */\n\telse if((/*y = */x.match(sirregex))) {\n\t\tz.r = utf8read(x);\n\t\tz.t = unescapexml(utf8read((str_remove_xml_ns_g(x, \"rPh\").match(sitregex)||[]).join(\"\").replace(tagregex,\"\")), true);\n\t\tif(html) z.h = rs_to_html(parse_rs(z.r));\n\t}\n\t/* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\t/* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\treturn z;\n}\n\n/* 18.4 Shared String Table */\nvar sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\nvar sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\nfunction parse_sst_xml(data/*:string*/, opts)/*:SST*/ {\n\tvar s/*:SST*/ = ([]/*:any*/), ss = \"\";\n\tif(!data) return s;\n\t/* 18.4.9 sst CT_Sst */\n\tvar sst = str_match_xml_ns(data, \"sst\");\n\tif(sst) {\n\t\tss = sst[1].replace(sstr1,\"\").split(sstr2);\n\t\tfor(var i = 0; i != ss.length; ++i) {\n\t\t\tvar o = parse_si(ss[i].trim(), opts);\n\t\t\tif(o != null) s[s.length] = o;\n\t\t}\n\t\tsst = parsexmltag(sst[0].slice(0, sst[0].indexOf(\">\"))); s.Count = sst.count; s.Unique = sst.uniqueCount;\n\t}\n\treturn s;\n}\n\nvar straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\nfunction write_sst_xml(sst/*:SST*/, opts)/*:string*/ {\n\tif(!opts.bookSST) return \"\";\n\tvar o = [XML_HEADER];\n\to[o.length] = (writextag('sst', null, {\n\t\txmlns: XMLNS_main[0],\n\t\tcount: sst.Count,\n\t\tuniqueCount: sst.Unique\n\t}));\n\tfor(var i = 0; i != sst.length; ++i) { if(sst[i] == null) continue;\n\t\tvar s/*:XLString*/ = sst[i];\n\t\tvar sitag = \"<si>\";\n\t\tif(s.r) sitag += s.r;\n\t\telse {\n\t\t\tsitag += \"<t\";\n\t\t\tif(!s.t) s.t = \"\";\n\t\t\tif(typeof s.t !== \"string\") s.t = String(s.t);\n\t\t\tif(s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n\t\t\tsitag += \">\" + escapexml(s.t) + \"</t>\";\n\t\t}\n\t\tsitag += \"</si>\";\n\t\to[o.length] = (sitag);\n\t}\n\tif(o.length>2){ o[o.length] = ('</sst>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.221 BrtBeginSst */\nfunction parse_BrtBeginSst(data) {\n\treturn [data.read_shift(4), data.read_shift(4)];\n}\n\n/* [MS-XLSB] 2.1.7.45 Shared Strings */\nfunction parse_sst_bin(data, opts)/*:SST*/ {\n\tvar s/*:SST*/ = ([]/*:any*/);\n\tvar pass = false;\n\trecordhopper(data, function hopper_sst(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x009F: /* BrtBeginSst */\n\t\t\t\ts.Count = val[0]; s.Unique = val[1]; break;\n\t\t\tcase 0x0013: /* BrtSSTItem */\n\t\t\t\ts.push(val); break;\n\t\t\tcase 0x00A0: /* BrtEndSst */\n\t\t\t\treturn true;\n\n\t\t\tcase 0x0023: /* BrtFRTBegin */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* BrtFRTEnd */\n\t\t\t\tpass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){}\n\t\t\t\tif(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn s;\n}\n\nfunction write_BrtBeginSst(sst, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(4, sst.Count);\n\to.write_shift(4, sst.Unique);\n\treturn o;\n}\n\nvar write_BrtSSTItem = write_RichStr;\n\nfunction write_sst_bin(sst/*::, opts*/) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x009F /* BrtBeginSst */, write_BrtBeginSst(sst));\n\tfor(var i = 0; i < sst.length; ++i) write_record(ba, 0x0013 /* BrtSSTItem */, write_BrtSSTItem(sst[i]));\n\t/* FRTSST */\n\twrite_record(ba, 0x00A0 /* BrtEndSst */);\n\treturn ba.end();\n}\nfunction _JS2ANSI(str/*:string*/)/*:Array<number>*/ {\n\tif(typeof $cptable !== 'undefined') return $cptable.utils.encode(current_ansi, str);\n\tvar o/*:Array<number>*/ = [], oo = str.split(\"\");\n\tfor(var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.4 Version */\nfunction parse_CRYPTOVersion(blob, length/*:?number*/) {\n\tvar o/*:any*/ = {};\n\to.Major = blob.read_shift(2);\n\to.Minor = blob.read_shift(2);\n\t/*:: if(length == null) return o; */\n\tif(length >= 4) blob.l += length - 4;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.5 DataSpaceVersionInfo */\nfunction parse_DataSpaceVersionInfo(blob) {\n\tvar o = {};\n\to.id = blob.read_shift(0, 'lpp4');\n\to.R = parse_CRYPTOVersion(blob, 4);\n\to.U = parse_CRYPTOVersion(blob, 4);\n\to.W = parse_CRYPTOVersion(blob, 4);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.6.1 DataSpaceMapEntry Structure */\nfunction parse_DataSpaceMapEntry(blob) {\n\tvar len = blob.read_shift(4);\n\tvar end = blob.l + len - 4;\n\tvar o = {};\n\tvar cnt = blob.read_shift(4);\n\tvar comps/*:Array<{t:number, v:string}>*/ = [];\n\t/* [MS-OFFCRYPTO] 2.1.6.2 DataSpaceReferenceComponent Structure */\n\twhile(cnt-- > 0) comps.push({ t: blob.read_shift(4), v: blob.read_shift(0, 'lpp4') });\n\to.name = blob.read_shift(0, 'lpp4');\n\to.comps = comps;\n\tif(blob.l != end) throw new Error(\"Bad DataSpaceMapEntry: \" + blob.l + \" != \" + end);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.6 DataSpaceMap */\nfunction parse_DataSpaceMap(blob) {\n\tvar o = [];\n\tblob.l += 4; // must be 0x8\n\tvar cnt = blob.read_shift(4);\n\twhile(cnt-- > 0) o.push(parse_DataSpaceMapEntry(blob));\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.7 DataSpaceDefinition */\nfunction parse_DataSpaceDefinition(blob)/*:Array<string>*/ {\n\tvar o/*:Array<string>*/ = [];\n\tblob.l += 4; // must be 0x8\n\tvar cnt = blob.read_shift(4);\n\twhile(cnt-- > 0) o.push(blob.read_shift(0, 'lpp4'));\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.8 DataSpaceDefinition */\nfunction parse_TransformInfoHeader(blob) {\n\tvar o = {};\n\t/*var len = */blob.read_shift(4);\n\tblob.l += 4; // must be 0x1\n\to.id = blob.read_shift(0, 'lpp4');\n\to.name = blob.read_shift(0, 'lpp4');\n\to.R = parse_CRYPTOVersion(blob, 4);\n\to.U = parse_CRYPTOVersion(blob, 4);\n\to.W = parse_CRYPTOVersion(blob, 4);\n\treturn o;\n}\n\nfunction parse_Primary(blob) {\n\t/* [MS-OFFCRYPTO] 2.2.6 IRMDSTransformInfo */\n\tvar hdr = parse_TransformInfoHeader(blob);\n\t/* [MS-OFFCRYPTO] 2.1.9 EncryptionTransformInfo */\n\thdr.ename = blob.read_shift(0, '8lpp4');\n\thdr.blksz = blob.read_shift(4);\n\thdr.cmode = blob.read_shift(4);\n\tif(blob.read_shift(4) != 0x04) throw new Error(\"Bad !Primary record\");\n\treturn hdr;\n}\n\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\nfunction parse_EncryptionHeader(blob, length/*:number*/) {\n\tvar tgt = blob.l + length;\n\tvar o = {};\n\to.Flags = (blob.read_shift(4) & 0x3F);\n\tblob.l += 4;\n\to.AlgID = blob.read_shift(4);\n\tvar valid = false;\n\tswitch(o.AlgID) {\n\t\tcase 0x660E: case 0x660F: case 0x6610: valid = (o.Flags == 0x24); break;\n\t\tcase 0x6801: valid = (o.Flags == 0x04); break;\n\t\tcase 0: valid = (o.Flags == 0x10 || o.Flags == 0x04 || o.Flags == 0x24); break;\n\t\tdefault: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n\t}\n\tif(!valid) throw new Error(\"Encryption Flags/AlgID mismatch\");\n\to.AlgIDHash = blob.read_shift(4);\n\to.KeySize = blob.read_shift(4);\n\to.ProviderType = blob.read_shift(4);\n\tblob.l += 8;\n\to.CSPName = blob.read_shift((tgt-blob.l)>>1, 'utf16le');\n\tblob.l = tgt;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\nfunction parse_EncryptionVerifier(blob, length/*:number*/) {\n\tvar o = {}, tgt = blob.l + length;\n\tblob.l += 4; // SaltSize must be 0x10\n\to.Salt = blob.slice(blob.l, blob.l+16); blob.l += 16;\n\to.Verifier = blob.slice(blob.l, blob.l+16); blob.l += 16;\n\t/*var sz = */blob.read_shift(4);\n\to.VerifierHash = blob.slice(blob.l, tgt); blob.l = tgt;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.4.* EncryptionInfo Stream */\nfunction parse_EncryptionInfo(blob) {\n\tvar vers = parse_CRYPTOVersion(blob);\n\tswitch(vers.Minor) {\n\t\tcase 0x02: return [vers.Minor, parse_EncInfoStd(blob, vers)];\n\t\tcase 0x03: return [vers.Minor, parse_EncInfoExt(blob, vers)];\n\t\tcase 0x04: return [vers.Minor, parse_EncInfoAgl(blob, vers)];\n\t}\n\tthrow new Error(\"ECMA-376 Encrypted file unrecognized Version: \" + vers.Minor);\n}\n\n/* [MS-OFFCRYPTO] 2.3.4.5  EncryptionInfo Stream (Standard Encryption) */\nfunction parse_EncInfoStd(blob/*::, vers*/) {\n\tvar flags = blob.read_shift(4);\n\tif((flags & 0x3F) != 0x24) throw new Error(\"EncryptionInfo mismatch\");\n\tvar sz = blob.read_shift(4);\n\t//var tgt = blob.l + sz;\n\tvar hdr = parse_EncryptionHeader(blob, sz);\n\tvar verifier = parse_EncryptionVerifier(blob, blob.length - blob.l);\n\treturn { t:\"Std\", h:hdr, v:verifier };\n}\n/* [MS-OFFCRYPTO] 2.3.4.6  EncryptionInfo Stream (Extensible Encryption) */\nfunction parse_EncInfoExt(/*::blob, vers*/) { throw new Error(\"File is password-protected: ECMA-376 Extensible\"); }\n/* [MS-OFFCRYPTO] 2.3.4.10 EncryptionInfo Stream (Agile Encryption) */\nfunction parse_EncInfoAgl(blob/*::, vers*/) {\n\tvar KeyData = [\"saltSize\",\"blockSize\",\"keyBits\",\"hashSize\",\"cipherAlgorithm\",\"cipherChaining\",\"hashAlgorithm\",\"saltValue\"];\n\tblob.l+=4;\n\tvar xml = blob.read_shift(blob.length - blob.l, 'utf8');\n\tvar o = {};\n\txml.replace(tagregex, function xml_agile(x) {\n\t\tvar y/*:any*/ = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<encryption': case '</encryption>': break;\n\t\t\tcase '<keyData': KeyData.forEach(function(k) { o[k] = y[k]; }); break;\n\t\t\tcase '<dataIntegrity': o.encryptedHmacKey = y.encryptedHmacKey; o.encryptedHmacValue = y.encryptedHmacValue; break;\n\t\t\tcase '<keyEncryptors>': case '<keyEncryptors': o.encs = []; break;\n\t\t\tcase '</keyEncryptors>': break;\n\n\t\t\tcase '<keyEncryptor': o.uri = y.uri; break;\n\t\t\tcase '</keyEncryptor>': break;\n\t\t\tcase '<encryptedKey': o.encs.push(y); break;\n\t\t\tdefault: throw y[0];\n\t\t}\n\t});\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\nfunction parse_RC4CryptoHeader(blob, length/*:number*/) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4); length -= 4;\n\tif(vers.Minor != 2) throw new Error('unrecognized minor version code: ' + vers.Minor);\n\tif(vers.Major > 4 || vers.Major < 2) throw new Error('unrecognized major version code: ' + vers.Major);\n\to.Flags = blob.read_shift(4); length -= 4;\n\tvar sz = blob.read_shift(4); length -= 4;\n\to.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\n\to.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n\treturn o;\n}\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\nfunction parse_RC4Header(blob/*::, length*/) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n\tif(vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n\to.Salt = blob.read_shift(16);\n\to.EncryptedVerifier = blob.read_shift(16);\n\to.EncryptedVerifierHash = blob.read_shift(16);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\nfunction crypto_CreatePasswordVerifier_Method1(Password/*:string*/) {\n\tvar Verifier = 0x0000, PasswordArray;\n\tvar PasswordDecoded = _JS2ANSI(Password);\n\tvar len = PasswordDecoded.length + 1, i, PasswordByte;\n\tvar Intermediate1, Intermediate2, Intermediate3;\n\tPasswordArray = new_raw_buf(len);\n\tPasswordArray[0] = PasswordDecoded.length;\n\tfor(i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i-1];\n\tfor(i = len-1; i >= 0; --i) {\n\t\tPasswordByte = PasswordArray[i];\n\t\tIntermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\n\t\tIntermediate2 = (Verifier << 1) & 0x7FFF;\n\t\tIntermediate3 = Intermediate1 | Intermediate2;\n\t\tVerifier = Intermediate3 ^ PasswordByte;\n\t}\n\treturn Verifier ^ 0xCE4B;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\nvar crypto_CreateXorArray_Method1 = /*#__PURE__*/(function() {\n\tvar PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n\tvar InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n\tvar XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\tvar Ror = function(Byte) { return ((Byte/2) | (Byte*128)) & 0xFF; };\n\tvar XorRor = function(byte1, byte2) { return Ror(byte1 ^ byte2); };\n\tvar CreateXorKey_Method1 = function(Password) {\n\t\tvar XorKey = InitialCode[Password.length - 1];\n\t\tvar CurrentElement = 0x68;\n\t\tfor(var i = Password.length-1; i >= 0; --i) {\n\t\t\tvar Char = Password[i];\n\t\t\tfor(var j = 0; j != 7; ++j) {\n\t\t\t\tif(Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n\t\t\t\tChar *= 2; --CurrentElement;\n\t\t\t}\n\t\t}\n\t\treturn XorKey;\n\t};\n\treturn function(password/*:string*/) {\n\t\tvar Password = _JS2ANSI(password);\n\t\tvar XorKey = CreateXorKey_Method1(Password);\n\t\tvar Index = Password.length;\n\t\tvar ObfuscationArray = new_raw_buf(16);\n\t\tfor(var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n\t\tvar Temp, PasswordLastChar, PadIndex;\n\t\tif((Index & 1) === 1) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tPasswordLastChar = Password[Password.length - 1];\n\t\t\tObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n\t\t}\n\t\twhile(Index > 0) {\n\t\t\t--Index;\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t}\n\t\tIndex = 15;\n\t\tPadIndex = 15 - Password.length;\n\t\twhile(PadIndex > 0) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t}\n\t\treturn ObfuscationArray;\n\t};\n})();\n\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\nvar crypto_DecryptData_Method1 = function(password/*:string*/, Data, XorArrayIndex, XorArray, O) {\n\t/* If XorArray is set, use it; if O is not set, make changes in-place */\n\tif(!O) O = Data;\n\tif(!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n\tvar Index, Value;\n\tfor(Index = 0; Index != Data.length; ++Index) {\n\t\tValue = Data[Index];\n\t\tValue ^= XorArray[XorArrayIndex];\n\t\tValue = ((Value>>5) | (Value<<3)) & 0xFF;\n\t\tO[Index] = Value;\n\t\t++XorArrayIndex;\n\t}\n\treturn [O, XorArrayIndex, XorArray];\n};\n\nvar crypto_MakeXorDecryptor = function(password/*:string*/) {\n\tvar XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\n\treturn function(Data) {\n\t\tvar O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n\t\tXorArrayIndex = O[1];\n\t\treturn O[0];\n\t};\n};\n\n/* 2.5.343 */\nfunction parse_XORObfuscation(blob, length, opts, out) {\n\tvar o = ({ key: parseuint16(blob), verificationBytes: parseuint16(blob) }/*:any*/);\n\tif(opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n\tout.valid = o.verificationBytes === o.verifier;\n\tif(out.valid) out.insitu = crypto_MakeXorDecryptor(opts.password);\n\treturn o;\n}\n\n/* 2.4.117 */\nfunction parse_FilePassHeader(blob, length/*:number*/, oo) {\n\tvar o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\n\tif(o.Info === 1) o.Data = parse_RC4Header(blob, length);\n\telse o.Data = parse_RC4CryptoHeader(blob, length);\n\treturn o;\n}\nfunction parse_FilePass(blob, length/*:number*/, opts) {\n\tvar o = ({ Type: opts.biff >= 8 ? blob.read_shift(2) : 0 }/*:any*/); /* wEncryptionType */\n\tif(o.Type) parse_FilePassHeader(blob, length-2, o);\n\telse parse_XORObfuscation(blob, opts.biff >= 8 ? length : length - 2, opts, o);\n\treturn o;\n}\n\n\nfunction rtf_to_sheet(d, opts) {\n  switch (opts.type) {\n    case \"base64\":\n      return rtf_to_sheet_str(Base64_decode(d), opts);\n    case \"binary\":\n      return rtf_to_sheet_str(d, opts);\n    case \"buffer\":\n      return rtf_to_sheet_str(has_buf && Buffer.isBuffer(d) ? d.toString(\"binary\") : a2s(d), opts);\n    case \"array\":\n      return rtf_to_sheet_str(cc2str(d), opts);\n  }\n  throw new Error(\"Unrecognized type \" + opts.type);\n}\nfunction rtf_to_sheet_str(str, opts) {\n  var o = opts || {};\n  var ws = {};\n  var dense = o.dense;\n  if (dense)\n    ws[\"!data\"] = [];\n  var rows = str_match_ng(str, \"\\\\trowd\", \"\\\\row\");\n  if (!rows)\n    throw new Error(\"RTF missing table\");\n  var range = { s: { c: 0, r: 0 }, e: { c: 0, r: rows.length - 1 } };\n  var row = [];\n  rows.forEach(function(rowtf, R) {\n    if (dense)\n      row = ws[\"!data\"][R] = [];\n    var rtfre = /\\\\[\\w\\-]+\\b/g;\n    var last_index = 0;\n    var res;\n    var C = -1;\n    var payload = [];\n    while ((res = rtfre.exec(rowtf)) != null) {\n      var data = rowtf.slice(last_index, rtfre.lastIndex - res[0].length);\n      if (data.charCodeAt(0) == 32)\n        data = data.slice(1);\n      if (data.length)\n        payload.push(data);\n      switch (res[0]) {\n        case \"\\\\cell\":\n          ++C;\n          if (payload.length) {\n            var cell = { v: payload.join(\"\"), t: \"s\" };\n            if (cell.v == \"TRUE\" || cell.v == \"FALSE\") {\n              cell.v = cell.v == \"TRUE\";\n              cell.t = \"b\";\n            } else if (!isNaN(fuzzynum(cell.v))) {\n              cell.t = \"n\";\n              if (o.cellText !== false)\n                cell.w = cell.v;\n              cell.v = fuzzynum(cell.v);\n            } else if (RBErr[cell.v] != null) {\n              cell.t = \"e\";\n              cell.w = cell.v;\n              cell.v = RBErr[cell.v];\n            }\n            if (dense)\n              row[C] = cell;\n            else\n              ws[encode_cell({ r: R, c: C })] = cell;\n          }\n          payload = [];\n          break;\n        case \"\\\\par\":\n          payload.push(\"\\n\");\n          break;\n      }\n      last_index = rtfre.lastIndex;\n    }\n    if (C > range.e.c)\n      range.e.c = C;\n  });\n  ws[\"!ref\"] = encode_range(range);\n  return ws;\n}\nfunction rtf_to_workbook(d, opts) {\n  var wb = sheet_to_workbook(rtf_to_sheet(d, opts), opts);\n  wb.bookType = \"rtf\";\n  return wb;\n}\nfunction sheet_to_rtf(ws, opts) {\n  var o = [\"{\\\\rtf1\\\\ansi\"];\n  if (!ws[\"!ref\"])\n    return o[0] + \"}\";\n  var r = safe_decode_range(ws[\"!ref\"]), cell;\n  var dense = ws[\"!data\"] != null, row = [];\n  for (var R = r.s.r; R <= r.e.r; ++R) {\n    o.push(\"\\\\trowd\\\\trautofit1\");\n    for (var C = r.s.c; C <= r.e.c; ++C)\n      o.push(\"\\\\cellx\" + (C + 1));\n    o.push(\"\\\\pard\\\\intbl\");\n    if (dense)\n      row = ws[\"!data\"][R] || [];\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      var coord = encode_cell({ r: R, c: C });\n      cell = dense ? row[C] : ws[coord];\n      if (!cell || cell.v == null && (!cell.f || cell.F)) {\n        o.push(\" \\\\cell\");\n        continue;\n      }\n      o.push(\" \" + (cell.w || (format_cell(cell), cell.w) || \"\").replace(/[\\r\\n]/g, \"\\\\par \"));\n      o.push(\"\\\\cell\");\n    }\n    o.push(\"\\\\pard\\\\intbl\\\\row\");\n  }\n  return o.join(\"\") + \"}\";\n}\nfunction hex2RGB(h) {\n\tvar o = h.slice(h[0]===\"#\"?1:0).slice(0,6);\n\treturn [parseInt(o.slice(0,2),16),parseInt(o.slice(2,4),16),parseInt(o.slice(4,6),16)];\n}\nfunction rgb2Hex(rgb) {\n\tfor(var i=0,o=1; i!=3; ++i) o = o*256 + (rgb[i]>255?255:rgb[i]<0?0:rgb[i]);\n\treturn o.toString(16).toUpperCase().slice(1);\n}\n\nfunction rgb2HSL(rgb) {\n\tvar R = rgb[0]/255, G = rgb[1]/255, B=rgb[2]/255;\n\tvar M = Math.max(R, G, B), m = Math.min(R, G, B), C = M - m;\n\tif(C === 0) return [0, 0, R];\n\n\tvar H6 = 0, S = 0, L2 = (M + m);\n\tS = C / (L2 > 1 ? 2 - L2 : L2);\n\tswitch(M){\n\t\tcase R: H6 = ((G - B) / C + 6)%6; break;\n\t\tcase G: H6 = ((B - R) / C + 2); break;\n\t\tcase B: H6 = ((R - G) / C + 4); break;\n\t}\n\treturn [H6 / 6, S, L2 / 2];\n}\n\nfunction hsl2RGB(hsl){\n\tvar H = hsl[0], S = hsl[1], L = hsl[2];\n\tvar C = S * 2 * (L < 0.5 ? L : 1 - L), m = L - C/2;\n\tvar rgb = [m,m,m], h6 = 6*H;\n\n\tvar X;\n\tif(S !== 0) switch(h6|0) {\n\t\tcase 0: case 6: X = C * h6; rgb[0] += C; rgb[1] += X; break;\n\t\tcase 1: X = C * (2 - h6);   rgb[0] += X; rgb[1] += C; break;\n\t\tcase 2: X = C * (h6 - 2);   rgb[1] += C; rgb[2] += X; break;\n\t\tcase 3: X = C * (4 - h6);   rgb[1] += X; rgb[2] += C; break;\n\t\tcase 4: X = C * (h6 - 4);   rgb[2] += C; rgb[0] += X; break;\n\t\tcase 5: X = C * (6 - h6);   rgb[2] += X; rgb[0] += C; break;\n\t}\n\tfor(var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i]*255);\n\treturn rgb;\n}\n\n/* 18.8.3 bgColor tint algorithm */\nfunction rgb_tint(hex, tint) {\n\tif(tint === 0) return hex;\n\tvar hsl = rgb2HSL(hex2RGB(hex));\n\tif (tint < 0) hsl[2] = hsl[2] * (1 + tint);\n\telse hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n\treturn rgb2Hex(hsl2RGB(hsl));\n}\n\n/* 18.3.1.13 width calculations */\n/* [MS-OI29500] 2.1.595 Column Width & Formatting */\nvar DEF_MDW = 6, MAX_MDW = 15, MIN_MDW = 1, MDW = DEF_MDW;\nfunction width2px(width) { return Math.floor(( width + (Math.round(128/MDW))/256 )* MDW ); }\nfunction px2char(px) { return (Math.floor((px - 5)/MDW * 100 + 0.5))/100; }\nfunction char2width(chr) { return (Math.round((chr * MDW + 5)/MDW*256))/256; }\n//function px2char_(px) { return (((px - 5)/MDW * 100 + 0.5))/100; }\n//function char2width_(chr) { return (((chr * MDW + 5)/MDW*256))/256; }\nfunction cycle_width(collw) { return char2width(px2char(width2px(collw))); }\n/* XLSX/XLSB/XLS specify width in units of MDW */\nfunction find_mdw_colw(collw) {\n\tvar delta = Math.abs(collw - cycle_width(collw)), _MDW = MDW;\n\tif(delta > 0.005) for(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) if(Math.abs(collw - cycle_width(collw)) <= delta) { delta = Math.abs(collw - cycle_width(collw)); _MDW = MDW; }\n\tMDW = _MDW;\n}\n/* XLML specifies width in terms of pixels */\n/*function find_mdw_wpx(wpx) {\n\tvar delta = Infinity, guess = 0, _MDW = MIN_MDW;\n\tfor(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) {\n\t\tguess = char2width_(px2char_(wpx))*256;\n\t\tguess = (guess) % 1;\n\t\tif(guess > 0.5) guess--;\n\t\tif(Math.abs(guess) < delta) { delta = Math.abs(guess); _MDW = MDW; }\n\t}\n\tMDW = _MDW;\n}*/\n\nfunction process_col(coll/*:ColInfo*/) {\n\tif(coll.width) {\n\t\tcoll.wpx = width2px(coll.width);\n\t\tcoll.wch = px2char(coll.wpx);\n\t\tcoll.MDW = MDW;\n\t} else if(coll.wpx) {\n\t\tcoll.wch = px2char(coll.wpx);\n\t\tcoll.width = char2width(coll.wch);\n\t\tcoll.MDW = MDW;\n\t} else if(typeof coll.wch == 'number') {\n\t\tcoll.width = char2width(coll.wch);\n\t\tcoll.wpx = width2px(coll.width);\n\t\tcoll.MDW = MDW;\n\t}\n\tif(coll.customWidth) delete coll.customWidth;\n}\n\nvar DEF_PPI = 96, PPI = DEF_PPI;\nfunction px2pt(px) { return px * 96 / PPI; }\nfunction pt2px(pt) { return pt * PPI / 96; }\n\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\nvar XLMLPatternTypeMap = {\n\t\"None\": \"none\",\n\t\"Solid\": \"solid\",\n\t\"Gray50\": \"mediumGray\",\n\t\"Gray75\": \"darkGray\",\n\t\"Gray25\": \"lightGray\",\n\t\"HorzStripe\": \"darkHorizontal\",\n\t\"VertStripe\": \"darkVertical\",\n\t\"ReverseDiagStripe\": \"darkDown\",\n\t\"DiagStripe\": \"darkUp\",\n\t\"DiagCross\": \"darkGrid\",\n\t\"ThickDiagCross\": \"darkTrellis\",\n\t\"ThinHorzStripe\": \"lightHorizontal\",\n\t\"ThinVertStripe\": \"lightVertical\",\n\t\"ThinReverseDiagStripe\": \"lightDown\",\n\t\"ThinHorzCross\": \"lightGrid\"\n};\n\n/* 18.8.5 borders CT_Borders */\nfunction parse_borders(t, styles, themes, opts) {\n\tstyles.Borders = [];\n\tvar border = {};\n\tvar pass = false;\n\t(t.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<borders': case '<borders>': case '</borders>': break;\n\n\t\t\t/* 18.8.4 border CT_Border */\n\t\t\tcase '<border': case '<border>': case '<border/>':\n\t\t\t\tborder = /*::(*/{}/*:: :any)*/;\n\t\t\t\tif(y.diagonalUp) border.diagonalUp = parsexmlbool(y.diagonalUp);\n\t\t\t\tif(y.diagonalDown) border.diagonalDown = parsexmlbool(y.diagonalDown);\n\t\t\t\tstyles.Borders.push(border);\n\t\t\t\tbreak;\n\t\t\tcase '</border>': break;\n\n\t\t\t/* note: not in spec, appears to be CT_BorderPr */\n\t\t\tcase '<left/>': break;\n\t\t\tcase '<left': case '<left>': break;\n\t\t\tcase '</left>': break;\n\n\t\t\t/* note: not in spec, appears to be CT_BorderPr */\n\t\t\tcase '<right/>': break;\n\t\t\tcase '<right': case '<right>': break;\n\t\t\tcase '</right>': break;\n\n\t\t\t/* 18.8.43 top CT_BorderPr */\n\t\t\tcase '<top/>': break;\n\t\t\tcase '<top': case '<top>': break;\n\t\t\tcase '</top>': break;\n\n\t\t\t/* 18.8.6 bottom CT_BorderPr */\n\t\t\tcase '<bottom/>': break;\n\t\t\tcase '<bottom': case '<bottom>': break;\n\t\t\tcase '</bottom>': break;\n\n\t\t\t/* 18.8.13 diagonal CT_BorderPr */\n\t\t\tcase '<diagonal': case '<diagonal>': case '<diagonal/>': break;\n\t\t\tcase '</diagonal>': break;\n\n\t\t\t/* 18.8.25 horizontal CT_BorderPr */\n\t\t\tcase '<horizontal': case '<horizontal>': case '<horizontal/>': break;\n\t\t\tcase '</horizontal>': break;\n\n\t\t\t/* 18.8.44 vertical CT_BorderPr */\n\t\t\tcase '<vertical': case '<vertical>': case '<vertical/>': break;\n\t\t\tcase '</vertical>': break;\n\n\t\t\t/* 18.8.37 start CT_BorderPr */\n\t\t\tcase '<start': case '<start>': case '<start/>': break;\n\t\t\tcase '</start>': break;\n\n\t\t\t/* 18.8.16 end CT_BorderPr */\n\t\t\tcase '<end': case '<end>': case '<end/>': break;\n\t\t\tcase '</end>': break;\n\n\t\t\t/* 18.8.? color CT_Color */\n\t\t\tcase '<color': case '<color>':\n\t\t\t\tbreak;\n\t\t\tcase '<color/>': case '</color>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in borders');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.21 fills CT_Fills */\nfunction parse_fills(t, styles, themes, opts) {\n\tstyles.Fills = [];\n\tvar fill = {};\n\tvar pass = false;\n\t(t.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<fills': case '<fills>': case '</fills>': break;\n\n\t\t\t/* 18.8.20 fill CT_Fill */\n\t\t\tcase '<fill>': case '<fill': case '<fill/>':\n\t\t\t\tfill = {}; styles.Fills.push(fill); break;\n\t\t\tcase '</fill>': break;\n\n\t\t\t/* 18.8.24 gradientFill CT_GradientFill */\n\t\t\tcase '<gradientFill>': break;\n\t\t\tcase '<gradientFill':\n\t\t\tcase '</gradientFill>': styles.Fills.push(fill); fill = {}; break;\n\n\t\t\t/* 18.8.32 patternFill CT_PatternFill */\n\t\t\tcase '<patternFill': case '<patternFill>':\n\t\t\t\tif(y.patternType) fill.patternType = y.patternType;\n\t\t\t\tbreak;\n\t\t\tcase '<patternFill/>': case '</patternFill>': break;\n\n\t\t\t/* 18.8.3 bgColor CT_Color */\n\t\t\tcase '<bgColor':\n\t\t\t\tif(!fill.bgColor) fill.bgColor = {};\n\t\t\t\tif(y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n\t\t\t\tif(y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n\t\t\t\tif(y.tint) fill.bgColor.tint = parseFloat(y.tint);\n\t\t\t\t/* Excel uses ARGB strings */\n\t\t\t\tif(y.rgb) fill.bgColor.rgb = y.rgb.slice(-6);\n\t\t\t\tbreak;\n\t\t\tcase '<bgColor/>': case '</bgColor>': break;\n\n\t\t\t/* 18.8.19 fgColor CT_Color */\n\t\t\tcase '<fgColor':\n\t\t\t\tif(!fill.fgColor) fill.fgColor = {};\n\t\t\t\tif(y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n\t\t\t\tif(y.tint) fill.fgColor.tint = parseFloat(y.tint);\n\t\t\t\t/* Excel uses ARGB strings */\n\t\t\t\tif(y.rgb != null) fill.fgColor.rgb = y.rgb.slice(-6);\n\t\t\t\tbreak;\n\t\t\tcase '<fgColor/>': case '</fgColor>': break;\n\n\t\t\t/* 18.8.38 stop CT_GradientStop */\n\t\t\tcase '<stop': case '<stop/>': break;\n\t\t\tcase '</stop>': break;\n\n\t\t\t/* 18.8.? color CT_Color */\n\t\t\tcase '<color': case '<color/>': break;\n\t\t\tcase '</color>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in fills');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.23 fonts CT_Fonts */\nfunction parse_fonts(t, styles, themes, opts) {\n\tstyles.Fonts = [];\n\tvar font = {};\n\tvar pass = false;\n\t(t.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<fonts': case '<fonts>': case '</fonts>': break;\n\n\t\t\t/* 18.8.22 font CT_Font */\n\t\t\tcase '<font': case '<font>': break;\n\t\t\tcase '</font>': case '<font/>':\n\t\t\t\tstyles.Fonts.push(font);\n\t\t\t\tfont = {};\n\t\t\t\tbreak;\n\n\t\t\t/* 18.8.29 name CT_FontName */\n\t\t\tcase '<name': if(y.val) font.name = utf8read(y.val); break;\n\t\t\tcase '<name/>': case '</name>': break;\n\n\t\t\t/* 18.8.2  b CT_BooleanProperty */\n\t\t\tcase '<b': font.bold = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<b/>': font.bold = 1; break;\n\t\t\tcase '</b>': case '</b': break;\n\n\t\t\t/* 18.8.26 i CT_BooleanProperty */\n\t\t\tcase '<i': font.italic = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<i/>': font.italic = 1; break;\n\t\t\tcase '</i>': case '</i': break;\n\n\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\tcase '<u':\n\t\t\t\tswitch(y.val) {\n\t\t\t\t\tcase \"none\": font.underline = 0x00; break;\n\t\t\t\t\tcase \"single\": font.underline = 0x01; break;\n\t\t\t\t\tcase \"double\": font.underline = 0x02; break;\n\t\t\t\t\tcase \"singleAccounting\": font.underline = 0x21; break;\n\t\t\t\t\tcase \"doubleAccounting\": font.underline = 0x22; break;\n\t\t\t\t} break;\n\t\t\tcase '<u/>': font.underline = 1; break;\n\t\t\tcase '</u>': case '</u': break;\n\n\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\tcase '<strike': font.strike = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<strike/>': font.strike = 1; break;\n\t\t\tcase '</strike>': case '</strike': break;\n\n\t\t\t/* 18.4.2  outline CT_BooleanProperty */\n\t\t\tcase '<outline': font.outline = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<outline/>': font.outline = 1; break;\n\t\t\tcase '</outline>': case '</outline': break;\n\n\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\tcase '<shadow': font.shadow = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<shadow/>': font.shadow = 1; break;\n\t\t\tcase '</shadow>': case '</shadow': break;\n\n\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\tcase '<condense': font.condense = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<condense/>': font.condense = 1; break;\n\t\t\tcase '</condense>': case '</condense': break;\n\n\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\tcase '<extend': font.extend = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<extend/>': font.extend = 1; break;\n\t\t\tcase '</extend>': case '</extend': break;\n\n\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\tcase '<sz': if(y.val) font.sz = +y.val; break;\n\t\t\tcase '<sz/>': case '</sz>': case '</sz': break;\n\n\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty */\n\t\t\tcase '<vertAlign': if(y.val) font.vertAlign = y.val; break;\n\t\t\tcase '<vertAlign/>': case '</vertAlign>': case '</vertAlign': break;\n\n\t\t\t/* 18.8.18 family CT_FontFamily */\n\t\t\tcase '<family': if(y.val) font.family = parseInt(y.val,10); break;\n\t\t\tcase '<family/>': case '</family>': case '</family': break;\n\n\t\t\t/* 18.8.35 scheme CT_FontScheme */\n\t\t\tcase '<scheme': if(y.val) font.scheme = y.val; break;\n\t\t\tcase '<scheme/>': case '</scheme>': case '</scheme': break;\n\n\t\t\t/* 18.4.1 charset CT_IntProperty */\n\t\t\tcase '<charset':\n\t\t\t\tif(y.val == '1') break;\n\t\t\t\ty.codepage = CS2CP[parseInt(y.val, 10)];\n\t\t\t\tbreak;\n\t\t\tcase '<charset/>': case '</charset>': case '</charset': break;\n\n\t\t\t/* 18.?.? color CT_Color */\n\t\t\tcase '<color':\n\t\t\t\tif(!font.color) font.color = {};\n\t\t\t\tif(y.auto) font.color.auto = parsexmlbool(y.auto);\n\n\t\t\t\tif(y.rgb) font.color.rgb = y.rgb.slice(-6);\n\t\t\t\telse if(y.indexed) {\n\t\t\t\t\tfont.color.index = parseInt(y.indexed, 10);\n\t\t\t\t\tvar icv = XLSIcv[font.color.index];\n\t\t\t\t\tif(font.color.index == 81) icv = XLSIcv[1];\n\t\t\t\t\tif(!icv) icv = XLSIcv[1]; //throw new Error(x); // note: 206 is valid\n\t\t\t\t\tfont.color.rgb = icv[0].toString(16) + icv[1].toString(16) + icv[2].toString(16);\n\t\t\t\t} else if(y.theme) {\n\t\t\t\t\tfont.color.theme = parseInt(y.theme, 10);\n\t\t\t\t\tif(y.tint) font.color.tint = parseFloat(y.tint);\n\t\t\t\t\tif(y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n\t\t\t\t\t\tfont.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase '<color/>': case '</color>': case '</color': break;\n\n\t\t\t/* note: sometimes mc:AlternateContent appears bare */\n\t\t\tcase '<AlternateContent': pass = true; break;\n\t\t\tcase '</AlternateContent>': case '</AlternateContent': pass = false; break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in fonts');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.31 numFmts CT_NumFmts */\nfunction parse_numFmts(t, styles, opts) {\n\tstyles.NumberFmt = [];\n\tvar k/*Array<number>*/ = (keys(table_fmt)/*:any*/);\n\tfor(var i=0; i < k.length; ++i) styles.NumberFmt[k[i]] = table_fmt[k[i]];\n\tvar m = t.match(tagregex);\n\tif(!m) return;\n\tfor(i=0; i < m.length; ++i) {\n\t\tvar y = parsexmltag(m[i]);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<numFmts': case '</numFmts>': case '<numFmts/>': case '<numFmts>': break;\n\t\t\tcase '<numFmt': {\n\t\t\t\tvar f=unescapexml(utf8read(y.formatCode)), j=parseInt(y.numFmtId,10);\n\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\tif(j>0) {\n\t\t\t\t\tif(j > 0x188) {\n\t\t\t\t\t\tfor(j = 0x188; j > 0x3c; --j) if(styles.NumberFmt[j] == null) break;\n\t\t\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\t\t}\n\t\t\t\t\tSSF__load(f,j);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase '</numFmt>': break;\n\t\t\tdefault: if(opts.WTF) throw new Error('unrecognized ' + y[0] + ' in numFmts');\n\t\t}\n\t}\n}\n\nfunction write_numFmts(NF/*:{[n:number|string]:string}*//*::, opts*/) {\n\tvar o = [\"<numFmts>\"];\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) o[o.length] = (writextag('numFmt',null,{numFmtId:i,formatCode:escapexml(NF[i])}));\n\t});\n\tif(o.length === 1) return \"\";\n\to[o.length] = (\"</numFmts>\");\n\to[0] = writextag('numFmts', null, { count:o.length-2 }).replace(\"/>\", \">\");\n\treturn o.join(\"\");\n}\n\n/* 18.8.10 cellXfs CT_CellXfs */\nvar cellXF_uint = [ \"numFmtId\", \"fillId\", \"fontId\", \"borderId\", \"xfId\" ];\nvar cellXF_bool = [ \"applyAlignment\", \"applyBorder\", \"applyFill\", \"applyFont\", \"applyNumberFormat\", \"applyProtection\", \"pivotButton\", \"quotePrefix\" ];\nfunction parse_cellXfs(t, styles, opts) {\n\tstyles.CellXf = [];\n\tvar xf;\n\tvar pass = false;\n\t(t.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x), i = 0;\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<cellXfs': case '<cellXfs>': case '<cellXfs/>': case '</cellXfs>': break;\n\n\t\t\t/* 18.8.45 xf CT_Xf */\n\t\t\tcase '<xf': case '<xf/>': case '<xf>':\n\t\t\t\txf = y;\n\t\t\t\tdelete xf[0];\n\t\t\t\tfor(i = 0; i < cellXF_uint.length; ++i) if(xf[cellXF_uint[i]])\n\t\t\t\t\txf[cellXF_uint[i]] = parseInt(xf[cellXF_uint[i]], 10);\n\t\t\t\tfor(i = 0; i < cellXF_bool.length; ++i) if(xf[cellXF_bool[i]])\n\t\t\t\t\txf[cellXF_bool[i]] = parsexmlbool(xf[cellXF_bool[i]]);\n\t\t\t\tif(styles.NumberFmt && xf.numFmtId > 0x188) {\n\t\t\t\t\tfor(i = 0x188; i > 0x3c; --i) if(styles.NumberFmt[xf.numFmtId] == styles.NumberFmt[i]) { xf.numFmtId = i; break; }\n\t\t\t\t}\n\t\t\t\tstyles.CellXf.push(xf); break;\n\t\t\tcase '</xf>': break;\n\n\t\t\t/* 18.8.1 alignment CT_CellAlignment */\n\t\t\tcase '<alignment': case '<alignment/>': case '<alignment>':\n\t\t\t\tvar alignment = {};\n\t\t\t\tif(y.vertical) alignment.vertical = y.vertical;\n\t\t\t\tif(y.horizontal) alignment.horizontal = y.horizontal;\n\t\t\t\tif(y.textRotation != null) alignment.textRotation = y.textRotation;\n\t\t\t\tif(y.indent) alignment.indent = y.indent;\n\t\t\t\tif(y.wrapText) alignment.wrapText = parsexmlbool(y.wrapText);\n\t\t\t\txf.alignment = alignment;\n\t\t\t\tbreak;\n\t\t\tcase '</alignment>': break;\n\n\t\t\t/* 18.8.33 protection CT_CellProtection */\n\t\t\tcase '<protection': case '<protection>':\n\t\t\t\tbreak;\n\t\t\tcase '</protection>': case '<protection/>': break;\n\n\t\t\t/* note: sometimes mc:AlternateContent appears bare */\n\t\t\tcase '<AlternateContent': case '<AlternateContent>': pass = true; break;\n\t\t\tcase '</AlternateContent>': pass = false; break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in cellXfs');\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction write_cellXfs(cellXfs)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\to[o.length] = (writextag('cellXfs',null));\n\tcellXfs.forEach(function(c) {\n\t\to[o.length] = (writextag('xf', null, c));\n\t});\n\to[o.length] = (\"</cellXfs>\");\n\tif(o.length === 2) return \"\";\n\to[0] = writextag('cellXfs',null, {count:o.length-2}).replace(\"/>\",\">\");\n\treturn o.join(\"\");\n}\n\n/* 18.8 Styles CT_Stylesheet*/\nvar parse_sty_xml= /*#__PURE__*/(function make_pstyx() {\n\nreturn function parse_sty_xml(data, themes, opts) {\n\tvar styles = {};\n\tif(!data) return styles;\n\tdata = remove_doctype(str_remove_ng(data, \"<!--\", \"-->\"));\n\t/* 18.8.39 styleSheet CT_Stylesheet */\n\tvar t;\n\n\t/* 18.8.31 numFmts CT_NumFmts ? */\n\tif((t=str_match_xml_ns(data, \"numFmts\"))) parse_numFmts(t[0], styles, opts);\n\n\t/* 18.8.23 fonts CT_Fonts ? */\n\tif((t=str_match_xml_ns(data, \"fonts\"))) parse_fonts(t[0], styles, themes, opts);\n\n\t/* 18.8.21 fills CT_Fills ? */\n\tif((t=str_match_xml_ns(data, \"fills\"))) parse_fills(t[0], styles, themes, opts);\n\n\t/* 18.8.5  borders CT_Borders ? */\n\tif((t=str_match_xml_ns(data, \"borders\"))) parse_borders(t[0], styles, themes, opts);\n\n\t/* 18.8.9  cellStyleXfs CT_CellStyleXfs ? */\n\t/* 18.8.8  cellStyles CT_CellStyles ? */\n\n\t/* 18.8.10 cellXfs CT_CellXfs ? */\n\tif((t=str_match_xml_ns(data, \"cellXfs\"))) parse_cellXfs(t[0], styles, opts);\n\n\t/* 18.8.15 dxfs CT_Dxfs ? */\n\t/* 18.8.42 tableStyles CT_TableStyles ? */\n\t/* 18.8.11 colors CT_Colors ? */\n\t/* 18.2.10 extLst CT_ExtensionList ? */\n\n\treturn styles;\n};\n})();\n\nfunction write_sty_xml(wb/*:Workbook*/, opts)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('styleSheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:vt': XMLNS.vt\n\t})], w;\n\tif(wb.SSF && (w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n\to[o.length] = ('<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>');\n\to[o.length] = ('<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>');\n\to[o.length] = ('<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');\n\to[o.length] = ('<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>');\n\tif((w = write_cellXfs(opts.cellXfs))) o[o.length] = (w);\n\to[o.length] = ('<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>');\n\to[o.length] = ('<dxfs count=\"0\"/>');\n\to[o.length] = ('<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>');\n\n\tif(o.length>2){ o[o.length] = ('</styleSheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.657 BrtFmt */\nfunction parse_BrtFmt(data, length/*:number*/) {\n\tvar numFmtId = data.read_shift(2);\n\tvar stFmtCode = parse_XLWideString(data,length-2);\n\treturn [numFmtId, stFmtCode];\n}\nfunction write_BrtFmt(i/*:number*/, f/*:string*/, o) {\n\tif(!o) o = new_buf(6 + 4 * f.length);\n\to.write_shift(2, i);\n\twrite_XLWideString(f, o);\n\tvar out = (o.length > o.l) ? o.slice(0, o.l) : o;\n\tif(o.l == null) o.l = o.length;\n\treturn out;\n}\n\n/* [MS-XLSB] 2.4.659 BrtFont TODO */\nfunction parse_BrtFont(data, length/*:number*/, opts) {\n\tvar out = ({}/*:any*/);\n\n\tout.sz = data.read_shift(2) / 20;\n\n\tvar grbit = parse_FontFlags(data, 2, opts);\n\tif(grbit.fItalic) out.italic = 1;\n\tif(grbit.fCondense) out.condense = 1;\n\tif(grbit.fExtend) out.extend = 1;\n\tif(grbit.fShadow) out.shadow = 1;\n\tif(grbit.fOutline) out.outline = 1;\n\tif(grbit.fStrikeout) out.strike = 1;\n\n\tvar bls = data.read_shift(2);\n\tif(bls === 0x02BC) out.bold = 1;\n\n\tswitch(data.read_shift(2)) {\n\t\t/* case 0: out.vertAlign = \"baseline\"; break; */\n\t\tcase 1: out.vertAlign = \"superscript\"; break;\n\t\tcase 2: out.vertAlign = \"subscript\"; break;\n\t}\n\n\tvar underline = data.read_shift(1);\n\tif(underline != 0) out.underline = underline;\n\n\tvar family = data.read_shift(1);\n\tif(family > 0) out.family = family;\n\n\tvar bCharSet = data.read_shift(1);\n\tif(bCharSet > 0) out.charset = bCharSet;\n\n\tdata.l++;\n\tout.color = parse_BrtColor(data, 8);\n\n\tswitch(data.read_shift(1)) {\n\t\t/* case 0: out.scheme = \"none\": break; */\n\t\tcase 1: out.scheme = \"major\"; break;\n\t\tcase 2: out.scheme = \"minor\"; break;\n\t}\n\n\tout.name = parse_XLWideString(data, length - 21);\n\n\treturn out;\n}\nfunction write_BrtFont(font/*:any*/, o) {\n\tif(!o) o = new_buf(25+4*32);\n\to.write_shift(2, font.sz * 20);\n\twrite_FontFlags(font, o);\n\to.write_shift(2, font.bold ? 0x02BC : 0x0190);\n\tvar sss = 0;\n\tif(font.vertAlign == \"superscript\") sss = 1;\n\telse if(font.vertAlign == \"subscript\") sss = 2;\n\to.write_shift(2, sss);\n\to.write_shift(1, font.underline || 0);\n\to.write_shift(1, font.family || 0);\n\to.write_shift(1, font.charset || 0);\n\to.write_shift(1, 0);\n\twrite_BrtColor(font.color, o);\n\tvar scheme = 0;\n\tif(font.scheme == \"major\") scheme = 1;\n\tif(font.scheme == \"minor\") scheme = 2;\n\to.write_shift(1, scheme);\n\twrite_XLWideString(font.name, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.650 BrtFill */\nvar XLSBFillPTNames = [\n\t\"none\",\n\t\"solid\",\n\t\"mediumGray\",\n\t\"darkGray\",\n\t\"lightGray\",\n\t\"darkHorizontal\",\n\t\"darkVertical\",\n\t\"darkDown\",\n\t\"darkUp\",\n\t\"darkGrid\",\n\t\"darkTrellis\",\n\t\"lightHorizontal\",\n\t\"lightVertical\",\n\t\"lightDown\",\n\t\"lightUp\",\n\t\"lightGrid\",\n\t\"lightTrellis\",\n\t\"gray125\",\n\t\"gray0625\"\n];\nvar rev_XLSBFillPTNames/*:EvertNumType*/;\n/* TODO: gradient fill representation */\nvar parse_BrtFill = parsenoop;\nfunction write_BrtFill(fill, o) {\n\tif(!o) o = new_buf(4*3 + 8*7 + 16*1);\n\tif(!rev_XLSBFillPTNames) rev_XLSBFillPTNames = (evert(XLSBFillPTNames)/*:any*/);\n\tvar fls/*:number*/ = rev_XLSBFillPTNames[fill.patternType];\n\tif(fls == null) fls = 0x28;\n\to.write_shift(4, fls);\n\tvar j = 0;\n\tif(fls != 0x28) {\n\t\t/* TODO: custom FG Color */\n\t\twrite_BrtColor({auto:1}, o);\n\t\t/* TODO: custom BG Color */\n\t\twrite_BrtColor({auto:1}, o);\n\n\t\tfor(; j < 12; ++j) o.write_shift(4, 0);\n\t} else {\n\t\tfor(; j < 4; ++j) o.write_shift(4, 0);\n\n\t\tfor(; j < 12; ++j) o.write_shift(4, 0); /* TODO */\n\t\t/* iGradientType */\n\t\t/* xnumDegree */\n\t\t/* xnumFillToLeft */\n\t\t/* xnumFillToRight */\n\t\t/* xnumFillToTop */\n\t\t/* xnumFillToBottom */\n\t\t/* cNumStop */\n\t\t/* xfillGradientStop */\n\t}\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.824 BrtXF */\nfunction parse_BrtXF(data, length/*:number*/) {\n\tvar tgt = data.l + length;\n\tvar ixfeParent = data.read_shift(2);\n\tvar ifmt = data.read_shift(2);\n\tdata.l = tgt;\n\treturn {ixfe:ixfeParent, numFmtId:ifmt };\n}\nfunction write_BrtXF(data, ixfeP, o) {\n\tif(!o) o = new_buf(16);\n\to.write_shift(2, ixfeP||0);\n\to.write_shift(2, data.numFmtId||0);\n\to.write_shift(2, 0); /* iFont */\n\to.write_shift(2, 0); /* iFill */\n\to.write_shift(2, 0); /* ixBorder */\n\to.write_shift(1, 0); /* trot */\n\to.write_shift(1, 0); /* indent */\n\tvar flow = 0;\n\to.write_shift(1, flow); /* flags */\n\to.write_shift(1, 0); /* flags */\n\to.write_shift(1, 0); /* xfGrbitAtr */\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.4 Blxf TODO */\nfunction write_Blxf(data, o) {\n\tif(!o) o = new_buf(10);\n\to.write_shift(1, 0); /* dg */\n\to.write_shift(1, 0);\n\to.write_shift(4, 0); /* color */\n\to.write_shift(4, 0); /* color */\n\treturn o;\n}\n/* [MS-XLSB] 2.4.302 BrtBorder TODO */\nvar parse_BrtBorder = parsenoop;\nfunction write_BrtBorder(border, o) {\n\tif(!o) o = new_buf(51);\n\to.write_shift(1, 0); /* diagonal */\n\twrite_Blxf(null, o); /* top */\n\twrite_Blxf(null, o); /* bottom */\n\twrite_Blxf(null, o); /* left */\n\twrite_Blxf(null, o); /* right */\n\twrite_Blxf(null, o); /* diag */\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.763 BrtStyle TODO */\nfunction write_BrtStyle(style, o) {\n\tif(!o) o = new_buf(12+4*10);\n\to.write_shift(4, style.xfId);\n\to.write_shift(2, 1);\n\to.write_shift(1, +style.builtinId);\n\to.write_shift(1, 0); /* iLevel */\n\twrite_XLNullableWideString(style.name || \"\", o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.272 BrtBeginTableStyles */\nfunction write_BrtBeginTableStyles(cnt, defTableStyle, defPivotStyle) {\n\tvar o = new_buf(4+256*2*4);\n\to.write_shift(4, cnt);\n\twrite_XLNullableWideString(defTableStyle, o);\n\twrite_XLNullableWideString(defPivotStyle, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction parse_sty_bin(data, themes, opts) {\n\tvar styles = {};\n\tstyles.NumberFmt = ([]/*:any*/);\n\tfor(var y in table_fmt) styles.NumberFmt[y] = table_fmt[y];\n\n\tstyles.CellXf = [];\n\tstyles.Fonts = [];\n\tvar state/*:Array<string>*/ = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_sty(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x002C: /* BrtFmt */\n\t\t\t\tstyles.NumberFmt[val[0]] = val[1]; SSF__load(val[1], val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 0x002B: /* BrtFont */\n\t\t\t\tstyles.Fonts.push(val);\n\t\t\t\tif(val.color.theme != null && themes && themes.themeElements && themes.themeElements.clrScheme) {\n\t\t\t\t\tval.color.rgb = rgb_tint(themes.themeElements.clrScheme[val.color.theme].rgb, val.color.tint || 0);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 0x0401: /* BrtKnownFonts */ break;\n\t\t\tcase 0x002D: /* BrtFill */\n\t\t\t\tbreak;\n\t\t\tcase 0x002E: /* BrtBorder */\n\t\t\t\tbreak;\n\t\t\tcase 0x002F: /* BrtXF */\n\t\t\t\tif(state[state.length - 1] == 0x0269 /* BrtBeginCellXFs */) {\n\t\t\t\t\tstyles.CellXf.push(val);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 0x0030: /* BrtStyle */\n\t\t\tcase 0x01FB: /* BrtDXF */\n\t\t\tcase 0x023C: /* BrtMRUColor */\n\t\t\tcase 0x01DB: /* BrtIndexedColor */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0493: /* BrtDXF14 */\n\t\t\tcase 0x0836: /* BrtDXF15 */\n\t\t\tcase 0x046A: /* BrtSlicerStyleElement */\n\t\t\tcase 0x0200: /* BrtTableStyleElement */\n\t\t\tcase 0x082F: /* BrtTimelineStyleElement */\n\t\t\tcase 0x0C00: /* BrtUid */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* BrtFRTBegin */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* BrtFRTEnd */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* BrtACBegin */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* BrtACEnd */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T > 0) state.push(RT);\n\t\t\t\telse if(R.T < 0) state.pop();\n\t\t\t\telse if(!pass || (opts.WTF && state[state.length-1] != 0x0025 /* BrtACBegin */)) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn styles;\n}\n\nfunction write_FMTS_bin(ba, NF/*:?SSFTable*/) {\n\tif(!NF) return;\n\tvar cnt = 0;\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\t/*:: if(!NF) return; */\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) ++cnt;\n\t});\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0267 /* BrtBeginFmts */, write_UInt32LE(cnt));\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\t/*:: if(!NF) return; */\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_record(ba, 0x002C /* BrtFmt */, write_BrtFmt(i, NF[i]));\n\t});\n\twrite_record(ba, 0x0268 /* BrtEndFmts */);\n}\n\nfunction write_FONTS_bin(ba/*::, data*/) {\n\tvar cnt = 1;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0263 /* BrtBeginFonts */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002B /* BrtFont */, write_BrtFont({\n\t\tsz:12,\n\t\tcolor: {theme:1},\n\t\tname: \"Calibri\",\n\t\tfamily: 2,\n\t\tscheme: \"minor\"\n\t}));\n\t/* 1*65491BrtFont [ACFONTS] */\n\twrite_record(ba, 0x0264 /* BrtEndFonts */);\n}\n\nfunction write_FILLS_bin(ba/*::, data*/) {\n\tvar cnt = 2;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x025B /* BrtBeginFills */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002D /* BrtFill */, write_BrtFill({patternType:\"none\"}));\n\twrite_record(ba, 0x002D /* BrtFill */, write_BrtFill({patternType:\"gray125\"}));\n\t/* 1*65431BrtFill */\n\twrite_record(ba, 0x025C /* BrtEndFills */);\n}\n\nfunction write_BORDERS_bin(ba/*::, data*/) {\n\tvar cnt = 1;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0265 /* BrtBeginBorders */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002E /* BrtBorder */, write_BrtBorder({}));\n\t/* 1*65430BrtBorder */\n\twrite_record(ba, 0x0266 /* BrtEndBorders */);\n}\n\nfunction write_CELLSTYLEXFS_bin(ba/*::, data*/) {\n\tvar cnt = 1;\n\twrite_record(ba, 0x0272 /* BrtBeginCellStyleXFs */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002F /* BrtXF */, write_BrtXF({\n\t\tnumFmtId: 0,\n\t\tfontId:   0,\n\t\tfillId:   0,\n\t\tborderId: 0\n\t}, 0xFFFF));\n\t/* 1*65430(BrtXF *FRT) */\n\twrite_record(ba, 0x0273 /* BrtEndCellStyleXFs */);\n}\n\nfunction write_CELLXFS_bin(ba, data) {\n\twrite_record(ba, 0x0269 /* BrtBeginCellXFs */, write_UInt32LE(data.length));\n\tdata.forEach(function(c) { write_record(ba, 0x002F /* BrtXF */, write_BrtXF(c,0)); });\n\t/* 1*65430(BrtXF *FRT) */\n\twrite_record(ba, 0x026A /* BrtEndCellXFs */);\n}\n\nfunction write_STYLES_bin(ba/*::, data*/) {\n\tvar cnt = 1;\n\n\twrite_record(ba, 0x026B /* BrtBeginStyles */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x0030 /* BrtStyle */, write_BrtStyle({\n\t\txfId:0,\n\t\tbuiltinId:0,\n\t\tname:\"Normal\"\n\t}));\n\t/* 1*65430(BrtStyle *FRT) */\n\twrite_record(ba, 0x026C /* BrtEndStyles */);\n}\n\nfunction write_DXFS_bin(ba/*::, data*/) {\n\tvar cnt = 0;\n\n\twrite_record(ba, 0x01F9 /* BrtBeginDXFs */, write_UInt32LE(cnt));\n\t/* *2147483647(BrtDXF *FRT) */\n\twrite_record(ba, 0x01FA /* BrtEndDXFs */);\n}\n\nfunction write_TABLESTYLES_bin(ba/*::, data*/) {\n\tvar cnt = 0;\n\n\twrite_record(ba, 0x01FC /* BrtBeginTableStyles */, write_BrtBeginTableStyles(cnt, \"TableStyleMedium9\", \"PivotStyleMedium4\"));\n\t/* *TABLESTYLE */\n\twrite_record(ba, 0x01FD /* BrtEndTableStyles */);\n}\n\nfunction write_COLORPALETTE_bin(/*::ba, data*/) {\n\treturn;\n\t/* BrtBeginColorPalette [INDEXEDCOLORS] [MRUCOLORS] BrtEndColorPalette */\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction write_sty_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0116 /* BrtBeginStyleSheet */);\n\twrite_FMTS_bin(ba, wb.SSF);\n\twrite_FONTS_bin(ba, wb);\n\twrite_FILLS_bin(ba, wb);\n\twrite_BORDERS_bin(ba, wb);\n\twrite_CELLSTYLEXFS_bin(ba, wb);\n\twrite_CELLXFS_bin(ba, opts.cellXfs);\n\twrite_STYLES_bin(ba, wb);\n\twrite_DXFS_bin(ba, wb);\n\twrite_TABLESTYLES_bin(ba, wb);\n\twrite_COLORPALETTE_bin(ba, wb);\n\t/* FRTSTYLESHEET*/\n\twrite_record(ba, 0x0117 /* BrtEndStyleSheet */);\n\treturn ba.end();\n}\n/* Even though theme layout is dk1 lt1 dk2 lt2, true order is lt1 dk1 lt2 dk2 */\nvar XLSXThemeClrScheme = [\n\t'</a:lt1>', '</a:dk1>', '</a:lt2>', '</a:dk2>',\n\t'</a:accent1>', '</a:accent2>', '</a:accent3>',\n\t'</a:accent4>', '</a:accent5>', '</a:accent6>',\n\t'</a:hlink>', '</a:folHlink>'\n];\n/* 20.1.6.2 clrScheme CT_ColorScheme */\nfunction parse_clrScheme(t, themes, opts) {\n\tthemes.themeElements.clrScheme = [];\n\tvar color = {};\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\t/* 20.1.6.2 clrScheme (Color Scheme) CT_ColorScheme */\n\t\t\tcase '<a:clrScheme': case '</a:clrScheme>': break;\n\n\t\t\t/* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\t\t\tcase '<a:srgbClr':\n\t\t\t\tcolor.rgb = y.val; break;\n\t\t\tcase '</a:srgbClr>': break;\n\n\t\t\t/* 20.1.2.3.33 sysClr CT_SystemColor */\n\t\t\tcase '<a:sysClr':\n\t\t\t\tcolor.rgb = y.lastClr; break;\n\t\t\tcase '</a:sysClr>': break;\n\n\t\t\t/* 20.1.4.1.1 accent1 (Accent 1) */\n\t\t\t/* 20.1.4.1.2 accent2 (Accent 2) */\n\t\t\t/* 20.1.4.1.3 accent3 (Accent 3) */\n\t\t\t/* 20.1.4.1.4 accent4 (Accent 4) */\n\t\t\t/* 20.1.4.1.5 accent5 (Accent 5) */\n\t\t\t/* 20.1.4.1.6 accent6 (Accent 6) */\n\t\t\t/* 20.1.4.1.9 dk1 (Dark 1) */\n\t\t\t/* 20.1.4.1.10 dk2 (Dark 2) */\n\t\t\t/* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\t\t\t/* 20.1.4.1.19 hlink (Hyperlink) */\n\t\t\t/* 20.1.4.1.22 lt1 (Light 1) */\n\t\t\t/* 20.1.4.1.23 lt2 (Light 2) */\n\t\t\tcase '</a:dk1>':\n\t\t\tcase '</a:lt1>':\n\t\t\tcase '<a:dk1>':\n\t\t\tcase '<a:lt1>':\n\t\t\tcase '<a:dk2>': case '</a:dk2>':\n\t\t\tcase '<a:lt2>': case '</a:lt2>':\n\t\t\tcase '<a:accent1>': case '</a:accent1>':\n\t\t\tcase '<a:accent2>': case '</a:accent2>':\n\t\t\tcase '<a:accent3>': case '</a:accent3>':\n\t\t\tcase '<a:accent4>': case '</a:accent4>':\n\t\t\tcase '<a:accent5>': case '</a:accent5>':\n\t\t\tcase '<a:accent6>': case '</a:accent6>':\n\t\t\tcase '<a:hlink>': case '</a:hlink>':\n\t\t\tcase '<a:folHlink>': case '</a:folHlink>':\n\t\t\t\tif (y[0].charAt(1) === '/') {\n\t\t\t\t\tthemes.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(y[0])] = color;\n\t\t\t\t\tcolor = {};\n\t\t\t\t} else {\n\t\t\t\t\tcolor.name = y[0].slice(3, y[0].length - 1);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault: if(opts && opts.WTF) throw new Error('Unrecognized ' + y[0] + ' in clrScheme');\n\t\t}\n\t});\n}\n\n/* 20.1.4.1.18 fontScheme CT_FontScheme */\nfunction parse_fontScheme(/*::t, themes, opts*/) { }\n\n/* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\nfunction parse_fmtScheme(/*::t, themes, opts*/) { }\n\n/* 20.1.6.10 themeElements CT_BaseStyles */\nfunction parse_themeElements(data, themes, opts) {\n\tthemes.themeElements = {};\n\n\tvar t;\n\n\t/* clrScheme CT_ColorScheme */\n\tif(!(t=str_match_xml(data, \"a:clrScheme\"))) throw new Error('clrScheme not found in themeElements');\n\tparse_clrScheme(t, themes, opts);\n\n\t/* fontScheme CT_FontScheme */\n\tif(!(t=str_match_xml(data, \"a:fontScheme\"))) throw new Error('fontScheme not found in themeElements');\n\tparse_fontScheme(t, themes, opts);\n\n\t/* fmtScheme CT_StyleMatrix */\n\tif(!(t=str_match_xml(data, \"a:fmtScheme\"))) throw new Error('fmtScheme not found in themeElements');\n\tparse_fmtScheme(t, themes, opts);\n}\n\n/* 14.2.7 Theme Part */\nfunction parse_theme_xml(data/*:string*/, opts) {\n\t/* 20.1.6.9 theme CT_OfficeStyleSheet */\n\tif(!data || data.length === 0) data = write_theme();\n\n\tvar t;\n\tvar themes = {};\n\n\t/* themeElements CT_BaseStyles */\n\tif(!(t=str_match_xml(data, \"a:themeElements\"))) throw new Error('themeElements not found in theme');\n\tparse_themeElements(t[0], themes, opts);\n\tthemes.raw = data;\n\treturn themes;\n}\n\nfunction write_theme(Themes, opts)/*:string*/ {\n\tif(opts && opts.themeXLSX) return opts.themeXLSX;\n\tif(Themes && typeof Themes.raw == \"string\") return Themes.raw;\n\tvar o = [XML_HEADER];\n\to[o.length] = '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';\n\to[o.length] =  '<a:themeElements>';\n\n\to[o.length] =   '<a:clrScheme name=\"Office\">';\n\to[o.length] =    '<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';\n\to[o.length] =    '<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';\n\to[o.length] =    '<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';\n\to[o.length] =    '<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';\n\to[o.length] =    '<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';\n\to[o.length] =    '<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';\n\to[o.length] =    '<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';\n\to[o.length] =    '<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';\n\to[o.length] =    '<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';\n\to[o.length] =    '<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';\n\to[o.length] =    '<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';\n\to[o.length] =    '<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';\n\to[o.length] =   '</a:clrScheme>';\n\n\to[o.length] =   '<a:fontScheme name=\"Office\">';\n\to[o.length] =    '<a:majorFont>';\n\to[o.length] =     '<a:latin typeface=\"Cambria\"/>';\n\to[o.length] =     '<a:ea typeface=\"\"/>';\n\to[o.length] =     '<a:cs typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/>';\n\to[o.length] =     '<a:font script=\"Hang\" typeface=\"맑은 고딕\"/>';\n\to[o.length] =     '<a:font script=\"Hans\" typeface=\"宋体\"/>';\n\to[o.length] =     '<a:font script=\"Hant\" typeface=\"新細明體\"/>';\n\to[o.length] =     '<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n\to[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n\to[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n\to[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n\to[o.length] =     '<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';\n\to[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n\to[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n\to[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n\to[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n\to[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n\to[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n\to[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n\to[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n\to[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n\to[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n\to[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n\to[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n\to[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n\to[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n\to[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n\to[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n\to[o.length] =    '</a:majorFont>';\n\to[o.length] =    '<a:minorFont>';\n\to[o.length] =     '<a:latin typeface=\"Calibri\"/>';\n\to[o.length] =     '<a:ea typeface=\"\"/>';\n\to[o.length] =     '<a:cs typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/>';\n\to[o.length] =     '<a:font script=\"Hang\" typeface=\"맑은 고딕\"/>';\n\to[o.length] =     '<a:font script=\"Hans\" typeface=\"宋体\"/>';\n\to[o.length] =     '<a:font script=\"Hant\" typeface=\"新細明體\"/>';\n\to[o.length] =     '<a:font script=\"Arab\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Hebr\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n\to[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n\to[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n\to[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n\to[o.length] =     '<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';\n\to[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n\to[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n\to[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n\to[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n\to[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n\to[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n\to[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n\to[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n\to[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n\to[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n\to[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n\to[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n\to[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n\to[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n\to[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Viet\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n\to[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n\to[o.length] =    '</a:minorFont>';\n\to[o.length] =   '</a:fontScheme>';\n\n\to[o.length] =   '<a:fmtScheme name=\"Office\">';\n\to[o.length] =    '<a:fillStyleLst>';\n\to[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:lin ang=\"16200000\" scaled=\"1\"/>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:lin ang=\"16200000\" scaled=\"0\"/>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =    '</a:fillStyleLst>';\n\to[o.length] =    '<a:lnStyleLst>';\n\to[o.length] =     '<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =     '<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =     '<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =    '</a:lnStyleLst>';\n\to[o.length] =    '<a:effectStyleLst>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =      '<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';\n\to[o.length] =      '<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =    '</a:effectStyleLst>';\n\to[o.length] =    '<a:bgFillStyleLst>';\n\to[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =    '</a:bgFillStyleLst>';\n\to[o.length] =   '</a:fmtScheme>';\n\to[o.length] =  '</a:themeElements>';\n\n\to[o.length] =  '<a:objectDefaults>';\n\to[o.length] =   '<a:spDef>';\n\to[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';\n\to[o.length] =   '</a:spDef>';\n\to[o.length] =   '<a:lnDef>';\n\to[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';\n\to[o.length] =   '</a:lnDef>';\n\to[o.length] =  '</a:objectDefaults>';\n\to[o.length] =  '<a:extraClrSchemeLst/>';\n\to[o.length] = '</a:theme>';\n\treturn o.join(\"\");\n}\n/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\nfunction parse_Theme(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar dwThemeVersion = blob.read_shift(4);\n\tif(dwThemeVersion === 124226) return;\n\tif(!opts.cellStyles) { blob.l = end; return; }\n\tvar data = blob.slice(blob.l);\n\tblob.l = end;\n\tvar zip; try { zip = zip_read(data, {type: \"array\"}); } catch(e) { return; }\n\tvar themeXML = getzipstr(zip, \"theme/theme/theme1.xml\", true);\n\tif(!themeXML) return;\n\treturn parse_theme_xml(themeXML, opts);\n}\n\n/* 2.5.49 */\nfunction parse_ColorTheme(blob/*::, length*/) { return blob.read_shift(4); }\n\n/* 2.5.155 */\nfunction parse_FullColorExt(blob/*::, length*/) {\n\tvar o = {};\n\to.xclrType = blob.read_shift(2);\n\to.nTintShade = blob.read_shift(2);\n\tswitch(o.xclrType) {\n\t\tcase 0: blob.l += 4; break;\n\t\tcase 1: o.xclrValue = parse_IcvXF(blob, 4); break;\n\t\tcase 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\n\t\tcase 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\n\t\tcase 4: blob.l += 4; break;\n\t}\n\tblob.l += 8;\n\treturn o;\n}\n\n/* 2.5.164 TODO: read 7 bits*/\nfunction parse_IcvXF(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* 2.5.280 */\nfunction parse_XFExtGradient(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* [MS-XLS] 2.5.108 */\nfunction parse_ExtProp(blob/*::, length*/)/*:Array<any>*/ {\n\tvar extType = blob.read_shift(2);\n\tvar cb = blob.read_shift(2) - 4;\n\tvar o = [extType];\n\tswitch(extType) {\n\t\tcase 0x04: case 0x05: case 0x07: case 0x08:\n\t\tcase 0x09: case 0x0A: case 0x0B: case 0x0D:\n\t\t\to[1] = parse_FullColorExt(blob, cb); break;\n\t\tcase 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\n\t\tcase 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 1 ? 1 : 2); break;\n\t\tdefault: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n\t}\n\treturn o;\n}\n\n/* 2.4.355 */\nfunction parse_XFExt(blob, length) {\n\tvar end = blob.l + length;\n\tblob.l += 2;\n\tvar ixfe = blob.read_shift(2);\n\tblob.l += 2;\n\tvar cexts = blob.read_shift(2);\n\tvar ext/*:AOA*/ = [];\n\twhile(cexts-- > 0) ext.push(parse_ExtProp(blob, end-blob.l));\n\treturn {ixfe:ixfe, ext:ext};\n}\n\n/* xf is an XF, see parse_XFExt for xfext */\nfunction update_xfext(xf, xfext) {\n\txfext.forEach(function(xfe) {\n\t\tswitch(xfe[0]) { /* 2.5.108 extPropData */\n\t\t\tcase 0x04: break; /* foreground color */\n\t\t\tcase 0x05: break; /* background color */\n\t\t\tcase 0x06: break; /* gradient fill */\n\t\t\tcase 0x07: break; /* top cell border color */\n\t\t\tcase 0x08: break; /* bottom cell border color */\n\t\t\tcase 0x09: break; /* left cell border color */\n\t\t\tcase 0x0a: break; /* right cell border color */\n\t\t\tcase 0x0b: break; /* diagonal cell border color */\n\t\t\tcase 0x0d: /* text color */\n\t\t\t\tbreak;\n\t\t\tcase 0x0e: break; /* font scheme */\n\t\t\tcase 0x0f: break; /* indentation level */\n\t\t}\n\t});\n}\n\nfunction parse_BrtMdtinfo(data, length) {\n  return {\n    flags: data.read_shift(4),\n    version: data.read_shift(4),\n    name: parse_XLWideString(data, length - 8)\n  };\n}\nfunction write_BrtMdtinfo(data) {\n  var o = new_buf(12 + 2 * data.name.length);\n  o.write_shift(4, data.flags);\n  o.write_shift(4, data.version);\n  write_XLWideString(data.name, o);\n  return o.slice(0, o.l);\n}\nfunction parse_BrtMdb(data) {\n  var out = [];\n  var cnt = data.read_shift(4);\n  while (cnt-- > 0)\n    out.push([data.read_shift(4), data.read_shift(4)]);\n  return out;\n}\nfunction write_BrtMdb(mdb) {\n  var o = new_buf(4 + 8 * mdb.length);\n  o.write_shift(4, mdb.length);\n  for (var i = 0; i < mdb.length; ++i) {\n    o.write_shift(4, mdb[i][0]);\n    o.write_shift(4, mdb[i][1]);\n  }\n  return o;\n}\nfunction write_BrtBeginEsfmd(cnt, name) {\n  var o = new_buf(8 + 2 * name.length);\n  o.write_shift(4, cnt);\n  write_XLWideString(name, o);\n  return o.slice(0, o.l);\n}\nfunction parse_BrtBeginEsmdb(data) {\n  data.l += 4;\n  return data.read_shift(4) != 0;\n}\nfunction write_BrtBeginEsmdb(cnt, cm) {\n  var o = new_buf(8);\n  o.write_shift(4, cnt);\n  o.write_shift(4, cm ? 1 : 0);\n  return o;\n}\nfunction parse_xlmeta_bin(data, name, _opts) {\n  var out = { Types: [], Cell: [], Value: [] };\n  var opts = _opts || {};\n  var state = [];\n  var pass = false;\n  var metatype = 2;\n  recordhopper(data, function(val, R, RT) {\n    switch (RT) {\n      case 335:\n        out.Types.push({ name: val.name });\n        break;\n      case 51:\n        val.forEach(function(r) {\n          if (metatype == 1)\n            out.Cell.push({ type: out.Types[r[0] - 1].name, index: r[1] });\n          else if (metatype == 0)\n            out.Value.push({ type: out.Types[r[0] - 1].name, index: r[1] });\n        });\n        break;\n      case 337:\n        metatype = val ? 1 : 0;\n        break;\n      case 338:\n        metatype = 2;\n        break;\n      case 35:\n        state.push(RT);\n        pass = true;\n        break;\n      case 36:\n        state.pop();\n        pass = false;\n        break;\n      default:\n        if (R.T) {\n        } else if (!pass || opts.WTF && state[state.length - 1] != 35)\n          throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return out;\n}\nfunction write_xlmeta_bin() {\n  var ba = buf_array();\n  write_record(ba, 332);\n  write_record(ba, 334, write_UInt32LE(1));\n  write_record(ba, 335, write_BrtMdtinfo({\n    name: \"XLDAPR\",\n    version: 12e4,\n    flags: 3496657072\n  }));\n  write_record(ba, 336);\n  write_record(ba, 339, write_BrtBeginEsfmd(1, \"XLDAPR\"));\n  write_record(ba, 52);\n  write_record(ba, 35, write_UInt32LE(514));\n  write_record(ba, 4096, write_UInt32LE(0));\n  write_record(ba, 4097, writeuint16(1));\n  write_record(ba, 36);\n  write_record(ba, 53);\n  write_record(ba, 340);\n  write_record(ba, 337, write_BrtBeginEsmdb(1, true));\n  write_record(ba, 51, write_BrtMdb([[1, 0]]));\n  write_record(ba, 338);\n  write_record(ba, 333);\n  return ba.end();\n}\nfunction parse_xlmeta_xml(data, name, opts) {\n  var out = { Types: [], Cell: [], Value: [] };\n  if (!data)\n    return out;\n  var pass = false;\n  var metatype = 2;\n  var lastmeta;\n  data.replace(tagregex, function(x) {\n    var y = parsexmltag(x);\n    switch (strip_ns(y[0])) {\n      case \"<?xml\":\n        break;\n      case \"<metadata\":\n      case \"</metadata>\":\n        break;\n      case \"<metadataTypes\":\n      case \"</metadataTypes>\":\n        break;\n      case \"<metadataType\":\n        out.Types.push({ name: y.name });\n        break;\n      case \"</metadataType>\":\n        break;\n      case \"<futureMetadata\":\n        for (var j = 0; j < out.Types.length; ++j)\n          if (out.Types[j].name == y.name)\n            lastmeta = out.Types[j];\n        break;\n      case \"</futureMetadata>\":\n        break;\n      case \"<bk>\":\n        break;\n      case \"</bk>\":\n        break;\n      case \"<rc\":\n        if (metatype == 1)\n          out.Cell.push({ type: out.Types[y.t - 1].name, index: +y.v });\n        else if (metatype == 0)\n          out.Value.push({ type: out.Types[y.t - 1].name, index: +y.v });\n        break;\n      case \"</rc>\":\n        break;\n      case \"<cellMetadata\":\n        metatype = 1;\n        break;\n      case \"</cellMetadata>\":\n        metatype = 2;\n        break;\n      case \"<valueMetadata\":\n        metatype = 0;\n        break;\n      case \"</valueMetadata>\":\n        metatype = 2;\n        break;\n      case \"<extLst\":\n      case \"<extLst>\":\n      case \"</extLst>\":\n      case \"<extLst/>\":\n        break;\n      case \"<ext\":\n        pass = true;\n        break;\n      case \"</ext>\":\n        pass = false;\n        break;\n      case \"<rvb\":\n        if (!lastmeta)\n          break;\n        if (!lastmeta.offsets)\n          lastmeta.offsets = [];\n        lastmeta.offsets.push(+y.i);\n        break;\n      default:\n        if (!pass && (opts == null ? void 0 : opts.WTF))\n          throw new Error(\"unrecognized \" + y[0] + \" in metadata\");\n    }\n    return x;\n  });\n  return out;\n}\nfunction write_xlmeta_xml() {\n  var o = [XML_HEADER];\n  o.push('<metadata xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:xlrd=\"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata\" xmlns:xda=\"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray\">\\n  <metadataTypes count=\"1\">\\n    <metadataType name=\"XLDAPR\" minSupportedVersion=\"120000\" copy=\"1\" pasteAll=\"1\" pasteValues=\"1\" merge=\"1\" splitFirst=\"1\" rowColShift=\"1\" clearFormats=\"1\" clearComments=\"1\" assign=\"1\" coerce=\"1\" cellMeta=\"1\"/>\\n  </metadataTypes>\\n  <futureMetadata name=\"XLDAPR\" count=\"1\">\\n    <bk>\\n      <extLst>\\n        <ext uri=\"{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}\">\\n          <xda:dynamicArrayProperties fDynamic=\"1\" fCollapsed=\"0\"/>\\n        </ext>\\n      </extLst>\\n    </bk>\\n  </futureMetadata>\\n  <cellMetadata count=\"1\">\\n    <bk>\\n      <rc t=\"1\" v=\"0\"/>\\n    </bk>\\n  </cellMetadata>\\n</metadata>');\n  return o.join(\"\");\n}\n/* 18.6 Calculation Chain */\nfunction parse_cc_xml(data/*::, name, opts*/)/*:Array<any>*/ {\n\tvar d = [];\n\tif(!data) return d;\n\tvar i = 1;\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<?xml': break;\n\t\t\t/* 18.6.2  calcChain CT_CalcChain 1 */\n\t\t\tcase '<calcChain': case '<calcChain>': case '</calcChain>': break;\n\t\t\t/* 18.6.1  c CT_CalcCell 1 */\n\t\t\tcase '<c': delete y[0]; if(y.i) i = y.i; else y.i = i; d.push(y); break;\n\t\t}\n\t});\n\treturn d;\n}\n\n//function write_cc_xml(data, opts) { }\n\n/* [MS-XLSB] 2.6.4.1 */\nfunction parse_BrtCalcChainItem$(data) {\n\tvar out = {};\n\tout.i = data.read_shift(4);\n\tvar cell = {};\n\tcell.r = data.read_shift(4);\n\tcell.c = data.read_shift(4);\n\tout.r = encode_cell(cell);\n\tvar flags = data.read_shift(1);\n\tif(flags & 0x2) out.l = '1';\n\tif(flags & 0x8) out.a = '1';\n\treturn out;\n}\n\n/* 18.6 Calculation Chain */\nfunction parse_cc_bin(data, name, opts) {\n\tvar out = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_cc(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x003F: /* 'BrtCalcChainItem$' */\n\t\t\t\tout.push(val); break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn out;\n}\n\n//function write_cc_bin(data, opts) { }\n/* 18.14 Supplementary Workbook Data */\nfunction parse_xlink_xml(/*::data, rel, name:string, _opts*/) {\n\t//var opts = _opts || {};\n\t//if(opts.WTF) throw \"XLSX External Link\";\n}\n\n/* [MS-XLSB] 2.1.7.25 External Link */\nfunction parse_xlink_bin(data, rel, name/*:string*/, _opts) {\n\tif(!data) return data;\n\tvar opts = _opts || {};\n\n\tvar pass = false, end = false;\n\n\trecordhopper(data, function xlink_parse(val, R, RT) {\n\t\tif(end) return;\n\t\tswitch(RT) {\n\t\t\tcase 0x0167: /* 'BrtSupTabs' */\n\t\t\tcase 0x016B: /* 'BrtExternTableStart' */\n\t\t\tcase 0x016C: /* 'BrtExternTableEnd' */\n\t\t\tcase 0x016E: /* 'BrtExternRowHdr' */\n\t\t\tcase 0x016F: /* 'BrtExternCellBlank' */\n\t\t\tcase 0x0170: /* 'BrtExternCellReal' */\n\t\t\tcase 0x0171: /* 'BrtExternCellBool' */\n\t\t\tcase 0x0172: /* 'BrtExternCellError' */\n\t\t\tcase 0x0173: /* 'BrtExternCellString' */\n\t\t\tcase 0x01D8: /* 'BrtExternValueMeta' */\n\t\t\tcase 0x0241: /* 'BrtSupNameStart' */\n\t\t\tcase 0x0242: /* 'BrtSupNameValueStart' */\n\t\t\tcase 0x0243: /* 'BrtSupNameValueEnd' */\n\t\t\tcase 0x0244: /* 'BrtSupNameNum' */\n\t\t\tcase 0x0245: /* 'BrtSupNameErr' */\n\t\t\tcase 0x0246: /* 'BrtSupNameSt' */\n\t\t\tcase 0x0247: /* 'BrtSupNameNil' */\n\t\t\tcase 0x0248: /* 'BrtSupNameBool' */\n\t\t\tcase 0x0249: /* 'BrtSupNameFmla' */\n\t\t\tcase 0x024A: /* 'BrtSupNameBits' */\n\t\t\tcase 0x024B: /* 'BrtSupNameEnd' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n}\n/* 20.5 DrawingML - SpreadsheetML Drawing */\n/* 20.5.2.35 wsDr CT_Drawing */\nfunction parse_drawing(data, rels/*:any*/) {\n\tif(!data) return \"??\";\n\t/*\n\t  Chartsheet Drawing:\n\t   - 20.5.2.35 wsDr CT_Drawing\n\t    - 20.5.2.1  absoluteAnchor CT_AbsoluteAnchor\n\t     - 20.5.2.16 graphicFrame CT_GraphicalObjectFrame\n\t      - 20.1.2.2.16 graphic CT_GraphicalObject\n\t       - 20.1.2.2.17 graphicData CT_GraphicalObjectData\n          - chart reference\n\t   the actual type is based on the URI of the graphicData\n\t\tTODO: handle embedded charts and other types of graphics\n\t*/\n\tvar id = (data.match(/<c:chart [^<>]*r:id=\"([^<>\"]*)\"/)||[\"\",\"\"])[1];\n\n\treturn rels['!id'][id].Target;\n}\n\n/* L.5.5.2 SpreadsheetML Comments + VML Schema */\nfunction parse_vml(data/*:string*/, sheet, comments) {\n\tvar cidx = 0;\n\t(str_match_xml_ns_g(data, \"shape\")||[]).forEach(function(m) {\n\t\tvar type = \"\";\n\t\tvar hidden = true;\n\t\tvar aidx = -1;\n\t\tvar R = -1, C = -1;\n\t\tm.replace(tagregex, function(x/*:string*/, idx/*:number*/) {\n\t\t\tvar y = parsexmltag(x);\n\t\t\tswitch(strip_ns(y[0])) {\n\t\t\t\tcase '<ClientData': if(y.ObjectType) type = y.ObjectType; break;\n\n\t\t\t\tcase '<Visible': case '<Visible/>': hidden = false; break;\n\n\t\t\t\tcase '<Row': case '<Row>': aidx = idx + x.length; break;\n\t\t\t\tcase '</Row>': R = +m.slice(aidx, idx).trim(); break;\n\n\t\t\t\tcase '<Column': case '<Column>': aidx = idx + x.length; break;\n\t\t\t\tcase '</Column>': C = +m.slice(aidx, idx).trim(); break;\n\t\t\t}\n\t\t\treturn \"\";\n\t\t});\n\t\tswitch(type) {\n\t\tcase 'Note':\n\t\t\tvar cell = ws_get_cell_stub(sheet, ((R>=0 && C>=0) ? encode_cell({r:R,c:C}) : comments[cidx].ref));\n\t\t\tif(cell.c) {\n\t\t\t\tcell.c.hidden = hidden;\n\t\t\t}\n\t\t\t++cidx;\n\t\t\tbreak;\n\t\t}\n\n\t});\n}\n\n\n/* comment boxes */\nfunction write_vml(rId/*:number*/, comments, ws) {\n\tvar csize = [21600, 21600];\n\t/* L.5.2.1.2 Path Attribute */\n\tvar bbox = [\"m0,0l0\",csize[1],csize[0],csize[1],csize[0],\"0xe\"].join(\",\");\n\tvar o = [\n\t\twritextag(\"xml\", null, { 'xmlns:v': XLMLNS.v, 'xmlns:o': XLMLNS.o, 'xmlns:x': XLMLNS.x, 'xmlns:mv': XLMLNS.mv }).replace(/\\/>/,\">\"),\n\t\twritextag(\"o:shapelayout\", writextag(\"o:idmap\", null, {'v:ext':\"edit\", 'data':rId}), {'v:ext':\"edit\"})\n\t];\n\n\tvar _shapeid = 65536 * rId;\n\n\tvar _comments = comments || [];\n\tif(_comments.length > 0) o.push(writextag(\"v:shapetype\", [\n\t\twritextag(\"v:stroke\", null, {joinstyle:\"miter\"}),\n\t\twritextag(\"v:path\", null, {gradientshapeok:\"t\", 'o:connecttype':\"rect\"})\n\t].join(\"\"), {id:\"_x0000_t202\", coordsize:csize.join(\",\"), 'o:spt':202, path:bbox}));\n\n\t_comments.forEach(function(x) { ++_shapeid; o.push(write_vml_comment(x, _shapeid)); });\n\to.push('</xml>');\n\treturn o.join(\"\");\n}\n\nfunction write_vml_comment(x, _shapeid, ws)/*:string*/ {\n\tvar c = decode_cell(x[0]);\n\tvar fillopts = /*::(*/{'color2':\"#BEFF82\", 'type':\"gradient\"}/*:: :any)*/;\n\tif(fillopts.type == \"gradient\") fillopts.angle = \"-180\";\n\tvar fillparm = fillopts.type == \"gradient\" ? writextag(\"o:fill\", null, {type:\"gradientUnscaled\", 'v:ext':\"view\"}) : null;\n\tvar fillxml = writextag('v:fill', fillparm, fillopts);\n\n\tvar shadata = ({on:\"t\", 'obscured':\"t\"}/*:any*/);\n\n\treturn [\n\t'<v:shape' + wxt_helper({\n\t\tid:'_x0000_s' + _shapeid,\n\t\ttype:\"#_x0000_t202\",\n\t\tstyle:\"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\" + (x[1].hidden ? \";visibility:hidden\" : \"\") ,\n\t\tfillcolor:\"#ECFAD4\",\n\t\tstrokecolor:\"#edeaa1\"\n\t}) + '>',\n\t\tfillxml,\n\t\twritextag(\"v:shadow\", null, shadata),\n\t\twritextag(\"v:path\", null, {'o:connecttype':\"none\"}),\n\t\t'<v:textbox><div style=\"text-align:left\"></div></v:textbox>',\n\t\t'<x:ClientData ObjectType=\"Note\">',\n\t\t\t'<x:MoveWithCells/>',\n\t\t\t'<x:SizeWithCells/>',\n\t\t\t/* Part 4 19.4.2.3 Anchor (Anchor) */\n\t\t\twritetag('x:Anchor', [c.c+1, 0, c.r+1, 0, c.c+3, 20, c.r+5, 20].join(\",\")),\n\t\t\twritetag('x:AutoFill', \"False\"),\n\t\t\twritetag('x:Row', String(c.r)),\n\t\t\twritetag('x:Column', String(c.c)),\n\t\t\tx[1].hidden ? '' : '<x:Visible/>',\n\t\t'</x:ClientData>',\n\t'</v:shape>'\n\t].join(\"\");\n}\nfunction sheet_insert_comments(sheet/*:WorkSheet*/, comments/*:Array<RawComment>*/, threaded/*:boolean*/, people/*:?Array<any>*/) {\n\tvar dense = sheet[\"!data\"] != null;\n\tvar cell/*:Cell*/;\n\tcomments.forEach(function(comment) {\n\t\tvar r = decode_cell(comment.ref);\n\t\tif(r.r < 0 || r.c < 0) return;\n\t\tif(dense) {\n\t\t\tif(!sheet[\"!data\"][r.r]) sheet[\"!data\"][r.r] = [];\n\t\t\tcell = sheet[\"!data\"][r.r][r.c];\n\t\t} else cell = sheet[comment.ref];\n\t\tif (!cell) {\n\t\t\tcell = ({t:\"z\"}/*:any*/);\n\t\t\tif(dense) sheet[\"!data\"][r.r][r.c] = cell;\n\t\t\telse sheet[comment.ref] = cell;\n\t\t\tvar range = safe_decode_range(sheet[\"!ref\"]||\"BDWGO1000001:A1\");\n\t\t\tif(range.s.r > r.r) range.s.r = r.r;\n\t\t\tif(range.e.r < r.r) range.e.r = r.r;\n\t\t\tif(range.s.c > r.c) range.s.c = r.c;\n\t\t\tif(range.e.c < r.c) range.e.c = r.c;\n\t\t\tvar encoded = encode_range(range);\n\t\t\tsheet[\"!ref\"] = encoded;\n\t\t}\n\n\t\tif (!cell.c) cell.c = [];\n\t\tvar o/*:Comment*/ = ({a: comment.author, t: comment.t, r: comment.r, T: threaded});\n\t\tif(comment.h) o.h = comment.h;\n\n\t\t/* threaded comments always override */\n\t\tfor(var i = cell.c.length - 1; i >= 0; --i) {\n\t\t\tif(!threaded && cell.c[i].T) return;\n\t\t\tif(threaded && !cell.c[i].T) cell.c.splice(i, 1);\n\t\t}\n\t\tif(threaded && people) for(i = 0; i < people.length; ++i) {\n\t\t\tif(o.a == people[i].id) { o.a = people[i].name || o.a; break; }\n\t\t}\n\t\tcell.c.push(o);\n\t});\n}\n/* 18.7 Comments */\nfunction parse_comments_xml(data/*:string*/, opts)/*:Array<RawComment>*/ {\n\t/* 18.7.6 CT_Comments */\n\tif(data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n\tvar authors/*:Array<string>*/ = [];\n\tvar commentList/*:Array<RawComment>*/ = [];\n\tvar authtag = str_match_xml_ns(data, \"authors\");\n\tif(authtag && authtag[1]) authtag[1].split(/<\\/\\w*:?author>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar a = x.match(/<(?:\\w+:)?author[^<>]*>(.*)/);\n\t\tif(a) authors.push(a[1]);\n\t});\n\tvar cmnttag = str_match_xml_ns(data, \"commentList\");\n\tif(cmnttag && cmnttag[1]) cmnttag[1].split(/<\\/\\w*:?comment>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar cm = x.match(/<(?:\\w+:)?comment[^<>]*>/);\n\t\tif(!cm) return;\n\t\tvar y = parsexmltag(cm[0]);\n\t\tvar comment/*:RawComment*/ = ({ author: y.authorId && authors[y.authorId] || \"sheetjsghost\", ref: y.ref, guid: y.guid }/*:any*/);\n\t\tvar cell = decode_cell(y.ref);\n\t\tif(opts.sheetRows && opts.sheetRows <= cell.r) return;\n\t\tvar textMatch = str_match_xml_ns(x, \"text\");\n\t\tvar rt = !!textMatch && !!textMatch[1] && parse_si(textMatch[1]) || {r:\"\",t:\"\",h:\"\"};\n\t\tcomment.r = rt.r;\n\t\tif(rt.r == \"<t></t>\") rt.t = rt.h = \"\";\n\t\tcomment.t = (rt.t||\"\").replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\n\t\tif(opts.cellHTML) comment.h = rt.h;\n\t\tcommentList.push(comment);\n\t});\n\treturn commentList;\n}\n\nfunction write_comments_xml(data/*::, opts*/) {\n\tvar o = [XML_HEADER, writextag('comments', null, { 'xmlns': XMLNS_main[0] })];\n\n\tvar iauthor/*:Array<string>*/ = [];\n\to.push(\"<authors>\");\n\tdata.forEach(function(x) { x[1].forEach(function(w) { var a = escapexml(w.a);\n\t\tif(iauthor.indexOf(a) == -1) {\n\t\t\tiauthor.push(a);\n\t\t\to.push(\"<author>\" + a + \"</author>\");\n\t\t}\n\t\tif(w.T && w.ID && iauthor.indexOf(\"tc=\" + w.ID) == -1) {\n\t\t\tiauthor.push(\"tc=\" + w.ID);\n\t\t\to.push(\"<author>\" + \"tc=\" + w.ID + \"</author>\");\n\t\t}\n\t}); });\n\tif(iauthor.length == 0) { iauthor.push(\"SheetJ5\"); o.push(\"<author>SheetJ5</author>\"); }\n\to.push(\"</authors>\");\n\to.push(\"<commentList>\");\n\tdata.forEach(function(d) {\n\t\t/* 18.7.3 CT_Comment */\n\t\tvar lastauthor = 0, ts = [], tcnt = 0;\n\t\tif(d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);\n\t\td[1].forEach(function(c) {\n\t\t\tif(c.a) lastauthor = iauthor.indexOf(escapexml(c.a));\n\t\t\tif(c.T) ++tcnt;\n\t\t\tts.push(c.t == null ? \"\" : escapexml(c.t));\n\t\t});\n\t\tif(tcnt === 0) {\n\t\t\td[1].forEach(function(c) {\n\t\t\t\to.push('<comment ref=\"' + d[0] + '\" authorId=\"' + iauthor.indexOf(escapexml(c.a)) + '\"><text>');\n\t\t\t\to.push(writetag(\"t\", c.t == null ? \"\" : escapexml(c.t)));\n\t\t\t\to.push('</text></comment>');\n\t\t\t});\n\t\t} else {\n\t\t\tif(d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);\n\t\t\t/* based on Threaded Comments -> Comments projection */\n\t\t\to.push('<comment ref=\"' + d[0] + '\" authorId=\"' + lastauthor + '\"><text>');\n\t\t\tvar t = \"Comment:\\n    \" + (ts[0]) + \"\\n\";\n\t\t\tfor(var i = 1; i < ts.length; ++i) t += \"Reply:\\n    \" + ts[i] + \"\\n\";\n\t\t\to.push(writetag(\"t\", escapexml(t)));\n\t\t\to.push('</text></comment>');\n\t\t}\n\t});\n\to.push(\"</commentList>\");\n\tif(o.length>2) { o[o.length] = ('</comments>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSX] 2.1.17 */\nfunction parse_tcmnt_xml(data/*:string*/, opts)/*:Array<RawComment>*/ {\n\tvar out = [];\n\tvar pass = false, comment = {}, tidx = 0;\n\tdata.replace(tagregex, function xml_tcmnt(x, idx) {\n\t\tvar y/*:any*/ = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 2.6.207 ThreadedComments CT_ThreadedComments */\n\t\t\tcase '<ThreadedComments': break;\n\t\t\tcase '</ThreadedComments>': break;\n\n\t\t\t/* 2.6.205 threadedComment CT_ThreadedComment */\n\t\t\tcase '<threadedComment': comment = {author: y.personId, guid: y.id, ref: y.ref, T: 1}; break;\n\t\t\tcase '</threadedComment>': if(comment.t != null) out.push(comment); break;\n\n\t\t\tcase '<text>': case '<text': tidx = idx + x.length; break;\n\t\t\tcase '</text>': comment.t = data.slice(tidx, idx).replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\"); break;\n\n\t\t\t/* 2.6.206 mentions CT_ThreadedCommentMentions TODO */\n\t\t\tcase '<mentions': case '<mentions>': pass = true; break;\n\t\t\tcase '</mentions>': pass = false; break;\n\n\t\t\t/* 2.6.202 mention CT_Mention TODO */\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break;\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\n\nfunction write_tcmnt_xml(comments, people, opts) {\n\tvar o = [XML_HEADER, writextag('ThreadedComments', null, { 'xmlns': XMLNS.TCMNT }).replace(/[\\/]>/, \">\")];\n\tcomments.forEach(function(carr) {\n\t\tvar rootid = \"\";\n\t\t(carr[1] || []).forEach(function(c, idx) {\n\t\t\tif(!c.T) { delete c.ID; return; }\n\t\t\tif(c.a && people.indexOf(c.a) == -1) people.push(c.a);\n\t\t\tvar tcopts = {\n\t\t\t\tref: carr[0],\n\t\t\t\tid: \"{54EE7951-7262-4200-6969-\" + (\"000000000000\" + opts.tcid++).slice(-12) + \"}\"\n\t\t\t};\n\t\t\tif(idx == 0) rootid = tcopts.id;\n\t\t\telse tcopts.parentId = rootid;\n\t\t\tc.ID = tcopts.id;\n\t\t\tif(c.a) tcopts.personId = \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + people.indexOf(c.a)).slice(-12) + \"}\";\n\t\t\to.push(writextag('threadedComment', writetag('text', c.t||\"\"), tcopts));\n\t\t});\n\t});\n\to.push('</ThreadedComments>');\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSX] 2.1.18 */\nfunction parse_people_xml(data/*:string*/, opts) {\n\tvar out = [];\n\tvar pass = false;\n\tdata.replace(tagregex, function xml_tcmnt(x) {\n\t\tvar y/*:any*/ = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 2.4.85 personList CT_PersonList */\n\t\t\tcase '<personList': break;\n\t\t\tcase '</personList>': break;\n\n\t\t\t/* 2.6.203 person CT_Person TODO: providers */\n\t\t\tcase '<person': out.push({name: y.displayname, id: y.id }); break;\n\t\t\tcase '</person>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break;\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\nfunction write_people_xml(people/*, opts*/) {\n\tvar o = [XML_HEADER, writextag('personList', null, {\n\t\t'xmlns': XMLNS.TCMNT,\n\t\t'xmlns:x': XMLNS_main[0]\n\t}).replace(/[\\/]>/, \">\")];\n\tpeople.forEach(function(person, idx) {\n\t\to.push(writextag('person', null, {\n\t\t\tdisplayName: person,\n\t\t\tid: \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + idx).slice(-12) + \"}\",\n\t\t\tuserId: person,\n\t\t\tproviderId: \"None\"\n\t\t}));\n\t});\n\to.push(\"</personList>\");\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.28 BrtBeginComment */\nfunction parse_BrtBeginComment(data) {\n\tvar out = {};\n\tout.iauthor = data.read_shift(4);\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tout.rfx = rfx.s;\n\tout.ref = encode_cell(rfx.s);\n\tdata.l += 16; /*var guid = parse_GUID(data); */\n\treturn out;\n}\nfunction write_BrtBeginComment(data, o) {\n\tif(o == null) o = new_buf(36);\n\to.write_shift(4, data[1].iauthor);\n\twrite_UncheckedRfX((data[0]/*:any*/), o);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.327 BrtCommentAuthor */\nvar parse_BrtCommentAuthor = parse_XLWideString;\nfunction write_BrtCommentAuthor(data) { return write_XLWideString(data.slice(0, 54)); }\n\n/* [MS-XLSB] 2.1.7.8 Comments */\nfunction parse_comments_bin(data, opts)/*:Array<RawComment>*/ {\n\tvar out/*:Array<RawComment>*/ = [];\n\tvar authors/*:Array<string>*/ = [];\n\tvar c = {};\n\tvar pass = false;\n\trecordhopper(data, function hopper_cmnt(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x0278: /* 'BrtCommentAuthor' */\n\t\t\t\tauthors.push(val); break;\n\t\t\tcase 0x027B: /* 'BrtBeginComment' */\n\t\t\t\tc = val; break;\n\t\t\tcase 0x027D: /* 'BrtCommentText' */\n\t\t\t\tc.t = val.t; c.h = val.h; c.r = val.r; break;\n\t\t\tcase 0x027C: /* 'BrtEndComment' */\n\t\t\t\tc.author = authors[c.iauthor];\n\t\t\t\tdelete (c/*:any*/).iauthor;\n\t\t\t\tif(opts.sheetRows && c.rfx && opts.sheetRows <= c.rfx.r) break;\n\t\t\t\tif(!c.t) c.t = \"\";\n\t\t\t\tdelete c.rfx; out.push(c); break;\n\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */ break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */ break;\n\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn out;\n}\n\nfunction write_comments_bin(data/*::, opts*/) {\n\tvar ba = buf_array();\n\tvar iauthor/*:Array<string>*/ = [];\n\twrite_record(ba, 0x0274 /* BrtBeginComments */);\n\n\twrite_record(ba, 0x0276 /* BrtBeginCommentAuthors */);\n\tdata.forEach(function(comment) {\n\t\tcomment[1].forEach(function(c) {\n\t\t\tif(iauthor.indexOf(c.a) > -1) return;\n\t\t\tiauthor.push(c.a.slice(0,54));\n\t\t\twrite_record(ba, 0x0278 /* BrtCommentAuthor */, write_BrtCommentAuthor(c.a));\n\t\t\tif(c.T && c.ID && iauthor.indexOf(\"tc=\" + c.ID) == -1) {\n\t\t\t\tiauthor.push(\"tc=\" + c.ID);\n\t\t\t\twrite_record(ba, 0x0278 /* BrtCommentAuthor */, write_BrtCommentAuthor(\"tc=\" + c.ID));\n\t\t\t}\n\t\t});\n\t});\n\twrite_record(ba, 0x0277 /* BrtEndCommentAuthors */);\n\n\twrite_record(ba, 0x0279 /* BrtBeginCommentList */);\n\tdata.forEach(function(comment) {\n\t\tcomment[1].forEach(function(c) {\n\t\t\tvar _ia = -1;\n\t\t\tif(c.ID) _ia = iauthor.indexOf(\"tc=\" + c.ID);\n\t\t\tif(_ia == -1 && comment[1][0].T && comment[1][0].ID) _ia = iauthor.indexOf(\"tc=\" + comment[1][0].ID);\n\t\t\tif(_ia == -1) _ia = iauthor.indexOf(c.a);\n\t\t\tc.iauthor = _ia;\n\t\t\tvar range = {s:decode_cell(comment[0]),e:decode_cell(comment[0])};\n\t\t\twrite_record(ba, 0x027B /* BrtBeginComment */, write_BrtBeginComment([range, c]));\n\t\t\tif(c.t && c.t.length > 0) write_record(ba, 0x027D /* BrtCommentText */, write_BrtCommentText(c));\n\t\t\twrite_record(ba, 0x027C /* BrtEndComment */);\n\t\t\tdelete c.iauthor;\n\t\t});\n\t});\n\twrite_record(ba, 0x027A /* BrtEndCommentList */);\n\n\twrite_record(ba, 0x0275 /* BrtEndComments */);\n\treturn ba.end();\n}\nvar CT_VBA = \"application/vnd.ms-office.vbaProject\";\nfunction make_vba_xls(cfb) {\n  var newcfb = CFB.utils.cfb_new({ root: \"R\" });\n  cfb.FullPaths.forEach(function(p, i) {\n    if (p.slice(-1) === \"/\" || !p.match(/_VBA_PROJECT_CUR/))\n      return;\n    var newpath = p.replace(/^[^\\/]*/, \"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/, \"\");\n    CFB.utils.cfb_add(newcfb, newpath, cfb.FileIndex[i].content);\n  });\n  return CFB.write(newcfb);\n}\nfunction fill_vba_xls(cfb, vba) {\n  vba.FullPaths.forEach(function(p, i) {\n    if (i == 0)\n      return;\n    var newpath = p.replace(/^[\\/]*[^\\/]*[\\/]/, \"/_VBA_PROJECT_CUR/\");\n    if (newpath.slice(-1) !== \"/\")\n      CFB.utils.cfb_add(cfb, newpath, vba.FileIndex[i].content);\n  });\n}\nvar VBAFMTS = [\"xlsb\", \"xlsm\", \"xlam\", \"biff8\", \"xla\"];\n/* macro and dialog sheet stubs */\nfunction parse_ds_bin(/*::data:any, opts, idx:number, rels, wb, themes, styles*/)/*:Worksheet*/ { return {'!type':'dialog'}; }\nfunction parse_ds_xml(/*::data:any, opts, idx:number, rels, wb, themes, styles*/)/*:Worksheet*/ { return {'!type':'dialog'}; }\nfunction parse_ms_bin(/*::data:any, opts, idx:number, rels, wb, themes, styles*/)/*:Worksheet*/ { return {'!type':'macro'}; }\nfunction parse_ms_xml(/*::data:any, opts, idx:number, rels, wb, themes, styles*/)/*:Worksheet*/ { return {'!type':'macro'}; }\n/* TODO: it will be useful to parse the function str */\nvar rc_to_a1 = /*#__PURE__*/(function(){\n\tvar rcregex = /(^|[^A-Za-z_])R(\\[?-?\\d+\\]|[1-9]\\d*|)C(\\[?-?\\d+\\]|[1-9]\\d*|)(?![A-Za-z0-9_])/g;\n\tvar rcbase/*:Cell*/ = ({r:0,c:0}/*:any*/);\n\tfunction rcfunc($$,$1,$2,$3) {\n\t\tvar cRel = false, rRel = false;\n\n\t\tif($2.length == 0) rRel = true;\n\t\telse if($2.charAt(0) == \"[\") { rRel = true; $2 = $2.slice(1, -1); }\n\n\t\tif($3.length == 0) cRel = true;\n\t\telse if($3.charAt(0) == \"[\") { cRel = true; $3 = $3.slice(1, -1); }\n\n\t\tvar R = $2.length>0?parseInt($2,10)|0:0, C = $3.length>0?parseInt($3,10)|0:0;\n\n\t\tif(cRel) C += rcbase.c; else --C;\n\t\tif(rRel) R += rcbase.r; else --R;\n\t\treturn $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n\t}\n\treturn function rc_to_a1(fstr/*:string*/, base/*:Cell*/)/*:string*/ {\n\t\trcbase = base;\n\t\treturn fstr.replace(rcregex, rcfunc);\n\t};\n})();\n\nvar crefregex = /(^|[^._A-Z0-9])(\\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\\$?)(\\d{1,7})(?![_.\\(A-Za-z0-9])/g;\ntry {\n\tcrefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})(?![_.\\(A-Za-z0-9])/g;\n}catch(e){}\nvar a1_to_rc = /*#__PURE__*/(function(){\n\treturn function a1_to_rc(fstr/*:string*/, base/*:CellAddress*/) {\n\t\treturn fstr.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\n\t\t\tvar c = decode_col($3) - ($2 ? 0 : base.c);\n\t\t\tvar r = decode_row($5) - ($4 ? 0 : base.r);\n\t\t\tvar R = $4 == \"$\" ? (r+1) : (r == 0 ? \"\" : \"[\" + r + \"]\");\n\t\t\tvar C = $2 == \"$\" ? (c+1) : (c == 0 ? \"\" : \"[\" + c + \"]\");\n\t\t\treturn $1 + \"R\" + R + \"C\" + C;\n\t\t});\n\t};\n})();\n\n/* no defined name can collide with a valid cell address A1:XFD1048576 ... except LOG10! */\nfunction shift_formula_str(f/*:string*/, delta/*:Cell*/)/*:string*/ {\n\treturn f.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\n\t\treturn $1+($2==\"$\" ? $2+$3 : encode_col(decode_col($3)+delta.c))+($4==\"$\" ? $4+$5 : encode_row(decode_row($5) + delta.r));\n\t});\n}\n\nfunction shift_formula_xlsx(f/*:string*/, range/*:string*/, cell/*:string*/)/*:string*/ {\n\tvar r = decode_range(range), s = r.s, c = decode_cell(cell);\n\tvar delta = {r:c.r - s.r, c:c.c - s.c};\n\treturn shift_formula_str(f, delta);\n}\n\n/* TODO: parse formula */\nfunction fuzzyfmla(f/*:string*/)/*:boolean*/ {\n\tif(f.length == 1) return false;\n\treturn true;\n}\n\nfunction _xlfn(f/*:string*/)/*:string*/ {\n\treturn f.replace(/_xlfn\\./g,\"\");\n}\nfunction parseread1(blob) { blob.l+=1; return; }\n\n/* [MS-XLS] 2.5.51 */\nfunction parse_ColRelU(blob, length) {\n\tvar c = blob.read_shift(length == 1 ? 1 : 2);\n\treturn [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\n}\n\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.89 */\nfunction parse_RgceArea(blob, length, opts) {\n\tvar w = 2;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);\n\t\telse if(opts.biff == 12) w = 4;\n\t}\n\tvar r=blob.read_shift(w), R=blob.read_shift(w);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n/* BIFF 2-5 encodes flags in the row field */\nfunction parse_RgceArea_BIFF2(blob/*::, length, opts*/) {\n\tvar r=parse_ColRelU(blob, 2), R=parse_ColRelU(blob, 2);\n\tvar c=blob.read_shift(1);\n\tvar C=blob.read_shift(1);\n\treturn { s:{r:r[0], c:c, cRel:r[1], rRel:r[2]}, e:{r:R[0], c:C, cRel:R[1], rRel:R[2]} };\n}\n\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.90 */\nfunction parse_RgceAreaRel(blob, length, opts) {\n\tif(opts.biff < 8) return parse_RgceArea_BIFF2(blob, length, opts);\n\tvar r=blob.read_shift(opts.biff == 12 ? 4 : 2), R=blob.read_shift(opts.biff == 12 ? 4 : 2);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n\n/* [MS-XLS] 2.5.198.109 ; [MS-XLSB] 2.5.97.91 */\nfunction parse_RgceLoc(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);\n\tvar c = parse_ColRelU(blob, 2);\n\treturn {r:r, c:c[0], cRel:c[1], rRel:c[2]};\n}\nfunction parse_RgceLoc_BIFF2(blob/*::, length, opts*/) {\n\tvar r = parse_ColRelU(blob, 2);\n\tvar c = blob.read_shift(1);\n\treturn {r:r[0], c:c, cRel:r[1], rRel:r[2]};\n}\n\n/* [MS-XLS] 2.5.198.107, 2.5.47 */\nfunction parse_RgceElfLoc(blob/*::, length, opts*/) {\n\tvar r = blob.read_shift(2);\n\tvar c = blob.read_shift(2);\n\treturn {r:r, c:c & 0xFF, fQuoted:!!(c & 0x4000), cRel:c>>15, rRel:c>>15 };\n}\n\n/* [MS-XLS] 2.5.198.111 ; [MS-XLSB] 2.5.97.92 TODO */\nfunction parse_RgceLocRel(blob, length, opts) {\n\tvar biff = opts && opts.biff ? opts.biff : 8;\n\tif(biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(biff >= 12 ? 4 : 2);\n\tvar cl = blob.read_shift(2);\n\tvar cRel = (cl & 0x4000) >> 14, rRel = (cl & 0x8000) >> 15;\n\tcl &= 0x3FFF;\n\tif(rRel == 1) while(r > 0x7FFFF) r -= 0x100000;\n\tif(cRel == 1) while(cl > 0x1FFF) cl = cl - 0x4000;\n\treturn {r:r,c:cl,cRel:cRel,rRel:rRel};\n}\nfunction parse_RgceLocRel_BIFF2(blob/*::, length:number, opts*/) {\n\tvar rl = blob.read_shift(2);\n\tvar c = blob.read_shift(1);\n\tvar rRel = (rl & 0x8000) >> 15, cRel = (rl & 0x4000) >> 14;\n\trl &= 0x3FFF;\n\tif(rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n\tif(cRel == 1 && c >= 0x80) c = c - 0x100;\n\treturn {r:rl,c:c,cRel:cRel,rRel:rRel};\n}\n\n/* [MS-XLS] 2.5.198.27 ; [MS-XLSB] 2.5.97.18 */\nfunction parse_PtgArea(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n\treturn [type, area];\n}\n\n/* [MS-XLS] 2.5.198.28 ; [MS-XLSB] 2.5.97.19 */\nfunction parse_PtgArea3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2, 'i');\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t\tcase 12: w = 12; break;\n\t}\n\tvar area = parse_RgceArea(blob, w, opts);\n\treturn [type, ixti, area];\n}\n\n/* [MS-XLS] 2.5.198.29 ; [MS-XLSB] 2.5.97.20 */\nfunction parse_PtgAreaErr(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts && (opts.biff > 8) ? 12 : (opts.biff < 8 ? 6 : 8);\n\treturn [type];\n}\n/* [MS-XLS] 2.5.198.30 ; [MS-XLSB] 2.5.97.21 */\nfunction parse_PtgAreaErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t\tcase 12: w = 12; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* [MS-XLS] 2.5.198.31 ; [MS-XLSB] 2.5.97.22 */\nfunction parse_PtgAreaN(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceAreaRel(blob, length - 1, opts);\n\treturn [type, area];\n}\n\n/* [MS-XLS] 2.5.198.32 ; [MS-XLSB] 2.5.97.23 */\nfunction parse_PtgArray(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;\n\treturn [type];\n}\n\n/* [MS-XLS] 2.5.198.33 ; [MS-XLSB] 2.5.97.24 */\nfunction parse_PtgAttrBaxcel(blob) {\n\tvar bitSemi = blob[blob.l+1] & 0x01; /* 1 = volatile */\n\tvar bitBaxcel = 1;\n\tblob.l += 4;\n\treturn [bitSemi, bitBaxcel];\n}\n\n/* [MS-XLS] 2.5.198.34 ; [MS-XLSB] 2.5.97.25 */\nfunction parse_PtgAttrChoose(blob, length, opts)/*:Array<number>*/ {\n\tblob.l +=2;\n\tvar offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar o/*:Array<number>*/ = [];\n\t/* offset is 1 less than the number of elements */\n\tfor(var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.35 ; [MS-XLSB] 2.5.97.26 */\nfunction parse_PtgAttrGoto(blob, length, opts) {\n\tvar bitGoto = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* [MS-XLS] 2.5.198.36 ; [MS-XLSB] 2.5.97.27 */\nfunction parse_PtgAttrIf(blob, length, opts) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* [MS-XLSB] 2.5.97.28 */\nfunction parse_PtgAttrIfError(blob) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(2)];\n}\n\n/* [MS-XLS] 2.5.198.37 ; [MS-XLSB] 2.5.97.29 */\nfunction parse_PtgAttrSemi(blob, length, opts) {\n\tvar bitSemi = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += opts && opts.biff == 2 ? 3 : 4;\n\treturn [bitSemi];\n}\n\n/* [MS-XLS] 2.5.198.40 ; [MS-XLSB] 2.5.97.32 */\nfunction parse_PtgAttrSpaceType(blob/*::, length*/) {\n\tvar type = blob.read_shift(1), cch = blob.read_shift(1);\n\treturn [type, cch];\n}\n\n/* [MS-XLS] 2.5.198.38 ; [MS-XLSB] 2.5.97.30 */\nfunction parse_PtgAttrSpace(blob) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* [MS-XLS] 2.5.198.39 ; [MS-XLSB] 2.5.97.31 */\nfunction parse_PtgAttrSpaceSemi(blob) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* [MS-XLS] 2.5.198.84 ; [MS-XLSB] 2.5.97.68 TODO */\nfunction parse_PtgRef(blob, length, opts) {\n\t//var ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLoc(blob, 0, opts);\n\treturn [type, loc];\n}\n\n/* [MS-XLS] 2.5.198.88 ; [MS-XLSB] 2.5.97.72 TODO */\nfunction parse_PtgRefN(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLocRel(blob, 0, opts);\n\treturn [type, loc];\n}\n\n/* [MS-XLS] 2.5.198.85 ; [MS-XLSB] 2.5.97.69 TODO */\nfunction parse_PtgRef3d(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tif(opts && opts.biff == 5) blob.l += 12;\n\tvar loc = parse_RgceLoc(blob, 0, opts); // TODO: or RgceLocRel\n\treturn [type, ixti, loc];\n}\n\n\n/* [MS-XLS] 2.5.198.62 ; [MS-XLSB] 2.5.97.45 TODO */\nfunction parse_PtgFunc(blob, length, opts) {\n\t//var ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n\treturn [FtabArgc[iftab], Ftab[iftab], type];\n}\n/* [MS-XLS] 2.5.198.63 ; [MS-XLSB] 2.5.97.46 TODO */\nfunction parse_PtgFuncVar(blob, length, opts) {\n\tvar type = blob[blob.l++];\n\tvar cparams = blob.read_shift(1), tab = opts && opts.biff <= 3 ? [(type == 0x58 ? -1 : 0), blob.read_shift(1)]: parsetab(blob);\n\treturn [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n}\n\nfunction parsetab(blob) {\n\treturn [blob[blob.l+1]>>7, blob.read_shift(2) & 0x7FFF];\n}\n\n/* [MS-XLS] 2.5.198.41 ; [MS-XLSB] 2.5.97.33 */\nfunction parse_PtgAttrSum(blob, length, opts) {\n\tblob.l += opts && opts.biff == 2 ? 3 : 4; return;\n}\n\n/* [MS-XLS] 2.5.198.58 ; [MS-XLSB] 2.5.97.40 */\nfunction parse_PtgExp(blob, length, opts) {\n\tblob.l++;\n\tif(opts && opts.biff == 12) return [blob.read_shift(4, 'i'), 0];\n\tvar row = blob.read_shift(2);\n\tvar col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [row, col];\n}\n\n/* [MS-XLS] 2.5.198.57 ; [MS-XLSB] 2.5.97.39 */\nfunction parse_PtgErr(blob) { blob.l++; return BErr[blob.read_shift(1)]; }\n\n/* [MS-XLS] 2.5.198.66 ; [MS-XLSB] 2.5.97.49 */\nfunction parse_PtgInt(blob) { blob.l++; return blob.read_shift(2); }\n\n/* [MS-XLS] 2.5.198.42 ; [MS-XLSB] 2.5.97.34 */\nfunction parse_PtgBool(blob) { blob.l++; return blob.read_shift(1)!==0;}\n\n/* [MS-XLS] 2.5.198.79 ; [MS-XLSB] 2.5.97.63 */\nfunction parse_PtgNum(blob) { blob.l++; return parse_Xnum(blob, 8); }\n\n/* [MS-XLS] 2.5.198.89 ; [MS-XLSB] 2.5.97.74 */\nfunction parse_PtgStr(blob, length, opts) { blob.l++; return parse_ShortXLUnicodeString(blob, length-1, opts); }\n\n/* [MS-XLS] 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n/* [MS-XLSB] 2.5.97.93 + 2.5.97.9{4,5,6,7} */\nfunction parse_SerAr(blob, biff/*:number*/) {\n\tvar val = [blob.read_shift(1)];\n\tif(biff == 12) switch(val[0]) {\n\t\tcase 0x02: val[0] = 0x04; break; /* SerBool */\n\t\tcase 0x04: val[0] = 0x10; break; /* SerErr */\n\t\tcase 0x00: val[0] = 0x01; break; /* SerNum */\n\t\tcase 0x01: val[0] = 0x02; break; /* SerStr */\n\t}\n\tswitch(val[0]) {\n\t\tcase 0x04: /* SerBool -- boolean */\n\t\t\tval[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n\t\t\tif(biff != 12) blob.l += 7; break;\n\t\tcase 0x25: /* appears to be an alias */\n\t\tcase 0x10: /* SerErr -- error */\n\t\t\tval[1] = BErr[blob[blob.l]];\n\t\t\tblob.l += ((biff == 12) ? 4 : 8); break;\n\t\tcase 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\n\t\t\tblob.l += 8; break;\n\t\tcase 0x01: /* SerNum -- Xnum */\n\t\t\tval[1] = parse_Xnum(blob, 8); break;\n\t\tcase 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\n\t\t\tval[1] = parse_XLUnicodeString2(blob, 0, {biff:biff > 0 && biff < 8 ? 2 : biff}); break;\n\t\tdefault: throw new Error(\"Bad SerAr: \" + val[0]); /* Unreachable */\n\t}\n\treturn val;\n}\n\n/* [MS-XLS] 2.5.198.61 ; [MS-XLSB] 2.5.97.44 */\nfunction parse_PtgExtraMem(blob, cce, opts) {\n\tvar count = blob.read_shift((opts.biff == 12) ? 4 : 2);\n\tvar out/*:Array<Range>*/ = [];\n\tfor(var i = 0; i != count; ++i) out.push(((opts.biff == 12) ? parse_UncheckedRfX : parse_Ref8U)(blob, 8));\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.198.59 ; [MS-XLSB] 2.5.97.41 */\nfunction parse_PtgExtraArray(blob, length, opts) {\n\tvar rows = 0, cols = 0;\n\tif(opts.biff == 12) {\n\t\trows = blob.read_shift(4); // DRw\n\t\tcols = blob.read_shift(4); // DCol\n\t} else {\n\t\tcols = 1 + blob.read_shift(1); //DColByteU\n\t\trows = 1 + blob.read_shift(2); //DRw\n\t}\n\tif(opts.biff >= 2 && opts.biff < 8) { --rows; if(--cols == 0) cols = 0x100; }\n\t// $FlowIgnore\n\tfor(var i = 0, o/*:Array<Array<any>>*/ = []; i != rows && (o[i] = []); ++i)\n\t\tfor(var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 */\nfunction parse_PtgName(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar w = (!opts || (opts.biff >= 8)) ? 4 : 2;\n\tvar nameindex = blob.read_shift(w);\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l += 5; break;\n\t\tcase 3: case 4: blob.l += 8; break;\n\t\tcase 5: blob.l += 12; break;\n\t}\n\treturn [type, 0, nameindex];\n}\n\n/* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 */\nfunction parse_PtgNameX(blob, length, opts) {\n\tif(opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tvar nameindex = blob.read_shift(4);\n\treturn [type, ixti, nameindex];\n}\nfunction parse_PtgNameX_BIFF5(blob/*::, length, opts*/) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2, 'i'); // XtiIndex\n\tblob.l += 8;\n\tvar nameindex = blob.read_shift(2);\n\tblob.l += 12;\n\treturn [type, ixti, nameindex];\n}\n\n/* [MS-XLS] 2.5.198.70 ; [MS-XLSB] 2.5.97.54 */\nfunction parse_PtgMemArea(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += (opts && opts.biff == 2 ? 3 : 4);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n/* [MS-XLS] 2.5.198.72 ; [MS-XLSB] 2.5.97.56 */\nfunction parse_PtgMemFunc(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n\n/* [MS-XLS] 2.5.198.86 ; [MS-XLSB] 2.5.97.69 */\nfunction parse_PtgRefErr(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += 4;\n\tif(opts.biff < 8) blob.l--;\n\tif(opts.biff == 12) blob.l += 2;\n\treturn [type];\n}\n\n/* [MS-XLS] 2.5.198.87 ; [MS-XLSB] 2.5.97.71 */\nfunction parse_PtgRefErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 4;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: w = 15; break;\n\t\tcase 12: w = 6; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* [MS-XLS] 2.5.198.71 ; [MS-XLSB] 2.5.97.55 */\nvar parse_PtgMemErr = parsenoop;\n/* [MS-XLS] 2.5.198.73  ; [MS-XLSB] 2.5.97.57 */\nvar parse_PtgMemNoMem = parsenoop;\n/* [MS-XLS] 2.5.198.92 */\nvar parse_PtgTbl = parsenoop;\n\nfunction parse_PtgElfLoc(blob, length, opts) {\n\tblob.l += 2;\n\treturn [parse_RgceElfLoc(blob, 4, opts)];\n}\nfunction parse_PtgElfNoop(blob/*::, length, opts*/) {\n\tblob.l += 6;\n\treturn [];\n}\n/* [MS-XLS] 2.5.198.46 */\nvar parse_PtgElfCol = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.47 */\nvar parse_PtgElfColS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.48 */\nvar parse_PtgElfColSV = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.49 */\nvar parse_PtgElfColV = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.50 */\nfunction parse_PtgElfLel(blob/*::, length, opts*/) {\n\tblob.l += 2;\n\treturn [parseuint16(blob), blob.read_shift(2) & 0x01];\n}\n/* [MS-XLS] 2.5.198.51 */\nvar parse_PtgElfRadical = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.52 */\nvar parse_PtgElfRadicalLel = parse_PtgElfLel;\n/* [MS-XLS] 2.5.198.53 */\nvar parse_PtgElfRadicalS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.54 */\nvar parse_PtgElfRw = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.55 */\nvar parse_PtgElfRwV = parse_PtgElfLoc;\n\n/* [MS-XLSB] 2.5.97.52 TODO */\nvar PtgListRT = [\n\t\"Data\",\n\t\"All\",\n\t\"Headers\",\n\t\"??\",\n\t\"?Data2\",\n\t\"??\",\n\t\"?DataHeaders\",\n\t\"??\",\n\t\"Totals\",\n\t\"??\",\n\t\"??\",\n\t\"??\",\n\t\"?DataTotals\",\n\t\"??\",\n\t\"??\",\n\t\"??\",\n\t\"?Current\"\n];\nfunction parse_PtgList(blob/*::, length, opts*/) {\n\tblob.l += 2;\n\tvar ixti = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tvar idx = blob.read_shift(4);\n\tvar c = blob.read_shift(2);\n\tvar C = blob.read_shift(2);\n\tvar rt = PtgListRT[(flags >> 2) & 0x1F];\n\treturn {ixti: ixti, coltype:(flags&0x3), rt:rt, idx:idx, c:c, C:C};\n}\n/* [MS-XLS] 2.5.198.91 ; [MS-XLSB] 2.5.97.76 */\nfunction parse_PtgSxName(blob/*::, length, opts*/) {\n\tblob.l += 2;\n\treturn [blob.read_shift(4)];\n}\n\n/* [XLS] old spec */\nfunction parse_PtgSheet(blob, length, opts) {\n\tblob.l += 5;\n\tblob.l += 2;\n\tblob.l += (opts.biff == 2 ? 1 : 4);\n\treturn [\"PTGSHEET\"];\n}\nfunction parse_PtgEndSheet(blob, length, opts) {\n\tblob.l += (opts.biff == 2 ? 4 : 5);\n\treturn [\"PTGENDSHEET\"];\n}\nfunction parse_PtgMemAreaN(blob/*::, length, opts*/) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\nfunction parse_PtgMemNoMemN(blob/*::, length, opts*/) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\nfunction parse_PtgAttrNoop(blob/*::, length, opts*/) {\n\tblob.l += 4;\n\treturn [0, 0];\n}\n\n/* [MS-XLS] 2.5.198.25 ; [MS-XLSB] 2.5.97.16 */\nvar PtgTypes = {\n\t0x01: { n:'PtgExp', f:parse_PtgExp },\n\t0x02: { n:'PtgTbl', f:parse_PtgTbl },\n\t0x03: { n:'PtgAdd', f:parseread1 },\n\t0x04: { n:'PtgSub', f:parseread1 },\n\t0x05: { n:'PtgMul', f:parseread1 },\n\t0x06: { n:'PtgDiv', f:parseread1 },\n\t0x07: { n:'PtgPower', f:parseread1 },\n\t0x08: { n:'PtgConcat', f:parseread1 },\n\t0x09: { n:'PtgLt', f:parseread1 },\n\t0x0A: { n:'PtgLe', f:parseread1 },\n\t0x0B: { n:'PtgEq', f:parseread1 },\n\t0x0C: { n:'PtgGe', f:parseread1 },\n\t0x0D: { n:'PtgGt', f:parseread1 },\n\t0x0E: { n:'PtgNe', f:parseread1 },\n\t0x0F: { n:'PtgIsect', f:parseread1 },\n\t0x10: { n:'PtgUnion', f:parseread1 },\n\t0x11: { n:'PtgRange', f:parseread1 },\n\t0x12: { n:'PtgUplus', f:parseread1 },\n\t0x13: { n:'PtgUminus', f:parseread1 },\n\t0x14: { n:'PtgPercent', f:parseread1 },\n\t0x15: { n:'PtgParen', f:parseread1 },\n\t0x16: { n:'PtgMissArg', f:parseread1 },\n\t0x17: { n:'PtgStr', f:parse_PtgStr },\n\t0x1A: { n:'PtgSheet', f:parse_PtgSheet },\n\t0x1B: { n:'PtgEndSheet', f:parse_PtgEndSheet },\n\t0x1C: { n:'PtgErr', f:parse_PtgErr },\n\t0x1D: { n:'PtgBool', f:parse_PtgBool },\n\t0x1E: { n:'PtgInt', f:parse_PtgInt },\n\t0x1F: { n:'PtgNum', f:parse_PtgNum },\n\t0x20: { n:'PtgArray', f:parse_PtgArray },\n\t0x21: { n:'PtgFunc', f:parse_PtgFunc },\n\t0x22: { n:'PtgFuncVar', f:parse_PtgFuncVar },\n\t0x23: { n:'PtgName', f:parse_PtgName },\n\t0x24: { n:'PtgRef', f:parse_PtgRef },\n\t0x25: { n:'PtgArea', f:parse_PtgArea },\n\t0x26: { n:'PtgMemArea', f:parse_PtgMemArea },\n\t0x27: { n:'PtgMemErr', f:parse_PtgMemErr },\n\t0x28: { n:'PtgMemNoMem', f:parse_PtgMemNoMem },\n\t0x29: { n:'PtgMemFunc', f:parse_PtgMemFunc },\n\t0x2A: { n:'PtgRefErr', f:parse_PtgRefErr },\n\t0x2B: { n:'PtgAreaErr', f:parse_PtgAreaErr },\n\t0x2C: { n:'PtgRefN', f:parse_PtgRefN },\n\t0x2D: { n:'PtgAreaN', f:parse_PtgAreaN },\n\t0x2E: { n:'PtgMemAreaN', f:parse_PtgMemAreaN },\n\t0x2F: { n:'PtgMemNoMemN', f:parse_PtgMemNoMemN },\n\t0x39: { n:'PtgNameX', f:parse_PtgNameX },\n\t0x3A: { n:'PtgRef3d', f:parse_PtgRef3d },\n\t0x3B: { n:'PtgArea3d', f:parse_PtgArea3d },\n\t0x3C: { n:'PtgRefErr3d', f:parse_PtgRefErr3d },\n\t0x3D: { n:'PtgAreaErr3d', f:parse_PtgAreaErr3d },\n\t0xFF: {}\n};\n/* These are duplicated in the PtgTypes table */\nvar PtgDupes = {\n\t0x40: 0x20, 0x60: 0x20,\n\t0x41: 0x21, 0x61: 0x21,\n\t0x42: 0x22, 0x62: 0x22,\n\t0x43: 0x23, 0x63: 0x23,\n\t0x44: 0x24, 0x64: 0x24,\n\t0x45: 0x25, 0x65: 0x25,\n\t0x46: 0x26, 0x66: 0x26,\n\t0x47: 0x27, 0x67: 0x27,\n\t0x48: 0x28, 0x68: 0x28,\n\t0x49: 0x29, 0x69: 0x29,\n\t0x4A: 0x2A, 0x6A: 0x2A,\n\t0x4B: 0x2B, 0x6B: 0x2B,\n\t0x4C: 0x2C, 0x6C: 0x2C,\n\t0x4D: 0x2D, 0x6D: 0x2D,\n\t0x4E: 0x2E, 0x6E: 0x2E,\n\t0x4F: 0x2F, 0x6F: 0x2F,\n\t0x58: 0x22, 0x78: 0x22,\n\t0x59: 0x39, 0x79: 0x39,\n\t0x5A: 0x3A, 0x7A: 0x3A,\n\t0x5B: 0x3B, 0x7B: 0x3B,\n\t0x5C: 0x3C, 0x7C: 0x3C,\n\t0x5D: 0x3D, 0x7D: 0x3D\n};\n\nvar Ptg18 = {\n\t0x01: { n:'PtgElfLel', f:parse_PtgElfLel },\n\t0x02: { n:'PtgElfRw', f:parse_PtgElfRw },\n\t0x03: { n:'PtgElfCol', f:parse_PtgElfCol },\n\t0x06: { n:'PtgElfRwV', f:parse_PtgElfRwV },\n\t0x07: { n:'PtgElfColV', f:parse_PtgElfColV },\n\t0x0A: { n:'PtgElfRadical', f:parse_PtgElfRadical },\n\t0x0B: { n:'PtgElfRadicalS', f:parse_PtgElfRadicalS },\n\t0x0D: { n:'PtgElfColS', f:parse_PtgElfColS },\n\t0x0F: { n:'PtgElfColSV', f:parse_PtgElfColSV },\n\t0x10: { n:'PtgElfRadicalLel', f:parse_PtgElfRadicalLel },\n\t0x19: { n:'PtgList', f:parse_PtgList },\n\t0x1D: { n:'PtgSxName', f:parse_PtgSxName },\n\t0xFF: {}\n};\nvar Ptg19 = {\n\t0x00: { n:'PtgAttrNoop', f:parse_PtgAttrNoop },\n\t0x01: { n:'PtgAttrSemi', f:parse_PtgAttrSemi },\n\t0x02: { n:'PtgAttrIf', f:parse_PtgAttrIf },\n\t0x04: { n:'PtgAttrChoose', f:parse_PtgAttrChoose },\n\t0x08: { n:'PtgAttrGoto', f:parse_PtgAttrGoto },\n\t0x10: { n:'PtgAttrSum', f:parse_PtgAttrSum },\n\t0x20: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n\t0x21: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n\t0x40: { n:'PtgAttrSpace', f:parse_PtgAttrSpace },\n\t0x41: { n:'PtgAttrSpaceSemi', f:parse_PtgAttrSpaceSemi },\n\t0x80: { n:'PtgAttrIfError', f:parse_PtgAttrIfError },\n\t0xFF: {}\n};\n\n/* [MS-XLS] 2.5.198.103 ; [MS-XLSB] 2.5.97.87 */\nfunction parse_RgbExtra(blob, length, rgce, opts) {\n\tif(opts.biff < 8) return parsenoop(blob, length);\n\tvar target = blob.l + length;\n\tvar o = [];\n\tfor(var i = 0; i !== rgce.length; ++i) {\n\t\tswitch(rgce[i][0]) {\n\t\t\tcase 'PtgArray': /* PtgArray -> PtgExtraArray */\n\t\t\t\trgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n\t\t\t\to.push(rgce[i][1]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\n\t\t\t\trgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);\n\t\t\t\to.push(rgce[i][2]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgExp': /* PtgExp -> PtgExtraCol */\n\t\t\t\tif(opts && opts.biff == 12) {\n\t\t\t\t\trgce[i][1][1] = blob.read_shift(4);\n\t\t\t\t\to.push(rgce[i][1]);\n\t\t\t\t} break;\n\t\t\tcase 'PtgList': /* TODO: PtgList -> PtgExtraList */\n\t\t\tcase 'PtgElfRadicalS': /* TODO: PtgElfRadicalS -> PtgExtraElf */\n\t\t\tcase 'PtgElfColS': /* TODO: PtgElfColS -> PtgExtraElf */\n\t\t\tcase 'PtgElfColSV': /* TODO: PtgElfColSV -> PtgExtraElf */\n\t\t\t\tthrow \"Unsupported \" + rgce[i][0];\n\t\t\tdefault: break;\n\t\t}\n\t}\n\tlength = target - blob.l;\n\t/* note: this is technically an error but Excel disregards */\n\t//if(target !== blob.l && blob.l !== target - length) throw new Error(target + \" != \" + blob.l);\n\tif(length !== 0) o.push(parsenoop(blob, length));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.104 ; [MS-XLSB] 2.5.97.88 */\nfunction parse_Rgce(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar R, id, ptgs = [];\n\twhile(target != blob.l) {\n\t\tlength = target - blob.l;\n\t\tid = blob[blob.l];\n\t\tR = PtgTypes[id] || PtgTypes[PtgDupes[id]];\n\t\tif(id === 0x18 || id === 0x19) R = (id === 0x18 ? Ptg18 : Ptg19)[blob[blob.l + 1]];\n\t\tif(!R || !R.f) { /*ptgs.push*/(parsenoop(blob, length)); }\n\t\telse { ptgs.push([R.n, R.f(blob, length, opts)]); }\n\t}\n\treturn ptgs;\n}\n\nfunction stringify_array(f/*:Array<Array<string>>*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tfor(var i = 0; i < f.length; ++i) {\n\t\tvar x = f[i], r/*:Array<string>*/ = [];\n\t\tfor(var j = 0; j < x.length; ++j) {\n\t\t\tvar y = x[j];\n\t\t\tif(y) switch(y[0]) {\n\t\t\t\t// TODO: handle embedded quotes\n\t\t\t\tcase 0x02:\n\t\t\t\t\t/*:: if(typeof y[1] != 'string') throw \"unreachable\"; */\n\t\t\t\t\tr.push('\"' + y[1].replace(/\"/g,'\"\"') + '\"'); break;\n\t\t\t\tdefault: r.push(y[1]);\n\t\t\t} else r.push(\"\");\n\t\t}\n\t\to.push(r.join(\",\"));\n\t}\n\treturn o.join(\";\");\n}\n\n/* [MS-XLS] 2.2.2 ; [MS-XLSB] 2.2.2 TODO */\nvar PtgBinOp = {\n\tPtgAdd: \"+\",\n\tPtgConcat: \"&\",\n\tPtgDiv: \"/\",\n\tPtgEq: \"=\",\n\tPtgGe: \">=\",\n\tPtgGt: \">\",\n\tPtgLe: \"<=\",\n\tPtgLt: \"<\",\n\tPtgMul: \"*\",\n\tPtgNe: \"<>\",\n\tPtgPower: \"^\",\n\tPtgSub: \"-\"\n};\n\n// TODO: explore space\nfunction make_3d_range(start, end) {\n\tvar s = start.lastIndexOf(\"!\"), e = end.lastIndexOf(\"!\");\n\tif(s == -1 && e == -1) return start + \":\" + end;\n\tif(s > 0 && e > 0 && start.slice(0, s).toLowerCase() == end.slice(0, e).toLowerCase()) return start + \":\" + end.slice(e+1);\n\tconsole.error(\"Cannot hydrate range\", start, end);\n\treturn start + \":\" + end;\n}\n\nfunction get_ixti_raw(supbooks, ixti/*:number*/, opts)/*:string*/ {\n\tif(!supbooks) return \"SH33TJSERR0\";\n\tif(opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];\n\tif(!supbooks.XTI) return \"SH33TJSERR6\";\n\tvar XTI = supbooks.XTI[ixti];\n\tif(opts.biff < 8) {\n\t\tif(ixti > 10000) ixti-= 65536;\n\t\tif(ixti < 0) ixti = -ixti;\n\t\treturn ixti == 0 ? \"\" : supbooks.XTI[ixti - 1];\n\t}\n\tif(!XTI) return \"SH33TJSERR1\";\n\tvar o = \"\";\n\tif(opts.biff > 8) switch(supbooks[XTI[0]][0]) {\n\t\tcase 0x0165: /* 'BrtSupSelf' */\n\t\t\to = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]];\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\t\tcase 0x0166: /* 'BrtSupSame' */\n\t\t\tif(opts.SID != null) return supbooks.SheetNames[opts.SID];\n\t\t\treturn \"SH33TJSSAME\" + supbooks[XTI[0]][0];\n\t\tcase 0x0163: /* 'BrtSupBookSrc' */\n\t\t\t/* falls through */\n\t\tdefault: return \"SH33TJSSRC\" + supbooks[XTI[0]][0];\n\t}\n\tswitch(supbooks[XTI[0]][0][0]) {\n\t\tcase 0x0401:\n\t\t\to = XTI[1] == -1 ? \"#REF\" : (supbooks.SheetNames[XTI[1]] || \"SH33TJSERR3\");\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\t\tcase 0x3A01: return supbooks[XTI[0]].slice(1).map(function(name) { return name.Name; }).join(\";;\"); //return \"SH33TJSERR8\";\n\t\tdefault:\n\t\t\tif(!supbooks[XTI[0]][0][3]) return \"SH33TJSERR2\";\n\t\t\to = XTI[1] == -1 ? \"#REF\" : (supbooks[XTI[0]][0][3][XTI[1]] || \"SH33TJSERR4\");\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks[XTI[0]][0][3][XTI[2]];\n\t}\n}\nfunction get_ixti(supbooks, ixti/*:number*/, opts)/*:string*/ {\n\tvar ixtiraw = get_ixti_raw(supbooks, ixti, opts);\n\treturn ixtiraw == \"#REF\" ? ixtiraw : formula_quote_sheet_name(ixtiraw, opts);\n}\nfunction stringify_formula(formula/*Array<any>*/, range, cell/*:any*/, supbooks, opts)/*:string*/ {\n\tvar biff = (opts && opts.biff) || 8;\n\tvar _range = /*range != null ? range :*/ {s:{c:0, r:0},e:{c:0, r:0}};\n\tvar stack/*:Array<string>*/ = [], e1, e2, /*::type,*/ c/*:CellAddress*/, ixti=0, nameidx=0, r, sname=\"\";\n\tif(!formula[0] || !formula[0][0]) return \"\";\n\tvar last_sp = -1, sp = \"\";\n\tfor(var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n\t\tvar f = formula[0][ff];\n\t\tswitch(f[0]) {\n\t\t\tcase 'PtgUminus': /* [MS-XLS] 2.5.198.93 */\n\t\t\t\tstack.push(\"-\" + stack.pop()); break;\n\t\t\tcase 'PtgUplus': /* [MS-XLS] 2.5.198.95 */\n\t\t\t\tstack.push(\"+\" + stack.pop()); break;\n\t\t\tcase 'PtgPercent': /* [MS-XLS] 2.5.198.81 */\n\t\t\t\tstack.push(stack.pop() + \"%\"); break;\n\n\t\t\tcase 'PtgAdd':    /* [MS-XLS] 2.5.198.26 */\n\t\t\tcase 'PtgConcat': /* [MS-XLS] 2.5.198.43 */\n\t\t\tcase 'PtgDiv':    /* [MS-XLS] 2.5.198.45 */\n\t\t\tcase 'PtgEq':     /* [MS-XLS] 2.5.198.56 */\n\t\t\tcase 'PtgGe':     /* [MS-XLS] 2.5.198.64 */\n\t\t\tcase 'PtgGt':     /* [MS-XLS] 2.5.198.65 */\n\t\t\tcase 'PtgLe':     /* [MS-XLS] 2.5.198.68 */\n\t\t\tcase 'PtgLt':     /* [MS-XLS] 2.5.198.69 */\n\t\t\tcase 'PtgMul':    /* [MS-XLS] 2.5.198.75 */\n\t\t\tcase 'PtgNe':     /* [MS-XLS] 2.5.198.78 */\n\t\t\tcase 'PtgPower':  /* [MS-XLS] 2.5.198.82 */\n\t\t\tcase 'PtgSub':    /* [MS-XLS] 2.5.198.90 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tsp = fill(\" \", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tsp = fill(\"\\r\", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tsp = \"\";\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\te2 = e2 + sp;\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(e2+PtgBinOp[f[0]]+e1);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgIsect': /* [MS-XLS] 2.5.198.67 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\" \"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgUnion': /* [MS-XLS] 2.5.198.94 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\",\"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRange': /* [MS-XLS] 2.5.198.83 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(make_3d_range(e2,e1));\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrChoose': /* [MS-XLS] 2.5.198.34 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrGoto': /* [MS-XLS] 2.5.198.35 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrIf': /* [MS-XLS] 2.5.198.36 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrIfError': /* [MS-XLSB] 2.5.97.28 */\n\t\t\t\tbreak;\n\n\n\t\t\tcase 'PtgRef': /* [MS-XLS] 2.5.198.84 */\n\t\t\t\t/*::type = f[1][0]; */c = shift_cell_xls((f[1][1]/*:any*/), _range, opts);\n\t\t\t\tstack.push(encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRefN': /* [MS-XLS] 2.5.198.88 */\n\t\t\t\t/*::type = f[1][0]; */c = cell ? shift_cell_xls((f[1][1]/*:any*/), cell, opts) : (f[1][1]/*:any*/);\n\t\t\t\tstack.push(encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRef3d': /* [MS-XLS] 2.5.198.85 */\n\t\t\t\t/*::type = f[1][0]; */ixti = /*::Number(*/f[1][1]/*::)*/; c = shift_cell_xls((f[1][2]/*:any*/), _range, opts);\n\t\t\t\tsname = get_ixti(supbooks, ixti, opts);\n\t\t\t\tvar w = sname; /* IE9 fails on defined names */ // eslint-disable-line no-unused-vars\n\t\t\t\tstack.push(sname + \"!\" + encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgFunc': /* [MS-XLS] 2.5.198.62 */\n\t\t\tcase 'PtgFuncVar': /* [MS-XLS] 2.5.198.63 */\n\t\t\t\t/* f[1] = [argc, func, type] */\n\t\t\t\tvar argc/*:number*/ = (f[1][0]/*:any*/), func/*:string*/ = (f[1][1]/*:any*/);\n\t\t\t\tif(!argc) argc = 0;\n\t\t\t\targc &= 0x7F;\n\t\t\t\tvar args = argc == 0 ? [] : stack.slice(-argc);\n\t\t\t\tstack.length -= argc;\n\t\t\t\tif(func === 'User') func = args.shift();\n\t\t\t\tstack.push(func + \"(\" + args.join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgBool': /* [MS-XLS] 2.5.198.42 */\n\t\t\t\tstack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\n\t\t\tcase 'PtgInt': /* [MS-XLS] 2.5.198.66 */\n\t\t\t\tstack.push(/*::String(*/f[1]/*::)*/); break;\n\t\t\tcase 'PtgNum': /* [MS-XLS] 2.5.198.79 TODO: precision? */\n\t\t\t\tstack.push(String(f[1])); break;\n\t\t\tcase 'PtgStr': /* [MS-XLS] 2.5.198.89 */\n\t\t\t\t// $FlowIgnore\n\t\t\t\tstack.push('\"' + f[1].replace(/\"/g, '\"\"') + '\"'); break;\n\t\t\tcase 'PtgErr': /* [MS-XLS] 2.5.198.57 */\n\t\t\t\tstack.push(/*::String(*/f[1]/*::)*/); break;\n\t\t\tcase 'PtgAreaN': /* [MS-XLS] 2.5.198.31 TODO */\n\t\t\t\t/*::type = f[1][0]; */r = shift_range_xls(f[1][1], cell ? {s:cell} : _range, opts);\n\t\t\t\tstack.push(encode_range_xls((r/*:any*/), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgArea': /* [MS-XLS] 2.5.198.27 TODO: fixed points */\n\t\t\t\t/*::type = f[1][0]; */r = shift_range_xls(f[1][1], _range, opts);\n\t\t\t\tstack.push(encode_range_xls((r/*:any*/), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgArea3d': /* [MS-XLS] 2.5.198.28 TODO */\n\t\t\t\t/*::type = f[1][0]; */ixti = /*::Number(*/f[1][1]/*::)*/; r = f[1][2];\n\t\t\t\tsname = get_ixti(supbooks, ixti, opts);\n\t\t\t\tstack.push(sname + \"!\" + encode_range_xls((r/*:any*/), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrSum': /* [MS-XLS] 2.5.198.41 */\n\t\t\t\tstack.push(\"SUM(\" + stack.pop() + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrBaxcel': /* [MS-XLS] 2.5.198.33 */\n\t\t\tcase 'PtgAttrSemi': /* [MS-XLS] 2.5.198.37 */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgName': /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 TODO: revisions */\n\t\t\t\t/* f[1] = type, 0, nameindex */\n\t\t\t\tnameidx = (f[1][2]/*:any*/);\n\t\t\t\tvar lbl = (supbooks.names||[])[nameidx-1] || (supbooks[0]||[])[nameidx];\n\t\t\t\tvar name = lbl ? lbl.Name : \"SH33TJSNAME\" + String(nameidx);\n\t\t\t\t/* [MS-XLSB] 2.5.97.10 Ftab -- last verified 20220204 */\n\t\t\t\tif(name && name.slice(0,6) == \"_xlfn.\" && !opts.xlfn) name = name.slice(6);\n\t\t\t\tstack.push(name);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgNameX': /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 TODO: revisions */\n\t\t\t\t/* f[1] = type, ixti, nameindex */\n\t\t\t\tvar bookidx/*:number*/ = (f[1][1]/*:any*/); nameidx = (f[1][2]/*:any*/); var externbook;\n\t\t\t\t/* TODO: Properly handle missing values -- this should be using get_ixti_raw primarily */\n\t\t\t\tif(opts.biff <= 5) {\n\t\t\t\t\tif(bookidx < 0) bookidx = -bookidx;\n\t\t\t\t\tif(supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n\t\t\t\t} else {\n\t\t\t\t\tvar o = \"\";\n\t\t\t\t\tif(((supbooks[bookidx]||[])[0]||[])[0] == 0x3A01){/* empty */}\n\t\t\t\t\telse if(((supbooks[bookidx]||[])[0]||[])[0] == 0x0401){\n\t\t\t\t\t\tif(supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {\n\t\t\t\t\t\t\to = supbooks.SheetNames[supbooks[bookidx][nameidx].itab-1] + \"!\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse o = supbooks.SheetNames[nameidx-1]+ \"!\";\n\t\t\t\t\tif(supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;\n\t\t\t\t\telse if(supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar ixtidata = (get_ixti_raw(supbooks, bookidx, opts)||\"\").split(\";;\");\n\t\t\t\t\t\tif(ixtidata[nameidx - 1]) o = ixtidata[nameidx - 1]; // TODO: confirm this is correct\n\t\t\t\t\t\telse o += \"SH33TJSERRX\";\n\t\t\t\t\t}\n\t\t\t\t\tstack.push(o);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!externbook) externbook = {Name: \"SH33TJSERRY\"};\n\t\t\t\tstack.push(externbook.Name);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgParen': /* [MS-XLS] 2.5.198.80 */\n\t\t\t\tvar lp = '(', rp = ')';\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 2: lp = fill(\" \", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 3: lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 4: rp = fill(\" \", formula[0][last_sp][1][1]) + rp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 5: rp = fill(\"\\r\", formula[0][last_sp][1][1]) + rp; break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(lp + stack.pop() + rp); break;\n\n\t\t\tcase 'PtgRefErr': /* [MS-XLS] 2.5.198.86 */\n\t\t\t\tstack.push('#REF!'); break;\n\n\t\t\tcase 'PtgRefErr3d': /* [MS-XLS] 2.5.198.87 */\n\t\t\t\tstack.push('#REF!'); break;\n\n\t\t\tcase 'PtgExp': /* [MS-XLS] 2.5.198.58 TODO */\n\t\t\t\tc = {c:(f[1][1]/*:any*/),r:(f[1][0]/*:any*/)};\n\t\t\t\tvar q = ({c: cell.c, r:cell.r}/*:any*/);\n\t\t\t\tif(supbooks.sharedf[encode_cell(c)]) {\n\t\t\t\t\tvar parsedf = (supbooks.sharedf[encode_cell(c)]);\n\t\t\t\t\tstack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n\t\t\t\t} else {\n\t\t\t\t\tvar fnd = false;\n\t\t\t\t\tfor(e1=0;e1!=supbooks.arrayf.length; ++e1) {\n\t\t\t\t\t\t/* TODO: should be something like range_has */\n\t\t\t\t\t\te2 = supbooks.arrayf[e1];\n\t\t\t\t\t\tif(c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n\t\t\t\t\t\tif(c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n\t\t\t\t\t\tstack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n\t\t\t\t\t\tfnd = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(!fnd) stack.push(/*::String(*/f[1]/*::)*/);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgArray': /* [MS-XLS] 2.5.198.32 TODO */\n\t\t\t\tstack.push(\"{\" + stringify_array(/*::(*/f[1]/*:: :any)*/) + \"}\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemArea': /* [MS-XLS] 2.5.198.70 TODO: confirm this is a non-display */\n\t\t\t\t//stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrSpace': /* [MS-XLS] 2.5.198.38 */\n\t\t\tcase 'PtgAttrSpaceSemi': /* [MS-XLS] 2.5.198.39 */\n\t\t\t\tlast_sp = ff;\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgTbl': /* [MS-XLS] 2.5.198.92 TODO */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemErr': /* [MS-XLS] 2.5.198.71 */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMissArg': /* [MS-XLS] 2.5.198.74 */\n\t\t\t\tstack.push(\"\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAreaErr': /* [MS-XLS] 2.5.198.29 */\n\t\t\t\tstack.push(\"#REF!\"); break;\n\n\t\t\tcase 'PtgAreaErr3d': /* [MS-XLS] 2.5.198.30 */\n\t\t\t\tstack.push(\"#REF!\"); break;\n\n\t\t\tcase 'PtgList': /* [MS-XLSB] 2.5.97.52 */\n\t\t\t\t// $FlowIgnore\n\t\t\t\tstack.push(\"Table\" + f[1].idx + \"[#\" + f[1].rt + \"]\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemAreaN':\n\t\t\tcase 'PtgMemNoMemN':\n\t\t\tcase 'PtgAttrNoop':\n\t\t\tcase 'PtgSheet':\n\t\t\tcase 'PtgEndSheet':\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemFunc': /* [MS-XLS] 2.5.198.72 TODO */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemNoMem': /* [MS-XLS] 2.5.198.73 TODO */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgElfCol': /* [MS-XLS] 2.5.198.46 */\n\t\t\tcase 'PtgElfColS': /* [MS-XLS] 2.5.198.47 */\n\t\t\tcase 'PtgElfColSV': /* [MS-XLS] 2.5.198.48 */\n\t\t\tcase 'PtgElfColV': /* [MS-XLS] 2.5.198.49 */\n\t\t\tcase 'PtgElfLel': /* [MS-XLS] 2.5.198.50 */\n\t\t\tcase 'PtgElfRadical': /* [MS-XLS] 2.5.198.51 */\n\t\t\tcase 'PtgElfRadicalLel': /* [MS-XLS] 2.5.198.52 */\n\t\t\tcase 'PtgElfRadicalS': /* [MS-XLS] 2.5.198.53 */\n\t\t\tcase 'PtgElfRw': /* [MS-XLS] 2.5.198.54 */\n\t\t\tcase 'PtgElfRwV': /* [MS-XLS] 2.5.198.55 */\n\t\t\t\tthrow new Error(\"Unsupported ELFs\");\n\n\t\t\tcase 'PtgSxName': /* [MS-XLS] 2.5.198.91 TODO -- find a test case */\n\t\t\t\tthrow new Error('Unrecognized Formula Token: ' + String(f));\n\t\t\tdefault: throw new Error('Unrecognized Formula Token: ' + String(f));\n\t\t}\n\t\tvar PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n\t\tif(opts.biff != 3) if(last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n\t\t\tf = formula[0][last_sp];\n\t\t\tvar _left = true;\n\t\t\tswitch(f[1][0]) {\n\t\t\t\t/* note: some bad XLSB files omit the PtgParen */\n\t\t\t\tcase 4: _left = false;\n\t\t\t\t/* falls through */\n\t\t\t\tcase 0:\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tsp = fill(\" \", f[1][1]); break;\n\t\t\t\tcase 5: _left = false;\n\t\t\t\t/* falls through */\n\t\t\t\tcase 1:\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tsp = fill(\"\\r\", f[1][1]); break;\n\t\t\t\tdefault:\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + f[1][0]);\n\t\t\t}\n\t\t\tstack.push((_left ? sp : \"\") + stack.pop() + (_left ? \"\" : sp));\n\t\t\tlast_sp = -1;\n\t\t}\n\t}\n\tif(stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n\tif(stack[0] == \"TRUE\") return true; if(stack[0] == \"FALSE\") return false;\n\treturn stack[0];\n}\n\n/* [MS-XLS] 2.5.198.1 TODO */\nfunction parse_ArrayParsedFormula(blob, length, opts/*::, ref*/) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\tblob.l = target;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.3 TODO */\nfunction parse_XLSCellParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\tblob.l = target;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.21 */\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\n\tvar target = blob.l + length;\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tvar rgcb;\n\tif(target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.118 TODO */\nfunction parse_SharedParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.133 TODO: how to emit empty strings? */\nfunction parse_FormulaValue(blob/*::, length*/) {\n\tvar b;\n\tif(__readUInt16LE(blob,blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob),'n'];\n\tswitch(blob[blob.l]) {\n\t\tcase 0x00: blob.l += 8; return [\"String\", 's'];\n\t\tcase 0x01: b = blob[blob.l+2] === 0x1; blob.l += 8; return [b,'b'];\n\t\tcase 0x02: b = blob[blob.l+2]; blob.l += 8; return [b,'e'];\n\t\tcase 0x03: blob.l += 8; return [\"\",'s'];\n\t}\n\treturn [];\n}\nfunction write_FormulaValue(value) {\n\tif(value == null) {\n\t\t// Blank String Value\n\t\tvar o = new_buf(8);\n\t\to.write_shift(1, 0x03);\n\t\to.write_shift(1, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0xFFFF);\n\t\treturn o;\n\t} else if(typeof value == \"number\") return write_Xnum(value);\n\treturn write_Xnum(0);\n}\n\n/* [MS-XLS] 2.4.127 TODO */\nfunction parse_Formula(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6, opts);\n\tvar val = parse_FormulaValue(blob,8);\n\tvar flags = blob.read_shift(1);\n\tif(opts.biff != 2) {\n\t\tblob.read_shift(1);\n\t\tif(opts.biff >= 5) {\n\t\t\t/*var chn = */blob.read_shift(4);\n\t\t}\n\t}\n\tvar cbf = parse_XLSCellParsedFormula(blob, end - blob.l, opts);\n\treturn {cell:cell, val:val[0], formula:cbf, shared: (flags >> 3) & 1, tt:val[1]};\n}\nfunction write_Formula(cell/*:Cell*/, R/*:number*/, C/*:number*/, opts, os/*:number*/) {\n\t// Cell\n\tvar o1 = write_XLSCell(R, C, os);\n\n\t// FormulaValue\n\tvar o2 = write_FormulaValue(cell.v);\n\n\t// flags + cache\n\tvar o3 = new_buf(6);\n\tvar flags = 0x01 | 0x20;\n\to3.write_shift(2, flags);\n\to3.write_shift(4, 0);\n\n\t// CellParsedFormula\n\tvar bf = new_buf(cell.bf.length);\n\tfor(var i = 0; i < cell.bf.length; ++i) bf[i] = cell.bf[i];\n\n\tvar out = bconcat([o1, o2, o3, bf]);\n\treturn out;\n}\n\n\n/* XLSB Parsed Formula records have the same shape */\nfunction parse_XLSBParsedFormula(data, length, opts) {\n\tvar cce = data.read_shift(4);\n\tvar rgce = parse_Rgce(data, cce, opts);\n\tvar cb = data.read_shift(4);\n\tvar rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLSB] 2.5.97.1 ArrayParsedFormula */\nvar parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.4 CellParsedFormula */\nvar parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.8 DVParsedFormula */\n//var parse_XLSBDVParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.9 FRTParsedFormula */\n//var parse_XLSBFRTParsedFormula = parse_XLSBParsedFormula2;\n/* [MS-XLSB] 2.5.97.12 NameParsedFormula */\nvar parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.98 SharedParsedFormula */\nvar parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;\n\n/* Writes a PtgNum or PtgInt */\nfunction write_XLSBFormulaNum(val/*:number*/) {\n\tif((val | 0) == val && val < Math.pow(2,16) && val >= 0) {\n\t\tvar oint = new_buf(11);\n\t\toint.write_shift(4, 3);\n\t\toint.write_shift(1, 0x1e);\n\t\toint.write_shift(2, val);\n\t\toint.write_shift(4, 0);\n\t\treturn oint;\n\t}\n\n\tvar num = new_buf(17);\n\tnum.write_shift(4, 11);\n\tnum.write_shift(1, 0x1f);\n\tnum.write_shift(8, val);\n\tnum.write_shift(4, 0);\n\treturn num;\n}\n/* Writes a PtgErr */\nfunction write_XLSBFormulaErr(val/*:number*/) {\n\tvar oint = new_buf(10);\n\toint.write_shift(4, 2);\n\toint.write_shift(1, 0x1C);\n\toint.write_shift(1, val);\n\toint.write_shift(4, 0);\n\treturn oint;\n}\n/* Writes a PtgBool */\nfunction write_XLSBFormulaBool(val/*:boolean*/) {\n\tvar oint = new_buf(10);\n\toint.write_shift(4, 2);\n\toint.write_shift(1, 0x1D);\n\toint.write_shift(1, val?1:0);\n\toint.write_shift(4, 0);\n\treturn oint;\n}\n\n/* Writes a PtgStr */\nfunction write_XLSBFormulaStr(val/*:string*/) {\n\tvar preamble = new_buf(7);\n\tpreamble.write_shift(4, 3 + 2 * val.length);\n\tpreamble.write_shift(1, 0x17);\n\tpreamble.write_shift(2, val.length);\n\n\tvar body = new_buf(2 * val.length);\n\tbody.write_shift(2 * val.length, val, \"utf16le\");\n\n\tvar postamble = new_buf(4);\n\tpostamble.write_shift(4, 0);\n\n\treturn bconcat([preamble, body, postamble]);\n}\n\n/* Writes a PtgRef */\nfunction write_XLSBFormulaRef(str) {\n\tvar cell = decode_cell(str);\n\tvar out = new_buf(15);\n\tout.write_shift(4, 7);\n\tout.write_shift(1, 0x04 | ((1)<<5));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a PtgRef3d */\nfunction write_XLSBFormulaRef3D(str, wb) {\n\tvar lastbang = str.lastIndexOf(\"!\");\n\tvar sname = str.slice(0, lastbang);\n\tstr = str.slice(lastbang+1);\n\tvar cell = decode_cell(str);\n\tif(sname.charAt(0) == \"'\") sname = sname.slice(1, -1).replace(/''/g, \"'\");\n\n\tvar out = new_buf(17);\n\tout.write_shift(4, 9);\n\tout.write_shift(1, 0x1A | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a PtgRefErr3d */\nfunction write_XLSBFormulaRefErr3D(str, wb) {\n\tvar lastbang = str.lastIndexOf(\"!\");\n\tvar sname = str.slice(0, lastbang);\n\tstr = str.slice(lastbang+1);\n\tif(sname.charAt(0) == \"'\") sname = sname.slice(1, -1).replace(/''/g, \"'\");\n\n\tvar out = new_buf(17);\n\tout.write_shift(4, 9);\n\tout.write_shift(1, 0x1C | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, 0);\n\tout.write_shift(2, 0); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a single sheet range [PtgRef PtgRef PtgRange] */\nfunction write_XLSBFormulaRange(_str) {\n\tvar parts = _str.split(\":\"), str = parts[0];\n\n\tvar out = new_buf(23);\n\tout.write_shift(4, 15);\n\n\t/* start cell */\n\tstr = parts[0]; var cell = decode_cell(str);\n\tout.write_shift(1, 0x04 | ((1)<<5));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\t/* end cell */\n\tstr = parts[1]; cell = decode_cell(str);\n\tout.write_shift(1, 0x04 | ((1)<<5));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\tout.write_shift(4, 0);\n\n\t/* PtgRange */\n\tout.write_shift(1, 0x11);\n\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a range with explicit sheet name [PtgRef3D PtgRef3D PtgRange] */\nfunction write_XLSBFormulaRangeWS(_str, wb) {\n\tvar lastbang = _str.lastIndexOf(\"!\");\n\tvar sname = _str.slice(0, lastbang);\n\t_str = _str.slice(lastbang+1);\n\tif(sname.charAt(0) == \"'\") sname = sname.slice(1, -1).replace(/''/g, \"'\");\n\tvar parts = _str.split(\":\");\n\n\tvar out = new_buf(27);\n\tout.write_shift(4, 19);\n\n\t/* start cell */\n\tvar str = parts[0], cell = decode_cell(str);\n\tout.write_shift(1, 0x1A | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\n\t/* end cell */\n\tstr = parts[1]; cell = decode_cell(str);\n\tout.write_shift(1, 0x1A | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, cell.r);\n\tout.write_shift(2, cell.c | ((str.charAt(0) == \"$\" ? 0 : 1)<<14) | ((str.match(/\\$\\d/) ? 0 : 1)<<15)); // <== ColRelShort\n\n\t/* PtgRange */\n\tout.write_shift(1, 0x11);\n\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n/* Writes a range with explicit sheet name [PtgArea3d] */\nfunction write_XLSBFormulaArea3D(_str, wb) {\n\tvar lastbang = _str.lastIndexOf(\"!\");\n\tvar sname = _str.slice(0, lastbang);\n\t_str = _str.slice(lastbang+1);\n\tif(sname.charAt(0) == \"'\") sname = sname.slice(1, -1).replace(/''/g, \"'\");\n\tvar range = decode_range(_str);\n\n\tvar out = new_buf(23);\n\tout.write_shift(4, 15);\n\n\tout.write_shift(1, 0x1B | ((1)<<5));\n\tout.write_shift(2, 2 + wb.SheetNames.map(function(n) { return n.toLowerCase(); }).indexOf(sname.toLowerCase()));\n\tout.write_shift(4, range.s.r);\n\tout.write_shift(4, range.e.r);\n\tout.write_shift(2, range.s.c);\n\tout.write_shift(2, range.e.c);\n\n\tout.write_shift(4, 0);\n\n\treturn out;\n}\n\n\n/* General Formula */\nfunction write_XLSBFormula(val/*:string|number*/, wb) {\n\tif(typeof val == \"number\") return write_XLSBFormulaNum(val);\n\tif(typeof val == \"boolean\") return write_XLSBFormulaBool(val);\n\tif(/^#(DIV\\/0!|GETTING_DATA|N\\/A|NAME\\?|NULL!|NUM!|REF!|VALUE!)$/.test(val)) return write_XLSBFormulaErr(+RBErr[val]);\n\tif(val.match(/^\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaRef(val);\n\tif(val.match(/^\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5}):\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaRange(val);\n\tif(val.match(/^#REF!\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5}):\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaArea3D(val, wb);\n\tif(val.match(/^(?:'[^\\\\\\/?*\\[\\]:]*'|[^'][^\\\\\\/?*\\[\\]:'`~!@#$%^()\\-=+{}|;,<.>]*)!\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaRef3D(val, wb);\n\tif(val.match(/^(?:'[^\\\\\\/?*\\[\\]:]*'|[^'][^\\\\\\/?*\\[\\]:'`~!@#$%^()\\-=+{}|;,<.>]*)!\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5}):\\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\\$?(?:10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})$/)) return write_XLSBFormulaRangeWS(val, wb);\n\tif(/^(?:'[^\\\\\\/?*\\[\\]:]*'|[^'][^\\\\\\/?*\\[\\]:'`~!@#$%^()\\-=+{}|;,<.>]*)!#REF!$/.test(val)) return write_XLSBFormulaRefErr3D(val, wb);\n\tif(/^\".*\"$/.test(val)) return write_XLSBFormulaStr(val);\n\tif(/^[+-]\\d+$/.test(val)) return write_XLSBFormulaNum(parseInt(val, 10));\n\tthrow \"Formula |\" + val + \"| not supported for XLSB\";\n}\nvar write_XLSBNameParsedFormula = write_XLSBFormula;\nvar Cetab = {\n  0: \"BEEP\",\n  1: \"OPEN\",\n  2: \"OPEN.LINKS\",\n  3: \"CLOSE.ALL\",\n  4: \"SAVE\",\n  5: \"SAVE.AS\",\n  6: \"FILE.DELETE\",\n  7: \"PAGE.SETUP\",\n  8: \"PRINT\",\n  9: \"PRINTER.SETUP\",\n  10: \"QUIT\",\n  11: \"NEW.WINDOW\",\n  12: \"ARRANGE.ALL\",\n  13: \"WINDOW.SIZE\",\n  14: \"WINDOW.MOVE\",\n  15: \"FULL\",\n  16: \"CLOSE\",\n  17: \"RUN\",\n  22: \"SET.PRINT.AREA\",\n  23: \"SET.PRINT.TITLES\",\n  24: \"SET.PAGE.BREAK\",\n  25: \"REMOVE.PAGE.BREAK\",\n  26: \"FONT\",\n  27: \"DISPLAY\",\n  28: \"PROTECT.DOCUMENT\",\n  29: \"PRECISION\",\n  30: \"A1.R1C1\",\n  31: \"CALCULATE.NOW\",\n  32: \"CALCULATION\",\n  34: \"DATA.FIND\",\n  35: \"EXTRACT\",\n  36: \"DATA.DELETE\",\n  37: \"SET.DATABASE\",\n  38: \"SET.CRITERIA\",\n  39: \"SORT\",\n  40: \"DATA.SERIES\",\n  41: \"TABLE\",\n  42: \"FORMAT.NUMBER\",\n  43: \"ALIGNMENT\",\n  44: \"STYLE\",\n  45: \"BORDER\",\n  46: \"CELL.PROTECTION\",\n  47: \"COLUMN.WIDTH\",\n  48: \"UNDO\",\n  49: \"CUT\",\n  50: \"COPY\",\n  51: \"PASTE\",\n  52: \"CLEAR\",\n  53: \"PASTE.SPECIAL\",\n  54: \"EDIT.DELETE\",\n  55: \"INSERT\",\n  56: \"FILL.RIGHT\",\n  57: \"FILL.DOWN\",\n  61: \"DEFINE.NAME\",\n  62: \"CREATE.NAMES\",\n  63: \"FORMULA.GOTO\",\n  64: \"FORMULA.FIND\",\n  65: \"SELECT.LAST.CELL\",\n  66: \"SHOW.ACTIVE.CELL\",\n  67: \"GALLERY.AREA\",\n  68: \"GALLERY.BAR\",\n  69: \"GALLERY.COLUMN\",\n  70: \"GALLERY.LINE\",\n  71: \"GALLERY.PIE\",\n  72: \"GALLERY.SCATTER\",\n  73: \"COMBINATION\",\n  74: \"PREFERRED\",\n  75: \"ADD.OVERLAY\",\n  76: \"GRIDLINES\",\n  77: \"SET.PREFERRED\",\n  78: \"AXES\",\n  79: \"LEGEND\",\n  80: \"ATTACH.TEXT\",\n  81: \"ADD.ARROW\",\n  82: \"SELECT.CHART\",\n  83: \"SELECT.PLOT.AREA\",\n  84: \"PATTERNS\",\n  85: \"MAIN.CHART\",\n  86: \"OVERLAY\",\n  87: \"SCALE\",\n  88: \"FORMAT.LEGEND\",\n  89: \"FORMAT.TEXT\",\n  90: \"EDIT.REPEAT\",\n  91: \"PARSE\",\n  92: \"JUSTIFY\",\n  93: \"HIDE\",\n  94: \"UNHIDE\",\n  95: \"WORKSPACE\",\n  96: \"FORMULA\",\n  97: \"FORMULA.FILL\",\n  98: \"FORMULA.ARRAY\",\n  99: \"DATA.FIND.NEXT\",\n  100: \"DATA.FIND.PREV\",\n  101: \"FORMULA.FIND.NEXT\",\n  102: \"FORMULA.FIND.PREV\",\n  103: \"ACTIVATE\",\n  104: \"ACTIVATE.NEXT\",\n  105: \"ACTIVATE.PREV\",\n  106: \"UNLOCKED.NEXT\",\n  107: \"UNLOCKED.PREV\",\n  108: \"COPY.PICTURE\",\n  109: \"SELECT\",\n  110: \"DELETE.NAME\",\n  111: \"DELETE.FORMAT\",\n  112: \"VLINE\",\n  113: \"HLINE\",\n  114: \"VPAGE\",\n  115: \"HPAGE\",\n  116: \"VSCROLL\",\n  117: \"HSCROLL\",\n  118: \"ALERT\",\n  119: \"NEW\",\n  120: \"CANCEL.COPY\",\n  121: \"SHOW.CLIPBOARD\",\n  122: \"MESSAGE\",\n  124: \"PASTE.LINK\",\n  125: \"APP.ACTIVATE\",\n  126: \"DELETE.ARROW\",\n  127: \"ROW.HEIGHT\",\n  128: \"FORMAT.MOVE\",\n  129: \"FORMAT.SIZE\",\n  130: \"FORMULA.REPLACE\",\n  131: \"SEND.KEYS\",\n  132: \"SELECT.SPECIAL\",\n  133: \"APPLY.NAMES\",\n  134: \"REPLACE.FONT\",\n  135: \"FREEZE.PANES\",\n  136: \"SHOW.INFO\",\n  137: \"SPLIT\",\n  138: \"ON.WINDOW\",\n  139: \"ON.DATA\",\n  140: \"DISABLE.INPUT\",\n  142: \"OUTLINE\",\n  143: \"LIST.NAMES\",\n  144: \"FILE.CLOSE\",\n  145: \"SAVE.WORKBOOK\",\n  146: \"DATA.FORM\",\n  147: \"COPY.CHART\",\n  148: \"ON.TIME\",\n  149: \"WAIT\",\n  150: \"FORMAT.FONT\",\n  151: \"FILL.UP\",\n  152: \"FILL.LEFT\",\n  153: \"DELETE.OVERLAY\",\n  155: \"SHORT.MENUS\",\n  159: \"SET.UPDATE.STATUS\",\n  161: \"COLOR.PALETTE\",\n  162: \"DELETE.STYLE\",\n  163: \"WINDOW.RESTORE\",\n  164: \"WINDOW.MAXIMIZE\",\n  166: \"CHANGE.LINK\",\n  167: \"CALCULATE.DOCUMENT\",\n  168: \"ON.KEY\",\n  169: \"APP.RESTORE\",\n  170: \"APP.MOVE\",\n  171: \"APP.SIZE\",\n  172: \"APP.MINIMIZE\",\n  173: \"APP.MAXIMIZE\",\n  174: \"BRING.TO.FRONT\",\n  175: \"SEND.TO.BACK\",\n  185: \"MAIN.CHART.TYPE\",\n  186: \"OVERLAY.CHART.TYPE\",\n  187: \"SELECT.END\",\n  188: \"OPEN.MAIL\",\n  189: \"SEND.MAIL\",\n  190: \"STANDARD.FONT\",\n  191: \"CONSOLIDATE\",\n  192: \"SORT.SPECIAL\",\n  193: \"GALLERY.3D.AREA\",\n  194: \"GALLERY.3D.COLUMN\",\n  195: \"GALLERY.3D.LINE\",\n  196: \"GALLERY.3D.PIE\",\n  197: \"VIEW.3D\",\n  198: \"GOAL.SEEK\",\n  199: \"WORKGROUP\",\n  200: \"FILL.GROUP\",\n  201: \"UPDATE.LINK\",\n  202: \"PROMOTE\",\n  203: \"DEMOTE\",\n  204: \"SHOW.DETAIL\",\n  206: \"UNGROUP\",\n  207: \"OBJECT.PROPERTIES\",\n  208: \"SAVE.NEW.OBJECT\",\n  209: \"SHARE\",\n  210: \"SHARE.NAME\",\n  211: \"DUPLICATE\",\n  212: \"APPLY.STYLE\",\n  213: \"ASSIGN.TO.OBJECT\",\n  214: \"OBJECT.PROTECTION\",\n  215: \"HIDE.OBJECT\",\n  216: \"SET.EXTRACT\",\n  217: \"CREATE.PUBLISHER\",\n  218: \"SUBSCRIBE.TO\",\n  219: \"ATTRIBUTES\",\n  220: \"SHOW.TOOLBAR\",\n  222: \"PRINT.PREVIEW\",\n  223: \"EDIT.COLOR\",\n  224: \"SHOW.LEVELS\",\n  225: \"FORMAT.MAIN\",\n  226: \"FORMAT.OVERLAY\",\n  227: \"ON.RECALC\",\n  228: \"EDIT.SERIES\",\n  229: \"DEFINE.STYLE\",\n  240: \"LINE.PRINT\",\n  243: \"ENTER.DATA\",\n  249: \"GALLERY.RADAR\",\n  250: \"MERGE.STYLES\",\n  251: \"EDITION.OPTIONS\",\n  252: \"PASTE.PICTURE\",\n  253: \"PASTE.PICTURE.LINK\",\n  254: \"SPELLING\",\n  256: \"ZOOM\",\n  259: \"INSERT.OBJECT\",\n  260: \"WINDOW.MINIMIZE\",\n  265: \"SOUND.NOTE\",\n  266: \"SOUND.PLAY\",\n  267: \"FORMAT.SHAPE\",\n  268: \"EXTEND.POLYGON\",\n  269: \"FORMAT.AUTO\",\n  272: \"GALLERY.3D.BAR\",\n  273: \"GALLERY.3D.SURFACE\",\n  274: \"FILL.AUTO\",\n  276: \"CUSTOMIZE.TOOLBAR\",\n  277: \"ADD.TOOL\",\n  278: \"EDIT.OBJECT\",\n  279: \"ON.DOUBLECLICK\",\n  280: \"ON.ENTRY\",\n  281: \"WORKBOOK.ADD\",\n  282: \"WORKBOOK.MOVE\",\n  283: \"WORKBOOK.COPY\",\n  284: \"WORKBOOK.OPTIONS\",\n  285: \"SAVE.WORKSPACE\",\n  288: \"CHART.WIZARD\",\n  289: \"DELETE.TOOL\",\n  290: \"MOVE.TOOL\",\n  291: \"WORKBOOK.SELECT\",\n  292: \"WORKBOOK.ACTIVATE\",\n  293: \"ASSIGN.TO.TOOL\",\n  295: \"COPY.TOOL\",\n  296: \"RESET.TOOL\",\n  297: \"CONSTRAIN.NUMERIC\",\n  298: \"PASTE.TOOL\",\n  302: \"WORKBOOK.NEW\",\n  305: \"SCENARIO.CELLS\",\n  306: \"SCENARIO.DELETE\",\n  307: \"SCENARIO.ADD\",\n  308: \"SCENARIO.EDIT\",\n  309: \"SCENARIO.SHOW\",\n  310: \"SCENARIO.SHOW.NEXT\",\n  311: \"SCENARIO.SUMMARY\",\n  312: \"PIVOT.TABLE.WIZARD\",\n  313: \"PIVOT.FIELD.PROPERTIES\",\n  314: \"PIVOT.FIELD\",\n  315: \"PIVOT.ITEM\",\n  316: \"PIVOT.ADD.FIELDS\",\n  318: \"OPTIONS.CALCULATION\",\n  319: \"OPTIONS.EDIT\",\n  320: \"OPTIONS.VIEW\",\n  321: \"ADDIN.MANAGER\",\n  322: \"MENU.EDITOR\",\n  323: \"ATTACH.TOOLBARS\",\n  324: \"VBAActivate\",\n  325: \"OPTIONS.CHART\",\n  328: \"VBA.INSERT.FILE\",\n  330: \"VBA.PROCEDURE.DEFINITION\",\n  336: \"ROUTING.SLIP\",\n  338: \"ROUTE.DOCUMENT\",\n  339: \"MAIL.LOGON\",\n  342: \"INSERT.PICTURE\",\n  343: \"EDIT.TOOL\",\n  344: \"GALLERY.DOUGHNUT\",\n  350: \"CHART.TREND\",\n  352: \"PIVOT.ITEM.PROPERTIES\",\n  354: \"WORKBOOK.INSERT\",\n  355: \"OPTIONS.TRANSITION\",\n  356: \"OPTIONS.GENERAL\",\n  370: \"FILTER.ADVANCED\",\n  373: \"MAIL.ADD.MAILER\",\n  374: \"MAIL.DELETE.MAILER\",\n  375: \"MAIL.REPLY\",\n  376: \"MAIL.REPLY.ALL\",\n  377: \"MAIL.FORWARD\",\n  378: \"MAIL.NEXT.LETTER\",\n  379: \"DATA.LABEL\",\n  380: \"INSERT.TITLE\",\n  381: \"FONT.PROPERTIES\",\n  382: \"MACRO.OPTIONS\",\n  383: \"WORKBOOK.HIDE\",\n  384: \"WORKBOOK.UNHIDE\",\n  385: \"WORKBOOK.DELETE\",\n  386: \"WORKBOOK.NAME\",\n  388: \"GALLERY.CUSTOM\",\n  390: \"ADD.CHART.AUTOFORMAT\",\n  391: \"DELETE.CHART.AUTOFORMAT\",\n  392: \"CHART.ADD.DATA\",\n  393: \"AUTO.OUTLINE\",\n  394: \"TAB.ORDER\",\n  395: \"SHOW.DIALOG\",\n  396: \"SELECT.ALL\",\n  397: \"UNGROUP.SHEETS\",\n  398: \"SUBTOTAL.CREATE\",\n  399: \"SUBTOTAL.REMOVE\",\n  400: \"RENAME.OBJECT\",\n  412: \"WORKBOOK.SCROLL\",\n  413: \"WORKBOOK.NEXT\",\n  414: \"WORKBOOK.PREV\",\n  415: \"WORKBOOK.TAB.SPLIT\",\n  416: \"FULL.SCREEN\",\n  417: \"WORKBOOK.PROTECT\",\n  420: \"SCROLLBAR.PROPERTIES\",\n  421: \"PIVOT.SHOW.PAGES\",\n  422: \"TEXT.TO.COLUMNS\",\n  423: \"FORMAT.CHARTTYPE\",\n  424: \"LINK.FORMAT\",\n  425: \"TRACER.DISPLAY\",\n  430: \"TRACER.NAVIGATE\",\n  431: \"TRACER.CLEAR\",\n  432: \"TRACER.ERROR\",\n  433: \"PIVOT.FIELD.GROUP\",\n  434: \"PIVOT.FIELD.UNGROUP\",\n  435: \"CHECKBOX.PROPERTIES\",\n  436: \"LABEL.PROPERTIES\",\n  437: \"LISTBOX.PROPERTIES\",\n  438: \"EDITBOX.PROPERTIES\",\n  439: \"PIVOT.REFRESH\",\n  440: \"LINK.COMBO\",\n  441: \"OPEN.TEXT\",\n  442: \"HIDE.DIALOG\",\n  443: \"SET.DIALOG.FOCUS\",\n  444: \"ENABLE.OBJECT\",\n  445: \"PUSHBUTTON.PROPERTIES\",\n  446: \"SET.DIALOG.DEFAULT\",\n  447: \"FILTER\",\n  448: \"FILTER.SHOW.ALL\",\n  449: \"CLEAR.OUTLINE\",\n  450: \"FUNCTION.WIZARD\",\n  451: \"ADD.LIST.ITEM\",\n  452: \"SET.LIST.ITEM\",\n  453: \"REMOVE.LIST.ITEM\",\n  454: \"SELECT.LIST.ITEM\",\n  455: \"SET.CONTROL.VALUE\",\n  456: \"SAVE.COPY.AS\",\n  458: \"OPTIONS.LISTS.ADD\",\n  459: \"OPTIONS.LISTS.DELETE\",\n  460: \"SERIES.AXES\",\n  461: \"SERIES.X\",\n  462: \"SERIES.Y\",\n  463: \"ERRORBAR.X\",\n  464: \"ERRORBAR.Y\",\n  465: \"FORMAT.CHART\",\n  466: \"SERIES.ORDER\",\n  467: \"MAIL.LOGOFF\",\n  468: \"CLEAR.ROUTING.SLIP\",\n  469: \"APP.ACTIVATE.MICROSOFT\",\n  470: \"MAIL.EDIT.MAILER\",\n  471: \"ON.SHEET\",\n  472: \"STANDARD.WIDTH\",\n  473: \"SCENARIO.MERGE\",\n  474: \"SUMMARY.INFO\",\n  475: \"FIND.FILE\",\n  476: \"ACTIVE.CELL.FONT\",\n  477: \"ENABLE.TIPWIZARD\",\n  478: \"VBA.MAKE.ADDIN\",\n  480: \"INSERTDATATABLE\",\n  481: \"WORKGROUP.OPTIONS\",\n  482: \"MAIL.SEND.MAILER\",\n  485: \"AUTOCORRECT\",\n  489: \"POST.DOCUMENT\",\n  491: \"PICKLIST\",\n  493: \"VIEW.SHOW\",\n  494: \"VIEW.DEFINE\",\n  495: \"VIEW.DELETE\",\n  509: \"SHEET.BACKGROUND\",\n  510: \"INSERT.MAP.OBJECT\",\n  511: \"OPTIONS.MENONO\",\n  517: \"MSOCHECKS\",\n  518: \"NORMAL\",\n  519: \"LAYOUT\",\n  520: \"RM.PRINT.AREA\",\n  521: \"CLEAR.PRINT.AREA\",\n  522: \"ADD.PRINT.AREA\",\n  523: \"MOVE.BRK\",\n  545: \"HIDECURR.NOTE\",\n  546: \"HIDEALL.NOTES\",\n  547: \"DELETE.NOTE\",\n  548: \"TRAVERSE.NOTES\",\n  549: \"ACTIVATE.NOTES\",\n  620: \"PROTECT.REVISIONS\",\n  621: \"UNPROTECT.REVISIONS\",\n  647: \"OPTIONS.ME\",\n  653: \"WEB.PUBLISH\",\n  667: \"NEWWEBQUERY\",\n  673: \"PIVOT.TABLE.CHART\",\n  753: \"OPTIONS.SAVE\",\n  755: \"OPTIONS.SPELL\",\n  808: \"HIDEALL.INKANNOTS\"\n};\nvar Ftab = {\n  0: \"COUNT\",\n  1: \"IF\",\n  2: \"ISNA\",\n  3: \"ISERROR\",\n  4: \"SUM\",\n  5: \"AVERAGE\",\n  6: \"MIN\",\n  7: \"MAX\",\n  8: \"ROW\",\n  9: \"COLUMN\",\n  10: \"NA\",\n  11: \"NPV\",\n  12: \"STDEV\",\n  13: \"DOLLAR\",\n  14: \"FIXED\",\n  15: \"SIN\",\n  16: \"COS\",\n  17: \"TAN\",\n  18: \"ATAN\",\n  19: \"PI\",\n  20: \"SQRT\",\n  21: \"EXP\",\n  22: \"LN\",\n  23: \"LOG10\",\n  24: \"ABS\",\n  25: \"INT\",\n  26: \"SIGN\",\n  27: \"ROUND\",\n  28: \"LOOKUP\",\n  29: \"INDEX\",\n  30: \"REPT\",\n  31: \"MID\",\n  32: \"LEN\",\n  33: \"VALUE\",\n  34: \"TRUE\",\n  35: \"FALSE\",\n  36: \"AND\",\n  37: \"OR\",\n  38: \"NOT\",\n  39: \"MOD\",\n  40: \"DCOUNT\",\n  41: \"DSUM\",\n  42: \"DAVERAGE\",\n  43: \"DMIN\",\n  44: \"DMAX\",\n  45: \"DSTDEV\",\n  46: \"VAR\",\n  47: \"DVAR\",\n  48: \"TEXT\",\n  49: \"LINEST\",\n  50: \"TREND\",\n  51: \"LOGEST\",\n  52: \"GROWTH\",\n  53: \"GOTO\",\n  54: \"HALT\",\n  55: \"RETURN\",\n  56: \"PV\",\n  57: \"FV\",\n  58: \"NPER\",\n  59: \"PMT\",\n  60: \"RATE\",\n  61: \"MIRR\",\n  62: \"IRR\",\n  63: \"RAND\",\n  64: \"MATCH\",\n  65: \"DATE\",\n  66: \"TIME\",\n  67: \"DAY\",\n  68: \"MONTH\",\n  69: \"YEAR\",\n  70: \"WEEKDAY\",\n  71: \"HOUR\",\n  72: \"MINUTE\",\n  73: \"SECOND\",\n  74: \"NOW\",\n  75: \"AREAS\",\n  76: \"ROWS\",\n  77: \"COLUMNS\",\n  78: \"OFFSET\",\n  79: \"ABSREF\",\n  80: \"RELREF\",\n  81: \"ARGUMENT\",\n  82: \"SEARCH\",\n  83: \"TRANSPOSE\",\n  84: \"ERROR\",\n  85: \"STEP\",\n  86: \"TYPE\",\n  87: \"ECHO\",\n  88: \"SET.NAME\",\n  89: \"CALLER\",\n  90: \"DEREF\",\n  91: \"WINDOWS\",\n  92: \"SERIES\",\n  93: \"DOCUMENTS\",\n  94: \"ACTIVE.CELL\",\n  95: \"SELECTION\",\n  96: \"RESULT\",\n  97: \"ATAN2\",\n  98: \"ASIN\",\n  99: \"ACOS\",\n  100: \"CHOOSE\",\n  101: \"HLOOKUP\",\n  102: \"VLOOKUP\",\n  103: \"LINKS\",\n  104: \"INPUT\",\n  105: \"ISREF\",\n  106: \"GET.FORMULA\",\n  107: \"GET.NAME\",\n  108: \"SET.VALUE\",\n  109: \"LOG\",\n  110: \"EXEC\",\n  111: \"CHAR\",\n  112: \"LOWER\",\n  113: \"UPPER\",\n  114: \"PROPER\",\n  115: \"LEFT\",\n  116: \"RIGHT\",\n  117: \"EXACT\",\n  118: \"TRIM\",\n  119: \"REPLACE\",\n  120: \"SUBSTITUTE\",\n  121: \"CODE\",\n  122: \"NAMES\",\n  123: \"DIRECTORY\",\n  124: \"FIND\",\n  125: \"CELL\",\n  126: \"ISERR\",\n  127: \"ISTEXT\",\n  128: \"ISNUMBER\",\n  129: \"ISBLANK\",\n  130: \"T\",\n  131: \"N\",\n  132: \"FOPEN\",\n  133: \"FCLOSE\",\n  134: \"FSIZE\",\n  135: \"FREADLN\",\n  136: \"FREAD\",\n  137: \"FWRITELN\",\n  138: \"FWRITE\",\n  139: \"FPOS\",\n  140: \"DATEVALUE\",\n  141: \"TIMEVALUE\",\n  142: \"SLN\",\n  143: \"SYD\",\n  144: \"DDB\",\n  145: \"GET.DEF\",\n  146: \"REFTEXT\",\n  147: \"TEXTREF\",\n  148: \"INDIRECT\",\n  149: \"REGISTER\",\n  150: \"CALL\",\n  151: \"ADD.BAR\",\n  152: \"ADD.MENU\",\n  153: \"ADD.COMMAND\",\n  154: \"ENABLE.COMMAND\",\n  155: \"CHECK.COMMAND\",\n  156: \"RENAME.COMMAND\",\n  157: \"SHOW.BAR\",\n  158: \"DELETE.MENU\",\n  159: \"DELETE.COMMAND\",\n  160: \"GET.CHART.ITEM\",\n  161: \"DIALOG.BOX\",\n  162: \"CLEAN\",\n  163: \"MDETERM\",\n  164: \"MINVERSE\",\n  165: \"MMULT\",\n  166: \"FILES\",\n  167: \"IPMT\",\n  168: \"PPMT\",\n  169: \"COUNTA\",\n  170: \"CANCEL.KEY\",\n  171: \"FOR\",\n  172: \"WHILE\",\n  173: \"BREAK\",\n  174: \"NEXT\",\n  175: \"INITIATE\",\n  176: \"REQUEST\",\n  177: \"POKE\",\n  178: \"EXECUTE\",\n  179: \"TERMINATE\",\n  180: \"RESTART\",\n  181: \"HELP\",\n  182: \"GET.BAR\",\n  183: \"PRODUCT\",\n  184: \"FACT\",\n  185: \"GET.CELL\",\n  186: \"GET.WORKSPACE\",\n  187: \"GET.WINDOW\",\n  188: \"GET.DOCUMENT\",\n  189: \"DPRODUCT\",\n  190: \"ISNONTEXT\",\n  191: \"GET.NOTE\",\n  192: \"NOTE\",\n  193: \"STDEVP\",\n  194: \"VARP\",\n  195: \"DSTDEVP\",\n  196: \"DVARP\",\n  197: \"TRUNC\",\n  198: \"ISLOGICAL\",\n  199: \"DCOUNTA\",\n  200: \"DELETE.BAR\",\n  201: \"UNREGISTER\",\n  204: \"USDOLLAR\",\n  205: \"FINDB\",\n  206: \"SEARCHB\",\n  207: \"REPLACEB\",\n  208: \"LEFTB\",\n  209: \"RIGHTB\",\n  210: \"MIDB\",\n  211: \"LENB\",\n  212: \"ROUNDUP\",\n  213: \"ROUNDDOWN\",\n  214: \"ASC\",\n  215: \"DBCS\",\n  216: \"RANK\",\n  219: \"ADDRESS\",\n  220: \"DAYS360\",\n  221: \"TODAY\",\n  222: \"VDB\",\n  223: \"ELSE\",\n  224: \"ELSE.IF\",\n  225: \"END.IF\",\n  226: \"FOR.CELL\",\n  227: \"MEDIAN\",\n  228: \"SUMPRODUCT\",\n  229: \"SINH\",\n  230: \"COSH\",\n  231: \"TANH\",\n  232: \"ASINH\",\n  233: \"ACOSH\",\n  234: \"ATANH\",\n  235: \"DGET\",\n  236: \"CREATE.OBJECT\",\n  237: \"VOLATILE\",\n  238: \"LAST.ERROR\",\n  239: \"CUSTOM.UNDO\",\n  240: \"CUSTOM.REPEAT\",\n  241: \"FORMULA.CONVERT\",\n  242: \"GET.LINK.INFO\",\n  243: \"TEXT.BOX\",\n  244: \"INFO\",\n  245: \"GROUP\",\n  246: \"GET.OBJECT\",\n  247: \"DB\",\n  248: \"PAUSE\",\n  251: \"RESUME\",\n  252: \"FREQUENCY\",\n  253: \"ADD.TOOLBAR\",\n  254: \"DELETE.TOOLBAR\",\n  255: \"User\",\n  256: \"RESET.TOOLBAR\",\n  257: \"EVALUATE\",\n  258: \"GET.TOOLBAR\",\n  259: \"GET.TOOL\",\n  260: \"SPELLING.CHECK\",\n  261: \"ERROR.TYPE\",\n  262: \"APP.TITLE\",\n  263: \"WINDOW.TITLE\",\n  264: \"SAVE.TOOLBAR\",\n  265: \"ENABLE.TOOL\",\n  266: \"PRESS.TOOL\",\n  267: \"REGISTER.ID\",\n  268: \"GET.WORKBOOK\",\n  269: \"AVEDEV\",\n  270: \"BETADIST\",\n  271: \"GAMMALN\",\n  272: \"BETAINV\",\n  273: \"BINOMDIST\",\n  274: \"CHIDIST\",\n  275: \"CHIINV\",\n  276: \"COMBIN\",\n  277: \"CONFIDENCE\",\n  278: \"CRITBINOM\",\n  279: \"EVEN\",\n  280: \"EXPONDIST\",\n  281: \"FDIST\",\n  282: \"FINV\",\n  283: \"FISHER\",\n  284: \"FISHERINV\",\n  285: \"FLOOR\",\n  286: \"GAMMADIST\",\n  287: \"GAMMAINV\",\n  288: \"CEILING\",\n  289: \"HYPGEOMDIST\",\n  290: \"LOGNORMDIST\",\n  291: \"LOGINV\",\n  292: \"NEGBINOMDIST\",\n  293: \"NORMDIST\",\n  294: \"NORMSDIST\",\n  295: \"NORMINV\",\n  296: \"NORMSINV\",\n  297: \"STANDARDIZE\",\n  298: \"ODD\",\n  299: \"PERMUT\",\n  300: \"POISSON\",\n  301: \"TDIST\",\n  302: \"WEIBULL\",\n  303: \"SUMXMY2\",\n  304: \"SUMX2MY2\",\n  305: \"SUMX2PY2\",\n  306: \"CHITEST\",\n  307: \"CORREL\",\n  308: \"COVAR\",\n  309: \"FORECAST\",\n  310: \"FTEST\",\n  311: \"INTERCEPT\",\n  312: \"PEARSON\",\n  313: \"RSQ\",\n  314: \"STEYX\",\n  315: \"SLOPE\",\n  316: \"TTEST\",\n  317: \"PROB\",\n  318: \"DEVSQ\",\n  319: \"GEOMEAN\",\n  320: \"HARMEAN\",\n  321: \"SUMSQ\",\n  322: \"KURT\",\n  323: \"SKEW\",\n  324: \"ZTEST\",\n  325: \"LARGE\",\n  326: \"SMALL\",\n  327: \"QUARTILE\",\n  328: \"PERCENTILE\",\n  329: \"PERCENTRANK\",\n  330: \"MODE\",\n  331: \"TRIMMEAN\",\n  332: \"TINV\",\n  334: \"MOVIE.COMMAND\",\n  335: \"GET.MOVIE\",\n  336: \"CONCATENATE\",\n  337: \"POWER\",\n  338: \"PIVOT.ADD.DATA\",\n  339: \"GET.PIVOT.TABLE\",\n  340: \"GET.PIVOT.FIELD\",\n  341: \"GET.PIVOT.ITEM\",\n  342: \"RADIANS\",\n  343: \"DEGREES\",\n  344: \"SUBTOTAL\",\n  345: \"SUMIF\",\n  346: \"COUNTIF\",\n  347: \"COUNTBLANK\",\n  348: \"SCENARIO.GET\",\n  349: \"OPTIONS.LISTS.GET\",\n  350: \"ISPMT\",\n  351: \"DATEDIF\",\n  352: \"DATESTRING\",\n  353: \"NUMBERSTRING\",\n  354: \"ROMAN\",\n  355: \"OPEN.DIALOG\",\n  356: \"SAVE.DIALOG\",\n  357: \"VIEW.GET\",\n  358: \"GETPIVOTDATA\",\n  359: \"HYPERLINK\",\n  360: \"PHONETIC\",\n  361: \"AVERAGEA\",\n  362: \"MAXA\",\n  363: \"MINA\",\n  364: \"STDEVPA\",\n  365: \"VARPA\",\n  366: \"STDEVA\",\n  367: \"VARA\",\n  368: \"BAHTTEXT\",\n  369: \"THAIDAYOFWEEK\",\n  370: \"THAIDIGIT\",\n  371: \"THAIMONTHOFYEAR\",\n  372: \"THAINUMSOUND\",\n  373: \"THAINUMSTRING\",\n  374: \"THAISTRINGLENGTH\",\n  375: \"ISTHAIDIGIT\",\n  376: \"ROUNDBAHTDOWN\",\n  377: \"ROUNDBAHTUP\",\n  378: \"THAIYEAR\",\n  379: \"RTD\",\n  380: \"CUBEVALUE\",\n  381: \"CUBEMEMBER\",\n  382: \"CUBEMEMBERPROPERTY\",\n  383: \"CUBERANKEDMEMBER\",\n  384: \"HEX2BIN\",\n  385: \"HEX2DEC\",\n  386: \"HEX2OCT\",\n  387: \"DEC2BIN\",\n  388: \"DEC2HEX\",\n  389: \"DEC2OCT\",\n  390: \"OCT2BIN\",\n  391: \"OCT2HEX\",\n  392: \"OCT2DEC\",\n  393: \"BIN2DEC\",\n  394: \"BIN2OCT\",\n  395: \"BIN2HEX\",\n  396: \"IMSUB\",\n  397: \"IMDIV\",\n  398: \"IMPOWER\",\n  399: \"IMABS\",\n  400: \"IMSQRT\",\n  401: \"IMLN\",\n  402: \"IMLOG2\",\n  403: \"IMLOG10\",\n  404: \"IMSIN\",\n  405: \"IMCOS\",\n  406: \"IMEXP\",\n  407: \"IMARGUMENT\",\n  408: \"IMCONJUGATE\",\n  409: \"IMAGINARY\",\n  410: \"IMREAL\",\n  411: \"COMPLEX\",\n  412: \"IMSUM\",\n  413: \"IMPRODUCT\",\n  414: \"SERIESSUM\",\n  415: \"FACTDOUBLE\",\n  416: \"SQRTPI\",\n  417: \"QUOTIENT\",\n  418: \"DELTA\",\n  419: \"GESTEP\",\n  420: \"ISEVEN\",\n  421: \"ISODD\",\n  422: \"MROUND\",\n  423: \"ERF\",\n  424: \"ERFC\",\n  425: \"BESSELJ\",\n  426: \"BESSELK\",\n  427: \"BESSELY\",\n  428: \"BESSELI\",\n  429: \"XIRR\",\n  430: \"XNPV\",\n  431: \"PRICEMAT\",\n  432: \"YIELDMAT\",\n  433: \"INTRATE\",\n  434: \"RECEIVED\",\n  435: \"DISC\",\n  436: \"PRICEDISC\",\n  437: \"YIELDDISC\",\n  438: \"TBILLEQ\",\n  439: \"TBILLPRICE\",\n  440: \"TBILLYIELD\",\n  441: \"PRICE\",\n  442: \"YIELD\",\n  443: \"DOLLARDE\",\n  444: \"DOLLARFR\",\n  445: \"NOMINAL\",\n  446: \"EFFECT\",\n  447: \"CUMPRINC\",\n  448: \"CUMIPMT\",\n  449: \"EDATE\",\n  450: \"EOMONTH\",\n  451: \"YEARFRAC\",\n  452: \"COUPDAYBS\",\n  453: \"COUPDAYS\",\n  454: \"COUPDAYSNC\",\n  455: \"COUPNCD\",\n  456: \"COUPNUM\",\n  457: \"COUPPCD\",\n  458: \"DURATION\",\n  459: \"MDURATION\",\n  460: \"ODDLPRICE\",\n  461: \"ODDLYIELD\",\n  462: \"ODDFPRICE\",\n  463: \"ODDFYIELD\",\n  464: \"RANDBETWEEN\",\n  465: \"WEEKNUM\",\n  466: \"AMORDEGRC\",\n  467: \"AMORLINC\",\n  468: \"CONVERT\",\n  724: \"SHEETJS\",\n  469: \"ACCRINT\",\n  470: \"ACCRINTM\",\n  471: \"WORKDAY\",\n  472: \"NETWORKDAYS\",\n  473: \"GCD\",\n  474: \"MULTINOMIAL\",\n  475: \"LCM\",\n  476: \"FVSCHEDULE\",\n  477: \"CUBEKPIMEMBER\",\n  478: \"CUBESET\",\n  479: \"CUBESETCOUNT\",\n  480: \"IFERROR\",\n  481: \"COUNTIFS\",\n  482: \"SUMIFS\",\n  483: \"AVERAGEIF\",\n  484: \"AVERAGEIFS\"\n};\nvar FtabArgc = {\n  2: 1,\n  3: 1,\n  10: 0,\n  15: 1,\n  16: 1,\n  17: 1,\n  18: 1,\n  19: 0,\n  20: 1,\n  21: 1,\n  22: 1,\n  23: 1,\n  24: 1,\n  25: 1,\n  26: 1,\n  27: 2,\n  30: 2,\n  31: 3,\n  32: 1,\n  33: 1,\n  34: 0,\n  35: 0,\n  38: 1,\n  39: 2,\n  40: 3,\n  41: 3,\n  42: 3,\n  43: 3,\n  44: 3,\n  45: 3,\n  47: 3,\n  48: 2,\n  53: 1,\n  61: 3,\n  63: 0,\n  65: 3,\n  66: 3,\n  67: 1,\n  68: 1,\n  69: 1,\n  70: 1,\n  71: 1,\n  72: 1,\n  73: 1,\n  74: 0,\n  75: 1,\n  76: 1,\n  77: 1,\n  79: 2,\n  80: 2,\n  83: 1,\n  85: 0,\n  86: 1,\n  89: 0,\n  90: 1,\n  94: 0,\n  95: 0,\n  97: 2,\n  98: 1,\n  99: 1,\n  101: 3,\n  102: 3,\n  105: 1,\n  106: 1,\n  108: 2,\n  111: 1,\n  112: 1,\n  113: 1,\n  114: 1,\n  117: 2,\n  118: 1,\n  119: 4,\n  121: 1,\n  126: 1,\n  127: 1,\n  128: 1,\n  129: 1,\n  130: 1,\n  131: 1,\n  133: 1,\n  134: 1,\n  135: 1,\n  136: 2,\n  137: 2,\n  138: 2,\n  140: 1,\n  141: 1,\n  142: 3,\n  143: 4,\n  144: 4,\n  161: 1,\n  162: 1,\n  163: 1,\n  164: 1,\n  165: 2,\n  172: 1,\n  175: 2,\n  176: 2,\n  177: 3,\n  178: 2,\n  179: 1,\n  184: 1,\n  186: 1,\n  189: 3,\n  190: 1,\n  195: 3,\n  196: 3,\n  197: 1,\n  198: 1,\n  199: 3,\n  201: 1,\n  207: 4,\n  210: 3,\n  211: 1,\n  212: 2,\n  213: 2,\n  214: 1,\n  215: 1,\n  225: 0,\n  229: 1,\n  230: 1,\n  231: 1,\n  232: 1,\n  233: 1,\n  234: 1,\n  235: 3,\n  244: 1,\n  247: 4,\n  252: 2,\n  257: 1,\n  261: 1,\n  271: 1,\n  273: 4,\n  274: 2,\n  275: 2,\n  276: 2,\n  277: 3,\n  278: 3,\n  279: 1,\n  280: 3,\n  281: 3,\n  282: 3,\n  283: 1,\n  284: 1,\n  285: 2,\n  286: 4,\n  287: 3,\n  288: 2,\n  289: 4,\n  290: 3,\n  291: 3,\n  292: 3,\n  293: 4,\n  294: 1,\n  295: 3,\n  296: 1,\n  297: 3,\n  298: 1,\n  299: 2,\n  300: 3,\n  301: 3,\n  302: 4,\n  303: 2,\n  304: 2,\n  305: 2,\n  306: 2,\n  307: 2,\n  308: 2,\n  309: 3,\n  310: 2,\n  311: 2,\n  312: 2,\n  313: 2,\n  314: 2,\n  315: 2,\n  316: 4,\n  325: 2,\n  326: 2,\n  327: 2,\n  328: 2,\n  331: 2,\n  332: 2,\n  337: 2,\n  342: 1,\n  343: 1,\n  346: 2,\n  347: 1,\n  350: 4,\n  351: 3,\n  352: 1,\n  353: 2,\n  360: 1,\n  368: 1,\n  369: 1,\n  370: 1,\n  371: 1,\n  372: 1,\n  373: 1,\n  374: 1,\n  375: 1,\n  376: 1,\n  377: 1,\n  378: 1,\n  382: 3,\n  385: 1,\n  392: 1,\n  393: 1,\n  396: 2,\n  397: 2,\n  398: 2,\n  399: 1,\n  400: 1,\n  401: 1,\n  402: 1,\n  403: 1,\n  404: 1,\n  405: 1,\n  406: 1,\n  407: 1,\n  408: 1,\n  409: 1,\n  410: 1,\n  414: 4,\n  415: 1,\n  416: 1,\n  417: 2,\n  420: 1,\n  421: 1,\n  422: 2,\n  424: 1,\n  425: 2,\n  426: 2,\n  427: 2,\n  428: 2,\n  430: 3,\n  438: 3,\n  439: 3,\n  440: 3,\n  443: 2,\n  444: 2,\n  445: 2,\n  446: 2,\n  447: 6,\n  448: 6,\n  449: 2,\n  450: 2,\n  464: 2,\n  468: 3,\n  476: 2,\n  479: 1,\n  480: 2,\n  65535: 0\n};\n/* Part 3 TODO: actually parse formulae */\nfunction ods_to_csf_formula(f/*:string*/)/*:string*/ {\n\tif(f.slice(0,3) == \"of:\") f = f.slice(3);\n\t/* 5.2 Basic Expressions */\n\tif(f.charCodeAt(0) == 61) {\n\t\tf = f.slice(1);\n\t\tif(f.charCodeAt(0) == 61) f = f.slice(1);\n\t}\n\tf = f.replace(/COM\\.MICROSOFT\\./g, \"\");\n\t/* Part 3 Section 5.8 References */\n\tf = f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, function($$, $1) { return $1.replace(/\\./g,\"\"); });\n\tf = f.replace(/\\$'([^']|'')+'/g, function($$) { return $$.slice(1); });\n\tf = f.replace(/\\$([^\\]\\. #$]+)/g, function($$, $1) { return ($1).match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})?$/) ? $$ : $1; });\n\t/* TODO: something other than this */\n\tf = f.replace(/\\[.(#[A-Z]*[?!])\\]/g, \"$1\");\n\treturn f.replace(/[;~]/g,\",\").replace(/\\|/g,\";\");\n}\n\nfunction csf_to_ods_formula(f/*:string*/)/*:string*/ {\n\tvar o = \"of:=\" + f.replace(crefregex, \"$1[.$2$3$4$5]\").replace(/\\]:\\[/g,\":\");\n\t/* TODO: something other than this */\n\treturn o.replace(/;/g, \"|\").replace(/,/g,\";\");\n}\n\nfunction ods_to_csf_3D(r/*:string*/)/*:[string, string]*/ {\n\tr = r.replace(/\\$'([^']|'')+'/g, function($$) { return $$.slice(1); });\n\tr = r.replace(/\\$([^\\]\\. #$]+)/g, function($$, $1) { return ($1).match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})?$/) ? $$ : $1; });\n\tvar a = r.split(\":\");\n\tvar s = a[0].split(\".\")[0];\n\treturn [s, a[0].split(\".\")[1] + (a.length > 1 ? (\":\" + (a[1].split(\".\")[1] || a[1].split(\".\")[0])) : \"\")];\n}\n\nfunction csf_to_ods_3D(r/*:string*/)/*:string*/ {\n\treturn r.replace(/!/,\".\").replace(/:/, \":.\");\n}\n\nvar strs = {}; // shared strings\nvar _ssfopts = {}; // spreadsheet formatting options\n\n\n/*global Map */\nvar browser_has_Map = typeof Map !== 'undefined';\n\nfunction get_sst_id(sst/*:SST*/, str/*:string*/, rev)/*:number*/ {\n\tvar i = 0, len = sst.length;\n\tif(rev) {\n\t\tif(browser_has_Map ? rev.has(str) : Object.prototype.hasOwnProperty.call(rev, str)) {\n\t\t\tvar revarr = browser_has_Map ? rev.get(str) : rev[str];\n\t\t\tfor(; i < revarr.length; ++i) {\n\t\t\t\tif(sst[revarr[i]].t === str) { sst.Count ++; return revarr[i]; }\n\t\t\t}\n\t\t}\n\t} else for(; i < len; ++i) {\n\t\tif(sst[i].t === str) { sst.Count ++; return i; }\n\t}\n\tsst[len] = ({t:str}/*:any*/); sst.Count ++; sst.Unique ++;\n\tif(rev) {\n\t\tif(browser_has_Map) {\n\t\t\tif(!rev.has(str)) rev.set(str, []);\n\t\t\trev.get(str).push(len);\n\t\t} else {\n\t\t\tif(!Object.prototype.hasOwnProperty.call(rev, str)) rev[str] = [];\n\t\t\trev[str].push(len);\n\t\t}\n\t}\n\treturn len;\n}\n\nfunction col_obj_w(C/*:number*/, col) {\n\tvar p = ({min:C+1,max:C+1}/*:any*/);\n\t/* wch (chars), wpx (pixels) */\n\tvar wch = -1;\n\tif(col.MDW) MDW = col.MDW;\n\tif(col.width != null) p.customWidth = 1;\n\telse if(col.wpx != null) wch = px2char(col.wpx);\n\telse if(col.wch != null) wch = col.wch;\n\tif(wch > -1) { p.width = char2width(wch); p.customWidth = 1; }\n\telse if(col.width != null) p.width = col.width;\n\tif(col.hidden) p.hidden = true;\n\tif(col.level != null) { p.outlineLevel = p.level = col.level; }\n\treturn p;\n}\n\nfunction default_margins(margins/*:Margins*/, mode/*:?string*/) {\n\tif(!margins) return;\n\tvar defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];\n\tif(mode == 'xlml') defs = [1, 1, 1, 1, 0.5, 0.5];\n\tif(margins.left   == null) margins.left   = defs[0];\n\tif(margins.right  == null) margins.right  = defs[1];\n\tif(margins.top    == null) margins.top    = defs[2];\n\tif(margins.bottom == null) margins.bottom = defs[3];\n\tif(margins.header == null) margins.header = defs[4];\n\tif(margins.footer == null) margins.footer = defs[5];\n}\n\nfunction get_cell_style(styles/*:Array<any>*/, cell/*:Cell*/, opts) {\n\tvar z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n\tvar i = 0x3c, len = styles.length;\n\tif(z == null && opts.ssf) {\n\t\tfor(; i < 0x188; ++i) if(opts.ssf[i] == null) {\n\t\t\tSSF__load(cell.z, i);\n\t\t\t// $FlowIgnore\n\t\t\topts.ssf[i] = cell.z;\n\t\t\topts.revssf[cell.z] = z = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(i = 0; i != len; ++i) if(styles[i].numFmtId === z) return i;\n\tstyles[len] = {\n\t\tnumFmtId:z,\n\t\tfontId:0,\n\t\tfillId:0,\n\t\tborderId:0,\n\t\txfId:0,\n\t\tapplyNumberFormat:1\n\t};\n\treturn len;\n}\n\nfunction safe_format(p/*:Cell*/, fmtid/*:number*/, fillid/*:?number*/, opts, themes, styles, date1904) {\n\ttry {\n\t\tif(opts.cellNF) p.z = table_fmt[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(p.t === 'z' && !opts.cellStyles) return;\n\tif(p.t === 'd' && typeof p.v === 'string') p.v = parseDate(p.v);\n\tif((!opts || opts.cellText !== false) && p.t !== 'z') try {\n\t\tif(table_fmt[fmtid] == null) SSF__load(SSFImplicit[fmtid] || \"General\", fmtid);\n\t\tif(p.t === 'e') p.w = p.w || BErr[p.v];\n\t\telse if(fmtid === 0) {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = p.v.toString(10);\n\t\t\t\telse p.w = SSF_general_num(p.v);\n\t\t\t}\n\t\t\telse if(p.t === 'd') {\n\t\t\t\tvar dd = datenum(p.v, !!date1904);\n\t\t\t\tif((dd|0) === dd) p.w = dd.toString(10);\n\t\t\t\telse p.w = SSF_general_num(dd);\n\t\t\t}\n\t\t\telse if(p.v === undefined) return \"\";\n\t\t\telse p.w = SSF_general(p.v,_ssfopts);\n\t\t}\n\t\telse if(p.t === 'd') p.w = SSF_format(fmtid,datenum(p.v, !!date1904),_ssfopts);\n\t\telse p.w = SSF_format(fmtid,p.v,_ssfopts);\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(!opts.cellStyles) return;\n\tif(fillid != null) try {\n\t\tp.s = styles.Fills[fillid];\n\t\tif (p.s.fgColor && p.s.fgColor.theme && !p.s.fgColor.rgb) {\n\t\t\tp.s.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.fgColor.theme].rgb, p.s.fgColor.tint || 0);\n\t\t\tif(opts.WTF) p.s.fgColor.raw_rgb = themes.themeElements.clrScheme[p.s.fgColor.theme].rgb;\n\t\t}\n\t\tif (p.s.bgColor && p.s.bgColor.theme) {\n\t\t\tp.s.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.bgColor.theme].rgb, p.s.bgColor.tint || 0);\n\t\t\tif(opts.WTF) p.s.bgColor.raw_rgb = themes.themeElements.clrScheme[p.s.bgColor.theme].rgb;\n\t\t}\n\t} catch(e) { if(opts.WTF && styles.Fills) throw e; }\n}\n\nfunction check_ws(ws/*:Worksheet*/, sname/*:string*/, i/*:number*/) {\n\tif(ws && ws['!ref']) {\n\t\tvar range = safe_decode_range(ws['!ref']);\n\t\tif(range.e.c < range.s.c || range.e.r < range.s.r) throw new Error(\"Bad range (\" + i + \"): \" + ws['!ref']);\n\t}\n}\nfunction parse_ws_xml_dim(ws/*:Worksheet*/, s/*:string*/) {\n\tvar d = safe_decode_range(s);\n\tif(d.s.r<=d.e.r && d.s.c<=d.e.c && d.s.r>=0 && d.s.c>=0) ws[\"!ref\"] = encode_range(d);\n}\nvar mergecregex = /<(?:\\w+:)?mergeCell ref=[\"'][A-Z0-9:]+['\"]\\s*[\\/]?>/g;\nvar hlinkregex = /<(?:\\w+:)?hyperlink [^<>]*>/mg;\nvar dimregex = /\"(\\w*:\\w*)\"/;\nvar colregex = /<(?:\\w+:)?col\\b[^<>]*[\\/]?>/g;\nvar afregex = /<(?:\\w+:)?autoFilter[^>]*/g;\nvar marginregex= /<(?:\\w+:)?pageMargins[^<>]*\\/>/g;\nvar sheetprregex = /<(?:\\w+:)?sheetPr\\b[^<>]*?\\/>/;\n\n/* 18.3 Worksheets */\nfunction parse_ws_xml(data/*:?string*/, opts, idx/*:number*/, rels, wb/*:WBWBProps*/, themes, styles)/*:Worksheet*/ {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\n\t/* 18.3.1.99 worksheet CT_Worksheet */\n\tvar s = ({}/*:any*/); if(opts.dense) s[\"!data\"] = [];\n\tvar refguess/*:Range*/ = ({s: {r:2000000, c:2000000}, e: {r:0, c:0} }/*:any*/);\n\n\tvar data1 = \"\", data2 = \"\";\n\tvar mtch/*:?any*/ = str_match_xml_ns(data, \"sheetData\");\n\tif(mtch) {\n\t\tdata1 = data.slice(0, mtch.index);\n\t\tdata2 = data.slice(mtch.index + mtch[0].length);\n\t} else data1 = data2 = data;\n\n\t/* 18.3.1.82 sheetPr CT_SheetPr */\n\tvar sheetPr = data1.match(sheetprregex);\n\tif(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\telse if((sheetPr = str_match_xml_ns(data1, \"sheetPr\"))) parse_ws_xml_sheetpr2(sheetPr[0], sheetPr[1]||\"\", s, wb, idx, styles, themes);\n\n\t/* 18.3.1.35 dimension CT_SheetDimension */\n\tvar ridx = (data1.match(/<(?:\\w*:)?dimension/)||{index:-1}).index;\n\tif(ridx > 0) {\n\t\tvar ref = data1.slice(ridx,ridx+50).match(dimregex);\n\t\tif(ref && !(opts && opts.nodim)) parse_ws_xml_dim(s, ref[1]);\n\t}\n\n\t/* 18.3.1.88 sheetViews CT_SheetViews */\n\tvar svs = str_match_xml_ns(data1, \"sheetViews\");\n\tif(svs && svs[1]) parse_ws_xml_sheetviews(svs[1], wb);\n\n\t/* 18.3.1.17 cols CT_Cols */\n\tvar columns/*:Array<ColInfo>*/ = [];\n\tif(opts.cellStyles) {\n\t\t/* 18.3.1.13 col CT_Col */\n\t\tvar cols = data1.match(colregex);\n\t\tif(cols) parse_ws_xml_cols(columns, cols);\n\t}\n\n\t/* 18.3.1.80 sheetData CT_SheetData ? */\n\tif(mtch) parse_ws_xml_data(mtch[1], s, opts, refguess, themes, styles, wb);\n\n\t/* 18.3.1.2  autoFilter CT_AutoFilter */\n\tvar afilter = data2.match(afregex);\n\tif(afilter) s['!autofilter'] = parse_ws_xml_autofilter(afilter[0]);\n\n\t/* 18.3.1.55 mergeCells CT_MergeCells */\n\tvar merges/*:Array<Range>*/ = [];\n\tvar _merge = data2.match(mergecregex);\n\tif(_merge) for(ridx = 0; ridx != _merge.length; ++ridx)\n\t\tmerges[ridx] = safe_decode_range(_merge[ridx].slice(_merge[ridx].indexOf(\"=\")+2));\n\n\t/* 18.3.1.48 hyperlinks CT_Hyperlinks */\n\tvar hlink = data2.match(hlinkregex);\n\tif(hlink) parse_ws_xml_hlinks(s, hlink, rels);\n\n\t/* 18.3.1.62 pageMargins CT_PageMargins */\n\tvar margins = data2.match(marginregex);\n\tif(margins) s['!margins'] = parse_ws_xml_margins(parsexmltag(margins[0]));\n\n\t/* legacyDrawing */\n\tvar m;\n\tif((m = data2.match(/legacyDrawing r:id=\"(.*?)\"/))) s['!legrel'] = m[1];\n\n\tif(opts && opts.nodim) refguess.s.c = refguess.s.r = 0;\n\tif(!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n\tif(opts.sheetRows > 0 && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows <= +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(columns.length > 0) s[\"!cols\"] = columns;\n\tif(merges.length > 0) s[\"!merges\"] = merges;\n\tif(rels['!id'][s['!legrel']]) s['!legdrawel'] = rels['!id'][s['!legrel']];\n\treturn s;\n}\n\nfunction write_ws_xml_merges(merges/*:Array<Range>*/)/*:string*/ {\n\tif(merges.length === 0) return \"\";\n\tvar o = '<mergeCells count=\"' + merges.length + '\">';\n\tfor(var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n\treturn o + '</mergeCells>';\n}\n\n/* 18.3.1.82-3 sheetPr CT_ChartsheetPr / CT_SheetPr */\nfunction parse_ws_xml_sheetpr(sheetPr/*:string*/, s, wb/*:WBWBProps*/, idx/*:number*/) {\n\tvar data = parsexmltag(sheetPr);\n\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\tif(data.codeName) wb.Sheets[idx].CodeName = unescapexml(utf8read(data.codeName));\n}\nfunction parse_ws_xml_sheetpr2(sheetPr/*:string*/, body/*:string*/, s, wb/*:WBWBProps*/, idx/*:number*/) {\n\tparse_ws_xml_sheetpr(sheetPr.slice(0, sheetPr.indexOf(\">\")), s, wb, idx);\n}\nfunction write_ws_xml_sheetpr(ws, wb, idx, opts, o) {\n\tvar needed = false;\n\tvar props = {}, payload = null;\n\tif(opts.bookType !== 'xlsx' && wb.vbaraw) {\n\t\tvar cname = wb.SheetNames[idx];\n\t\ttry { if(wb.Workbook) cname = wb.Workbook.Sheets[idx].CodeName || cname; } catch(e) {}\n\t\tneeded = true;\n\t\tprops.codeName = utf8write(escapexml(cname));\n\t}\n\n\tif(ws && ws[\"!outline\"]) {\n\t\tvar outlineprops = {summaryBelow:1, summaryRight:1};\n\t\tif(ws[\"!outline\"].above) outlineprops.summaryBelow = 0;\n\t\tif(ws[\"!outline\"].left) outlineprops.summaryRight = 0;\n\t\tpayload = (payload||\"\") + writextag('outlinePr', null, outlineprops);\n\t}\n\n\tif(!needed && !payload) return;\n\to[o.length] = (writextag('sheetPr', payload, props));\n}\n\n/* 18.3.1.85 sheetProtection CT_SheetProtection */\nvar sheetprot_deffalse = [\"objects\", \"scenarios\", \"selectLockedCells\", \"selectUnlockedCells\"];\nvar sheetprot_deftrue = [\n\t\"formatColumns\", \"formatRows\", \"formatCells\",\n\t\"insertColumns\", \"insertRows\", \"insertHyperlinks\",\n\t\"deleteColumns\", \"deleteRows\",\n\t\"sort\", \"autoFilter\", \"pivotTables\"\n];\nfunction write_ws_xml_protection(sp)/*:string*/ {\n\t// algorithmName, hashValue, saltValue, spinCount\n\tvar o = ({sheet:1}/*:any*/);\n\tsheetprot_deffalse.forEach(function(n) { if(sp[n] != null && sp[n]) o[n] = \"1\"; });\n\tsheetprot_deftrue.forEach(function(n) { if(sp[n] != null && !sp[n]) o[n] = \"0\"; });\n\t/* TODO: algorithm */\n\tif(sp.password) o.password = crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase();\n\treturn writextag('sheetProtection', null, o);\n}\n\nfunction parse_ws_xml_hlinks(s, data/*:Array<string>*/, rels) {\n\tvar dense = s[\"!data\"] != null;\n\tfor(var i = 0; i != data.length; ++i) {\n\t\tvar val = parsexmltag(utf8read(data[i]), true);\n\t\tif(!val.ref) return;\n\t\tvar rel = ((rels || {})['!id']||[])[val.id];\n\t\tif(rel) {\n\t\t\tval.Target = rel.Target;\n\t\t\tif(val.location) val.Target += \"#\"+unescapexml(val.location);\n\t\t} else {\n\t\t\tval.Target = \"#\" + unescapexml(val.location);\n\t\t\trel = {Target: val.Target, TargetMode: 'Internal'};\n\t\t}\n\t\tval.Rel = rel;\n\t\tif(val.tooltip) { val.Tooltip = val.tooltip; delete val.tooltip; }\n\t\tvar rng = safe_decode_range(val.ref);\n\t\tfor(var R=rng.s.r;R<=rng.e.r;++R) for(var C=rng.s.c;C<=rng.e.c;++C) {\n\t\t\tvar addr = encode_col(C) + encode_row(R);\n\t\t\tif(dense) {\n\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\tif(!s[\"!data\"][R][C]) s[\"!data\"][R][C] = {t:\"z\",v:undefined};\n\t\t\t\ts[\"!data\"][R][C].l = val;\n\t\t\t} else {\n\t\t\t\tif(!s[addr]) s[addr] = {t:\"z\",v:undefined};\n\t\t\t\ts[addr].l = val;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction parse_ws_xml_margins(margin) {\n\tvar o = {};\n\t[\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"].forEach(function(k) {\n\t\tif(margin[k]) o[k] = parseFloat(margin[k]);\n\t});\n\treturn o;\n}\nfunction write_ws_xml_margins(margin)/*:string*/ {\n\tdefault_margins(margin);\n\treturn writextag('pageMargins', null, margin);\n}\n\nfunction parse_ws_xml_cols(columns, cols) {\n\tvar seencol = false;\n\tfor(var coli = 0; coli != cols.length; ++coli) {\n\t\tvar coll = parsexmltag(cols[coli], true);\n\t\tif(coll.hidden) coll.hidden = parsexmlbool(coll.hidden);\n\t\tvar colm=parseInt(coll.min, 10)-1, colM=parseInt(coll.max,10)-1;\n\t\tif(coll.outlineLevel) coll.level = (+coll.outlineLevel || 0);\n\t\tdelete coll.min; delete coll.max; coll.width = +coll.width;\n\t\tif(!seencol && coll.width) { seencol = true; find_mdw_colw(coll.width); }\n\t\tprocess_col(coll);\n\t\twhile(colm <= colM) columns[colm++] = dup(coll);\n\t}\n}\nfunction write_ws_xml_cols(ws, cols)/*:string*/ {\n\tvar o = [\"<cols>\"], col;\n\tfor(var i = 0; i != cols.length; ++i) {\n\t\tif(!(col = cols[i])) continue;\n\t\to[o.length] = (writextag('col', null, col_obj_w(i, col)));\n\t}\n\to[o.length] = \"</cols>\";\n\treturn o.join(\"\");\n}\n\nfunction parse_ws_xml_autofilter(data/*:string*/) {\n\tvar o = { ref: (data.match(/ref=\"([^\"]*)\"/)||[])[1]};\n\treturn o;\n}\nfunction write_ws_xml_autofilter(data, ws, wb, idx)/*:string*/ {\n\tvar ref = typeof data.ref == \"string\" ? data.ref : encode_range(data.ref);\n\tif(!wb.Workbook) wb.Workbook = ({Sheets:[]}/*:any*/);\n\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\tvar names/*: Array<any> */ = wb.Workbook.Names;\n\tvar range = decode_range(ref);\n\tif(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar name = names[i];\n\t\tif(name.Name != '_xlnm._FilterDatabase') continue;\n\t\tif(name.Sheet != idx) continue;\n\t\tname.Ref = formula_quote_sheet_name(wb.SheetNames[idx]) + \"!\" + fix_range(ref); break;\n\t}\n\tif(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref  });\n\treturn writextag(\"autoFilter\", null, {ref:ref});\n}\n\n/* 18.3.1.88 sheetViews CT_SheetViews */\n/* 18.3.1.87 sheetView CT_SheetView */\nvar sviewregex = /<(?:\\w:)?sheetView(?:[^<>a-z][^<>]*)?\\/?>/g;\nfunction parse_ws_xml_sheetviews(data, wb/*:WBWBProps*/) {\n\tif(!wb.Views) wb.Views = [{}];\n\t(data.match(sviewregex)||[]).forEach(function(r/*:string*/, i/*:number*/) {\n\t\tvar tag = parsexmltag(r);\n\t\t// $FlowIgnore\n\t\tif(!wb.Views[i]) wb.Views[i] = {};\n\t\t// $FlowIgnore\n\t\tif(+tag.zoomScale) wb.Views[i].zoom = +tag.zoomScale;\n\t\t// $FlowIgnore\n\t\tif(tag.rightToLeft && parsexmlbool(tag.rightToLeft)) wb.Views[i].RTL = true;\n\t});\n}\nfunction write_ws_xml_sheetviews(ws, opts, idx, wb)/*:string*/ {\n\tvar sview = ({workbookViewId:\"0\"}/*:any*/);\n\t// $FlowIgnore\n\tif((((wb||{}).Workbook||{}).Views||[])[0]) sview.rightToLeft = wb.Workbook.Views[0].RTL ? \"1\" : \"0\";\n\treturn writextag(\"sheetViews\", writextag(\"sheetView\", null, sview), {});\n}\n\nfunction write_ws_xml_cell(cell/*:Cell*/, ref, ws, opts, idx, wb, date1904)/*:string*/ {\n\tif(cell.c) ws['!comments'].push([ref, cell.c]);\n\tif((cell.v === undefined || cell.t === \"z\" && !(opts||{}).sheetStubs) && typeof cell.f !== \"string\" && typeof cell.z == \"undefined\") return \"\";\n\tvar vv = \"\";\n\tvar oldt = cell.t, oldv = cell.v;\n\tif(cell.t !== \"z\") switch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'n':\n\t\t\tif(isNaN(cell.v)) { cell.t = \"e\"; vv = BErr[cell.v = 0x24]; } // #NUM!\n\t\t\telse if(!isFinite(cell.v)) { cell.t = \"e\"; vv = BErr[cell.v = 0x07]; } // #DIV/0!\n\t\t\telse vv = ''+cell.v; break;\n\t\tcase 'e': vv = BErr[cell.v]; break;\n\t\tcase 'd':\n\t\t\tif(opts && opts.cellDates) {\n\t\t\t\tvar _vv = parseDate(cell.v, date1904);\n\t\t\t\tvv = _vv.toISOString();\n\t\t\t\tif(_vv.getUTCFullYear() < 1900) vv = vv.slice(vv.indexOf(\"T\") + 1).replace(\"Z\",\"\");\n\t\t\t} else {\n\t\t\t\tcell = dup(cell);\n\t\t\t\tcell.t = 'n';\n\t\t\t\tvv = ''+(cell.v = datenum(parseDate(cell.v, date1904), date1904));\n\t\t\t}\n\t\t\tif(typeof cell.z === 'undefined') cell.z = table_fmt[14];\n\t\t\tbreak;\n\t\tdefault: vv = cell.v; break;\n\t}\n\tvar v = (cell.t == \"z\" || cell.v == null)? \"\" : writetag('v', escapexml(vv)), o = ({r:ref}/*:any*/);\n\t/* TODO: cell style */\n\tvar os = get_cell_style(opts.cellXfs, cell, opts);\n\tif(os !== 0) o.s = os;\n\tswitch(cell.t) {\n\t\tcase 'n': break;\n\t\tcase 'd': o.t = \"d\"; break;\n\t\tcase 'b': o.t = \"b\"; break;\n\t\tcase 'e': o.t = \"e\"; break;\n\t\tcase 'z': break;\n\t\tdefault: if(cell.v == null) { delete cell.t; break; }\n\t\t\tif(cell.v.length > 32767) throw new Error(\"Text length must not exceed 32767 characters\");\n\t\t\tif(opts && opts.bookSST) {\n\t\t\t\tv = writetag('v', ''+get_sst_id(opts.Strings, cell.v, opts.revStrings));\n\t\t\t\to.t = \"s\"; break;\n\t\t\t}\n\t\t\telse o.t = \"str\"; break;\n\t}\n\tif(cell.t != oldt) { cell.t = oldt; cell.v = oldv; }\n\tif(typeof cell.f == \"string\" && cell.f) {\n\t\tvar ff = cell.F && cell.F.slice(0, ref.length) == ref ? {t:\"array\", ref:cell.F} : null;\n\t\tv = writextag('f', escapexml(cell.f), ff) + (cell.v != null ? v : \"\");\n\t}\n\tif(cell.l) {\n\t\tcell.l.display = escapexml(vv);\n\t\tws['!links'].push([ref, cell.l]);\n\t}\n\tif(cell.D) o.cm = 1;\n\treturn writextag('c', v, o);\n}\n\nvar parse_ws_xml_data = /*#__PURE__*/(function() {\n\tvar cellregex = /<(?:\\w+:)?c[ \\/>]/, rowregex = /<\\/(?:\\w+:)?row>/;\n\tvar rregex = /r=[\"']([^\"']*)[\"']/;\n\tvar refregex = /ref=[\"']([^\"']*)[\"']/;\n\nreturn function parse_ws_xml_data(sdata/*:string*/, s, opts, guess/*:Range*/, themes, styles, wb) {\n\tvar ri = 0, x = \"\", cells/*:Array<string>*/ = [], cref/*:?Array<string>*/ = [], idx=0, i=0, cc=0, d=\"\", p/*:any*/;\n\tvar tag, tagr = 0, tagc = 0;\n\tvar sstr, ftag;\n\tvar fmtid = 0, fillid = 0;\n\tvar do_format = Array.isArray(styles.CellXf), cf;\n\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\tvar sharedf = [];\n\tvar dense = s[\"!data\"] != null;\n\tvar rows/*:Array<RowInfo>*/ = [], rowobj = {}, rowrite = false;\n\tvar sheetStubs = !!opts.sheetStubs;\n\tvar date1904 = !!((wb||{}).WBProps||{}).date1904;\n\tfor(var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n\t\tx = marr[mt].trim();\n\t\tvar xlen = x.length;\n\t\tif(xlen === 0) continue;\n\n\t\t/* 18.3.1.73 row CT_Row */\n\t\tvar rstarti = 0;\n\t\touta: for(ri = 0; ri < xlen; ++ri) switch(/*x.charCodeAt(ri)*/x[ri]) {\n\t\t\tcase \">\" /*62*/:\n\t\t\t\tif(/*x.charCodeAt(ri-1) != 47*/x[ri-1] != \"/\") { ++ri; break outa; }\n\t\t\t\tif(opts && opts.cellStyles) {\n\t\t\t\t\t// TODO: avoid duplication\n\t\t\t\t\ttag = parsexmltag(x.slice(rstarti,ri), true);\n\t\t\t\t\ttagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\n\t\t\t\t\tif(opts.sheetRows && opts.sheetRows < tagr) continue;\n\t\t\t\t\trowobj = {}; rowrite = false;\n\t\t\t\t\tif(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\n\t\t\t\t\tif(tag.hidden && parsexmlbool(tag.hidden)) { rowrite = true; rowobj.hidden = true; }\n\t\t\t\t\tif(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\n\t\t\t\t\tif(rowrite) rows[tagr-1] = rowobj;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"<\" /*60*/: rstarti = ri; break;\n\t\t}\n\t\tif(rstarti >= ri) break;\n\t\ttag = parsexmltag(x.slice(rstarti,ri), true);\n\t\ttagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\n\t\tif(opts.sheetRows && opts.sheetRows < tagr) continue;\n\t\tif(!opts.nodim) {\n\t\t\tif(guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n\t\t\tif(guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n\t\t}\n\n\t\tif(opts && opts.cellStyles) {\n\t\t\trowobj = {}; rowrite = false;\n\t\t\tif(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\n\t\t\tif(tag.hidden && parsexmlbool(tag.hidden)) { rowrite = true; rowobj.hidden = true; }\n\t\t\tif(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\n\t\t\tif(rowrite) rows[tagr-1] = rowobj;\n\t\t}\n\n\t\t/* 18.3.1.4 c CT_Cell */\n\t\tcells = x.slice(ri).split(cellregex);\n\t\tfor(var rslice = 0; rslice != cells.length; ++rslice) if(cells[rslice].trim().charAt(0) != \"<\") break;\n\t\tcells = cells.slice(rslice);\n\t\tfor(ri = 0; ri != cells.length; ++ri) {\n\t\t\tx = cells[ri].trim();\n\t\t\tif(x.length === 0) continue;\n\t\t\tcref = x.match(rregex); idx = ri; i=0; cc=0;\n\t\t\tx = \"<c \" + (x.slice(0,1)==\"<\"?\">\":\"\") + x;\n\t\t\tif(cref != null && cref.length === 2) {\n\t\t\t\tidx = 0; d=cref[1];\n\t\t\t\tfor(i=0; i != d.length; ++i) {\n\t\t\t\t\tif((cc=d.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\t\t\t\tidx = 26*idx + cc;\n\t\t\t\t}\n\t\t\t\t--idx;\n\t\t\t\ttagc = idx;\n\t\t\t} else ++tagc;\n\t\t\tfor(i = 0; i != x.length; ++i) if(x.charCodeAt(i) === 62) break; ++i;\n\t\t\ttag = parsexmltag(x.slice(0,i), true);\n\t\t\tif(!tag.r) tag.r = encode_cell({r:tagr-1, c:tagc});\n\t\t\td = x.slice(i);\n\t\t\tp = ({t:\"\"}/*:any*/);\n\n\t\t\tif((cref=str_match_xml_ns(d, \"v\"))!= null && /*::cref != null && */cref[1] !== '') p.v=unescapexml(cref[1]);\n\t\t\tif(opts.cellFormula) {\n\t\t\t\tif((cref=str_match_xml_ns(d, \"f\"))!= null /*:: && cref != null*/) {\n\t\t\t\t\tif(cref[1] == \"\") {\n\t\t\t\t\t\tif(/*::cref != null && cref[0] != null && */cref[0].indexOf('t=\"shared\"') > -1) {\n\t\t\t\t\t\t\t// TODO: parse formula\n\t\t\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\t\t\tif(sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]/*[0].ref*/, tag.r);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* TODO: match against XLSXFutureFunctions */\n\t\t\t\t\t\tp.f=unescapexml(utf8read(cref[1]), true);\n\t\t\t\t\t\tif(!opts.xlfn) p.f = _xlfn(p.f);\n\t\t\t\t\t\tif(/*::cref != null && cref[0] != null && */cref[0].indexOf('t=\"array\"') > -1) {\n\t\t\t\t\t\t\tp.F = (d.match(refregex)||[])[1];\n\t\t\t\t\t\t\tif(p.F.indexOf(\":\") > -1) arrayf.push([safe_decode_range(p.F), p.F]);\n\t\t\t\t\t\t} else if(/*::cref != null && cref[0] != null && */cref[0].indexOf('t=\"shared\"') > -1) {\n\t\t\t\t\t\t\t// TODO: parse formula\n\t\t\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\t\t\tvar ___f = unescapexml(utf8read(cref[1]));\n\t\t\t\t\t\t\tif(!opts.xlfn) ___f = _xlfn(___f);\n\t\t\t\t\t\t\tsharedf[parseInt(ftag.si, 10)] = [ftag, ___f, tag.r];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if((cref=d.match(/<f[^<>]*\\/>/))) {\n\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\tif(sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]/*[0].ref*/, tag.r);\n\t\t\t\t}\n\t\t\t\t/* TODO: factor out contains logic */\n\t\t\t\tvar _tag = decode_cell(tag.r);\n\t\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\tif(_tag.r >= arrayf[i][0].s.r && _tag.r <= arrayf[i][0].e.r)\n\t\t\t\t\t\tif(_tag.c >= arrayf[i][0].s.c && _tag.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\tp.F = arrayf[i][1];\n\t\t\t}\n\n\t\t\tif(tag.t == null && p.v === undefined) {\n\t\t\t\tif(p.f || p.F) {\n\t\t\t\t\tp.v = 0; p.t = \"n\";\n\t\t\t\t} else if(!sheetStubs) continue;\n\t\t\t\telse p.t = \"z\";\n\t\t\t}\n\t\t\telse p.t = tag.t || \"n\";\n\t\t\tif(guess.s.c > tagc) guess.s.c = tagc;\n\t\t\tif(guess.e.c < tagc) guess.e.c = tagc;\n\t\t\t/* 18.18.11 t ST_CellType */\n\t\t\tswitch(p.t) {\n\t\t\t\tcase 'n':\n\t\t\t\t\tif(p.v == \"\" || p.v == null) {\n\t\t\t\t\t\tif(!sheetStubs) continue;\n\t\t\t\t\t\tp.t = 'z';\n\t\t\t\t\t} else p.v = parseFloat(p.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 's':\n\t\t\t\t\tif(typeof p.v == 'undefined') {\n\t\t\t\t\t\tif(!sheetStubs) continue;\n\t\t\t\t\t\tp.t = 'z';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsstr = strs[parseInt(p.v, 10)];\n\t\t\t\t\t\tp.v = sstr.t;\n\t\t\t\t\t\tp.r = sstr.r;\n\t\t\t\t\t\tif(opts.cellHTML) p.h = sstr.h;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'str':\n\t\t\t\t\tp.t = \"s\";\n\t\t\t\t\tp.v = (p.v!=null) ? unescapexml(utf8read(p.v), true) : '';\n\t\t\t\t\tif(opts.cellHTML) p.h = escapehtml(p.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'inlineStr':\n\t\t\t\t\tcref = str_match_xml_ns(d, \"is\");\n\t\t\t\t\tp.t = 's';\n\t\t\t\t\tif(cref != null && (sstr = parse_si(cref[1]))) {\n\t\t\t\t\t\tp.v = sstr.t;\n\t\t\t\t\t\tif(opts.cellHTML) p.h = sstr.h;\n\t\t\t\t\t} else p.v = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'b': p.v = parsexmlbool(p.v); break;\n\t\t\t\tcase 'd':\n\t\t\t\t\tif(opts.cellDates) p.v = parseDate(p.v, date1904);\n\t\t\t\t\telse { p.v = datenum(parseDate(p.v, date1904), date1904); p.t = 'n'; }\n\t\t\t\t\tbreak;\n\t\t\t\t/* error string in .w, number in .v */\n\t\t\t\tcase 'e':\n\t\t\t\t\tif(!opts || opts.cellText !== false) p.w = p.v;\n\t\t\t\t\tp.v = RBErr[p.v]; break;\n\t\t\t}\n\t\t\t/* formatting */\n\t\t\tfmtid = fillid = 0;\n\t\t\tcf = null;\n\t\t\tif(do_format && tag.s !== undefined) {\n\t\t\t\tcf = styles.CellXf[tag.s];\n\t\t\t\tif(cf != null) {\n\t\t\t\t\tif(cf.numFmtId != null) fmtid = cf.numFmtId;\n\t\t\t\t\tif(opts.cellStyles) {\n\t\t\t\t\t\tif(cf.fillId != null) fillid = cf.fillId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tsafe_format(p, fmtid, fillid, opts, themes, styles, date1904);\n\t\t\tif(opts.cellDates && do_format && p.t == 'n' && fmt_is_date(table_fmt[fmtid])) { p.v = numdate(p.v + (date1904 ? 1462 : 0)); p.t = typeof p.v == \"number\" ? 'n' : 'd'; }\n\t\t\tif(tag.cm && opts.xlmeta) {\n\t\t\t\tvar cm = (opts.xlmeta.Cell||[])[+tag.cm-1];\n\t\t\t\tif(cm && cm.type == 'XLDAPR') p.D = true;\n\t\t\t}\n\t\t\tvar _r;\n\t\t\tif(opts.nodim) {\n\t\t\t\t_r = decode_cell(tag.r);\n\t\t\t\tif(guess.s.r > _r.r) guess.s.r = _r.r;\n\t\t\t\tif(guess.e.r < _r.r) guess.e.r = _r.r;\n\t\t\t}\n\t\t\tif(dense) {\n\t\t\t\t_r = decode_cell(tag.r);\n\t\t\t\tif(!s[\"!data\"][_r.r]) s[\"!data\"][_r.r] = [];\n\t\t\t\ts[\"!data\"][_r.r][_r.c] = p;\n\t\t\t} else s[tag.r] = p;\n\t\t}\n\t}\n\tif(rows.length > 0) s['!rows'] = rows;\n}; })();\n\nfunction write_ws_xml_data(ws/*:Worksheet*/, opts, idx/*:number*/, wb/*:Workbook*//*::, rels*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [], r/*:Array<string>*/ = [], range = safe_decode_range(ws['!ref']), cell=\"\", ref, rr = \"\", cols/*:Array<string>*/ = [], R=0, C=0, rows = ws['!rows'];\n\tvar dense = ws[\"!data\"] != null, data = dense ? ws[\"!data\"] : [];\n\tvar params = ({r:rr}/*:any*/), row/*:RowInfo*/, height = -1;\n\tvar date1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\tfor(C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\tfor(R = range.s.r; R <= range.e.r; ++R) {\n\t\tr = [];\n\t\trr = encode_row(R);\n\t\tvar data_R = dense ? data[R] : [];\n\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tref = cols[C] + rr;\n\t\t\tvar _cell = dense ? data_R[C] : ws[ref];\n\t\t\tif(_cell === undefined) continue;\n\t\t\tif((cell = write_ws_xml_cell(_cell, ref, ws, opts, idx, wb, date1904)) != null) r.push(cell);\n\t\t}\n\t\tif(r.length > 0 || (rows && rows[R])) {\n\t\t\tparams = ({r:rr}/*:any*/);\n\t\t\tif(rows && rows[R]) {\n\t\t\t\trow = rows[R];\n\t\t\t\tif(row.hidden) params.hidden = 1;\n\t\t\t\theight = -1;\n\t\t\t\tif(row.hpx) height = px2pt(row.hpx);\n\t\t\t\telse if(row.hpt) height = row.hpt;\n\t\t\t\tif(height > -1) { params.ht = height; params.customHeight = 1; }\n\t\t\t\tif(row.level) { params.outlineLevel = row.level; }\n\t\t\t}\n\t\t\to[o.length] = (writextag('row', r.join(\"\"), params));\n\t\t}\n\t}\n\tif(rows) for(; R < rows.length; ++R) {\n\t\tif(rows && rows[R]) {\n\t\t\tparams = ({r:R+1}/*:any*/);\n\t\t\trow = rows[R];\n\t\t\tif(row.hidden) params.hidden = 1;\n\t\t\theight = -1;\n\t\t\tif (row.hpx) height = px2pt(row.hpx);\n\t\t\telse if (row.hpt) height = row.hpt;\n\t\t\tif (height > -1) { params.ht = height; params.customHeight = 1; }\n\t\t\tif (row.level) { params.outlineLevel = row.level; }\n\t\t\to[o.length] = (writextag('row', \"\", params));\n\t\t}\n\t}\n\treturn o.join(\"\");\n}\n\nfunction write_ws_xml(idx/*:number*/, opts, wb/*:Workbook*/, rels)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('worksheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t})];\n\tvar s = wb.SheetNames[idx], sidx = 0, rdata = \"\";\n\tvar ws = wb.Sheets[s];\n\tif(ws == null) ws = {};\n\tvar ref = ws['!ref'] || 'A1';\n\tvar range = safe_decode_range(ref);\n\tif(range.e.c > 0x3FFF || range.e.r > 0xFFFFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + ref + \" exceeds format limit A1:XFD1048576\");\n\t\trange.e.c = Math.min(range.e.c, 0x3FFF);\n\t\trange.e.r = Math.min(range.e.c, 0xFFFFF);\n\t\tref = encode_range(range);\n\t}\n\tif(!rels) rels = {};\n\tws['!comments'] = [];\n\tvar _drawing = [];\n\n\twrite_ws_xml_sheetpr(ws, wb, idx, opts, o);\n\n\to[o.length] = (writextag('dimension', null, {'ref': ref}));\n\n\to[o.length] = write_ws_xml_sheetviews(ws, opts, idx, wb);\n\n\t/* TODO: store in WB, process styles */\n\tif(opts.sheetFormat) o[o.length] = (writextag('sheetFormatPr', null, {\n\t\tdefaultRowHeight:opts.sheetFormat.defaultRowHeight||'16',\n\t\tbaseColWidth:opts.sheetFormat.baseColWidth||'10',\n\t\toutlineLevelRow:opts.sheetFormat.outlineLevelRow||'7'\n\t}));\n\n\tif(ws['!cols'] != null && ws['!cols'].length > 0) o[o.length] = (write_ws_xml_cols(ws, ws['!cols']));\n\n\to[sidx = o.length] = '<sheetData/>';\n\tws['!links'] = [];\n\tif(ws['!ref'] != null) {\n\t\trdata = write_ws_xml_data(ws, opts, idx, wb, rels);\n\t\tif(rdata.length > 0) o[o.length] = (rdata);\n\t}\n\tif(o.length>sidx+1) { o[o.length] = ('</sheetData>'); o[sidx]=o[sidx].replace(\"/>\",\">\"); }\n\n\t/* sheetCalcPr */\n\n\tif(ws['!protect']) o[o.length] = write_ws_xml_protection(ws['!protect']);\n\n\t/* protectedRanges */\n\t/* scenarios */\n\n\tif(ws['!autofilter'] != null) o[o.length] = write_ws_xml_autofilter(ws['!autofilter'], ws, wb, idx);\n\n\t/* sortState */\n\t/* dataConsolidate */\n\t/* customSheetViews */\n\n\tif(ws['!merges'] != null && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));\n\n\t/* phoneticPr */\n\t/* conditionalFormatting */\n\t/* dataValidations */\n\n\tvar relc = -1, rel, rId = -1;\n\tif(/*::(*/ws['!links']/*::||[])*/.length > 0) {\n\t\to[o.length] = \"<hyperlinks>\";\n\t\t/*::(*/ws['!links']/*::||[])*/.forEach(function(l) {\n\t\t\tif(!l[1].Target) return;\n\t\t\trel = ({\"ref\":l[0]}/*:any*/);\n\t\t\tif(l[1].Target.charAt(0) != \"#\") {\n\t\t\t\trId = add_rels(rels, -1, escapexml(l[1].Target).replace(/#[\\s\\S]*$/, \"\"), RELS.HLINK);\n\t\t\t\trel[\"r:id\"] = \"rId\"+rId;\n\t\t\t}\n\t\t\tif((relc = l[1].Target.indexOf(\"#\")) > -1) rel.location = escapexml(l[1].Target.slice(relc+1));\n\t\t\tif(l[1].Tooltip) rel.tooltip = escapexml(l[1].Tooltip);\n\t\t\trel.display = l[1].display;\n\t\t\to[o.length] = writextag(\"hyperlink\",null,rel);\n\t\t});\n\t\to[o.length] = \"</hyperlinks>\";\n\t}\n\tdelete ws['!links'];\n\n\t/* printOptions */\n\n\tif(ws['!margins'] != null) o[o.length] =  write_ws_xml_margins(ws['!margins']);\n\n\t/* pageSetup */\n\t/* headerFooter */\n\t/* rowBreaks */\n\t/* colBreaks */\n\t/* customProperties */\n\t/* cellWatches */\n\n\tif(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) o[o.length] = writetag(\"ignoredErrors\", writextag(\"ignoredError\", null, {numberStoredAsText:1, sqref:ref}));\n\n\t/* smartTags */\n\n\tif(_drawing.length > 0) {\n\t\trId = add_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\n\t\to[o.length] = writextag(\"drawing\", null, {\"r:id\":\"rId\" + rId});\n\t\tws['!drawing'] = _drawing;\n\t}\n\n\tif(ws['!comments'].length > 0) {\n\t\trId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\n\t\to[o.length] = writextag(\"legacyDrawing\", null, {\"r:id\":\"rId\" + rId});\n\t\tws['!legacy'] = rId;\n\t}\n\n\t/* legacyDrawingHF */\n\t/* picture */\n\t/* oleObjects */\n\t/* controls */\n\t/* webPublishItems */\n\t/* tableParts */\n\t/* extLst */\n\n\tif(o.length>1) { o[o.length] = ('</worksheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSB] 2.4.726 BrtRowHdr */\nfunction parse_BrtRowHdr(data, length) {\n\tvar z = ({}/*:any*/);\n\tvar tgt = data.l + length;\n\tz.r = data.read_shift(4);\n\tdata.l += 4; // TODO: ixfe\n\tvar miyRw = data.read_shift(2);\n\tdata.l += 1; // TODO: top/bot padding\n\tvar flags = data.read_shift(1);\n\tdata.l = tgt;\n\tif(flags & 0x07) z.level = flags & 0x07;\n\tif(flags & 0x10) z.hidden = true;\n\tif(flags & 0x20) z.hpt = miyRw / 20;\n\treturn z;\n}\nfunction write_BrtRowHdr(R/*:number*/, range, ws) {\n\tvar o = new_buf(17+8*16);\n\tvar row = (ws['!rows']||[])[R]||{};\n\to.write_shift(4, R);\n\n\to.write_shift(4, 0); /* TODO: ixfe */\n\n\tvar miyRw = 0x0140;\n\tif(row.hpx) miyRw = px2pt(row.hpx) * 20;\n\telse if(row.hpt) miyRw = row.hpt * 20;\n\to.write_shift(2, miyRw);\n\n\to.write_shift(1, 0); /* top/bot padding */\n\n\tvar flags = 0x0;\n\tif(row.level) flags |= row.level;\n\tif(row.hidden) flags |= 0x10;\n\tif(row.hpx || row.hpt) flags |= 0x20;\n\to.write_shift(1, flags);\n\n\to.write_shift(1, 0); /* phonetic guide */\n\n\t/* [MS-XLSB] 2.5.8 BrtColSpan explains the mechanism */\n\tvar ncolspan = 0, lcs = o.l;\n\to.l += 4;\n\n\tvar caddr = {r:R, c:0};\n\tvar dense = ws[\"!data\"] != null;\n\tfor(var i = 0; i < 16; ++i) {\n\t\tif((range.s.c > ((i+1) << 10)) || (range.e.c < (i << 10))) continue;\n\t\tvar first = -1, last = -1;\n\t\tfor(var j = (i<<10); j < ((i+1)<<10); ++j) {\n\t\t\tcaddr.c = j;\n\t\t\tvar cell = dense ? (ws[\"!data\"][caddr.r]||[])[caddr.c] : ws[encode_cell(caddr)];\n\t\t\tif(cell) { if(first < 0) first = j; last = j; }\n\t\t}\n\t\tif(first < 0) continue;\n\t\t++ncolspan;\n\t\to.write_shift(4, first);\n\t\to.write_shift(4, last);\n\t}\n\n\tvar l = o.l;\n\to.l = lcs;\n\to.write_shift(4, ncolspan);\n\to.l = l;\n\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\nfunction write_row_header(ba, ws, range, R) {\n\tvar o = write_BrtRowHdr(R, range, ws);\n\tif((o.length > 17) || (ws['!rows']||[])[R]) write_record(ba, 0x0000 /* BrtRowHdr */, o);\n}\n\n/* [MS-XLSB] 2.4.820 BrtWsDim */\nvar parse_BrtWsDim = parse_UncheckedRfX;\nvar write_BrtWsDim = write_UncheckedRfX;\n\n/* [MS-XLSB] 2.4.821 BrtWsFmtInfo */\nfunction parse_BrtWsFmtInfo(/*::data, length*/) {\n}\n//function write_BrtWsFmtInfo(ws, o) { }\n\n/* [MS-XLSB] 2.4.823 BrtWsProp */\nfunction parse_BrtWsProp(data, length) {\n\tvar z = {};\n\tvar f = data[data.l]; ++data.l;\n\tz.above = !(f & 0x40);\n\tz.left  = !(f & 0x80);\n\t/* TODO: pull flags */\n\tdata.l += 18;\n\tz.name = parse_XLSBCodeName(data, length - 19);\n\treturn z;\n}\nfunction write_BrtWsProp(str, outl, o) {\n\tif(o == null) o = new_buf(84+4*str.length);\n\tvar f = 0xC0;\n\tif(outl) {\n\t\tif(outl.above) f &= ~0x40;\n\t\tif(outl.left)  f &= ~0x80;\n\t}\n\to.write_shift(1, f);\n\tfor(var i = 1; i < 3; ++i) o.write_shift(1,0);\n\twrite_BrtColor({auto:1}, o);\n\to.write_shift(-4,-1);\n\to.write_shift(-4,-1);\n\twrite_XLSBCodeName(str, o);\n\treturn o.slice(0, o.l);\n}\n\n/* [MS-XLSB] 2.4.306 BrtCellBlank */\nfunction parse_BrtCellBlank(data) {\n\tvar cell = parse_XLSBCell(data);\n\treturn [cell];\n}\nfunction write_BrtCellBlank(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\treturn write_XLSBCell(ncell, o);\n}\nfunction parse_BrtShortBlank(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\treturn [cell];\n}\nfunction write_BrtShortBlank(cell, ncell, o) {\n\tif(o == null) o = new_buf(4);\n\treturn write_XLSBShortCell(ncell, o);\n}\n\n/* [MS-XLSB] 2.4.307 BrtCellBool */\nfunction parse_BrtCellBool(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\nfunction write_BrtCellBool(cell, ncell, o) {\n\tif(o == null) o = new_buf(9);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(1, cell.v ? 1 : 0);\n\treturn o;\n}\nfunction parse_BrtShortBool(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\nfunction write_BrtShortBool(cell, ncell, o) {\n\tif(o == null) o = new_buf(5);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(1, cell.v ? 1 : 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.308 BrtCellError */\nfunction parse_BrtCellError(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar bError = data.read_shift(1);\n\treturn [cell, bError, 'e'];\n}\nfunction write_BrtCellError(cell, ncell, o) {\n\tif(o == null) o = new_buf(9);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(1, cell.v);\n\treturn o;\n}\nfunction parse_BrtShortError(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar bError = data.read_shift(1);\n\treturn [cell, bError, 'e'];\n}\nfunction write_BrtShortError(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(1, cell.v);\n\to.write_shift(2, 0);\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n\n/* [MS-XLSB] 2.4.311 BrtCellIsst */\nfunction parse_BrtCellIsst(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\nfunction write_BrtCellIsst(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(4, ncell.v);\n\treturn o;\n}\nfunction parse_BrtShortIsst(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\nfunction write_BrtShortIsst(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(4, ncell.v);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.313 BrtCellReal */\nfunction parse_BrtCellReal(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtCellReal(cell, ncell, o) {\n\tif(o == null) o = new_buf(16);\n\twrite_XLSBCell(ncell, o);\n\twrite_Xnum(cell.v, o);\n\treturn o;\n}\nfunction parse_BrtShortReal(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtShortReal(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_Xnum(cell.v, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.314 BrtCellRk */\nfunction parse_BrtCellRk(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtCellRk(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBCell(ncell, o);\n\twrite_RkNumber(cell.v, o);\n\treturn o;\n}\nfunction parse_BrtShortRk(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtShortRk(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_RkNumber(cell.v, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.323 BrtCellRString */\nfunction parse_BrtCellRString(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RichStr(data);\n\treturn [cell, value, 'is'];\n}\n\n/* [MS-XLSB] 2.4.317 BrtCellSt */\nfunction parse_BrtCellSt(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\nfunction write_BrtCellSt(cell, ncell, o) {\n\tvar data = cell.v == null ? \"\" : String(cell.v);\n\tif(o == null) o = new_buf(12 + 4 * cell.v.length);\n\twrite_XLSBCell(ncell, o);\n\twrite_XLWideString(data, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\nfunction parse_BrtShortSt(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\nfunction write_BrtShortSt(cell, ncell, o) {\n\tvar data = cell.v == null ? \"\" : String(cell.v);\n\tif(o == null) o = new_buf(8 + 4 * data.length);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_XLWideString(data, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.653 BrtFmlaBool */\nfunction parse_BrtFmlaBool(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'b'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.654 BrtFmlaError */\nfunction parse_BrtFmlaError(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'e'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.655 BrtFmlaNum */\nfunction parse_BrtFmlaNum(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = parse_Xnum(data);\n\tvar o = [cell, value, 'n'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.656 BrtFmlaString */\nfunction parse_BrtFmlaString(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = parse_XLWideString(data);\n\tvar o = [cell, value, 'str'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.682 BrtMergeCell */\nvar parse_BrtMergeCell = parse_UncheckedRfX;\nvar write_BrtMergeCell = write_UncheckedRfX;\n/* [MS-XLSB] 2.4.107 BrtBeginMergeCells */\nfunction write_BrtBeginMergeCells(cnt, o) {\n\tif(o == null) o = new_buf(4);\n\to.write_shift(4, cnt);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.662 BrtHLink */\nfunction parse_BrtHLink(data, length/*::, opts*/) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar relId = parse_XLNullableWideString(data);\n\tvar loc = parse_XLWideString(data);\n\tvar tooltip = parse_XLWideString(data);\n\tvar display = parse_XLWideString(data);\n\tdata.l = end;\n\tvar o = ({rfx:rfx, relId:relId, loc:loc, display:display}/*:any*/);\n\tif(tooltip) o.Tooltip = tooltip;\n\treturn o;\n}\nfunction write_BrtHLink(l, rId) {\n\tvar o = new_buf(50+4*(l[1].Target.length + (l[1].Tooltip || \"\").length));\n\twrite_UncheckedRfX({s:decode_cell(l[0]), e:decode_cell(l[0])}, o);\n\twrite_RelID(\"rId\" + rId, o);\n\tvar locidx = l[1].Target.indexOf(\"#\");\n\tvar loc = locidx == -1 ? \"\" : l[1].Target.slice(locidx+1);\n\twrite_XLWideString(loc || \"\", o);\n\twrite_XLWideString(l[1].Tooltip || \"\", o);\n\twrite_XLWideString(\"\", o);\n\treturn o.slice(0, o.l);\n}\n\n/* [MS-XLSB] 2.4.692 BrtPane */\nfunction parse_BrtPane(/*data, length, opts*/) {\n}\n\n/* [MS-XLSB] 2.4.6 BrtArrFmla */\nfunction parse_BrtArrFmla(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_RfX(data, 16);\n\tvar fAlwaysCalc = data.read_shift(1);\n\tvar o = [rfx]; o[2] = fAlwaysCalc;\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);\n\t\to[1] = formula;\n\t} else data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.750 BrtShrFmla */\nfunction parse_BrtShrFmla(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar o = [rfx];\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);\n\t\to[1] = formula;\n\t\tdata.l = end;\n\t} else data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.323 BrtColInfo */\n/* TODO: once XLS ColInfo is set, combine the functions */\nfunction write_BrtColInfo(C/*:number*/, col, o) {\n\tif(o == null) o = new_buf(18);\n\tvar p = col_obj_w(C, col);\n\to.write_shift(-4, C);\n\to.write_shift(-4, C);\n\to.write_shift(4, (p.width || 10) * 256);\n\to.write_shift(4, 0/*ixfe*/); // style\n\tvar flags = 0;\n\tif(col.hidden) flags |= 0x01;\n\tif(typeof p.width == 'number') flags |= 0x02;\n\tif(col.level) flags |= (col.level << 8);\n\to.write_shift(2, flags); // bit flag\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.678 BrtMargins */\nvar BrtMarginKeys = [\"left\",\"right\",\"top\",\"bottom\",\"header\",\"footer\"];\nfunction parse_BrtMargins(data/*::, length, opts*/)/*:Margins*/ {\n\tvar margins = ({}/*:any*/);\n\tBrtMarginKeys.forEach(function(k) { margins[k] = parse_Xnum(data, 8); });\n\treturn margins;\n}\nfunction write_BrtMargins(margins/*:Margins*/, o) {\n\tif(o == null) o = new_buf(6*8);\n\tdefault_margins(margins);\n\tBrtMarginKeys.forEach(function(k) { write_Xnum((margins/*:any*/)[k], o); });\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.299 BrtBeginWsView */\nfunction parse_BrtBeginWsView(data/*::, length, opts*/) {\n\tvar f = data.read_shift(2);\n\tdata.l += 28;\n\treturn { RTL: f & 0x20 };\n}\nfunction write_BrtBeginWsView(ws, Workbook, o) {\n\tif(o == null) o = new_buf(30);\n\tvar f = 0x39c;\n\tif((((Workbook||{}).Views||[])[0]||{}).RTL) f |= 0x20;\n\to.write_shift(2, f); // bit flag\n\to.write_shift(4, 0);\n\to.write_shift(4, 0); // view first row\n\to.write_shift(4, 0); // view first col\n\to.write_shift(1, 0); // gridline color ICV\n\to.write_shift(1, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 100); // zoom scale\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(4, 0); // workbook view id\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.309 BrtCellIgnoreEC */\nfunction write_BrtCellIgnoreEC(ref) {\n\tvar o = new_buf(24);\n\to.write_shift(4, 4);\n\to.write_shift(4, 1);\n\twrite_UncheckedRfX(ref, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.748 BrtSheetProtection */\nfunction write_BrtSheetProtection(sp, o) {\n\tif(o == null) o = new_buf(16*4+2);\n\to.write_shift(2, sp.password ? crypto_CreatePasswordVerifier_Method1(sp.password) : 0);\n\to.write_shift(4, 1); // this record should not be written if no protection\n\t[\n\t\t[\"objects\",             false], // fObjects\n\t\t[\"scenarios\",           false], // fScenarios\n\t\t[\"formatCells\",          true], // fFormatCells\n\t\t[\"formatColumns\",        true], // fFormatColumns\n\t\t[\"formatRows\",           true], // fFormatRows\n\t\t[\"insertColumns\",        true], // fInsertColumns\n\t\t[\"insertRows\",           true], // fInsertRows\n\t\t[\"insertHyperlinks\",     true], // fInsertHyperlinks\n\t\t[\"deleteColumns\",        true], // fDeleteColumns\n\t\t[\"deleteRows\",           true], // fDeleteRows\n\t\t[\"selectLockedCells\",   false], // fSelLockedCells\n\t\t[\"sort\",                 true], // fSort\n\t\t[\"autoFilter\",           true], // fAutoFilter\n\t\t[\"pivotTables\",          true], // fPivotTables\n\t\t[\"selectUnlockedCells\", false]  // fSelUnlockedCells\n\t].forEach(function(n) {\n\t\t/*:: if(o == null) throw \"unreachable\"; */\n\t\tif(n[1]) o.write_shift(4, sp[n[0]] != null && !sp[n[0]] ? 1 : 0);\n\t\telse      o.write_shift(4, sp[n[0]] != null && sp[n[0]] ? 0 : 1);\n\t});\n\treturn o;\n}\n\nfunction parse_BrtDVal(/*data, length, opts*/) {\n}\nfunction parse_BrtDVal14(/*data, length, opts*/) {\n}\n/* [MS-XLSB] 2.1.7.61 Worksheet */\nfunction parse_ws_bin(data, _opts, idx, rels, wb/*:WBWBProps*/, themes, styles)/*:Worksheet*/ {\n\tif(!data) return data;\n\tvar opts = _opts || {};\n\tif(!rels) rels = {'!id':{}};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar s/*:Worksheet*/ = ({}); if(opts.dense) s[\"!data\"] = [];\n\n\tvar ref;\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\n\tvar state/*:Array<string>*/ = [];\n\tvar pass = false, end = false;\n\tvar row, p, cf, R, C, addr, sstr, rr, cell/*:Cell*/;\n\tvar merges/*:Array<Range>*/ = [];\n\topts.biff = 12;\n\topts['!row'] = 0;\n\n\tvar ai = 0, af = false;\n\n\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\tvar sharedf = {};\n\tvar supbooks = opts.supbooks || /*::(*/wb/*:: :any)*/.supbooks || ([[]]/*:any*/);\n\tsupbooks.sharedf = sharedf;\n\tsupbooks.arrayf = arrayf;\n\tsupbooks.SheetNames = wb.SheetNames || wb.Sheets.map(function(x) { return x.name; });\n\tif(!opts.supbooks) {\n\t\topts.supbooks = supbooks;\n\t\tif(wb.Names) for(var i = 0; i < wb.Names.length; ++i) supbooks[0][i+1] = wb.Names[i];\n\t}\n\n\tvar colinfo/*:Array<ColInfo>*/ = [], rowinfo/*:Array<RowInfo>*/ = [];\n\tvar seencol = false;\n\n\tXLSBRecordEnum[0x0010] = { n:\"BrtShortReal\", f:parse_BrtShortReal };\n\n\tvar cm, vm;\n\tvar date1904 = 1462 * +!!((wb||{}).WBProps||{}).date1904;\n\n\trecordhopper(data, function ws_parse(val, RR, RT) {\n\t\tif(end) return;\n\t\tswitch(RT) {\n\t\t\tcase 0x0094: /* 'BrtWsDim' */\n\t\t\t\tref = val; break;\n\t\t\tcase 0x0000: /* 'BrtRowHdr' */\n\t\t\t\trow = val;\n\t\t\t\tif(opts.sheetRows && opts.sheetRows <= row.r) end=true;\n\t\t\t\trr = encode_row(R = row.r);\n\t\t\t\topts['!row'] = row.r;\n\t\t\t\tif(val.hidden || val.hpt || val.level != null) {\n\t\t\t\t\tif(val.hpt) val.hpx = pt2px(val.hpt);\n\t\t\t\t\trowinfo[val.r] = val;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0002: /* 'BrtCellRk' */\n\t\t\tcase 0x0003: /* 'BrtCellError' */\n\t\t\tcase 0x0004: /* 'BrtCellBool' */\n\t\t\tcase 0x0005: /* 'BrtCellReal' */\n\t\t\tcase 0x0006: /* 'BrtCellSt' */\n\t\t\tcase 0x0007: /* 'BrtCellIsst' */\n\t\t\tcase 0x0008: /* 'BrtFmlaString' */\n\t\t\tcase 0x0009: /* 'BrtFmlaNum' */\n\t\t\tcase 0x000A: /* 'BrtFmlaBool' */\n\t\t\tcase 0x000B: /* 'BrtFmlaError' */\n\t\t\tcase 0x000D: /* 'BrtShortRk' */\n\t\t\tcase 0x000E: /* 'BrtShortError' */\n\t\t\tcase 0x000F: /* 'BrtShortBool' */\n\t\t\tcase 0x0010: /* 'BrtShortReal' */\n\t\t\tcase 0x0011: /* 'BrtShortSt' */\n\t\t\tcase 0x0012: /* 'BrtShortIsst' */\n\t\t\tcase 0x003E: /* 'BrtCellRString' */\n\t\t\t\tp = ({t:val[2]}/*:any*/);\n\t\t\t\tswitch(val[2]) {\n\t\t\t\t\tcase 'n': p.v = val[1]; break;\n\t\t\t\t\tcase 's': sstr = strs[val[1]]; p.v = sstr.t; p.r = sstr.r; break;\n\t\t\t\t\tcase 'b': p.v = val[1] ? true : false; break;\n\t\t\t\t\tcase 'e': p.v = val[1]; if(opts.cellText !== false) p.w = BErr[p.v]; break;\n\t\t\t\t\tcase 'str': p.t = 's'; p.v = val[1]; break;\n\t\t\t\t\tcase 'is': p.t = 's'; p.v = val[1].t; break;\n\t\t\t\t}\n\t\t\t\tif((cf = styles.CellXf[val[0].iStyleRef])) safe_format(p,cf.numFmtId,null,opts, themes, styles, date1904>0);\n\t\t\t\tC = val[0].c == -1 ? C + 1 : val[0].c;\n\t\t\t\tif(opts.dense) { if(!s[\"!data\"][R]) s[\"!data\"][R] = []; s[\"!data\"][R][C] = p; }\n\t\t\t\telse s[encode_col(C) + rr] = p;\n\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\taf = false;\n\t\t\t\t\tfor(ai = 0; ai < arrayf.length; ++ai) {\n\t\t\t\t\t\tvar aii = arrayf[ai];\n\t\t\t\t\t\tif(row.r >= aii[0].s.r && row.r <= aii[0].e.r)\n\t\t\t\t\t\t\tif(C >= aii[0].s.c && C <= aii[0].e.c) {\n\t\t\t\t\t\t\t\tp.F = encode_range(aii[0]); af = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!af && val.length > 3) p.f = val[3];\n\t\t\t\t}\n\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tif(opts.cellDates && cf && p.t == 'n' && fmt_is_date(table_fmt[cf.numFmtId])) {\n\t\t\t\t\tvar _d = SSF_parse_date_code(p.v + date1904); if(_d) { p.t = 'd'; p.v = new Date(Date.UTC(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u)); }\n\t\t\t\t}\n\t\t\t\tif(cm) {\n\t\t\t\t\tif(cm.type == 'XLDAPR') p.D = true;\n\t\t\t\t\tcm = void 0;\n\t\t\t\t}\n\t\t\t\tif(vm) vm = void 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0001: /* 'BrtCellBlank' */\n\t\t\tcase 0x000C: /* 'BrtShortBlank' */\n\t\t\t\tif(!opts.sheetStubs || pass) break;\n\t\t\t\tp = ({t:'z',v:void 0}/*:any*/);\n\t\t\t\tC = val[0].c == -1 ? C + 1 : val[0].c;\n\t\t\t\tif(opts.dense) { if(!s[\"!data\"][R]) s[\"!data\"][R] = []; s[\"!data\"][R][C] = p; }\n\t\t\t\telse s[encode_col(C) + rr] = p;\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tif(cm) {\n\t\t\t\t\tif(cm.type == 'XLDAPR') p.D = true;\n\t\t\t\t\tcm = void 0;\n\t\t\t\t}\n\t\t\t\tif(vm) vm = void 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x00B0: /* 'BrtMergeCell' */\n\t\t\t\tmerges.push(val); break;\n\n\t\t\tcase 0x0031: { /* 'BrtCellMeta' */\n\t\t\t\tcm = ((opts.xlmeta||{}).Cell||[])[val-1];\n\t\t\t} break;\n\n\t\t\tcase 0x01EE: /* 'BrtHLink' */\n\t\t\t\tvar rel = rels['!id'][val.relId];\n\t\t\t\tif(rel) {\n\t\t\t\t\tval.Target = rel.Target;\n\t\t\t\t\tif(val.loc) val.Target += \"#\"+val.loc;\n\t\t\t\t\tval.Rel = rel;\n\t\t\t\t} else if(val.relId == '') {\n\t\t\t\t\tval.Target = \"#\" + val.loc;\n\t\t\t\t}\n\t\t\t\tfor(R=val.rfx.s.r;R<=val.rfx.e.r;++R) for(C=val.rfx.s.c;C<=val.rfx.e.c;++C) {\n\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\tif(!s[\"!data\"][R]) s[\"!data\"][R] = [];\n\t\t\t\t\t\tif(!s[\"!data\"][R][C]) s[\"!data\"][R][C] = {t:'z',v:undefined};\n\t\t\t\t\t\ts[\"!data\"][R][C].l = val;\n\t\t\t\t\t} else {\n\t\t\t\t\t\taddr = encode_col(C) + encode_row(R);\n\t\t\t\t\t\tif(!s[addr]) s[addr] = {t:'z',v:undefined};\n\t\t\t\t\t\ts[addr].l = val;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01AA: /* 'BrtArrFmla' */\n\t\t\t\tif(!opts.cellFormula) break;\n\t\t\t\tarrayf.push(val);\n\t\t\t\tcell = ((opts.dense ? s[\"!data\"][R][C] : s[encode_col(C) + rr])/*:any*/);\n\t\t\t\tcell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\n\t\t\t\tcell.F = encode_range(val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 0x01AB: /* 'BrtShrFmla' */\n\t\t\t\tif(!opts.cellFormula) break;\n\t\t\t\tsharedf[encode_cell(val[0].s)] = val[1];\n\t\t\t\tcell = (opts.dense ? s[\"!data\"][R][C] : s[encode_col(C) + rr]);\n\t\t\t\tcell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\n\t\t\t\tbreak;\n\n\t\t\t/* identical to 'ColInfo' in XLS */\n\t\t\tcase 0x003C: /* 'BrtColInfo' */\n\t\t\t\tif(!opts.cellStyles) break;\n\t\t\t\twhile(val.e >= val.s) {\n\t\t\t\t\tcolinfo[val.e--] = { width: val.w/256, hidden: !!(val.flags & 0x01), level: val.level };\n\t\t\t\t\tif(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\n\t\t\t\t\tprocess_col(colinfo[val.e+1]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0227: /* 'BrtLegacyDrawing' */\n\t\t\t\tif(val) s[\"!legrel\"] = val;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x00A1: /* 'BrtBeginAFilter' */\n\t\t\t\ts['!autofilter'] = { ref:encode_range(val) };\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01DC: /* 'BrtMargins' */\n\t\t\t\ts['!margins'] = val;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0093: /* 'BrtWsProp' */\n\t\t\t\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\t\t\t\tif(val.name) wb.Sheets[idx].CodeName = val.name;\n\t\t\t\tif(val.above || val.left) s['!outline'] = { above: val.above, left: val.left };\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0089: /* 'BrtBeginWsView' */\n\t\t\t\tif(!wb.Views) wb.Views = [{}];\n\t\t\t\tif(!wb.Views[0]) wb.Views[0] = {};\n\t\t\t\tif(val.RTL) wb.Views[0].RTL = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01E5: /* 'BrtWsFmtInfo' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0040: /* 'BrtDVal' */\n\t\t\tcase 0x041D: /* 'BrtDVal14' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0097: /* 'BrtPane' */\n\t\t\t\tbreak;\n\t\t\tcase 0x0098: /* 'BrtSel' */\n\t\t\tcase 0x00AF: /* 'BrtAFilterDateGroupItem' */\n\t\t\tcase 0x0284: /* 'BrtActiveX' */\n\t\t\tcase 0x0271: /* 'BrtBigName' */\n\t\t\tcase 0x0232: /* 'BrtBkHim' */\n\t\t\tcase 0x018C: /* 'BrtBrk' */\n\t\t\tcase 0x0458: /* 'BrtCFIcon' */\n\t\t\tcase 0x047A: /* 'BrtCFRuleExt' */\n\t\t\tcase 0x01D7: /* 'BrtCFVO' */\n\t\t\tcase 0x041A: /* 'BrtCFVO14' */\n\t\t\tcase 0x0289: /* 'BrtCellIgnoreEC' */\n\t\t\tcase 0x0451: /* 'BrtCellIgnoreEC14' */\n\t\t\tcase 0x024D: /* 'BrtCellSmartTagProperty' */\n\t\t\tcase 0x025F: /* 'BrtCellWatch' */\n\t\t\tcase 0x0234: /* 'BrtColor' */\n\t\t\tcase 0x041F: /* 'BrtColor14' */\n\t\t\tcase 0x00A8: /* 'BrtColorFilter' */\n\t\t\tcase 0x00AE: /* 'BrtCustomFilter' */\n\t\t\tcase 0x049C: /* 'BrtCustomFilter14' */\n\t\t\tcase 0x01F3: /* 'BrtDRef' */\n\t\t\tcase 0x01FB: /* 'BrtDXF' */\n\t\t\tcase 0x0226: /* 'BrtDrawing' */\n\t\t\tcase 0x00AB: /* 'BrtDynamicFilter' */\n\t\t\tcase 0x00A7: /* 'BrtFilter' */\n\t\t\tcase 0x0499: /* 'BrtFilter14' */\n\t\t\tcase 0x00A9: /* 'BrtIconFilter' */\n\t\t\tcase 0x049D: /* 'BrtIconFilter14' */\n\t\t\tcase 0x0228: /* 'BrtLegacyDrawingHF' */\n\t\t\tcase 0x0295: /* 'BrtListPart' */\n\t\t\tcase 0x027F: /* 'BrtOleObject' */\n\t\t\tcase 0x01DE: /* 'BrtPageSetup' */\n\t\t\tcase 0x0219: /* 'BrtPhoneticInfo' */\n\t\t\tcase 0x01DD: /* 'BrtPrintOptions' */\n\t\t\tcase 0x0218: /* 'BrtRangeProtection' */\n\t\t\tcase 0x044F: /* 'BrtRangeProtection14' */\n\t\t\tcase 0x02A8: /* 'BrtRangeProtectionIso' */\n\t\t\tcase 0x0450: /* 'BrtRangeProtectionIso14' */\n\t\t\tcase 0x0400: /* 'BrtRwDescent' */\n\t\t\tcase 0x0297: /* 'BrtSheetCalcProp' */\n\t\t\tcase 0x0217: /* 'BrtSheetProtection' */\n\t\t\tcase 0x02A6: /* 'BrtSheetProtectionIso' */\n\t\t\tcase 0x01F8: /* 'BrtSlc' */\n\t\t\tcase 0x0413: /* 'BrtSparkline' */\n\t\t\tcase 0x01AC: /* 'BrtTable' */\n\t\t\tcase 0x00AA: /* 'BrtTop10Filter' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\tcase 0x0032: /* 'BrtValueMeta' */\n\t\t\tcase 0x0816: /* 'BrtWebExtension' */\n\t\t\tcase 0x0415: /* 'BrtWsFmtInfoEx14' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(RR.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tdelete opts.supbooks;\n\tdelete opts['!row'];\n\n\tif(!s[\"!ref\"] && (refguess.s.r < 2000000 || ref && (ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0))) s[\"!ref\"] = encode_range(ref || refguess);\n\tif(opts.sheetRows && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows <= +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(merges.length > 0) s[\"!merges\"] = merges;\n\tif(colinfo.length > 0) s[\"!cols\"] = colinfo;\n\tif(rowinfo.length > 0) s[\"!rows\"] = rowinfo;\n\tif(rels['!id'][s['!legrel']]) s['!legdrawel'] = rels['!id'][s['!legrel']];\n\treturn s;\n}\n\n/* TODO: something useful -- this is a stub */\nfunction write_ws_bin_cell(ba/*:BufArray*/, cell/*:Cell*/, R/*:number*/, C/*:number*/, opts, ws/*:Worksheet*/, last_seen/*:boolean*/, date1904/*:boolean*/)/*:boolean*/ {\n\tvar o/*:any*/ = ({r:R, c:C}/*:any*/);\n\tif(cell.c) ws['!comments'].push([encode_cell(o), cell.c]);\n\tif(cell.v === undefined) return false;\n\tvar vv = \"\";\n\tswitch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'd': // no BrtCellDate :(\n\t\t\tcell = dup(cell);\n\t\t\tcell.z = cell.z || table_fmt[14];\n\t\t\tcell.v = datenum(parseDate(cell.v, date1904), date1904); cell.t = 'n';\n\t\t\tbreak;\n\t\t/* falls through */\n\t\tcase 'n': case 'e': vv = ''+cell.v; break;\n\t\tdefault: vv = cell.v; break;\n\t}\n\t/* TODO: cell style */\n\to.s = get_cell_style(opts.cellXfs, cell, opts);\n\tif(cell.l) ws['!links'].push([encode_cell(o), cell.l]);\n\tswitch(cell.t) {\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvv = get_sst_id(opts.Strings, (cell.v == null ? \"\" : String(cell.v)/*:any*/), opts.revStrings);\n\t\t\t\to.t = \"s\"; o.v = vv;\n\t\t\t\tif(last_seen) write_record(ba, 0x0012 /* BrtShortIsst */, write_BrtShortIsst(cell, o));\n\t\t\t\telse write_record(ba, 0x0007 /* BrtCellIsst */, write_BrtCellIsst(cell, o));\n\t\t\t} else {\n\t\t\t\to.t = \"str\";\n\t\t\t\tif(last_seen) write_record(ba, 0x0011 /* BrtShortSt */, write_BrtShortSt(cell, o));\n\t\t\t\telse write_record(ba, 0x0006 /* BrtCellSt */, write_BrtCellSt(cell, o));\n\t\t\t}\n\t\t\treturn true;\n\t\tcase 'n':\n\t\t\t/* TODO: determine threshold for Real vs RK */\n\t\t\tif(cell.v == (cell.v | 0) && cell.v > -1000 && cell.v < 1000) {\n\t\t\t\tif(last_seen) write_record(ba, 0x000D /* BrtShortRk */, write_BrtShortRk(cell, o));\n\t\t\t\telse write_record(ba, 0x0002 /* BrtCellRk */, write_BrtCellRk(cell, o));\n\t\t\t} else if(!isFinite(cell.v)) {\n\t\t\t\to.t = \"e\";\n\t\t\t\tif(isNaN(cell.v)) {\n\t\t\t\t\tif(last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError({t:\"e\", v: 0x24}, o)); // #NUM!\n\t\t\t\t\telse write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError({t:\"e\", v: 0x24}, o)); // #NUM!\n\t\t\t\t} else {\n\t\t\t\t\tif(last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError({t:\"e\", v: 0x07}, o)); // #DIV/0!\n\t\t\t\t\telse write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError({t:\"e\", v: 0x07}, o)); // #DIV/0!\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(last_seen) write_record(ba, 0x0010 /* BrtShortReal */, write_BrtShortReal(cell, o));\n\t\t\t\telse write_record(ba, 0x0005 /* BrtCellReal */, write_BrtCellReal(cell, o));\n\t\t\t} return true;\n\t\tcase 'b':\n\t\t\to.t = \"b\";\n\t\t\tif(last_seen) write_record(ba, 0x000F /* BrtShortBool */, write_BrtShortBool(cell, o));\n\t\t\telse write_record(ba, 0x0004 /* BrtCellBool */, write_BrtCellBool(cell, o));\n\t\t\treturn true;\n\t\tcase 'e':\n\t\t\to.t = \"e\";\n\t\t\tif(last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError(cell, o));\n\t\t\telse write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError(cell, o));\n\t\t\treturn true;\n\t}\n\tif(last_seen) write_record(ba, 0x000C /* BrtShortBlank */, write_BrtShortBlank(cell, o));\n\telse write_record(ba, 0x0001 /* BrtCellBlank */, write_BrtCellBlank(cell, o));\n\treturn true;\n}\n\nfunction write_CELLTABLE(ba, ws/*:Worksheet*/, idx/*:number*/, opts, wb/*:Workbook*/) {\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), rr = \"\", cols/*:Array<string>*/ = [];\n\tvar date1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\twrite_record(ba, 0x0091 /* BrtBeginSheetData */);\n\tvar dense = ws[\"!data\"] != null, row = dense ? ws[\"!data\"][range.s.r] : [];\n\tvar cap = range.e.r;\n\tif(ws['!rows']) cap = Math.max(range.e.r, ws['!rows'].length - 1);\n\tfor(var R = range.s.r; R <= cap; ++R) {\n\t\trr = encode_row(R);\n\t\tif(dense) row = ws[\"!data\"][R];\n\t\t/* [ACCELLTABLE] */\n\t\t/* BrtRowHdr */\n\t\twrite_row_header(ba, ws, range, R);\n\t\tif(dense && !row) continue;\n\t\tvar last_seen = false;\n\t\tif(R <= range.e.r) for(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t/* *16384CELL */\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tvar cell = dense ? row[C] : ws[cols[C] + rr];\n\t\t\tif(!cell) { last_seen = false; continue; }\n\t\t\t/* write cell */\n\t\t\tlast_seen = write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen, date1904);\n\t\t}\n\t}\n\twrite_record(ba, 0x0092 /* BrtEndSheetData */);\n}\n\nfunction write_MERGECELLS(ba, ws/*:Worksheet*/) {\n\tif(!ws || !ws['!merges']) return;\n\twrite_record(ba, 0x00B1 /* BrtBeginMergeCells */, write_BrtBeginMergeCells(ws['!merges'].length));\n\tws['!merges'].forEach(function(m) { write_record(ba, 0x00B0 /* BrtMergeCell */, write_BrtMergeCell(m)); });\n\twrite_record(ba, 0x00B2 /* BrtEndMergeCells */);\n}\n\nfunction write_COLINFOS(ba, ws/*:Worksheet*//*::, idx:number, opts, wb:Workbook*/) {\n\tif(!ws || !ws['!cols']) return;\n\twrite_record(ba, 0x0186 /* BrtBeginColInfos */);\n\tws['!cols'].forEach(function(m, i) { if(m) write_record(ba, 0x003C /* 'BrtColInfo' */, write_BrtColInfo(i, m)); });\n\twrite_record(ba, 0x0187 /* BrtEndColInfos */);\n}\n\nfunction write_IGNOREECS(ba, ws/*:Worksheet*/) {\n\tif(!ws || !ws['!ref']) return;\n\twrite_record(ba, 0x0288 /* BrtBeginCellIgnoreECs */);\n\twrite_record(ba, 0x0289 /* BrtCellIgnoreEC */, write_BrtCellIgnoreEC(safe_decode_range(ws['!ref'])));\n\twrite_record(ba, 0x028A /* BrtEndCellIgnoreECs */);\n}\n\nfunction write_HLINKS(ba, ws/*:Worksheet*/, rels) {\n\t/* *BrtHLink */\n\tws['!links'].forEach(function(l) {\n\t\tif(!l[1].Target) return;\n\t\tvar rId = add_rels(rels, -1, l[1].Target.replace(/#[\\s\\S]*$/, \"\"), RELS.HLINK);\n\t\twrite_record(ba, 0x01EE /* BrtHLink */, write_BrtHLink(l, rId));\n\t});\n\tdelete ws['!links'];\n}\nfunction write_LEGACYDRAWING(ba, ws/*:Worksheet*/, idx/*:number*/, rels) {\n\t/* [BrtLegacyDrawing] */\n\tif(ws['!comments'].length > 0) {\n\t\tvar rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\n\t\twrite_record(ba, 0x0227 /* BrtLegacyDrawing */, write_RelID(\"rId\" + rId));\n\t\tws['!legacy'] = rId;\n\t}\n}\n\nfunction write_AUTOFILTER(ba, ws, wb, idx) {\n\tif(!ws['!autofilter']) return;\n\tvar data = ws['!autofilter'];\n\tvar ref = typeof data.ref === \"string\" ? data.ref : encode_range(data.ref);\n\n\t/* Update FilterDatabase defined name for the worksheet */\n\tif(!wb.Workbook) wb.Workbook = ({Sheets:[]}/*:any*/);\n\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\tvar names/*: Array<any> */ = wb.Workbook.Names;\n\tvar range = decode_range(ref);\n\tif(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar name = names[i];\n\t\tif(name.Name != '_xlnm._FilterDatabase') continue;\n\t\tif(name.Sheet != idx) continue;\n\t\tname.Ref = formula_quote_sheet_name(wb.SheetNames[idx]) + \"!\" + fix_range(ref); break;\n\t}\n\tif(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: formula_quote_sheet_name(wb.SheetNames[idx]) + \"!\" + fix_range(ref)  });\n\n\twrite_record(ba, 0x00A1 /* BrtBeginAFilter */, write_UncheckedRfX(safe_decode_range(ref)));\n\t/* *FILTERCOLUMN */\n\t/* [SORTSTATE] */\n\t/* BrtEndAFilter */\n\twrite_record(ba, 0x00A2 /* BrtEndAFilter */);\n}\n\nfunction write_WSVIEWS2(ba, ws, Workbook) {\n\twrite_record(ba, 0x0085 /* BrtBeginWsViews */);\n\t{ /* 1*WSVIEW2 */\n\t\t/* [ACUID] */\n\t\twrite_record(ba, 0x0089 /* BrtBeginWsView */, write_BrtBeginWsView(ws, Workbook));\n\t\t/* [BrtPane] */\n\t\t/* *4BrtSel */\n\t\t/* *4SXSELECT */\n\t\t/* *FRT */\n\t\twrite_record(ba, 0x008A /* BrtEndWsView */);\n\t}\n\t/* *FRT */\n\twrite_record(ba, 0x0086 /* BrtEndWsViews */);\n}\n\nfunction write_WSFMTINFO(/*::ba, ws*/) {\n\t/* [ACWSFMTINFO] */\n\t// write_record(ba, 0x01E5 /* BrtWsFmtInfo */, write_BrtWsFmtInfo(ws));\n}\n\nfunction write_SHEETPROTECT(ba, ws) {\n\tif(!ws['!protect']) return;\n\t/* [BrtSheetProtectionIso] */\n\twrite_record(ba, 0x0217 /* BrtSheetProtection */, write_BrtSheetProtection(ws['!protect']));\n}\n\nfunction write_ws_bin(idx/*:number*/, opts, wb/*:Workbook*/, rels) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar c/*:string*/ = s; try { if(wb && wb.Workbook) c = wb.Workbook.Sheets[idx].CodeName || c; } catch(e) {}\n\tvar r = safe_decode_range(ws['!ref'] || \"A1\");\n\tif(r.e.c > 0x3FFF || r.e.r > 0xFFFFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:XFD1048576\");\n\t\tr.e.c = Math.min(r.e.c, 0x3FFF);\n\t\tr.e.r = Math.min(r.e.c, 0xFFFFF);\n\t}\n\tws['!links'] = [];\n\t/* passed back to write_zip and removed there */\n\tws['!comments'] = [];\n\twrite_record(ba, 0x0081 /* BrtBeginSheet */);\n\tif(wb.vbaraw || ws['!outline']) write_record(ba, 0x0093 /* BrtWsProp */, write_BrtWsProp(c, ws['!outline']));\n\twrite_record(ba, 0x0094 /* BrtWsDim */, write_BrtWsDim(r));\n\twrite_WSVIEWS2(ba, ws, wb.Workbook);\n\twrite_WSFMTINFO(ba, ws);\n\twrite_COLINFOS(ba, ws, idx, opts, wb);\n\twrite_CELLTABLE(ba, ws, idx, opts, wb);\n\t/* [BrtSheetCalcProp] */\n\twrite_SHEETPROTECT(ba, ws);\n\t/* *([BrtRangeProtectionIso] BrtRangeProtection) */\n\t/* [SCENMAN] */\n\twrite_AUTOFILTER(ba, ws, wb, idx);\n\t/* [SORTSTATE] */\n\t/* [DCON] */\n\t/* [USERSHVIEWS] */\n\twrite_MERGECELLS(ba, ws);\n\t/* [BrtPhoneticInfo] */\n\t/* *CONDITIONALFORMATTING */\n\t/* [DVALS] */\n\twrite_HLINKS(ba, ws, rels);\n\t/* [BrtPrintOptions] */\n\tif(ws['!margins']) write_record(ba, 0x01DC /* BrtMargins */, write_BrtMargins(ws['!margins']));\n\t/* [BrtPageSetup] */\n\t/* [HEADERFOOTER] */\n\t/* [RWBRK] */\n\t/* [COLBRK] */\n\t/* *BrtBigName */\n\t/* [CELLWATCHES] */\n\tif(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) write_IGNOREECS(ba, ws);\n\t/* [SMARTTAGS] */\n\t/* [BrtDrawing] */\n\twrite_LEGACYDRAWING(ba, ws, idx, rels);\n\t/* [BrtLegacyDrawingHF] */\n\t/* [BrtBkHim] */\n\t/* [OLEOBJECTS] */\n\t/* [ACTIVEXCONTROLS] */\n\t/* [WEBPUBITEMS] */\n\t/* [LISTPARTS] */\n\t/* FRTWORKSHEET */\n\twrite_record(ba, 0x0082 /* BrtEndSheet */);\n\treturn ba.end();\n}\nfunction parse_Cache(data/*:string*/)/*:[Array<number|string>, string, ?string]*/ {\n\tvar col/*:Array<number|string>*/ = [];\n\tvar num = data.match(/^<c:numCache>/);\n\tvar f;\n\n\t/* 21.2.2.150 pt CT_NumVal */\n\t(data.match(/<c:pt idx=\"(\\d*)\"[^<>\\/]*><c:v>([^<])<\\/c:v><\\/c:pt>/mg)||[]).forEach(function(pt) {\n\t\tvar q = pt.match(/<c:pt idx=\"(\\d*)\"[^<>\\/]*><c:v>([^<]*)<\\/c:v><\\/c:pt>/);\n\t\tif(!q) return;\n\t\tcol[+q[1]] = num ? +q[2] : q[2];\n\t});\n\n\t/* 21.2.2.71 formatCode CT_Xstring */\n\tvar nf = unescapexml((str_match_xml(data, \"c:formatCode\") || [\"\",\"General\"])[1]);\n\n\t(str_match_ng(data, \"<c:f>\", \"</c:f>\")||[]).forEach(function(F) { f = F.replace(/<[^<>]*>/g,\"\"); });\n\n\treturn [col, nf, f];\n}\n\n/* 21.2 DrawingML - Charts */\nfunction parse_chart(data/*:?string*/, name/*:string*/, opts, rels, wb, csheet) {\n\tvar cs/*:Worksheet*/ = ((csheet || {\"!type\":\"chart\"})/*:any*/);\n\tif(!data) return csheet;\n\t/* 21.2.2.27 chart CT_Chart */\n\n\tvar C = 0, R = 0, col = \"A\";\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\n\t/* 21.2.2.120 numCache CT_NumData */\n\t(str_match_ng(data, \"<c:numCache>\", \"</c:numCache>\")||[]).forEach(function(nc) {\n\t\tvar cache = parse_Cache(nc);\n\t\trefguess.s.r = refguess.s.c = 0;\n\t\trefguess.e.c = C;\n\t\tcol = encode_col(C);\n\t\tcache[0].forEach(function(n,i) {\n\t\t\tif(cs[\"!data\"]) {\n\t\t\t\tif(!cs[\"!data\"][i]) cs[\"!data\"][i] = [];\n\t\t\t\tcs[\"!data\"][i][C] = {t:'n', v:n, z:cache[1] };\n\t\t\t} else cs[col + encode_row(i)] = {t:'n', v:n, z:cache[1] };\n\t\t\tR = i;\n\t\t});\n\t\tif(refguess.e.r < R) refguess.e.r = R;\n\t\t++C;\n\t});\n\tif(C > 0) cs[\"!ref\"] = encode_range(refguess);\n\treturn cs;\n}\n/* 18.3 Worksheets also covers Chartsheets */\nfunction parse_cs_xml(data/*:?string*/, opts, idx/*:number*/, rels, wb/*::, themes, styles*/)/*:Worksheet*/ {\n\tif(!data) return data;\n\t/* 18.3.1.12 chartsheet CT_ChartSheet */\n\tif(!rels) rels = {'!id':{}};\n\tvar s = ({'!type':\"chart\", '!drawel':null, '!rel':\"\"}/*:any*/);\n\tvar m;\n\n\t/* 18.3.1.83 sheetPr CT_ChartsheetPr */\n\tvar sheetPr = data.match(sheetprregex);\n\tif(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\n\t/* 18.3.1.36 drawing CT_Drawing */\n\tif((m = data.match(/drawing r:id=\"(.*?)\"/))) s['!rel'] = m[1];\n\n\tif(rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n\treturn s;\n}\n//function write_cs_xml(idx/*:number*/, opts, wb/*:Workbook*/, rels)/*:string*/ {\n//\tvar o = [XML_HEADER, writextag('chartsheet', null, {\n//\t\t'xmlns': XMLNS_main[0],\n//\t\t'xmlns:r': XMLNS.r\n//\t})];\n//\to[o.length] = writextag(\"drawing\", null, {\"r:id\": \"rId1\"});\n//\tadd_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\n//\tif(o.length>2) { o[o.length] = ('</chartsheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n//\treturn o.join(\"\");\n//}\n\n/* [MS-XLSB] 2.4.331 BrtCsProp */\nfunction parse_BrtCsProp(data, length/*:number*/) {\n\tdata.l += 10;\n\tvar name = parse_XLWideString(data, length - 10);\n\treturn { name: name };\n}\n\n/* [MS-XLSB] 2.1.7.7 Chart Sheet */\nfunction parse_cs_bin(data, opts, idx/*:number*/, rels, wb/*::, themes, styles*/)/*:Worksheet*/ {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tvar s = {'!type':\"chart\", '!drawel':null, '!rel':\"\"};\n\tvar state/*:Array<string>*/ = [];\n\tvar pass = false;\n\trecordhopper(data, function cs_parse(val, R, RT) {\n\t\tswitch(RT) {\n\n\t\t\tcase 0x0226: /* 'BrtDrawing' */\n\t\t\t\ts['!rel'] = val; break;\n\n\t\t\tcase 0x028B: /* 'BrtCsProp' */\n\t\t\t\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\t\t\t\tif(val.name) wb.Sheets[idx].CodeName = val.name;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0232: /* 'BrtBkHim' */\n\t\t\tcase 0x028C: /* 'BrtCsPageSetup' */\n\t\t\tcase 0x029D: /* 'BrtCsProtection' */\n\t\t\tcase 0x02A7: /* 'BrtCsProtectionIso' */\n\t\t\tcase 0x0227: /* 'BrtLegacyDrawing' */\n\t\t\tcase 0x0228: /* 'BrtLegacyDrawingHF' */\n\t\t\tcase 0x01DC: /* 'BrtMargins' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T > 0) state.push(RT);\n\t\t\t\telse if(R.T < 0) state.pop();\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tif(rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n\treturn s;\n}\n//function write_cs_bin(/*::idx:number, opts, wb:Workbook, rels*/) {\n//\tvar ba = buf_array();\n//\twrite_record(ba, 0x0081 /* BrtBeginSheet */);\n//\t/* [BrtCsProp] */\n//\t/* CSVIEWS */\n//\t/* [[BrtCsProtectionIso] BrtCsProtection] */\n//\t/* [USERCSVIEWS] */\n//\t/* [BrtMargins] */\n//\t/* [BrtCsPageSetup] */\n//\t/* [HEADERFOOTER] */\n//\t/* BrtDrawing */\n//\t/* [BrtLegacyDrawing] */\n//\t/* [BrtLegacyDrawingHF] */\n//\t/* [BrtBkHim] */\n//\t/* [WEBPUBITEMS] */\n//\t/* FRTCHARTSHEET */\n//\twrite_record(ba, 0x0082 /* BrtEndSheet */);\n//\treturn ba.end();\n//}\n/* 18.2.28 (CT_WorkbookProtection) Defaults */\nvar WBPropsDef = [\n\t['allowRefreshQuery',           false, \"bool\"],\n\t['autoCompressPictures',        true,  \"bool\"],\n\t['backupFile',                  false, \"bool\"],\n\t['checkCompatibility',          false, \"bool\"],\n\t['CodeName',                    ''],\n\t['date1904',                    false, \"bool\"],\n\t['defaultThemeVersion',         0,      \"int\"],\n\t['filterPrivacy',               false, \"bool\"],\n\t['hidePivotFieldList',          false, \"bool\"],\n\t['promptedSolutions',           false, \"bool\"],\n\t['publishItems',                false, \"bool\"],\n\t['refreshAllConnections',       false, \"bool\"],\n\t['saveExternalLinkValues',      true,  \"bool\"],\n\t['showBorderUnselectedTables',  true,  \"bool\"],\n\t['showInkAnnotation',           true,  \"bool\"],\n\t['showObjects',                 'all'],\n\t['showPivotChartFilter',        false, \"bool\"],\n\t['updateLinks', 'userSet']\n];\n\n/* 18.2.30 (CT_BookView) Defaults */\nvar WBViewDef = [\n\t['activeTab',                   0,      \"int\"],\n\t['autoFilterDateGrouping',      true,  \"bool\"],\n\t['firstSheet',                  0,      \"int\"],\n\t['minimized',                   false, \"bool\"],\n\t['showHorizontalScroll',        true,  \"bool\"],\n\t['showSheetTabs',               true,  \"bool\"],\n\t['showVerticalScroll',          true,  \"bool\"],\n\t['tabRatio',                    600,    \"int\"],\n\t['visibility',                  'visible']\n\t//window{Height,Width}, {x,y}Window\n];\n\n/* 18.2.19 (CT_Sheet) Defaults */\nvar SheetDef = [\n\t//['state', 'visible']\n];\n\n/* 18.2.2  (CT_CalcPr) Defaults */\nvar CalcPrDef = [\n\t['calcCompleted', 'true'],\n\t['calcMode', 'auto'],\n\t['calcOnSave', 'true'],\n\t['concurrentCalc', 'true'],\n\t['fullCalcOnLoad', 'false'],\n\t['fullPrecision', 'true'],\n\t['iterate', 'false'],\n\t['iterateCount', '100'],\n\t['iterateDelta', '0.001'],\n\t['refMode', 'A1']\n];\n\n/* 18.2.3 (CT_CustomWorkbookView) Defaults */\n/*var CustomWBViewDef = [\n\t['autoUpdate', 'false'],\n\t['changesSavedWin', 'false'],\n\t['includeHiddenRowCol', 'true'],\n\t['includePrintSettings', 'true'],\n\t['maximized', 'false'],\n\t['minimized', 'false'],\n\t['onlySync', 'false'],\n\t['personalView', 'false'],\n\t['showComments', 'commIndicator'],\n\t['showFormulaBar', 'true'],\n\t['showHorizontalScroll', 'true'],\n\t['showObjects', 'all'],\n\t['showSheetTabs', 'true'],\n\t['showStatusbar', 'true'],\n\t['showVerticalScroll', 'true'],\n\t['tabRatio', '600'],\n\t['xWindow', '0'],\n\t['yWindow', '0']\n];*/\n\nfunction push_defaults_array(target, defaults) {\n\tfor(var j = 0; j != target.length; ++j) { var w = target[j];\n\t\tfor(var i=0; i != defaults.length; ++i) { var z = defaults[i];\n\t\t\tif(w[z[0]] == null) w[z[0]] = z[1];\n\t\t\telse switch(z[2]) {\n\t\t\tcase \"bool\": if(typeof w[z[0]] == \"string\") w[z[0]] = parsexmlbool(w[z[0]]); break;\n\t\t\tcase \"int\": if(typeof w[z[0]] == \"string\") w[z[0]] = parseInt(w[z[0]], 10); break;\n\t\t\t}\n\t\t}\n\t}\n}\nfunction push_defaults(target, defaults) {\n\tfor(var i = 0; i != defaults.length; ++i) { var z = defaults[i];\n\t\tif(target[z[0]] == null) target[z[0]] = z[1];\n\t\telse switch(z[2]) {\n\t\t\tcase \"bool\": if(typeof target[z[0]] == \"string\") target[z[0]] = parsexmlbool(target[z[0]]); break;\n\t\t\tcase \"int\": if(typeof target[z[0]] == \"string\") target[z[0]] = parseInt(target[z[0]], 10); break;\n\t\t}\n\t}\n}\n\nfunction parse_wb_defaults(wb) {\n\tpush_defaults(wb.WBProps, WBPropsDef);\n\tpush_defaults(wb.CalcPr, CalcPrDef);\n\n\tpush_defaults_array(wb.WBView, WBViewDef);\n\tpush_defaults_array(wb.Sheets, SheetDef);\n\n\t_ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904);\n}\n\nfunction safe1904(wb/*:Workbook*/)/*:string*/ {\n\t/* TODO: store date1904 somewhere else */\n\tif(!wb.Workbook) return \"false\";\n\tif(!wb.Workbook.WBProps) return \"false\";\n\treturn parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n}\n\nvar badchars = /*#__PURE__*/\":][*?\\/\\\\\".split(\"\");\nfunction check_ws_name(n/*:string*/, safe/*:?boolean*/)/*:boolean*/ {\n\ttry {\n\t\tif(n == \"\") throw new Error(\"Sheet name cannot be blank\");\n\t\tif(n.length > 31) throw new Error(\"Sheet name cannot exceed 31 chars\");\n\t\tif(n.charCodeAt(0) == 0x27 || n.charCodeAt(n.length - 1) == 0x27) throw new Error(\"Sheet name cannot start or end with apostrophe (')\");\n\t\tif(n.toLowerCase() == \"history\") throw new Error(\"Sheet name cannot be 'History'\");\n\t\tbadchars.forEach(function(c) {\n\t\t\tif(n.indexOf(c) == -1) return;\n\t\t\tthrow new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\n\t\t});\n\t} catch(e) { if(safe) return false; throw e; }\n\treturn true;\n}\nfunction check_wb_names(N, S, codes) {\n\tN.forEach(function(n,i) {\n\t\tcheck_ws_name(n);\n\t\tfor(var j = 0; j < i; ++j) if(n == N[j]) throw new Error(\"Duplicate Sheet Name: \" + n);\n\t\tif(codes) {\n\t\t\tvar cn = (S && S[i] && S[i].CodeName) || n;\n\t\t\tif(cn.charCodeAt(0) == 95 && cn.length > 22) throw new Error(\"Bad Code Name: Worksheet\" + cn);\n\t\t}\n\t});\n}\nfunction check_wb(wb) {\n\tif(!wb || !wb.SheetNames || !wb.Sheets) throw new Error(\"Invalid Workbook\");\n\tif(!wb.SheetNames.length) throw new Error(\"Workbook is empty\");\n\tvar Sheets = (wb.Workbook && wb.Workbook.Sheets) || [];\n\tcheck_wb_names(wb.SheetNames, Sheets, !!wb.vbaraw);\n\tfor(var i = 0; i < wb.SheetNames.length; ++i) check_ws(wb.Sheets[wb.SheetNames[i]], wb.SheetNames[i], i);\n\twb.SheetNames.forEach(function(n, i) {\n\t\tvar ws = wb.Sheets[n];\n\t\tif(!ws || !ws[\"!autofilter\"]) return;\n\t\tvar DN;\n\t\tif(!wb.Workbook) wb.Workbook = {};\n\t\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\t\twb.Workbook.Names.forEach(function(dn) { if(dn.Name == \"_xlnm._FilterDatabase\" && dn.Sheet == i) DN = dn; });\n\t\tvar nn = formula_quote_sheet_name(n) + \"!\" + fix_range(ws[\"!autofilter\"].ref);\n\t\tif(DN) DN.Ref = nn;\n\t\telse wb.Workbook.Names.push({Name: \"_xlnm._FilterDatabase\", Sheet: i, Ref: nn});\n\t});\n\t/* TODO: validate workbook */\n}\n/* 18.2 Workbook */\nvar wbnsregex = /<\\w+:workbook/;\nfunction parse_wb_xml(data, opts)/*:WorkbookFile*/ {\n\tif(!data) throw new Error(\"Could not find file\");\n\tvar wb = /*::(*/{ AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, Names:[], xmlns: \"\" }/*::)*/;\n\tvar pass = false, xmlns = \"xmlns\";\n\tvar dname = {}, dnstart = 0;\n\tdata.replace(tagregex, function xml_wb(x, idx) {\n\t\tvar y/*:any*/ = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 18.2.27 workbook CT_Workbook 1 */\n\t\t\tcase '<workbook':\n\t\t\t\tif(x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n\t\t\t\twb.xmlns = y[xmlns];\n\t\t\t\tbreak;\n\t\t\tcase '</workbook>': break;\n\n\t\t\t/* 18.2.13 fileVersion CT_FileVersion ? */\n\t\t\tcase '<fileVersion': delete y[0]; wb.AppVersion = y; break;\n\t\t\tcase '<fileVersion/>': case '</fileVersion>': break;\n\n\t\t\t/* 18.2.12 fileSharing CT_FileSharing ? */\n\t\t\tcase '<fileSharing':\n\t\t\t\tbreak;\n\t\t\tcase '<fileSharing/>': break;\n\n\t\t\t/* 18.2.28 workbookPr CT_WorkbookPr ? */\n\t\t\tcase '<workbookPr':\n\t\t\tcase '<workbookPr/>':\n\t\t\t\tWBPropsDef.forEach(function(w) {\n\t\t\t\t\tif(y[w[0]] == null) return;\n\t\t\t\t\tswitch(w[2]) {\n\t\t\t\t\t\tcase \"bool\": wb.WBProps[w[0]] = parsexmlbool(y[w[0]]); break;\n\t\t\t\t\t\tcase \"int\": wb.WBProps[w[0]] = parseInt(y[w[0]], 10); break;\n\t\t\t\t\t\tdefault: wb.WBProps[w[0]] = y[w[0]];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(y.codeName) wb.WBProps.CodeName = utf8read(y.codeName);\n\t\t\t\tbreak;\n\t\t\tcase '</workbookPr>': break;\n\n\t\t\t/* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\t\t\tcase '<workbookProtection':\n\t\t\t\tbreak;\n\t\t\tcase '<workbookProtection/>': break;\n\n\t\t\t/* 18.2.1  bookViews CT_BookViews ? */\n\t\t\tcase '<bookViews': case '<bookViews>': case '</bookViews>': break;\n\t\t\t/* 18.2.30   workbookView CT_BookView + */\n\t\t\tcase '<workbookView': case '<workbookView/>': delete y[0]; wb.WBView.push(y); break;\n\t\t\tcase '</workbookView>': break;\n\n\t\t\t/* 18.2.20 sheets CT_Sheets 1 */\n\t\t\tcase '<sheets': case '<sheets>': case '</sheets>': break; // aggregate sheet\n\t\t\t/* 18.2.19   sheet CT_Sheet + */\n\t\t\tcase '<sheet':\n\t\t\t\tswitch(y.state) {\n\t\t\t\t\tcase \"hidden\": y.Hidden = 1; break;\n\t\t\t\t\tcase \"veryHidden\": y.Hidden = 2; break;\n\t\t\t\t\tdefault: y.Hidden = 0;\n\t\t\t\t}\n\t\t\t\tdelete y.state;\n\t\t\t\ty.name = unescapexml(utf8read(y.name));\n\t\t\t\tdelete y[0]; wb.Sheets.push(y); break;\n\t\t\tcase '</sheet>': break;\n\n\t\t\t/* 18.2.15 functionGroups CT_FunctionGroups ? */\n\t\t\tcase '<functionGroups': case '<functionGroups/>': break;\n\t\t\t/* 18.2.14   functionGroup CT_FunctionGroup + */\n\t\t\tcase '<functionGroup': break;\n\n\t\t\t/* 18.2.9  externalReferences CT_ExternalReferences ? */\n\t\t\tcase '<externalReferences': case '</externalReferences>': case '<externalReferences>': break;\n\t\t\t/* 18.2.8    externalReference CT_ExternalReference + */\n\t\t\tcase '<externalReference': break;\n\n\t\t\t/* 18.2.6  definedNames CT_DefinedNames ? */\n\t\t\tcase '<definedNames/>': break;\n\t\t\tcase '<definedNames>': case '<definedNames': pass=true; break;\n\t\t\tcase '</definedNames>': pass=false; break;\n\t\t\t/* 18.2.5    definedName CT_DefinedName + */\n\t\t\tcase '<definedName': {\n\t\t\t\tdname = {};\n\t\t\t\tdname.Name = utf8read(y.name);\n\t\t\t\tif(y.comment) dname.Comment = y.comment;\n\t\t\t\tif(y.localSheetId) dname.Sheet = +y.localSheetId;\n\t\t\t\tif(parsexmlbool(y.hidden||\"0\")) dname.Hidden = true;\n\t\t\t\tdnstart = idx + x.length;\n\t\t\t}\tbreak;\n\t\t\tcase '</definedName>': {\n\t\t\t\tdname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\n\t\t\t\twb.Names.push(dname);\n\t\t\t} break;\n\t\t\tcase '<definedName/>': break;\n\n\t\t\t/* 18.2.2  calcPr CT_CalcPr ? */\n\t\t\tcase '<calcPr': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '<calcPr/>': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '</calcPr>': break;\n\n\t\t\t/* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\t\t\tcase '<oleSize': break;\n\n\t\t\t/* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\t\t\tcase '<customWorkbookViews>': case '</customWorkbookViews>': case '<customWorkbookViews': break;\n\t\t\t/* 18.2.3  customWorkbookView CT_CustomWorkbookView + */\n\t\t\tcase '<customWorkbookView': case '</customWorkbookView>': break;\n\n\t\t\t/* 18.2.18 pivotCaches CT_PivotCaches ? */\n\t\t\tcase '<pivotCaches>': case '</pivotCaches>': case '<pivotCaches': break;\n\t\t\t/* 18.2.17 pivotCache CT_PivotCache ? */\n\t\t\tcase '<pivotCache': break;\n\n\t\t\t/* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\t\t\tcase '<smartTagPr': case '<smartTagPr/>': break;\n\n\t\t\t/* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\t\t\tcase '<smartTagTypes': case '<smartTagTypes>': case '</smartTagTypes>': break;\n\t\t\t/* 18.2.22 smartTagType CT_SmartTagType ? */\n\t\t\tcase '<smartTagType': break;\n\n\t\t\t/* 18.2.24 webPublishing CT_WebPublishing ? */\n\t\t\tcase '<webPublishing': case '<webPublishing/>': break;\n\n\t\t\t/* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\t\t\tcase '<fileRecoveryPr': case '<fileRecoveryPr/>': break;\n\n\t\t\t/* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\t\t\tcase '<webPublishObjects>': case '<webPublishObjects': case '</webPublishObjects>': break;\n\t\t\t/* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\t\t\tcase '<webPublishObject': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break; //TODO: check with versions of excel\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\t/* Others */\n\t\t\tcase '<ArchID': break;\n\t\t\tcase '<AlternateContent':\n\t\t\tcase '<AlternateContent>': pass=true; break;\n\t\t\tcase '</AlternateContent>': pass=false; break;\n\n\t\t\t/* TODO */\n\t\t\tcase '<revisionPtr': break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in workbook');\n\t\t}\n\t\treturn x;\n\t});\n\tif(XMLNS_main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n\n\tparse_wb_defaults(wb);\n\n\treturn wb;\n}\n\nfunction write_wb_xml(wb/*:Workbook*//*::, opts:?WriteOpts*/)/*:string*/ {\n\tvar o = [XML_HEADER];\n\to[o.length] = writextag('workbook', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t//'xmlns:mx': XMLNS.mx,\n\t\t//'xmlns:s': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t});\n\n\tvar write_names = (wb.Workbook && (wb.Workbook.Names||[]).length > 0);\n\n\t/* fileVersion */\n\t/* fileSharing */\n\n\tvar workbookPr/*:any*/ = ({codeName:\"ThisWorkbook\"}/*:any*/);\n\tif(wb.Workbook && wb.Workbook.WBProps) {\n\t\tWBPropsDef.forEach(function(x) {\n\t\t\t/*:: if(!wb.Workbook || !wb.Workbook.WBProps) throw \"unreachable\"; */\n\t\t\tif((wb.Workbook.WBProps[x[0]]/*:any*/) == null) return;\n\t\t\tif((wb.Workbook.WBProps[x[0]]/*:any*/) == x[1]) return;\n\t\t\tworkbookPr[x[0]] = (wb.Workbook.WBProps[x[0]]/*:any*/);\n\t\t});\n\t\t/*:: if(!wb.Workbook || !wb.Workbook.WBProps) throw \"unreachable\"; */\n\t\tif(wb.Workbook.WBProps.CodeName) { workbookPr.codeName = wb.Workbook.WBProps.CodeName; delete workbookPr.CodeName; }\n\t}\n\to[o.length] = (writextag('workbookPr', null, workbookPr));\n\n\t/* workbookProtection */\n\n\tvar sheets = wb.Workbook && wb.Workbook.Sheets || [];\n\tvar i = 0;\n\n\t/* bookViews only written if first worksheet is hidden */\n\tif(sheets && sheets[0] && !!sheets[0].Hidden) {\n\t\to[o.length] = \"<bookViews>\";\n\t\tfor(i = 0; i != wb.SheetNames.length; ++i) {\n\t\t\tif(!sheets[i]) break;\n\t\t\tif(!sheets[i].Hidden) break;\n\t\t}\n\t\tif(i == wb.SheetNames.length) i = 0;\n\t\to[o.length] = '<workbookView firstSheet=\"' + i + '\" activeTab=\"' + i + '\"/>';\n\t\to[o.length] = \"</bookViews>\";\n\t}\n\n\to[o.length] = \"<sheets>\";\n\tfor(i = 0; i != wb.SheetNames.length; ++i) {\n\t\tvar sht = ({name:escapexml(wb.SheetNames[i].slice(0,31))}/*:any*/);\n\t\tsht.sheetId = \"\"+(i+1);\n\t\tsht[\"r:id\"] = \"rId\"+(i+1);\n\t\tif(sheets[i]) switch(sheets[i].Hidden) {\n\t\t\tcase 1: sht.state = \"hidden\"; break;\n\t\t\tcase 2: sht.state = \"veryHidden\"; break;\n\t\t}\n\t\to[o.length] = (writextag('sheet',null,sht));\n\t}\n\to[o.length] = \"</sheets>\";\n\n\t/* functionGroups */\n\t/* externalReferences */\n\n\tif(write_names) {\n\t\to[o.length] = \"<definedNames>\";\n\t\tif(wb.Workbook && wb.Workbook.Names) wb.Workbook.Names.forEach(function(n) {\n\t\t\tvar d/*:any*/ = {name:n.Name};\n\t\t\tif(n.Comment) d.comment = n.Comment;\n\t\t\tif(n.Sheet != null) d.localSheetId = \"\"+n.Sheet;\n\t\t\tif(n.Hidden) d.hidden = \"1\";\n\t\t\tif(!n.Ref) return;\n\t\t\to[o.length] = writextag('definedName', escapexml(n.Ref), d);\n\t\t});\n\t\to[o.length] = \"</definedNames>\";\n\t}\n\n\t/* calcPr */\n\t/* oleSize */\n\t/* customWorkbookViews */\n\t/* pivotCaches */\n\t/* smartTagPr */\n\t/* smartTagTypes */\n\t/* webPublishing */\n\t/* fileRecoveryPr */\n\t/* webPublishObjects */\n\t/* extLst */\n\n\tif(o.length>2){ o[o.length] = '</workbook>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.304 BrtBundleSh */\nfunction parse_BrtBundleSh(data, length/*:number*/) {\n\tvar z = {};\n\tz.Hidden = data.read_shift(4); //hsState ST_SheetState\n\tz.iTabID = data.read_shift(4);\n\tz.strRelID = parse_RelID(data,length-8);\n\tz.name = parse_XLWideString(data);\n\treturn z;\n}\nfunction write_BrtBundleSh(data, o) {\n\tif(!o) o = new_buf(127);\n\to.write_shift(4, data.Hidden);\n\to.write_shift(4, data.iTabID);\n\twrite_RelID(data.strRelID, o);\n\twrite_XLWideString(data.name.slice(0,31), o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.815 BrtWbProp */\nfunction parse_BrtWbProp(data, length)/*:WBProps*/ {\n\tvar o/*:WBProps*/ = ({}/*:any*/);\n\tvar flags = data.read_shift(4);\n\to.defaultThemeVersion = data.read_shift(4);\n\tvar strName = (length > 8) ? parse_XLWideString(data) : \"\";\n\tif(strName.length > 0) o.CodeName = strName;\n\to.autoCompressPictures = !!(flags & 0x10000);\n\to.backupFile = !!(flags & 0x40);\n\to.checkCompatibility = !!(flags & 0x1000);\n\to.date1904 = !!(flags & 0x01);\n\to.filterPrivacy = !!(flags & 0x08);\n\to.hidePivotFieldList = !!(flags & 0x400);\n\to.promptedSolutions = !!(flags & 0x10);\n\to.publishItems = !!(flags & 0x800);\n\to.refreshAllConnections = !!(flags & 0x40000);\n\to.saveExternalLinkValues = !!(flags & 0x80);\n\to.showBorderUnselectedTables = !!(flags & 0x04);\n\to.showInkAnnotation = !!(flags & 0x20);\n\to.showObjects = [\"all\", \"placeholders\", \"none\"][(flags >> 13) & 0x03];\n\to.showPivotChartFilter = !!(flags & 0x8000);\n\to.updateLinks = [\"userSet\", \"never\", \"always\"][(flags >> 8) & 0x03];\n\treturn o;\n}\nfunction write_BrtWbProp(data/*:?WBProps*/, o) {\n\tif(!o) o = new_buf(72);\n\tvar flags = 0;\n\tif(data) {\n\t\t/* TODO: mirror parse_BrtWbProp fields */\n\t\tif(data.date1904) flags |= 0x01;\n\t\tif(data.filterPrivacy) flags |= 0x08;\n\t}\n\to.write_shift(4, flags);\n\to.write_shift(4, 0);\n\twrite_XLSBCodeName(data && data.CodeName || \"ThisWorkbook\", o);\n\treturn o.slice(0, o.l);\n}\n\nfunction parse_BrtFRTArchID$(data, length) {\n\tvar o = {};\n\tdata.read_shift(4);\n\to.ArchID = data.read_shift(4);\n\tdata.l += length - 8;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.687 BrtName */\nfunction parse_BrtName(data, length, opts) {\n\tvar end = data.l + length;\n\tvar flags = data.read_shift(4);\n\tdata.l += 1; //var chKey = data.read_shift(1);\n\tvar itab = data.read_shift(4);\n\tvar name = parse_XLNameWideString(data);\n\tvar formula;\n\tvar comment = \"\";\n\ttry {\n\t\tformula = parse_XLSBNameParsedFormula(data, 0, opts);\n\t\ttry {\n\t\t\tcomment = parse_XLNullableWideString(data);\n\t\t} catch(e){}\n\t} catch(e) { console.error(\"Could not parse defined name \" + name); }\n\tif(flags & 0x20) name = \"_xlnm.\" + name;\n\t//if(0 /* fProc */) {\n\t\t// unusedstring1: XLNullableWideString\n\t\t// description: XLNullableWideString\n\t\t// helpTopic: XLNullableWideString\n\t\t// unusedstring2: XLNullableWideString\n\t//}\n\tdata.l = end;\n\tvar out = ({Name:name, Ptg:formula, Flags: flags}/*:any*/);\n\tif(itab < 0xFFFFFFF) out.Sheet = itab;\n\tif(comment) out.Comment = comment;\n\treturn out;\n}\nfunction write_BrtName(name, wb) {\n\tvar o = new_buf(9);\n\tvar flags = 0;\n\tvar dname = name.Name;\n\tif(XLSLblBuiltIn.indexOf(dname) > -1) { flags |= 0x20; dname = dname.slice(6); }\n\to.write_shift(4, flags); // flags\n\to.write_shift(1, 0); // chKey\n\to.write_shift(4, name.Sheet == null ? 0xFFFFFFFF : name.Sheet);\n\n\tvar arr = [\n\t\to,\n\t\twrite_XLWideString(dname),\n\t\twrite_XLSBNameParsedFormula(name.Ref, wb)\n\t];\n\tif(name.Comment) arr.push(write_XLNullableWideString(name.Comment));\n\telse {\n\t\tvar x = new_buf(4);\n\t\tx.write_shift(4, 0xFFFFFFFF);\n\t\tarr.push(x);\n\t}\n\n\t// if macro (flags & 0x0F):\n\t// write_shift(4, 0xFFFFFFFF);\n\t// write_XLNullableWideString(description)\n\t// write_XLNullableWideString(helpTopic)\n\t// write_shift(4, 0xFFFFFFFF);\n\n\treturn bconcat(arr);\n}\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\nfunction parse_wb_bin(data, opts)/*:WorkbookFile*/ {\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\n\tvar state/*:Array<string>*/ = [];\n\tvar pass = false;\n\n\tif(!opts) opts = {};\n\topts.biff = 12;\n\n\tvar Names = [];\n\tvar supbooks = ([[]]/*:any*/);\n\tsupbooks.SheetNames = [];\n\tsupbooks.XTI = [];\n\n\tXLSBRecordEnum[0x0010] = { n:\"BrtFRTArchID$\", f:parse_BrtFRTArchID$ };\n\n\trecordhopper(data, function hopper_wb(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x009C: /* 'BrtBundleSh' */\n\t\t\t\tsupbooks.SheetNames.push(val.name);\n\t\t\t\twb.Sheets.push(val); break;\n\n\t\t\tcase 0x0099: /* 'BrtWbProp' */\n\t\t\t\twb.WBProps = val; break;\n\n\t\t\tcase 0x0027: /* 'BrtName' */\n\t\t\t\tif(val.Sheet != null) opts.SID = val.Sheet;\n\t\t\t\tval.Ref = val.Ptg ? stringify_formula(val.Ptg, null, null, supbooks, opts) : \"#REF!\";\n\t\t\t\tdelete opts.SID;\n\t\t\t\tdelete val.Ptg;\n\t\t\t\tNames.push(val);\n\t\t\t\tbreak;\n\t\t\tcase 0x040C: /* 'BrtNameExt' */ break;\n\n\t\t\tcase 0x0165: /* 'BrtSupSelf' */\n\t\t\tcase 0x0166: /* 'BrtSupSame' */\n\t\t\tcase 0x0163: /* 'BrtSupBookSrc' */\n\t\t\tcase 0x029B: /* 'BrtSupAddin' */\n\t\t\t\tif(!supbooks[0].length) supbooks[0] = [RT, val];\n\t\t\t\telse supbooks.push([RT, val]);\n\t\t\t\tsupbooks[supbooks.length - 1].XTI = [];\n\t\t\t\tbreak;\n\t\t\tcase 0x016A: /* 'BrtExternSheet' */\n\t\t\t\tif(supbooks.length === 0) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\tsupbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n\t\t\t\tsupbooks.XTI = supbooks.XTI.concat(val);\n\t\t\t\tbreak;\n\t\t\tcase 0x0169: /* 'BrtPlaceholderName' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0817: /* 'BrtAbsPath15' */\n\t\t\tcase 0x009E: /* 'BrtBookView' */\n\t\t\tcase 0x008F: /* 'BrtBeginBundleShs' */\n\t\t\tcase 0x0298: /* 'BrtBeginFnGroup' */\n\t\t\tcase 0x0161: /* 'BrtBeginExternals' */\n\t\t\t\tbreak;\n\n\t\t\t/* case 'BrtModelTimeGroupingCalcCol' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\tcase 0x0C01: /* 'BrtRevisionPtr' */\n\t\t\tcase 0x0216: /* 'BrtBookProtection' */\n\t\t\tcase 0x02A5: /* 'BrtBookProtectionIso' */\n\t\t\tcase 0x009D: /* 'BrtCalcProp' */\n\t\t\tcase 0x0262: /* 'BrtCrashRecErr' */\n\t\t\tcase 0x0802: /* 'BrtDecoupledPivotCacheID' */\n\t\t\tcase 0x009B: /* 'BrtFileRecover' */\n\t\t\tcase 0x0224: /* 'BrtFileSharing' */\n\t\t\tcase 0x02A4: /* 'BrtFileSharingIso' */\n\t\t\tcase 0x0080: /* 'BrtFileVersion' */\n\t\t\tcase 0x0299: /* 'BrtFnGroup' */\n\t\t\tcase 0x0850: /* 'BrtModelRelationship' */\n\t\t\tcase 0x084D: /* 'BrtModelTable' */\n\t\t\tcase 0x0225: /* 'BrtOleSize' */\n\t\t\tcase 0x0805: /* 'BrtPivotTableRef' */\n\t\t\tcase 0x0254: /* 'BrtSmartTagType' */\n\t\t\tcase 0x081C: /* 'BrtTableSlicerCacheID' */\n\t\t\tcase 0x081B: /* 'BrtTableSlicerCacheIDs' */\n\t\t\tcase 0x0822: /* 'BrtTimelineCachePivotCacheID' */\n\t\t\tcase 0x018D: /* 'BrtUserBookView' */\n\t\t\tcase 0x009A: /* 'BrtWbFactoid' */\n\t\t\tcase 0x045D: /* 'BrtWbProp14' */\n\t\t\tcase 0x0229: /* 'BrtWebOpt' */\n\t\t\tcase 0x082B: /* 'BrtWorkBookPr15' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tcase 0x0010: /* 'BrtFRTArchID$' */ break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || (opts.WTF && state[state.length-1] != 0x0025 /* BrtACBegin */ && state[state.length-1] != 0x0023 /* BrtFRTBegin */)) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tparse_wb_defaults(wb);\n\n\t// $FlowIgnore\n\twb.Names = Names;\n\n\t(wb/*:any*/).supbooks = supbooks;\n\treturn wb;\n}\n\nfunction write_BUNDLESHS(ba, wb/*::, opts*/) {\n\twrite_record(ba, 0x008F /* BrtBeginBundleShs */);\n\tfor(var idx = 0; idx != wb.SheetNames.length; ++idx) {\n\t\tvar viz = wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx] && wb.Workbook.Sheets[idx].Hidden || 0;\n\t\tvar d = { Hidden: viz, iTabID: idx+1, strRelID: 'rId' + (idx+1), name: wb.SheetNames[idx] };\n\t\twrite_record(ba, 0x009C /* BrtBundleSh */, write_BrtBundleSh(d));\n\t}\n\twrite_record(ba, 0x0090 /* BrtEndBundleShs */);\n}\n\n/* [MS-XLSB] 2.4.649 BrtFileVersion */\nfunction write_BrtFileVersion(data, o) {\n\tif(!o) o = new_buf(127);\n\tfor(var i = 0; i != 4; ++i) o.write_shift(4, 0);\n\twrite_XLWideString(\"SheetJS\", o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(\"7262\", o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.301 BrtBookView */\nfunction write_BrtBookView(idx, o) {\n\tif(!o) o = new_buf(29);\n\to.write_shift(-4, 0);\n\to.write_shift(-4, 460);\n\to.write_shift(4,  28800);\n\to.write_shift(4,  17600);\n\to.write_shift(4,  500);\n\to.write_shift(4,  idx);\n\to.write_shift(4,  idx);\n\tvar flags = 0x78;\n\to.write_shift(1,  flags);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\nfunction write_BOOKVIEWS(ba, wb/*::, opts*/) {\n\t/* required if hidden tab appears before visible tab */\n\tif(!wb.Workbook || !wb.Workbook.Sheets) return;\n\tvar sheets = wb.Workbook.Sheets;\n\tvar i = 0, vistab = -1, hidden = -1;\n\tfor(; i < sheets.length; ++i) {\n\t\tif(!sheets[i] || !sheets[i].Hidden && vistab == -1) vistab = i;\n\t\telse if(sheets[i].Hidden == 1 && hidden == -1) hidden = i;\n\t}\n\tif(hidden > vistab) return;\n\twrite_record(ba, 0x0087 /* BrtBeginBookViews */);\n\twrite_record(ba, 0x009E /* BrtBookView */, write_BrtBookView(vistab));\n\t/* 1*(BrtBookView *FRT) */\n\twrite_record(ba, 0x0088 /* BrtEndBookViews */);\n}\n\nfunction write_BRTNAMES(ba, wb) {\n\tif(!wb.Workbook || !wb.Workbook.Names) return;\n\twb.Workbook.Names.forEach(function(name) { try {\n\t\tif(name.Flags & 0x0e) return; // TODO: macro name write\n\t\twrite_record(ba, 0x0027 /* BrtName */, write_BrtName(name, wb));\n\t} catch(e) {\n\t\tconsole.error(\"Could not serialize defined name \" + JSON.stringify(name));\n\t} });\n}\n\nfunction write_SELF_EXTERNS_xlsb(wb) {\n\tvar L = wb.SheetNames.length;\n\tvar o = new_buf(12 * L + 28);\n\to.write_shift(4, L + 2);\n\to.write_shift(4, 0); o.write_shift(4, -2); o.write_shift(4, -2); // workbook-level reference\n\to.write_shift(4, 0); o.write_shift(4, -1); o.write_shift(4, -1); // #REF!...\n\tfor(var i = 0; i < L; ++i) {\n\t\to.write_shift(4, 0); o.write_shift(4, i); o.write_shift(4, i);\n\t}\n\treturn o;\n}\nfunction write_EXTERNALS_xlsb(ba, wb) {\n\twrite_record(ba, 0x0161 /* BrtBeginExternals */);\n\twrite_record(ba, 0x0165 /* BrtSupSelf */);\n\twrite_record(ba, 0x016A /* BrtExternSheet */, write_SELF_EXTERNS_xlsb(wb, 0));\n\twrite_record(ba, 0x0162 /* BrtEndExternals */);\n}\n\n/* [MS-XLSB] 2.4.305 BrtCalcProp */\n/*function write_BrtCalcProp(data, o) {\n\tif(!o) o = new_buf(26);\n\to.write_shift(4,0); // force recalc\n\to.write_shift(4,1);\n\to.write_shift(4,0);\n\twrite_Xnum(0, o);\n\to.write_shift(-4, 1023);\n\to.write_shift(1, 0x33);\n\to.write_shift(1, 0x00);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.4.646 BrtFileRecover */\n/*function write_BrtFileRecover(data, o) {\n\tif(!o) o = new_buf(1);\n\to.write_shift(1,0);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\nfunction write_wb_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0083 /* BrtBeginBook */);\n\twrite_record(ba, 0x0080 /* BrtFileVersion */, write_BrtFileVersion());\n\t/* [[BrtFileSharingIso] BrtFileSharing] */\n\twrite_record(ba, 0x0099 /* BrtWbProp */, write_BrtWbProp(wb.Workbook && wb.Workbook.WBProps || null));\n\t/* [ACABSPATH] */\n\t/* [[BrtBookProtectionIso] BrtBookProtection] */\n\twrite_BOOKVIEWS(ba, wb, opts);\n\twrite_BUNDLESHS(ba, wb, opts);\n\t/* [FNGROUP] */\n\twrite_EXTERNALS_xlsb(ba, wb);\n\tif((wb.Workbook||{}).Names) write_BRTNAMES(ba, wb);\n\t/* write_record(ba, 0x009D BrtCalcProp, write_BrtCalcProp()); */\n\t/* [BrtOleSize] */\n\t/* *(BrtUserBookView *FRT) */\n\t/* [PIVOTCACHEIDS] */\n\t/* [BrtWbFactoid] */\n\t/* [SMARTTAGTYPES] */\n\t/* [BrtWebOpt] */\n\t/* write_record(ba, 0x009B BrtFileRecover, write_BrtFileRecover()); */\n\t/* [WEBPUBITEMS] */\n\t/* [CRERRS] */\n\t/* FRTWORKBOOK */\n\twrite_record(ba, 0x0084 /* BrtEndBook */);\n\n\treturn ba.end();\n}\nfunction parse_wb(data, name/*:string*/, opts)/*:WorkbookFile*/ {\n\tif(name.slice(-4)===\".bin\") return parse_wb_bin((data/*:any*/), opts);\n\treturn parse_wb_xml((data/*:any*/), opts);\n}\n\nfunction parse_ws(data, name/*:string*/, idx/*:number*/, opts, rels, wb, themes, styles)/*:Worksheet*/ {\n\tif(name.slice(-4)===\".bin\") return parse_ws_bin((data/*:any*/), opts, idx, rels, wb, themes, styles);\n\treturn parse_ws_xml((data/*:any*/), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_cs(data, name/*:string*/, idx/*:number*/, opts, rels, wb, themes, styles)/*:Worksheet*/ {\n\tif(name.slice(-4)===\".bin\") return parse_cs_bin((data/*:any*/), opts, idx, rels, wb, themes, styles);\n\treturn parse_cs_xml((data/*:any*/), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ms(data, name/*:string*/, idx/*:number*/, opts, rels, wb, themes, styles)/*:Worksheet*/ {\n\tif(name.slice(-4)===\".bin\") return parse_ms_bin((data/*:any*/), opts, idx, rels, wb, themes, styles);\n\treturn parse_ms_xml((data/*:any*/), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ds(data, name/*:string*/, idx/*:number*/, opts, rels, wb, themes, styles)/*:Worksheet*/ {\n\tif(name.slice(-4)===\".bin\") return parse_ds_bin((data/*:any*/), opts, idx, rels, wb, themes, styles);\n\treturn parse_ds_xml((data/*:any*/), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_sty(data, name/*:string*/, themes, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_sty_bin((data/*:any*/), themes, opts);\n\treturn parse_sty_xml((data/*:any*/), themes, opts);\n}\n\nfunction parse_sst(data, name/*:string*/, opts)/*:SST*/ {\n\tif(name.slice(-4)===\".bin\") return parse_sst_bin((data/*:any*/), opts);\n\treturn parse_sst_xml((data/*:any*/), opts);\n}\n\nfunction parse_cmnt(data, name/*:string*/, opts)/*:Array<RawComment>*/ {\n\tif(name.slice(-4)===\".bin\") return parse_comments_bin((data/*:any*/), opts);\n\treturn parse_comments_xml((data/*:any*/), opts);\n}\n\nfunction parse_cc(data, name/*:string*/, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_cc_bin((data/*:any*/), name, opts);\n\treturn parse_cc_xml((data/*:any*/), name, opts);\n}\n\nfunction parse_xlink(data, rel, name/*:string*/, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_xlink_bin((data/*:any*/), rel, name, opts);\n\treturn parse_xlink_xml((data/*:any*/), rel, name, opts);\n}\n\nfunction parse_xlmeta(data, name/*:string*/, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_xlmeta_bin((data/*:any*/), name, opts);\n\treturn parse_xlmeta_xml((data/*:any*/), name, opts);\n}\nvar attregexg2=/\\b((?:\\w+:)?[\\w]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar attregex2=/\\b((?:\\w+:)?[\\w]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\nfunction xlml_parsexmltag(tag/*:string*/, skip_root/*:?boolean*/) {\n\tvar words = tag.split(/\\s+/);\n\tvar z/*:any*/ = ([]/*:any*/); if(!skip_root) z[0] = words[0];\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\n/*:: if(!y || !y[2]) continue; */\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\n\t\telse {\n\t\t\tif(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\n\t\t\telse w = y[1].slice(j+1);\n\t\t\tz[w] = y[2].slice(1,y[2].length-1);\n\t\t}\n\t}\n\treturn z;\n}\nfunction xlml_parsexmltagobj(tag/*:string*/) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = {};\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\n/*:: if(!y || !y[2]) continue; */\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\n\t\telse {\n\t\t\tif(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\n\t\t\telse w = y[1].slice(j+1);\n\t\t\tz[w] = y[2].slice(1,y[2].length-1);\n\t\t}\n\t}\n\treturn z;\n}\n\n// ----\n\n/* map from xlml named formats to SSF TODO: localize */\nvar XLMLFormatMap/*: {[string]:string}*/;\n\nfunction xlml_format(format, value, date1904)/*:string*/ {\n\tvar fmt = XLMLFormatMap[format] || unescapexml(format);\n\tif(fmt === \"General\") return SSF_general(value);\n\treturn SSF_format(fmt, value, {date1904: !!date1904});\n}\n\nfunction xlml_set_custprop(Custprops, key, cp, val/*:string*/) {\n\tvar oval/*:any*/ = val;\n\tswitch((cp[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]) {\n\t\tcase \"boolean\": oval = parsexmlbool(val); break;\n\t\tcase \"i2\": case \"int\": oval = parseInt(val, 10); break;\n\t\tcase \"r4\": case \"float\": oval = parseFloat(val); break;\n\t\tcase \"date\": case \"dateTime.tz\": oval = parseDate(val); break;\n\t\tcase \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\n\t\tdefault: throw new Error(\"bad custprop:\" + cp[0]);\n\t}\n\tCustprops[unescapexml(key)] = oval;\n}\n\nfunction safe_format_xlml(cell/*:Cell*/, nf, o, date1904) {\n\tif(cell.t === 'z') return;\n\tif(!o || o.cellText !== false) try {\n\t\tif(cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\n\t\telse if(nf === \"General\") {\n\t\t\tif(cell.t === 'n') {\n\t\t\t\tif((cell.v|0) === cell.v) cell.w = cell.v.toString(10);\n\t\t\t\telse cell.w = SSF_general_num(cell.v);\n\t\t\t}\n\t\t\telse cell.w = SSF_general(cell.v);\n\t\t}\n\t\telse cell.w = xlml_format(nf||\"General\", cell.v, date1904);\n\t} catch(e) { if(o.WTF) throw e; }\n\ttry {\n\t\tvar z = XLMLFormatMap[nf]||nf||\"General\";\n\t\tif(o.cellNF) cell.z = z;\n\t\tif(o.cellDates && cell.t == 'n' && fmt_is_date(z)) {\n\t\t\tvar _d = SSF_parse_date_code(cell.v + (date1904 ? 1462 : 0)); if(_d) { cell.t = 'd'; cell.v = new Date(Date.UTC(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u)); }\n\t\t}\n\t} catch(e) { if(o.WTF) throw e; }\n}\n\nfunction process_style_xlml(styles, stag, opts) {\n\tif(opts.cellStyles) {\n\t\tif(stag.Interior) {\n\t\t\tvar I = stag.Interior;\n\t\t\tif(I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n\t\t}\n\t}\n\tstyles[stag.ID] = stag;\n}\n\n/* TODO: there must exist some form of OSP-blessed spec */\nfunction parse_xlml_data(xml, ss, data, cell/*:any*/, base, styles, csty, row, arrayf, o, date1904) {\n\tvar nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\n\tvar interiors = [];\n\tvar i = 0;\n\tif(sid === undefined && row) sid = row.StyleID;\n\tif(sid === undefined && csty) sid = csty.StyleID;\n\twhile(styles[sid] !== undefined) {\n\t\tvar ssid = styles[sid];\n\t\tif(ssid.nf) nf = ssid.nf;\n\t\tif(ssid.Interior) interiors.push(ssid.Interior);\n\t\tif(!ssid.Parent) break;\n\t\tsid = ssid.Parent;\n\t}\n\tswitch(data.Type) {\n\t\tcase 'Boolean':\n\t\t\tcell.t = 'b';\n\t\t\tcell.v = parsexmlbool(xml);\n\t\t\tbreak;\n\t\tcase 'String':\n\t\t\tcell.t = 's'; cell.r = xlml_fixstr(unescapexml(xml));\n\t\t\tcell.v = (xml.indexOf(\"<\") > -1 ? unescapexml(ss||xml).replace(/<[^<>]*>/g, \"\") : cell.r); // todo: BR etc\n\t\t\tbreak;\n\t\tcase 'DateTime':\n\t\t\tif(xml.slice(-1) != \"Z\") xml += \"Z\";\n\t\t\tcell.v = datenum(parseDate(xml, date1904), date1904);\n\t\t\tif(cell.v !== cell.v) cell.v = unescapexml(xml);\n\t\t\tif(!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\t\t\t/* falls through */\n\t\tcase 'Number':\n\t\t\tif(cell.v === undefined) cell.v=+xml;\n\t\t\tif(!cell.t) cell.t = 'n';\n\t\t\tbreak;\n\t\tcase 'Error': cell.t = 'e'; cell.v = RBErr[xml]; if(o.cellText !== false) cell.w = xml; break;\n\t\tdefault:\n\t\t\tif(xml == \"\" && ss == \"\") { cell.t = 'z'; }\n\t\t\telse { cell.t = 's'; cell.v = xlml_fixstr(ss||xml); }\n\t\t\tbreak;\n\t}\n\tsafe_format_xlml(cell, nf, o, date1904);\n\tif(o.cellFormula !== false) {\n\t\tif(cell.Formula) {\n\t\t\tvar fstr = unescapexml(cell.Formula);\n\t\t\t/* strictly speaking, the leading = is required but some writers omit */\n\t\t\tif(fstr.charCodeAt(0) == 61 /* = */) fstr = fstr.slice(1);\n\t\t\tcell.f = rc_to_a1(fstr, base);\n\t\t\tdelete cell.Formula;\n\t\t\tif(cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);\n\t\t\telse if(cell.ArrayRange) {\n\t\t\t\tcell.F = rc_to_a1(cell.ArrayRange, base);\n\t\t\t\tarrayf.push([safe_decode_range(cell.F), cell.F]);\n\t\t\t}\n\t\t} else {\n\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\tif(base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r)\n\t\t\t\t\tif(base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\tcell.F = arrayf[i][1];\n\t\t}\n\t}\n\tif(o.cellStyles) {\n\t\tinteriors.forEach(function(x) {\n\t\t\tif(!S.patternType && x.patternType) S.patternType = x.patternType;\n\t\t});\n\t\tcell.s = S;\n\t}\n\tif(cell.StyleID !== undefined) cell.ixfe = cell.StyleID;\n}\n\nfunction xlml_prefix_dname(dname) {\n\treturn XLSLblBuiltIn.indexOf(\"_xlnm.\" + dname) > -1 ? \"_xlnm.\" + dname : dname;\n}\n\nfunction xlml_clean_comment(comment/*:any*/) {\n\tcomment.t = comment.v || \"\";\n\tcomment.t = comment.t.replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\n\tcomment.v = comment.w = comment.ixfe = undefined;\n}\n\n/* TODO: Everything */\nfunction parse_xlml_xml(d, _opts)/*:Workbook*/ {\n\tvar opts = _opts || {};\n\tmake_ssf();\n\tvar str = debom(xlml_normalize(d));\n\tif(opts.type == 'binary' || opts.type == 'array' || opts.type == 'base64') {\n\t\tif(typeof $cptable !== 'undefined') str = $cptable.utils.decode(65001, char_codes(str));\n\t\telse str = utf8read(str);\n\t}\n\tvar opening = str.slice(0, 1024).toLowerCase(), ishtml = false;\n\topening = opening.replace(/\".*?\"/g, \"\");\n\tif((opening.indexOf(\">\") & 1023) > Math.min((opening.indexOf(\",\") & 1023), (opening.indexOf(\";\")&1023))) { var _o = dup(opts); _o.type = \"string\"; return PRN.to_workbook(str, _o); }\n\tif(opening.indexOf(\"<?xml\") == -1) [\"html\", \"table\", \"head\", \"meta\", \"script\", \"style\", \"div\"].forEach(function(tag) { if(opening.indexOf(\"<\" + tag) >= 0) ishtml = true; });\n\tif(ishtml) return html_to_workbook(str, opts);\n\n\tXLMLFormatMap = ({\n\t\t\"General Number\": \"General\",\n\t\t\"General Date\": table_fmt[22],\n\t\t\"Long Date\": \"dddd, mmmm dd, yyyy\",\n\t\t\"Medium Date\": table_fmt[15],\n\t\t\"Short Date\": table_fmt[14],\n\t\t\"Long Time\": table_fmt[19],\n\t\t\"Medium Time\": table_fmt[18],\n\t\t\"Short Time\": table_fmt[20],\n\t\t\"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\t\"Fixed\": table_fmt[2],\n\t\t\"Standard\": table_fmt[4],\n\t\t\"Percent\": table_fmt[10],\n\t\t\"Scientific\": table_fmt[11],\n\t\t\"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n\t\t\"True/False\": '\"True\";\"True\";\"False\";@',\n\t\t\"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n\t}/*:any*/);\n\n\n\tvar Rn;\n\tvar state = [], tmp;\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar sheets = {}, sheetnames/*:Array<string>*/ = [], cursheet/*:Worksheet*/ = ({}), sheetname = \"\"; if(opts.dense) cursheet[\"!data\"] = [];\n\tvar cell = ({}/*:any*/), row = {};// eslint-disable-line no-unused-vars\n\tvar dtag = xlml_parsexmltag('<Data ss:Type=\"String\">'), didx = 0;\n\tvar c = 0, r = 0;\n\tvar refguess/*:Range*/ = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\tvar styles = {}, stag = {};\n\tvar ss = \"\", fidx = 0;\n\tvar merges/*:Array<Range>*/ = [];\n\tvar Props = {}, Custprops = {}, pidx = 0, cp = [];\n\tvar comments/*:Array<Comment>*/ = [], comment/*:Comment*/ = ({}/*:any*/);\n\tvar cstys = [], csty, seencol = false;\n\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\tvar rowinfo/*:Array<RowInfo>*/ = [], rowobj = {}, cc = 0, rr = 0;\n\tvar Workbook/*:WBWBProps*/ = ({ Sheets:[], WBProps:{date1904:false} }/*:any*/), wsprops = {};\n\txlmlregex.lastIndex = 0;\n\tstr = str_remove_ng(str, \"<!--\", \"-->\");\n\tvar raw_Rn3 = \"\";\n\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3] = (raw_Rn3 = Rn[3]).toLowerCase())) {\n\t\tcase 'data' /*case 'Data'*/:\n\t\t\tif(raw_Rn3 == \"data\") {\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(state[state.length-1][1]) break;\n\t\t\tif(Rn[1]==='/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length-1][0]==/*\"Comment\"*/\"comment\"?comment:cell, {c:c,r:r}, styles, cstys[c], row, arrayf, opts, Workbook.WBProps.date1904);\n\t\t\telse { ss = \"\"; dtag = xlml_parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\n\t\t\tbreak;\n\t\tcase 'cell' /*case 'Cell'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif(comments.length > 0) cell.c = comments;\n\t\t\t\tif((!opts.sheetRows || opts.sheetRows > r) && cell.v !== void 0) {\n\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\tif(!cursheet[\"!data\"][r]) cursheet[\"!data\"][r] = [];\n\t\t\t\t\t\tcursheet[\"!data\"][r][c] = cell;\n\t\t\t\t\t} else cursheet[encode_col(c) + encode_row(r)] = cell;\n\t\t\t\t}\n\t\t\t\tif(cell.HRef) {\n\t\t\t\t\tcell.l = ({Target:unescapexml(cell.HRef)}/*:any*/);\n\t\t\t\t\tif(cell.HRefScreenTip) cell.l.Tooltip = cell.HRefScreenTip;\n\t\t\t\t\tdelete cell.HRef; delete cell.HRefScreenTip;\n\t\t\t\t}\n\t\t\t\tif(cell.MergeAcross || cell.MergeDown) {\n\t\t\t\t\tcc = c + (parseInt(cell.MergeAcross,10)|0);\n\t\t\t\t\trr = r + (parseInt(cell.MergeDown,10)|0);\n\t\t\t\t\tif(cc > c || rr > r) merges.push({s:{c:c,r:r},e:{c:cc,r:rr}});\n\t\t\t\t}\n\t\t\t\tif(!opts.sheetStubs) { if(cell.MergeAcross) c = cc + 1; else ++c; }\n\t\t\t\telse if(cell.MergeAcross || cell.MergeDown) {\n\t\t\t\t\t/*:: if(!cc) cc = 0; if(!rr) rr = 0; */\n\t\t\t\t\tfor(var cma = c; cma <= cc; ++cma) {\n\t\t\t\t\t\tfor(var cmd = r; cmd <= rr; ++cmd) {\n\t\t\t\t\t\t\tif(cma > c || cmd > r) {\n\t\t\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\t\t\tif(!cursheet[\"!data\"][cmd]) cursheet[\"!data\"][cmd] = [];\n\t\t\t\t\t\t\t\t\tcursheet[\"!data\"][cmd][cma] = {t:'z'};\n\t\t\t\t\t\t\t\t} else cursheet[encode_col(cma) + encode_row(cmd)] = {t:'z'};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tc = cc + 1;\n\t\t\t\t}\n\t\t\t\telse ++c;\n\t\t\t} else {\n\t\t\t\tcell = xlml_parsexmltagobj(Rn[0]);\n\t\t\t\tif(cell.Index) c = +cell.Index - 1;\n\t\t\t\tif(c < refguess.s.c) refguess.s.c = c;\n\t\t\t\tif(c > refguess.e.c) refguess.e.c = c;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") ++c;\n\t\t\t\tcomments = [];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'row' /*case 'Row'*/:\n\t\t\tif(Rn[1]==='/' || Rn[0].slice(-2) === \"/>\") {\n\t\t\t\tif(r < refguess.s.r) refguess.s.r = r;\n\t\t\t\tif(r > refguess.e.r) refguess.e.r = r;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") {\n\t\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\t}\n\t\t\t\tc = 0; ++r;\n\t\t\t} else {\n\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\trowobj = {};\n\t\t\t\tif(row.AutoFitHeight == \"0\" || row.Height) {\n\t\t\t\t\trowobj.hpx = parseInt(row.Height, 10); rowobj.hpt = px2pt(rowobj.hpx);\n\t\t\t\t\trowinfo[r] = rowobj;\n\t\t\t\t}\n\t\t\t\tif(row.Hidden == \"1\") { rowobj.hidden = true; rowinfo[r] = rowobj; }\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'worksheet' /*case 'Worksheet'*/: /* TODO: read range from FullRows/FullColumns */\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t\tsheetnames.push(sheetname);\n\t\t\t\tif(refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) {\n\t\t\t\t\tcursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\tif(opts.sheetRows && opts.sheetRows <= refguess.e.r) {\n\t\t\t\t\t\tcursheet[\"!fullref\"] = cursheet[\"!ref\"];\n\t\t\t\t\t\trefguess.e.r = opts.sheetRows - 1;\n\t\t\t\t\t\tcursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(merges.length) cursheet[\"!merges\"] = merges;\n\t\t\t\tif(cstys.length > 0) cursheet[\"!cols\"] = cstys;\n\t\t\t\tif(rowinfo.length > 0) cursheet[\"!rows\"] = rowinfo;\n\t\t\t\tsheets[sheetname] = cursheet;\n\t\t\t} else {\n\t\t\t\trefguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\t\t\t\tr = c = 0;\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tsheetname = unescapexml(tmp.Name);\n\t\t\t\tcursheet = ({}); if(opts.dense) cursheet[\"!data\"] = [];\n\t\t\t\tmerges = [];\n\t\t\t\tarrayf = [];\n\t\t\t\trowinfo = [];\n\t\t\t\twsprops = {name:sheetname, Hidden:0};\n\t\t\t\tWorkbook.Sheets.push(wsprops);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'table' /*case 'Table'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].slice(-2) == \"/>\") break;\n\t\t\telse {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\tcstys = []; seencol = false;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'style' /*case 'Style'*/:\n\t\t\tif(Rn[1]==='/') process_style_xlml(styles, stag, opts);\n\t\t\telse stag = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\n\t\tcase 'numberformat' /*case 'NumberFormat'*/:\n\t\t\tstag.nf = unescapexml(xlml_parsexmltag(Rn[0]).Format || \"General\");\n\t\t\tif(XLMLFormatMap[stag.nf]) stag.nf = XLMLFormatMap[stag.nf];\n\t\t\tfor(var ssfidx = 0; ssfidx != 0x188; ++ssfidx) if(table_fmt[ssfidx] == stag.nf) break;\n\t\t\tif(ssfidx == 0x188) for(ssfidx = 0x39; ssfidx != 0x188; ++ssfidx) if(table_fmt[ssfidx] == null) { SSF__load(stag.nf, ssfidx); break; }\n\t\t\tbreak;\n\n\t\tcase 'column' /*case 'Column'*/:\n\t\t\tif(state[state.length-1][0] !== /*'Table'*/'table') break;\n\t\t\tif(Rn[1]==='/') break;\n\t\t\tcsty = xlml_parsexmltag(Rn[0]);\n\t\t\tif(csty.Hidden) { csty.hidden = true; delete csty.Hidden; }\n\t\t\tif(csty.Width) csty.wpx = parseInt(csty.Width, 10);\n\t\t\tif(!seencol && csty.wpx > 10) {\n\t\t\t\tseencol = true; MDW = DEF_MDW; //find_mdw_wpx(csty.wpx);\n\t\t\t\tfor(var _col = 0; _col < cstys.length; ++_col) if(cstys[_col]) process_col(cstys[_col]);\n\t\t\t}\n\t\t\tif(seencol) process_col(csty);\n\t\t\tcstys[(csty.Index-1||cstys.length)] = csty;\n\t\t\tfor(var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = dup(csty);\n\t\t\tbreak;\n\n\t\tcase 'namedrange' /*case 'NamedRange'*/:\n\t\t\tif(Rn[1]==='/') break;\n\t\t\tif(!Workbook.Names) Workbook.Names = [];\n\t\t\tvar _NamedRange = parsexmltag(Rn[0]);\n\t\t\tvar _DefinedName/*:DefinedName*/ = ({\n\t\t\t\tName: xlml_prefix_dname(_NamedRange.Name),\n\t\t\t\tRef: rc_to_a1(_NamedRange.RefersTo.slice(1), {r:0, c:0})\n\t\t\t}/*:any*/);\n\t\t\tif(Workbook.Sheets.length>0) _DefinedName.Sheet=Workbook.Sheets.length-1;\n\t\t\t/*:: if(Workbook.Names) */Workbook.Names.push(_DefinedName);\n\t\t\tbreak;\n\n\t\tcase 'namedcell' /*case 'NamedCell'*/: break;\n\t\tcase 'b' /*case 'B'*/: break;\n\t\tcase 'i' /*case 'I'*/: break;\n\t\tcase 'u' /*case 'U'*/: break;\n\t\tcase 's' /*case 'S'*/: break;\n\t\tcase 'em' /*case 'EM'*/: break;\n\t\tcase 'h2' /*case 'H2'*/: break;\n\t\tcase 'h3' /*case 'H3'*/: break;\n\t\tcase 'sub' /*case 'Sub'*/: break;\n\t\tcase 'sup' /*case 'Sup'*/: break;\n\t\tcase 'span' /*case 'Span'*/: break;\n\t\tcase 'alignment' /*case 'Alignment'*/:\n\t\t\tbreak;\n\t\tcase 'borders' /*case 'Borders'*/: break;\n\t\tcase 'border' /*case 'Border'*/: break;\n\t\tcase 'font' /*case 'Font'*/:\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") ss += str.slice(fidx, Rn.index);\n\t\t\telse fidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'interior' /*case 'Interior'*/:\n\t\t\tif(!opts.cellStyles) break;\n\t\t\tstag.Interior = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\t\tcase 'protection' /*case 'Protection'*/: break;\n\n\t\tcase 'author' /*case 'Author'*/:\n\t\tcase 'title' /*case 'Title'*/:\n\t\tcase 'description' /*case 'Description'*/:\n\t\tcase 'created' /*case 'Created'*/:\n\t\tcase 'keywords' /*case 'Keywords'*/:\n\t\tcase 'subject' /*case 'Subject'*/:\n\t\tcase 'category' /*case 'Category'*/:\n\t\tcase 'company' /*case 'Company'*/:\n\t\tcase 'lastauthor' /*case 'LastAuthor'*/:\n\t\tcase 'lastsaved' /*case 'LastSaved'*/:\n\t\tcase 'lastprinted' /*case 'LastPrinted'*/:\n\t\tcase 'version' /*case 'Version'*/:\n\t\tcase 'revision' /*case 'Revision'*/:\n\t\tcase 'totaltime' /*case 'TotalTime'*/:\n\t\tcase 'hyperlinkbase' /*case 'HyperlinkBase'*/:\n\t\tcase 'manager' /*case 'Manager'*/:\n\t\tcase 'contentstatus' /*case 'ContentStatus'*/:\n\t\tcase 'identifier' /*case 'Identifier'*/:\n\t\tcase 'language' /*case 'Language'*/:\n\t\tcase 'appname' /*case 'AppName'*/:\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") xlml_set_prop(Props, raw_Rn3, str.slice(pidx, Rn.index));\n\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'paragraphs' /*case 'Paragraphs'*/: break;\n\n\t\tcase 'styles' /*case 'Styles'*/:\n\t\tcase 'workbook' /*case 'Workbook'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse state.push([Rn[3], false]);\n\t\t\tbreak;\n\n\t\tcase 'comment' /*case 'Comment'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t\txlml_clean_comment(comment);\n\t\t\t\tcomments.push(comment);\n\t\t\t} else {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tif(!parsexmlbool(tmp[\"ShowAlways\"]||\"0\")) comments.hidden = true;\n\t\t\t\tcomment = ({a:tmp.Author}/*:any*/);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'autofilter' /*case 'AutoFilter'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\tvar AutoFilter = xlml_parsexmltag(Rn[0]);\n\t\t\t\tcursheet['!autofilter'] = { ref:rc_to_a1(AutoFilter.Range).replace(/\\$/g,\"\") };\n\t\t\t\tstate.push([Rn[3], true]);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'name' /*case 'Name'*/: break;\n\n\t\tcase 'datavalidation' /*case 'DataValidation'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t} else {\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'pixelsperinch' /*case 'PixelsPerInch'*/:\n\t\t\tbreak;\n\t\tcase 'componentoptions' /*case 'ComponentOptions'*/:\n\t\tcase 'documentproperties' /*case 'DocumentProperties'*/:\n\t\tcase 'customdocumentproperties' /*case 'CustomDocumentProperties'*/:\n\t\tcase 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/:\n\t\tcase 'pivottable' /*case 'PivotTable'*/:\n\t\tcase 'pivotcache' /*case 'PivotCache'*/:\n\t\tcase 'names' /*case 'Names'*/:\n\t\tcase 'mapinfo' /*case 'MapInfo'*/:\n\t\tcase 'pagebreaks' /*case 'PageBreaks'*/:\n\t\tcase 'querytable' /*case 'QueryTable'*/:\n\t\tcase 'sorting' /*case 'Sorting'*/:\n\t\tcase 'schema' /*case 'Schema'*/: //case 'data' /*case 'data'*/:\n\t\tcase 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n\t\tcase 'smarttagtype' /*case 'SmartTagType'*/:\n\t\tcase 'smarttags' /*case 'SmartTags'*/:\n\t\tcase 'excelworkbook' /*case 'ExcelWorkbook'*/:\n\t\tcase 'workbookoptions' /*case 'WorkbookOptions'*/:\n\t\tcase 'worksheetoptions' /*case 'WorksheetOptions'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\tbreak;\n\n\t\tcase 'null' /*case 'Null'*/: break;\n\n\t\tdefault:\n\t\t\t/* FODS file root is <office:document> */\n\t\t\tif(state.length == 0 && Rn[3] == \"document\") return parse_fods(str, opts);\n\t\t\t/* UOS file root is <uof:UOF> */\n\t\t\tif(state.length == 0 && Rn[3] == \"uof\"/*\"UOF\"*/) return parse_fods(str, opts);\n\n\t\t\tvar seen = true;\n\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t/* OfficeDocumentSettings */\n\t\t\t\tcase 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'allowpng' /*case 'AllowPNG'*/: break;\n\t\t\t\t\tcase 'removepersonalinformation' /*case 'RemovePersonalInformation'*/: break;\n\t\t\t\t\tcase 'downloadcomponents' /*case 'DownloadComponents'*/: break;\n\t\t\t\t\tcase 'locationofcomponents' /*case 'LocationOfComponents'*/: break;\n\t\t\t\t\tcase 'colors' /*case 'Colors'*/: break;\n\t\t\t\t\tcase 'color' /*case 'Color'*/: break;\n\t\t\t\t\tcase 'index' /*case 'Index'*/: break;\n\t\t\t\t\tcase 'rgb' /*case 'RGB'*/: break;\n\t\t\t\t\tcase 'targetscreensize' /*case 'TargetScreenSize'*/: break;\n\t\t\t\t\tcase 'readonlyrecommended' /*case 'ReadOnlyRecommended'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ComponentOptions */\n\t\t\t\tcase 'componentoptions' /*case 'ComponentOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'toolbar' /*case 'Toolbar'*/: break;\n\t\t\t\t\tcase 'hideofficelogo' /*case 'HideOfficeLogo'*/: break;\n\t\t\t\t\tcase 'spreadsheetautofit' /*case 'SpreadsheetAutoFit'*/: break;\n\t\t\t\t\tcase 'label' /*case 'Label'*/: break;\n\t\t\t\t\tcase 'caption' /*case 'Caption'*/: break;\n\t\t\t\t\tcase 'maxheight' /*case 'MaxHeight'*/: break;\n\t\t\t\t\tcase 'maxwidth' /*case 'MaxWidth'*/: break;\n\t\t\t\t\tcase 'nextsheetnumber' /*case 'NextSheetNumber'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ExcelWorkbook */\n\t\t\t\tcase 'excelworkbook' /*case 'ExcelWorkbook'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'date1904' /*case 'Date1904'*/:\n\t\t\t\t\t\t/*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n\t\t\t\t\t\tWorkbook.WBProps.date1904 = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'hidehorizontalscrollbar' /*case 'HideHorizontalScrollBar'*/: break;\n\t\t\t\t\tcase 'hideverticalscrollbar' /*case 'HideVerticalScrollBar'*/: break;\n\t\t\t\t\tcase 'hideworkbooktabs' /*case 'HideWorkbookTabs'*/: break;\n\t\t\t\t\tcase 'windowheight' /*case 'WindowHeight'*/: break;\n\t\t\t\t\tcase 'windowwidth' /*case 'WindowWidth'*/: break;\n\t\t\t\t\tcase 'windowtopx' /*case 'WindowTopX'*/: break;\n\t\t\t\t\tcase 'windowtopy' /*case 'WindowTopY'*/: break;\n\t\t\t\t\tcase 'tabratio' /*case 'TabRatio'*/: break;\n\t\t\t\t\tcase 'protectstructure' /*case 'ProtectStructure'*/: break;\n\t\t\t\t\tcase 'protectwindow' /*case 'ProtectWindow'*/: break;\n\t\t\t\t\tcase 'protectwindows' /*case 'ProtectWindows'*/: break;\n\t\t\t\t\tcase 'activesheet' /*case 'ActiveSheet'*/: break;\n\t\t\t\t\tcase 'displayinknotes' /*case 'DisplayInkNotes'*/: break;\n\t\t\t\t\tcase 'firstvisiblesheet' /*case 'FirstVisibleSheet'*/: break;\n\t\t\t\t\tcase 'supbook' /*case 'SupBook'*/: break;\n\t\t\t\t\tcase 'sheetname' /*case 'SheetName'*/: break;\n\t\t\t\t\tcase 'sheetindex' /*case 'SheetIndex'*/: break;\n\t\t\t\t\tcase 'sheetindexfirst' /*case 'SheetIndexFirst'*/: break;\n\t\t\t\t\tcase 'sheetindexlast' /*case 'SheetIndexLast'*/: break;\n\t\t\t\t\tcase 'dll' /*case 'Dll'*/: break;\n\t\t\t\t\tcase 'acceptlabelsinformulas' /*case 'AcceptLabelsInFormulas'*/: break;\n\t\t\t\t\tcase 'donotsavelinkvalues' /*case 'DoNotSaveLinkValues'*/: break;\n\t\t\t\t\tcase 'iteration' /*case 'Iteration'*/: break;\n\t\t\t\t\tcase 'maxiterations' /*case 'MaxIterations'*/: break;\n\t\t\t\t\tcase 'maxchange' /*case 'MaxChange'*/: break;\n\t\t\t\t\tcase 'path' /*case 'Path'*/: break;\n\t\t\t\t\tcase 'xct' /*case 'Xct'*/: break;\n\t\t\t\t\tcase 'count' /*case 'Count'*/: break;\n\t\t\t\t\tcase 'selectedsheets' /*case 'SelectedSheets'*/: break;\n\t\t\t\t\tcase 'calculation' /*case 'Calculation'*/: break;\n\t\t\t\t\tcase 'uncalced' /*case 'Uncalced'*/: break;\n\t\t\t\t\tcase 'startupprompt' /*case 'StartupPrompt'*/: break;\n\t\t\t\t\tcase 'crn' /*case 'Crn'*/: break;\n\t\t\t\t\tcase 'externname' /*case 'ExternName'*/: break;\n\t\t\t\t\tcase 'formula' /*case 'Formula'*/: break;\n\t\t\t\t\tcase 'colfirst' /*case 'ColFirst'*/: break;\n\t\t\t\t\tcase 'collast' /*case 'ColLast'*/: break;\n\t\t\t\t\tcase 'wantadvise' /*case 'WantAdvise'*/: break;\n\t\t\t\t\tcase 'boolean' /*case 'Boolean'*/: break;\n\t\t\t\t\tcase 'error' /*case 'Error'*/: break;\n\t\t\t\t\tcase 'text' /*case 'Text'*/: break;\n\t\t\t\t\tcase 'ole' /*case 'OLE'*/: break;\n\t\t\t\t\tcase 'noautorecover' /*case 'NoAutoRecover'*/: break;\n\t\t\t\t\tcase 'publishobjects' /*case 'PublishObjects'*/: break;\n\t\t\t\t\tcase 'donotcalculatebeforesave' /*case 'DoNotCalculateBeforeSave'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'refmoder1c1' /*case 'RefModeR1C1'*/: break;\n\t\t\t\t\tcase 'embedsavesmarttags' /*case 'EmbedSaveSmartTags'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorkbookOptions */\n\t\t\t\tcase 'workbookoptions' /*case 'WorkbookOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'owcversion' /*case 'OWCVersion'*/: break;\n\t\t\t\t\tcase 'height' /*case 'Height'*/: break;\n\t\t\t\t\tcase 'width' /*case 'Width'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorksheetOptions */\n\t\t\t\tcase 'worksheetoptions' /*case 'WorksheetOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'visible' /*case 'Visible'*/:\n\t\t\t\t\t\tif(Rn[0].slice(-2) === \"/>\"){/* empty */}\n\t\t\t\t\t\telse if(Rn[1]===\"/\") switch(str.slice(pidx, Rn.index)) {\n\t\t\t\t\t\t\tcase \"SheetHidden\": wsprops.Hidden = 1; break;\n\t\t\t\t\t\t\tcase \"SheetVeryHidden\": wsprops.Hidden = 2; break;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'header' /*case 'Header'*/:\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\n\t\t\t\t\t\tif(!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].header = +parsexmltag(Rn[0]).Margin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'footer' /*case 'Footer'*/:\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\n\t\t\t\t\t\tif(!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].footer = +parsexmltag(Rn[0]).Margin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'pagemargins' /*case 'PageMargins'*/:\n\t\t\t\t\t\tvar pagemargins = parsexmltag(Rn[0]);\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={},'xlml');\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Top)) cursheet['!margins'].top = +pagemargins.Top;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Left)) cursheet['!margins'].left = +pagemargins.Left;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Right)) cursheet['!margins'].right = +pagemargins.Right;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Bottom)) cursheet['!margins'].bottom = +pagemargins.Bottom;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'displayrighttoleft' /*case 'DisplayRightToLeft'*/:\n\t\t\t\t\t\tif(!Workbook.Views) Workbook.Views = [];\n\t\t\t\t\t\tif(!Workbook.Views[0]) Workbook.Views[0] = {};\n\t\t\t\t\t\tWorkbook.Views[0].RTL = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'freezepanes' /*case 'FreezePanes'*/: break;\n\t\t\t\t\tcase 'frozennosplit' /*case 'FrozenNoSplit'*/: break;\n\n\t\t\t\t\tcase 'splithorizontal' /*case 'SplitHorizontal'*/:\n\t\t\t\t\tcase 'splitvertical' /*case 'SplitVertical'*/:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'donotdisplaygridlines' /*case 'DoNotDisplayGridlines'*/:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'activerow' /*case 'ActiveRow'*/: break;\n\t\t\t\t\tcase 'activecol' /*case 'ActiveCol'*/: break;\n\t\t\t\t\tcase 'toprowbottompane' /*case 'TopRowBottomPane'*/: break;\n\t\t\t\t\tcase 'leftcolumnrightpane' /*case 'LeftColumnRightPane'*/: break;\n\n\t\t\t\t\tcase 'unsynced' /*case 'Unsynced'*/: break;\n\t\t\t\t\tcase 'print' /*case 'Print'*/: break;\n\t\t\t\t\tcase 'printerrors' /*case 'PrintErrors'*/: break;\n\t\t\t\t\tcase 'panes' /*case 'Panes'*/: break;\n\t\t\t\t\tcase 'scale' /*case 'Scale'*/: break;\n\t\t\t\t\tcase 'pane' /*case 'Pane'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'layout' /*case 'Layout'*/: break;\n\t\t\t\t\tcase 'pagesetup' /*case 'PageSetup'*/: break;\n\t\t\t\t\tcase 'selected' /*case 'Selected'*/: break;\n\t\t\t\t\tcase 'protectobjects' /*case 'ProtectObjects'*/: break;\n\t\t\t\t\tcase 'enableselection' /*case 'EnableSelection'*/: break;\n\t\t\t\t\tcase 'protectscenarios' /*case 'ProtectScenarios'*/: break;\n\t\t\t\t\tcase 'validprinterinfo' /*case 'ValidPrinterInfo'*/: break;\n\t\t\t\t\tcase 'horizontalresolution' /*case 'HorizontalResolution'*/: break;\n\t\t\t\t\tcase 'verticalresolution' /*case 'VerticalResolution'*/: break;\n\t\t\t\t\tcase 'numberofcopies' /*case 'NumberofCopies'*/: break;\n\t\t\t\t\tcase 'activepane' /*case 'ActivePane'*/: break;\n\t\t\t\t\tcase 'toprowvisible' /*case 'TopRowVisible'*/: break;\n\t\t\t\t\tcase 'leftcolumnvisible' /*case 'LeftColumnVisible'*/: break;\n\t\t\t\t\tcase 'fittopage' /*case 'FitToPage'*/: break;\n\t\t\t\t\tcase 'rangeselection' /*case 'RangeSelection'*/: break;\n\t\t\t\t\tcase 'papersizeindex' /*case 'PaperSizeIndex'*/: break;\n\t\t\t\t\tcase 'pagelayoutzoom' /*case 'PageLayoutZoom'*/: break;\n\t\t\t\t\tcase 'pagebreakzoom' /*case 'PageBreakZoom'*/: break;\n\t\t\t\t\tcase 'filteron' /*case 'FilterOn'*/: break;\n\t\t\t\t\tcase 'fitwidth' /*case 'FitWidth'*/: break;\n\t\t\t\t\tcase 'fitheight' /*case 'FitHeight'*/: break;\n\t\t\t\t\tcase 'commentslayout' /*case 'CommentsLayout'*/: break;\n\t\t\t\t\tcase 'zoom' /*case 'Zoom'*/: break;\n\t\t\t\t\tcase 'lefttoright' /*case 'LeftToRight'*/: break;\n\t\t\t\t\tcase 'gridlines' /*case 'Gridlines'*/: break;\n\t\t\t\t\tcase 'allowsort' /*case 'AllowSort'*/: break;\n\t\t\t\t\tcase 'allowfilter' /*case 'AllowFilter'*/: break;\n\t\t\t\t\tcase 'allowinsertrows' /*case 'AllowInsertRows'*/: break;\n\t\t\t\t\tcase 'allowdeleterows' /*case 'AllowDeleteRows'*/: break;\n\t\t\t\t\tcase 'allowinsertcols' /*case 'AllowInsertCols'*/: break;\n\t\t\t\t\tcase 'allowdeletecols' /*case 'AllowDeleteCols'*/: break;\n\t\t\t\t\tcase 'allowinserthyperlinks' /*case 'AllowInsertHyperlinks'*/: break;\n\t\t\t\t\tcase 'allowformatcells' /*case 'AllowFormatCells'*/: break;\n\t\t\t\t\tcase 'allowsizecols' /*case 'AllowSizeCols'*/: break;\n\t\t\t\t\tcase 'allowsizerows' /*case 'AllowSizeRows'*/: break;\n\t\t\t\t\tcase 'nosummaryrowsbelowdetail' /*case 'NoSummaryRowsBelowDetail'*/:\n\t\t\t\t\t\tif(!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n\t\t\t\t\t\tcursheet[\"!outline\"].above = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'tabcolorindex' /*case 'TabColorIndex'*/: break;\n\t\t\t\t\tcase 'donotdisplayheadings' /*case 'DoNotDisplayHeadings'*/: break;\n\t\t\t\t\tcase 'showpagelayoutzoom' /*case 'ShowPageLayoutZoom'*/: break;\n\t\t\t\t\tcase 'nosummarycolumnsrightdetail' /*case 'NoSummaryColumnsRightDetail'*/:\n\t\t\t\t\t\tif(!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n\t\t\t\t\t\tcursheet[\"!outline\"].left = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'blackandwhite' /*case 'BlackAndWhite'*/: break;\n\t\t\t\t\tcase 'donotdisplayzeros' /*case 'DoNotDisplayZeros'*/: break;\n\t\t\t\t\tcase 'displaypagebreak' /*case 'DisplayPageBreak'*/: break;\n\t\t\t\t\tcase 'rowcolheadings' /*case 'RowColHeadings'*/: break;\n\t\t\t\t\tcase 'donotdisplayoutline' /*case 'DoNotDisplayOutline'*/: break;\n\t\t\t\t\tcase 'noorientation' /*case 'NoOrientation'*/: break;\n\t\t\t\t\tcase 'allowusepivottables' /*case 'AllowUsePivotTables'*/: break;\n\t\t\t\t\tcase 'zeroheight' /*case 'ZeroHeight'*/: break;\n\t\t\t\t\tcase 'viewablerange' /*case 'ViewableRange'*/: break;\n\t\t\t\t\tcase 'selection' /*case 'Selection'*/: break;\n\t\t\t\t\tcase 'protectcontents' /*case 'ProtectContents'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PivotTable */\n\t\t\t\tcase 'pivottable' /*case 'PivotTable'*/: case 'pivotcache' /*case 'PivotCache'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'immediateitemsondrop' /*case 'ImmediateItemsOnDrop'*/: break;\n\t\t\t\t\tcase 'showpagemultipleitemlabel' /*case 'ShowPageMultipleItemLabel'*/: break;\n\t\t\t\t\tcase 'compactrowindent' /*case 'CompactRowIndent'*/: break;\n\t\t\t\t\tcase 'location' /*case 'Location'*/: break;\n\t\t\t\t\tcase 'pivotfield' /*case 'PivotField'*/: break;\n\t\t\t\t\tcase 'orientation' /*case 'Orientation'*/: break;\n\t\t\t\t\tcase 'layoutform' /*case 'LayoutForm'*/: break;\n\t\t\t\t\tcase 'layoutsubtotallocation' /*case 'LayoutSubtotalLocation'*/: break;\n\t\t\t\t\tcase 'layoutcompactrow' /*case 'LayoutCompactRow'*/: break;\n\t\t\t\t\tcase 'position' /*case 'Position'*/: break;\n\t\t\t\t\tcase 'pivotitem' /*case 'PivotItem'*/: break;\n\t\t\t\t\tcase 'datatype' /*case 'DataType'*/: break;\n\t\t\t\t\tcase 'datafield' /*case 'DataField'*/: break;\n\t\t\t\t\tcase 'sourcename' /*case 'SourceName'*/: break;\n\t\t\t\t\tcase 'parentfield' /*case 'ParentField'*/: break;\n\t\t\t\t\tcase 'ptlineitems' /*case 'PTLineItems'*/: break;\n\t\t\t\t\tcase 'ptlineitem' /*case 'PTLineItem'*/: break;\n\t\t\t\t\tcase 'countofsameitems' /*case 'CountOfSameItems'*/: break;\n\t\t\t\t\tcase 'item' /*case 'Item'*/: break;\n\t\t\t\t\tcase 'itemtype' /*case 'ItemType'*/: break;\n\t\t\t\t\tcase 'ptsource' /*case 'PTSource'*/: break;\n\t\t\t\t\tcase 'cacheindex' /*case 'CacheIndex'*/: break;\n\t\t\t\t\tcase 'consolidationreference' /*case 'ConsolidationReference'*/: break;\n\t\t\t\t\tcase 'filename' /*case 'FileName'*/: break;\n\t\t\t\t\tcase 'reference' /*case 'Reference'*/: break;\n\t\t\t\t\tcase 'nocolumngrand' /*case 'NoColumnGrand'*/: break;\n\t\t\t\t\tcase 'norowgrand' /*case 'NoRowGrand'*/: break;\n\t\t\t\t\tcase 'blanklineafteritems' /*case 'BlankLineAfterItems'*/: break;\n\t\t\t\t\tcase 'hidden' /*case 'Hidden'*/: break;\n\t\t\t\t\tcase 'subtotal' /*case 'Subtotal'*/: break;\n\t\t\t\t\tcase 'basefield' /*case 'BaseField'*/: break;\n\t\t\t\t\tcase 'mapchilditems' /*case 'MapChildItems'*/: break;\n\t\t\t\t\tcase 'function' /*case 'Function'*/: break;\n\t\t\t\t\tcase 'refreshonfileopen' /*case 'RefreshOnFileOpen'*/: break;\n\t\t\t\t\tcase 'printsettitles' /*case 'PrintSetTitles'*/: break;\n\t\t\t\t\tcase 'mergelabels' /*case 'MergeLabels'*/: break;\n\t\t\t\t\tcase 'defaultversion' /*case 'DefaultVersion'*/: break;\n\t\t\t\t\tcase 'refreshname' /*case 'RefreshName'*/: break;\n\t\t\t\t\tcase 'refreshdate' /*case 'RefreshDate'*/: break;\n\t\t\t\t\tcase 'refreshdatecopy' /*case 'RefreshDateCopy'*/: break;\n\t\t\t\t\tcase 'versionlastrefresh' /*case 'VersionLastRefresh'*/: break;\n\t\t\t\t\tcase 'versionlastupdate' /*case 'VersionLastUpdate'*/: break;\n\t\t\t\t\tcase 'versionupdateablemin' /*case 'VersionUpdateableMin'*/: break;\n\t\t\t\t\tcase 'versionrefreshablemin' /*case 'VersionRefreshableMin'*/: break;\n\t\t\t\t\tcase 'calculation' /*case 'Calculation'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PageBreaks */\n\t\t\t\tcase 'pagebreaks' /*case 'PageBreaks'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'colbreaks' /*case 'ColBreaks'*/: break;\n\t\t\t\t\tcase 'colbreak' /*case 'ColBreak'*/: break;\n\t\t\t\t\tcase 'rowbreaks' /*case 'RowBreaks'*/: break;\n\t\t\t\t\tcase 'rowbreak' /*case 'RowBreak'*/: break;\n\t\t\t\t\tcase 'colstart' /*case 'ColStart'*/: break;\n\t\t\t\t\tcase 'colend' /*case 'ColEnd'*/: break;\n\t\t\t\t\tcase 'rowend' /*case 'RowEnd'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* AutoFilter */\n\t\t\t\tcase 'autofilter' /*case 'AutoFilter'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'autofiltercolumn' /*case 'AutoFilterColumn'*/: break;\n\t\t\t\t\tcase 'autofiltercondition' /*case 'AutoFilterCondition'*/: break;\n\t\t\t\t\tcase 'autofilterand' /*case 'AutoFilterAnd'*/: break;\n\t\t\t\t\tcase 'autofilteror' /*case 'AutoFilterOr'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* QueryTable */\n\t\t\t\tcase 'querytable' /*case 'QueryTable'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'id' /*case 'Id'*/: break;\n\t\t\t\t\tcase 'autoformatfont' /*case 'AutoFormatFont'*/: break;\n\t\t\t\t\tcase 'autoformatpattern' /*case 'AutoFormatPattern'*/: break;\n\t\t\t\t\tcase 'querysource' /*case 'QuerySource'*/: break;\n\t\t\t\t\tcase 'querytype' /*case 'QueryType'*/: break;\n\t\t\t\t\tcase 'enableredirections' /*case 'EnableRedirections'*/: break;\n\t\t\t\t\tcase 'refreshedinxl9' /*case 'RefreshedInXl9'*/: break;\n\t\t\t\t\tcase 'urlstring' /*case 'URLString'*/: break;\n\t\t\t\t\tcase 'htmltables' /*case 'HTMLTables'*/: break;\n\t\t\t\t\tcase 'connection' /*case 'Connection'*/: break;\n\t\t\t\t\tcase 'commandtext' /*case 'CommandText'*/: break;\n\t\t\t\t\tcase 'refreshinfo' /*case 'RefreshInfo'*/: break;\n\t\t\t\t\tcase 'notitles' /*case 'NoTitles'*/: break;\n\t\t\t\t\tcase 'nextid' /*case 'NextId'*/: break;\n\t\t\t\t\tcase 'columninfo' /*case 'ColumnInfo'*/: break;\n\t\t\t\t\tcase 'overwritecells' /*case 'OverwriteCells'*/: break;\n\t\t\t\t\tcase 'donotpromptforfile' /*case 'DoNotPromptForFile'*/: break;\n\t\t\t\t\tcase 'textwizardsettings' /*case 'TextWizardSettings'*/: break;\n\t\t\t\t\tcase 'source' /*case 'Source'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'decimal' /*case 'Decimal'*/: break;\n\t\t\t\t\tcase 'thousandseparator' /*case 'ThousandSeparator'*/: break;\n\t\t\t\t\tcase 'trailingminusnumbers' /*case 'TrailingMinusNumbers'*/: break;\n\t\t\t\t\tcase 'formatsettings' /*case 'FormatSettings'*/: break;\n\t\t\t\t\tcase 'fieldtype' /*case 'FieldType'*/: break;\n\t\t\t\t\tcase 'delimiters' /*case 'Delimiters'*/: break;\n\t\t\t\t\tcase 'tab' /*case 'Tab'*/: break;\n\t\t\t\t\tcase 'comma' /*case 'Comma'*/: break;\n\t\t\t\t\tcase 'autoformatname' /*case 'AutoFormatName'*/: break;\n\t\t\t\t\tcase 'versionlastedit' /*case 'VersionLastEdit'*/: break;\n\t\t\t\t\tcase 'versionlastrefresh' /*case 'VersionLastRefresh'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\tcase 'datavalidation' /*case 'DataValidation'*/:\n\t\t\t\tswitch(Rn[3]) {\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\n\t\t\t\t\tcase 'type' /*case 'Type'*/: break;\n\t\t\t\t\tcase 'min' /*case 'Min'*/: break;\n\t\t\t\t\tcase 'max' /*case 'Max'*/: break;\n\t\t\t\t\tcase 'sort' /*case 'Sort'*/: break;\n\t\t\t\t\tcase 'descending' /*case 'Descending'*/: break;\n\t\t\t\t\tcase 'order' /*case 'Order'*/: break;\n\t\t\t\t\tcase 'casesensitive' /*case 'CaseSensitive'*/: break;\n\t\t\t\t\tcase 'value' /*case 'Value'*/: break;\n\t\t\t\t\tcase 'errorstyle' /*case 'ErrorStyle'*/: break;\n\t\t\t\t\tcase 'errormessage' /*case 'ErrorMessage'*/: break;\n\t\t\t\t\tcase 'errortitle' /*case 'ErrorTitle'*/: break;\n\t\t\t\t\tcase 'inputmessage' /*case 'InputMessage'*/: break;\n\t\t\t\t\tcase 'inputtitle' /*case 'InputTitle'*/: break;\n\t\t\t\t\tcase 'combohide' /*case 'ComboHide'*/: break;\n\t\t\t\t\tcase 'inputhide' /*case 'InputHide'*/: break;\n\t\t\t\t\tcase 'condition' /*case 'Condition'*/: break;\n\t\t\t\t\tcase 'qualifier' /*case 'Qualifier'*/: break;\n\t\t\t\t\tcase 'useblank' /*case 'UseBlank'*/: break;\n\t\t\t\t\tcase 'value1' /*case 'Value1'*/: break;\n\t\t\t\t\tcase 'value2' /*case 'Value2'*/: break;\n\t\t\t\t\tcase 'format' /*case 'Format'*/: break;\n\n\t\t\t\t\tcase 'cellrangelist' /*case 'CellRangeList'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\tcase 'sorting' /*case 'Sorting'*/:\n\t\t\t\tcase 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n\t\t\t\tswitch(Rn[3]) {\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\t\t\t\t\tcase 'type' /*case 'Type'*/: break;\n\t\t\t\t\tcase 'min' /*case 'Min'*/: break;\n\t\t\t\t\tcase 'max' /*case 'Max'*/: break;\n\t\t\t\t\tcase 'sort' /*case 'Sort'*/: break;\n\t\t\t\t\tcase 'descending' /*case 'Descending'*/: break;\n\t\t\t\t\tcase 'order' /*case 'Order'*/: break;\n\t\t\t\t\tcase 'casesensitive' /*case 'CaseSensitive'*/: break;\n\t\t\t\t\tcase 'value' /*case 'Value'*/: break;\n\t\t\t\t\tcase 'errorstyle' /*case 'ErrorStyle'*/: break;\n\t\t\t\t\tcase 'errormessage' /*case 'ErrorMessage'*/: break;\n\t\t\t\t\tcase 'errortitle' /*case 'ErrorTitle'*/: break;\n\t\t\t\t\tcase 'cellrangelist' /*case 'CellRangeList'*/: break;\n\t\t\t\t\tcase 'inputmessage' /*case 'InputMessage'*/: break;\n\t\t\t\t\tcase 'inputtitle' /*case 'InputTitle'*/: break;\n\t\t\t\t\tcase 'combohide' /*case 'ComboHide'*/: break;\n\t\t\t\t\tcase 'inputhide' /*case 'InputHide'*/: break;\n\t\t\t\t\tcase 'condition' /*case 'Condition'*/: break;\n\t\t\t\t\tcase 'qualifier' /*case 'Qualifier'*/: break;\n\t\t\t\t\tcase 'useblank' /*case 'UseBlank'*/: break;\n\t\t\t\t\tcase 'value1' /*case 'Value1'*/: break;\n\t\t\t\t\tcase 'value2' /*case 'Value2'*/: break;\n\t\t\t\t\tcase 'format' /*case 'Format'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* MapInfo (schema) */\n\t\t\t\tcase 'mapinfo' /*case 'MapInfo'*/: case 'schema' /*case 'Schema'*/: case 'data' /*case 'data'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'map' /*case 'Map'*/: break;\n\t\t\t\t\tcase 'entry' /*case 'Entry'*/: break;\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\t\t\t\t\tcase 'xpath' /*case 'XPath'*/: break;\n\t\t\t\t\tcase 'field' /*case 'Field'*/: break;\n\t\t\t\t\tcase 'xsdtype' /*case 'XSDType'*/: break;\n\t\t\t\t\tcase 'filteron' /*case 'FilterOn'*/: break;\n\t\t\t\t\tcase 'aggregate' /*case 'Aggregate'*/: break;\n\t\t\t\t\tcase 'elementtype' /*case 'ElementType'*/: break;\n\t\t\t\t\tcase 'attributetype' /*case 'AttributeType'*/: break;\n\t\t\t\t/* These are from xsd (XML Schema Definition) */\n\t\t\t\t\tcase 'schema' /*case 'schema'*/:\n\t\t\t\t\tcase 'element' /*case 'element'*/:\n\t\t\t\t\tcase 'complextype' /*case 'complexType'*/:\n\t\t\t\t\tcase 'datatype' /*case 'datatype'*/:\n\t\t\t\t\tcase 'all' /*case 'all'*/:\n\t\t\t\t\tcase 'attribute' /*case 'attribute'*/:\n\t\t\t\t\tcase 'extends' /*case 'extends'*/: break;\n\n\t\t\t\t\tcase 'row' /*case 'row'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* SmartTags (can be anything) */\n\t\t\t\tcase 'smarttags' /*case 'SmartTags'*/: break;\n\n\t\t\t\tdefault: seen = false; break;\n\t\t\t}\n\t\t\tif(seen) break;\n\t\t\t/* CustomDocumentProperties */\n\t\t\tif(Rn[3].match(/!\\[CDATA/)) break;\n\t\t\tif(!state[state.length-1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t\t\tif(state[state.length-1][0]===/*'CustomDocumentProperties'*/'customdocumentproperties') {\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") xlml_set_custprop(Custprops, raw_Rn3, cp, str.slice(pidx, Rn.index));\n\t\t\t\telse { cp = Rn; pidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t}\n\tvar out = ({}/*:any*/);\n\tif(!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n\tout.SheetNames = sheetnames;\n\tout.Workbook = Workbook;\n\tout.SSF = dup(table_fmt);\n\tout.Props = Props;\n\tout.Custprops = Custprops;\n\tout.bookType = \"xlml\";\n\treturn out;\n}\n\nfunction parse_xlml(data/*:RawBytes|string*/, opts)/*:Workbook*/ {\n\tfix_read_opts(opts=opts||{});\n\tswitch(opts.type||\"base64\") {\n\t\tcase \"base64\": return parse_xlml_xml(Base64_decode(data), opts);\n\t\tcase \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\n\t\tcase \"array\": return parse_xlml_xml(a2s(data), opts);\n\t}\n\t/*:: throw new Error(\"unsupported type \" + opts.type); */\n}\n\n/* TODO */\nfunction write_props_xlml(wb/*:Workbook*/, opts)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\t/* DocumentProperties */\n\tif(wb.Props) o.push(xlml_write_docprops(wb.Props, opts));\n\t/* CustomDocumentProperties */\n\tif(wb.Custprops) o.push(xlml_write_custprops(wb.Props, wb.Custprops, opts));\n\treturn o.join(\"\");\n}\n/* TODO */\nfunction write_wb_xlml(wb/*::, opts*/)/*:string*/ {\n\t/* OfficeDocumentSettings */\n\t/* ExcelWorkbook */\n\tif((((wb||{}).Workbook||{}).WBProps||{}).date1904) return '<ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\"><Date1904/></ExcelWorkbook>';\n\treturn \"\";\n}\n/* TODO */\nfunction write_sty_xlml(wb, opts)/*:string*/ {\n\t/* Styles */\n\tvar styles/*:Array<string>*/ = ['<Style ss:ID=\"Default\" ss:Name=\"Normal\"><NumberFormat/></Style>'];\n\topts.cellXfs.forEach(function(xf, id) {\n\t\tvar payload/*:Array<string>*/ = [];\n\t\tpayload.push(writextag('NumberFormat', null, {\"ss:Format\": escapexml(table_fmt[xf.numFmtId])}));\n\n\t\tvar o = /*::(*/{\"ss:ID\": \"s\" + (21+id)}/*:: :any)*/;\n\t\tstyles.push(writextag('Style', payload.join(\"\"), o));\n\t});\n\treturn writextag(\"Styles\", styles.join(\"\"));\n}\nfunction write_name_xlml(n) { return writextag(\"NamedRange\", null, {\"ss:Name\": n.Name.slice(0,6) == \"_xlnm.\" ? n.Name.slice(6) : n.Name, \"ss:RefersTo\":\"=\" + a1_to_rc(n.Ref, {r:0,c:0})}); }\nfunction write_names_xlml(wb/*::, opts*/)/*:string*/ {\n\tif(!((wb||{}).Workbook||{}).Names) return \"\";\n\t/*:: if(!wb || !wb.Workbook || !wb.Workbook.Names) throw new Error(\"unreachable\"); */\n\tvar names/*:Array<any>*/ = wb.Workbook.Names;\n\tvar out/*:Array<string>*/ = [];\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar n = names[i];\n\t\tif(n.Sheet != null) continue;\n\t\tif(n.Name.match(/^_xlfn\\./)) continue;\n\t\tout.push(write_name_xlml(n));\n\t}\n\treturn writextag(\"Names\", out.join(\"\"));\n}\nfunction write_ws_xlml_names(ws/*:Worksheet*/, opts, idx/*:number*/, wb/*:Workbook*/)/*:string*/ {\n\tif(!ws) return \"\";\n\tif(!((wb||{}).Workbook||{}).Names) return \"\";\n\t/*:: if(!wb || !wb.Workbook || !wb.Workbook.Names) throw new Error(\"unreachable\"); */\n\tvar names/*:Array<any>*/ = wb.Workbook.Names;\n\tvar out/*:Array<string>*/ = [];\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar n = names[i];\n\t\tif(n.Sheet != idx) continue;\n\t\t/*switch(n.Name) {\n\t\t\tcase \"_\": continue;\n\t\t}*/\n\t\tif(n.Name.match(/^_xlfn\\./)) continue;\n\t\tout.push(write_name_xlml(n));\n\t}\n\treturn out.join(\"\");\n}\n/* WorksheetOptions */\nfunction write_ws_xlml_wsopts(ws/*:Worksheet*/, opts, idx/*:number*/, wb/*:Workbook*/)/*:string*/ {\n\tif(!ws) return \"\";\n\tvar o/*:Array<string>*/ = [];\n\t/* NOTE: spec technically allows any order, but stick with implied order */\n\n\t/* FitToPage */\n\t/* DoNotDisplayColHeaders */\n\t/* DoNotDisplayRowHeaders */\n\t/* ViewableRange */\n\t/* Selection */\n\t/* GridlineColor */\n\t/* Name */\n\t/* ExcelWorksheetType */\n\t/* IntlMacro */\n\t/* Unsynced */\n\t/* Selected */\n\t/* CodeName */\n\n\tif(ws['!margins']) {\n\t\to.push(\"<PageSetup>\");\n\t\tif(ws['!margins'].header) o.push(writextag(\"Header\", null, {'x:Margin':ws['!margins'].header}));\n\t\tif(ws['!margins'].footer) o.push(writextag(\"Footer\", null, {'x:Margin':ws['!margins'].footer}));\n\t\to.push(writextag(\"PageMargins\", null, {\n\t\t\t'x:Bottom': ws['!margins'].bottom || \"0.75\",\n\t\t\t'x:Left': ws['!margins'].left || \"0.7\",\n\t\t\t'x:Right': ws['!margins'].right || \"0.7\",\n\t\t\t'x:Top': ws['!margins'].top || \"0.75\"\n\t\t}));\n\t\to.push(\"</PageSetup>\");\n\t}\n\n\t/* PageSetup */\n\t/* DisplayPageBreak */\n\t/* TransitionExpressionEvaluation */\n\t/* TransitionFormulaEntry */\n\t/* Print */\n\t/* Zoom */\n\t/* PageLayoutZoom */\n\t/* PageBreakZoom */\n\t/* ShowPageBreakZoom */\n\t/* DefaultRowHeight */\n\t/* DefaultColumnWidth */\n\t/* StandardWidth */\n\n\tif(wb && wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx]) {\n\t\t/* Visible */\n\t\tif(wb.Workbook.Sheets[idx].Hidden) o.push(writextag(\"Visible\", (wb.Workbook.Sheets[idx].Hidden == 1 ? \"SheetHidden\" : \"SheetVeryHidden\"), {}));\n\t\telse {\n\t\t\t/* Selected */\n\t\t\tfor(var i = 0; i < idx; ++i) if(wb.Workbook.Sheets[i] && !wb.Workbook.Sheets[i].Hidden) break;\n\t\t\tif(i == idx) o.push(\"<Selected/>\");\n\t\t}\n\t}\n\n\t/* LeftColumnVisible */\n\n\tif(((((wb||{}).Workbook||{}).Views||[])[0]||{}).RTL) o.push(\"<DisplayRightToLeft/>\");\n\n\t/* GridlineColorIndex */\n\t/* DisplayFormulas */\n\t/* DoNotDisplayGridlines */\n\t/* DoNotDisplayHeadings */\n\t/* DoNotDisplayOutline */\n\t/* ApplyAutomaticOutlineStyles */\n\t/* NoSummaryRowsBelowDetail */\n\t/* NoSummaryColumnsRightDetail */\n\t/* DoNotDisplayZeros */\n\t/* ActiveRow */\n\t/* ActiveColumn */\n\t/* FilterOn */\n\t/* RangeSelection */\n\t/* TopRowVisible */\n\t/* TopRowBottomPane */\n\t/* LeftColumnRightPane */\n\t/* ActivePane */\n\t/* SplitHorizontal */\n\t/* SplitVertical */\n\t/* FreezePanes */\n\t/* FrozenNoSplit */\n\t/* TabColorIndex */\n\t/* Panes */\n\n\t/* NOTE: Password not supported in XLML Format */\n\tif(ws['!protect']) {\n\t\to.push(writetag(\"ProtectContents\", \"True\"));\n\t\tif(ws['!protect'].objects) o.push(writetag(\"ProtectObjects\", \"True\"));\n\t\tif(ws['!protect'].scenarios) o.push(writetag(\"ProtectScenarios\", \"True\"));\n\t\tif(ws['!protect'].selectLockedCells != null && !ws['!protect'].selectLockedCells) o.push(writetag(\"EnableSelection\", \"NoSelection\"));\n\t\telse if(ws['!protect'].selectUnlockedCells != null && !ws['!protect'].selectUnlockedCells) o.push(writetag(\"EnableSelection\", \"UnlockedCells\"));\n\t[\n\t\t[ \"formatCells\", \"AllowFormatCells\" ],\n\t\t[ \"formatColumns\", \"AllowSizeCols\" ],\n\t\t[ \"formatRows\", \"AllowSizeRows\" ],\n\t\t[ \"insertColumns\", \"AllowInsertCols\" ],\n\t\t[ \"insertRows\", \"AllowInsertRows\" ],\n\t\t[ \"insertHyperlinks\", \"AllowInsertHyperlinks\" ],\n\t\t[ \"deleteColumns\", \"AllowDeleteCols\" ],\n\t\t[ \"deleteRows\", \"AllowDeleteRows\" ],\n\t\t[ \"sort\", \"AllowSort\" ],\n\t\t[ \"autoFilter\", \"AllowFilter\" ],\n\t\t[ \"pivotTables\", \"AllowUsePivotTables\" ]\n\t].forEach(function(x) { if(ws['!protect'][x[0]]) o.push(\"<\"+x[1]+\"/>\"); });\n\t}\n\n\tif(o.length == 0) return \"\";\n\treturn writextag(\"WorksheetOptions\", o.join(\"\"), {xmlns:XLMLNS.x});\n}\nfunction write_ws_xlml_comment(comments/*:Array<any>*/)/*:string*/ {\n\t/* TODO: test multiple comments */\n\treturn comments.map(function(c) {\n\t\t// TODO: formatted text\n\t\tvar t = xlml_unfixstr(c.t||\"\");\n\t\tvar d =writextag(\"ss:Data\", t, {\"xmlns\":\"http://www.w3.org/TR/REC-html40\"});\n\t\tvar p = {};\n\t\tif(c.a) p[\"ss:Author\"] = c.a;\n\t\tif(!comments.hidden) p[\"ss:ShowAlways\"] = \"1\";\n\t\treturn writextag(\"Comment\", d, p);\n\t}).join(\"\");\n}\nfunction write_ws_xlml_cell(cell, ref/*:string*/, ws, opts, idx/*:number*/, wb, addr)/*:string*/{\n\tif(!cell || (cell.v == undefined && cell.f == undefined)) return \"\";\n\n\tvar attr = {};\n\tif(cell.f) attr[\"ss:Formula\"] = \"=\" + escapexml(a1_to_rc(cell.f, addr));\n\tif(cell.F && cell.F.slice(0, ref.length) == ref) {\n\t\tvar end = decode_cell(cell.F.slice(ref.length + 1));\n\t\tattr[\"ss:ArrayRange\"] = \"RC:R\" + (end.r == addr.r ? \"\" : \"[\" + (end.r - addr.r) + \"]\") + \"C\" + (end.c == addr.c ? \"\" : \"[\" + (end.c - addr.c) + \"]\");\n\t}\n\n\tif(cell.l && cell.l.Target) {\n\t\tattr[\"ss:HRef\"] = escapexml(cell.l.Target);\n\t\tif(cell.l.Tooltip) attr[\"x:HRefScreenTip\"] = escapexml(cell.l.Tooltip);\n\t}\n\n\tif(ws['!merges']) {\n\t\tvar marr = ws['!merges'];\n\t\tfor(var mi = 0; mi != marr.length; ++mi) {\n\t\t\tif(marr[mi].s.c != addr.c || marr[mi].s.r != addr.r) continue;\n\t\t\tif(marr[mi].e.c > marr[mi].s.c) attr['ss:MergeAcross'] = marr[mi].e.c - marr[mi].s.c;\n\t\t\tif(marr[mi].e.r > marr[mi].s.r) attr['ss:MergeDown'] = marr[mi].e.r - marr[mi].s.r;\n\t\t}\n\t}\n\n\tvar t = \"\", p = \"\";\n\tswitch(cell.t) {\n\t\tcase 'z': if(!opts.sheetStubs) return \"\"; break;\n\t\tcase 'n': {\n\t\t\tif(!isFinite(cell.v)) {\n\t\t\t\tt = 'Error'; p = BErr[isNaN(cell.v) ? 0x24 : 0x07];\n\t\t\t} else {\n\t\t\t\tt = 'Number'; p = String(cell.v);\n\t\t\t}\n\t\t} break;\n\t\tcase 'b': t = 'Boolean'; p = (cell.v ? \"1\" : \"0\"); break;\n\t\tcase 'e': t = 'Error'; p = BErr[cell.v]; break;\n\t\tcase 'd': t = 'DateTime'; p = new Date(cell.v).toISOString(); if(cell.z == null) cell.z = cell.z || table_fmt[14]; break;\n\t\tcase 's': t = 'String'; p = escapexlml(cell.v||\"\"); break;\n\t}\n\t/* TODO: cell style */\n\tvar os = get_cell_style(opts.cellXfs, cell, opts);\n\tattr[\"ss:StyleID\"] = \"s\" + (21+os);\n\tattr[\"ss:Index\"] = addr.c + 1;\n\tvar _v = (cell.v != null ? p : \"\");\n\tvar m = cell.t == 'z' ? \"\" : ('<Data ss:Type=\"' + t + '\">' + _v + '</Data>');\n\n\tif((cell.c||[]).length > 0) m += write_ws_xlml_comment(cell.c);\n\n\treturn writextag(\"Cell\", m, attr);\n}\nfunction write_ws_xlml_row(R/*:number*/, row)/*:string*/ {\n\tvar o = '<Row ss:Index=\"' + (R+1) + '\"';\n\tif(row) {\n\t\tif(row.hpt && !row.hpx) row.hpx = pt2px(row.hpt);\n\t\tif(row.hpx) o += ' ss:AutoFitHeight=\"0\" ss:Height=\"' + row.hpx + '\"';\n\t\tif(row.hidden) o += ' ss:Hidden=\"1\"';\n\t}\n\treturn o + '>';\n}\n/* TODO */\nfunction write_ws_xlml_table(ws/*:Worksheet*/, opts, idx/*:number*/, wb/*:Workbook*/)/*:string*/ {\n\tif(!ws['!ref']) return \"\";\n\tvar range/*:Range*/ = safe_decode_range(ws['!ref']);\n\tvar marr/*:Array<Range>*/ = ws['!merges'] || [], mi = 0;\n\tvar o/*:Array<string>*/ = [];\n\tif(ws['!cols']) ws['!cols'].forEach(function(n, i) {\n\t\tprocess_col(n);\n\t\tvar w = !!n.width;\n\t\tvar p = col_obj_w(i, n);\n\t\tvar k/*:any*/ = {\"ss:Index\":i+1};\n\t\tif(w) k['ss:Width'] = width2px(p.width);\n\t\tif(n.hidden) k['ss:Hidden']=\"1\";\n\t\to.push(writextag(\"Column\",null,k));\n\t});\n\tvar dense = ws[\"!data\"] != null;\n\tvar addr = {r:0,c:0};\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\tvar row = [write_ws_xlml_row(R, (ws['!rows']||[])[R])];\n\t\taddr.r = R;\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\taddr.c = C;\n\t\t\tvar skip = false;\n\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(skip) continue;\n\t\t\tvar ref = encode_col(C) + encode_row(R), cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[ref];\n\t\t\trow.push(write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr));\n\t\t}\n\t\trow.push(\"</Row>\");\n\t\tif(row.length > 2) o.push(row.join(\"\"));\n\t}\n\treturn o.join(\"\");\n}\nfunction write_ws_xlml(idx/*:number*/, opts, wb/*:Workbook*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tvar s = wb.SheetNames[idx];\n\tvar ws = wb.Sheets[s];\n\n\tvar t/*:string*/ = ws ? write_ws_xlml_names(ws, opts, idx, wb) : \"\";\n\tif(t.length > 0) o.push(\"<Names>\" + t + \"</Names>\");\n\n\t/* Table */\n\tt = ws ? write_ws_xlml_table(ws, opts, idx, wb) : \"\";\n\tif(t.length > 0) o.push(\"<Table>\" + t + \"</Table>\");\n\n\t/* WorksheetOptions */\n\to.push(write_ws_xlml_wsopts(ws, opts, idx, wb));\n\n\tif(ws && ws[\"!autofilter\"]) o.push('<AutoFilter x:Range=\"' + a1_to_rc(fix_range(ws[\"!autofilter\"].ref), {r:0,c:0}) + '\" xmlns=\"urn:schemas-microsoft-com:office:excel\"></AutoFilter>');\n\n\treturn o.join(\"\");\n}\nfunction write_xlml(wb, opts)/*:string*/ {\n\tif(!opts) opts = {};\n\tif(!wb.SSF) wb.SSF = dup(table_fmt);\n\tif(wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t\topts.cellXfs = [];\n\t\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\t}\n\tvar d/*:Array<string>*/ = [];\n\td.push(write_props_xlml(wb, opts));\n\td.push(write_wb_xlml(wb, opts));\n\td.push(\"\");\n\td.push(write_names_xlml(wb, opts));\n\tfor(var i = 0; i < wb.SheetNames.length; ++i)\n\t\td.push(writextag(\"Worksheet\", write_ws_xlml(i, opts, wb), {\"ss:Name\":escapexml(wb.SheetNames[i])}));\n\td[2] = write_sty_xlml(wb, opts);\n\treturn XML_HEADER + writextag(\"Workbook\", d.join(\"\"), {\n\t\t'xmlns':      XLMLNS.ss,\n\t\t'xmlns:o':    XLMLNS.o,\n\t\t'xmlns:x':    XLMLNS.x,\n\t\t'xmlns:ss':   XLMLNS.ss,\n\t\t'xmlns:dt':   XLMLNS.dt,\n\t\t'xmlns:html': XLMLNS.html\n\t});\n}\n/* [MS-OLEDS] 2.3.8 CompObjStream */\nfunction parse_compobj(obj/*:CFBEntry*/) {\n\tvar v = {};\n\tvar o = obj.content;\n\t/*:: if(o == null) return; */\n\n\t/* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\to.l = 28;\n\n\tv.AnsiUserType = o.read_shift(0, \"lpstr-ansi\");\n\tv.AnsiClipboardFormat = parse_ClipboardFormatOrAnsiString(o);\n\n\tif(o.length - o.l <= 4) return v;\n\n\tvar m/*:number*/ = o.read_shift(4);\n\tif(m == 0 || m > 40) return v;\n\to.l-=4; v.Reserved1 = o.read_shift(0, \"lpstr-ansi\");\n\n\tif(o.length - o.l <= 4) return v;\n\tm = o.read_shift(4);\n\tif(m !== 0x71b239f4) return v;\n\tv.UnicodeClipboardFormat = parse_ClipboardFormatOrUnicodeString(o);\n\n\tm = o.read_shift(4);\n\tif(m == 0 || m > 40) return v;\n\to.l-=4; v.Reserved2 = o.read_shift(0, \"lpwstr\");\n}\n\n/*\n\tContinue logic for:\n\t- 2.4.58 Continue          0x003c\n\t- 2.4.59 ContinueBigName   0x043c\n\t- 2.4.60 ContinueFrt       0x0812\n\t- 2.4.61 ContinueFrt11     0x0875\n\t- 2.4.62 ContinueFrt12     0x087f\n*/\nvar CONTINUE_RT = [ 0x003c, 0x043c, 0x0812, 0x0875, 0x087f ];\nfunction slurp(RecordType, R, blob, length/*:number*/, opts)/*:any*/ {\n\tvar l = length;\n\tvar bufs = [];\n\tvar d = blob.slice(blob.l,blob.l+l);\n\tif(opts && opts.enc && opts.enc.insitu && d.length > 0) switch(RecordType) {\n\tcase 0x0009: case 0x0209: case 0x0409: case 0x0809/* BOF */: case 0x002F /* FilePass */: case 0x0195 /* FileLock */: case 0x00E1 /* InterfaceHdr */: case 0x0196 /* RRDInfo */: case 0x0138 /* RRDHead */: case 0x0194 /* UsrExcl */: case 0x000a /* EOF */:\n\t\tbreak;\n\tcase 0x0085 /* BoundSheet8 */:\n\t\tbreak;\n\tdefault:\n\t\topts.enc.insitu(d);\n\t}\n\tbufs.push(d);\n\tblob.l += l;\n\tvar nextrt = __readUInt16LE(blob,blob.l), next = XLSRecordEnum[nextrt];\n\tvar start = 0;\n\twhile(next != null && CONTINUE_RT.indexOf(nextrt) > -1) {\n\t\tl = __readUInt16LE(blob,blob.l+2);\n\t\tstart = blob.l + 4;\n\t\tif(nextrt == 0x0812 /* ContinueFrt */) start += 4;\n\t\telse if(nextrt == 0x0875 || nextrt == 0x087f) {\n\t\t\tstart += 12;\n\t\t}\n\t\td = blob.slice(start,blob.l+4+l);\n\t\tbufs.push(d);\n\t\tblob.l += 4+l;\n\t\tnext = (XLSRecordEnum[nextrt = __readUInt16LE(blob, blob.l)]);\n\t}\n\tvar b = (bconcat(bufs)/*:any*/);\n\tprep_blob(b, 0);\n\tvar ll = 0; b.lens = [];\n\tfor(var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\n\tif(b.length < length) throw \"XLS Record 0x\" + RecordType.toString(16) + \" Truncated: \" + b.length + \" < \" + length;\n\treturn R.f(b, b.length, opts);\n}\n\nfunction safe_format_xf(p/*:any*/, opts/*:ParseOpts*/, date1904/*:?boolean*/) {\n\tif(p.t === 'z') return;\n\tif(!p.XF) return;\n\tvar fmtid = 0;\n\ttry {\n\t\tfmtid = p.z || p.XF.numFmtId || 0;\n\t\tif(opts.cellNF && p.z == null) p.z = table_fmt[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(!opts || opts.cellText !== false) try {\n\t\tif(p.t === 'e') { p.w = p.w || BErr[p.v]; }\n\t\telse if(fmtid === 0 || fmtid == \"General\") {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = p.v.toString(10);\n\t\t\t\telse p.w = SSF_general_num(p.v);\n\t\t\t}\n\t\t\telse p.w = SSF_general(p.v);\n\t\t}\n\t\telse p.w = SSF_format(fmtid,p.v, {date1904:!!date1904, dateNF: opts && opts.dateNF});\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(opts.cellDates && fmtid && p.t == 'n' && fmt_is_date(table_fmt[fmtid] || String(fmtid))) {\n\t\tvar _d = SSF_parse_date_code(p.v + (date1904 ? 1462 : 0)); if(_d) { p.t = 'd'; p.v = new Date(Date.UTC(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u)); }\n\t}\n}\n\nfunction make_cell(val, ixfe, t)/*:Cell*/ {\n\treturn ({v:val, ixfe:ixfe, t:t}/*:any*/);\n}\n\n// 2.3.2\nfunction parse_workbook(blob, options/*:ParseOpts*/)/*:Workbook*/ {\n\tvar wb = ({opts:{}}/*:any*/);\n\tvar Sheets = {};\n\tif(DENSE != null && options.dense == null) options.dense = DENSE;\n\tvar out/*:Worksheet*/ = ({}/*:any*/); if(options.dense) out[\"!data\"] = [];\n\tvar Directory = {};\n\tvar range/*:Range*/ = ({}/*:any*/);\n\tvar last_formula = null;\n\tvar sst/*:SST*/ = ([]/*:any*/);\n\tvar cur_sheet = \"\";\n\tvar Preamble = {};\n\tvar lastcell, last_cell = \"\", cc/*:Cell*/, cmnt, rngC, rngR;\n\tvar sharedf = {};\n\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\tvar temp_val/*:Cell*/;\n\tvar country;\n\tvar XFs = []; /* XF records */\n\tvar palette/*:Array<[number, number, number]>*/ = [];\n\tvar Workbook/*:WBWBProps*/ = ({ Sheets:[], WBProps:{date1904:false}, Views:[{}] }/*:any*/), wsprops = {};\n\tvar biff4w = false;\n\tvar get_rgb = function getrgb(icv/*:number*/)/*:[number, number, number]*/ {\n\t\tif(icv < 8) return XLSIcv[icv];\n\t\tif(icv < 64) return palette[icv-8] || XLSIcv[icv];\n\t\treturn XLSIcv[icv];\n\t};\n\tvar process_cell_style = function pcs(line/*:any*/, options) {\n\t\tvar xfd = line.XF.data;\n\t\tif(!xfd || !xfd.patternType || !options || !options.cellStyles) return;\n\t\tline.s = ({}/*:any*/);\n\t\tline.s.patternType = xfd.patternType;\n\t\tvar t;\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = {rgb:t}; }\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = {rgb:t}; }\n\t};\n\tvar addcell = function addcell(cell/*:any*/, line/*:any*/, options/*:any*/) {\n\t\tif(!biff4w && file_depth > 1) return;\n\t\tif(options.sheetRows && cell.r >= options.sheetRows) return;\n\t\tif(options.cellStyles && line.XF && line.XF.data) process_cell_style(line, options);\n\t\tdelete line.ixfe; delete line.XF;\n\t\tlastcell = cell;\n\t\tlast_cell = encode_cell(cell);\n\t\tif(!range || !range.s || !range.e) range = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\tif(cell.r < range.s.r) range.s.r = cell.r;\n\t\tif(cell.c < range.s.c) range.s.c = cell.c;\n\t\tif(cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n\t\tif(cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n\t\tif(options.cellFormula && line.f) {\n\t\t\tfor(var afi = 0; afi < arrayf.length; ++afi) {\n\t\t\t\tif(arrayf[afi][0].s.c > cell.c || arrayf[afi][0].s.r > cell.r) continue;\n\t\t\t\tif(arrayf[afi][0].e.c < cell.c || arrayf[afi][0].e.r < cell.r) continue;\n\t\t\t\tline.F = encode_range(arrayf[afi][0]);\n\t\t\t\tif(arrayf[afi][0].s.c != cell.c || arrayf[afi][0].s.r != cell.r) delete line.f;\n\t\t\t\tif(line.f) line.f = \"\" + stringify_formula(arrayf[afi][1], range, cell, supbooks, opts);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t{\n\t\t\tif(options.dense) {\n\t\t\t\tif(!out[\"!data\"][cell.r]) out[\"!data\"][cell.r] = [];\n\t\t\t\tout[\"!data\"][cell.r][cell.c] = line;\n\t\t\t} else out[last_cell] = line;\n\t\t}\n\t};\n\tvar opts = ({\n\t\tenc: false, // encrypted\n\t\tsbcch: 0, // cch in the preceding SupBook\n\t\tsnames: [], // sheetnames\n\t\tsharedf: sharedf, // shared formulae by address\n\t\tarrayf: arrayf, // array formulae array\n\t\trrtabid: [], // RRTabId\n\t\tlastuser: \"\", // Last User from WriteAccess\n\t\tbiff: 8, // BIFF version\n\t\tcodepage: 0, // CP from CodePage record\n\t\twinlocked: 0, // fLockWn from WinProtect\n\t\tcellStyles: !!options && !!options.cellStyles,\n\t\tWTF: !!options && !!options.wtf\n\t}/*:any*/);\n\tif(options.password) opts.password = options.password;\n\tvar themes;\n\tvar merges/*:Array<Range>*/ = [];\n\tvar objects = [];\n\tvar colinfo/*:Array<ColInfo>*/ = [], rowinfo/*:Array<RowInfo>*/ = [];\n\tvar seencol = false;\n\tvar supbooks = ([]/*:any*/); // 1-indexed, will hold extern names\n\tsupbooks.SheetNames = opts.snames;\n\tsupbooks.sharedf = opts.sharedf;\n\tsupbooks.arrayf = opts.arrayf;\n\tsupbooks.names = [];\n\tsupbooks.XTI = [];\n\tvar last_RT = 0;\n\tvar file_depth = 0; /* TODO: make a real stack */\n\tvar BIFF2Fmt = 0, BIFF2FmtTable/*:Array<string>*/ = [];\n\tvar FilterDatabases = []; /* TODO: sort out supbooks and process elsewhere */\n\tvar last_lbl/*:?DefinedName*/;\n\n\t/* explicit override for some broken writers */\n\topts.codepage = 1200;\n\tset_cp(1200);\n\tvar seen_codepage = false;\n\twhile(blob.l < blob.length - 1) {\n\t\tvar s = blob.l;\n\t\tvar RecordType = blob.read_shift(2);\n\t\tif(RecordType === 0 && last_RT === 0x000a /* EOF */) break;\n\t\tvar length = (blob.l === blob.length ? 0 : blob.read_shift(2));\n\t\tvar R = XLSRecordEnum[RecordType];\n\t\tif(file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(RecordType) == -1 /* BOF */) break;\n\t\t//console.log(RecordType.toString(16), RecordType, R, blob.l, length, blob.length);\n\t\t//if(!R) console.log(blob.slice(blob.l, blob.l + length));\n\t\tif(R && R.f) {\n\t\t\tif(options.bookSheets) {\n\t\t\t\tif(last_RT === 0x0085 /* BoundSheet8 */ && RecordType !== 0x0085 /* R.n !== 'BoundSheet8' */) break;\n\t\t\t}\n\t\t\tlast_RT = RecordType;\n\t\t\tif(R.r === 2 || R.r == 12) {\n\t\t\t\tvar rt = blob.read_shift(2); length -= 2;\n\t\t\t\tif(!opts.enc && rt !== RecordType && (((rt&0xFF)<<8)|(rt>>8)) !== RecordType) throw new Error(\"rt mismatch: \" + rt + \"!=\" + RecordType);\n\t\t\t\tif(R.r == 12){\n\t\t\t\t\tblob.l += 10; length -= 10;\n\t\t\t\t} // skip FRT\n\t\t\t}\n\t\t\t//console.error(R,blob.l,length,blob.length);\n\t\t\tvar val/*:any*/ = ({}/*:any*/);\n\t\t\tif(RecordType === 0x000a /* EOF */) val = /*::(*/R.f(blob, length, opts)/*:: :any)*/;\n\t\t\telse val = /*::(*/slurp(RecordType, R, blob, length, opts)/*:: :any)*/;\n\t\t\t/*:: val = (val:any); */\n\t\t\tif(file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(last_RT) === -1 /* BOF */) continue;\n\t\t\tswitch(RecordType) {\n\t\t\t\tcase 0x0022 /* Date1904 */:\n\t\t\t\t\t/*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n\t\t\t\t\twb.opts.Date1904 = Workbook.WBProps.date1904 = val; break;\n\t\t\t\tcase 0x0086 /* WriteProtect */: wb.opts.WriteProtect = true; break;\n\t\t\t\tcase 0x002f /* FilePass */:\n\t\t\t\t\tif(!opts.enc) blob.l = 0;\n\t\t\t\t\topts.enc = val;\n\t\t\t\t\tif(!options.password) throw new Error(\"File is password-protected\");\n\t\t\t\t\tif(val.valid == null) throw new Error(\"Encryption scheme unsupported\");\n\t\t\t\t\tif(!val.valid) throw new Error(\"Password is incorrect\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x005c /* WriteAccess */: opts.lastuser = val; break;\n\t\t\t\tcase 0x0042 /* CodePage */:\n\t\t\t\t\tvar cpval = Number(val);\n\t\t\t\t\t/* overrides based on test cases */\n\t\t\t\t\tswitch(cpval) {\n\t\t\t\t\t\tcase 0x5212: cpval =  1200; break;\n\t\t\t\t\t\tcase 0x8000: cpval = 10000; break;\n\t\t\t\t\t\tcase 0x8001: cpval =  1252; break;\n\t\t\t\t\t}\n\t\t\t\t\tset_cp(opts.codepage = cpval);\n\t\t\t\t\tseen_codepage = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x013d /* RRTabId */: opts.rrtabid = val; break;\n\t\t\t\tcase 0x0019 /* WinProtect */: opts.winlocked = val; break;\n\t\t\t\tcase 0x01b7 /* RefreshAll */: wb.opts[\"RefreshAll\"] = val; break;\n\t\t\t\tcase 0x000c /* CalcCount */: wb.opts[\"CalcCount\"] = val; break;\n\t\t\t\tcase 0x0010 /* CalcDelta */: wb.opts[\"CalcDelta\"] = val; break;\n\t\t\t\tcase 0x0011 /* CalcIter */: wb.opts[\"CalcIter\"] = val; break;\n\t\t\t\tcase 0x000d /* CalcMode */: wb.opts[\"CalcMode\"] = val; break;\n\t\t\t\tcase 0x000e /* CalcPrecision */: wb.opts[\"CalcPrecision\"] = val; break;\n\t\t\t\tcase 0x005f /* CalcSaveRecalc */: wb.opts[\"CalcSaveRecalc\"] = val; break;\n\t\t\t\tcase 0x000f /* CalcRefMode */: opts.CalcRefMode = val; break; // TODO: implement R1C1\n\t\t\t\tcase 0x08a3 /* ForceFullCalculation */: wb.opts.FullCalc = val; break;\n\t\t\t\tcase 0x0081 /* WsBool */:\n\t\t\t\t\tif(val.fDialog) out[\"!type\"] = \"dialog\";\n\t\t\t\t\tif(!val.fBelow) (out[\"!outline\"] || (out[\"!outline\"] = {})).above = true;\n\t\t\t\t\tif(!val.fRight) (out[\"!outline\"] || (out[\"!outline\"] = {})).left = true;\n\t\t\t\t\tbreak; // TODO\n\t\t\t\tcase 0x0043: /* BIFF2XF */ case 0x0243: /* BIFF3XF */ case 0x0443: /* BIFF4XF */\n\t\t\t\tcase 0x00e0 /* XF */:\n\t\t\t\t\tXFs.push(val); break;\n\t\t\t\tcase 0x01ae /* SupBook */:\n\t\t\t\t\tsupbooks.push([val]);\n\t\t\t\t\tsupbooks[supbooks.length-1].XTI = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0023: case 0x0223 /* ExternName */:\n\t\t\t\t\tsupbooks[supbooks.length-1].push(val);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0018: case 0x0218 /* Lbl */:\n\t\t\t\t\tlast_lbl = ({\n\t\t\t\t\t\tName: val.Name,\n\t\t\t\t\t\tRef: stringify_formula(val.rgce,range,null,supbooks,opts)\n\t\t\t\t\t}/*:DefinedName*/);\n\t\t\t\t\tif(val.itab > 0) last_lbl.Sheet = val.itab - 1;\n\t\t\t\t\tsupbooks.names.push(last_lbl);\n\t\t\t\t\tif(!supbooks[0]) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\t\tsupbooks[supbooks.length-1].push(val);\n\t\t\t\t\tif(val.Name == \"_xlnm._FilterDatabase\" && val.itab > 0)\n\t\t\t\t\t\tif(val.rgce && val.rgce[0] && val.rgce[0][0] && val.rgce[0][0][0] == 'PtgArea3d')\n\t\t\t\t\t\t\tFilterDatabases[val.itab - 1] = { ref: encode_range(val.rgce[0][0][1][2]) };\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0016 /* ExternCount */: opts.ExternCount = val; break;\n\t\t\t\tcase 0x0017 /* ExternSheet */:\n\t\t\t\t\tif(supbooks.length == 0) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\t\tsupbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val); supbooks.XTI = supbooks.XTI.concat(val); break;\n\t\t\t\tcase 0x0894 /* NameCmt */:\n\t\t\t\t\t/* TODO: search for correct name */\n\t\t\t\t\tif(opts.biff < 8) break;\n\t\t\t\t\tif(last_lbl != null) last_lbl.Comment = val[1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0012 /* Protect */: out[\"!protect\"] = val; break; /* for sheet or book */\n\t\t\t\tcase 0x0013 /* Password */: if(val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\n\t\t\t\tcase 0x0085 /* BoundSheet8 */: {\n\t\t\t\t\tDirectory[opts.biff == 4 ? opts.snames.length : val.pos] = val;\n\t\t\t\t\topts.snames.push(val.name);\n\t\t\t\t} break;\n\t\t\t\tcase 0x000a /* EOF */: {\n\t\t\t\t\tif(--file_depth ? !biff4w : biff4w) break;\n\t\t\t\t\tif(range.e) {\n\t\t\t\t\t\tif(range.e.r > 0 && range.e.c > 0) {\n\t\t\t\t\t\t\trange.e.r--; range.e.c--;\n\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\tif(options.sheetRows && options.sheetRows <= range.e.r) {\n\t\t\t\t\t\t\t\tvar tmpri = range.e.r;\n\t\t\t\t\t\t\t\trange.e.r = options.sheetRows - 1;\n\t\t\t\t\t\t\t\tout[\"!fullref\"] = out[\"!ref\"];\n\t\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\t\trange.e.r = tmpri;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.e.r++; range.e.c++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(merges.length > 0) out[\"!merges\"] = merges;\n\t\t\t\t\t\tif(objects.length > 0) out[\"!objects\"] = objects;\n\t\t\t\t\t\tif(colinfo.length > 0) out[\"!cols\"] = colinfo;\n\t\t\t\t\t\tif(rowinfo.length > 0) out[\"!rows\"] = rowinfo;\n\t\t\t\t\t\tWorkbook.Sheets.push(wsprops);\n\t\t\t\t\t}\n\t\t\t\t\tif(cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\n\t\t\t\t\tout = ({}/*:any*/); if(options.dense) out[\"!data\"] = [];\n\t\t\t\t} break;\n\t\t\t\tcase 0x0009: case 0x0209: case 0x0409: case 0x0809 /* BOF */: {\n\t\t\t\t\tif(opts.biff === 8) opts.biff = {\n\t\t\t\t\t\t0x0009: 2,\n\t\t\t\t\t\t0x0209: 3,\n\t\t\t\t\t\t0x0409: 4\n\t\t\t\t\t}[RecordType] || {\n\t\t\t\t\t\t0x0200: 2,\n\t\t\t\t\t\t0x0300: 3,\n\t\t\t\t\t\t0x0400: 4,\n\t\t\t\t\t\t0x0500: 5,\n\t\t\t\t\t\t0x0600: 8,\n\t\t\t\t\t\t0x0002: 2,\n\t\t\t\t\t\t0x0007: 2\n\t\t\t\t\t}[val.BIFFVer] || 8;\n\t\t\t\t\topts.biffguess = val.BIFFVer == 0;\n\t\t\t\t\tif(val.BIFFVer == 0 && val.dt == 0x1000) { opts.biff = 5; seen_codepage = true; set_cp(opts.codepage = 28591); }\n\t\t\t\t\tif(opts.biff == 4 && val.dt & 0x100) biff4w = true;\n\t\t\t\t\tif(opts.biff == 8 && val.BIFFVer == 0 && val.dt == 16) opts.biff = 2;\n\t\t\t\t\tif(file_depth++ && !biff4w) break;\n\t\t\t\t\tout = ({}/*:any*/); if(options.dense) out[\"!data\"] = [];\n\n\t\t\t\t\tif(opts.biff < 8 && !seen_codepage) { seen_codepage = true; set_cp(opts.codepage = options.codepage || 1252); }\n\t\t\t\t\tif(opts.biff == 4 && biff4w) {\n\t\t\t\t\t\tcur_sheet = (Directory[opts.snames.indexOf(cur_sheet)+1] || {name:\"\"}).name;\n\t\t\t\t\t} else if(opts.biff < 5 || val.BIFFVer == 0 && val.dt == 0x1000) {\n\t\t\t\t\t\tif(cur_sheet === \"\") cur_sheet = \"Sheet1\";\n\t\t\t\t\t\trange = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\t\t\t\t\t/* fake BoundSheet8 */\n\t\t\t\t\t\tvar fakebs8 = {pos: blob.l - length, name:cur_sheet};\n\t\t\t\t\t\tDirectory[fakebs8.pos] = fakebs8;\n\t\t\t\t\t\topts.snames.push(cur_sheet);\n\t\t\t\t\t}\n\t\t\t\t\telse cur_sheet = (Directory[s] || {name:\"\"}).name;\n\t\t\t\t\tif(val.dt == 0x20) out[\"!type\"] = \"chart\";\n\t\t\t\t\tif(val.dt == 0x40) out[\"!type\"] = \"macro\";\n\t\t\t\t\tmerges = [];\n\t\t\t\t\tobjects = [];\n\t\t\t\t\topts.arrayf = arrayf = [];\n\t\t\t\t\tcolinfo = []; rowinfo = [];\n\t\t\t\t\tseencol = false;\n\t\t\t\t\twsprops = {Hidden:(Directory[s]||{hs:0}).hs, name:cur_sheet };\n\t\t\t\t} break;\n\t\t\t\tcase 0x0203 /* Number */: case 0x0003 /* BIFF2NUM */: case 0x0002 /* BIFF2INT */: {\n\t\t\t\t\tif(out[\"!type\"] == \"chart\") if(options.dense ? (out[\"!data\"][val.r]||[])[val.c]: out[encode_col(val.c) + encode_row(val.r)]) ++val.c;\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe]||{}, v:val.val, t:'n'}/*:any*/);\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x0005: case 0x0205 /* BoolErr */: {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:val.t}/*:any*/);\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x027e /* RK */: {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.rknum, t:'n'}/*:any*/);\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x00bd /* MulRk */: {\n\t\t\t\t\tfor(var j = val.c; j <= val.C; ++j) {\n\t\t\t\t\t\tvar ixfe = val.rkrec[j-val.c][0];\n\t\t\t\t\t\ttemp_val= ({ixfe:ixfe, XF:XFs[ixfe], v:val.rkrec[j-val.c][1], t:'n'}/*:any*/);\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0006: case 0x0206: case 0x0406 /* Formula */: {\n\t\t\t\t\tif(val.val == 'String') { last_formula = val; break; }\n\t\t\t\t\ttemp_val = make_cell(val.val, val.cell.ixfe, val.tt);\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\tvar _f = val.formula;\n\t\t\t\t\t\tif(_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n\t\t\t\t\t\t\tvar _fr = _f[0][0][1][0], _fc = _f[0][0][1][1];\n\t\t\t\t\t\t\tvar _fe = encode_cell({r:_fr, c:_fc});\n\t\t\t\t\t\t\tif(sharedf[_fe]) temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t\t\telse temp_val.F = ((options.dense ? (out[\"!data\"][_fr]||[])[_fc]: out[_fe]) || {}).F;\n\t\t\t\t\t\t} else temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell(val.cell, temp_val, options);\n\t\t\t\t\tlast_formula = val;\n\t\t\t\t} break;\n\t\t\t\tcase 0x0007: case 0x0207 /* String */: {\n\t\t\t\t\tif(last_formula) { /* technically always true */\n\t\t\t\t\t\tlast_formula.val = val;\n\t\t\t\t\t\ttemp_val = make_cell(val, last_formula.cell.ixfe, 's');\n\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\t\ttemp_val.f = \"\"+stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell(last_formula.cell, temp_val, options);\n\t\t\t\t\t\tlast_formula = null;\n\t\t\t\t\t} else throw new Error(\"String record expects Formula\");\n\t\t\t\t} break;\n\t\t\t\tcase 0x0021: case 0x0221 /* Array */: {\n\t\t\t\t\tarrayf.push(val);\n\t\t\t\t\tvar _arraystart = encode_cell(val[0].s);\n\t\t\t\t\tcc = options.dense ? (out[\"!data\"][val[0].s.r]||[])[val[0].s.c] : out[_arraystart];\n\t\t\t\t\tif(options.cellFormula && cc) {\n\t\t\t\t\t\tif(!last_formula) break; /* technically unreachable */\n\t\t\t\t\t\tif(!_arraystart || !cc) break;\n\t\t\t\t\t\tcc.f = \"\"+stringify_formula(val[1], range, val[0], supbooks, opts);\n\t\t\t\t\t\tcc.F = encode_range(val[0]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x04bc /* ShrFmla */: {\n\t\t\t\t\tif(!options.cellFormula) break;\n\t\t\t\t\tif(last_cell) {\n\t\t\t\t\t\t/* TODO: capture range */\n\t\t\t\t\t\tif(!last_formula) break; /* technically unreachable */\n\t\t\t\t\t\tsharedf[encode_cell(last_formula.cell)]= val[0];\n\t\t\t\t\t\tcc = options.dense ? (out[\"!data\"][last_formula.cell.r]||[])[last_formula.cell.c] : out[encode_cell(last_formula.cell)];\n\t\t\t\t\t\t(cc||{}).f = \"\"+stringify_formula(val[0], range, lastcell, supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x00fd /* LabelSst */:\n\t\t\t\t\ttemp_val=make_cell(sst[val.isst].t, val.ixfe, 's');\n\t\t\t\t\tif(sst[val.isst].h) temp_val.h = sst[val.isst].h;\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0201 /* Blank */: if(options.sheetStubs) {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], t:'z'}/*:any*/);\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x00be /* MulBlank */: if(options.sheetStubs) {\n\t\t\t\t\tfor(var _j = val.c; _j <= val.C; ++_j) {\n\t\t\t\t\t\tvar _ixfe = val.ixfe[_j-val.c];\n\t\t\t\t\t\ttemp_val= ({ixfe:_ixfe, XF:XFs[_ixfe], t:'z'}/*:any*/);\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:_j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x00d6 /* RString */:\n\t\t\t\tcase 0x0204 /* Label */: case 0x0004 /* BIFF2STR */:\n\t\t\t\t\ttemp_val=make_cell(val.val, val.ixfe, 's');\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = (temp_val.XF && temp_val.XF.numFmtId) && BIFF2FmtTable[temp_val.XF.numFmtId] || BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0x0000: case 0x0200 /* Dimensions */: {\n\t\t\t\t\tif(file_depth === 1) range = val; /* TODO: stack */\n\t\t\t\t} break;\n\t\t\t\tcase 0x00fc /* SST */: {\n\t\t\t\t\tsst = val;\n\t\t\t\t} break;\n\t\t\t\tcase 0x041e /* Format */: { /* val = [id, fmt] */\n\t\t\t\t\tif(opts.biff >= 3 && opts.biff <= 4) {\n\t\t\t\t\t\tBIFF2FmtTable[BIFF2Fmt++] = val[1];\n\t\t\t\t\t\tfor(var b4idx = 0; b4idx < BIFF2Fmt + 163; ++b4idx) if(table_fmt[b4idx] == val[1]) break;\n\t\t\t\t\t\tif(b4idx >= 163) SSF__load(val[1], BIFF2Fmt + 163);\n\t\t\t\t\t}\n\t\t\t\t\telse SSF__load(val[1], val[0]);\n\t\t\t\t} break;\n\t\t\t\tcase 0x001e /* BIFF2FORMAT */: {\n\t\t\t\t\tBIFF2FmtTable[BIFF2Fmt++] = val;\n\t\t\t\t\tfor(var b2idx = 0; b2idx < BIFF2Fmt + 163; ++b2idx) if(table_fmt[b2idx] == val) break;\n\t\t\t\t\tif(b2idx >= 163) SSF__load(val, BIFF2Fmt + 163);\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x00e5 /* MergeCells */: merges = merges.concat(val); break;\n\n\t\t\t\tcase 0x005d /* Obj */: objects[val.cmo[0]] = opts.lastobj = val; break;\n\t\t\t\tcase 0x01b6 /* TxO */: opts.lastobj.TxO = val; break;\n\t\t\t\tcase 0x007f /* ImData */: opts.lastobj.ImData = val; break;\n\n\t\t\t\tcase 0x01b8 /* HLink */: {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n\t\t\t\t\t\t\tcc = options.dense ? (out[\"!data\"][rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\n\t\t\t\t\t\t\tif(cc) cc.l = val[1];\n\t\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0800 /* HLinkTooltip */: {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n\t\t\t\t\t\t\tcc = options.dense ? (out[\"!data\"][rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\n\t\t\t\t\t\t\tif(cc && cc.l) cc.l.Tooltip = val[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x001c /* Note */: {\n\t\t\t\t\t/* TODO: comment continuation (row == -1 / 0xFFFF) */\n\t\t\t\t\tcc = options.dense ? (out[\"!data\"][val[0].r]||[])[val[0].c] : out[encode_cell(val[0])];\n\t\t\t\t\tif(!cc) {\n\t\t\t\t\t\tif(options.dense) {\n\t\t\t\t\t\t\tif(!out[\"!data\"][val[0].r]) out[\"!data\"][val[0].r] = [];\n\t\t\t\t\t\t\tcc = out[\"!data\"][val[0].r][val[0].c] = ({t:\"z\"}/*:any*/);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcc = out[encode_cell(val[0])] = ({t:\"z\"}/*:any*/);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.e.r = Math.max(range.e.r, val[0].r);\n\t\t\t\t\t\trange.s.r = Math.min(range.s.r, val[0].r);\n\t\t\t\t\t\trange.e.c = Math.max(range.e.c, val[0].c);\n\t\t\t\t\t\trange.s.c = Math.min(range.s.c, val[0].c);\n\t\t\t\t\t}\n\t\t\t\t\tif(!cc.c) cc.c = [];\n\t\t\t\t\tif(opts.biff <= 5 && opts.biff >= 2) cmnt = {a:\"SheetJ5\", t:val[1]};\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar noteobj = objects[val[2]];\n\t\t\t\t\t\tcmnt = {a:val[1],t:noteobj.TxO.t};\n\t\t\t\t\t\tif(val[3] != null && !(val[3] & 0x02)) cc.c.hidden = true;\n\t\t\t\t\t}\n\t\t\t\t\tcc.c.push(cmnt);\n\t\t\t\t} break;\n\t\t\t\tcase 0x087d /* XFExt */: update_xfext(XFs[val.ixfe], val.ext); break;\n\t\t\t\tcase 0x007d /* ColInfo */: {\n\t\t\t\t\tif(!opts.cellStyles) break;\n\t\t\t\t\twhile(val.e >= val.s) {\n\t\t\t\t\t\tcolinfo[val.e--] = { width: val.w/256, level: (val.level || 0), hidden: !!(val.flags & 1) };\n\t\t\t\t\t\tif(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\n\t\t\t\t\t\tprocess_col(colinfo[val.e+1]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0208 /* Row */: {\n\t\t\t\t\tvar rowobj = {};\n\t\t\t\t\tif(val.level != null) { rowinfo[val.r] = rowobj; rowobj.level = val.level; }\n\t\t\t\t\tif(val.hidden) { rowinfo[val.r] = rowobj; rowobj.hidden = true; }\n\t\t\t\t\tif(val.hpt) {\n\t\t\t\t\t\trowinfo[val.r] = rowobj;\n\t\t\t\t\t\trowobj.hpt = val.hpt; rowobj.hpx = pt2px(val.hpt);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0026 /* LeftMargin */:\n\t\t\t\tcase 0x0027 /* RightMargin */:\n\t\t\t\tcase 0x0028 /* TopMargin */:\n\t\t\t\tcase 0x0029 /* BottomMargin */:\n\t\t\t\t\tif(!out['!margins']) default_margins(out['!margins'] = {});\n\t\t\t\t\tout['!margins'][({0x26: \"left\", 0x27:\"right\", 0x28:\"top\", 0x29:\"bottom\"})[RecordType]] = val;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x00a1 /* Setup */: // TODO\n\t\t\t\t\tif(!out['!margins']) default_margins(out['!margins'] = {});\n\t\t\t\t\tout['!margins'].header = val.header;\n\t\t\t\t\tout['!margins'].footer = val.footer;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x023e /* Window2 */: // TODO\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tif(val.RTL) Workbook.Views[0].RTL = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0092 /* Palette */: palette = val; break;\n\t\t\t\tcase 0x0896 /* Theme */: themes = val; break;\n\t\t\t\tcase 0x008c /* Country */: country = val; break;\n\t\t\t\tcase 0x01ba /* CodeName */: {\n\t\t\t\t\t/*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n\t\t\t\t\tif(!cur_sheet) Workbook.WBProps.CodeName = val || \"ThisWorkbook\";\n\t\t\t\t\telse wsprops.CodeName = val || wsprops.name;\n\t\t\t\t} break;\n\t\t\t}\n\t\t} else {\n\t\t\tif(!R) console.error(\"Missing Info for XLS Record 0x\" + RecordType.toString(16));\n\t\t\tblob.l += length;\n\t\t}\n\t}\n\twb.SheetNames=keys(Directory).sort(function(a,b) { return Number(a) - Number(b); }).map(function(x){return Directory[x].name;});\n\tif(!options.bookSheets) wb.Sheets=Sheets;\n\tif(!wb.SheetNames.length && Preamble[\"!ref\"]) {\n\t\twb.SheetNames.push(\"Sheet1\");\n\t\t/*jshint -W069 */\n\t\tif(wb.Sheets) wb.Sheets[\"Sheet1\"] = Preamble;\n\t\t/*jshint +W069 */\n\t} else wb.Preamble=Preamble;\n\tif(wb.Sheets) FilterDatabases.forEach(function(r,i) { wb.Sheets[wb.SheetNames[i]]['!autofilter'] = r; });\n\twb.Strings = sst;\n\twb.SSF = dup(table_fmt);\n\tif(opts.enc) wb.Encryption = opts.enc;\n\tif(themes) wb.Themes = themes;\n\twb.Metadata = {};\n\tif(country !== undefined) wb.Metadata.Country = country;\n\tif(supbooks.names.length > 0) Workbook.Names = supbooks.names;\n\twb.Workbook = Workbook;\n\treturn wb;\n}\n\n/* TODO: split props*/\nvar PSCLSID = {\n\tSI: \"e0859ff2f94f6810ab9108002b27b3d9\",\n\tDSI: \"02d5cdd59c2e1b10939708002b2cf9ae\",\n\tUDI: \"05d5cdd59c2e1b10939708002b2cf9ae\"\n};\nfunction parse_xls_props(cfb/*:CFBContainer*/, props, o) {\n\t/* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n\tvar DSI = CFB.find(cfb, '/!DocumentSummaryInformation');\n\tif(DSI && DSI.size > 0) try {\n\t\tvar DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI, PSCLSID.DSI);\n\t\tfor(var d in DocSummary) props[d] = DocSummary[d];\n\t} catch(e) {if(o.WTF) throw e;/* empty */}\n\n\t/* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\tvar SI = CFB.find(cfb, '/!SummaryInformation');\n\tif(SI && SI.size > 0) try {\n\t\tvar Summary = parse_PropertySetStream(SI, SummaryPIDSI, PSCLSID.SI);\n\t\tfor(var s in Summary) if(props[s] == null) props[s] = Summary[s];\n\t} catch(e) {if(o.WTF) throw e;/* empty */}\n\n\tif(props.HeadingPairs && props.TitlesOfParts) {\n\t\tload_props_pairs(props.HeadingPairs, props.TitlesOfParts, props, o);\n\t\tdelete props.HeadingPairs; delete props.TitlesOfParts;\n\t}\n}\nfunction write_xls_props(wb/*:Workbook*/, cfb/*:CFBContainer*/) {\n\tvar DSEntries = [], SEntries = [], CEntries = [];\n\tvar i = 0, Keys;\n\tvar DocSummaryRE/*:{[key:string]:string}*/ = evert_key(DocSummaryPIDDSI, \"n\");\n\tvar SummaryRE/*:{[key:string]:string}*/ = evert_key(SummaryPIDSI, \"n\");\n\tif(wb.Props) {\n\t\tKeys = keys(wb.Props);\n\t\t// $FlowIgnore\n\t\tfor(i = 0; i < Keys.length; ++i) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Props[Keys[i]]]);\n\t}\n\tif(wb.Custprops) {\n\t\tKeys = keys(wb.Custprops);\n\t\t// $FlowIgnore\n\t\tfor(i = 0; i < Keys.length; ++i) if(!Object.prototype.hasOwnProperty.call((wb.Props||{}), Keys[i])) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Custprops[Keys[i]]]);\n\t}\n\tvar CEntries2 = [];\n\tfor(i = 0; i < CEntries.length; ++i) {\n\t\tif(XLSPSSkip.indexOf(CEntries[i][0]) > -1 || PseudoPropsPairs.indexOf(CEntries[i][0]) > -1) continue;\n\t\tif(CEntries[i][1] == null) continue;\n\t\tCEntries2.push(CEntries[i]);\n\t}\n\tif(SEntries.length) CFB.utils.cfb_add(cfb, \"/\\u0005SummaryInformation\", write_PropertySetStream(SEntries, PSCLSID.SI, SummaryRE, SummaryPIDSI));\n\tif(DSEntries.length || CEntries2.length) CFB.utils.cfb_add(cfb, \"/\\u0005DocumentSummaryInformation\", write_PropertySetStream(DSEntries, PSCLSID.DSI, DocSummaryRE, DocSummaryPIDDSI, CEntries2.length ? CEntries2 : null, PSCLSID.UDI));\n}\n\nfunction parse_xlscfb(cfb/*:any*/, options/*:?ParseOpts*/)/*:Workbook*/ {\nif(!options) options = {};\nfix_read_opts(options);\nreset_cp();\nif(options.codepage) set_ansi(options.codepage);\nvar CompObj/*:?CFBEntry*/, WB/*:?any*/;\nif(cfb.FullPaths) {\n\tif(CFB.find(cfb, '/encryption')) throw new Error(\"File is password-protected\");\n\tCompObj = CFB.find(cfb, '!CompObj');\n\tWB = CFB.find(cfb, '/Workbook') || CFB.find(cfb, '/Book');\n} else {\n\tswitch(options.type) {\n\t\tcase 'base64': cfb = s2a(Base64_decode(cfb)); break;\n\t\tcase 'binary': cfb = s2a(cfb); break;\n\t\tcase 'buffer': break;\n\t\tcase 'array': if(!Array.isArray(cfb)) cfb = Array.prototype.slice.call(cfb); break;\n\t}\n\tprep_blob(cfb, 0);\n\tWB = ({content: cfb}/*:any*/);\n}\nvar /*::CompObjP, */WorkbookP/*:: :Workbook = XLSX.utils.book_new(); */;\n\nvar _data/*:?any*/;\nif(CompObj) /*::CompObjP = */parse_compobj(CompObj);\nif(options.bookProps && !options.bookSheets) WorkbookP = ({}/*:any*/);\nelse/*:: if(cfb instanceof CFBContainer) */ {\n\tvar T = has_buf ? 'buffer' : 'array';\n\tif(WB && WB.content) WorkbookP = parse_workbook(WB.content, options);\n\t/* Quattro Pro 7-8 */\n\telse if((_data=CFB.find(cfb, 'PerfectOffice_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n\t/* Quattro Pro 9 */\n\telse if((_data=CFB.find(cfb, 'NativeContent_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n\t/* Works 4 for Mac */\n\telse if((_data=CFB.find(cfb, 'MN0')) && _data.content) throw new Error(\"Unsupported Works 4 for Mac file\");\n\telse throw new Error(\"Cannot find Workbook stream\");\n\tif(options.bookVBA && cfb.FullPaths && CFB.find(cfb, '/_VBA_PROJECT_CUR/VBA/dir')) WorkbookP.vbaraw = make_vba_xls(cfb);\n}\n\nvar props = {};\nif(cfb.FullPaths) parse_xls_props(/*::((*/cfb/*:: :any):CFBContainer)*/, props, options);\n\nWorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\nif(options.bookFiles) WorkbookP.cfb = cfb;\n/*WorkbookP.CompObjP = CompObjP; // TODO: storage? */\nreturn WorkbookP;\n}\n\n\nfunction write_xlscfb(wb/*:Workbook*/, opts/*:WriteOpts*/)/*:CFBContainer*/ {\n\tvar o = opts || {};\n\tvar cfb = CFB.utils.cfb_new({root:\"R\"});\n\tvar wbpath = \"/Workbook\";\n\tswitch(o.bookType || \"xls\") {\n\t\tcase \"xls\": o.bookType = \"biff8\";\n\t\t/* falls through */\n\t\tcase \"xla\": if(!o.bookType) o.bookType = \"xla\";\n\t\t/* falls through */\n\t\tcase \"biff8\": wbpath = \"/Workbook\"; o.biff = 8; break;\n\t\tcase \"biff5\": wbpath = \"/Book\"; o.biff = 5; break;\n\t\tdefault: throw new Error(\"invalid type \" + o.bookType + \" for XLS CFB\");\n\t}\n\tCFB.utils.cfb_add(cfb, wbpath, write_biff_buf(wb, o));\n\tif(o.biff == 8 && (wb.Props || wb.Custprops)) write_xls_props(wb, cfb);\n\t// TODO: SI, DSI, CO\n\tif(o.biff == 8 && wb.vbaraw) fill_vba_xls(cfb, CFB.read(wb.vbaraw, {type: typeof wb.vbaraw == \"string\" ? \"binary\" : \"buffer\"}));\n\treturn cfb;\n}\n/* [MS-XLSB] 2.3 Record Enumeration */\nvar XLSBRecordEnum = {\n\t0x0000: { /* n:\"BrtRowHdr\", */ f:parse_BrtRowHdr },\n\t0x0001: { /* n:\"BrtCellBlank\", */ f:parse_BrtCellBlank },\n\t0x0002: { /* n:\"BrtCellRk\", */ f:parse_BrtCellRk },\n\t0x0003: { /* n:\"BrtCellError\", */ f:parse_BrtCellError },\n\t0x0004: { /* n:\"BrtCellBool\", */ f:parse_BrtCellBool },\n\t0x0005: { /* n:\"BrtCellReal\", */ f:parse_BrtCellReal },\n\t0x0006: { /* n:\"BrtCellSt\", */ f:parse_BrtCellSt },\n\t0x0007: { /* n:\"BrtCellIsst\", */ f:parse_BrtCellIsst },\n\t0x0008: { /* n:\"BrtFmlaString\", */ f:parse_BrtFmlaString },\n\t0x0009: { /* n:\"BrtFmlaNum\", */ f:parse_BrtFmlaNum },\n\t0x000A: { /* n:\"BrtFmlaBool\", */ f:parse_BrtFmlaBool },\n\t0x000B: { /* n:\"BrtFmlaError\", */ f:parse_BrtFmlaError },\n\t0x000C: { /* n:\"BrtShortBlank\", */ f:parse_BrtShortBlank },\n\t0x000D: { /* n:\"BrtShortRk\", */ f:parse_BrtShortRk },\n\t0x000E: { /* n:\"BrtShortError\", */ f:parse_BrtShortError },\n\t0x000F: { /* n:\"BrtShortBool\", */ f:parse_BrtShortBool },\n\t0x0010: { /* n:\"BrtShortReal\", */ f:parse_BrtShortReal },\n\t0x0011: { /* n:\"BrtShortSt\", */ f:parse_BrtShortSt },\n\t0x0012: { /* n:\"BrtShortIsst\", */ f:parse_BrtShortIsst },\n\t0x0013: { /* n:\"BrtSSTItem\", */ f:parse_RichStr },\n\t0x0014: { /* n:\"BrtPCDIMissing\" */ },\n\t0x0015: { /* n:\"BrtPCDINumber\" */ },\n\t0x0016: { /* n:\"BrtPCDIBoolean\" */ },\n\t0x0017: { /* n:\"BrtPCDIError\" */ },\n\t0x0018: { /* n:\"BrtPCDIString\" */ },\n\t0x0019: { /* n:\"BrtPCDIDatetime\" */ },\n\t0x001A: { /* n:\"BrtPCDIIndex\" */ },\n\t0x001B: { /* n:\"BrtPCDIAMissing\" */ },\n\t0x001C: { /* n:\"BrtPCDIANumber\" */ },\n\t0x001D: { /* n:\"BrtPCDIABoolean\" */ },\n\t0x001E: { /* n:\"BrtPCDIAError\" */ },\n\t0x001F: { /* n:\"BrtPCDIAString\" */ },\n\t0x0020: { /* n:\"BrtPCDIADatetime\" */ },\n\t0x0021: { /* n:\"BrtPCRRecord\" */ },\n\t0x0022: { /* n:\"BrtPCRRecordDt\" */ },\n\t0x0023: { /* n:\"BrtFRTBegin\", */ T:1 },\n\t0x0024: { /* n:\"BrtFRTEnd\", */ T:-1 },\n\t0x0025: { /* n:\"BrtACBegin\", */ T:1 },\n\t0x0026: { /* n:\"BrtACEnd\", */ T:-1 },\n\t0x0027: { /* n:\"BrtName\", */ f:parse_BrtName },\n\t0x0028: { /* n:\"BrtIndexRowBlock\" */ },\n\t0x002A: { /* n:\"BrtIndexBlock\" */ },\n\t0x002B: { /* n:\"BrtFont\", */ f:parse_BrtFont },\n\t0x002C: { /* n:\"BrtFmt\", */ f:parse_BrtFmt },\n\t0x002D: { /* n:\"BrtFill\", */ f:parse_BrtFill },\n\t0x002E: { /* n:\"BrtBorder\", */ f:parse_BrtBorder },\n\t0x002F: { /* n:\"BrtXF\", */ f:parse_BrtXF },\n\t0x0030: { /* n:\"BrtStyle\" */ },\n\t0x0031: { /* n:\"BrtCellMeta\", */ f:parse_Int32LE },\n\t0x0032: { /* n:\"BrtValueMeta\" */ },\n\t0x0033: { /* n:\"BrtMdb\" */ f:parse_BrtMdb },\n\t0x0034: { /* n:\"BrtBeginFmd\", */ T:1 },\n\t0x0035: { /* n:\"BrtEndFmd\", */ T:-1 },\n\t0x0036: { /* n:\"BrtBeginMdx\", */ T:1 },\n\t0x0037: { /* n:\"BrtEndMdx\", */ T:-1 },\n\t0x0038: { /* n:\"BrtBeginMdxTuple\", */ T:1 },\n\t0x0039: { /* n:\"BrtEndMdxTuple\", */ T:-1 },\n\t0x003A: { /* n:\"BrtMdxMbrIstr\" */ },\n\t0x003B: { /* n:\"BrtStr\" */ },\n\t0x003C: { /* n:\"BrtColInfo\", */ f:parse_ColInfo },\n\t0x003E: { /* n:\"BrtCellRString\", */ f:parse_BrtCellRString },\n\t0x003F: { /* n:\"BrtCalcChainItem$\", */ f:parse_BrtCalcChainItem$ },\n\t0x0040: { /* n:\"BrtDVal\", */ f:parse_BrtDVal },\n\t0x0041: { /* n:\"BrtSxvcellNum\" */ },\n\t0x0042: { /* n:\"BrtSxvcellStr\" */ },\n\t0x0043: { /* n:\"BrtSxvcellBool\" */ },\n\t0x0044: { /* n:\"BrtSxvcellErr\" */ },\n\t0x0045: { /* n:\"BrtSxvcellDate\" */ },\n\t0x0046: { /* n:\"BrtSxvcellNil\" */ },\n\t0x0080: { /* n:\"BrtFileVersion\" */ },\n\t0x0081: { /* n:\"BrtBeginSheet\", */ T:1 },\n\t0x0082: { /* n:\"BrtEndSheet\", */ T:-1 },\n\t0x0083: { /* n:\"BrtBeginBook\", */ T:1, f:parsenoop, p:0 },\n\t0x0084: { /* n:\"BrtEndBook\", */ T:-1 },\n\t0x0085: { /* n:\"BrtBeginWsViews\", */ T:1 },\n\t0x0086: { /* n:\"BrtEndWsViews\", */ T:-1 },\n\t0x0087: { /* n:\"BrtBeginBookViews\", */ T:1 },\n\t0x0088: { /* n:\"BrtEndBookViews\", */ T:-1 },\n\t0x0089: { /* n:\"BrtBeginWsView\", */ T:1, f:parse_BrtBeginWsView },\n\t0x008A: { /* n:\"BrtEndWsView\", */ T:-1 },\n\t0x008B: { /* n:\"BrtBeginCsViews\", */ T:1 },\n\t0x008C: { /* n:\"BrtEndCsViews\", */ T:-1 },\n\t0x008D: { /* n:\"BrtBeginCsView\", */ T:1 },\n\t0x008E: { /* n:\"BrtEndCsView\", */ T:-1 },\n\t0x008F: { /* n:\"BrtBeginBundleShs\", */ T:1 },\n\t0x0090: { /* n:\"BrtEndBundleShs\", */ T:-1 },\n\t0x0091: { /* n:\"BrtBeginSheetData\", */ T:1 },\n\t0x0092: { /* n:\"BrtEndSheetData\", */ T:-1 },\n\t0x0093: { /* n:\"BrtWsProp\", */ f:parse_BrtWsProp },\n\t0x0094: { /* n:\"BrtWsDim\", */ f:parse_BrtWsDim, p:16 },\n\t0x0097: { /* n:\"BrtPane\", */ f:parse_BrtPane },\n\t0x0098: { /* n:\"BrtSel\" */ },\n\t0x0099: { /* n:\"BrtWbProp\", */ f:parse_BrtWbProp },\n\t0x009A: { /* n:\"BrtWbFactoid\" */ },\n\t0x009B: { /* n:\"BrtFileRecover\" */ },\n\t0x009C: { /* n:\"BrtBundleSh\", */ f:parse_BrtBundleSh },\n\t0x009D: { /* n:\"BrtCalcProp\" */ },\n\t0x009E: { /* n:\"BrtBookView\" */ },\n\t0x009F: { /* n:\"BrtBeginSst\", */ T:1, f:parse_BrtBeginSst },\n\t0x00A0: { /* n:\"BrtEndSst\", */ T:-1 },\n\t0x00A1: { /* n:\"BrtBeginAFilter\", */ T:1, f:parse_UncheckedRfX },\n\t0x00A2: { /* n:\"BrtEndAFilter\", */ T:-1 },\n\t0x00A3: { /* n:\"BrtBeginFilterColumn\", */ T:1 },\n\t0x00A4: { /* n:\"BrtEndFilterColumn\", */ T:-1 },\n\t0x00A5: { /* n:\"BrtBeginFilters\", */ T:1 },\n\t0x00A6: { /* n:\"BrtEndFilters\", */ T:-1 },\n\t0x00A7: { /* n:\"BrtFilter\" */ },\n\t0x00A8: { /* n:\"BrtColorFilter\" */ },\n\t0x00A9: { /* n:\"BrtIconFilter\" */ },\n\t0x00AA: { /* n:\"BrtTop10Filter\" */ },\n\t0x00AB: { /* n:\"BrtDynamicFilter\" */ },\n\t0x00AC: { /* n:\"BrtBeginCustomFilters\", */ T:1 },\n\t0x00AD: { /* n:\"BrtEndCustomFilters\", */ T:-1 },\n\t0x00AE: { /* n:\"BrtCustomFilter\" */ },\n\t0x00AF: { /* n:\"BrtAFilterDateGroupItem\" */ },\n\t0x00B0: { /* n:\"BrtMergeCell\", */ f:parse_BrtMergeCell },\n\t0x00B1: { /* n:\"BrtBeginMergeCells\", */ T:1 },\n\t0x00B2: { /* n:\"BrtEndMergeCells\", */ T:-1 },\n\t0x00B3: { /* n:\"BrtBeginPivotCacheDef\", */ T:1 },\n\t0x00B4: { /* n:\"BrtEndPivotCacheDef\", */ T:-1 },\n\t0x00B5: { /* n:\"BrtBeginPCDFields\", */ T:1 },\n\t0x00B6: { /* n:\"BrtEndPCDFields\", */ T:-1 },\n\t0x00B7: { /* n:\"BrtBeginPCDField\", */ T:1 },\n\t0x00B8: { /* n:\"BrtEndPCDField\", */ T:-1 },\n\t0x00B9: { /* n:\"BrtBeginPCDSource\", */ T:1 },\n\t0x00BA: { /* n:\"BrtEndPCDSource\", */ T:-1 },\n\t0x00BB: { /* n:\"BrtBeginPCDSRange\", */ T:1 },\n\t0x00BC: { /* n:\"BrtEndPCDSRange\", */ T:-1 },\n\t0x00BD: { /* n:\"BrtBeginPCDFAtbl\", */ T:1 },\n\t0x00BE: { /* n:\"BrtEndPCDFAtbl\", */ T:-1 },\n\t0x00BF: { /* n:\"BrtBeginPCDIRun\", */ T:1 },\n\t0x00C0: { /* n:\"BrtEndPCDIRun\", */ T:-1 },\n\t0x00C1: { /* n:\"BrtBeginPivotCacheRecords\", */ T:1 },\n\t0x00C2: { /* n:\"BrtEndPivotCacheRecords\", */ T:-1 },\n\t0x00C3: { /* n:\"BrtBeginPCDHierarchies\", */ T:1 },\n\t0x00C4: { /* n:\"BrtEndPCDHierarchies\", */ T:-1 },\n\t0x00C5: { /* n:\"BrtBeginPCDHierarchy\", */ T:1 },\n\t0x00C6: { /* n:\"BrtEndPCDHierarchy\", */ T:-1 },\n\t0x00C7: { /* n:\"BrtBeginPCDHFieldsUsage\", */ T:1 },\n\t0x00C8: { /* n:\"BrtEndPCDHFieldsUsage\", */ T:-1 },\n\t0x00C9: { /* n:\"BrtBeginExtConnection\", */ T:1 },\n\t0x00CA: { /* n:\"BrtEndExtConnection\", */ T:-1 },\n\t0x00CB: { /* n:\"BrtBeginECDbProps\", */ T:1 },\n\t0x00CC: { /* n:\"BrtEndECDbProps\", */ T:-1 },\n\t0x00CD: { /* n:\"BrtBeginECOlapProps\", */ T:1 },\n\t0x00CE: { /* n:\"BrtEndECOlapProps\", */ T:-1 },\n\t0x00CF: { /* n:\"BrtBeginPCDSConsol\", */ T:1 },\n\t0x00D0: { /* n:\"BrtEndPCDSConsol\", */ T:-1 },\n\t0x00D1: { /* n:\"BrtBeginPCDSCPages\", */ T:1 },\n\t0x00D2: { /* n:\"BrtEndPCDSCPages\", */ T:-1 },\n\t0x00D3: { /* n:\"BrtBeginPCDSCPage\", */ T:1 },\n\t0x00D4: { /* n:\"BrtEndPCDSCPage\", */ T:-1 },\n\t0x00D5: { /* n:\"BrtBeginPCDSCPItem\", */ T:1 },\n\t0x00D6: { /* n:\"BrtEndPCDSCPItem\", */ T:-1 },\n\t0x00D7: { /* n:\"BrtBeginPCDSCSets\", */ T:1 },\n\t0x00D8: { /* n:\"BrtEndPCDSCSets\", */ T:-1 },\n\t0x00D9: { /* n:\"BrtBeginPCDSCSet\", */ T:1 },\n\t0x00DA: { /* n:\"BrtEndPCDSCSet\", */ T:-1 },\n\t0x00DB: { /* n:\"BrtBeginPCDFGroup\", */ T:1 },\n\t0x00DC: { /* n:\"BrtEndPCDFGroup\", */ T:-1 },\n\t0x00DD: { /* n:\"BrtBeginPCDFGItems\", */ T:1 },\n\t0x00DE: { /* n:\"BrtEndPCDFGItems\", */ T:-1 },\n\t0x00DF: { /* n:\"BrtBeginPCDFGRange\", */ T:1 },\n\t0x00E0: { /* n:\"BrtEndPCDFGRange\", */ T:-1 },\n\t0x00E1: { /* n:\"BrtBeginPCDFGDiscrete\", */ T:1 },\n\t0x00E2: { /* n:\"BrtEndPCDFGDiscrete\", */ T:-1 },\n\t0x00E3: { /* n:\"BrtBeginPCDSDTupleCache\", */ T:1 },\n\t0x00E4: { /* n:\"BrtEndPCDSDTupleCache\", */ T:-1 },\n\t0x00E5: { /* n:\"BrtBeginPCDSDTCEntries\", */ T:1 },\n\t0x00E6: { /* n:\"BrtEndPCDSDTCEntries\", */ T:-1 },\n\t0x00E7: { /* n:\"BrtBeginPCDSDTCEMembers\", */ T:1 },\n\t0x00E8: { /* n:\"BrtEndPCDSDTCEMembers\", */ T:-1 },\n\t0x00E9: { /* n:\"BrtBeginPCDSDTCEMember\", */ T:1 },\n\t0x00EA: { /* n:\"BrtEndPCDSDTCEMember\", */ T:-1 },\n\t0x00EB: { /* n:\"BrtBeginPCDSDTCQueries\", */ T:1 },\n\t0x00EC: { /* n:\"BrtEndPCDSDTCQueries\", */ T:-1 },\n\t0x00ED: { /* n:\"BrtBeginPCDSDTCQuery\", */ T:1 },\n\t0x00EE: { /* n:\"BrtEndPCDSDTCQuery\", */ T:-1 },\n\t0x00EF: { /* n:\"BrtBeginPCDSDTCSets\", */ T:1 },\n\t0x00F0: { /* n:\"BrtEndPCDSDTCSets\", */ T:-1 },\n\t0x00F1: { /* n:\"BrtBeginPCDSDTCSet\", */ T:1 },\n\t0x00F2: { /* n:\"BrtEndPCDSDTCSet\", */ T:-1 },\n\t0x00F3: { /* n:\"BrtBeginPCDCalcItems\", */ T:1 },\n\t0x00F4: { /* n:\"BrtEndPCDCalcItems\", */ T:-1 },\n\t0x00F5: { /* n:\"BrtBeginPCDCalcItem\", */ T:1 },\n\t0x00F6: { /* n:\"BrtEndPCDCalcItem\", */ T:-1 },\n\t0x00F7: { /* n:\"BrtBeginPRule\", */ T:1 },\n\t0x00F8: { /* n:\"BrtEndPRule\", */ T:-1 },\n\t0x00F9: { /* n:\"BrtBeginPRFilters\", */ T:1 },\n\t0x00FA: { /* n:\"BrtEndPRFilters\", */ T:-1 },\n\t0x00FB: { /* n:\"BrtBeginPRFilter\", */ T:1 },\n\t0x00FC: { /* n:\"BrtEndPRFilter\", */ T:-1 },\n\t0x00FD: { /* n:\"BrtBeginPNames\", */ T:1 },\n\t0x00FE: { /* n:\"BrtEndPNames\", */ T:-1 },\n\t0x00FF: { /* n:\"BrtBeginPName\", */ T:1 },\n\t0x0100: { /* n:\"BrtEndPName\", */ T:-1 },\n\t0x0101: { /* n:\"BrtBeginPNPairs\", */ T:1 },\n\t0x0102: { /* n:\"BrtEndPNPairs\", */ T:-1 },\n\t0x0103: { /* n:\"BrtBeginPNPair\", */ T:1 },\n\t0x0104: { /* n:\"BrtEndPNPair\", */ T:-1 },\n\t0x0105: { /* n:\"BrtBeginECWebProps\", */ T:1 },\n\t0x0106: { /* n:\"BrtEndECWebProps\", */ T:-1 },\n\t0x0107: { /* n:\"BrtBeginEcWpTables\", */ T:1 },\n\t0x0108: { /* n:\"BrtEndECWPTables\", */ T:-1 },\n\t0x0109: { /* n:\"BrtBeginECParams\", */ T:1 },\n\t0x010A: { /* n:\"BrtEndECParams\", */ T:-1 },\n\t0x010B: { /* n:\"BrtBeginECParam\", */ T:1 },\n\t0x010C: { /* n:\"BrtEndECParam\", */ T:-1 },\n\t0x010D: { /* n:\"BrtBeginPCDKPIs\", */ T:1 },\n\t0x010E: { /* n:\"BrtEndPCDKPIs\", */ T:-1 },\n\t0x010F: { /* n:\"BrtBeginPCDKPI\", */ T:1 },\n\t0x0110: { /* n:\"BrtEndPCDKPI\", */ T:-1 },\n\t0x0111: { /* n:\"BrtBeginDims\", */ T:1 },\n\t0x0112: { /* n:\"BrtEndDims\", */ T:-1 },\n\t0x0113: { /* n:\"BrtBeginDim\", */ T:1 },\n\t0x0114: { /* n:\"BrtEndDim\", */ T:-1 },\n\t0x0115: { /* n:\"BrtIndexPartEnd\" */ },\n\t0x0116: { /* n:\"BrtBeginStyleSheet\", */ T:1 },\n\t0x0117: { /* n:\"BrtEndStyleSheet\", */ T:-1 },\n\t0x0118: { /* n:\"BrtBeginSXView\", */ T:1 },\n\t0x0119: { /* n:\"BrtEndSXVI\", */ T:-1 },\n\t0x011A: { /* n:\"BrtBeginSXVI\", */ T:1 },\n\t0x011B: { /* n:\"BrtBeginSXVIs\", */ T:1 },\n\t0x011C: { /* n:\"BrtEndSXVIs\", */ T:-1 },\n\t0x011D: { /* n:\"BrtBeginSXVD\", */ T:1 },\n\t0x011E: { /* n:\"BrtEndSXVD\", */ T:-1 },\n\t0x011F: { /* n:\"BrtBeginSXVDs\", */ T:1 },\n\t0x0120: { /* n:\"BrtEndSXVDs\", */ T:-1 },\n\t0x0121: { /* n:\"BrtBeginSXPI\", */ T:1 },\n\t0x0122: { /* n:\"BrtEndSXPI\", */ T:-1 },\n\t0x0123: { /* n:\"BrtBeginSXPIs\", */ T:1 },\n\t0x0124: { /* n:\"BrtEndSXPIs\", */ T:-1 },\n\t0x0125: { /* n:\"BrtBeginSXDI\", */ T:1 },\n\t0x0126: { /* n:\"BrtEndSXDI\", */ T:-1 },\n\t0x0127: { /* n:\"BrtBeginSXDIs\", */ T:1 },\n\t0x0128: { /* n:\"BrtEndSXDIs\", */ T:-1 },\n\t0x0129: { /* n:\"BrtBeginSXLI\", */ T:1 },\n\t0x012A: { /* n:\"BrtEndSXLI\", */ T:-1 },\n\t0x012B: { /* n:\"BrtBeginSXLIRws\", */ T:1 },\n\t0x012C: { /* n:\"BrtEndSXLIRws\", */ T:-1 },\n\t0x012D: { /* n:\"BrtBeginSXLICols\", */ T:1 },\n\t0x012E: { /* n:\"BrtEndSXLICols\", */ T:-1 },\n\t0x012F: { /* n:\"BrtBeginSXFormat\", */ T:1 },\n\t0x0130: { /* n:\"BrtEndSXFormat\", */ T:-1 },\n\t0x0131: { /* n:\"BrtBeginSXFormats\", */ T:1 },\n\t0x0132: { /* n:\"BrtEndSxFormats\", */ T:-1 },\n\t0x0133: { /* n:\"BrtBeginSxSelect\", */ T:1 },\n\t0x0134: { /* n:\"BrtEndSxSelect\", */ T:-1 },\n\t0x0135: { /* n:\"BrtBeginISXVDRws\", */ T:1 },\n\t0x0136: { /* n:\"BrtEndISXVDRws\", */ T:-1 },\n\t0x0137: { /* n:\"BrtBeginISXVDCols\", */ T:1 },\n\t0x0138: { /* n:\"BrtEndISXVDCols\", */ T:-1 },\n\t0x0139: { /* n:\"BrtEndSXLocation\", */ T:-1 },\n\t0x013A: { /* n:\"BrtBeginSXLocation\", */ T:1 },\n\t0x013B: { /* n:\"BrtEndSXView\", */ T:-1 },\n\t0x013C: { /* n:\"BrtBeginSXTHs\", */ T:1 },\n\t0x013D: { /* n:\"BrtEndSXTHs\", */ T:-1 },\n\t0x013E: { /* n:\"BrtBeginSXTH\", */ T:1 },\n\t0x013F: { /* n:\"BrtEndSXTH\", */ T:-1 },\n\t0x0140: { /* n:\"BrtBeginISXTHRws\", */ T:1 },\n\t0x0141: { /* n:\"BrtEndISXTHRws\", */ T:-1 },\n\t0x0142: { /* n:\"BrtBeginISXTHCols\", */ T:1 },\n\t0x0143: { /* n:\"BrtEndISXTHCols\", */ T:-1 },\n\t0x0144: { /* n:\"BrtBeginSXTDMPS\", */ T:1 },\n\t0x0145: { /* n:\"BrtEndSXTDMPs\", */ T:-1 },\n\t0x0146: { /* n:\"BrtBeginSXTDMP\", */ T:1 },\n\t0x0147: { /* n:\"BrtEndSXTDMP\", */ T:-1 },\n\t0x0148: { /* n:\"BrtBeginSXTHItems\", */ T:1 },\n\t0x0149: { /* n:\"BrtEndSXTHItems\", */ T:-1 },\n\t0x014A: { /* n:\"BrtBeginSXTHItem\", */ T:1 },\n\t0x014B: { /* n:\"BrtEndSXTHItem\", */ T:-1 },\n\t0x014C: { /* n:\"BrtBeginMetadata\", */ T:1 },\n\t0x014D: { /* n:\"BrtEndMetadata\", */ T:-1 },\n\t0x014E: { /* n:\"BrtBeginEsmdtinfo\", */ T:1 },\n\t0x014F: { /* n:\"BrtMdtinfo\", */ f:parse_BrtMdtinfo },\n\t0x0150: { /* n:\"BrtEndEsmdtinfo\", */ T:-1 },\n\t0x0151: { /* n:\"BrtBeginEsmdb\", */ f:parse_BrtBeginEsmdb, T:1 },\n\t0x0152: { /* n:\"BrtEndEsmdb\", */ T:-1 },\n\t0x0153: { /* n:\"BrtBeginEsfmd\", */ T:1 },\n\t0x0154: { /* n:\"BrtEndEsfmd\", */ T:-1 },\n\t0x0155: { /* n:\"BrtBeginSingleCells\", */ T:1 },\n\t0x0156: { /* n:\"BrtEndSingleCells\", */ T:-1 },\n\t0x0157: { /* n:\"BrtBeginList\", */ T:1 },\n\t0x0158: { /* n:\"BrtEndList\", */ T:-1 },\n\t0x0159: { /* n:\"BrtBeginListCols\", */ T:1 },\n\t0x015A: { /* n:\"BrtEndListCols\", */ T:-1 },\n\t0x015B: { /* n:\"BrtBeginListCol\", */ T:1 },\n\t0x015C: { /* n:\"BrtEndListCol\", */ T:-1 },\n\t0x015D: { /* n:\"BrtBeginListXmlCPr\", */ T:1 },\n\t0x015E: { /* n:\"BrtEndListXmlCPr\", */ T:-1 },\n\t0x015F: { /* n:\"BrtListCCFmla\" */ },\n\t0x0160: { /* n:\"BrtListTrFmla\" */ },\n\t0x0161: { /* n:\"BrtBeginExternals\", */ T:1 },\n\t0x0162: { /* n:\"BrtEndExternals\", */ T:-1 },\n\t0x0163: { /* n:\"BrtSupBookSrc\", */ f:parse_RelID},\n\t0x0165: { /* n:\"BrtSupSelf\" */ },\n\t0x0166: { /* n:\"BrtSupSame\" */ },\n\t0x0167: { /* n:\"BrtSupTabs\" */ },\n\t0x0168: { /* n:\"BrtBeginSupBook\", */ T:1 },\n\t0x0169: { /* n:\"BrtPlaceholderName\" */ },\n\t0x016A: { /* n:\"BrtExternSheet\", */ f:parse_ExternSheet },\n\t0x016B: { /* n:\"BrtExternTableStart\" */ },\n\t0x016C: { /* n:\"BrtExternTableEnd\" */ },\n\t0x016E: { /* n:\"BrtExternRowHdr\" */ },\n\t0x016F: { /* n:\"BrtExternCellBlank\" */ },\n\t0x0170: { /* n:\"BrtExternCellReal\" */ },\n\t0x0171: { /* n:\"BrtExternCellBool\" */ },\n\t0x0172: { /* n:\"BrtExternCellError\" */ },\n\t0x0173: { /* n:\"BrtExternCellString\" */ },\n\t0x0174: { /* n:\"BrtBeginEsmdx\", */ T:1 },\n\t0x0175: { /* n:\"BrtEndEsmdx\", */ T:-1 },\n\t0x0176: { /* n:\"BrtBeginMdxSet\", */ T:1 },\n\t0x0177: { /* n:\"BrtEndMdxSet\", */ T:-1 },\n\t0x0178: { /* n:\"BrtBeginMdxMbrProp\", */ T:1 },\n\t0x0179: { /* n:\"BrtEndMdxMbrProp\", */ T:-1 },\n\t0x017A: { /* n:\"BrtBeginMdxKPI\", */ T:1 },\n\t0x017B: { /* n:\"BrtEndMdxKPI\", */ T:-1 },\n\t0x017C: { /* n:\"BrtBeginEsstr\", */ T:1 },\n\t0x017D: { /* n:\"BrtEndEsstr\", */ T:-1 },\n\t0x017E: { /* n:\"BrtBeginPRFItem\", */ T:1 },\n\t0x017F: { /* n:\"BrtEndPRFItem\", */ T:-1 },\n\t0x0180: { /* n:\"BrtBeginPivotCacheIDs\", */ T:1 },\n\t0x0181: { /* n:\"BrtEndPivotCacheIDs\", */ T:-1 },\n\t0x0182: { /* n:\"BrtBeginPivotCacheID\", */ T:1 },\n\t0x0183: { /* n:\"BrtEndPivotCacheID\", */ T:-1 },\n\t0x0184: { /* n:\"BrtBeginISXVIs\", */ T:1 },\n\t0x0185: { /* n:\"BrtEndISXVIs\", */ T:-1 },\n\t0x0186: { /* n:\"BrtBeginColInfos\", */ T:1 },\n\t0x0187: { /* n:\"BrtEndColInfos\", */ T:-1 },\n\t0x0188: { /* n:\"BrtBeginRwBrk\", */ T:1 },\n\t0x0189: { /* n:\"BrtEndRwBrk\", */ T:-1 },\n\t0x018A: { /* n:\"BrtBeginColBrk\", */ T:1 },\n\t0x018B: { /* n:\"BrtEndColBrk\", */ T:-1 },\n\t0x018C: { /* n:\"BrtBrk\" */ },\n\t0x018D: { /* n:\"BrtUserBookView\" */ },\n\t0x018E: { /* n:\"BrtInfo\" */ },\n\t0x018F: { /* n:\"BrtCUsr\" */ },\n\t0x0190: { /* n:\"BrtUsr\" */ },\n\t0x0191: { /* n:\"BrtBeginUsers\", */ T:1 },\n\t0x0193: { /* n:\"BrtEOF\" */ },\n\t0x0194: { /* n:\"BrtUCR\" */ },\n\t0x0195: { /* n:\"BrtRRInsDel\" */ },\n\t0x0196: { /* n:\"BrtRREndInsDel\" */ },\n\t0x0197: { /* n:\"BrtRRMove\" */ },\n\t0x0198: { /* n:\"BrtRREndMove\" */ },\n\t0x0199: { /* n:\"BrtRRChgCell\" */ },\n\t0x019A: { /* n:\"BrtRREndChgCell\" */ },\n\t0x019B: { /* n:\"BrtRRHeader\" */ },\n\t0x019C: { /* n:\"BrtRRUserView\" */ },\n\t0x019D: { /* n:\"BrtRRRenSheet\" */ },\n\t0x019E: { /* n:\"BrtRRInsertSh\" */ },\n\t0x019F: { /* n:\"BrtRRDefName\" */ },\n\t0x01A0: { /* n:\"BrtRRNote\" */ },\n\t0x01A1: { /* n:\"BrtRRConflict\" */ },\n\t0x01A2: { /* n:\"BrtRRTQSIF\" */ },\n\t0x01A3: { /* n:\"BrtRRFormat\" */ },\n\t0x01A4: { /* n:\"BrtRREndFormat\" */ },\n\t0x01A5: { /* n:\"BrtRRAutoFmt\" */ },\n\t0x01A6: { /* n:\"BrtBeginUserShViews\", */ T:1 },\n\t0x01A7: { /* n:\"BrtBeginUserShView\", */ T:1 },\n\t0x01A8: { /* n:\"BrtEndUserShView\", */ T:-1 },\n\t0x01A9: { /* n:\"BrtEndUserShViews\", */ T:-1 },\n\t0x01AA: { /* n:\"BrtArrFmla\", */ f:parse_BrtArrFmla },\n\t0x01AB: { /* n:\"BrtShrFmla\", */ f:parse_BrtShrFmla },\n\t0x01AC: { /* n:\"BrtTable\" */ },\n\t0x01AD: { /* n:\"BrtBeginExtConnections\", */ T:1 },\n\t0x01AE: { /* n:\"BrtEndExtConnections\", */ T:-1 },\n\t0x01AF: { /* n:\"BrtBeginPCDCalcMems\", */ T:1 },\n\t0x01B0: { /* n:\"BrtEndPCDCalcMems\", */ T:-1 },\n\t0x01B1: { /* n:\"BrtBeginPCDCalcMem\", */ T:1 },\n\t0x01B2: { /* n:\"BrtEndPCDCalcMem\", */ T:-1 },\n\t0x01B3: { /* n:\"BrtBeginPCDHGLevels\", */ T:1 },\n\t0x01B4: { /* n:\"BrtEndPCDHGLevels\", */ T:-1 },\n\t0x01B5: { /* n:\"BrtBeginPCDHGLevel\", */ T:1 },\n\t0x01B6: { /* n:\"BrtEndPCDHGLevel\", */ T:-1 },\n\t0x01B7: { /* n:\"BrtBeginPCDHGLGroups\", */ T:1 },\n\t0x01B8: { /* n:\"BrtEndPCDHGLGroups\", */ T:-1 },\n\t0x01B9: { /* n:\"BrtBeginPCDHGLGroup\", */ T:1 },\n\t0x01BA: { /* n:\"BrtEndPCDHGLGroup\", */ T:-1 },\n\t0x01BB: { /* n:\"BrtBeginPCDHGLGMembers\", */ T:1 },\n\t0x01BC: { /* n:\"BrtEndPCDHGLGMembers\", */ T:-1 },\n\t0x01BD: { /* n:\"BrtBeginPCDHGLGMember\", */ T:1 },\n\t0x01BE: { /* n:\"BrtEndPCDHGLGMember\", */ T:-1 },\n\t0x01BF: { /* n:\"BrtBeginQSI\", */ T:1 },\n\t0x01C0: { /* n:\"BrtEndQSI\", */ T:-1 },\n\t0x01C1: { /* n:\"BrtBeginQSIR\", */ T:1 },\n\t0x01C2: { /* n:\"BrtEndQSIR\", */ T:-1 },\n\t0x01C3: { /* n:\"BrtBeginDeletedNames\", */ T:1 },\n\t0x01C4: { /* n:\"BrtEndDeletedNames\", */ T:-1 },\n\t0x01C5: { /* n:\"BrtBeginDeletedName\", */ T:1 },\n\t0x01C6: { /* n:\"BrtEndDeletedName\", */ T:-1 },\n\t0x01C7: { /* n:\"BrtBeginQSIFs\", */ T:1 },\n\t0x01C8: { /* n:\"BrtEndQSIFs\", */ T:-1 },\n\t0x01C9: { /* n:\"BrtBeginQSIF\", */ T:1 },\n\t0x01CA: { /* n:\"BrtEndQSIF\", */ T:-1 },\n\t0x01CB: { /* n:\"BrtBeginAutoSortScope\", */ T:1 },\n\t0x01CC: { /* n:\"BrtEndAutoSortScope\", */ T:-1 },\n\t0x01CD: { /* n:\"BrtBeginConditionalFormatting\", */ T:1 },\n\t0x01CE: { /* n:\"BrtEndConditionalFormatting\", */ T:-1 },\n\t0x01CF: { /* n:\"BrtBeginCFRule\", */ T:1 },\n\t0x01D0: { /* n:\"BrtEndCFRule\", */ T:-1 },\n\t0x01D1: { /* n:\"BrtBeginIconSet\", */ T:1 },\n\t0x01D2: { /* n:\"BrtEndIconSet\", */ T:-1 },\n\t0x01D3: { /* n:\"BrtBeginDatabar\", */ T:1 },\n\t0x01D4: { /* n:\"BrtEndDatabar\", */ T:-1 },\n\t0x01D5: { /* n:\"BrtBeginColorScale\", */ T:1 },\n\t0x01D6: { /* n:\"BrtEndColorScale\", */ T:-1 },\n\t0x01D7: { /* n:\"BrtCFVO\" */ },\n\t0x01D8: { /* n:\"BrtExternValueMeta\" */ },\n\t0x01D9: { /* n:\"BrtBeginColorPalette\", */ T:1 },\n\t0x01DA: { /* n:\"BrtEndColorPalette\", */ T:-1 },\n\t0x01DB: { /* n:\"BrtIndexedColor\" */ },\n\t0x01DC: { /* n:\"BrtMargins\", */ f:parse_BrtMargins },\n\t0x01DD: { /* n:\"BrtPrintOptions\" */ },\n\t0x01DE: { /* n:\"BrtPageSetup\" */ },\n\t0x01DF: { /* n:\"BrtBeginHeaderFooter\", */ T:1 },\n\t0x01E0: { /* n:\"BrtEndHeaderFooter\", */ T:-1 },\n\t0x01E1: { /* n:\"BrtBeginSXCrtFormat\", */ T:1 },\n\t0x01E2: { /* n:\"BrtEndSXCrtFormat\", */ T:-1 },\n\t0x01E3: { /* n:\"BrtBeginSXCrtFormats\", */ T:1 },\n\t0x01E4: { /* n:\"BrtEndSXCrtFormats\", */ T:-1 },\n\t0x01E5: { /* n:\"BrtWsFmtInfo\", */ f:parse_BrtWsFmtInfo },\n\t0x01E6: { /* n:\"BrtBeginMgs\", */ T:1 },\n\t0x01E7: { /* n:\"BrtEndMGs\", */ T:-1 },\n\t0x01E8: { /* n:\"BrtBeginMGMaps\", */ T:1 },\n\t0x01E9: { /* n:\"BrtEndMGMaps\", */ T:-1 },\n\t0x01EA: { /* n:\"BrtBeginMG\", */ T:1 },\n\t0x01EB: { /* n:\"BrtEndMG\", */ T:-1 },\n\t0x01EC: { /* n:\"BrtBeginMap\", */ T:1 },\n\t0x01ED: { /* n:\"BrtEndMap\", */ T:-1 },\n\t0x01EE: { /* n:\"BrtHLink\", */ f:parse_BrtHLink },\n\t0x01EF: { /* n:\"BrtBeginDCon\", */ T:1 },\n\t0x01F0: { /* n:\"BrtEndDCon\", */ T:-1 },\n\t0x01F1: { /* n:\"BrtBeginDRefs\", */ T:1 },\n\t0x01F2: { /* n:\"BrtEndDRefs\", */ T:-1 },\n\t0x01F3: { /* n:\"BrtDRef\" */ },\n\t0x01F4: { /* n:\"BrtBeginScenMan\", */ T:1 },\n\t0x01F5: { /* n:\"BrtEndScenMan\", */ T:-1 },\n\t0x01F6: { /* n:\"BrtBeginSct\", */ T:1 },\n\t0x01F7: { /* n:\"BrtEndSct\", */ T:-1 },\n\t0x01F8: { /* n:\"BrtSlc\" */ },\n\t0x01F9: { /* n:\"BrtBeginDXFs\", */ T:1 },\n\t0x01FA: { /* n:\"BrtEndDXFs\", */ T:-1 },\n\t0x01FB: { /* n:\"BrtDXF\" */ },\n\t0x01FC: { /* n:\"BrtBeginTableStyles\", */ T:1 },\n\t0x01FD: { /* n:\"BrtEndTableStyles\", */ T:-1 },\n\t0x01FE: { /* n:\"BrtBeginTableStyle\", */ T:1 },\n\t0x01FF: { /* n:\"BrtEndTableStyle\", */ T:-1 },\n\t0x0200: { /* n:\"BrtTableStyleElement\" */ },\n\t0x0201: { /* n:\"BrtTableStyleClient\" */ },\n\t0x0202: { /* n:\"BrtBeginVolDeps\", */ T:1 },\n\t0x0203: { /* n:\"BrtEndVolDeps\", */ T:-1 },\n\t0x0204: { /* n:\"BrtBeginVolType\", */ T:1 },\n\t0x0205: { /* n:\"BrtEndVolType\", */ T:-1 },\n\t0x0206: { /* n:\"BrtBeginVolMain\", */ T:1 },\n\t0x0207: { /* n:\"BrtEndVolMain\", */ T:-1 },\n\t0x0208: { /* n:\"BrtBeginVolTopic\", */ T:1 },\n\t0x0209: { /* n:\"BrtEndVolTopic\", */ T:-1 },\n\t0x020A: { /* n:\"BrtVolSubtopic\" */ },\n\t0x020B: { /* n:\"BrtVolRef\" */ },\n\t0x020C: { /* n:\"BrtVolNum\" */ },\n\t0x020D: { /* n:\"BrtVolErr\" */ },\n\t0x020E: { /* n:\"BrtVolStr\" */ },\n\t0x020F: { /* n:\"BrtVolBool\" */ },\n\t0x0210: { /* n:\"BrtBeginCalcChain$\", */ T:1 },\n\t0x0211: { /* n:\"BrtEndCalcChain$\", */ T:-1 },\n\t0x0212: { /* n:\"BrtBeginSortState\", */ T:1 },\n\t0x0213: { /* n:\"BrtEndSortState\", */ T:-1 },\n\t0x0214: { /* n:\"BrtBeginSortCond\", */ T:1 },\n\t0x0215: { /* n:\"BrtEndSortCond\", */ T:-1 },\n\t0x0216: { /* n:\"BrtBookProtection\" */ },\n\t0x0217: { /* n:\"BrtSheetProtection\" */ },\n\t0x0218: { /* n:\"BrtRangeProtection\" */ },\n\t0x0219: { /* n:\"BrtPhoneticInfo\" */ },\n\t0x021A: { /* n:\"BrtBeginECTxtWiz\", */ T:1 },\n\t0x021B: { /* n:\"BrtEndECTxtWiz\", */ T:-1 },\n\t0x021C: { /* n:\"BrtBeginECTWFldInfoLst\", */ T:1 },\n\t0x021D: { /* n:\"BrtEndECTWFldInfoLst\", */ T:-1 },\n\t0x021E: { /* n:\"BrtBeginECTwFldInfo\", */ T:1 },\n\t0x0224: { /* n:\"BrtFileSharing\" */ },\n\t0x0225: { /* n:\"BrtOleSize\" */ },\n\t0x0226: { /* n:\"BrtDrawing\", */ f:parse_RelID },\n\t0x0227: { /* n:\"BrtLegacyDrawing\", */ f:parse_XLNullableWideString },\n\t0x0228: { /* n:\"BrtLegacyDrawingHF\" */ },\n\t0x0229: { /* n:\"BrtWebOpt\" */ },\n\t0x022A: { /* n:\"BrtBeginWebPubItems\", */ T:1 },\n\t0x022B: { /* n:\"BrtEndWebPubItems\", */ T:-1 },\n\t0x022C: { /* n:\"BrtBeginWebPubItem\", */ T:1 },\n\t0x022D: { /* n:\"BrtEndWebPubItem\", */ T:-1 },\n\t0x022E: { /* n:\"BrtBeginSXCondFmt\", */ T:1 },\n\t0x022F: { /* n:\"BrtEndSXCondFmt\", */ T:-1 },\n\t0x0230: { /* n:\"BrtBeginSXCondFmts\", */ T:1 },\n\t0x0231: { /* n:\"BrtEndSXCondFmts\", */ T:-1 },\n\t0x0232: { /* n:\"BrtBkHim\" */ },\n\t0x0234: { /* n:\"BrtColor\" */ },\n\t0x0235: { /* n:\"BrtBeginIndexedColors\", */ T:1 },\n\t0x0236: { /* n:\"BrtEndIndexedColors\", */ T:-1 },\n\t0x0239: { /* n:\"BrtBeginMRUColors\", */ T:1 },\n\t0x023A: { /* n:\"BrtEndMRUColors\", */ T:-1 },\n\t0x023C: { /* n:\"BrtMRUColor\" */ },\n\t0x023D: { /* n:\"BrtBeginDVals\", */ T:1 },\n\t0x023E: { /* n:\"BrtEndDVals\", */ T:-1 },\n\t0x0241: { /* n:\"BrtSupNameStart\" */ },\n\t0x0242: { /* n:\"BrtSupNameValueStart\" */ },\n\t0x0243: { /* n:\"BrtSupNameValueEnd\" */ },\n\t0x0244: { /* n:\"BrtSupNameNum\" */ },\n\t0x0245: { /* n:\"BrtSupNameErr\" */ },\n\t0x0246: { /* n:\"BrtSupNameSt\" */ },\n\t0x0247: { /* n:\"BrtSupNameNil\" */ },\n\t0x0248: { /* n:\"BrtSupNameBool\" */ },\n\t0x0249: { /* n:\"BrtSupNameFmla\" */ },\n\t0x024A: { /* n:\"BrtSupNameBits\" */ },\n\t0x024B: { /* n:\"BrtSupNameEnd\" */ },\n\t0x024C: { /* n:\"BrtEndSupBook\", */ T:-1 },\n\t0x024D: { /* n:\"BrtCellSmartTagProperty\" */ },\n\t0x024E: { /* n:\"BrtBeginCellSmartTag\", */ T:1 },\n\t0x024F: { /* n:\"BrtEndCellSmartTag\", */ T:-1 },\n\t0x0250: { /* n:\"BrtBeginCellSmartTags\", */ T:1 },\n\t0x0251: { /* n:\"BrtEndCellSmartTags\", */ T:-1 },\n\t0x0252: { /* n:\"BrtBeginSmartTags\", */ T:1 },\n\t0x0253: { /* n:\"BrtEndSmartTags\", */ T:-1 },\n\t0x0254: { /* n:\"BrtSmartTagType\" */ },\n\t0x0255: { /* n:\"BrtBeginSmartTagTypes\", */ T:1 },\n\t0x0256: { /* n:\"BrtEndSmartTagTypes\", */ T:-1 },\n\t0x0257: { /* n:\"BrtBeginSXFilters\", */ T:1 },\n\t0x0258: { /* n:\"BrtEndSXFilters\", */ T:-1 },\n\t0x0259: { /* n:\"BrtBeginSXFILTER\", */ T:1 },\n\t0x025A: { /* n:\"BrtEndSXFilter\", */ T:-1 },\n\t0x025B: { /* n:\"BrtBeginFills\", */ T:1 },\n\t0x025C: { /* n:\"BrtEndFills\", */ T:-1 },\n\t0x025D: { /* n:\"BrtBeginCellWatches\", */ T:1 },\n\t0x025E: { /* n:\"BrtEndCellWatches\", */ T:-1 },\n\t0x025F: { /* n:\"BrtCellWatch\" */ },\n\t0x0260: { /* n:\"BrtBeginCRErrs\", */ T:1 },\n\t0x0261: { /* n:\"BrtEndCRErrs\", */ T:-1 },\n\t0x0262: { /* n:\"BrtCrashRecErr\" */ },\n\t0x0263: { /* n:\"BrtBeginFonts\", */ T:1 },\n\t0x0264: { /* n:\"BrtEndFonts\", */ T:-1 },\n\t0x0265: { /* n:\"BrtBeginBorders\", */ T:1 },\n\t0x0266: { /* n:\"BrtEndBorders\", */ T:-1 },\n\t0x0267: { /* n:\"BrtBeginFmts\", */ T:1 },\n\t0x0268: { /* n:\"BrtEndFmts\", */ T:-1 },\n\t0x0269: { /* n:\"BrtBeginCellXFs\", */ T:1 },\n\t0x026A: { /* n:\"BrtEndCellXFs\", */ T:-1 },\n\t0x026B: { /* n:\"BrtBeginStyles\", */ T:1 },\n\t0x026C: { /* n:\"BrtEndStyles\", */ T:-1 },\n\t0x0271: { /* n:\"BrtBigName\" */ },\n\t0x0272: { /* n:\"BrtBeginCellStyleXFs\", */ T:1 },\n\t0x0273: { /* n:\"BrtEndCellStyleXFs\", */ T:-1 },\n\t0x0274: { /* n:\"BrtBeginComments\", */ T:1 },\n\t0x0275: { /* n:\"BrtEndComments\", */ T:-1 },\n\t0x0276: { /* n:\"BrtBeginCommentAuthors\", */ T:1 },\n\t0x0277: { /* n:\"BrtEndCommentAuthors\", */ T:-1 },\n\t0x0278: { /* n:\"BrtCommentAuthor\", */ f:parse_BrtCommentAuthor },\n\t0x0279: { /* n:\"BrtBeginCommentList\", */ T:1 },\n\t0x027A: { /* n:\"BrtEndCommentList\", */ T:-1 },\n\t0x027B: { /* n:\"BrtBeginComment\", */ T:1, f:parse_BrtBeginComment},\n\t0x027C: { /* n:\"BrtEndComment\", */ T:-1 },\n\t0x027D: { /* n:\"BrtCommentText\", */ f:parse_BrtCommentText },\n\t0x027E: { /* n:\"BrtBeginOleObjects\", */ T:1 },\n\t0x027F: { /* n:\"BrtOleObject\" */ },\n\t0x0280: { /* n:\"BrtEndOleObjects\", */ T:-1 },\n\t0x0281: { /* n:\"BrtBeginSxrules\", */ T:1 },\n\t0x0282: { /* n:\"BrtEndSxRules\", */ T:-1 },\n\t0x0283: { /* n:\"BrtBeginActiveXControls\", */ T:1 },\n\t0x0284: { /* n:\"BrtActiveX\" */ },\n\t0x0285: { /* n:\"BrtEndActiveXControls\", */ T:-1 },\n\t0x0286: { /* n:\"BrtBeginPCDSDTCEMembersSortBy\", */ T:1 },\n\t0x0288: { /* n:\"BrtBeginCellIgnoreECs\", */ T:1 },\n\t0x0289: { /* n:\"BrtCellIgnoreEC\" */ },\n\t0x028A: { /* n:\"BrtEndCellIgnoreECs\", */ T:-1 },\n\t0x028B: { /* n:\"BrtCsProp\", */ f:parse_BrtCsProp },\n\t0x028C: { /* n:\"BrtCsPageSetup\" */ },\n\t0x028D: { /* n:\"BrtBeginUserCsViews\", */ T:1 },\n\t0x028E: { /* n:\"BrtEndUserCsViews\", */ T:-1 },\n\t0x028F: { /* n:\"BrtBeginUserCsView\", */ T:1 },\n\t0x0290: { /* n:\"BrtEndUserCsView\", */ T:-1 },\n\t0x0291: { /* n:\"BrtBeginPcdSFCIEntries\", */ T:1 },\n\t0x0292: { /* n:\"BrtEndPCDSFCIEntries\", */ T:-1 },\n\t0x0293: { /* n:\"BrtPCDSFCIEntry\" */ },\n\t0x0294: { /* n:\"BrtBeginListParts\", */ T:1 },\n\t0x0295: { /* n:\"BrtListPart\" */ },\n\t0x0296: { /* n:\"BrtEndListParts\", */ T:-1 },\n\t0x0297: { /* n:\"BrtSheetCalcProp\" */ },\n\t0x0298: { /* n:\"BrtBeginFnGroup\", */ T:1 },\n\t0x0299: { /* n:\"BrtFnGroup\" */ },\n\t0x029A: { /* n:\"BrtEndFnGroup\", */ T:-1 },\n\t0x029B: { /* n:\"BrtSupAddin\" */ },\n\t0x029C: { /* n:\"BrtSXTDMPOrder\" */ },\n\t0x029D: { /* n:\"BrtCsProtection\" */ },\n\t0x029F: { /* n:\"BrtBeginWsSortMap\", */ T:1 },\n\t0x02A0: { /* n:\"BrtEndWsSortMap\", */ T:-1 },\n\t0x02A1: { /* n:\"BrtBeginRRSort\", */ T:1 },\n\t0x02A2: { /* n:\"BrtEndRRSort\", */ T:-1 },\n\t0x02A3: { /* n:\"BrtRRSortItem\" */ },\n\t0x02A4: { /* n:\"BrtFileSharingIso\" */ },\n\t0x02A5: { /* n:\"BrtBookProtectionIso\" */ },\n\t0x02A6: { /* n:\"BrtSheetProtectionIso\" */ },\n\t0x02A7: { /* n:\"BrtCsProtectionIso\" */ },\n\t0x02A8: { /* n:\"BrtRangeProtectionIso\" */ },\n\t0x02A9: { /* n:\"BrtDValList\" */ },\n\t0x0400: { /* n:\"BrtRwDescent\" */ },\n\t0x0401: { /* n:\"BrtKnownFonts\" */ },\n\t0x0402: { /* n:\"BrtBeginSXTupleSet\", */ T:1 },\n\t0x0403: { /* n:\"BrtEndSXTupleSet\", */ T:-1 },\n\t0x0404: { /* n:\"BrtBeginSXTupleSetHeader\", */ T:1 },\n\t0x0405: { /* n:\"BrtEndSXTupleSetHeader\", */ T:-1 },\n\t0x0406: { /* n:\"BrtSXTupleSetHeaderItem\" */ },\n\t0x0407: { /* n:\"BrtBeginSXTupleSetData\", */ T:1 },\n\t0x0408: { /* n:\"BrtEndSXTupleSetData\", */ T:-1 },\n\t0x0409: { /* n:\"BrtBeginSXTupleSetRow\", */ T:1 },\n\t0x040A: { /* n:\"BrtEndSXTupleSetRow\", */ T:-1 },\n\t0x040B: { /* n:\"BrtSXTupleSetRowItem\" */ },\n\t0x040C: { /* n:\"BrtNameExt\" */ },\n\t0x040D: { /* n:\"BrtPCDH14\" */ },\n\t0x040E: { /* n:\"BrtBeginPCDCalcMem14\", */ T:1 },\n\t0x040F: { /* n:\"BrtEndPCDCalcMem14\", */ T:-1 },\n\t0x0410: { /* n:\"BrtSXTH14\" */ },\n\t0x0411: { /* n:\"BrtBeginSparklineGroup\", */ T:1 },\n\t0x0412: { /* n:\"BrtEndSparklineGroup\", */ T:-1 },\n\t0x0413: { /* n:\"BrtSparkline\" */ },\n\t0x0414: { /* n:\"BrtSXDI14\" */ },\n\t0x0415: { /* n:\"BrtWsFmtInfoEx14\" */ },\n\t0x0416: { /* n:\"BrtBeginConditionalFormatting14\", */ T:1 },\n\t0x0417: { /* n:\"BrtEndConditionalFormatting14\", */ T:-1 },\n\t0x0418: { /* n:\"BrtBeginCFRule14\", */ T:1 },\n\t0x0419: { /* n:\"BrtEndCFRule14\", */ T:-1 },\n\t0x041A: { /* n:\"BrtCFVO14\" */ },\n\t0x041B: { /* n:\"BrtBeginDatabar14\", */ T:1 },\n\t0x041C: { /* n:\"BrtBeginIconSet14\", */ T:1 },\n\t0x041D: { /* n:\"BrtDVal14\", */ f: parse_BrtDVal14 },\n\t0x041E: { /* n:\"BrtBeginDVals14\", */ T:1 },\n\t0x041F: { /* n:\"BrtColor14\" */ },\n\t0x0420: { /* n:\"BrtBeginSparklines\", */ T:1 },\n\t0x0421: { /* n:\"BrtEndSparklines\", */ T:-1 },\n\t0x0422: { /* n:\"BrtBeginSparklineGroups\", */ T:1 },\n\t0x0423: { /* n:\"BrtEndSparklineGroups\", */ T:-1 },\n\t0x0425: { /* n:\"BrtSXVD14\" */ },\n\t0x0426: { /* n:\"BrtBeginSXView14\", */ T:1 },\n\t0x0427: { /* n:\"BrtEndSXView14\", */ T:-1 },\n\t0x0428: { /* n:\"BrtBeginSXView16\", */ T:1 },\n\t0x0429: { /* n:\"BrtEndSXView16\", */ T:-1 },\n\t0x042A: { /* n:\"BrtBeginPCD14\", */ T:1 },\n\t0x042B: { /* n:\"BrtEndPCD14\", */ T:-1 },\n\t0x042C: { /* n:\"BrtBeginExtConn14\", */ T:1 },\n\t0x042D: { /* n:\"BrtEndExtConn14\", */ T:-1 },\n\t0x042E: { /* n:\"BrtBeginSlicerCacheIDs\", */ T:1 },\n\t0x042F: { /* n:\"BrtEndSlicerCacheIDs\", */ T:-1 },\n\t0x0430: { /* n:\"BrtBeginSlicerCacheID\", */ T:1 },\n\t0x0431: { /* n:\"BrtEndSlicerCacheID\", */ T:-1 },\n\t0x0433: { /* n:\"BrtBeginSlicerCache\", */ T:1 },\n\t0x0434: { /* n:\"BrtEndSlicerCache\", */ T:-1 },\n\t0x0435: { /* n:\"BrtBeginSlicerCacheDef\", */ T:1 },\n\t0x0436: { /* n:\"BrtEndSlicerCacheDef\", */ T:-1 },\n\t0x0437: { /* n:\"BrtBeginSlicersEx\", */ T:1 },\n\t0x0438: { /* n:\"BrtEndSlicersEx\", */ T:-1 },\n\t0x0439: { /* n:\"BrtBeginSlicerEx\", */ T:1 },\n\t0x043A: { /* n:\"BrtEndSlicerEx\", */ T:-1 },\n\t0x043B: { /* n:\"BrtBeginSlicer\", */ T:1 },\n\t0x043C: { /* n:\"BrtEndSlicer\", */ T:-1 },\n\t0x043D: { /* n:\"BrtSlicerCachePivotTables\" */ },\n\t0x043E: { /* n:\"BrtBeginSlicerCacheOlapImpl\", */ T:1 },\n\t0x043F: { /* n:\"BrtEndSlicerCacheOlapImpl\", */ T:-1 },\n\t0x0440: { /* n:\"BrtBeginSlicerCacheLevelsData\", */ T:1 },\n\t0x0441: { /* n:\"BrtEndSlicerCacheLevelsData\", */ T:-1 },\n\t0x0442: { /* n:\"BrtBeginSlicerCacheLevelData\", */ T:1 },\n\t0x0443: { /* n:\"BrtEndSlicerCacheLevelData\", */ T:-1 },\n\t0x0444: { /* n:\"BrtBeginSlicerCacheSiRanges\", */ T:1 },\n\t0x0445: { /* n:\"BrtEndSlicerCacheSiRanges\", */ T:-1 },\n\t0x0446: { /* n:\"BrtBeginSlicerCacheSiRange\", */ T:1 },\n\t0x0447: { /* n:\"BrtEndSlicerCacheSiRange\", */ T:-1 },\n\t0x0448: { /* n:\"BrtSlicerCacheOlapItem\" */ },\n\t0x0449: { /* n:\"BrtBeginSlicerCacheSelections\", */ T:1 },\n\t0x044A: { /* n:\"BrtSlicerCacheSelection\" */ },\n\t0x044B: { /* n:\"BrtEndSlicerCacheSelections\", */ T:-1 },\n\t0x044C: { /* n:\"BrtBeginSlicerCacheNative\", */ T:1 },\n\t0x044D: { /* n:\"BrtEndSlicerCacheNative\", */ T:-1 },\n\t0x044E: { /* n:\"BrtSlicerCacheNativeItem\" */ },\n\t0x044F: { /* n:\"BrtRangeProtection14\" */ },\n\t0x0450: { /* n:\"BrtRangeProtectionIso14\" */ },\n\t0x0451: { /* n:\"BrtCellIgnoreEC14\" */ },\n\t0x0457: { /* n:\"BrtList14\" */ },\n\t0x0458: { /* n:\"BrtCFIcon\" */ },\n\t0x0459: { /* n:\"BrtBeginSlicerCachesPivotCacheIDs\", */ T:1 },\n\t0x045A: { /* n:\"BrtEndSlicerCachesPivotCacheIDs\", */ T:-1 },\n\t0x045B: { /* n:\"BrtBeginSlicers\", */ T:1 },\n\t0x045C: { /* n:\"BrtEndSlicers\", */ T:-1 },\n\t0x045D: { /* n:\"BrtWbProp14\" */ },\n\t0x045E: { /* n:\"BrtBeginSXEdit\", */ T:1 },\n\t0x045F: { /* n:\"BrtEndSXEdit\", */ T:-1 },\n\t0x0460: { /* n:\"BrtBeginSXEdits\", */ T:1 },\n\t0x0461: { /* n:\"BrtEndSXEdits\", */ T:-1 },\n\t0x0462: { /* n:\"BrtBeginSXChange\", */ T:1 },\n\t0x0463: { /* n:\"BrtEndSXChange\", */ T:-1 },\n\t0x0464: { /* n:\"BrtBeginSXChanges\", */ T:1 },\n\t0x0465: { /* n:\"BrtEndSXChanges\", */ T:-1 },\n\t0x0466: { /* n:\"BrtSXTupleItems\" */ },\n\t0x0468: { /* n:\"BrtBeginSlicerStyle\", */ T:1 },\n\t0x0469: { /* n:\"BrtEndSlicerStyle\", */ T:-1 },\n\t0x046A: { /* n:\"BrtSlicerStyleElement\" */ },\n\t0x046B: { /* n:\"BrtBeginStyleSheetExt14\", */ T:1 },\n\t0x046C: { /* n:\"BrtEndStyleSheetExt14\", */ T:-1 },\n\t0x046D: { /* n:\"BrtBeginSlicerCachesPivotCacheID\", */ T:1 },\n\t0x046E: { /* n:\"BrtEndSlicerCachesPivotCacheID\", */ T:-1 },\n\t0x046F: { /* n:\"BrtBeginConditionalFormattings\", */ T:1 },\n\t0x0470: { /* n:\"BrtEndConditionalFormattings\", */ T:-1 },\n\t0x0471: { /* n:\"BrtBeginPCDCalcMemExt\", */ T:1 },\n\t0x0472: { /* n:\"BrtEndPCDCalcMemExt\", */ T:-1 },\n\t0x0473: { /* n:\"BrtBeginPCDCalcMemsExt\", */ T:1 },\n\t0x0474: { /* n:\"BrtEndPCDCalcMemsExt\", */ T:-1 },\n\t0x0475: { /* n:\"BrtPCDField14\" */ },\n\t0x0476: { /* n:\"BrtBeginSlicerStyles\", */ T:1 },\n\t0x0477: { /* n:\"BrtEndSlicerStyles\", */ T:-1 },\n\t0x0478: { /* n:\"BrtBeginSlicerStyleElements\", */ T:1 },\n\t0x0479: { /* n:\"BrtEndSlicerStyleElements\", */ T:-1 },\n\t0x047A: { /* n:\"BrtCFRuleExt\" */ },\n\t0x047B: { /* n:\"BrtBeginSXCondFmt14\", */ T:1 },\n\t0x047C: { /* n:\"BrtEndSXCondFmt14\", */ T:-1 },\n\t0x047D: { /* n:\"BrtBeginSXCondFmts14\", */ T:1 },\n\t0x047E: { /* n:\"BrtEndSXCondFmts14\", */ T:-1 },\n\t0x0480: { /* n:\"BrtBeginSortCond14\", */ T:1 },\n\t0x0481: { /* n:\"BrtEndSortCond14\", */ T:-1 },\n\t0x0482: { /* n:\"BrtEndDVals14\", */ T:-1 },\n\t0x0483: { /* n:\"BrtEndIconSet14\", */ T:-1 },\n\t0x0484: { /* n:\"BrtEndDatabar14\", */ T:-1 },\n\t0x0485: { /* n:\"BrtBeginColorScale14\", */ T:1 },\n\t0x0486: { /* n:\"BrtEndColorScale14\", */ T:-1 },\n\t0x0487: { /* n:\"BrtBeginSxrules14\", */ T:1 },\n\t0x0488: { /* n:\"BrtEndSxrules14\", */ T:-1 },\n\t0x0489: { /* n:\"BrtBeginPRule14\", */ T:1 },\n\t0x048A: { /* n:\"BrtEndPRule14\", */ T:-1 },\n\t0x048B: { /* n:\"BrtBeginPRFilters14\", */ T:1 },\n\t0x048C: { /* n:\"BrtEndPRFilters14\", */ T:-1 },\n\t0x048D: { /* n:\"BrtBeginPRFilter14\", */ T:1 },\n\t0x048E: { /* n:\"BrtEndPRFilter14\", */ T:-1 },\n\t0x048F: { /* n:\"BrtBeginPRFItem14\", */ T:1 },\n\t0x0490: { /* n:\"BrtEndPRFItem14\", */ T:-1 },\n\t0x0491: { /* n:\"BrtBeginCellIgnoreECs14\", */ T:1 },\n\t0x0492: { /* n:\"BrtEndCellIgnoreECs14\", */ T:-1 },\n\t0x0493: { /* n:\"BrtDxf14\" */ },\n\t0x0494: { /* n:\"BrtBeginDxF14s\", */ T:1 },\n\t0x0495: { /* n:\"BrtEndDxf14s\", */ T:-1 },\n\t0x0499: { /* n:\"BrtFilter14\" */ },\n\t0x049A: { /* n:\"BrtBeginCustomFilters14\", */ T:1 },\n\t0x049C: { /* n:\"BrtCustomFilter14\" */ },\n\t0x049D: { /* n:\"BrtIconFilter14\" */ },\n\t0x049E: { /* n:\"BrtPivotCacheConnectionName\" */ },\n\t0x0800: { /* n:\"BrtBeginDecoupledPivotCacheIDs\", */ T:1 },\n\t0x0801: { /* n:\"BrtEndDecoupledPivotCacheIDs\", */ T:-1 },\n\t0x0802: { /* n:\"BrtDecoupledPivotCacheID\" */ },\n\t0x0803: { /* n:\"BrtBeginPivotTableRefs\", */ T:1 },\n\t0x0804: { /* n:\"BrtEndPivotTableRefs\", */ T:-1 },\n\t0x0805: { /* n:\"BrtPivotTableRef\" */ },\n\t0x0806: { /* n:\"BrtSlicerCacheBookPivotTables\" */ },\n\t0x0807: { /* n:\"BrtBeginSxvcells\", */ T:1 },\n\t0x0808: { /* n:\"BrtEndSxvcells\", */ T:-1 },\n\t0x0809: { /* n:\"BrtBeginSxRow\", */ T:1 },\n\t0x080A: { /* n:\"BrtEndSxRow\", */ T:-1 },\n\t0x080C: { /* n:\"BrtPcdCalcMem15\" */ },\n\t0x0813: { /* n:\"BrtQsi15\" */ },\n\t0x0814: { /* n:\"BrtBeginWebExtensions\", */ T:1 },\n\t0x0815: { /* n:\"BrtEndWebExtensions\", */ T:-1 },\n\t0x0816: { /* n:\"BrtWebExtension\" */ },\n\t0x0817: { /* n:\"BrtAbsPath15\" */ },\n\t0x0818: { /* n:\"BrtBeginPivotTableUISettings\", */ T:1 },\n\t0x0819: { /* n:\"BrtEndPivotTableUISettings\", */ T:-1 },\n\t0x081B: { /* n:\"BrtTableSlicerCacheIDs\" */ },\n\t0x081C: { /* n:\"BrtTableSlicerCacheID\" */ },\n\t0x081D: { /* n:\"BrtBeginTableSlicerCache\", */ T:1 },\n\t0x081E: { /* n:\"BrtEndTableSlicerCache\", */ T:-1 },\n\t0x081F: { /* n:\"BrtSxFilter15\" */ },\n\t0x0820: { /* n:\"BrtBeginTimelineCachePivotCacheIDs\", */ T:1 },\n\t0x0821: { /* n:\"BrtEndTimelineCachePivotCacheIDs\", */ T:-1 },\n\t0x0822: { /* n:\"BrtTimelineCachePivotCacheID\" */ },\n\t0x0823: { /* n:\"BrtBeginTimelineCacheIDs\", */ T:1 },\n\t0x0824: { /* n:\"BrtEndTimelineCacheIDs\", */ T:-1 },\n\t0x0825: { /* n:\"BrtBeginTimelineCacheID\", */ T:1 },\n\t0x0826: { /* n:\"BrtEndTimelineCacheID\", */ T:-1 },\n\t0x0827: { /* n:\"BrtBeginTimelinesEx\", */ T:1 },\n\t0x0828: { /* n:\"BrtEndTimelinesEx\", */ T:-1 },\n\t0x0829: { /* n:\"BrtBeginTimelineEx\", */ T:1 },\n\t0x082A: { /* n:\"BrtEndTimelineEx\", */ T:-1 },\n\t0x082B: { /* n:\"BrtWorkBookPr15\" */ },\n\t0x082C: { /* n:\"BrtPCDH15\" */ },\n\t0x082D: { /* n:\"BrtBeginTimelineStyle\", */ T:1 },\n\t0x082E: { /* n:\"BrtEndTimelineStyle\", */ T:-1 },\n\t0x082F: { /* n:\"BrtTimelineStyleElement\" */ },\n\t0x0830: { /* n:\"BrtBeginTimelineStylesheetExt15\", */ T:1 },\n\t0x0831: { /* n:\"BrtEndTimelineStylesheetExt15\", */ T:-1 },\n\t0x0832: { /* n:\"BrtBeginTimelineStyles\", */ T:1 },\n\t0x0833: { /* n:\"BrtEndTimelineStyles\", */ T:-1 },\n\t0x0834: { /* n:\"BrtBeginTimelineStyleElements\", */ T:1 },\n\t0x0835: { /* n:\"BrtEndTimelineStyleElements\", */ T:-1 },\n\t0x0836: { /* n:\"BrtDxf15\" */ },\n\t0x0837: { /* n:\"BrtBeginDxfs15\", */ T:1 },\n\t0x0838: { /* n:\"BrtEndDxfs15\", */ T:-1 },\n\t0x0839: { /* n:\"BrtSlicerCacheHideItemsWithNoData\" */ },\n\t0x083A: { /* n:\"BrtBeginItemUniqueNames\", */ T:1 },\n\t0x083B: { /* n:\"BrtEndItemUniqueNames\", */ T:-1 },\n\t0x083C: { /* n:\"BrtItemUniqueName\" */ },\n\t0x083D: { /* n:\"BrtBeginExtConn15\", */ T:1 },\n\t0x083E: { /* n:\"BrtEndExtConn15\", */ T:-1 },\n\t0x083F: { /* n:\"BrtBeginOledbPr15\", */ T:1 },\n\t0x0840: { /* n:\"BrtEndOledbPr15\", */ T:-1 },\n\t0x0841: { /* n:\"BrtBeginDataFeedPr15\", */ T:1 },\n\t0x0842: { /* n:\"BrtEndDataFeedPr15\", */ T:-1 },\n\t0x0843: { /* n:\"BrtTextPr15\" */ },\n\t0x0844: { /* n:\"BrtRangePr15\" */ },\n\t0x0845: { /* n:\"BrtDbCommand15\" */ },\n\t0x0846: { /* n:\"BrtBeginDbTables15\", */ T:1 },\n\t0x0847: { /* n:\"BrtEndDbTables15\", */ T:-1 },\n\t0x0848: { /* n:\"BrtDbTable15\" */ },\n\t0x0849: { /* n:\"BrtBeginDataModel\", */ T:1 },\n\t0x084A: { /* n:\"BrtEndDataModel\", */ T:-1 },\n\t0x084B: { /* n:\"BrtBeginModelTables\", */ T:1 },\n\t0x084C: { /* n:\"BrtEndModelTables\", */ T:-1 },\n\t0x084D: { /* n:\"BrtModelTable\" */ },\n\t0x084E: { /* n:\"BrtBeginModelRelationships\", */ T:1 },\n\t0x084F: { /* n:\"BrtEndModelRelationships\", */ T:-1 },\n\t0x0850: { /* n:\"BrtModelRelationship\" */ },\n\t0x0851: { /* n:\"BrtBeginECTxtWiz15\", */ T:1 },\n\t0x0852: { /* n:\"BrtEndECTxtWiz15\", */ T:-1 },\n\t0x0853: { /* n:\"BrtBeginECTWFldInfoLst15\", */ T:1 },\n\t0x0854: { /* n:\"BrtEndECTWFldInfoLst15\", */ T:-1 },\n\t0x0855: { /* n:\"BrtBeginECTWFldInfo15\", */ T:1 },\n\t0x0856: { /* n:\"BrtFieldListActiveItem\" */ },\n\t0x0857: { /* n:\"BrtPivotCacheIdVersion\" */ },\n\t0x0858: { /* n:\"BrtSXDI15\" */ },\n\t0x0859: { /* n:\"BrtBeginModelTimeGroupings\", */ T:1 },\n\t0x085A: { /* n:\"BrtEndModelTimeGroupings\", */ T:-1 },\n\t0x085B: { /* n:\"BrtBeginModelTimeGrouping\", */ T:1 },\n\t0x085C: { /* n:\"BrtEndModelTimeGrouping\", */ T:-1 },\n\t0x085D: { /* n:\"BrtModelTimeGroupingCalcCol\" */ },\n\t0x0C00: { /* n:\"BrtUid\" */ },\n\t0x0C01: { /* n:\"BrtRevisionPtr\" */ },\n\t0x1000: { /* n:\"BrtBeginDynamicArrayPr\", */ T:1 },\n\t0x1001: { /* n:\"BrtEndDynamicArrayPr\", */ T:-1 },\n\t0x138A: { /* n:\"BrtBeginRichValueBlock\", */ T:1 },\n\t0x138B: { /* n:\"BrtEndRichValueBlock\", */ T:-1 },\n\t0x13D9: { /* n:\"BrtBeginRichFilters\", */ T:1 },\n\t0x13DA: { /* n:\"BrtEndRichFilters\", */ T:-1 },\n\t0x13DB: { /* n:\"BrtRichFilter\" */ },\n\t0x13DC: { /* n:\"BrtBeginRichFilterColumn\", */ T:1 },\n\t0x13DD: { /* n:\"BrtEndRichFilterColumn\", */ T:-1 },\n\t0x13DE: { /* n:\"BrtBeginCustomRichFilters\", */ T:1 },\n\t0x13DF: { /* n:\"BrtEndCustomRichFilters\", */ T:-1 },\n\t0x13E0: { /* n:\"BrtCustomRichFilter\" */ },\n\t0x13E1: { /* n:\"BrtTop10RichFilter\" */ },\n\t0x13E2: { /* n:\"BrtDynamicRichFilter\" */ },\n\t0x13E4: { /* n:\"BrtBeginRichSortCondition\", */ T:1 },\n\t0x13E5: { /* n:\"BrtEndRichSortCondition\", */ T:-1 },\n\t0x13E6: { /* n:\"BrtRichFilterDateGroupItem\" */ },\n\t0x13E7: { /* n:\"BrtBeginCalcFeatures\", */ T:1 },\n\t0x13E8: { /* n:\"BrtEndCalcFeatures\", */ T:-1 },\n\t0x13E9: { /* n:\"BrtCalcFeature\" */ },\n\t0x13EB: { /* n:\"BrtExternalLinksPr\" */ },\n\t0xFFFF: { n:\"\" }\n};\n\n/* [MS-XLS] 2.3 Record Enumeration (and other sources) */\nvar XLSRecordEnum = {\n\t/* [MS-XLS] 2.3 Record Enumeration 2021-08-17 */\n\t0x0006: { /* n:\"Formula\", */ f:parse_Formula },\n\t0x000a: { /* n:\"EOF\", */ f:parsenoop2 },\n\t0x000c: { /* n:\"CalcCount\", */ f:parseuint16 }, //\n\t0x000d: { /* n:\"CalcMode\", */ f:parseuint16 }, //\n\t0x000e: { /* n:\"CalcPrecision\", */ f:parsebool }, //\n\t0x000f: { /* n:\"CalcRefMode\", */ f:parsebool }, //\n\t0x0010: { /* n:\"CalcDelta\", */ f:parse_Xnum }, //\n\t0x0011: { /* n:\"CalcIter\", */ f:parsebool }, //\n\t0x0012: { /* n:\"Protect\", */ f:parsebool },\n\t0x0013: { /* n:\"Password\", */ f:parseuint16 },\n\t0x0014: { /* n:\"Header\", */ f:parse_XLHeaderFooter },\n\t0x0015: { /* n:\"Footer\", */ f:parse_XLHeaderFooter },\n\t0x0017: { /* n:\"ExternSheet\", */ f:parse_ExternSheet },\n\t0x0018: { /* n:\"Lbl\", */ f:parse_Lbl },\n\t0x0019: { /* n:\"WinProtect\", */ f:parsebool },\n\t0x001a: { /* n:\"VerticalPageBreaks\", */ },\n\t0x001b: { /* n:\"HorizontalPageBreaks\", */ },\n\t0x001c: { /* n:\"Note\", */ f:parse_Note },\n\t0x001d: { /* n:\"Selection\", */ },\n\t0x0022: { /* n:\"Date1904\", */ f:parsebool },\n\t0x0023: { /* n:\"ExternName\", */ f:parse_ExternName },\n\t0x0026: { /* n:\"LeftMargin\", */ f:parse_Xnum }, // *\n\t0x0027: { /* n:\"RightMargin\", */ f:parse_Xnum }, // *\n\t0x0028: { /* n:\"TopMargin\", */ f:parse_Xnum }, // *\n\t0x0029: { /* n:\"BottomMargin\", */ f:parse_Xnum }, // *\n\t0x002a: { /* n:\"PrintRowCol\", */ f:parsebool },\n\t0x002b: { /* n:\"PrintGrid\", */ f:parsebool },\n\t0x002f: { /* n:\"FilePass\", */ f:parse_FilePass },\n\t0x0031: { /* n:\"Font\", */ f:parse_Font },\n\t0x0033: { /* n:\"PrintSize\", */ f:parseuint16 },\n\t0x003c: { /* n:\"Continue\", */ },\n\t0x003d: { /* n:\"Window1\", */ f:parse_Window1 },\n\t0x0040: { /* n:\"Backup\", */ f:parsebool },\n\t0x0041: { /* n:\"Pane\", */ f:parse_Pane },\n\t0x0042: { /* n:\"CodePage\", */ f:parseuint16 },\n\t0x004d: { /* n:\"Pls\", */ },\n\t0x0050: { /* n:\"DCon\", */ },\n\t0x0051: { /* n:\"DConRef\", */ },\n\t0x0052: { /* n:\"DConName\", */ },\n\t0x0055: { /* n:\"DefColWidth\", */ f:parseuint16 },\n\t0x0059: { /* n:\"XCT\", */ },\n\t0x005a: { /* n:\"CRN\", */ },\n\t0x005b: { /* n:\"FileSharing\", */ },\n\t0x005c: { /* n:\"WriteAccess\", */ f:parse_WriteAccess },\n\t0x005d: { /* n:\"Obj\", */ f:parse_Obj },\n\t0x005e: { /* n:\"Uncalced\", */ },\n\t0x005f: { /* n:\"CalcSaveRecalc\", */ f:parsebool }, //\n\t0x0060: { /* n:\"Template\", */ },\n\t0x0061: { /* n:\"Intl\", */ },\n\t0x0063: { /* n:\"ObjProtect\", */ f:parsebool },\n\t0x007d: { /* n:\"ColInfo\", */ f:parse_ColInfo },\n\t0x0080: { /* n:\"Guts\", */ f:parse_Guts },\n\t0x0081: { /* n:\"WsBool\", */ f:parse_WsBool },\n\t0x0082: { /* n:\"GridSet\", */ f:parseuint16 },\n\t0x0083: { /* n:\"HCenter\", */ f:parsebool },\n\t0x0084: { /* n:\"VCenter\", */ f:parsebool },\n\t0x0085: { /* n:\"BoundSheet8\", */ f:parse_BoundSheet8 },\n\t0x0086: { /* n:\"WriteProtect\", */ },\n\t0x008c: { /* n:\"Country\", */ f:parse_Country },\n\t0x008d: { /* n:\"HideObj\", */ f:parseuint16 },\n\t0x0090: { /* n:\"Sort\", */ },\n\t0x0092: { /* n:\"Palette\", */ f:parse_Palette },\n\t0x0097: { /* n:\"Sync\", */ },\n\t0x0098: { /* n:\"LPr\", */ },\n\t0x0099: { /* n:\"DxGCol\", */ },\n\t0x009a: { /* n:\"FnGroupName\", */ },\n\t0x009b: { /* n:\"FilterMode\", */ },\n\t0x009c: { /* n:\"BuiltInFnGroupCount\", */ f:parseuint16 },\n\t0x009d: { /* n:\"AutoFilterInfo\", */ },\n\t0x009e: { /* n:\"AutoFilter\", */ },\n\t0x00a0: { /* n:\"Scl\", */ f:parse_Scl },\n\t0x00a1: { /* n:\"Setup\", */ f:parse_Setup },\n\t0x00ae: { /* n:\"ScenMan\", */ },\n\t0x00af: { /* n:\"SCENARIO\", */ },\n\t0x00b0: { /* n:\"SxView\", */ },\n\t0x00b1: { /* n:\"Sxvd\", */ },\n\t0x00b2: { /* n:\"SXVI\", */ },\n\t0x00b4: { /* n:\"SxIvd\", */ },\n\t0x00b5: { /* n:\"SXLI\", */ },\n\t0x00b6: { /* n:\"SXPI\", */ },\n\t0x00b8: { /* n:\"DocRoute\", */ },\n\t0x00b9: { /* n:\"RecipName\", */ },\n\t0x00bd: { /* n:\"MulRk\", */ f:parse_MulRk },\n\t0x00be: { /* n:\"MulBlank\", */ f:parse_MulBlank },\n\t0x00c1: { /* n:\"Mms\", */ f:parsenoop2 },\n\t0x00c5: { /* n:\"SXDI\", */ },\n\t0x00c6: { /* n:\"SXDB\", */ },\n\t0x00c7: { /* n:\"SXFDB\", */ },\n\t0x00c8: { /* n:\"SXDBB\", */ },\n\t0x00c9: { /* n:\"SXNum\", */ },\n\t0x00ca: { /* n:\"SxBool\", */ f:parsebool },\n\t0x00cb: { /* n:\"SxErr\", */ },\n\t0x00cc: { /* n:\"SXInt\", */ },\n\t0x00cd: { /* n:\"SXString\", */ },\n\t0x00ce: { /* n:\"SXDtr\", */ },\n\t0x00cf: { /* n:\"SxNil\", */ },\n\t0x00d0: { /* n:\"SXTbl\", */ },\n\t0x00d1: { /* n:\"SXTBRGIITM\", */ },\n\t0x00d2: { /* n:\"SxTbpg\", */ },\n\t0x00d3: { /* n:\"ObProj\", */ },\n\t0x00d5: { /* n:\"SXStreamID\", */ },\n\t0x00d7: { /* n:\"DBCell\", */ },\n\t0x00d8: { /* n:\"SXRng\", */ },\n\t0x00d9: { /* n:\"SxIsxoper\", */ },\n\t0x00da: { /* n:\"BookBool\", */ f:parseuint16 },\n\t0x00dc: { /* n:\"DbOrParamQry\", */ },\n\t0x00dd: { /* n:\"ScenarioProtect\", */ f:parsebool },\n\t0x00de: { /* n:\"OleObjectSize\", */ },\n\t0x00e0: { /* n:\"XF\", */ f:parse_XF },\n\t0x00e1: { /* n:\"InterfaceHdr\", */ f:parse_InterfaceHdr },\n\t0x00e2: { /* n:\"InterfaceEnd\", */ f:parsenoop2 },\n\t0x00e3: { /* n:\"SXVS\", */ },\n\t0x00e5: { /* n:\"MergeCells\", */ f:parse_MergeCells },\n\t0x00e9: { /* n:\"BkHim\", */ },\n\t0x00eb: { /* n:\"MsoDrawingGroup\", */ },\n\t0x00ec: { /* n:\"MsoDrawing\", */ },\n\t0x00ed: { /* n:\"MsoDrawingSelection\", */ },\n\t0x00ef: { /* n:\"PhoneticInfo\", */ },\n\t0x00f0: { /* n:\"SxRule\", */ },\n\t0x00f1: { /* n:\"SXEx\", */ },\n\t0x00f2: { /* n:\"SxFilt\", */ },\n\t0x00f4: { /* n:\"SxDXF\", */ },\n\t0x00f5: { /* n:\"SxItm\", */ },\n\t0x00f6: { /* n:\"SxName\", */ },\n\t0x00f7: { /* n:\"SxSelect\", */ },\n\t0x00f8: { /* n:\"SXPair\", */ },\n\t0x00f9: { /* n:\"SxFmla\", */ },\n\t0x00fb: { /* n:\"SxFormat\", */ },\n\t0x00fc: { /* n:\"SST\", */ f:parse_SST },\n\t0x00fd: { /* n:\"LabelSst\", */ f:parse_LabelSst },\n\t0x00ff: { /* n:\"ExtSST\", */ f:parse_ExtSST },\n\t0x0100: { /* n:\"SXVDEx\", */ },\n\t0x0103: { /* n:\"SXFormula\", */ },\n\t0x0122: { /* n:\"SXDBEx\", */ },\n\t0x0137: { /* n:\"RRDInsDel\", */ },\n\t0x0138: { /* n:\"RRDHead\", */ },\n\t0x013b: { /* n:\"RRDChgCell\", */ },\n\t0x013d: { /* n:\"RRTabId\", */ f:parseuint16a },\n\t0x013e: { /* n:\"RRDRenSheet\", */ },\n\t0x013f: { /* n:\"RRSort\", */ },\n\t0x0140: { /* n:\"RRDMove\", */ },\n\t0x014a: { /* n:\"RRFormat\", */ },\n\t0x014b: { /* n:\"RRAutoFmt\", */ },\n\t0x014d: { /* n:\"RRInsertSh\", */ },\n\t0x014e: { /* n:\"RRDMoveBegin\", */ },\n\t0x014f: { /* n:\"RRDMoveEnd\", */ },\n\t0x0150: { /* n:\"RRDInsDelBegin\", */ },\n\t0x0151: { /* n:\"RRDInsDelEnd\", */ },\n\t0x0152: { /* n:\"RRDConflict\", */ },\n\t0x0153: { /* n:\"RRDDefName\", */ },\n\t0x0154: { /* n:\"RRDRstEtxp\", */ },\n\t0x015f: { /* n:\"LRng\", */ },\n\t0x0160: { /* n:\"UsesELFs\", */ f:parsebool },\n\t0x0161: { /* n:\"DSF\", */ f:parsenoop2 },\n\t0x0191: { /* n:\"CUsr\", */ },\n\t0x0192: { /* n:\"CbUsr\", */ },\n\t0x0193: { /* n:\"UsrInfo\", */ },\n\t0x0194: { /* n:\"UsrExcl\", */ },\n\t0x0195: { /* n:\"FileLock\", */ },\n\t0x0196: { /* n:\"RRDInfo\", */ },\n\t0x0197: { /* n:\"BCUsrs\", */ },\n\t0x0198: { /* n:\"UsrChk\", */ },\n\t0x01a9: { /* n:\"UserBView\", */ },\n\t0x01aa: { /* n:\"UserSViewBegin\", */ },\n\t0x01ab: { /* n:\"UserSViewEnd\", */ },\n\t0x01ac: { /* n:\"RRDUserView\", */ },\n\t0x01ad: { /* n:\"Qsi\", */ },\n\t0x01ae: { /* n:\"SupBook\", */ f:parse_SupBook },\n\t0x01af: { /* n:\"Prot4Rev\", */ f:parsebool },\n\t0x01b0: { /* n:\"CondFmt\", */ },\n\t0x01b1: { /* n:\"CF\", */ },\n\t0x01b2: { /* n:\"DVal\", */ },\n\t0x01b5: { /* n:\"DConBin\", */ },\n\t0x01b6: { /* n:\"TxO\", */ f:parse_TxO },\n\t0x01b7: { /* n:\"RefreshAll\", */ f:parsebool }, //\n\t0x01b8: { /* n:\"HLink\", */ f:parse_HLink },\n\t0x01b9: { /* n:\"Lel\", */ },\n\t0x01ba: { /* n:\"CodeName\", */ f:parse_XLUnicodeString },\n\t0x01bb: { /* n:\"SXFDBType\", */ },\n\t0x01bc: { /* n:\"Prot4RevPass\", */ f:parseuint16 },\n\t0x01bd: { /* n:\"ObNoMacros\", */ },\n\t0x01be: { /* n:\"Dv\", */ },\n\t0x01c0: { /* n:\"Excel9File\", */ f:parsenoop2 },\n\t0x01c1: { /* n:\"RecalcId\", */ f:parse_RecalcId, r:2},\n\t0x01c2: { /* n:\"EntExU2\", */ f:parsenoop2 },\n\t0x0200: { /* n:\"Dimensions\", */ f:parse_Dimensions },\n\t0x0201: { /* n:\"Blank\", */ f:parse_Blank },\n\t0x0203: { /* n:\"Number\", */ f:parse_Number },\n\t0x0204: { /* n:\"Label\", */ f:parse_Label },\n\t0x0205: { /* n:\"BoolErr\", */ f:parse_BoolErr },\n\t0x0207: { /* n:\"String\", */ f:parse_String },\n\t0x0208: { /* n:\"Row\", */ f:parse_Row },\n\t0x020b: { /* n:\"Index\", */ },\n\t0x0221: { /* n:\"Array\", */ f:parse_Array },\n\t0x0225: { /* n:\"DefaultRowHeight\", */ f:parse_DefaultRowHeight },\n\t0x0236: { /* n:\"Table\", */ },\n\t0x023e: { /* n:\"Window2\", */ f:parse_Window2 },\n\t0x027e: { /* n:\"RK\", */ f:parse_RK },\n\t0x0293: { /* n:\"Style\", */ },\n\t0x0418: { /* n:\"BigName\", */ },\n\t0x041e: { /* n:\"Format\", */ f:parse_Format },\n\t0x043c: { /* n:\"ContinueBigName\", */ },\n\t0x04bc: { /* n:\"ShrFmla\", */ f:parse_ShrFmla },\n\t0x0800: { /* n:\"HLinkTooltip\", */ f:parse_HLinkTooltip },\n\t0x0801: { /* n:\"WebPub\", */ },\n\t0x0802: { /* n:\"QsiSXTag\", */ },\n\t0x0803: { /* n:\"DBQueryExt\", */ },\n\t0x0804: { /* n:\"ExtString\", */ },\n\t0x0805: { /* n:\"TxtQry\", */ },\n\t0x0806: { /* n:\"Qsir\", */ },\n\t0x0807: { /* n:\"Qsif\", */ },\n\t0x0808: { /* n:\"RRDTQSIF\", */ },\n\t0x0809: { /* n:\"BOF\", */ f:parse_BOF },\n\t0x080a: { /* n:\"OleDbConn\", */ },\n\t0x080b: { /* n:\"WOpt\", */ },\n\t0x080c: { /* n:\"SXViewEx\", */ },\n\t0x080d: { /* n:\"SXTH\", */ },\n\t0x080e: { /* n:\"SXPIEx\", */ },\n\t0x080f: { /* n:\"SXVDTEx\", */ },\n\t0x0810: { /* n:\"SXViewEx9\", */ },\n\t0x0812: { /* n:\"ContinueFrt\", */ },\n\t0x0813: { /* n:\"RealTimeData\", */ },\n\t0x0850: { /* n:\"ChartFrtInfo\", */ },\n\t0x0851: { /* n:\"FrtWrapper\", */ },\n\t0x0852: { /* n:\"StartBlock\", */ },\n\t0x0853: { /* n:\"EndBlock\", */ },\n\t0x0854: { /* n:\"StartObject\", */ },\n\t0x0855: { /* n:\"EndObject\", */ },\n\t0x0856: { /* n:\"CatLab\", */ },\n\t0x0857: { /* n:\"YMult\", */ },\n\t0x0858: { /* n:\"SXViewLink\", */ },\n\t0x0859: { /* n:\"PivotChartBits\", */ },\n\t0x085a: { /* n:\"FrtFontList\", */ },\n\t0x0862: { /* n:\"SheetExt\", */ },\n\t0x0863: { /* n:\"BookExt\", */ r:12},\n\t0x0864: { /* n:\"SXAddl\", */ },\n\t0x0865: { /* n:\"CrErr\", */ },\n\t0x0866: { /* n:\"HFPicture\", */ },\n\t0x0867: { /* n:\"FeatHdr\", */ f:parsenoop2 },\n\t0x0868: { /* n:\"Feat\", */ },\n\t0x086a: { /* n:\"DataLabExt\", */ },\n\t0x086b: { /* n:\"DataLabExtContents\", */ },\n\t0x086c: { /* n:\"CellWatch\", */ },\n\t0x0871: { /* n:\"FeatHdr11\", */ },\n\t0x0872: { /* n:\"Feature11\", */ },\n\t0x0874: { /* n:\"DropDownObjIds\", */ },\n\t0x0875: { /* n:\"ContinueFrt11\", */ },\n\t0x0876: { /* n:\"DConn\", */ },\n\t0x0877: { /* n:\"List12\", */ },\n\t0x0878: { /* n:\"Feature12\", */ },\n\t0x0879: { /* n:\"CondFmt12\", */ },\n\t0x087a: { /* n:\"CF12\", */ },\n\t0x087b: { /* n:\"CFEx\", */ },\n\t0x087c: { /* n:\"XFCRC\", */ f:parse_XFCRC, r:12 },\n\t0x087d: { /* n:\"XFExt\", */ f:parse_XFExt, r:12 },\n\t0x087e: { /* n:\"AutoFilter12\", */ },\n\t0x087f: { /* n:\"ContinueFrt12\", */ },\n\t0x0884: { /* n:\"MDTInfo\", */ },\n\t0x0885: { /* n:\"MDXStr\", */ },\n\t0x0886: { /* n:\"MDXTuple\", */ },\n\t0x0887: { /* n:\"MDXSet\", */ },\n\t0x0888: { /* n:\"MDXProp\", */ },\n\t0x0889: { /* n:\"MDXKPI\", */ },\n\t0x088a: { /* n:\"MDB\", */ },\n\t0x088b: { /* n:\"PLV\", */ },\n\t0x088c: { /* n:\"Compat12\", */ f:parsebool, r:12 },\n\t0x088d: { /* n:\"DXF\", */ },\n\t0x088e: { /* n:\"TableStyles\", */ r:12 },\n\t0x088f: { /* n:\"TableStyle\", */ },\n\t0x0890: { /* n:\"TableStyleElement\", */ },\n\t0x0892: { /* n:\"StyleExt\", */ },\n\t0x0893: { /* n:\"NamePublish\", */ },\n\t0x0894: { /* n:\"NameCmt\", */ f:parse_NameCmt, r:12 },\n\t0x0895: { /* n:\"SortData\", */ },\n\t0x0896: { /* n:\"Theme\", */ f:parse_Theme, r:12 },\n\t0x0897: { /* n:\"GUIDTypeLib\", */ },\n\t0x0898: { /* n:\"FnGrp12\", */ },\n\t0x0899: { /* n:\"NameFnGrp12\", */ },\n\t0x089a: { /* n:\"MTRSettings\", */ f:parse_MTRSettings, r:12 },\n\t0x089b: { /* n:\"CompressPictures\", */ f:parsenoop2 },\n\t0x089c: { /* n:\"HeaderFooter\", */ },\n\t0x089d: { /* n:\"CrtLayout12\", */ },\n\t0x089e: { /* n:\"CrtMlFrt\", */ },\n\t0x089f: { /* n:\"CrtMlFrtContinue\", */ },\n\t0x08a3: { /* n:\"ForceFullCalculation\", */ f:parse_ForceFullCalculation },\n\t0x08a4: { /* n:\"ShapePropsStream\", */ },\n\t0x08a5: { /* n:\"TextPropsStream\", */ },\n\t0x08a6: { /* n:\"RichTextStream\", */ },\n\t0x08a7: { /* n:\"CrtLayout12A\", */ },\n\t0x1001: { /* n:\"Units\", */ },\n\t0x1002: { /* n:\"Chart\", */ },\n\t0x1003: { /* n:\"Series\", */ },\n\t0x1006: { /* n:\"DataFormat\", */ },\n\t0x1007: { /* n:\"LineFormat\", */ },\n\t0x1009: { /* n:\"MarkerFormat\", */ },\n\t0x100a: { /* n:\"AreaFormat\", */ },\n\t0x100b: { /* n:\"PieFormat\", */ },\n\t0x100c: { /* n:\"AttachedLabel\", */ },\n\t0x100d: { /* n:\"SeriesText\", */ },\n\t0x1014: { /* n:\"ChartFormat\", */ },\n\t0x1015: { /* n:\"Legend\", */ },\n\t0x1016: { /* n:\"SeriesList\", */ },\n\t0x1017: { /* n:\"Bar\", */ },\n\t0x1018: { /* n:\"Line\", */ },\n\t0x1019: { /* n:\"Pie\", */ },\n\t0x101a: { /* n:\"Area\", */ },\n\t0x101b: { /* n:\"Scatter\", */ },\n\t0x101c: { /* n:\"CrtLine\", */ },\n\t0x101d: { /* n:\"Axis\", */ },\n\t0x101e: { /* n:\"Tick\", */ },\n\t0x101f: { /* n:\"ValueRange\", */ },\n\t0x1020: { /* n:\"CatSerRange\", */ },\n\t0x1021: { /* n:\"AxisLine\", */ },\n\t0x1022: { /* n:\"CrtLink\", */ },\n\t0x1024: { /* n:\"DefaultText\", */ },\n\t0x1025: { /* n:\"Text\", */ },\n\t0x1026: { /* n:\"FontX\", */ f:parseuint16 },\n\t0x1027: { /* n:\"ObjectLink\", */ },\n\t0x1032: { /* n:\"Frame\", */ },\n\t0x1033: { /* n:\"Begin\", */ },\n\t0x1034: { /* n:\"End\", */ },\n\t0x1035: { /* n:\"PlotArea\", */ },\n\t0x103a: { /* n:\"Chart3d\", */ },\n\t0x103c: { /* n:\"PicF\", */ },\n\t0x103d: { /* n:\"DropBar\", */ },\n\t0x103e: { /* n:\"Radar\", */ },\n\t0x103f: { /* n:\"Surf\", */ },\n\t0x1040: { /* n:\"RadarArea\", */ },\n\t0x1041: { /* n:\"AxisParent\", */ },\n\t0x1043: { /* n:\"LegendException\", */ },\n\t0x1044: { /* n:\"ShtProps\", */ f:parse_ShtProps },\n\t0x1045: { /* n:\"SerToCrt\", */ },\n\t0x1046: { /* n:\"AxesUsed\", */ },\n\t0x1048: { /* n:\"SBaseRef\", */ },\n\t0x104a: { /* n:\"SerParent\", */ },\n\t0x104b: { /* n:\"SerAuxTrend\", */ },\n\t0x104e: { /* n:\"IFmtRecord\", */ },\n\t0x104f: { /* n:\"Pos\", */ },\n\t0x1050: { /* n:\"AlRuns\", */ },\n\t0x1051: { /* n:\"BRAI\", */ },\n\t0x105b: { /* n:\"SerAuxErrBar\", */ },\n\t0x105c: { /* n:\"ClrtClient\", */ f:parse_ClrtClient },\n\t0x105d: { /* n:\"SerFmt\", */ },\n\t0x105f: { /* n:\"Chart3DBarShape\", */ },\n\t0x1060: { /* n:\"Fbi\", */ },\n\t0x1061: { /* n:\"BopPop\", */ },\n\t0x1062: { /* n:\"AxcExt\", */ },\n\t0x1063: { /* n:\"Dat\", */ },\n\t0x1064: { /* n:\"PlotGrowth\", */ },\n\t0x1065: { /* n:\"SIIndex\", */ },\n\t0x1066: { /* n:\"GelFrame\", */ },\n\t0x1067: { /* n:\"BopPopCustom\", */ },\n\t0x1068: { /* n:\"Fbi2\", */ },\n\n\t0x0000: { /* n:\"Dimensions\", */ f:parse_Dimensions },\n\t0x0001: { /* n:\"BIFF2BLANK\", */ },\n\t0x0002: { /* n:\"BIFF2INT\", */ f:parse_BIFF2INT },\n\t0x0003: { /* n:\"BIFF2NUM\", */ f:parse_BIFF2NUM },\n\t0x0004: { /* n:\"BIFF2STR\", */ f:parse_BIFF2STR },\n\t0x0005: { /* n:\"BIFF2BOOLERR\", */ f:parse_BIFF2BOOLERR },\n\t0x0007: { /* n:\"String\", */ f:parse_BIFF2STRING },\n\t0x0008: { /* n:\"BIFF2ROW\", */ },\n\t0x0009: { /* n:\"BOF\", */ f:parse_BOF },\n\t0x000b: { /* n:\"Index\", */ },\n\t0x0016: { /* n:\"ExternCount\", */ f:parseuint16 },\n\t0x001e: { /* n:\"BIFF2FORMAT\", */ f:parse_BIFF2Format },\n\t0x001f: { /* n:\"BIFF2FMTCNT\", */ }, /* 16-bit cnt of BIFF2FORMAT records */\n\t0x0020: { /* n:\"BIFF2COLINFO\", */ },\n\t0x0021: { /* n:\"Array\", */ f:parse_Array },\n\t0x0024: { /* n:\"COLWIDTH\", */ },\n\t0x0025: { /* n:\"DefaultRowHeight\", */ f:parse_DefaultRowHeight },\n\t// 0x002c ??\n\t// 0x002d ??\n\t// 0x002e ??\n\t// 0x0030 FONTCOUNT: number of fonts\n\t0x0032: { /* n:\"BIFF2FONTXTRA\", */ f:parse_BIFF2FONTXTRA },\n\t// 0x0035: INFOOPTS\n\t// 0x0036: TABLE (BIFF2 only)\n\t// 0x0037: TABLE2 (BIFF2 only)\n\t// 0x0038: WNDESK\n\t// 0x0039 ??\n\t// 0x003a: BEGINPREF\n\t// 0x003b: ENDPREF\n\t0x003e: { /* n:\"BIFF2WINDOW2\", */ },\n\t// 0x003f ??\n\t// 0x0046: SHOWSCROLL\n\t// 0x0047: SHOWFORMULA\n\t// 0x0048: STATUSBAR\n\t// 0x0049: SHORTMENUS\n\t// 0x004A:\n\t// 0x004B:\n\t// 0x004C:\n\t// 0x004E:\n\t// 0x004F:\n\t// 0x0058: TOOLBAR (BIFF3)\n\n\t/* - - - */\n\t0x0034: { /* n:\"DDEObjName\", */ },\n\t0x0043: { /* n:\"BIFF2XF\", */ f:parse_BIFF2XF },\n\t0x0044: { /* n:\"BIFF2XFINDEX\", */ f:parseuint16 },\n\t0x0045: { /* n:\"BIFF2FONTCLR\", */ },\n\t0x0056: { /* n:\"BIFF4FMTCNT\", */ }, /* 16-bit cnt, similar to BIFF2 */\n\t0x007e: { /* n:\"RK\", */ }, /* Not necessarily same as 0x027e */\n\t0x007f: { /* n:\"ImData\", */ f:parse_ImData },\n\t0x0087: { /* n:\"Addin\", */ },\n\t0x0088: { /* n:\"Edg\", */ },\n\t0x0089: { /* n:\"Pub\", */ },\n\t// 0x8A\n\t// 0x8B LH: alternate menu key flag (BIFF3/4)\n\t// 0x8E\n\t0x008F: { /* n:\"BIFF4SheetInfo\", */ f:parse_BIFF4SheetInfo },\n\t0x0091: { /* n:\"Sub\", */ },\n\t// 0x93 STYLE\n\t0x0094: { /* n:\"LHRecord\", */ },\n\t0x0095: { /* n:\"LHNGraph\", */ },\n\t0x0096: { /* n:\"Sound\", */ },\n\t// 0xA2 FNPROTO: function prototypes (BIFF4)\n\t// 0xA3\n\t// 0xA8\n\t0x00a9: { /* n:\"CoordList\", */ },\n\t0x00ab: { /* n:\"GCW\", */ },\n\t0x00bc: { /* n:\"ShrFmla\", */ }, /* Not necessarily same as 0x04bc */\n\t0x00bf: { /* n:\"ToolbarHdr\", */ },\n\t0x00c0: { /* n:\"ToolbarEnd\", */ },\n\t0x00c2: { /* n:\"AddMenu\", */ },\n\t0x00c3: { /* n:\"DelMenu\", */ },\n\t0x00d6: { /* n:\"RString\", */ f:parse_RString },\n\t0x00df: { /* n:\"UDDesc\", */ },\n\t0x00ea: { /* n:\"TabIdConf\", */ },\n\t0x0162: { /* n:\"XL5Modify\", */ },\n\t0x01a5: { /* n:\"FileSharing2\", */ },\n\t0x0206: { /* n:\"Formula\", */ f:parse_Formula },\n\t0x0209: { /* n:\"BOF\", */ f:parse_BOF },\n\t0x0218: { /* n:\"Lbl\", */ f:parse_Lbl },\n\t0x0223: { /* n:\"ExternName\", */ f:parse_ExternName },\n\t0x0231: { /* n:\"Font\", */ },\n\t0x0243: { /* n:\"BIFF3XF\", */ f:parse_BIFF3XF },\n\t0x0406: { /* n:\"Formula\", */ f:parse_Formula },\n\t0x0409: { /* n:\"BOF\", */ f:parse_BOF },\n\t0x0443: { /* n:\"BIFF4XF\", */ f:parse_BIFF4XF },\n\t0x086d: { /* n:\"FeatInfo\", */ },\n\t0x0873: { /* n:\"FeatInfo11\", */ },\n\t0x0881: { /* n:\"SXAddl12\", */ },\n\t0x08c0: { /* n:\"AutoWebPub\", */ },\n\t0x08c1: { /* n:\"ListObj\", */ },\n\t0x08c2: { /* n:\"ListField\", */ },\n\t0x08c3: { /* n:\"ListDV\", */ },\n\t0x08c4: { /* n:\"ListCondFmt\", */ },\n\t0x08c5: { /* n:\"ListCF\", */ },\n\t0x08c6: { /* n:\"FMQry\", */ },\n\t0x08c7: { /* n:\"FMSQry\", */ },\n\t0x08c8: { /* n:\"PLV\", */ },\n\t0x08c9: { /* n:\"LnExt\", */ },\n\t0x08ca: { /* n:\"MkrExt\", */ },\n\t0x08cb: { /* n:\"CrtCoopt\", */ },\n\t0x08d6: { /* n:\"FRTArchId$\", */ r:12 },\n\n\t/* --- multiplan 4 records --- */\n\t0x0065: { /* n:\"\", */ }, // one per window\n\t0x0066: { /* n:\"\", */ }, // calc settings\n\t0x0069: { /* n:\"\", */ }, // print header\n\t0x006a: { /* n:\"\", */ }, // print footer\n\t0x006b: { /* n:\"\", */ }, // print settings\n\t0x006d: { /* n:\"\", */ }, // one per window\n\t0x0070: { /* n:\"\", */ }, // includes default col width\n\t0x0072: { /* n:\"\", */ }, // includes selected cell\n\n\t0x7262: {}\n};\n\nfunction write_biff_rec(ba/*:BufArray*/, type/*:number*/, payload, length/*:?number*/)/*:void*/ {\n\tvar t/*:number*/ = type;\n\tif(isNaN(t)) return;\n\tvar len = length || (payload||[]).length || 0;\n\tvar o = ba.next(4);\n\to.write_shift(2, t);\n\to.write_shift(2, len);\n\tif(/*:: len != null &&*/len > 0 && is_buf(payload)) ba.push(payload);\n}\n\nfunction write_biff_continue(ba/*:BufArray*/, type/*:number*/, payload, length/*:?number*/)/*:void*/ {\n\tvar len = length || (payload||[]).length || 0;\n\tif(len <= 8224) return write_biff_rec(ba, type, payload, len);\n\tvar t = type;\n\tif(isNaN(t)) return;\n\tvar parts = payload.parts || [], sidx = 0;\n\tvar i = 0, w = 0;\n\twhile(w + (parts[sidx] || 8224) <= 8224) { w+= (parts[sidx] || 8224); sidx++; }\n\tvar o = ba.next(4);\n\to.write_shift(2, t);\n\to.write_shift(2, w);\n\tba.push(payload.slice(i, i + w));\n\ti += w;\n\twhile(i < len) {\n\t\to = ba.next(4);\n\t\to.write_shift(2, 0x3c); // TODO: figure out correct continue type\n\t\tw = 0;\n\t\twhile(w + (parts[sidx] || 8224) <= 8224) { w+= (parts[sidx] || 8224); sidx++; }\n\t\to.write_shift(2, w);\n\t\tba.push(payload.slice(i, i+w)); i+= w;\n\t}\n}\n\nfunction write_BIFF2BERR(r/*:number*/, c/*:number*/, val, t/*:?string*/) {\n\tvar out = new_buf(9);\n\twrite_BIFF2Cell(out, r, c);\n\twrite_Bes(val, t || 'b', out);\n\treturn out;\n}\n\n/* TODO: codepage, large strings */\nfunction write_BIFF2LABEL(r/*:number*/, c/*:number*/, val) {\n\tvar out = new_buf(8 + 2*val.length);\n\twrite_BIFF2Cell(out, r, c);\n\tout.write_shift(1, val.length);\n\tout.write_shift(val.length, val, 'sbcs');\n\treturn out.l < out.length ? out.slice(0, out.l) : out;\n}\n\nfunction write_comments_biff2(ba/*:BufArray*/, comments/*:Array<[Comment[], number, number]>*/) {\n\tcomments.forEach(function(data) {\n\t\tvar text = data[0].map(function(cc) { return cc.t; }).join(\"\");\n\t\t// TODO: should '\\n' be translated to '\\r' to correct for Excel 5.0 bug when exporting to BIFF2/3 ?\n\t\tif(text.length <= 2048) return write_biff_rec(ba, 0x001C, write_NOTE_BIFF2(text, data[1], data[2]));\n\t\twrite_biff_rec(ba, 0x001C, write_NOTE_BIFF2(text.slice(0, 2048), data[1], data[2], text.length));\n\t\tfor(var i = 2048; i < text.length; i += 2048)\n\t\t\twrite_biff_rec(ba, 0x001C, write_NOTE_BIFF2(text.slice(i, Math.min(i+2048, text.length)), -1, -1, Math.min(2048, text.length - i)));\n\t});\n}\n\n/* TODO: BIFF3/4 use different records -- see comments*/\nfunction write_ws_biff2_cell(ba/*:BufArray*/, cell/*:Cell*/, R/*:number*/, C/*:number*/, opts, date1904/*:boolean*/) {\n\tvar ifmt = 0;\n\tif(cell.z != null) {\n\t\tifmt = opts._BIFF2FmtTable.indexOf(cell.z);\n\t\tif(ifmt == -1) { opts._BIFF2FmtTable.push(cell.z); ifmt = opts._BIFF2FmtTable.length - 1; }\n\t}\n\tvar ixfe = 0;\n\tif(cell.z != null) {\n\t\tfor(; ixfe < opts.cellXfs.length; ++ixfe) if(opts.cellXfs[ixfe].numFmtId == ifmt) break;\n\t\tif(ixfe == opts.cellXfs.length) opts.cellXfs.push({numFmtId: ifmt});\n\t}\n\tif(cell.v != null) switch(cell.t) {\n\t\tcase 'd': case 'n':\n\t\t\tvar v = cell.t == 'd' ? datenum(parseDate(cell.v, date1904), date1904) : cell.v;\n\t\t\tif(opts.biff == 2 && (v == (v|0)) && (v >= 0) && (v < 65536))\n\t\t\t\t// 0x027E (RK) in BIFF3/4\n\t\t\t\twrite_biff_rec(ba, 0x0002, write_BIFF2INT(R, C, v, ixfe, ifmt));\n\t\t\telse if(isNaN(v))\n\t\t\t\t// 0x0205 in BIFF3/4\n\t\t\t\twrite_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, 0x24, \"e\")); // #NUM!\n\t\t\telse if(!isFinite(v))\n\t\t\t\t// 0x0205 in BIFF3/4\n\t\t\t\twrite_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, 0x07, \"e\")); // #DIV/0!\n\t\t\telse\n\t\t\t\t// 0x0203 in BIFF3/4\n\t\t\t\twrite_biff_rec(ba, 0x0003, write_BIFF2NUM(R,C, v, ixfe, ifmt));\n\t\t\treturn;\n\t\tcase 'b': case 'e':\n\t\t\t// 0x0205 in BIFF3/4\n\t\t\twrite_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, cell.v, cell.t)); return;\n\t\t/* TODO: codepage, sst */\n\t\tcase 's': case 'str':\n\t\t\t// 0x0204 in BIFF3/4\n\t\t\twrite_biff_rec(ba, 0x0004, write_BIFF2LABEL(R, C, cell.v == null ? \"\" : String(cell.v).slice(0,255)));\n\t\t\treturn;\n\t}\n\t// 0x0201 in BIFF3/4\n\twrite_biff_rec(ba, 0x0001, write_BIFF2Cell(null, R, C));\n}\n\nfunction write_ws_biff2(ba/*:BufArray*/, ws/*:Worksheet*/, idx/*:number*/, opts, wb/*:Workbook*/) {\n\tvar dense = ws[\"!data\"] != null;\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), rr = \"\", cols/*:Array<string>*/ = [];\n\tif(range.e.c > 0xFF || range.e.r > 0x3FFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n\t\trange.e.c = Math.min(range.e.c, 0xFF);\n\t\trange.e.r = Math.min(range.e.r, 0x3FFF);\n\t}\n\tvar date1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\tvar row = [], comments = [];\n\t/* TODO: 0x0000 / 0x0200 dimensions? */\n\tfor(var C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\tif(dense) row = ws[\"!data\"][R] || [];\n\t\trr = encode_row(R);\n\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tvar cell = dense ? row[C] : ws[cols[C] + rr];\n\t\t\tif(!cell) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_biff2_cell(ba, cell, R, C, opts, date1904);\n\t\t\tif(cell.c) comments.push([cell.c, R, C]);\n\t\t}\n\t}\n\n\t/* ... 0x12 0x19 0x13 (Password) */\n\twrite_comments_biff2(ba, comments);\n\t/* 0x3d (Window1) ... */\n}\n\n/* Based on test files */\nfunction write_biff2_buf(wb/*:Workbook*/, opts/*:WriteOpts*/) {\n\tvar o = opts || {};\n\n\tvar ba = buf_array();\n\tvar idx = 0;\n\tfor(var i=0;i<wb.SheetNames.length;++i) if(wb.SheetNames[i] == o.sheet) idx=i;\n\tif(idx == 0 && !!o.sheet && wb.SheetNames[0] != o.sheet) throw new Error(\"Sheet not found: \" + o.sheet);\n\twrite_biff_rec(ba, (o.biff == 4 ? 0x0409 : (o.biff == 3 ? 0x0209 : 0x0009)), write_BOF(wb, 0x10, o));\n\tif(((wb.Workbook||{}).WBProps||{}).date1904) write_biff_rec(ba, 0x0022, writebool(true));\n\to.cellXfs = [{numFmtId: 0}];\n\to._BIFF2FmtTable/*:Array<string>*/ = [\"General\"]; o._Fonts = [];\n\tvar body = buf_array();\n\twrite_ws_biff2(body, wb.Sheets[wb.SheetNames[idx]], idx, o, wb);\n\n\to._BIFF2FmtTable.forEach(function(f) {\n\t\tif(o.biff <= 3) write_biff_rec(ba, 0x001E, write_BIFF2Format(f));\n\t\telse write_biff_rec(ba, 0x041E, write_BIFF4Format(f));\n\t});\n\to.cellXfs.forEach(function(xf) {\n\t\tswitch(o.biff) {\n\t\t\tcase 2: write_biff_rec(ba, 0x0043, write_BIFF2XF(xf)); break;\n\t\t\tcase 3: write_biff_rec(ba, 0x0243, write_BIFF3XF(xf)); break;\n\t\t\tcase 4: write_biff_rec(ba, 0x0443, write_BIFF4XF(xf)); break;\n\t\t}\n\t});\n\tdelete o._BIFF2FmtTable; delete o.cellXfs; delete o._Fonts;\n\n\tba.push(body.end());\n\twrite_biff_rec(ba, 0x000A);\n\treturn ba.end();\n}\n\nvar b8oid = 1, b8ocnts/*:Array<[number, number, number]>*/ = [];\nfunction write_MsoDrawingGroup() {\n\tvar buf = new_buf(82 + 8 * b8ocnts.length);\n\t/* [MS-ODRAW] 2.2.12 OfficeArtDggContainer */\n\tbuf.write_shift(2, 0x0F);\n\tbuf.write_shift(2, 0xF000);\n\tbuf.write_shift(4, 74 + 8 * b8ocnts.length);\n\t/* 2.2.48 OfficeArtFDGGBlock */\n\t{\n\t\tbuf.write_shift(2, 0);\n\t\tbuf.write_shift(2, 0xF006);\n\t\tbuf.write_shift(4, 16 + 8 * b8ocnts.length);\n\t\t/* 2.2.47 OfficeArtFDGG */\n\t\t{\n\t\t\tbuf.write_shift(4, b8oid);\n\t\t\tbuf.write_shift(4, b8ocnts.length+1);\n\t\t\tvar acc = 0; for(var i = 0; i < b8ocnts.length; ++i) acc += (b8ocnts[i] && b8ocnts[i][1] || 0); buf.write_shift(4, acc);\n\t\t\tbuf.write_shift(4, b8ocnts.length);\n\t\t}\n\t\t/* 2.2.46 OfficeArtIDCL + */\n\t\tb8ocnts.forEach(function(b8) {\n\t\t\tbuf.write_shift(4, b8[0]);\n\t\t\tbuf.write_shift(4, b8[2]);\n\t\t});\n\t}\n\t/* 2.2.9 OfficeArtFOPT */\n\t{\n\t\tbuf.write_shift(2, 0x33); // 0x03 | (3 << 4)\n\t\tbuf.write_shift(2, 0xF00B);\n\t\tbuf.write_shift(4, 0x12); // 3 * 6\n\t\t/* 2.3.21.15 Text Boolean Properties */\n\t\tbuf.write_shift(2, 0xBF); buf.write_shift(4, 0x00080008);\n\t\t/* 2.3.7.2 fillColor */\n\t\tbuf.write_shift(2, 0x0181); buf.write_shift(4, 0x08000041);\n\t\t/* 2.3.8.1 lineColor */\n\t\tbuf.write_shift(2, 0x01C0); buf.write_shift(4, 0x08000040);\n\t}\n\t/* 2.2.45 OfficeArtSplitMenuColorContainer */\n\t{\n\t\tbuf.write_shift(2, 0x40);\n\t\tbuf.write_shift(2, 0xF11E);\n\t\tbuf.write_shift(4, 16);\n\t\tbuf.write_shift(4, 0x0800000D);\n\t\tbuf.write_shift(4, 0x0800000C);\n\t\tbuf.write_shift(4, 0x08000017);\n\t\tbuf.write_shift(4, 0x100000F7);\n\t}\n\treturn buf;\n}\nfunction write_comments_biff8(ba/*:BufArray*/, comments/*:Array<[Comment[], number, number]>*/) {\n\tvar notes/*:Array<RawData>*/ = [], sz = 0, pl = buf_array(), baseid = b8oid;\n\tvar _oasc;\n\tcomments.forEach(function(c, ci) {\n\t\tvar author = \"\";\n\t\tvar text = c[0].map(function(t) { if(t.a && !author) author = t.a; return t.t; }).join(\"\");\n\t\t++b8oid;\n\n\t\t/* 2.2.14 OfficeArtSpContainer */\n\t\t{\n\t\t\tvar oasc = new_buf(0x96);\n\t\t\toasc.write_shift(2, 0x0F);\n\t\t\toasc.write_shift(2, 0xF004);\n\t\t\toasc.write_shift(4, 0x96);\n\t\t\t/* 2.2.40 OfficeArtFSP */\n\t\t\t{\n\t\t\t\toasc.write_shift(2, 0xca2); // 0x02 | (0xca << 4)\n\t\t\t\toasc.write_shift(2, 0xF00A);\n\t\t\t\toasc.write_shift(4, 8);\n\t\t\t\toasc.write_shift(4, b8oid);\n\t\t\t\toasc.write_shift(4, 0xA00);\n\t\t\t}\n\t\t\t/* 2.2.9 OfficeArtFOPT */\n\t\t\t{\n\t\t\t\toasc.write_shift(2, 0xE3); // 0x03 | (14 << 4)\n\t\t\t\toasc.write_shift(2, 0xF00B);\n\t\t\t\toasc.write_shift(4, 0x54); // 14 * 6\n\t\t\t\t/* 2.3.21.1 ITxid */\n\t\t\t\toasc.write_shift(2, 0x80); oasc.write_shift(4, 0);\n\t\t\t\t/* 2.3.21.12 txdir */\n\t\t\t\toasc.write_shift(2, 0x8B); oasc.write_shift(4, 0x02);\n\t\t\t\t/* 2.3.21.15 Text Boolean Properties */\n\t\t\t\toasc.write_shift(2, 0xBF); oasc.write_shift(4, 0x00080008);\n\t\t\t\t/* 2.3.6.30 cxk */\n\t\t\t\toasc.write_shift(2, 0x0158); oasc.l += 4;\n\t\t\t\t/* 2.3.7.2 fillColor */\n\t\t\t\toasc.write_shift(2, 0x0181); oasc.write_shift(4, 0x08000050);\n\t\t\t\t/* 2.3.7.4 fillBackColor */\n\t\t\t\toasc.write_shift(2, 0x0183); oasc.write_shift(4, 0x08000050);\n\t\t\t\t/* 2.3.7.6 fillCrMod */\n\t\t\t\toasc.write_shift(2, 0x0185); oasc.write_shift(4, 0x100000F4);\n\t\t\t\t/* 2.3.7.43 Fill Style Boolean Properties */\n\t\t\t\toasc.write_shift(2, 0x01BF); oasc.write_shift(4, 0x00100010);\n\t\t\t\t/* 2.3.8.1 lineColor */\n\t\t\t\toasc.write_shift(2, 0x01C0); oasc.write_shift(4, 0x08000051);\n\t\t\t\t/* 2.3.8.4 lineCrMod */\n\t\t\t\toasc.write_shift(2, 0x01C3); oasc.write_shift(4, 0x100000F4);\n\t\t\t\t/* 2.3.13.2 shadowColor */\n\t\t\t\toasc.write_shift(2, 0x0201); oasc.write_shift(4, 0x08000051);\n\t\t\t\t/* 2.3.13.4 shadowCrMod */\n\t\t\t\toasc.write_shift(2, 0x0203); oasc.write_shift(4, 0x100000F4);\n\t\t\t\t/* 2.3.13.23 Shadow Style Boolean Properties */\n\t\t\t\toasc.write_shift(2, 0x023F); oasc.write_shift(4, 0x00030001);\n\t\t\t\t/* 2.3.4.44 Group Shape Boolean Properties */\n\t\t\t\toasc.write_shift(2, 0x03BF); oasc.write_shift(4, 0x00020000 | (c[0].hidden ? 2 : 0));\n\t\t\t}\n\t\t\t/* [MS-XLS] 2.5.193 OfficeArtClientAnchorSheet */\n\t\t\t{\n\t\t\t\toasc.l += 2;\n\t\t\t\toasc.write_shift(2, 0xF010);\n\t\t\t\toasc.write_shift(4, 0x12);\n\t\t\t\toasc.write_shift(2, 0x3); // do not move or size with cells\n\t\t\t\toasc.write_shift(2, c[2] + 2); oasc.l += 2;\n\t\t\t\toasc.write_shift(2, c[1] + 1); oasc.l += 2;\n\t\t\t\toasc.write_shift(2, c[2] + 4); oasc.l += 2;\n\t\t\t\toasc.write_shift(2, c[1] + 5); oasc.l += 2;\n\t\t\t}\n\t\t\t/* [MS-XLS] 2.5.194 OfficeArtClientData */\n\t\t\t{\n\t\t\t\toasc.l += 2;\n\t\t\t\toasc.write_shift(2, 0xF011);\n\t\t\t\toasc.l += 4;\n\t\t\t}\n\t\t\toasc.l = 0x96;\n\t\t\tif(ci == 0) /* write_biff_rec(pl, 0x003C, oasc); */ _oasc = oasc;\n\t\t\telse write_biff_rec(pl, 0x00EC, oasc);\n\t\t}\n\t\tsz += 0x96;\n\n\t\t/* [MS-XLS] 2.4.181 Obj */\n\t\t{\n\t\t\tvar obj = new_buf(52); // 22 + 26 + 4\n\t\t\t/* [MS-XLS] 2.5.143 FtCmo */\n\t\t\tobj.write_shift(2, 0x15);\n\t\t\tobj.write_shift(2, 0x12);\n\t\t\tobj.write_shift(2, 0x19);\n\t\t\tobj.write_shift(2, b8oid);\n\t\t\tobj.write_shift(2, 0);\n\t\t\tobj.l = 22;\n\t\t\t/* [MS-XLS] 2.5.149 FtNts */\n\t\t\tobj.write_shift(2, 0x0D);\n\t\t\tobj.write_shift(2, 0x16);\n\t\t\tobj.write_shift(4, 0x62726272);\n\t\t\tobj.write_shift(4, 0x95374305);\n\t\t\tobj.write_shift(4, 0x80301328);\n\t\t\tobj.write_shift(4, 0x69696904 + b8oid*256);\n\t\t\tobj.write_shift(2,0);\n\t\t\tobj.write_shift(4,0);\n\t\t\t// reserved\n\t\t\tobj.l += 4;\n\t\t\twrite_biff_rec(pl, 0x005D, obj);\n\t\t}\n\n\t\t/* [MS-XLS] 2.5.195 OfficeArtClientTextbox */\n\t\t{\n\t\t\tvar oact = new_buf(8);\n\t\t\toact.l += 2;\n\t\t\toact.write_shift(2, 0xF00D);\n\t\t\toact.l += 4;\n\t\t\twrite_biff_rec(pl, 0x00EC, oact);\n\t\t}\n\t\tsz += 8;\n\n\t\t/* [MS-XLS] 2.4.329 TxO */\n\t\t{\n\t\t\tvar txo = new_buf(18);\n\t\t\ttxo.write_shift(2, 0x12);\n\t\t\ttxo.l += 8;\n\t\t\ttxo.write_shift(2, text.length);\n\t\t\ttxo.write_shift(2, 0x10);\n\t\t\ttxo.l += 4;\n\t\t\twrite_biff_rec(pl, 0x01b6, txo);\n\t\t\t/* text continue record TODO: switch to wide strings */\n\t\t\t{\n\t\t\t\tvar cont = new_buf(1 + text.length);\n\t\t\t\tcont.write_shift(1, 0);\n\t\t\t\tcont.write_shift(text.length, text, \"sbcs\");\n\t\t\t\twrite_biff_rec(pl, 0x003C, cont);\n\t\t\t}\n\t\t\t/* formatting continue records */\n\t\t\t{\n\t\t\t\tvar conf = new_buf(0x10);\n\t\t\t\tconf.l += 8;\n\t\t\t\tconf.write_shift(2, text.length);\n\t\t\t\tconf.l += 6;\n\t\t\t\twrite_biff_rec(pl, 0x003C, conf);\n\t\t\t}\n\t\t}\n\n\t\t/* 2.4.179 Note */\n\t\t{\n\t\t\tvar notesh = new_buf(12 + author.length);\n\t\t\tnotesh.write_shift(2, c[1]);\n\t\t\tnotesh.write_shift(2, c[2]);\n\t\t\tnotesh.write_shift(2, 0 | (c[0].hidden ? 0 : 2));\n\t\t\tnotesh.write_shift(2, b8oid);\n\t\t\tnotesh.write_shift(2, author.length);\n\t\t\tnotesh.write_shift(1, 0);\n\t\t\tnotesh.write_shift(author.length, author, \"sbcs\");\n\t\t\tnotesh.l ++;\n\t\t\tnotes.push(notesh);\n\t\t}\n\t});\n\t/* [MS-ODRAW] 2.2.13 OfficeArtDgContainer */\n\t{\n\t\tvar hdr = new_buf(80);\n\t\thdr.write_shift(2, 0x0F);\n\t\thdr.write_shift(2, 0xF002);\n\t\thdr.write_shift(4, sz + hdr.length - 8);\n\t\t/* [MS-ODRAW] 2.2.49 OfficeArtFDG */\n\t\t{\n\t\t\thdr.write_shift(2, 0x10);\n\t\t\thdr.write_shift(2, 0xF008);\n\t\t\thdr.write_shift(4, 0x08);\n\t\t\thdr.write_shift(4, comments.length + 1);\n\t\t\thdr.write_shift(4, b8oid);\n\t\t}\n\t\t/* [MS-ODRAW] 2.2.16 OfficeArtSpgrContainer */\n\t\t{\n\t\t\thdr.write_shift(2, 0x0f);\n\t\t\thdr.write_shift(2, 0xF003);\n\t\t\thdr.write_shift(4, sz + 0x30);\n\t\t\t/* [MS-ODRAW] 2.2.14 OfficeArtSpContainer */\n\t\t\t{\n\t\t\t\thdr.write_shift(2, 0x0f);\n\t\t\t\thdr.write_shift(2, 0xF004);\n\t\t\t\thdr.write_shift(4, 0x28);\n\t\t\t\t/* [MS-ODRAW] 2.2.38 OfficeArtFSPGR */\n\t\t\t\t{\n\t\t\t\t\thdr.write_shift(2, 0x01);\n\t\t\t\t\thdr.write_shift(2, 0xF009);\n\t\t\t\t\thdr.write_shift(4, 0x10);\n\t\t\t\t\thdr.l += 16;\n\t\t\t\t}\n\t\t\t\t/* [MS-ODRAW] 2.2.40 OfficeArtFSP */\n\t\t\t\t{\n\t\t\t\t\thdr.write_shift(2, 0x02);\n\t\t\t\t\thdr.write_shift(2, 0xF00A);\n\t\t\t\t\thdr.write_shift(4, 0x08);\n\t\t\t\t\thdr.write_shift(4, baseid);\n\t\t\t\t\thdr.write_shift(4, 0x05);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twrite_biff_rec(ba, 0x00EC, /* hdr */ _oasc ? bconcat([hdr, _oasc]) : hdr);\n\t}\n\tba.push(pl.end());\n\tnotes.forEach(function(n) { write_biff_rec(ba, 0x001C, n); });\n\tb8ocnts.push([baseid, comments.length + 1, b8oid]);\n\t++b8oid;\n}\n\nfunction write_FONTS_biff8(ba, data, opts) {\n\twrite_biff_rec(ba, 0x0031 /* Font */, write_Font({\n\t\tsz:12,\n\t\tcolor: {theme:1},\n\t\tname: \"Arial\",\n\t\tfamily: 2,\n\t\tscheme: \"minor\"\n\t}, opts));\n}\n\n\nfunction write_FMTS_biff8(ba, NF/*:?SSFTable*/, opts) {\n\tif(!NF) return;\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\t/*:: if(!NF) return; */\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_biff_rec(ba, 0x041E /* Format */, write_Format(i, NF[i], opts));\n\t});\n}\n\nfunction write_FEAT(ba, ws) {\n\t/* [MS-XLS] 2.4.112 */\n\tvar o = new_buf(19);\n\to.write_shift(4, 0x867); o.write_shift(4, 0); o.write_shift(4, 0);\n\to.write_shift(2, 3); o.write_shift(1, 1); o.write_shift(4, 0);\n\twrite_biff_rec(ba, 0x0867 /* FeatHdr */, o);\n\t/* [MS-XLS] 2.4.111 */\n\to = new_buf(39);\n\to.write_shift(4, 0x868); o.write_shift(4, 0); o.write_shift(4, 0);\n\to.write_shift(2, 3); o.write_shift(1, 0); o.write_shift(4, 0);\n\to.write_shift(2, 1); o.write_shift(4, 4); o.write_shift(2, 0);\n\twrite_Ref8U(safe_decode_range(ws['!ref']||\"A1\"), o);\n\to.write_shift(4, 4);\n\twrite_biff_rec(ba, 0x0868 /* Feat */, o);\n}\n\nfunction write_CELLXFS_biff8(ba, opts) {\n\tfor(var i = 0; i < 16; ++i) write_biff_rec(ba, 0x00e0 /* XF */, write_XF({numFmtId:0, style:true}, 0, opts));\n\topts.cellXfs.forEach(function(c) {\n\t\twrite_biff_rec(ba, 0x00e0 /* XF */, write_XF(c, 0, opts));\n\t});\n}\n\nfunction write_ws_biff8_hlinks(ba/*:BufArray*/, ws) {\n\tfor(var R=0; R<ws['!links'].length; ++R) {\n\t\tvar HL = ws['!links'][R];\n\t\twrite_biff_rec(ba, 0x01b8 /* HLink */, write_HLink(HL));\n\t\tif(HL[1].Tooltip) write_biff_rec(ba, 0x0800 /* HLinkTooltip */, write_HLinkTooltip(HL));\n\t}\n\tdelete ws['!links'];\n}\n\nfunction write_ws_cols_biff8(ba, cols) {\n\tif(!cols) return;\n\tvar cnt = 0;\n\tcols.forEach(function(col, idx) {\n\t\tif(++cnt <= 256 && col) {\n\t\t\twrite_biff_rec(ba, 0x007d /* ColInfo */, write_ColInfo(col_obj_w(idx, col), idx));\n\t\t}\n\t});\n}\n\nfunction write_ws_biff8_cell(ba/*:BufArray*/, cell/*:Cell*/, R/*:number*/, C/*:number*/, opts, date1904/*:boolean*/) {\n\tvar os = 16 + get_cell_style(opts.cellXfs, cell, opts);\n\tif(cell.v == null && !cell.bf) {\n\t\twrite_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n\t\treturn;\n\t}\n\tif(cell.bf) write_biff_rec(ba, 0x0006 /* Formula */, write_Formula(cell, R, C, opts, os));\n\telse switch(cell.t) {\n\t\tcase 'd': case 'n':\n\t\t\tvar v = cell.t == 'd' ? datenum(parseDate(cell.v, date1904), date1904) : cell.v;\n\t\t\tif(isNaN(v)) write_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, 0x24, os, opts, \"e\")); // #NUM!\n\t\t\telse if(!isFinite(v)) write_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, 0x07, os, opts, \"e\")); // #DIV/0!\n\t\t\t/* TODO: emit RK as appropriate */\n\t\t\telse write_biff_rec(ba, 0x0203 /* Number */, write_Number(R, C, v, os, opts));\n\t\t\tbreak;\n\t\tcase 'b': case 'e':\n\t\t\twrite_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, cell.v, os, opts, cell.t));\n\t\t\tbreak;\n\t\t/* TODO: codepage, sst */\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvar isst = get_sst_id(opts.Strings, cell.v == null ? \"\" : String(cell.v), opts.revStrings);\n\t\t\t\twrite_biff_rec(ba, 0x00fd /* LabelSst */, write_LabelSst(R, C, isst, os, opts));\n\t\t\t} else write_biff_rec(ba, 0x0204 /* Label */, write_Label(R, C, (cell.v == null ? \"\" : String(cell.v)).slice(0,255), os, opts));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\twrite_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n\t}\n}\n\n/* [MS-XLS] 2.1.7.20.5 */\nfunction write_ws_biff8(idx/*:number*/, opts, wb/*:Workbook*/) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar _WB/*:WBWBProps*/ = ((wb||{}).Workbook||{}/*:any*/);\n\tvar _sheet/*:WBWSProp*/ = ((_WB.Sheets||[])[idx]||{}/*:any*/);\n\tvar dense = ws[\"!data\"] != null;\n\tvar b8 = opts.biff == 8;\n\tvar ref/*:string*/, rr = \"\", cols/*:Array<string>*/ = [];\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\");\n\tvar MAX_ROWS = b8 ? 65536 : 16384;\n\tif(range.e.c > 0xFF || range.e.r >= MAX_ROWS) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV\" + MAX_ROWS);\n\t\trange.e.c = Math.min(range.e.c, 0xFF);\n\t\trange.e.r = Math.min(range.e.r, MAX_ROWS-1);\n\t}\n\n\twrite_biff_rec(ba, 0x0809, write_BOF(wb, 0x10, opts));\n\t/* [Uncalced] Index */\n\twrite_biff_rec(ba, 0x000d /* CalcMode */, writeuint16(1));\n\twrite_biff_rec(ba, 0x000c /* CalcCount */, writeuint16(100));\n\twrite_biff_rec(ba, 0x000f /* CalcRefMode */, writebool(true));\n\twrite_biff_rec(ba, 0x0011 /* CalcIter */, writebool(false));\n\twrite_biff_rec(ba, 0x0010 /* CalcDelta */, write_Xnum(0.001));\n\twrite_biff_rec(ba, 0x005f /* CalcSaveRecalc */, writebool(true));\n\twrite_biff_rec(ba, 0x002a /* PrintRowCol */, writebool(false));\n\twrite_biff_rec(ba, 0x002b /* PrintGrid */, writebool(false));\n\twrite_biff_rec(ba, 0x0082 /* GridSet */, writeuint16(1));\n\twrite_biff_rec(ba, 0x0080 /* Guts */, write_Guts([0,0]));\n\t/* DefaultRowHeight WsBool [Sync] [LPr] [HorizontalPageBreaks] [VerticalPageBreaks] */\n\t/* Header (string) */\n\t/* Footer (string) */\n\twrite_biff_rec(ba, 0x0083 /* HCenter */, writebool(false));\n\twrite_biff_rec(ba, 0x0084 /* VCenter */, writebool(false));\n\t/* ... */\n\tif(b8) write_ws_cols_biff8(ba, ws[\"!cols\"]);\n\t/* ... */\n\twrite_biff_rec(ba, 0x0200 /* Dimensions */, write_Dimensions(range, opts));\n\t/* ... */\n\n\tvar date1904 = (((wb||{}).Workbook||{}).WBProps||{}).date1904;\n\tif(b8) ws['!links'] = [];\n\tfor(var C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\tvar comments = [];\n\tvar row = [];\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\tif(dense) row = ws[\"!data\"][R] || [];\n\t\trr = encode_row(R);\n\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tvar cell = dense ? row[C] : ws[cols[C] + rr];\n\t\t\tif(!cell) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_biff8_cell(ba, cell, R, C, opts, date1904);\n\t\t\tif(b8 && cell.l) ws['!links'].push([cols[C] + rr, cell.l]);\n\t\t\tif(cell.c) comments.push([cell.c, R, C]);\n\t\t}\n\t}\n\tvar cname/*:string*/ = _sheet.CodeName || _sheet.name || s;\n\t/* ... */\n\tif(b8) write_comments_biff8(ba, comments); else write_comments_biff2(ba, comments);\n\t/* ... */\n\tif(b8) write_biff_rec(ba, 0x023e /* Window2 */, write_Window2((_WB.Views||[])[0]));\n\t/* ... */\n\tif(b8 && (ws['!merges']||[]).length) write_biff_rec(ba, 0x00e5 /* MergeCells */, write_MergeCells(ws['!merges']));\n\t/* [LRng] *QUERYTABLE [PHONETICINFO] CONDFMTS */\n\tif(b8) write_ws_biff8_hlinks(ba, ws);\n\t/* [DVAL] */\n\twrite_biff_rec(ba, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n\t/* *WebPub *CellWatch [SheetExt] */\n\tif(b8) write_FEAT(ba, ws);\n\t/* *FEAT11 *RECORD12 */\n\twrite_biff_rec(ba, 0x000a /* EOF */);\n\treturn ba.end();\n}\n\n/* [MS-XLS] 2.1.7.20.3 */\nfunction write_biff8_global(wb/*:Workbook*/, bufs, opts/*:WriteOpts*/) {\n\tvar A = buf_array();\n\tvar _WB/*:WBWBProps*/ = ((wb||{}).Workbook||{}/*:any*/);\n\tvar _sheets/*:Array<WBWSProp>*/ = (_WB.Sheets||[]);\n\tvar _wb/*:WBProps*/ = /*::((*/_WB.WBProps||{/*::CodeName:\"ThisWorkbook\"*/}/*:: ):any)*/;\n\tvar b8 = opts.biff == 8, b5 = opts.biff == 5;\n\twrite_biff_rec(A, 0x0809, write_BOF(wb, 0x05, opts));\n\tif(opts.bookType == \"xla\") write_biff_rec(A, 0x0087 /* Addin */);\n\twrite_biff_rec(A, 0x00e1 /* InterfaceHdr */, b8 ? writeuint16(0x04b0) : null);\n\twrite_biff_rec(A, 0x00c1 /* Mms */, writezeroes(2));\n\tif(b5) write_biff_rec(A, 0x00bf /* ToolbarHdr */);\n\tif(b5) write_biff_rec(A, 0x00c0 /* ToolbarEnd */);\n\twrite_biff_rec(A, 0x00e2 /* InterfaceEnd */);\n\twrite_biff_rec(A, 0x005c /* WriteAccess */, write_WriteAccess(\"SheetJS\", opts));\n\t/* [FileSharing] */\n\twrite_biff_rec(A, 0x0042 /* CodePage */, writeuint16(b8 ? 0x04b0 : 0x04E4));\n\t/* *2047 Lel */\n\tif(b8) write_biff_rec(A, 0x0161 /* DSF */, writeuint16(0));\n\tif(b8) write_biff_rec(A, 0x01c0 /* Excel9File */);\n\twrite_biff_rec(A, 0x013d /* RRTabId */, write_RRTabId(wb.SheetNames.length));\n\tif(b8 && wb.vbaraw) write_biff_rec(A, 0x00d3 /* ObProj */);\n\t/* [ObNoMacros] */\n\tif(b8 && wb.vbaraw) {\n\t\tvar cname/*:string*/ = _wb.CodeName || \"ThisWorkbook\";\n\t\twrite_biff_rec(A, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n\t}\n\twrite_biff_rec(A, 0x009c /* BuiltInFnGroupCount */, writeuint16(0x11));\n\t/* *FnGroupName *FnGrp12 */\n\t/* *Lbl */\n\t/* [OleObjectSize] */\n\twrite_biff_rec(A, 0x0019 /* WinProtect */, writebool(false));\n\twrite_biff_rec(A, 0x0012 /* Protect */, writebool(false));\n\twrite_biff_rec(A, 0x0013 /* Password */, writeuint16(0));\n\tif(b8) write_biff_rec(A, 0x01af /* Prot4Rev */, writebool(false));\n\tif(b8) write_biff_rec(A, 0x01bc /* Prot4RevPass */, writeuint16(0));\n\twrite_biff_rec(A, 0x003d /* Window1 */, write_Window1(opts));\n\twrite_biff_rec(A, 0x0040 /* Backup */, writebool(false));\n\twrite_biff_rec(A, 0x008d /* HideObj */, writeuint16(0));\n\twrite_biff_rec(A, 0x0022 /* Date1904 */, writebool(safe1904(wb)==\"true\"));\n\twrite_biff_rec(A, 0x000e /* CalcPrecision */, writebool(true));\n\tif(b8) write_biff_rec(A, 0x01b7 /* RefreshAll */, writebool(false));\n\twrite_biff_rec(A, 0x00DA /* BookBool */, writeuint16(0));\n\t/* ... */\n\twrite_FONTS_biff8(A, wb, opts);\n\twrite_FMTS_biff8(A, wb.SSF, opts);\n\twrite_CELLXFS_biff8(A, opts);\n\t/* ... */\n\tif(b8) write_biff_rec(A, 0x0160 /* UsesELFs */, writebool(false));\n\tvar a = A.end();\n\n\tvar C = buf_array();\n\t/* METADATA [MTRSettings] [ForceFullCalculation] */\n\tif(b8) write_biff_rec(C, 0x008C /* Country */, write_Country());\n\t/* *SUPBOOK *LBL *RTD [RecalcId] *HFPicture */\n\n\t/* BIFF8: MsoDrawingGroup [*Continue] */\n\tif(b8 && b8ocnts.length) write_biff_rec(C, 0x00EB /* MsoDrawingGroup */, write_MsoDrawingGroup());\n\t/* BIFF8: [SST *Continue] ExtSST */\n\tif(b8 && opts.Strings) write_biff_continue(C, 0x00FC /* SST */, write_SST(opts.Strings, opts));\n\n\t/* *WebPub [WOpt] [CrErr] [BookExt] *FeatHdr *DConn [THEME] [CompressPictures] [Compat12] [GUIDTypeLib] */\n\twrite_biff_rec(C, 0x000A /* EOF */);\n\tvar c = C.end();\n\n\tvar B = buf_array();\n\tvar blen = 0, j = 0;\n\tfor(j = 0; j < wb.SheetNames.length; ++j) blen += (b8 ? 12 : 11) + (b8 ? 2 : 1) * wb.SheetNames[j].length;\n\tvar start = a.length + blen + c.length;\n\tfor(j = 0; j < wb.SheetNames.length; ++j) {\n\t\tvar _sheet/*:WBWSProp*/ = _sheets[j] || ({}/*:any*/);\n\t\twrite_biff_rec(B, 0x0085 /* BoundSheet8 */, write_BoundSheet8({pos:start, hs:_sheet.Hidden||0, dt:0, name:wb.SheetNames[j]}, opts));\n\t\tstart += bufs[j].length;\n\t}\n\t/* 1*BoundSheet8 */\n\tvar b = B.end();\n\tif(blen != b.length) throw new Error(\"BS8 \" + blen + \" != \" + b.length);\n\n\tvar out = [];\n\tif(a.length) out.push(a);\n\tif(b.length) out.push(b);\n\tif(c.length) out.push(c);\n\treturn bconcat(out);\n}\n\n/* [MS-XLS] 2.1.7.20 Workbook Stream */\nfunction write_biff8_buf(wb/*:Workbook*/, opts/*:WriteOpts*/) {\n\tvar o = opts || {};\n\tvar bufs = [];\n\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\to.revssf = evert_num(wb.SSF); o.revssf[wb.SSF[65535]] = 0;\n\t\to.ssf = wb.SSF;\n\t}\n\n\tb8oid = 1; b8ocnts = [];\n\to.Strings = /*::((*/[]/*:: :any):SST)*/; o.Strings.Count = 0; o.Strings.Unique = 0;\n\tfix_write_opts(o);\n\n\to.cellXfs = [];\n\tget_cell_style(o.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tfor(var i = 0; i < wb.SheetNames.length; ++i) bufs[bufs.length] = write_ws_biff8(i, o, wb);\n\tbufs.unshift(write_biff8_global(wb, bufs, o));\n\treturn bconcat(bufs);\n}\n\nfunction write_biff_buf(wb/*:Workbook*/, opts/*:WriteOpts*/) {\n\tfor(var i = 0; i <= wb.SheetNames.length; ++i) {\n\t\tvar ws = wb.Sheets[wb.SheetNames[i]];\n\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\tif(range.e.c > 255) { // note: 255 is IV\n\t\t\tif(typeof console != \"undefined\" && console.error) console.error(\"Worksheet '\" + wb.SheetNames[i] + \"' extends beyond column IV (255).  Data may be lost.\");\n\t\t}\n\t\tif(range.e.r > 65535) {\n\t\t\tif(typeof console != \"undefined\" && console.error) console.error(\"Worksheet '\" + wb.SheetNames[i] + \"' extends beyond row 65536.  Data may be lost.\");\n\t\t}\n\t}\n\n\tvar o = opts || {};\n\tswitch(o.biff || 2) {\n\t\tcase 8: case 5: return write_biff8_buf(wb, opts);\n\t\tcase 4: case 3: case 2: return write_biff2_buf(wb, opts);\n\t}\n\tthrow new Error(\"invalid type \" + o.bookType + \" for BIFF\");\n}\n/* note: browser DOM element cannot see mso- style attrs, must parse */\nfunction html_to_sheet(str/*:string*/, _opts)/*:Workbook*/ {\n\tvar opts = _opts || {};\n\tvar dense = (opts.dense != null) ? opts.dense : DENSE;\n\tvar ws/*:Worksheet*/ = ({}/*:any*/); if(dense) ws[\"!data\"] = [];\n\tstr = str_remove_ng(str, \"<!--\", \"-->\");\n\tvar mtch/*:any*/ = str.match(/<table/i);\n\tif(!mtch) throw new Error(\"Invalid HTML: could not find <table>\");\n\tvar mtch2/*:any*/ = str.match(/<\\/table/i);\n\tvar i/*:number*/ = mtch.index, j/*:number*/ = mtch2 && mtch2.index || str.length;\n\tvar rows = split_regex(str.slice(i, j), /(:?<tr[^<>]*>)/i, \"<tr>\");\n\tvar R = -1, C = 0, RS = 0, CS = 0;\n\tvar range/*:Range*/ = {s:{r:10000000, c:10000000},e:{r:0,c:0}};\n\tvar merges/*:Array<Range>*/ = [];\n\tfor(i = 0; i < rows.length; ++i) {\n\t\tvar row = rows[i].trim();\n\t\tvar hd = row.slice(0,3).toLowerCase();\n\t\tif(hd == \"<tr\") { ++R; if(opts.sheetRows && opts.sheetRows <= R) { --R; break; } C = 0; continue; }\n\t\tif(hd != \"<td\" && hd != \"<th\") continue;\n\t\tvar cells = row.split(/<\\/t[dh]>/i);\n\t\tfor(j = 0; j < cells.length; ++j) {\n\t\t\tvar cell = cells[j].trim();\n\t\t\tif(!cell.match(/<t[dh]/i)) continue;\n\t\t\tvar m = cell, cc = 0;\n\t\t\t/* TODO: parse styles etc */\n\t\t\twhile(m.charAt(0) == \"<\" && (cc = m.indexOf(\">\")) > -1) m = m.slice(cc+1);\n\t\t\tfor(var midx = 0; midx < merges.length; ++midx) {\n\t\t\t\tvar _merge/*:Range*/ = merges[midx];\n\t\t\t\tif(_merge.s.c == C && _merge.s.r < R && R <= _merge.e.r) { C = _merge.e.c + 1; midx = -1; }\n\t\t\t}\n\t\t\tvar tag = parsexmltag(cell.slice(0, cell.indexOf(\">\")));\n\t\t\tCS = tag.colspan ? +tag.colspan : 1;\n\t\t\tif((RS = +tag.rowspan)>1 || CS>1) merges.push({s:{r:R,c:C},e:{r:R + (RS||1) - 1, c:C + CS - 1}});\n\t\t\tvar _t/*:string*/ = tag.t || tag[\"data-t\"] || \"\";\n\t\t\t/* TODO: generate stub cells */\n\t\t\tif(!m.length) { C += CS; continue; }\n\t\t\tm = htmldecode(m);\n\t\t\tif(range.s.r > R) range.s.r = R; if(range.e.r < R) range.e.r = R;\n\t\t\tif(range.s.c > C) range.s.c = C; if(range.e.c < C) range.e.c = C;\n\t\t\tif(!m.length) { C += CS; continue; }\n\t\t\tvar o/*:Cell*/ = {t:'s', v:m};\n\t\t\tif(opts.raw || !m.trim().length || _t == 's'){}\n\t\t\telse if(m === 'TRUE') o = {t:'b', v:true};\n\t\t\telse if(m === 'FALSE') o = {t:'b', v:false};\n\t\t\telse if(!isNaN(fuzzynum(m))) o = {t:'n', v:fuzzynum(m)};\n\t\t\telse if(!isNaN(fuzzydate(m).getDate())) {\n\t\t\t\to = ({t:'d', v:parseDate(m)}/*:any*/);\n\t\t\t\tif(opts.UTC === false) o.v = utc_to_local(o.v);\n\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)}/*:any*/);\n\t\t\t\to.z = opts.dateNF || table_fmt[14];\n\t\t\t} else if(m.charCodeAt(0) == 35 /* # */ && RBErr[m] != null) {\n\t\t\t\to.t = 'e'; o.w = m; o.v = RBErr[m];\n\t\t\t}\n\t\t\tif(o.cellText !== false) o.w = m;\n\t\t\tif(dense) { if(!ws[\"!data\"][R]) ws[\"!data\"][R] = []; ws[\"!data\"][R][C] = o; }\n\t\t\telse ws[encode_cell({r:R, c:C})] = o;\n\t\t\tC += CS;\n\t\t}\n\t}\n\tws['!ref'] = encode_range(range);\n\tif(merges.length) ws[\"!merges\"] = merges;\n\treturn ws;\n}\nfunction make_html_row(ws/*:Worksheet*/, r/*:Range*/, R/*:number*/, o/*:Sheet2HTMLOpts*/)/*:string*/ {\n\tvar M/*:Array<Range>*/ = (ws['!merges'] ||[]);\n\tvar oo/*:Array<string>*/ = [];\n\tvar sp = ({}/*:any*/);\n\tvar dense = ws[\"!data\"] != null;\n\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\tvar RS = 0, CS = 0;\n\t\tfor(var j = 0; j < M.length; ++j) {\n\t\t\tif(M[j].s.r > R || M[j].s.c > C) continue;\n\t\t\tif(M[j].e.r < R || M[j].e.c < C) continue;\n\t\t\tif(M[j].s.r < R || M[j].s.c < C) { RS = -1; break; }\n\t\t\tRS = M[j].e.r - M[j].s.r + 1; CS = M[j].e.c - M[j].s.c + 1; break;\n\t\t}\n\t\tif(RS < 0) continue;\n\t\tvar coord = encode_col(C) + encode_row(R);\n\t\tvar cell = dense ? (ws[\"!data\"][R]||[])[C] : ws[coord];\n\t\tif(cell && cell.t == 'n' && cell.v != null && !isFinite(cell.v)) {\n\t\t\tif(isNaN(cell.v)) cell = ({t:'e', v:0x24, w:BErr[0x24]});\n\t\t\telse cell = ({t:'e', v:0x07, w:BErr[0x07]});\n\t\t}\n\t\t/* TODO: html entities */\n\t\tvar w = (cell && cell.v != null) && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\")) || \"\";\n\t\tsp = ({}/*:any*/);\n\t\tif(RS > 1) sp.rowspan = RS;\n\t\tif(CS > 1) sp.colspan = CS;\n\t\tif(o.editable) w = '<span contenteditable=\"true\">' + w + '</span>';\n\t\telse if(cell) {\n\t\t\tsp[\"data-t\"] = cell && cell.t || 'z';\n\t\t\t// note: data-v is unaffected by the timezone interpretation\n\t\t\tif(cell.v != null) sp[\"data-v\"] = escapehtml(cell.v instanceof Date ? cell.v.toISOString() : cell.v);\n\t\t\tif(cell.z != null) sp[\"data-z\"] = cell.z;\n\t\t\tif(cell.l && (cell.l.Target || \"#\").charAt(0) != \"#\") w = '<a href=\"' + escapehtml(cell.l.Target) +'\">' + w + '</a>';\n\t\t}\n\t\tsp.id = (o.id || \"sjs\") + \"-\" + coord;\n\t\too.push(writextag('td', w, sp));\n\t}\n\tvar preamble = \"<tr>\";\n\treturn preamble + oo.join(\"\") + \"</tr>\";\n}\n\nvar HTML_BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\nvar HTML_END = '</body></html>';\n\nfunction html_to_workbook(str/*:string*/, opts)/*:Workbook*/ {\n\tvar mtch = str_match_xml_ig(str, \"table\");\n\tif(!mtch || mtch.length == 0) throw new Error(\"Invalid HTML: could not find <table>\");\n\tif(mtch.length == 1) {\n\t\tvar w = sheet_to_workbook(html_to_sheet(mtch[0], opts), opts);\n\t\tw.bookType = \"html\";\n\t\treturn w;\n\t}\n\tvar wb = book_new();\n\tmtch.forEach(function(s, idx) { book_append_sheet(wb, html_to_sheet(s, opts), \"Sheet\" + (idx+1)); });\n\twb.bookType = \"html\";\n\treturn wb;\n}\n\nfunction make_html_preamble(ws/*:Worksheet*/, R/*:Range*/, o/*:Sheet2HTMLOpts*/)/*:string*/ {\n\tvar out/*:Array<string>*/ = [];\n\treturn out.join(\"\") + '<table' + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + '>';\n}\n\nfunction sheet_to_html(ws/*:Worksheet*/, opts/*:?Sheet2HTMLOpts*//*, wb:?Workbook*/)/*:string*/ {\n\tvar o = opts || {};\n\tvar header = o.header != null ? o.header : HTML_BEGIN;\n\tvar footer = o.footer != null ? o.footer : HTML_END;\n\tvar out/*:Array<string>*/ = [header];\n\tvar r = decode_range(ws['!ref'] || \"A1\");\n\tout.push(make_html_preamble(ws, r, o));\n\tif(ws[\"!ref\"]) for(var R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));\n\tout.push(\"</table>\" + footer);\n\treturn out.join(\"\");\n}\n\nfunction sheet_add_dom(ws/*:Worksheet*/, table/*:HTMLElement*/, _opts/*:?any*/)/*:Worksheet*/ {\n\tvar rows/*:HTMLCollection<HTMLTableRowElement>*/ = table.rows;\n\tif(!rows) {\n\t\t/* not an HTML TABLE */\n\t\tthrow \"Unsupported origin when \" + table.tagName + \" is not a TABLE\";\n\t}\n\n\tvar opts = _opts || {};\n\tvar dense = ws[\"!data\"] != null;\n\tvar or_R = 0, or_C = 0;\n\tif(opts.origin != null) {\n\t\tif(typeof opts.origin == 'number') or_R = opts.origin;\n\t\telse {\n\t\t\tvar _origin/*:CellAddress*/ = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\n\t\t\tor_R = _origin.r; or_C = _origin.c;\n\t\t}\n\t}\n\n\tvar sheetRows = Math.min(opts.sheetRows||10000000, rows.length);\n\tvar range/*:Range*/ = {s:{r:0,c:0},e:{r:or_R,c:or_C}};\n\tif(ws[\"!ref\"]) {\n\t\tvar _range/*:Range*/ = decode_range(ws[\"!ref\"]);\n\t\trange.s.r = Math.min(range.s.r, _range.s.r);\n\t\trange.s.c = Math.min(range.s.c, _range.s.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\tif(or_R == -1) range.e.r = or_R = _range.e.r + 1;\n\t}\n\tvar merges/*:Array<Range>*/ = [], midx = 0;\n\tvar rowinfo/*:Array<RowInfo>*/ = ws[\"!rows\"] || (ws[\"!rows\"] = []);\n\tvar _R = 0, R = 0, _C = 0, C = 0, RS = 0, CS = 0;\n\tif(!ws[\"!cols\"]) ws['!cols'] = [];\n\tfor(; _R < rows.length && R < sheetRows; ++_R) {\n\t\tvar row/*:HTMLTableRowElement*/ = rows[_R];\n\t\tif (is_dom_element_hidden(row)) {\n\t\t\tif (opts.display) continue;\n\t\t\trowinfo[R] = {hidden: true};\n\t\t}\n\t\tvar elts/*:HTMLCollection<HTMLTableCellElement>*/ = (row.cells);\n\t\tfor(_C = C = 0; _C < elts.length; ++_C) {\n\t\t\tvar elt/*:HTMLTableCellElement*/ = elts[_C];\n\t\t\tif (opts.display && is_dom_element_hidden(elt)) continue;\n\t\t\tvar v/*:?string*/ = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\n\t\t\tvar z/*:?string*/ = elt.getAttribute('data-z') || elt.getAttribute('z');\n\t\t\tfor(midx = 0; midx < merges.length; ++midx) {\n\t\t\t\tvar m/*:Range*/ = merges[midx];\n\t\t\t\tif(m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) { C = m.e.c+1 - or_C; midx = -1; }\n\t\t\t}\n\t\t\t/* TODO: figure out how to extract nonstandard mso- style */\n\t\t\tCS = +elt.getAttribute(\"colspan\") || 1;\n\t\t\tif( ((RS = (+elt.getAttribute(\"rowspan\") || 1)))>1 || CS>1) merges.push({s:{r:R + or_R,c:C + or_C},e:{r:R + or_R + (RS||1) - 1, c:C + or_C + (CS||1) - 1}});\n\t\t\tvar o/*:Cell*/ = {t:'s', v:v};\n\t\t\tvar _t/*:string*/ = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\n\t\t\tif(v != null) {\n\t\t\t\tif(v.length == 0) o.t = _t || 'z';\n\t\t\t\telse if(opts.raw || v.trim().length == 0 || _t == \"s\"){}\n\t\t\t\telse if(_t == \"e\" && BErr[+v]) o = {t:'e', v:+v, w: BErr[+v]};\n\t\t\t\telse if(v === 'TRUE') o = {t:'b', v:true};\n\t\t\t\telse if(v === 'FALSE') o = {t:'b', v:false};\n\t\t\t\telse if(!isNaN(fuzzynum(v))) o = {t:'n', v:fuzzynum(v)};\n\t\t\t\telse if(!isNaN(fuzzydate(v).getDate())) {\n\t\t\t\t\to = ({t:'d', v:parseDate(v)}/*:any*/);\n\t\t\t\t\tif(opts.UTC) o.v = local_to_utc(o.v);\n\t\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)}/*:any*/);\n\t\t\t\t\to.z = opts.dateNF || table_fmt[14];\n\t\t\t\t} else if(v.charCodeAt(0) == 35 /* # */ && RBErr[v] != null) o = ({t:'e', v: RBErr[v], w: v});\n\t\t\t}\n\t\t\tif(o.z === undefined && z != null) o.z = z;\n\t\t\t/* The first link is used.  Links are assumed to be fully specified.\n\t\t\t * TODO: The right way to process relative links is to make a new <a> */\n\t\t\tvar l = \"\", Aelts = elt.getElementsByTagName(\"A\");\n\t\t\tif(Aelts && Aelts.length) for(var Aelti = 0; Aelti < Aelts.length; ++Aelti)\tif(Aelts[Aelti].hasAttribute(\"href\")) {\n\t\t\t\tl = Aelts[Aelti].getAttribute(\"href\"); if(l.charAt(0) != \"#\") break;\n\t\t\t}\n\t\t\tif(l && l.charAt(0) != \"#\" &&\tl.slice(0, 11).toLowerCase() != 'javascript:') o.l = ({ Target: l });\n\t\t\tif(dense) { if(!ws[\"!data\"][R + or_R]) ws[\"!data\"][R + or_R] = []; ws[\"!data\"][R + or_R][C + or_C] = o; }\n\t\t\telse ws[encode_cell({c:C + or_C, r:R + or_R})] = o;\n\t\t\tif(range.e.c < C + or_C) range.e.c = C + or_C;\n\t\t\tC += CS;\n\t\t}\n\t\t++R;\n\t}\n\tif(merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\n\trange.e.r = Math.max(range.e.r, R - 1 + or_R);\n\tws['!ref'] = encode_range(range);\n\tif(R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length-_R+R-1 + or_R,range)); // We can count the real number of rows to parse but we don't to improve the performance\n\treturn ws;\n}\n\nfunction parse_dom_table(table/*:HTMLElement*/, _opts/*:?any*/)/*:Worksheet*/ {\n\tvar opts = _opts || {};\n\tvar ws/*:Worksheet*/ = ({}/*:any*/); if(opts.dense) ws[\"!data\"] = [];\n\treturn sheet_add_dom(ws, table, _opts);\n}\n\nfunction table_to_book(table/*:HTMLElement*/, opts/*:?any*/)/*:Workbook*/ {\n\tvar o = sheet_to_workbook(parse_dom_table(table, opts), opts);\n\t//o.bookType = \"dom\"; // TODO: define a type for this\n\treturn o;\n}\n\nfunction is_dom_element_hidden(element/*:HTMLElement*/)/*:boolean*/ {\n\tvar display/*:string*/ = '';\n\tvar get_computed_style/*:?function*/ = get_get_computed_style_function(element);\n\tif(get_computed_style) display = get_computed_style(element).getPropertyValue('display');\n\tif(!display) display = element.style && element.style.display;\n\treturn display === 'none';\n}\n\n/* global getComputedStyle */\nfunction get_get_computed_style_function(element/*:HTMLElement*/)/*:?function*/ {\n\t// The proper getComputedStyle implementation is the one defined in the element window\n\tif(element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle;\n\t// If it is not available, try to get one from the global namespace\n\tif(typeof getComputedStyle === 'function') return getComputedStyle;\n\treturn null;\n}\n/* OpenDocument */\nfunction parse_text_p(text/*:string*//*::, tag*/)/*:Array<any>*/ {\n\t/* 6.1.2 White Space Characters */\n\tvar fixed = text\n\t\t.replace(/[\\t\\r\\n]/g, \" \").trim().replace(/ +/g, \" \")\n\t\t.replace(/<text:s\\/>/g,\" \")\n\t\t.replace(/<text:s text:c=\"(\\d+)\"\\/>/g, function($$,$1) { return Array(parseInt($1,10)+1).join(\" \"); })\n\t\t.replace(/<text:tab[^<>]*\\/>/g,\"\\t\")\n\t\t.replace(/<text:line-break\\/>/g,\"\\n\");\n\tvar v = unescapexml(fixed.replace(/<[^<>]*>/g,\"\"));\n\n\treturn [v];\n}\n\n/* Note: ODS can stick styles in content.xml or styles.xml, FODS blurs lines */\nfunction parse_ods_styles(d/*:string*/, _opts, _nfm) {\n\tvar number_format_map = _nfm || {};\n\tvar str = xlml_normalize(d);\n\txlmlregex.lastIndex = 0;\n\tstr = remove_doctype(str_remove_ng(str, \"<!--\", \"-->\"));\n\tvar Rn, NFtag, NF = \"\", tNF = \"\", y, etpos = 0, tidx = -1, infmt = false, payload = \"\";\n\twhile((Rn = xlmlregex.exec(str))) {\n\t\tswitch((Rn[3]=Rn[3].replace(/_[\\s\\S]*$/,\"\"))) {\n\t\t/* Number Format Definitions */\n\t\tcase 'number-style': // <number:number-style> 16.29.2\n\t\tcase 'currency-style': // <number:currency-style> 16.29.8\n\t\tcase 'percentage-style': // <number:percentage-style> 16.29.10\n\t\tcase 'date-style': // <number:date-style> 16.29.11\n\t\tcase 'time-style': // <number:time-style> 16.29.19\n\t\tcase 'text-style': // <number:text-style> 16.29.26\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tinfmt = false;\n\t\t\t\tif(NFtag['truncate-on-overflow'] == \"false\") {\n\t\t\t\t\tif(NF.match(/h/)) NF = NF.replace(/h+/, \"[$&]\");\n\t\t\t\t\telse if(NF.match(/m/)) NF = NF.replace(/m+/, \"[$&]\");\n\t\t\t\t\telse if(NF.match(/s/)) NF = NF.replace(/s+/, \"[$&]\");\n\t\t\t\t}\n\t\t\t\tnumber_format_map[NFtag.name] = NF;\n\t\t\t\tNF = \"\";\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\tinfmt = true;\n\t\t\t\tNF = \"\";\n\t\t\t\tNFtag = parsexmltag(Rn[0], false);\n\t\t\t} break;\n\n\t\t// LibreOffice bug https://bugs.documentfoundation.org/show_bug.cgi?id=149484\n\t\tcase 'boolean-style': // <number:boolean-style> 16.29.24\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tinfmt = false;\n\t\t\t\tnumber_format_map[NFtag.name] = \"General\";\n\t\t\t\tNF = \"\";\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\tinfmt = true;\n\t\t\t\tNF = \"\";\n\t\t\t\tNFtag = parsexmltag(Rn[0], false);\n\t\t\t} break;\n\n\t\t/* Number Format Elements */\n\t\tcase 'boolean': // <number:boolean> 16.29.25\n\t\t\tNF += \"General\"; // ODF spec is unfortunately underspecified here\n\t\t\tbreak;\n\n\t\tcase 'text': // <number:text> 16.29.27\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tpayload = str.slice(tidx, xlmlregex.lastIndex - Rn[0].length);\n\t\t\t\t// NOTE: Excel has a different interpretation of \"%%\" and friends\n\t\t\t\tif(payload == \"%\" && NFtag[0] == '<number:percentage-style') NF += \"%\";\n\t\t\t\telse NF += '\"' + payload.replace(/\"/g, '\"\"') + '\"';\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\ttidx = xlmlregex.lastIndex;\n\t\t\t} break;\n\n\n\t\tcase 'day': { // <number:day> 16.29.12\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"d\"; break;\n\t\t\t\tcase \"long\": NF += \"dd\"; break;\n\t\t\t\tdefault: NF += \"dd\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'day-of-week': { // <number:day-of-week> 16.29.16\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"ddd\"; break;\n\t\t\t\tcase \"long\": NF += \"dddd\"; break;\n\t\t\t\tdefault: NF += \"ddd\"; break;\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'era': { // <number:era> 16.29.15 TODO: proper mapping\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"ee\"; break;\n\t\t\t\tcase \"long\": NF += \"eeee\"; break;\n\t\t\t\tdefault: NF += \"eeee\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'hours': { // <number:hours> 16.29.20\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"h\"; break;\n\t\t\t\tcase \"long\": NF += \"hh\"; break;\n\t\t\t\tdefault: NF += \"hh\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'minutes': { // <number:minutes> 16.29.21\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"m\"; break;\n\t\t\t\tcase \"long\": NF += \"mm\"; break;\n\t\t\t\tdefault: NF += \"mm\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'month': { // <number:month> 16.29.13\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tif(y[\"textual\"]) NF += \"mm\";\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"m\"; break;\n\t\t\t\tcase \"long\": NF += \"mm\"; break;\n\t\t\t\tdefault: NF += \"m\"; break;\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'seconds': { // <number:seconds> 16.29.22\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"s\"; break;\n\t\t\t\tcase \"long\": NF += \"ss\"; break;\n\t\t\t\tdefault: NF += \"ss\"; break; // TODO: error condition\n\t\t\t}\n\t\t\tif(y[\"decimal-places\"]) NF += \".\" + fill(\"0\", +y[\"decimal-places\"]);\n\t\t} break;\n\n\t\tcase 'year': { // <number:year> 16.29.14\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch(y[\"style\"]) {\n\t\t\t\tcase \"short\": NF += \"yy\"; break;\n\t\t\t\tcase \"long\": NF += \"yyyy\"; break;\n\t\t\t\tdefault: NF += \"yy\"; break; // TODO: error condition\n\t\t\t}\n\t\t} break;\n\n\t\tcase 'am-pm': // <number:am-pm> 16.29.23\n\t\t\tNF += \"AM/PM\"; // LO autocorrects A/P -> AM/PM\n\t\t\tbreak;\n\n\t\tcase 'week-of-year': // <number:week-of-year> 16.29.17\n\t\tcase 'quarter': // <number:quarter> 16.29.18\n\t\t\tconsole.error(\"Excel does not support ODS format token \" + Rn[3]);\n\t\t\tbreak;\n\n\t\tcase 'fill-character': // <number:fill-character> 16.29.5\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tpayload = str.slice(tidx, xlmlregex.lastIndex - Rn[0].length);\n\t\t\t\t// NOTE: Excel has a different interpretation of \"%%\" and friends\n\t\t\t\tNF += '\"' + payload.replace(/\"/g, '\"\"') + '\"*';\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\ttidx = xlmlregex.lastIndex;\n\t\t\t} break;\n\n\t\tcase 'scientific-number': // <number:scientific-number> 16.29.6\n\t\t\t// TODO: find a mapping for all parameters\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tNF += \"0.\" + fill(\"0\", +y[\"min-decimal-places\"] || +y[\"decimal-places\"] || 2) + fill(\"?\", +y[\"decimal-places\"] - +y[\"min-decimal-places\"] || 0) + \"E\" + (parsexmlbool(y[\"forced-exponent-sign\"]) ? \"+\" : \"\") + fill(\"0\", +y[\"min-exponent-digits\"] || 2);\n\t\t\tbreak;\n\n\t\tcase 'fraction': // <number:fraction> 16.29.7\n\t\t\t// TODO: find a mapping for all parameters\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tif(!+y[\"min-integer-digits\"]) NF += \"#\";\n\t\t\telse NF += fill(\"0\", +y[\"min-integer-digits\"]);\n\t\t\tNF += \" \";\n\t\t\tNF += fill(\"?\", +y[\"min-numerator-digits\"] || 1);\n\t\t\tNF += \"/\";\n\t\t\tif(+y[\"denominator-value\"]) NF += y[\"denominator-value\"];\n\t\t\telse NF += fill(\"?\", +y[\"min-denominator-digits\"] || 1);\n\t\t\tbreak;\n\n\t\tcase 'currency-symbol': // <number:currency-symbol> 16.29.9\n\t\t\t// TODO: localization with [$-...]\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tNF += '\"' + str.slice(tidx, xlmlregex.lastIndex - Rn[0].length).replace(/\"/g, '\"\"') + '\"';\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\ttidx = xlmlregex.lastIndex;\n\t\t\t} else NF += \"$\";\n\t\t\tbreak;\n\n\t\tcase 'text-properties': // <style:text-properties> 16.29.29\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tswitch((y[\"color\"]||\"\").toLowerCase().replace(\"#\", \"\")) {\n\t\t\t\tcase \"ff0000\": case \"red\": NF = \"[Red]\" + NF; break;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'text-content': // <number:text-content> 16.29.28\n\t\t\tNF += \"@\";\n\t\t\tbreak;\n\n\t\tcase 'map': // <style:map> 16.3\n\t\t\t// TODO: handle more complex maps\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\tif(unescapexml(y[\"condition\"]) == \"value()>=0\") NF = number_format_map[y[\"apply-style-name\"]] + \";\" + NF;\n\t\t\telse console.error(\"ODS number format may be incorrect: \" + y[\"condition\"]);\n\t\t\tbreak;\n\n\t\tcase 'number': // <number:number> 16.29.3\n\t\t\t// TODO: handle all the attributes\n\t\t\tif(Rn[1]==='/') break;\n\t\t\ty = parsexmltag(Rn[0], false);\n\t\t\ttNF = \"\";\n\t\t\ttNF += fill(\"0\", +y[\"min-integer-digits\"] || 1);\n\t\t\tif(parsexmlbool(y[\"grouping\"])) tNF = commaify(fill(\"#\", Math.max(0, 4 - tNF.length)) + tNF);\n\t\t\tif(+y[\"min-decimal-places\"] || +y[\"decimal-places\"]) tNF += \".\";\n\t\t\tif(+y[\"min-decimal-places\"]) tNF += fill(\"0\", +y[\"min-decimal-places\"] || 1);\n\t\t\tif(+y[\"decimal-places\"] - (+y[\"min-decimal-places\"]||0)) tNF += fill(\"0\", +y[\"decimal-places\"] - (+y[\"min-decimal-places\"]||0)); // TODO: should this be \"#\" ?\n\t\t\tNF += tNF;\n\t\t\tbreak;\n\n\t\tcase 'embedded-text': // <number:embedded-text> 16.29.4\n\t\t\t// TODO: verify interplay with grouping et al\n\t\t\tif(Rn[1]==='/') {\n\t\t\t\tif(etpos == 0) NF += '\"' + str.slice(tidx, xlmlregex.lastIndex - Rn[0].length).replace(/\"/g, '\"\"') + '\"';\n\t\t\t\telse NF = NF.slice(0, etpos) + '\"' + str.slice(tidx, xlmlregex.lastIndex - Rn[0].length).replace(/\"/g, '\"\"') + '\"' + NF.slice(etpos);\n\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\ttidx = xlmlregex.lastIndex;\n\t\t\t\tetpos = -+parsexmltag(Rn[0], false)[\"position\"] || 0;\n\t\t\t} break;\n\n\t}}\n\treturn number_format_map;\n}\n\nfunction parse_content_xml(d/*:string*/, _opts, _nfm)/*:Workbook*/ {\n\t\tvar opts = _opts || {};\n\t\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\t\tvar str = xlml_normalize(d);\n\t\tvar state/*:Array<any>*/ = [], tmp;\n\t\tvar tag/*:: = {}*/;\n\t\tvar nfidx, NF = \"\", pidx = 0;\n\t\tvar sheetag/*:: = {name:\"\", '名称':\"\"}*/;\n\t\tvar rowtag/*:: = {'行号':\"\"}*/;\n\t\tvar Sheets = {}, SheetNames/*:Array<string>*/ = [];\n\t\tvar ws = ({}/*:any*/); if(opts.dense) ws[\"!data\"] = [];\n\t\tvar Rn, q/*:: :any = ({t:\"\", v:null, z:null, w:\"\",c:[],}:any)*/;\n\t\tvar ctag = ({value:\"\"}/*:any*/), ctag2 = ({}/*:any*/);\n\t\tvar textp = \"\", textpidx = 0, textptag/*:: = {}*/, oldtextp = \"\", oldtextpidx = 0;\n\t\tvar textR = [], oldtextR = [];\n\t\tvar R = -1, C = -1, range = {s: {r:1000000,c:10000000}, e: {r:0, c:0}};\n\t\tvar row_ol = 0;\n\t\tvar number_format_map = _nfm || {}, styles = {};\n\t\tvar merges/*:Array<Range>*/ = [], mrange = {}, mR = 0, mC = 0;\n\t\tvar rowinfo/*:Array<RowInfo>*/ = [], rowpeat = 1, colpeat = 1;\n\t\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\t\tvar WB = {Names:[], WBProps:{}};\n\t\tvar atag = ({}/*:any*/);\n\t\tvar _Ref/*:[string, string]*/ = [\"\", \"\"];\n\t\tvar comments/*:Array<Comment>*/ = [], comment/*:Comment*/ = ({}/*:any*/);\n\t\tvar creator = \"\", creatoridx = 0;\n\t\tvar isstub = false, intable = false;\n\t\tvar i = 0;\n\t\txlmlregex.lastIndex = 0;\n\t\tstr = remove_doctype(str_remove_ng(str, \"<!--\", \"-->\"));\n\t\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3]=Rn[3].replace(/_[\\s\\S]*$/,\"\"))) {\n\n\t\t\tcase 'table': case '工作表': // 9.1.2 <table:table>\n\t\t\t\tif(Rn[1]==='/') {\n\t\t\t\t\tif(range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = encode_range(range);\n\t\t\t\t\telse ws['!ref'] = \"A1:A1\";\n\t\t\t\t\tif(opts.sheetRows > 0 && opts.sheetRows <= range.e.r) {\n\t\t\t\t\t\tws['!fullref'] = ws['!ref'];\n\t\t\t\t\t\trange.e.r = opts.sheetRows - 1;\n\t\t\t\t\t\tws['!ref'] = encode_range(range);\n\t\t\t\t\t}\n\t\t\t\t\tif(merges.length) ws['!merges'] = merges;\n\t\t\t\t\tif(rowinfo.length) ws[\"!rows\"] = rowinfo;\n\t\t\t\t\tsheetag.name = sheetag['名称'] || sheetag.name;\n\t\t\t\t\tif(typeof JSON !== 'undefined') JSON.stringify(sheetag);\n\t\t\t\t\tSheetNames.push(sheetag.name);\n\t\t\t\t\tSheets[sheetag.name] = ws;\n\t\t\t\t\tintable = false;\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tsheetag = parsexmltag(Rn[0], false);\n\t\t\t\t\tR = C = -1;\n\t\t\t\t\trange.s.r = range.s.c = 10000000; range.e.r = range.e.c = 0;\n\t\t\t\t\tws = ({}/*:any*/); if(opts.dense) ws[\"!data\"] = []; merges = [];\n\t\t\t\t\trowinfo = [];\n\t\t\t\t\tintable = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'table-row-group': // 9.1.9 <table:table-row-group>\n\t\t\t\tif(Rn[1] === \"/\") --row_ol; else ++row_ol;\n\t\t\t\tbreak;\n\t\t\tcase 'table-row': case '行': // 9.1.3 <table:table-row>\n\t\t\t\tif(Rn[1] === '/') { R+=rowpeat; rowpeat = 1; break; }\n\t\t\t\trowtag = parsexmltag(Rn[0], false);\n\t\t\t\tif(rowtag['行号']) R = rowtag['行号'] - 1; else if(R == -1) R = 0;\n\t\t\t\trowpeat = +rowtag['number-rows-repeated'] || 1;\n\t\t\t\t/* TODO: remove magic */\n\t\t\t\tif(rowpeat < 10) for(i = 0; i < rowpeat; ++i) if(row_ol > 0) rowinfo[R + i] = {level: row_ol};\n\t\t\t\tC = -1; break;\n\t\t\tcase 'covered-table-cell': // 9.1.5 <table:covered-table-cell>\n\t\t\t\tif(Rn[1] !== '/') {\n\t\t\t\t\t++C;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\",10) || 1;\n\t\t\t\t\tif(opts.sheetStubs) {\n\t\t\t\t\t\twhile(colpeat-- > 0) {\n\t\t\t\t\t\t\tif(opts.dense) { if(!ws[\"!data\"][R]) ws[\"!data\"][R] = []; ws[\"!data\"][R][C] = {t:'z'}; }\n\t\t\t\t\t\t\telse ws[encode_cell({r:R,c:C})] = {t:'z'};\n\t\t\t\t\t\t\t++C;\n\t\t\t\t\t\t} --C;\n\t\t\t\t\t}\n\t\t\t\t\telse C += colpeat - 1;\n\t\t\t\t}\n\t\t\t\ttextp = \"\"; textR = [];\n\t\t\t\tbreak; /* stub */\n\t\t\tcase 'table-cell': case '数据':\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) === '/') {\n\t\t\t\t\t++C;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10)||1;\n\t\t\t\t\tq = ({t:'z', v:null/*:: , z:null, w:\"\",c:[]*/}/*:any*/);\n\t\t\t\t\tif(ctag.formula && opts.cellFormula != false) q.f = ods_to_csf_formula(unescapexml(ctag.formula));\n\t\t\t\t\tif(ctag[\"style-name\"] && styles[ctag[\"style-name\"]]) q.z = styles[ctag[\"style-name\"]];\n\t\t\t\t\tif((ctag['数据类型'] || ctag['value-type']) == \"string\") {\n\t\t\t\t\t\tq.t = \"s\"; q.v = unescapexml(ctag['string-value'] || \"\");\n\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\tif(!ws[\"!data\"][R]) ws[\"!data\"][R] = [];\n\t\t\t\t\t\t\tws[\"!data\"][R][C] = q;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tws[encode_col(C) + encode_row(R)] = q;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tC+= colpeat-1;\n\t\t\t\t} else if(Rn[1]!=='/') {\n\t\t\t\t\t++C;\n\t\t\t\t\ttextp = oldtextp = \"\"; textpidx = oldtextpidx = 0; textR = []; oldtextR = [];\n\t\t\t\t\tcolpeat = 1;\n\t\t\t\t\tvar rptR = rowpeat ? R + rowpeat - 1 : R;\n\t\t\t\t\tif(C > range.e.c) range.e.c = C;\n\t\t\t\t\tif(C < range.s.c) range.s.c = C;\n\t\t\t\t\tif(R < range.s.r) range.s.r = R;\n\t\t\t\t\tif(rptR > range.e.r) range.e.r = rptR;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tctag2 = parsexmltagraw(Rn[0], true);\n\t\t\t\t\tcomments = []; comment = ({}/*:any*/);\n\t\t\t\t\tq = ({t:ctag['数据类型'] || ctag['value-type'], v:null/*:: , z:null, w:\"\",c:[]*/}/*:any*/);\n\t\t\t\t\tif(ctag[\"style-name\"] && styles[ctag[\"style-name\"]]) q.z = styles[ctag[\"style-name\"]];\n\t\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\t\tif(ctag.formula) ctag.formula = unescapexml(ctag.formula);\n\t\t\t\t\t\tif(ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n\t\t\t\t\t\t\tmR = parseInt(ctag['number-matrix-rows-spanned'],10) || 0;\n\t\t\t\t\t\t\tmC = parseInt(ctag['number-matrix-columns-spanned'],10) || 0;\n\t\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\t\tq.F = encode_range(mrange);\n\t\t\t\t\t\t\tarrayf.push([mrange, q.F]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ctag.formula) q.f = ods_to_csf_formula(ctag.formula);\n\t\t\t\t\t\telse for(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\t\t\tif(R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r)\n\t\t\t\t\t\t\t\tif(C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\t\t\tq.F = arrayf[i][1];\n\t\t\t\t\t}\n\t\t\t\t\tif(ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n\t\t\t\t\t\tmR = parseInt(ctag['number-rows-spanned']||\"1\",10) || 1;\n\t\t\t\t\t\tmC = parseInt(ctag['number-columns-spanned']||\"1\",10) || 1;\n\t\t\t\t\t\tif(mR * mC > 1) {\n\t\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\t\tmerges.push(mrange);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t/* 19.675.2 table:number-columns-repeated */\n\t\t\t\t\tif(ctag['number-columns-repeated']) colpeat = parseInt(ctag['number-columns-repeated'], 10);\n\n\t\t\t\t\t/* 19.385 office:value-type TODO: verify ODS and UOS */\n\t\t\t\t\tswitch(q.t) {\n\t\t\t\t\t\tcase 'boolean': q.t = 'b'; q.v = parsexmlbool(ctag['boolean-value']) || (+ctag['boolean-value'] >= 1); break;\n\t\t\t\t\t\tcase 'float': q.t = 'n'; q.v = parseFloat(ctag.value);\n\t\t\t\t\t\t\tif(opts.cellDates && q.z && fmt_is_date(q.z)) { q.v = numdate(q.v + (WB.WBProps.date1904 ? 1462 : 0)); q.t = typeof q.v == \"number\" ? 'n' : 'd'; }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'percentage': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'currency': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'date': q.t = 'd'; q.v = parseDate(ctag['date-value'], WB.WBProps.date1904);\n\t\t\t\t\t\t\tif(!opts.cellDates) { q.t = 'n'; q.v = datenum(q.v, WB.WBProps.date1904); }\n\t\t\t\t\t\t\tif(!q.z) q.z = 'm/d/yy'; break;\n\t\t\t\t\t\t/* NOTE: for `time`, Excel ODS export incorrectly uses durations relative to 1900 epoch even if 1904 is specified */\n\t\t\t\t\t\tcase 'time': q.t = 'n'; q.v = parse_isodur(ctag['time-value'])/86400;\n\t\t\t\t\t\t\tif(opts.cellDates) { q.v = numdate(q.v); q.t = typeof q.v == \"number\" ? 'n' : 'd'; }\n\t\t\t\t\t\t\tif(!q.z) q.z = 'HH:MM:SS'; break;\n\t\t\t\t\t\tcase 'number': q.t = 'n'; q.v = parseFloat(ctag['数据数值']);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif(q.t === 'string' || q.t === 'text' || !q.t) {\n\t\t\t\t\t\t\t\tq.t = 's';\n\t\t\t\t\t\t\t\tif(ctag['string-value'] != null) { textp = unescapexml(ctag['string-value']); textR = []; }\n\t\t\t\t\t\t\t} else throw new Error('Unsupported value type ' + q.t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tisstub = false;\n\t\t\t\t\tif(ctag2['calcext:value-type'] == \"error\" && RBErr[textp] != null) {\n\t\t\t\t\t\tq.t = 'e'; q.w = textp; q.v = RBErr[textp];\n\t\t\t\t\t}\n\t\t\t\t\tif(q.t === 's') {\n\t\t\t\t\t\tq.v = textp || '';\n\t\t\t\t\t\tif(textR.length) q.R = textR;\n\t\t\t\t\t\tisstub = textpidx == 0;\n\t\t\t\t\t}\n\t\t\t\t\tif(atag.Target) q.l = atag;\n\t\t\t\t\tif(comments.length > 0) { q.c = comments; comments = []; }\n\t\t\t\t\tif(textp && opts.cellText !== false) q.w = textp;\n\t\t\t\t\tif(isstub) { q.t = \"z\"; delete q.v; }\n\t\t\t\t\tif(!isstub || opts.sheetStubs) {\n\t\t\t\t\t\tif(!(opts.sheetRows && opts.sheetRows <= R)) {\n\t\t\t\t\t\t\tfor(var rpt = 0; rpt < rowpeat; ++rpt) {\n\t\t\t\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\t\t\tif(!ws[\"!data\"][R + rpt]) ws[\"!data\"][R + rpt] = [];\n\t\t\t\t\t\t\t\t\tws[\"!data\"][R + rpt][C] = rpt == 0 ? q : dup(q);\n\t\t\t\t\t\t\t\t\twhile(--colpeat > 0) ws[\"!data\"][R + rpt][C + colpeat] = dup(q);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tws[encode_cell({r:R + rpt,c:C})] = q;\n\t\t\t\t\t\t\t\t\twhile(--colpeat > 0) ws[encode_cell({r:R + rpt,c:C + colpeat})] = dup(q);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(range.e.c <= C) range.e.c = C;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\tC += colpeat-1; colpeat = 0;\n\t\t\t\t\tq = {/*:: t:\"\", v:null, z:null, w:\"\",c:[]*/};\n\t\t\t\t\ttextp = \"\"; textR = [];\n\t\t\t\t}\n\t\t\t\tatag = ({}/*:any*/);\n\t\t\t\tbreak; // 9.1.4 <table:table-cell>\n\n\t\t\t/* pure state */\n\t\t\tcase 'document': // TODO: <office:document> is the root for FODS\n\t\t\tcase 'document-content': case '电子表格文档': // 3.1.3.2 <office:document-content>\n\t\t\tcase 'spreadsheet': case '主体': // 3.7 <office:spreadsheet>\n\t\t\tcase 'scripts': // 3.12 <office:scripts>\n\t\t\tcase 'styles': // TODO <office:styles>\n\t\t\tcase 'font-face-decls': // 3.14 <office:font-face-decls>\n\t\t\tcase 'master-styles': // 3.15.4 <office:master-styles> -- relevant for FODS\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\n\t\t\tcase 'annotation': // 14.1 <office:annotation>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\t\tcomment.t = textp;\n\t\t\t\t\tif(textR.length) /*::(*/comment/*:: :any)*/.R = textR;\n\t\t\t\t\tcomment.a = creator;\n\t\t\t\t\tcomments.push(comment);\n\t\t\t\t\ttextp = oldtextp; textpidx = oldtextpidx; textR = oldtextR;\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\t\tvar annotag = parsexmltag(Rn[0], true);\n\t\t\t\t\t/* office:display TODO: check if there is a global override */\n\t\t\t\t\tif(!(annotag[\"display\"] && parsexmlbool(annotag[\"display\"]))) comments.hidden = true;\n\t\t\t\t\toldtextp = textp; oldtextpidx = textpidx; oldtextR = textR;\n\t\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\t}\n\t\t\t\tcreator = \"\"; creatoridx = 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 'creator': // 4.3.2.7 <dc:creator>\n\t\t\t\tif(Rn[1]==='/') { creator = str.slice(creatoridx,Rn.index); }\n\t\t\t\telse creatoridx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\n\t\t\t/* ignore state */\n\t\t\tcase 'meta': case '元数据': // TODO: <office:meta> <uof:元数据> FODS/UOF\n\t\t\tcase 'settings': // TODO: <office:settings>\n\t\t\tcase 'config-item-set': // TODO: <office:config-item-set>\n\t\t\tcase 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n\t\t\tcase 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'config-item-map-named': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'shapes': // 9.2.8 <table:shapes>\n\t\t\tcase 'frame': // 10.4.2 <draw:frame>\n\t\t\tcase 'text-box': // 10.4.3 <draw:text-box>\n\t\t\tcase 'image': // 10.4.4 <draw:image>\n\t\t\tcase 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n\t\t\tcase 'list-style': // 16.30 <text:list-style>\n\t\t\tcase 'form': // 13.13 <form:form>\n\t\t\tcase 'dde-links': // 9.8 <table:dde-links>\n\t\t\tcase 'event-listeners': // TODO\n\t\t\tcase 'chart': // TODO\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], false]);\n\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\tbreak;\n\n\t\t\tcase 'scientific-number': // <number:scientific-number>\n\t\t\tcase 'currency-symbol': // <number:currency-symbol>\n\t\t\tcase 'fill-character': // 16.29.5 <number:fill-character>\n\t\t\t\tbreak;\n\n\t\t\tcase 'text-style': // 16.27.25 <number:text-style>\n\t\t\tcase 'boolean-style': // 16.27.23 <number:boolean-style>\n\t\t\tcase 'number-style': // 16.27.2 <number:number-style>\n\t\t\tcase 'currency-style': // 16.29.8 <number:currency-style>\n\t\t\tcase 'percentage-style': // 16.27.9 <number:percentage-style>\n\t\t\tcase 'date-style': // 16.27.10 <number:date-style>\n\t\t\tcase 'time-style': // 16.27.18 <number:time-style>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tvar xlmlidx = xlmlregex.lastIndex;\n\t\t\t\t\tparse_ods_styles(str.slice(nfidx, xlmlregex.lastIndex), _opts, number_format_map);\n\t\t\t\t\txlmlregex.lastIndex = xlmlidx;\n\t\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tnfidx = xlmlregex.lastIndex - Rn[0].length;\n\t\t\t\t} break;\n\n\t\t\tcase 'script': break; // 3.13 <office:script>\n\t\t\tcase 'libraries': break; // TODO: <ooo:libraries>\n\t\t\tcase 'automatic-styles': break; // 3.15.3 <office:automatic-styles>\n\n\t\t\tcase 'default-style': // TODO: <style:default-style>\n\t\t\tcase 'page-layout': break; // TODO: <style:page-layout>\n\t\t\tcase 'style': { // 16.2 <style:style>\n\t\t\t\tvar styletag = parsexmltag(Rn[0], false);\n\t\t\t\tif(styletag[\"family\"] == \"table-cell\" && number_format_map[styletag[\"data-style-name\"]]) styles[styletag[\"name\"]] = number_format_map[styletag[\"data-style-name\"]];\n\t\t\t} break;\n\t\t\tcase 'map': break; // 16.3 <style:map>\n\t\t\tcase 'font-face': break; // 16.21 <style:font-face>\n\n\t\t\tcase 'paragraph-properties': break; // 17.6 <style:paragraph-properties>\n\t\t\tcase 'table-properties': break; // 17.15 <style:table-properties>\n\t\t\tcase 'table-column-properties': break; // 17.16 <style:table-column-properties>\n\t\t\tcase 'table-row-properties': break; // 17.17 <style:table-row-properties>\n\t\t\tcase 'table-cell-properties': break; // 17.18 <style:table-cell-properties>\n\n\t\t\tcase 'number': // 16.27.3 <number:number>\n\t\t\t\tbreak;\n\n\t\t\tcase 'fraction': break; // TODO 16.27.6 <number:fraction>\n\n\t\t\tcase 'day': // 16.27.11 <number:day>\n\t\t\tcase 'month': // 16.27.12 <number:month>\n\t\t\tcase 'year': // 16.27.13 <number:year>\n\t\t\tcase 'era': // 16.27.14 <number:era>\n\t\t\tcase 'day-of-week': // 16.27.15 <number:day-of-week>\n\t\t\tcase 'week-of-year': // 16.27.16 <number:week-of-year>\n\t\t\tcase 'quarter': // 16.27.17 <number:quarter>\n\t\t\tcase 'hours': // 16.27.19 <number:hours>\n\t\t\tcase 'minutes': // 16.27.20 <number:minutes>\n\t\t\tcase 'seconds': // 16.27.21 <number:seconds>\n\t\t\tcase 'am-pm': // 16.27.22 <number:am-pm>\n\t\t\t\tbreak;\n\n\t\t\tcase 'boolean': break; // 16.27.24 <number:boolean>\n\t\t\tcase 'text': // 16.27.26 <number:text>\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") switch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'number-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\t\tNF += str.slice(pidx, Rn.index);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\n\t\t\tcase 'named-range': // 9.4.12 <table:named-range>\n\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t_Ref = ods_to_csf_3D(tag['cell-range-address']);\n\t\t\t\tvar nrange = ({Name:tag.name, Ref:_Ref[0] + '!' + _Ref[1]}/*:any*/);\n\t\t\t\tif(intable) nrange.Sheet = SheetNames.length;\n\t\t\t\tWB.Names.push(nrange);\n\t\t\t\tbreak;\n\n\t\t\tcase 'text-content': break; // 16.27.27 <number:text-content>\n\t\t\tcase 'text-properties': break; // 16.27.27 <style:text-properties>\n\t\t\tcase 'embedded-text': break; // 16.27.4 <number:embedded-text>\n\n\t\t\tcase 'body': case '电子表格': break; // 3.3 16.9.6 19.726.3\n\n\t\t\tcase 'forms': break; // 12.25.2 13.2\n\t\t\tcase 'table-column': break; // 9.1.6 <table:table-column>\n\t\t\tcase 'table-header-rows': break; // 9.1.7 <table:table-header-rows>\n\t\t\tcase 'table-rows': break; // 9.1.12 <table:table-rows>\n\t\t\t/* TODO: outline levels */\n\t\t\tcase 'table-column-group': break; // 9.1.10 <table:table-column-group>\n\t\t\tcase 'table-header-columns': break; // 9.1.11 <table:table-header-columns>\n\t\t\tcase 'table-columns': break; // 9.1.12 <table:table-columns>\n\n\t\t\tcase 'null-date': // 9.4.2 <table:null-date>\n\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\tswitch(tag[\"date-value\"]) {\n\t\t\t\t\tcase \"1904-01-01\": WB.WBProps.date1904 = true; break;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'graphic-properties': break; // 17.21 <style:graphic-properties>\n\t\t\tcase 'calculation-settings': break; // 9.4.1 <table:calculation-settings>\n\t\t\tcase 'named-expressions': break; // 9.4.11 <table:named-expressions>\n\t\t\tcase 'label-range': break; // 9.4.9 <table:label-range>\n\t\t\tcase 'label-ranges': break; // 9.4.10 <table:label-ranges>\n\t\t\tcase 'named-expression': break; // 9.4.13 <table:named-expression>\n\t\t\tcase 'sort': break; // 9.4.19 <table:sort>\n\t\t\tcase 'sort-by': break; // 9.4.20 <table:sort-by>\n\t\t\tcase 'sort-groups': break; // 9.4.22 <table:sort-groups>\n\n\t\t\tcase 'tab': break; // 6.1.4 <text:tab>\n\t\t\tcase 'line-break': break; // 6.1.5 <text:line-break>\n\t\t\tcase 'span': break; // 6.1.7 <text:span>\n\t\t\tcase 'p': case '文本串': // 5.1.3 <text:p>\n\t\t\t\tif(['master-styles'].indexOf(state[state.length-1][0]) > -1) break;\n\t\t\t\tif(Rn[1]==='/' && (!ctag || !ctag['string-value'])) {\n\t\t\t\t\tvar ptp = parse_text_p(str.slice(textpidx,Rn.index), textptag);\n\t\t\t\t\ttextp = (textp.length > 0 ? textp + \"\\n\" : \"\") + ptp[0];\n\t\t\t\t} else if(Rn[0].slice(-2) == \"/>\") {\n\t\t\t\t\t/* TODO: is self-closing 文本串 valid? */\n\t\t\t\t\ttextp += \"\\n\";\n\t\t\t\t} else { textptag = parsexmltag(Rn[0], false); textpidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak; // <text:p>\n\t\t\tcase 's': break; // <text:s>\n\n\t\t\tcase 'database-range': // 9.4.15 <table:database-range>\n\t\t\t\tif(Rn[1]==='/') break;\n\t\t\t\ttry {\n\t\t\t\t\t_Ref = ods_to_csf_3D(parsexmltag(Rn[0])['target-range-address']);\n\t\t\t\t\tSheets[_Ref[0]]['!autofilter'] = { ref:_Ref[1] };\n\t\t\t\t} catch(e) {/* empty */}\n\t\t\t\tbreak;\n\n\t\t\tcase 'date': break; // <*:date>\n\n\t\t\tcase 'object': break; // 10.4.6.2 <draw:object>\n\t\t\tcase 'title': case '标题': break; // <*:title> OR <uof:标题>\n\t\t\tcase 'desc': break; // <*:desc>\n\t\t\tcase 'binary-data': break; // 10.4.5 TODO: b64 blob\n\n\t\t\t/* 9.2 Advanced Tables */\n\t\t\tcase 'table-source': break; // 9.2.6\n\t\t\tcase 'scenario': break; // 9.2.6\n\n\t\t\tcase 'iteration': break; // 9.4.3 <table:iteration>\n\t\t\tcase 'content-validations': break; // 9.4.4 <table:\n\t\t\tcase 'content-validation': break; // 9.4.5 <table:\n\t\t\tcase 'help-message': break; // 9.4.6 <table:\n\t\t\tcase 'error-message': break; // 9.4.7 <table:\n\t\t\tcase 'database-ranges': break; // 9.4.14 <table:database-ranges>\n\n\t\t\t/* 9.5 Filters */\n\t\t\tcase 'filter': break; // 9.5.2 <table:filter>\n\t\t\tcase 'filter-and': break; // 9.5.3 <table:filter-and>\n\t\t\tcase 'filter-or': break; // 9.5.4 <table:filter-or>\n\t\t\tcase 'filter-condition': break; // 9.5.5 <table:filter-condition>\n\t\t\tcase 'filter-set-item': break; // 9.5.6 <table:filter-condition>\n\n\t\t\tcase 'list-level-style-bullet': break; // 16.31 <text:\n\t\t\tcase 'list-level-style-number': break; // 16.32 <text:\n\t\t\tcase 'list-level-properties': break; // 17.19 <style:\n\n\t\t\t/* 7.3 Document Fields */\n\t\t\tcase 'sender-firstname': // 7.3.6.2\n\t\t\tcase 'sender-lastname': // 7.3.6.3\n\t\t\tcase 'sender-initials': // 7.3.6.4\n\t\t\tcase 'sender-title': // 7.3.6.5\n\t\t\tcase 'sender-position': // 7.3.6.6\n\t\t\tcase 'sender-email': // 7.3.6.7\n\t\t\tcase 'sender-phone-private': // 7.3.6.8\n\t\t\tcase 'sender-fax': // 7.3.6.9\n\t\t\tcase 'sender-company': // 7.3.6.10\n\t\t\tcase 'sender-phone-work': // 7.3.6.11\n\t\t\tcase 'sender-street': // 7.3.6.12\n\t\t\tcase 'sender-city': // 7.3.6.13\n\t\t\tcase 'sender-postal-code': // 7.3.6.14\n\t\t\tcase 'sender-country': // 7.3.6.15\n\t\t\tcase 'sender-state-or-province': // 7.3.6.16\n\t\t\tcase 'author-name': // 7.3.7.1\n\t\t\tcase 'author-initials': // 7.3.7.2\n\t\t\tcase 'chapter': // 7.3.8\n\t\t\tcase 'file-name': // 7.3.9\n\t\t\tcase 'template-name': // 7.3.9\n\t\t\tcase 'sheet-name': // 7.3.9\n\t\t\t\tbreak;\n\n\t\t\tcase 'event-listener':\n\t\t\t\tbreak;\n\t\t\t/* TODO: FODS Properties */\n\t\t\tcase 'initial-creator':\n\t\t\tcase 'creation-date':\n\t\t\tcase 'print-date':\n\t\t\tcase 'generator':\n\t\t\tcase 'document-statistic':\n\t\t\tcase 'user-defined':\n\t\t\tcase 'editing-duration':\n\t\t\tcase 'editing-cycles':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: FODS Config */\n\t\t\tcase 'config-item':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: style tokens */\n\t\t\tcase 'page-number': break; // TODO <text:page-number>\n\t\t\tcase 'page-count': break; // TODO <text:page-count>\n\t\t\tcase 'time': break; // TODO <text:time>\n\n\t\t\t/* 9.3 Advanced Table Cells */\n\t\t\tcase 'cell-range-source': break; // 9.3.1 <table:\n\t\t\tcase 'detective': break; // 9.3.2 <table:\n\t\t\tcase 'operation': break; // 9.3.3 <table:\n\t\t\tcase 'highlighted-range': break; // 9.3.4 <table:\n\n\t\t\t/* 9.6 Data Pilot Tables <table: */\n\t\t\tcase 'data-pilot-table': // 9.6.3\n\t\t\tcase 'source-cell-range': // 9.6.5\n\t\t\tcase 'source-service': // 9.6.6\n\t\t\tcase 'data-pilot-field': // 9.6.7\n\t\t\tcase 'data-pilot-level': // 9.6.8\n\t\t\tcase 'data-pilot-subtotals': // 9.6.9\n\t\t\tcase 'data-pilot-subtotal': // 9.6.10\n\t\t\tcase 'data-pilot-members': // 9.6.11\n\t\t\tcase 'data-pilot-member': // 9.6.12\n\t\t\tcase 'data-pilot-display-info': // 9.6.13\n\t\t\tcase 'data-pilot-sort-info': // 9.6.14\n\t\t\tcase 'data-pilot-layout-info': // 9.6.15\n\t\t\tcase 'data-pilot-field-reference': // 9.6.16\n\t\t\tcase 'data-pilot-groups': // 9.6.17\n\t\t\tcase 'data-pilot-group': // 9.6.18\n\t\t\tcase 'data-pilot-group-member': // 9.6.19\n\t\t\t\tbreak;\n\n\t\t\t/* 10.3 Drawing Shapes */\n\t\t\tcase 'rect': // 10.3.2\n\t\t\t\tbreak;\n\n\t\t\t/* 14.6 DDE Connections */\n\t\t\tcase 'dde-connection-decls': // 14.6.2 <text:\n\t\t\tcase 'dde-connection-decl': // 14.6.3 <text:\n\t\t\tcase 'dde-link': // 14.6.4 <table:\n\t\t\tcase 'dde-source': // 14.6.5 <office:\n\t\t\t\tbreak;\n\n\t\t\tcase 'properties': break; // 13.7 <form:properties>\n\t\t\tcase 'property': break; // 13.8 <form:property>\n\n\t\t\tcase 'a': // 6.1.8 hyperlink\n\t\t\t\tif(Rn[1]!== '/') {\n\t\t\t\t\tatag = parsexmltag(Rn[0], false);\n\t\t\t\t\tif(!atag.href) break;\n\t\t\t\t\tatag.Target = unescapexml(atag.href); delete atag.href;\n\t\t\t\t\tif(atag.Target.charAt(0) == \"#\" && atag.Target.indexOf(\".\") > -1) {\n\t\t\t\t\t\t_Ref = ods_to_csf_3D(atag.Target.slice(1));\n\t\t\t\t\t\tatag.Target = \"#\" + _Ref[0] + \"!\" + _Ref[1];\n\t\t\t\t\t} else if(atag.Target.match(/^\\.\\.[\\\\\\/]/)) atag.Target = atag.Target.slice(3);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t/* non-standard */\n\t\t\tcase 'table-protection': break;\n\t\t\tcase 'data-pilot-grand-total': break; // <table:\n\t\t\tcase 'office-document-common-attrs': break; // bare\n\t\t\tdefault: switch(Rn[2]) {\n\t\t\t\tcase 'dc:':       // TODO: properties\n\t\t\t\tcase 'calcext:':  // ignore undocumented extensions\n\t\t\t\tcase 'loext:':    // ignore undocumented extensions\n\t\t\t\tcase 'ooo:':      // ignore undocumented extensions\n\t\t\t\tcase 'chartooo:': // ignore undocumented extensions\n\t\t\t\tcase 'draw:':     // TODO: drawing\n\t\t\t\tcase 'style:':    // TODO: styles\n\t\t\t\tcase 'chart:':    // TODO: charts\n\t\t\t\tcase 'form:':     // TODO: forms\n\t\t\t\tcase 'uof:':      // TODO: uof\n\t\t\t\tcase '表:':       // TODO: uof\n\t\t\t\tcase '字:':       // TODO: uof\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: if(opts.WTF) throw new Error(Rn);\n\t\t\t}\n\t\t}\n\t\tvar out/*:Workbook*/ = ({\n\t\t\tSheets: Sheets,\n\t\t\tSheetNames: SheetNames,\n\t\t\tWorkbook: WB\n\t\t}/*:any*/);\n\t\tif(opts.bookSheets) delete /*::(*/out/*:: :any)*/.Sheets;\n\t\treturn out;\n}\n\nfunction parse_ods(zip/*:ZIPFile*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\topts = opts || ({}/*:any*/);\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n\tvar styles = getzipstr(zip, 'styles.xml');\n\tvar Styles = styles && parse_ods_styles(utf8read(styles), opts);\n\tvar content = getzipstr(zip, 'content.xml');\n\tif(!content) throw new Error(\"Missing content.xml in ODS / UOF file\");\n\tvar wb = parse_content_xml(utf8read(content), opts, Styles);\n\tif(safegetzipfile(zip, 'meta.xml')) wb.Props = parse_core_props(getzipdata(zip, 'meta.xml'));\n\twb.bookType = \"ods\";\n\treturn wb;\n}\nfunction parse_fods(data/*:string*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tvar wb = parse_content_xml(data, opts);\n\twb.bookType = \"fods\";\n\treturn wb;\n}\n/* OpenDocument */\nvar write_styles_ods/*:{(wb:any, opts:any):string}*/ = /* @__PURE__ */(function() {\n\tvar master_styles = [\n\t\t'<office:master-styles>',\n\t\t\t'<style:master-page style:name=\"mp1\" style:page-layout-name=\"mp1\">',\n\t\t\t\t'<style:header/>',\n\t\t\t\t'<style:header-left style:display=\"false\"/>',\n\t\t\t\t'<style:footer/>',\n\t\t\t\t'<style:footer-left style:display=\"false\"/>',\n\t\t\t'</style:master-page>',\n\t\t'</office:master-styles>'\n\t].join(\"\");\n\n\tvar payload = '<office:document-styles ' + wxt_helper({\n\t\t'xmlns:office':   \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n\t\t'xmlns:table':    \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n\t\t'xmlns:style':    \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n\t\t'xmlns:text':     \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n\t\t'xmlns:draw':     \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n\t\t'xmlns:fo':       \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n\t\t'xmlns:xlink':    \"http://www.w3.org/1999/xlink\",\n\t\t'xmlns:dc':       \"http://purl.org/dc/elements/1.1/\",\n\t\t'xmlns:number':   \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n\t\t'xmlns:svg':      \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n\t\t'xmlns:of':       \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n\t\t'office:version': \"1.2\"\n\t}) + '>' + master_styles + '</office:document-styles>';\n\n\treturn function wso(/*::wb, opts*/) {\n\t\treturn XML_HEADER + payload;\n\t};\n})();\n\n// TODO: find out if anyone actually read the spec.  LO has some wild errors\nfunction write_number_format_ods(nf/*:string*/, nfidx/*:string*/)/*:string*/ {\n\tvar type = \"number\", payload = \"\", nopts = { \"style:name\": nfidx }, c = \"\", i = 0;\n\tnf = nf.replace(/\"[$]\"/g, \"$\");\n\t/* TODO: replace with an actual parser based on a real grammar */\n\tj: {\n\t\t// TODO: support style maps\n\t\tif(nf.indexOf(\";\") > -1) {\n\t\t\tconsole.error(\"Unsupported ODS Style Map exported.  Using first branch of \" + nf);\n\t\t\tnf = nf.slice(0, nf.indexOf(\";\"));\n\t\t}\n\n\t\tif(nf == \"@\") { type = \"text\"; payload = \"<number:text-content/>\"; break j; }\n\n\t\t/* currency flag */\n\t\tif(nf.indexOf(/\\$/) > -1) { type = \"currency\"; }\n\n\t\t/* opening string literal */\n\t\tif(nf[i] == '\"') {\n\t\t\tc = \"\";\n\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\tif(nf[i+1] == \"*\") {\n\t\t\t\ti++;\n\t\t\t\tpayload += '<number:fill-character>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:fill-character>';\n\t\t\t} else {\n\t\t\t\tpayload += '<number:text>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t\t}\n\t\t\tnf = nf.slice(i+1); i = 0;\n\t\t}\n\n\t\t/* fractions */\n\t\tvar t = nf.match(/# (\\?+)\\/(\\?+)/);\n\t\tif(t) { payload += writextag(\"number:fraction\", null, {\"number:min-integer-digits\":0, \"number:min-numerator-digits\": t[1].length, \"number:max-denominator-value\": Math.max(+(t[1].replace(/./g, \"9\")), +(t[2].replace(/./g, \"9\"))) }); break j; }\n\t\tif((t=nf.match(/# (\\?+)\\/(\\d+)/))) { payload += writextag(\"number:fraction\", null, {\"number:min-integer-digits\":0, \"number:min-numerator-digits\": t[1].length, \"number:denominator-value\": +t[2]}); break j; }\n\n\t\t/* percentages */\n\t\tif((t=nf.match(/\\b(\\d+)(|\\.\\d+)%/))) { type = \"percentage\"; payload += writextag(\"number:number\", null, {\"number:decimal-places\": t[2] && t.length - 1 || 0, \"number:min-decimal-places\": t[2] && t.length - 1 || 0, \"number:min-integer-digits\": t[1].length }) + \"<number:text>%</number:text>\"; break j; }\n\n\t\t/* datetime */\n\t\tvar has_time = false;\n\t\tif([\"y\",\"m\",\"d\"].indexOf(nf[0]) > -1) {\n\t\t\ttype = \"date\";\n\t\t\tk: for(; i < nf.length; ++i) switch((c = nf[i].toLowerCase())) {\n\t\t\t\tcase \"h\": case \"s\": has_time = true; --i; break k;\n\t\t\t\tcase \"m\":\n\t\t\t\t\tl: for(var h = i+1; h < nf.length; ++h) switch(nf[h]) {\n\t\t\t\t\t\tcase \"y\": case \"d\": break l;\n\t\t\t\t\t\tcase \"h\": case \"s\": has_time = true; --i; break k;\n\t\t\t\t\t}\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase \"y\": case \"d\":\n\t\t\t\t\twhile((nf[++i]||\"\").toLowerCase() == c[0]) c += c[0]; --i;\n\t\t\t\t\tswitch(c) {\n\t\t\t\t\t\tcase \"y\": case \"yy\": payload += \"<number:year/>\"; break;\n\t\t\t\t\t\tcase \"yyy\": case \"yyyy\": payload += '<number:year number:style=\"long\"/>'; break;\n\t\t\t\t\t\tcase \"mmmmm\": console.error(\"ODS has no equivalent of format |mmmmm|\");\n\t\t\t\t\t\t\t/* falls through */\n\t\t\t\t\t\tcase \"m\": case \"mm\": case \"mmm\": case \"mmmm\":\n\t\t\t\t\t\t\tpayload += '<number:month number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\" number:textual=\"' + (c.length >= 3 ? \"true\" : \"false\") + '\"/>';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"d\": case \"dd\": payload += '<number:day number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\"/>'; break;\n\t\t\t\t\t\tcase \"ddd\": case \"dddd\": payload += '<number:day-of-week number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\"/>'; break;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\"':\n\t\t\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\t\t\tpayload += '<number:text>' + escapexml(c.slice(1).replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\\\\': c = nf[++i];\n\t\t\t\t\tpayload += '<number:text>' + escapexml(c) + '</number:text>'; break;\n\t\t\t\tcase '/': case ':': payload += '<number:text>' + escapexml(c) + '</number:text>'; break;\n\t\t\t\tdefault: console.error(\"unrecognized character \" + c + \" in ODF format \" + nf);\n\t\t\t}\n\t\t\tif(!has_time) break j;\n\t\t\tnf = nf.slice(i+1); i = 0;\n\t\t}\n\t\tif(nf.match(/^\\[?[hms]/)) {\n\t\t\tif(type == \"number\") type = \"time\";\n\t\t\tif(nf.match(/\\[/)) {\n\t\t\t\tnf = nf.replace(/[\\[\\]]/g, \"\");\n\t\t\t\tnopts['number:truncate-on-overflow'] = \"false\";\n\t\t\t}\n\t\t\tfor(; i < nf.length; ++i) switch((c = nf[i].toLowerCase())) {\n\t\t\t\tcase \"h\": case \"m\": case \"s\":\n\t\t\t\t\twhile((nf[++i]||\"\").toLowerCase() == c[0]) c += c[0]; --i;\n\t\t\t\t\tswitch(c) {\n\t\t\t\t\t\tcase \"h\": case \"hh\": payload += '<number:hours number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\"/>'; break;\n\t\t\t\t\t\tcase \"m\": case \"mm\": payload += '<number:minutes number:style=\"' + (c.length % 2 ? \"short\" : \"long\") + '\"/>'; break;\n\t\t\t\t\t\tcase \"s\": case \"ss\":\n\t\t\t\t\t\t\tif(nf[i+1] == \".\") do { c += nf[i+1]; ++i; } while(nf[i+1] == \"0\");\n\t\t\t\t\t\t\tpayload += '<number:seconds number:style=\"' + (c.match(\"ss\") ? \"long\" : \"short\") + '\"' + (c.match(/\\./) ? ' number:decimal-places=\"' + (c.match(/0+/)||[\"\"])[0].length + '\"' : \"\")+ '/>'; break;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase '\"':\n\t\t\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\t\t\tpayload += '<number:text>' + escapexml(c.slice(1).replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t\t\t\tbreak;\n\t\t\t\tcase '/': case ':': payload += '<number:text>' + escapexml(c) + '</number:text>'; break;\n\t\t\t\tcase \"a\":\n\t\t\t\t\tif(nf.slice(i, i+3).toLowerCase() == \"a/p\") { payload += '<number:am-pm/>'; i += 2; break; } // Note: ODF does not support A/P\n\t\t\t\t\tif(nf.slice(i, i+5).toLowerCase() == \"am/pm\")  { payload += '<number:am-pm/>'; i += 4; break; }\n\t\t\t\t\t/* falls through */\n\t\t\t\tdefault: console.error(\"unrecognized character \" + c + \" in ODF format \" + nf);\n\t\t\t}\n\t\t\tbreak j;\n\t\t}\n\n\t\t/* currency flag */\n\t\tif(nf.indexOf(/\\$/) > -1) { type = \"currency\"; }\n\n\t\t/* should be in a char loop */\n\t\tif(nf[0] == \"$\") { payload += '<number:currency-symbol number:language=\"en\" number:country=\"US\">$</number:currency-symbol>'; nf = nf.slice(1); i = 0; }\n\t\ti = 0; if(nf[i] == '\"') {\n\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\tif(nf[i+1] == \"*\") {\n\t\t\t\ti++;\n\t\t\t\tpayload += '<number:fill-character>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:fill-character>';\n\t\t\t} else {\n\t\t\t\tpayload += '<number:text>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t\t}\n\t\t\tnf = nf.slice(i+1); i = 0;\n\t\t}\n\n\t\t/* number TODO: interstitial text e.g. 000)000-0000 */\n\t\tvar np = nf.match(/([#0][0#,]*)(\\.[0#]*|)(E[+]?0*|)/i);\n\t\tif(!np || !np[0]) console.error(\"Could not find numeric part of \" + nf);\n\t\telse {\n\t\t\tvar base = np[1].replace(/,/g, \"\");\n\t\t\tpayload += '<number:' + (np[3] ? \"scientific-\" : \"\")+ 'number' +\n\t\t\t\t' number:min-integer-digits=\"' + (base.indexOf(\"0\") == -1 ? \"0\" : base.length - base.indexOf(\"0\")) + '\"' +\n\t\t\t\t(np[0].indexOf(\",\") > -1 ? ' number:grouping=\"true\"' : \"\") +\n\t\t\t\t(np[2] && ' number:decimal-places=\"' + (np[2].length - 1) + '\"' || ' number:decimal-places=\"0\"') +\n\t\t\t\t(np[3] && np[3].indexOf(\"+\") > -1 ? ' number:forced-exponent-sign=\"true\"' : \"\" ) +\n\t\t\t\t(np[3] ? ' number:min-exponent-digits=\"' + np[3].match(/0+/)[0].length + '\"' : \"\" ) +\n\t\t\t\t'>' +\n\t\t\t\t/* TODO: interstitial text placeholders */\n\t\t\t\t'</number:' + (np[3] ? \"scientific-\" : \"\") + 'number>';\n\t\t\ti = np.index + np[0].length;\n\t\t}\n\n\t\t/* residual text */\n\t\tif(nf[i] == '\"') {\n\t\t\tc = \"\";\n\t\t\twhile(nf[++i] != '\"' || nf[++i] == '\"') c += nf[i]; --i;\n\t\t\tpayload += '<number:text>' + escapexml(c.replace(/\"\"/g, '\"')) + '</number:text>';\n\t\t}\n\t}\n\n\tif(!payload) { console.error(\"Could not generate ODS number format for |\" + nf + \"|\"); return \"\"; }\n\treturn writextag(\"number:\" + type + \"-style\", payload, nopts);\n}\n\nfunction write_names_ods(Names, SheetNames, idx) {\n\t//var scoped = Names.filter(function(name) { return name.Sheet == (idx == -1 ? null : idx); });\n\tvar scoped = []; for(var namei = 0; namei < Names.length; ++namei) {\n\t\tvar name = Names[namei];\n\t\tif(!name) continue;\n\t\tif(name.Sheet == (idx == -1 ? null : idx)) scoped.push(name);\n\t}\n\tif(!scoped.length) return \"\";\n\treturn \"      <table:named-expressions>\\n\" + scoped.map(function(name) {\n\t\tvar odsref =  (idx == -1 ? \"$\" : \"\") + csf_to_ods_3D(name.Ref);\n\t\treturn \"        \" + writextag(\"table:named-range\", null, {\n\t\t\t\"table:name\": name.Name,\n\t\t\t\"table:cell-range-address\": odsref,\n\t\t\t\"table:base-cell-address\": odsref.replace(/[\\.][^\\.]*$/, \".$A$1\")\n\t\t});\n\t}).join(\"\\n\") + \"\\n      </table:named-expressions>\\n\";\n}\nvar write_content_ods/*:{(wb:any, opts:any):string}*/ = /* @__PURE__ */(function() {\n\t/* 6.1.2 White Space Characters */\n\tvar write_text_p = function(text/*:string*/, span)/*:string*/ {\n\t\treturn escapexml(text)\n\t\t\t.replace(/  +/g, function($$){return '<text:s text:c=\"'+$$.length+'\"/>';})\n\t\t\t.replace(/\\t/g, \"<text:tab/>\")\n\t\t\t.replace(/\\n/g, span ? \"<text:line-break/>\": \"</text:p><text:p>\")\n\t\t\t.replace(/^ /, \"<text:s/>\").replace(/ $/, \"<text:s/>\");\n\t};\n\n\tvar null_cell_xml = '          <table:table-cell />\\n';\n\tvar write_ws = function(ws, wb/*:Workbook*/, i/*:number*/, opts, nfs, date1904)/*:string*/ {\n\t\t/* Section 9 Tables */\n\t\tvar o/*:Array<string>*/ = [];\n\t\to.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\" table:style-name=\"ta1\">\\n');\n\t\tvar R=0,C=0, range = decode_range(ws['!ref']||\"A1\");\n\t\tvar marr/*:Array<Range>*/ = ws['!merges'] || [], mi = 0;\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tif(ws[\"!cols\"]) {\n\t\t\tfor(C = 0; C <= range.e.c; ++C) o.push('        <table:table-column' + (ws[\"!cols\"][C] ? ' table:style-name=\"co' + ws[\"!cols\"][C].ods + '\"' : '') + '></table:table-column>\\n');\n\t\t}\n\t\tvar H = \"\", ROWS = ws[\"!rows\"]||[];\n\t\tfor(R = 0; R < range.s.r; ++R) {\n\t\t\tH = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n\t\t\to.push('        <table:table-row' + H + '></table:table-row>\\n');\n\t\t}\n\t\tfor(; R <= range.e.r; ++R) {\n\t\t\tH = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n\t\t\to.push('        <table:table-row' + H + '>\\n');\n\t\t\tfor(C=0; C < range.s.c; ++C) o.push(null_cell_xml);\n\t\t\tfor(; C <= range.e.c; ++C) {\n\t\t\t\tvar skip = false, ct = {}, textp = \"\";\n\t\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\t\tct['table:number-columns-spanned'] = (marr[mi].e.c - marr[mi].s.c + 1);\n\t\t\t\t\tct['table:number-rows-spanned'] =    (marr[mi].e.r - marr[mi].s.r + 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(skip) { o.push('          <table:covered-table-cell/>\\n'); continue; }\n\t\t\t\tvar ref = encode_cell({r:R, c:C}), cell = dense ? (ws[\"!data\"][R]||[])[C]: ws[ref];\n\t\t\t\tif(cell && cell.f) {\n\t\t\t\t\tct['table:formula'] = escapexml(csf_to_ods_formula(cell.f));\n\t\t\t\t\tif(cell.F) {\n\t\t\t\t\t\tif(cell.F.slice(0, ref.length) == ref) {\n\t\t\t\t\t\t\tvar _Fref = decode_range(cell.F);\n\t\t\t\t\t\t\tct['table:number-matrix-columns-spanned'] = (_Fref.e.c - _Fref.s.c + 1);\n\t\t\t\t\t\t\tct['table:number-matrix-rows-spanned'] =    (_Fref.e.r - _Fref.s.r + 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!cell) { o.push(null_cell_xml); continue; }\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\ttextp = (cell.v ? 'TRUE' : 'FALSE');\n\t\t\t\t\t\tct['office:value-type'] = \"boolean\";\n\t\t\t\t\t\tct['office:boolean-value'] = (cell.v ? 'true' : 'false');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\tif(!isFinite(cell.v)) {\n\t\t\t\t\t\t\tif(isNaN(cell.v)) {\n\t\t\t\t\t\t\t\ttextp = \"#NUM!\";\n\t\t\t\t\t\t\t\tct['table:formula'] = \"of:=#NUM!\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttextp = \"#DIV/0!\";\n\t\t\t\t\t\t\t\tct['table:formula'] = \"of:=\" + (cell.v < 0 ? \"-\" : \"\") + \"1/0\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tct['office:string-value'] = \"\";\n\t\t\t\t\t\t\tct['office:value-type'] = \"string\";\n\t\t\t\t\t\t\tct['calcext:value-type'] = \"error\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttextp = (cell.w||String(cell.v||0));\n\t\t\t\t\t\t\tct['office:value-type'] = \"float\";\n\t\t\t\t\t\t\tct['office:value'] = (cell.v||0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 's': case 'str':\n\t\t\t\t\t\ttextp = cell.v == null ? \"\" : cell.v;\n\t\t\t\t\t\tct['office:value-type'] = \"string\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\ttextp = (cell.w||(parseDate(cell.v, date1904).toISOString()));\n\t\t\t\t\t\tct['office:value-type'] = \"date\";\n\t\t\t\t\t\tct['office:date-value'] = (parseDate(cell.v, date1904).toISOString());\n\t\t\t\t\t\tct['table:style-name'] = \"ce1\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t//case 'e': // TODO: translate to ODS errors\n\t\t\t\t\tdefault: o.push(null_cell_xml); continue; // TODO: empty cell with comments\n\t\t\t\t}\n\t\t\t\tvar text_p = write_text_p(textp);\n\t\t\t\tif(cell.l && cell.l.Target) {\n\t\t\t\t\tvar _tgt = cell.l.Target;\n\t\t\t\t\t_tgt = _tgt.charAt(0) == \"#\" ? \"#\" + csf_to_ods_3D(_tgt.slice(1)) : _tgt;\n\t\t\t\t\t// TODO: choose correct parent path format based on link delimiters\n\t\t\t\t\tif(_tgt.charAt(0) != \"#\" && !_tgt.match(/^\\w+:/)) _tgt = '../' + _tgt;\n\t\t\t\t\ttext_p = writextag('text:a', text_p, {'xlink:href': _tgt.replace(/&/g, \"&amp;\")});\n\t\t\t\t}\n\t\t\t\tif(nfs[cell.z]) ct[\"table:style-name\"] = \"ce\" + nfs[cell.z].slice(1);\n\t\t\t\tvar payload = writextag('text:p', text_p, {});\n\t\t\t\tif(cell.c) {\n\t\t\t\t\tvar acreator = \"\", apayload = \"\", aprops = {};\n\t\t\t\t\tfor(var ci = 0; ci < cell.c.length; ++ci) {\n\t\t\t\t\t\tif(!acreator && cell.c[ci].a) acreator = cell.c[ci].a;\n\t\t\t\t\t\tapayload += \"<text:p>\" + write_text_p(cell.c[ci].t) + \"</text:p>\";\n\t\t\t\t\t}\n\t\t\t\t\tif(!cell.c.hidden) aprops[\"office:display\"] = true;\n\t\t\t\t\tpayload = writextag('office:annotation', apayload, aprops) + payload;\n\t\t\t\t}\n\t\t\t\to.push('          ' + writextag('table:table-cell', payload, ct) + '\\n');\n\t\t\t}\n\t\t\to.push('        </table:table-row>\\n');\n\t\t}\n\t\tif((wb.Workbook||{}).Names) o.push(write_names_ods(wb.Workbook.Names, wb.SheetNames, i));\n\t\to.push('      </table:table>\\n');\n\t\treturn o.join(\"\");\n\t};\n\n\tvar write_automatic_styles_ods = function(o/*:Array<string>*/, wb) {\n\t\to.push(' <office:automatic-styles>\\n');\n\n\t\t/* column styles */\n\t\tvar cidx = 0;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tif(ws[\"!cols\"]) {\n\t\t\t\tfor(var C = 0; C < ws[\"!cols\"].length; ++C) if(ws[\"!cols\"][C]) {\n\t\t\t\t\tvar colobj = ws[\"!cols\"][C];\n\t\t\t\t\tif(colobj.width == null && colobj.wpx == null && colobj.wch == null) continue;\n\t\t\t\t\tprocess_col(colobj);\n\t\t\t\t\tcolobj.ods = cidx;\n\t\t\t\t\tvar w = ws[\"!cols\"][C].wpx + \"px\";\n\t\t\t\t\to.push('  <style:style style:name=\"co' + cidx + '\" style:family=\"table-column\">\\n');\n\t\t\t\t\to.push('   <style:table-column-properties fo:break-before=\"auto\" style:column-width=\"' + w + '\"/>\\n');\n\t\t\t\t\to.push('  </style:style>\\n');\n\t\t\t\t\t++cidx;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t/* row styles */\n\t\tvar ridx = 0;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tif(ws[\"!rows\"]) {\n\t\t\t\tfor(var R = 0; R < ws[\"!rows\"].length; ++R) if(ws[\"!rows\"][R]) {\n\t\t\t\t\tws[\"!rows\"][R].ods = ridx;\n\t\t\t\t\tvar h = ws[\"!rows\"][R].hpx + \"px\";\n\t\t\t\t\to.push('  <style:style style:name=\"ro' + ridx + '\" style:family=\"table-row\">\\n');\n\t\t\t\t\to.push('   <style:table-row-properties fo:break-before=\"auto\" style:row-height=\"' + h + '\"/>\\n');\n\t\t\t\t\to.push('  </style:style>\\n');\n\t\t\t\t\t++ridx;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t/* table */\n\t\to.push('  <style:style style:name=\"ta1\" style:family=\"table\" style:master-page-name=\"mp1\">\\n');\n\t\to.push('   <style:table-properties table:display=\"true\" style:writing-mode=\"lr-tb\"/>\\n');\n\t\to.push('  </style:style>\\n');\n\n\t\to.push('  <number:date-style style:name=\"N37\" number:automatic-order=\"true\">\\n');\n\t\to.push('   <number:month number:style=\"long\"/>\\n');\n\t\to.push('   <number:text>/</number:text>\\n');\n\t\to.push('   <number:day number:style=\"long\"/>\\n');\n\t\to.push('   <number:text>/</number:text>\\n');\n\t\to.push('   <number:year/>\\n');\n\t\to.push('  </number:date-style>\\n');\n\n\t\t/* number formats, table cells, text */\n\t\tvar nfs = {};\n\t\tvar nfi = 69;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tvar dense = (ws[\"!data\"] != null);\n\t\t\tif(!ws[\"!ref\"]) return;\n\t\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\t\tfor(var R = 0; R <= range.e.r; ++R) for(var C = 0; C <= range.e.c; ++C) {\n\t\t\t\tvar c = dense ? (ws[\"!data\"][R]||[])[C] : ws[encode_cell({r:R,c:C})];\n\t\t\t\tif(!c || !c.z || c.z.toLowerCase() == \"general\") continue;\n\t\t\t\tif(!nfs[c.z]) {\n\t\t\t\t\tvar out = write_number_format_ods(c.z, \"N\" + nfi);\n\t\t\t\t\tif(out) { nfs[c.z] = \"N\" + nfi; ++nfi; o.push(out + \"\\n\"); }\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\to.push('  <style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N37\"/>\\n');\n\t\tkeys(nfs).forEach(function(nf) {\n\t\t\to.push('<style:style style:name=\"ce' + nfs[nf].slice(1) + '\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"' + nfs[nf] + '\"/>\\n');\n\t\t});\n\n\t\t/* page-layout */\n\n\t\to.push(' </office:automatic-styles>\\n');\n\t\treturn nfs;\n\t};\n\n\treturn function wcx(wb, opts) {\n\t\tvar o = [XML_HEADER];\n\t\t/* 3.1.3.2 */\n\t\tvar attr = wxt_helper({\n\t\t\t'xmlns:office':       \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n\t\t\t'xmlns:table':        \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n\t\t\t'xmlns:style':        \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n\t\t\t'xmlns:text':         \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n\t\t\t'xmlns:draw':         \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n\t\t\t'xmlns:fo':           \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n\t\t\t'xmlns:xlink':        \"http://www.w3.org/1999/xlink\",\n\t\t\t'xmlns:dc':           \"http://purl.org/dc/elements/1.1/\",\n\t\t\t'xmlns:meta':         \"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\",\n\t\t\t'xmlns:number':       \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n\t\t\t'xmlns:presentation': \"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\",\n\t\t\t'xmlns:svg':          \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n\t\t\t'xmlns:chart':        \"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\",\n\t\t\t'xmlns:dr3d':         \"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\",\n\t\t\t'xmlns:math':         \"http://www.w3.org/1998/Math/MathML\",\n\t\t\t'xmlns:form':         \"urn:oasis:names:tc:opendocument:xmlns:form:1.0\",\n\t\t\t'xmlns:script':       \"urn:oasis:names:tc:opendocument:xmlns:script:1.0\",\n\t\t\t'xmlns:ooo':          \"http://openoffice.org/2004/office\",\n\t\t\t'xmlns:ooow':         \"http://openoffice.org/2004/writer\",\n\t\t\t'xmlns:oooc':         \"http://openoffice.org/2004/calc\",\n\t\t\t'xmlns:dom':          \"http://www.w3.org/2001/xml-events\",\n\t\t\t'xmlns:xforms':       \"http://www.w3.org/2002/xforms\",\n\t\t\t'xmlns:xsd':          \"http://www.w3.org/2001/XMLSchema\",\n\t\t\t'xmlns:xsi':          \"http://www.w3.org/2001/XMLSchema-instance\",\n\t\t\t'xmlns:sheet':        \"urn:oasis:names:tc:opendocument:sh33tjs:1.0\",\n\t\t\t'xmlns:rpt':          \"http://openoffice.org/2005/report\",\n\t\t\t'xmlns:of':           \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n\t\t\t'xmlns:xhtml':        \"http://www.w3.org/1999/xhtml\",\n\t\t\t'xmlns:grddl':        \"http://www.w3.org/2003/g/data-view#\",\n\t\t\t'xmlns:tableooo':     \"http://openoffice.org/2009/table\",\n\t\t\t'xmlns:drawooo':      \"http://openoffice.org/2010/draw\",\n\t\t\t'xmlns:calcext':      \"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\",\n\t\t\t'xmlns:loext':        \"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\",\n\t\t\t'xmlns:field':        \"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\",\n\t\t\t'xmlns:formx':        \"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\",\n\t\t\t'xmlns:css3t':        \"http://www.w3.org/TR/css3-text/\",\n\t\t\t'office:version':     \"1.2\"\n\t\t});\n\n\t\tvar fods = wxt_helper({\n\t\t\t'xmlns:config':    \"urn:oasis:names:tc:opendocument:xmlns:config:1.0\",\n\t\t\t'office:mimetype': \"application/vnd.oasis.opendocument.spreadsheet\"\n\t\t});\n\n\t\tif(opts.bookType == \"fods\") {\n\t\t\to.push('<office:document' + attr + fods + '>\\n');\n\t\t\to.push(write_meta_ods().replace(/<office:document-meta[^<>]*?>/, \"\").replace(/<\\/office:document-meta>/, \"\") + \"\\n\");\n\t\t\t// TODO: settings (equiv of settings.xml for ODS)\n\t\t} else o.push('<office:document-content' + attr  + '>\\n');\n\t\t// o.push('  <office:scripts/>\\n');\n\t\tvar nfs = write_automatic_styles_ods(o, wb);\n\t\to.push('  <office:body>\\n');\n\t\to.push('    <office:spreadsheet>\\n');\n\t\tif(((wb.Workbook||{}).WBProps||{}).date1904) o.push('      <table:calculation-settings table:case-sensitive=\"false\" table:search-criteria-must-apply-to-whole-cell=\"true\" table:use-wildcards=\"true\" table:use-regular-expressions=\"false\" table:automatic-find-labels=\"false\">\\n        <table:null-date table:date-value=\"1904-01-01\"/>\\n      </table:calculation-settings>\\n');\n\t\tfor(var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts, nfs, ((wb.Workbook||{}).WBProps||{}).date1904));\n\t\tif((wb.Workbook||{}).Names) o.push(write_names_ods(wb.Workbook.Names, wb.SheetNames, -1));\n\t\to.push('    </office:spreadsheet>\\n');\n\t\to.push('  </office:body>\\n');\n\t\tif(opts.bookType == \"fods\") o.push('</office:document>');\n\t\telse o.push('</office:document-content>');\n\t\treturn o.join(\"\");\n\t};\n})();\n\nfunction write_ods(wb/*:any*/, opts/*:any*/) {\n\tif(opts.bookType == \"fods\") return write_content_ods(wb, opts);\n\n\tvar zip = zip_new();\n\tvar f = \"\";\n\n\tvar manifest/*:Array<Array<string> >*/ = [];\n\tvar rdf/*:Array<[string, string]>*/ = [];\n\n\t/* Part 3 Section 3.3 MIME Media Type */\n\tf = \"mimetype\";\n\tzip_add_file(zip, f, \"application/vnd.oasis.opendocument.spreadsheet\");\n\n\t/* Part 1 Section 2.2 Documents */\n\tf = \"content.xml\";\n\tzip_add_file(zip, f, write_content_ods(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"ContentFile\"]);\n\n\t/* TODO: these are hard-coded styles to satiate excel */\n\tf = \"styles.xml\";\n\tzip_add_file(zip, f, write_styles_ods(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"StylesFile\"]);\n\n\t/* TODO: this is hard-coded to satiate excel */\n\tf = \"meta.xml\";\n\tzip_add_file(zip, f, XML_HEADER + write_meta_ods(/*::wb, opts*/));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"MetadataFile\"]);\n\n\t/* Part 3 Section 6 Metadata Manifest File */\n\tf = \"manifest.rdf\";\n\tzip_add_file(zip, f, write_rdf(rdf/*, opts*/));\n\tmanifest.push([f, \"application/rdf+xml\"]);\n\n\t/* Part 3 Section 4 Manifest File */\n\tf = \"META-INF/manifest.xml\";\n\tzip_add_file(zip, f, write_manifest(manifest/*, opts*/));\n\n\treturn zip;\n}\n\n/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */\nvar subarray = function() {\n  try {\n    if (typeof Uint8Array == \"undefined\")\n      return \"slice\";\n    if (typeof Uint8Array.prototype.subarray == \"undefined\")\n      return \"slice\";\n    if (typeof Buffer !== \"undefined\") {\n      if (typeof Buffer.prototype.subarray == \"undefined\")\n        return \"slice\";\n      if ((typeof Buffer.from == \"function\" ? Buffer.from([72, 62]) : new Buffer([72, 62])) instanceof Uint8Array)\n        return \"subarray\";\n      return \"slice\";\n    }\n    return \"subarray\";\n  } catch (e) {\n    return \"slice\";\n  }\n}();\nfunction u8_to_dataview(array) {\n  return new DataView(array.buffer, array.byteOffset, array.byteLength);\n}\nfunction u8str(u8) {\n  return typeof TextDecoder != \"undefined\" ? new TextDecoder().decode(u8) : utf8read(a2s(u8));\n}\nfunction stru8(str) {\n  return typeof TextEncoder != \"undefined\" ? new TextEncoder().encode(str) : s2a(utf8write(str));\n}\nfunction u8concat(u8a) {\n  var len = 0;\n  for (var i = 0; i < u8a.length; ++i)\n    len += u8a[i].length;\n  var out = new Uint8Array(len);\n  var off = 0;\n  for (i = 0; i < u8a.length; ++i) {\n    var u8 = u8a[i], L = u8.length;\n    if (L < 250) {\n      for (var j = 0; j < L; ++j)\n        out[off++] = u8[j];\n    } else {\n      out.set(u8, off);\n      off += L;\n    }\n  }\n  return out;\n}\nfunction popcnt(x) {\n  x -= x >> 1 & 1431655765;\n  x = (x & 858993459) + (x >> 2 & 858993459);\n  return (x + (x >> 4) & 252645135) * 16843009 >>> 24;\n}\nfunction readDecimal128LE(buf, offset) {\n  var exp = (buf[offset + 15] & 127) << 7 | buf[offset + 14] >> 1;\n  var mantissa = buf[offset + 14] & 1;\n  for (var j = offset + 13; j >= offset; --j)\n    mantissa = mantissa * 256 + buf[j];\n  return (buf[offset + 15] & 128 ? -mantissa : mantissa) * Math.pow(10, exp - 6176);\n}\nfunction writeDecimal128LE(buf, offset, value) {\n  var exp = Math.floor(value == 0 ? 0 : Math.LOG10E * Math.log(Math.abs(value))) + 6176 - 16;\n  var mantissa = value / Math.pow(10, exp - 6176);\n  buf[offset + 15] |= exp >> 7;\n  buf[offset + 14] |= (exp & 127) << 1;\n  for (var i = 0; mantissa >= 1; ++i, mantissa /= 256)\n    buf[offset + i] = mantissa & 255;\n  buf[offset + 15] |= value >= 0 ? 0 : 128;\n}\nfunction parse_varint49(buf, ptr) {\n  var l = ptr.l;\n  var usz = buf[l] & 127;\n  varint:\n    if (buf[l++] >= 128) {\n      usz |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128)\n        break varint;\n      usz |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128)\n        break varint;\n      usz |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 28);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 35);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 42);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n    }\n  ptr.l = l;\n  return usz;\n}\nfunction write_varint49(v) {\n  var usz = new Uint8Array(7);\n  usz[0] = v & 127;\n  var L = 1;\n  sz:\n    if (v > 127) {\n      usz[L - 1] |= 128;\n      usz[L] = v >> 7 & 127;\n      ++L;\n      if (v <= 16383)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 14 & 127;\n      ++L;\n      if (v <= 2097151)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 21 & 127;\n      ++L;\n      if (v <= 268435455)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 256 >>> 21 & 127;\n      ++L;\n      if (v <= 34359738367)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 65536 >>> 21 & 127;\n      ++L;\n      if (v <= 4398046511103)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 16777216 >>> 21 & 127;\n      ++L;\n    }\n  return usz[subarray](0, L);\n}\nfunction parse_packed_varints(buf) {\n  var ptr = { l: 0 };\n  var out = [];\n  while (ptr.l < buf.length)\n    out.push(parse_varint49(buf, ptr));\n  return out;\n}\nfunction write_packed_varints(nums) {\n  return u8concat(nums.map(function(x) {\n    return write_varint49(x);\n  }));\n}\nfunction varint_to_i32(buf) {\n  var l = 0, i32 = buf[l] & 127;\n  if (buf[l++] < 128)\n    return i32;\n  i32 |= (buf[l] & 127) << 7;\n  if (buf[l++] < 128)\n    return i32;\n  i32 |= (buf[l] & 127) << 14;\n  if (buf[l++] < 128)\n    return i32;\n  i32 |= (buf[l] & 127) << 21;\n  if (buf[l++] < 128)\n    return i32;\n  i32 |= (buf[l] & 15) << 28;\n  return i32;\n}\nfunction varint_to_u64(buf) {\n  var l = 0, lo = buf[l] & 127, hi = 0;\n  varint:\n    if (buf[l++] >= 128) {\n      lo |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128)\n        break varint;\n      lo |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128)\n        break varint;\n      lo |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128)\n        break varint;\n      lo |= (buf[l] & 127) << 28;\n      hi = buf[l] >> 4 & 7;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 3;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 10;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 17;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 24;\n      if (buf[l++] < 128)\n        break varint;\n      hi |= (buf[l] & 127) << 31;\n    }\n  return [lo >>> 0, hi >>> 0];\n}\nfunction parse_shallow(buf) {\n  var out = [], ptr = { l: 0 };\n  while (ptr.l < buf.length) {\n    var off = ptr.l;\n    var num = parse_varint49(buf, ptr);\n    var type = num & 7;\n    num = num / 8 | 0;\n    var data;\n    var l = ptr.l;\n    switch (type) {\n      case 0:\n        {\n          while (buf[l++] >= 128)\n            ;\n          data = buf[subarray](ptr.l, l);\n          ptr.l = l;\n        }\n        break;\n      case 1:\n        {\n          data = buf[subarray](l, l + 8);\n          ptr.l = l + 8;\n        }\n        break;\n      case 2:\n        {\n          var len = parse_varint49(buf, ptr);\n          data = buf[subarray](ptr.l, ptr.l + len);\n          ptr.l += len;\n        }\n        break;\n      case 5:\n        {\n          data = buf[subarray](l, l + 4);\n          ptr.l = l + 4;\n        }\n        break;\n      default:\n        throw new Error(\"PB Type \".concat(type, \" for Field \").concat(num, \" at offset \").concat(off));\n    }\n    var v = { data: data, type: type };\n    if (out[num] == null)\n      out[num] = [];\n    out[num].push(v);\n  }\n  return out;\n}\nfunction write_shallow(proto) {\n  var out = [];\n  proto.forEach(function(field, idx) {\n    if (idx == 0)\n      return;\n    field.forEach(function(item) {\n      if (!item.data)\n        return;\n      out.push(write_varint49(idx * 8 + item.type));\n      if (item.type == 2)\n        out.push(write_varint49(item.data.length));\n      out.push(item.data);\n    });\n  });\n  return u8concat(out);\n}\nfunction mappa(data, cb) {\n  return (data == null ? void 0 : data.map(function(d) {\n    return cb(d.data);\n  })) || [];\n}\nfunction parse_iwa_file(buf) {\n  var _a;\n  var out = [], ptr = { l: 0 };\n  while (ptr.l < buf.length) {\n    var len = parse_varint49(buf, ptr);\n    var ai = parse_shallow(buf[subarray](ptr.l, ptr.l + len));\n    ptr.l += len;\n    var res = {\n      id: varint_to_i32(ai[1][0].data),\n      messages: []\n    };\n    ai[2].forEach(function(b) {\n      var mi = parse_shallow(b.data);\n      var fl = varint_to_i32(mi[3][0].data);\n      res.messages.push({\n        meta: mi,\n        data: buf[subarray](ptr.l, ptr.l + fl)\n      });\n      ptr.l += fl;\n    });\n    if ((_a = ai[3]) == null ? void 0 : _a[0])\n      res.merge = varint_to_i32(ai[3][0].data) >>> 0 > 0;\n    out.push(res);\n  }\n  return out;\n}\nfunction write_iwa_file(ias) {\n  var bufs = [];\n  ias.forEach(function(ia) {\n    var ai = [\n      [],\n      [{ data: write_varint49(ia.id), type: 0 }],\n      []\n    ];\n    if (ia.merge != null)\n      ai[3] = [{ data: write_varint49(+!!ia.merge), type: 0 }];\n    var midata = [];\n    ia.messages.forEach(function(mi) {\n      midata.push(mi.data);\n      mi.meta[3] = [{ type: 0, data: write_varint49(mi.data.length) }];\n      ai[2].push({ data: write_shallow(mi.meta), type: 2 });\n    });\n    var aipayload = write_shallow(ai);\n    bufs.push(write_varint49(aipayload.length));\n    bufs.push(aipayload);\n    midata.forEach(function(mid) {\n      return bufs.push(mid);\n    });\n  });\n  return u8concat(bufs);\n}\nfunction parse_snappy_chunk(type, buf) {\n  if (type != 0)\n    throw new Error(\"Unexpected Snappy chunk type \".concat(type));\n  var ptr = { l: 0 };\n  var usz = parse_varint49(buf, ptr);\n  var chunks = [];\n  var l = ptr.l;\n  while (l < buf.length) {\n    var tag = buf[l] & 3;\n    if (tag == 0) {\n      var len = buf[l++] >> 2;\n      if (len < 60)\n        ++len;\n      else {\n        var c = len - 59;\n        len = buf[l];\n        if (c > 1)\n          len |= buf[l + 1] << 8;\n        if (c > 2)\n          len |= buf[l + 2] << 16;\n        if (c > 3)\n          len |= buf[l + 3] << 24;\n        len >>>= 0;\n        len++;\n        l += c;\n      }\n      chunks.push(buf[subarray](l, l + len));\n      l += len;\n      continue;\n    } else {\n      var offset = 0, length = 0;\n      if (tag == 1) {\n        length = (buf[l] >> 2 & 7) + 4;\n        offset = (buf[l++] & 224) << 3;\n        offset |= buf[l++];\n      } else {\n        length = (buf[l++] >> 2) + 1;\n        if (tag == 2) {\n          offset = buf[l] | buf[l + 1] << 8;\n          l += 2;\n        } else {\n          offset = (buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16 | buf[l + 3] << 24) >>> 0;\n          l += 4;\n        }\n      }\n      if (offset == 0)\n        throw new Error(\"Invalid offset 0\");\n      var j = chunks.length - 1, off = offset;\n      while (j >= 0 && off >= chunks[j].length) {\n        off -= chunks[j].length;\n        --j;\n      }\n      if (j < 0) {\n        if (off == 0)\n          off = chunks[j = 0].length;\n        else\n          throw new Error(\"Invalid offset beyond length\");\n      }\n      if (length < off)\n        chunks.push(chunks[j][subarray](chunks[j].length - off, chunks[j].length - off + length));\n      else {\n        if (off > 0) {\n          chunks.push(chunks[j][subarray](chunks[j].length - off));\n          length -= off;\n        }\n        ++j;\n        while (length >= chunks[j].length) {\n          chunks.push(chunks[j]);\n          length -= chunks[j].length;\n          ++j;\n        }\n        if (length)\n          chunks.push(chunks[j][subarray](0, length));\n      }\n      if (chunks.length > 25)\n        chunks = [u8concat(chunks)];\n    }\n  }\n  var clen = 0;\n  for (var u8i = 0; u8i < chunks.length; ++u8i)\n    clen += chunks[u8i].length;\n  if (clen != usz)\n    throw new Error(\"Unexpected length: \".concat(clen, \" != \").concat(usz));\n  return chunks;\n}\nfunction decompress_iwa_file(buf) {\n  if (Array.isArray(buf))\n    buf = new Uint8Array(buf);\n  var out = [];\n  var l = 0;\n  while (l < buf.length) {\n    var t = buf[l++];\n    var len = buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16;\n    l += 3;\n    out.push.apply(out, parse_snappy_chunk(t, buf[subarray](l, l + len)));\n    l += len;\n  }\n  if (l !== buf.length)\n    throw new Error(\"data is not a valid framed stream!\");\n  return out.length == 1 ? out[0] : u8concat(out);\n}\nfunction compress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n  while (l < buf.length) {\n    var c = Math.min(buf.length - l, 268435455);\n    var frame = new Uint8Array(4);\n    out.push(frame);\n    var usz = write_varint49(c);\n    var L = usz.length;\n    out.push(usz);\n    if (c <= 60) {\n      L++;\n      out.push(new Uint8Array([c - 1 << 2]));\n    } else if (c <= 256) {\n      L += 2;\n      out.push(new Uint8Array([240, c - 1 & 255]));\n    } else if (c <= 65536) {\n      L += 3;\n      out.push(new Uint8Array([244, c - 1 & 255, c - 1 >> 8 & 255]));\n    } else if (c <= 16777216) {\n      L += 4;\n      out.push(new Uint8Array([248, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255]));\n    } else if (c <= 4294967296) {\n      L += 5;\n      out.push(new Uint8Array([252, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255, c - 1 >>> 24 & 255]));\n    }\n    out.push(buf[subarray](l, l + c));\n    L += c;\n    frame[0] = 0;\n    frame[1] = L & 255;\n    frame[2] = L >> 8 & 255;\n    frame[3] = L >> 16 & 255;\n    l += c;\n  }\n  return u8concat(out);\n}\nvar numbers_lut_new = function() {\n  return { sst: [], rsst: [], ofmt: [], nfmt: [], fmla: [], ferr: [], cmnt: [] };\n};\nfunction numbers_format_cell(cell, t, flags, ofmt, nfmt) {\n  var _a, _b, _c, _d;\n  var ctype = t & 255, ver = t >> 8;\n  var fmt = ver >= 5 ? nfmt : ofmt;\n  dur:\n    if (flags & (ver > 4 ? 8 : 4) && cell.t == \"n\" && ctype == 7) {\n      var dstyle = ((_a = fmt[7]) == null ? void 0 : _a[0]) ? varint_to_i32(fmt[7][0].data) : -1;\n      if (dstyle == -1)\n        break dur;\n      var dmin = ((_b = fmt[15]) == null ? void 0 : _b[0]) ? varint_to_i32(fmt[15][0].data) : -1;\n      var dmax = ((_c = fmt[16]) == null ? void 0 : _c[0]) ? varint_to_i32(fmt[16][0].data) : -1;\n      var auto = ((_d = fmt[40]) == null ? void 0 : _d[0]) ? varint_to_i32(fmt[40][0].data) : -1;\n      var d = cell.v, dd = d;\n      autodur:\n        if (auto) {\n          if (d == 0) {\n            dmin = dmax = 2;\n            break autodur;\n          }\n          if (d >= 604800)\n            dmin = 1;\n          else if (d >= 86400)\n            dmin = 2;\n          else if (d >= 3600)\n            dmin = 4;\n          else if (d >= 60)\n            dmin = 8;\n          else if (d >= 1)\n            dmin = 16;\n          else\n            dmin = 32;\n          if (Math.floor(d) != d)\n            dmax = 32;\n          else if (d % 60)\n            dmax = 16;\n          else if (d % 3600)\n            dmax = 8;\n          else if (d % 86400)\n            dmax = 4;\n          else if (d % 604800)\n            dmax = 2;\n          if (dmax < dmin)\n            dmax = dmin;\n        }\n      if (dmin == -1 || dmax == -1)\n        break dur;\n      var dstr = [], zstr = [];\n      if (dmin == 1) {\n        dd = d / 604800;\n        if (dmax == 1) {\n          zstr.push('d\"d\"');\n        } else {\n          dd |= 0;\n          d -= 604800 * dd;\n        }\n        dstr.push(dd + (dstyle == 2 ? \" week\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"w\" : \"\"));\n      }\n      if (dmin <= 2 && dmax >= 2) {\n        dd = d / 86400;\n        if (dmax > 2) {\n          dd |= 0;\n          d -= 86400 * dd;\n        }\n        zstr.push('d\"d\"');\n        dstr.push(dd + (dstyle == 2 ? \" day\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"d\" : \"\"));\n      }\n      if (dmin <= 4 && dmax >= 4) {\n        dd = d / 3600;\n        if (dmax > 4) {\n          dd |= 0;\n          d -= 3600 * dd;\n        }\n        zstr.push((dmin >= 4 ? \"[h]\" : \"h\") + '\"h\"');\n        dstr.push(dd + (dstyle == 2 ? \" hour\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"h\" : \"\"));\n      }\n      if (dmin <= 8 && dmax >= 8) {\n        dd = d / 60;\n        if (dmax > 8) {\n          dd |= 0;\n          d -= 60 * dd;\n        }\n        zstr.push((dmin >= 8 ? \"[m]\" : \"m\") + '\"m\"');\n        if (dstyle == 0)\n          dstr.push((dmin == 8 && dmax == 8 || dd >= 10 ? \"\" : \"0\") + dd);\n        else\n          dstr.push(dd + (dstyle == 2 ? \" minute\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"m\" : \"\"));\n      }\n      if (dmin <= 16 && dmax >= 16) {\n        dd = d;\n        if (dmax > 16) {\n          dd |= 0;\n          d -= dd;\n        }\n        zstr.push((dmin >= 16 ? \"[s]\" : \"s\") + '\"s\"');\n        if (dstyle == 0)\n          dstr.push((dmax == 16 && dmin == 16 || dd >= 10 ? \"\" : \"0\") + dd);\n        else\n          dstr.push(dd + (dstyle == 2 ? \" second\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"s\" : \"\"));\n      }\n      if (dmax >= 32) {\n        dd = Math.round(1e3 * d);\n        if (dmin < 32)\n          zstr.push('.000\"ms\"');\n        if (dstyle == 0)\n          dstr.push((dd >= 100 ? \"\" : dd >= 10 ? \"0\" : \"00\") + dd);\n        else\n          dstr.push(dd + (dstyle == 2 ? \" millisecond\" + (dd == 1 ? \"\" : \"s\") : dstyle == 1 ? \"ms\" : \"\"));\n      }\n      cell.w = dstr.join(dstyle == 0 ? \":\" : \" \");\n      cell.z = zstr.join(dstyle == 0 ? '\":\"' : \" \");\n      if (dstyle == 0)\n        cell.w = cell.w.replace(/:(\\d\\d\\d)$/, \".$1\");\n    }\n}\nfunction parse_old_storage(buf, lut, v, opts) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(4, true);\n  var ridx = -1, sidx = -1, zidx = -1, ieee = NaN, dc = 0, dt = new Date(Date.UTC(2001, 0, 1));\n  var doff = v > 1 ? 12 : 8;\n  if (flags & 2) {\n    zidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  doff += popcnt(flags & (v > 1 ? 3468 : 396)) * 4;\n  if (flags & 512) {\n    ridx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  doff += popcnt(flags & (v > 1 ? 12288 : 4096)) * 4;\n  if (flags & 16) {\n    sidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  if (flags & 32) {\n    ieee = dv.getFloat64(doff, true);\n    doff += 8;\n  }\n  if (flags & 64) {\n    dt.setTime(dt.getTime() + (dc = dv.getFloat64(doff, true)) * 1e3);\n    doff += 8;\n  }\n  if (v > 1) {\n    flags = dv.getUint32(8, true) >>> 16;\n    if (flags & 255) {\n      if (zidx == -1)\n        zidx = dv.getUint32(doff, true);\n      doff += 4;\n    }\n  }\n  var ret;\n  var t = buf[v >= 4 ? 1 : 2];\n  switch (t) {\n    case 0:\n      return void 0;\n    case 2:\n      ret = { t: \"n\", v: ieee };\n      break;\n    case 3:\n      ret = { t: \"s\", v: lut.sst[sidx] };\n      break;\n    case 5:\n      {\n        if (opts == null ? void 0 : opts.cellDates)\n          ret = { t: \"d\", v: dt };\n        else\n          ret = { t: \"n\", v: dc / 86400 + 35430, z: table_fmt[14] };\n      }\n      break;\n    case 6:\n      ret = { t: \"b\", v: ieee > 0 };\n      break;\n    case 7:\n      ret = { t: \"n\", v: ieee };\n      break;\n    case 8:\n      ret = { t: \"e\", v: 0 };\n      break;\n    case 9:\n      {\n        if (ridx > -1) {\n          var rts = lut.rsst[ridx];\n          ret = { t: \"s\", v: rts.v };\n          if (rts.l)\n            ret.l = { Target: rts.l };\n        } else\n          throw new Error(\"Unsupported cell type \".concat(buf[subarray](0, 4)));\n      }\n      break;\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf[subarray](0, 4)));\n  }\n  if (zidx > -1)\n    numbers_format_cell(ret, t | v << 8, flags, lut.ofmt[zidx], lut.nfmt[zidx]);\n  if (t == 7)\n    ret.v /= 86400;\n  return ret;\n}\nfunction parse_new_storage(buf, lut, opts) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(4, true);\n  var fields = dv.getUint32(8, true);\n  var doff = 12;\n  var ridx = -1, sidx = -1, zidx = -1, d128 = NaN, ieee = NaN, dc = 0, dt = new Date(Date.UTC(2001, 0, 1)), eidx = -1, fidx = -1;\n  if (fields & 1) {\n    d128 = readDecimal128LE(buf, doff);\n    doff += 16;\n  }\n  if (fields & 2) {\n    ieee = dv.getFloat64(doff, true);\n    doff += 8;\n  }\n  if (fields & 4) {\n    dt.setTime(dt.getTime() + (dc = dv.getFloat64(doff, true)) * 1e3);\n    doff += 8;\n  }\n  if (fields & 8) {\n    sidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  if (fields & 16) {\n    ridx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  doff += popcnt(fields & 480) * 4;\n  if (fields & 512) {\n    fidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  doff += popcnt(fields & 1024) * 4;\n  if (fields & 2048) {\n    eidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  var ret;\n  var t = buf[1];\n  switch (t) {\n    case 0:\n      ret = { t: \"z\" };\n      break;\n    case 2:\n      ret = { t: \"n\", v: d128 };\n      break;\n    case 3:\n      ret = { t: \"s\", v: lut.sst[sidx] };\n      break;\n    case 5:\n      {\n        if (opts == null ? void 0 : opts.cellDates)\n          ret = { t: \"d\", v: dt };\n        else\n          ret = { t: \"n\", v: dc / 86400 + 35430, z: table_fmt[14] };\n      }\n      break;\n    case 6:\n      ret = { t: \"b\", v: ieee > 0 };\n      break;\n    case 7:\n      ret = { t: \"n\", v: ieee };\n      break;\n    case 8:\n      ret = { t: \"e\", v: 0 };\n      break;\n    case 9:\n      {\n        if (ridx > -1) {\n          var rts = lut.rsst[ridx];\n          ret = { t: \"s\", v: rts.v };\n          if (rts.l)\n            ret.l = { Target: rts.l };\n        } else\n          throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(fields & 31, \" : \").concat(buf[subarray](0, 4)));\n      }\n      break;\n    case 10:\n      ret = { t: \"n\", v: d128 };\n      break;\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(fields & 31, \" : \").concat(buf[subarray](0, 4)));\n  }\n  doff += popcnt(fields & 4096) * 4;\n  if (fields & 516096) {\n    if (zidx == -1)\n      zidx = dv.getUint32(doff, true);\n    doff += 4;\n  }\n  if (fields & 524288) {\n    var cmntidx = dv.getUint32(doff, true);\n    doff += 4;\n    if (lut.cmnt[cmntidx])\n      ret.c = iwa_to_s5s_comment(lut.cmnt[cmntidx]);\n  }\n  if (zidx > -1)\n    numbers_format_cell(ret, t | 5 << 8, fields >> 13, lut.ofmt[zidx], lut.nfmt[zidx]);\n  if (t == 7)\n    ret.v /= 86400;\n  return ret;\n}\nfunction write_new_storage(cell, lut) {\n  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, fields = 0;\n  out[0] = 5;\n  switch (cell.t) {\n    case \"n\":\n      if (cell.z && fmt_is_date(cell.z)) {\n        out[1] = 5;\n        dv.setFloat64(l, (numdate(cell.v + 1462).getTime() - Date.UTC(2001, 0, 1)) / 1e3, true);\n        fields |= 4;\n        l += 8;\n        break;\n      } else {\n        out[1] = 2;\n        writeDecimal128LE(out, l, cell.v);\n        fields |= 1;\n        l += 16;\n      }\n      break;\n    case \"b\":\n      out[1] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      fields |= 2;\n      l += 8;\n      break;\n    case \"s\":\n      {\n        var s = cell.v == null ? \"\" : String(cell.v);\n        if (cell.l) {\n          var irsst = lut.rsst.findIndex(function(v) {\n            var _a;\n            return v.v == s && v.l == ((_a = cell.l) == null ? void 0 : _a.Target);\n          });\n          if (irsst == -1)\n            lut.rsst[irsst = lut.rsst.length] = { v: s, l: cell.l.Target };\n          out[1] = 9;\n          dv.setUint32(l, irsst, true);\n          fields |= 16;\n          l += 4;\n        } else {\n          var isst = lut.sst.indexOf(s);\n          if (isst == -1)\n            lut.sst[isst = lut.sst.length] = s;\n          out[1] = 3;\n          dv.setUint32(l, isst, true);\n          fields |= 8;\n          l += 4;\n        }\n      }\n      break;\n    case \"d\":\n      out[1] = 5;\n      dv.setFloat64(l, (cell.v.getTime() - Date.UTC(2001, 0, 1)) / 1e3, true);\n      fields |= 4;\n      l += 8;\n      break;\n    case \"z\":\n      out[1] = 0;\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  if (cell.c) {\n    lut.cmnt.push(s5s_to_iwa_comment(cell.c));\n    dv.setUint32(l, lut.cmnt.length - 1, true);\n    fields |= 524288;\n    l += 4;\n  }\n  dv.setUint32(8, fields, true);\n  return out[subarray](0, l);\n}\nfunction write_old_storage(cell, lut) {\n  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, fields = 0, s = \"\";\n  out[0] = 4;\n  switch (cell.t) {\n    case \"n\":\n      break;\n    case \"b\":\n      break;\n    case \"s\":\n      {\n        s = cell.v == null ? \"\" : String(cell.v);\n        if (cell.l) {\n          var irsst = lut.rsst.findIndex(function(v) {\n            var _a;\n            return v.v == s && v.l == ((_a = cell.l) == null ? void 0 : _a.Target);\n          });\n          if (irsst == -1)\n            lut.rsst[irsst = lut.rsst.length] = { v: s, l: cell.l.Target };\n          out[1] = 9;\n          dv.setUint32(l, irsst, true);\n          fields |= 512;\n          l += 4;\n        } else {\n        }\n      }\n      break;\n    case \"d\":\n      break;\n    case \"e\":\n      break;\n    case \"z\":\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  if (cell.c) {\n    dv.setUint32(l, lut.cmnt.length - 1, true);\n    fields |= 4096;\n    l += 4;\n  }\n  switch (cell.t) {\n    case \"n\":\n      out[1] = 2;\n      dv.setFloat64(l, cell.v, true);\n      fields |= 32;\n      l += 8;\n      break;\n    case \"b\":\n      out[1] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      fields |= 32;\n      l += 8;\n      break;\n    case \"s\":\n      {\n        s = cell.v == null ? \"\" : String(cell.v);\n        if (cell.l) {\n        } else {\n          var isst = lut.sst.indexOf(s);\n          if (isst == -1)\n            lut.sst[isst = lut.sst.length] = s;\n          out[1] = 3;\n          dv.setUint32(l, isst, true);\n          fields |= 16;\n          l += 4;\n        }\n      }\n      break;\n    case \"d\":\n      out[1] = 5;\n      dv.setFloat64(l, (cell.v.getTime() - Date.UTC(2001, 0, 1)) / 1e3, true);\n      fields |= 64;\n      l += 8;\n      break;\n    case \"z\":\n      out[1] = 0;\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  dv.setUint32(8, fields, true);\n  return out[subarray](0, l);\n}\nfunction parse_cell_storage(buf, lut, opts) {\n  switch (buf[0]) {\n    case 0:\n    case 1:\n    case 2:\n    case 3:\n    case 4:\n      return parse_old_storage(buf, lut, buf[0], opts);\n    case 5:\n      return parse_new_storage(buf, lut, opts);\n    default:\n      throw new Error(\"Unsupported payload version \".concat(buf[0]));\n  }\n}\nfunction parse_TSP_Reference(buf) {\n  var pb = parse_shallow(buf);\n  return varint_to_i32(pb[1][0].data);\n}\nfunction write_TSP_Reference(idx) {\n  return write_shallow([\n    [],\n    [{ type: 0, data: write_varint49(idx) }]\n  ]);\n}\nfunction numbers_add_oref(iwa, ref) {\n  var _a;\n  var orefs = ((_a = iwa.messages[0].meta[5]) == null ? void 0 : _a[0]) ? parse_packed_varints(iwa.messages[0].meta[5][0].data) : [];\n  var orefidx = orefs.indexOf(ref);\n  if (orefidx == -1) {\n    orefs.push(ref);\n    iwa.messages[0].meta[5] = [{ type: 2, data: write_packed_varints(orefs) }];\n  }\n}\nfunction numbers_del_oref(iwa, ref) {\n  var _a;\n  var orefs = ((_a = iwa.messages[0].meta[5]) == null ? void 0 : _a[0]) ? parse_packed_varints(iwa.messages[0].meta[5][0].data) : [];\n  iwa.messages[0].meta[5] = [{ type: 2, data: write_packed_varints(orefs.filter(function(r) {\n    return r != ref;\n  })) }];\n}\nfunction parse_TST_TableDataList(M, root) {\n  var pb = parse_shallow(root.data);\n  var type = varint_to_i32(pb[1][0].data);\n  var entries = pb[3];\n  var data = [];\n  (entries || []).forEach(function(entry) {\n    var _a, _b;\n    var le = parse_shallow(entry.data);\n    if (!le[1])\n      return;\n    var key = varint_to_i32(le[1][0].data) >>> 0;\n    switch (type) {\n      case 1:\n        data[key] = u8str(le[3][0].data);\n        break;\n      case 8:\n        {\n          var rt = M[parse_TSP_Reference(le[9][0].data)][0];\n          var rtp = parse_shallow(rt.data);\n          var rtpref = M[parse_TSP_Reference(rtp[1][0].data)][0];\n          var mtype = varint_to_i32(rtpref.meta[1][0].data);\n          if (mtype != 2001)\n            throw new Error(\"2000 unexpected reference to \".concat(mtype));\n          var tswpsa = parse_shallow(rtpref.data);\n          var richtext = { v: tswpsa[3].map(function(x) {\n            return u8str(x.data);\n          }).join(\"\") };\n          data[key] = richtext;\n          sfields:\n            if ((_a = tswpsa == null ? void 0 : tswpsa[11]) == null ? void 0 : _a[0]) {\n              var smartfields = (_b = parse_shallow(tswpsa[11][0].data)) == null ? void 0 : _b[1];\n              if (!smartfields)\n                break sfields;\n              smartfields.forEach(function(sf) {\n                var _a2, _b2, _c;\n                var attr = parse_shallow(sf.data);\n                if ((_a2 = attr[2]) == null ? void 0 : _a2[0]) {\n                  var obj = M[parse_TSP_Reference((_b2 = attr[2]) == null ? void 0 : _b2[0].data)][0];\n                  var objtype = varint_to_i32(obj.meta[1][0].data);\n                  switch (objtype) {\n                    case 2032:\n                      var hlink = parse_shallow(obj.data);\n                      if (((_c = hlink == null ? void 0 : hlink[2]) == null ? void 0 : _c[0]) && !richtext.l)\n                        richtext.l = u8str(hlink[2][0].data);\n                      break;\n                    case 2039:\n                      break;\n                    default:\n                      console.log(\"unrecognized ObjectAttribute type \".concat(objtype));\n                  }\n                }\n              });\n            }\n        }\n        break;\n      case 2:\n        data[key] = parse_shallow(le[6][0].data);\n        break;\n      case 3:\n        data[key] = parse_shallow(le[5][0].data);\n        break;\n      case 10:\n        {\n          var cs = M[parse_TSP_Reference(le[10][0].data)][0];\n          data[key] = parse_TSD_CommentStorageArchive(M, cs.data);\n        }\n        break;\n      default:\n        throw type;\n    }\n  });\n  return data;\n}\nfunction parse_TST_TileRowInfo(u8, type) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n;\n  var pb = parse_shallow(u8);\n  var R = varint_to_i32(pb[1][0].data) >>> 0;\n  var cnt = varint_to_i32(pb[2][0].data) >>> 0;\n  var wide_offsets = ((_b = (_a = pb[8]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data) && varint_to_i32(pb[8][0].data) > 0 || false;\n  var used_storage_u8, used_storage;\n  if (((_d = (_c = pb[7]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && type != 0) {\n    used_storage_u8 = (_f = (_e = pb[7]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data;\n    used_storage = (_h = (_g = pb[6]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data;\n  } else if (((_j = (_i = pb[4]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data) && type != 1) {\n    used_storage_u8 = (_l = (_k = pb[4]) == null ? void 0 : _k[0]) == null ? void 0 : _l.data;\n    used_storage = (_n = (_m = pb[3]) == null ? void 0 : _m[0]) == null ? void 0 : _n.data;\n  } else\n    throw \"NUMBERS Tile missing \".concat(type, \" cell storage\");\n  var width = wide_offsets ? 4 : 1;\n  var used_storage_offsets = u8_to_dataview(used_storage_u8);\n  var offsets = [];\n  for (var C = 0; C < used_storage_u8.length / 2; ++C) {\n    var off = used_storage_offsets.getUint16(C * 2, true);\n    if (off < 65535)\n      offsets.push([C, off]);\n  }\n  if (offsets.length != cnt)\n    throw \"Expected \".concat(cnt, \" cells, found \").concat(offsets.length);\n  var cells = [];\n  for (C = 0; C < offsets.length - 1; ++C)\n    cells[offsets[C][0]] = used_storage[subarray](offsets[C][1] * width, offsets[C + 1][1] * width);\n  if (offsets.length >= 1)\n    cells[offsets[offsets.length - 1][0]] = used_storage[subarray](offsets[offsets.length - 1][1] * width);\n  return { R: R, cells: cells };\n}\nfunction parse_TST_Tile(M, root) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var storage = -1;\n  if ((_a = pb == null ? void 0 : pb[7]) == null ? void 0 : _a[0]) {\n    if (varint_to_i32(pb[7][0].data) >>> 0)\n      storage = 1;\n    else\n      storage = 0;\n  }\n  var ri = mappa(pb[5], function(u8) {\n    return parse_TST_TileRowInfo(u8, storage);\n  });\n  return {\n    nrows: varint_to_i32(pb[4][0].data) >>> 0,\n    data: ri.reduce(function(acc, x) {\n      if (!acc[x.R])\n        acc[x.R] = [];\n      x.cells.forEach(function(cell, C) {\n        if (acc[x.R][C])\n          throw new Error(\"Duplicate cell r=\".concat(x.R, \" c=\").concat(C));\n        acc[x.R][C] = cell;\n      });\n      return acc;\n    }, [])\n  };\n}\nfunction parse_TSD_CommentStorageArchive(M, data) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j;\n  var out = { t: \"\", a: \"\" };\n  var csp = parse_shallow(data);\n  if ((_b = (_a = csp == null ? void 0 : csp[1]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data)\n    out.t = u8str((_d = (_c = csp == null ? void 0 : csp[1]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) || \"\";\n  if ((_f = (_e = csp == null ? void 0 : csp[3]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data) {\n    var as = M[parse_TSP_Reference((_h = (_g = csp == null ? void 0 : csp[3]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data)][0];\n    var asp = parse_shallow(as.data);\n    if ((_j = (_i = asp[1]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data)\n      out.a = u8str(asp[1][0].data);\n  }\n  if (csp == null ? void 0 : csp[4]) {\n    out.replies = [];\n    csp[4].forEach(function(pi) {\n      var cs = M[parse_TSP_Reference(pi.data)][0];\n      out.replies.push(parse_TSD_CommentStorageArchive(M, cs.data));\n    });\n  }\n  return out;\n}\nfunction iwa_to_s5s_comment(iwa) {\n  var out = [];\n  out.push({ t: iwa.t || \"\", a: iwa.a, T: iwa.replies && iwa.replies.length > 0 });\n  if (iwa.replies)\n    iwa.replies.forEach(function(reply) {\n      out.push({ t: reply.t || \"\", a: reply.a, T: true });\n    });\n  return out;\n}\nfunction s5s_to_iwa_comment(s5s) {\n  var out = { a: \"\", t: \"\", replies: [] };\n  for (var i = 0; i < s5s.length; ++i) {\n    if (i == 0) {\n      out.a = s5s[i].a;\n      out.t = s5s[i].t;\n    } else {\n      out.replies.push({ a: s5s[i].a, t: s5s[i].t });\n    }\n  }\n  return out;\n}\nfunction parse_TST_TableModelArchive(M, root, ws, opts) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n;\n  var pb = parse_shallow(root.data);\n  var range = { s: { r: 0, c: 0 }, e: { r: 0, c: 0 } };\n  range.e.r = (varint_to_i32(pb[6][0].data) >>> 0) - 1;\n  if (range.e.r < 0)\n    throw new Error(\"Invalid row varint \".concat(pb[6][0].data));\n  range.e.c = (varint_to_i32(pb[7][0].data) >>> 0) - 1;\n  if (range.e.c < 0)\n    throw new Error(\"Invalid col varint \".concat(pb[7][0].data));\n  ws[\"!ref\"] = encode_range(range);\n  var dense = ws[\"!data\"] != null, dws = ws;\n  var store = parse_shallow(pb[4][0].data);\n  var lut = numbers_lut_new();\n  if ((_a = store[4]) == null ? void 0 : _a[0])\n    lut.sst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[4][0].data)][0]);\n  if ((_b = store[6]) == null ? void 0 : _b[0])\n    lut.fmla = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[6][0].data)][0]);\n  if ((_c = store[11]) == null ? void 0 : _c[0])\n    lut.ofmt = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[11][0].data)][0]);\n  if ((_d = store[12]) == null ? void 0 : _d[0])\n    lut.ferr = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[12][0].data)][0]);\n  if ((_e = store[17]) == null ? void 0 : _e[0])\n    lut.rsst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[17][0].data)][0]);\n  if ((_f = store[19]) == null ? void 0 : _f[0])\n    lut.cmnt = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[19][0].data)][0]);\n  if ((_g = store[22]) == null ? void 0 : _g[0])\n    lut.nfmt = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[22][0].data)][0]);\n  var tile = parse_shallow(store[3][0].data);\n  var _R = 0;\n  if (!((_h = store[9]) == null ? void 0 : _h[0]))\n    throw \"NUMBERS file missing row tree\";\n  var rtt = parse_shallow(store[9][0].data)[1].map(function(p) {\n    return parse_shallow(p.data);\n  });\n  rtt.forEach(function(kv) {\n    _R = varint_to_i32(kv[1][0].data);\n    var tidx = varint_to_i32(kv[2][0].data);\n    var t = tile[1][tidx];\n    if (!t)\n      throw \"NUMBERS missing tile \" + tidx;\n    var tl = parse_shallow(t.data);\n    var ref2 = M[parse_TSP_Reference(tl[2][0].data)][0];\n    var mtype2 = varint_to_i32(ref2.meta[1][0].data);\n    if (mtype2 != 6002)\n      throw new Error(\"6001 unexpected reference to \".concat(mtype2));\n    var _tile = parse_TST_Tile(M, ref2);\n    _tile.data.forEach(function(row, R) {\n      row.forEach(function(buf, C) {\n        var res = parse_cell_storage(buf, lut, opts);\n        if (res) {\n          if (dense) {\n            if (!dws[\"!data\"][_R + R])\n              dws[\"!data\"][_R + R] = [];\n            dws[\"!data\"][_R + R][C] = res;\n          } else {\n            ws[encode_col(C) + encode_row(_R + R)] = res;\n          }\n        }\n      });\n    });\n    _R += _tile.nrows;\n  });\n  if ((_i = store[13]) == null ? void 0 : _i[0]) {\n    var ref = M[parse_TSP_Reference(store[13][0].data)][0];\n    var mtype = varint_to_i32(ref.meta[1][0].data);\n    if (mtype != 6144)\n      throw new Error(\"Expected merge type 6144, found \".concat(mtype));\n    ws[\"!merges\"] = (_j = parse_shallow(ref.data)) == null ? void 0 : _j[1].map(function(pi) {\n      var merge = parse_shallow(pi.data);\n      var origin = u8_to_dataview(parse_shallow(merge[1][0].data)[1][0].data), size = u8_to_dataview(parse_shallow(merge[2][0].data)[1][0].data);\n      return {\n        s: { r: origin.getUint16(0, true), c: origin.getUint16(2, true) },\n        e: {\n          r: origin.getUint16(0, true) + size.getUint16(0, true) - 1,\n          c: origin.getUint16(2, true) + size.getUint16(2, true) - 1\n        }\n      };\n    });\n  }\n  if (!((_k = ws[\"!merges\"]) == null ? void 0 : _k.length) && ((_l = pb[47]) == null ? void 0 : _l[0])) {\n    var merge_owner = parse_shallow(pb[47][0].data);\n    if ((_m = merge_owner[2]) == null ? void 0 : _m[0]) {\n      var formula_store = parse_shallow(merge_owner[2][0].data);\n      if ((_n = formula_store[3]) == null ? void 0 : _n[0]) {\n        ws[\"!merges\"] = mappa(formula_store[3], function(u) {\n          var _a2, _b2, _c2, _d2, _e2;\n          var formula_pair = parse_shallow(u);\n          var formula = parse_shallow(formula_pair[2][0].data);\n          var AST_node_array = parse_shallow(formula[1][0].data);\n          if (!((_a2 = AST_node_array[1]) == null ? void 0 : _a2[0]))\n            return;\n          var AST_node0 = parse_shallow(AST_node_array[1][0].data);\n          var AST_node_type = varint_to_i32(AST_node0[1][0].data);\n          if (AST_node_type != 67)\n            return;\n          var AST_colon_tract = parse_shallow(AST_node0[40][0].data);\n          if (!((_b2 = AST_colon_tract[3]) == null ? void 0 : _b2[0]) || !((_c2 = AST_colon_tract[4]) == null ? void 0 : _c2[0]))\n            return;\n          var colrange = parse_shallow(AST_colon_tract[3][0].data);\n          var rowrange = parse_shallow(AST_colon_tract[4][0].data);\n          var c = varint_to_i32(colrange[1][0].data);\n          var C = ((_d2 = colrange[2]) == null ? void 0 : _d2[0]) ? varint_to_i32(colrange[2][0].data) : c;\n          var r = varint_to_i32(rowrange[1][0].data);\n          var R = ((_e2 = rowrange[2]) == null ? void 0 : _e2[0]) ? varint_to_i32(rowrange[2][0].data) : r;\n          return { s: { r: r, c: c }, e: { r: R, c: C } };\n        }).filter(function(x) {\n          return x != null;\n        });\n      }\n    }\n  }\n}\nfunction parse_TST_TableInfoArchive(M, root, opts) {\n  var pb = parse_shallow(root.data);\n  var out = { \"!ref\": \"A1\" };\n  if (opts == null ? void 0 : opts.dense)\n    out[\"!data\"] = [];\n  var tableref = M[parse_TSP_Reference(pb[2][0].data)];\n  var mtype = varint_to_i32(tableref[0].meta[1][0].data);\n  if (mtype != 6001)\n    throw new Error(\"6000 unexpected reference to \".concat(mtype));\n  parse_TST_TableModelArchive(M, tableref[0], out, opts);\n  return out;\n}\nfunction parse_TN_SheetArchive(M, root, opts) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var out = {\n    name: ((_a = pb[1]) == null ? void 0 : _a[0]) ? u8str(pb[1][0].data) : \"\",\n    sheets: []\n  };\n  var shapeoffs = mappa(pb[2], parse_TSP_Reference);\n  shapeoffs.forEach(function(off) {\n    M[off].forEach(function(m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 6e3)\n        out.sheets.push(parse_TST_TableInfoArchive(M, m, opts));\n    });\n  });\n  return out;\n}\nfunction parse_TN_DocumentArchive(M, root, opts) {\n  var _a;\n  var out = book_new();\n  out.Workbook = { WBProps: { date1904: true } };\n  var pb = parse_shallow(root.data);\n  if ((_a = pb[2]) == null ? void 0 : _a[0])\n    throw new Error(\"Keynote presentations are not supported\");\n  var sheetoffs = mappa(pb[1], parse_TSP_Reference);\n  sheetoffs.forEach(function(off) {\n    M[off].forEach(function(m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 2) {\n        var root2 = parse_TN_SheetArchive(M, m, opts);\n        root2.sheets.forEach(function(sheet, idx) {\n          book_append_sheet(out, sheet, idx == 0 ? root2.name : root2.name + \"_\" + idx, true);\n        });\n      }\n    });\n  });\n  if (out.SheetNames.length == 0)\n    throw new Error(\"Empty NUMBERS file\");\n  out.bookType = \"numbers\";\n  return out;\n}\nfunction parse_numbers_iwa(cfb, opts) {\n  var _a, _b, _c, _d, _e, _f, _g;\n  var M = {}, indices = [];\n  cfb.FullPaths.forEach(function(p) {\n    if (p.match(/\\.iwpv2/))\n      throw new Error(\"Unsupported password protection\");\n  });\n  cfb.FileIndex.forEach(function(s) {\n    if (!s.name.match(/\\.iwa$/))\n      return;\n    if (s.content[0] != 0)\n      return;\n    var o;\n    try {\n      o = decompress_iwa_file(s.content);\n    } catch (e) {\n      return console.log(\"?? \" + s.content.length + \" \" + (e.message || e));\n    }\n    var packets;\n    try {\n      packets = parse_iwa_file(o);\n    } catch (e) {\n      return console.log(\"## \" + (e.message || e));\n    }\n    packets.forEach(function(packet) {\n      M[packet.id] = packet.messages;\n      indices.push(packet.id);\n    });\n  });\n  if (!indices.length)\n    throw new Error(\"File has no messages\");\n  if (((_c = (_b = (_a = M == null ? void 0 : M[1]) == null ? void 0 : _a[0].meta) == null ? void 0 : _b[1]) == null ? void 0 : _c[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1e4)\n    throw new Error(\"Pages documents are not supported\");\n  var docroot = ((_g = (_f = (_e = (_d = M == null ? void 0 : M[1]) == null ? void 0 : _d[0]) == null ? void 0 : _e.meta) == null ? void 0 : _f[1]) == null ? void 0 : _g[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1 && M[1][0];\n  if (!docroot)\n    indices.forEach(function(idx) {\n      M[idx].forEach(function(iwam) {\n        var mtype = varint_to_i32(iwam.meta[1][0].data) >>> 0;\n        if (mtype == 1) {\n          if (!docroot)\n            docroot = iwam;\n          else\n            throw new Error(\"Document has multiple roots\");\n        }\n      });\n    });\n  if (!docroot)\n    throw new Error(\"Cannot find Document root\");\n  return parse_TN_DocumentArchive(M, docroot, opts);\n}\nfunction write_TST_TileRowInfo(data, lut, wide) {\n  var _a, _b, _c;\n  var tri = [\n    [],\n    [{ type: 0, data: write_varint49(0) }],\n    [{ type: 0, data: write_varint49(0) }],\n    [{ type: 2, data: new Uint8Array([]) }],\n    [{ type: 2, data: new Uint8Array(Array.from({ length: 510 }, function() {\n      return 255;\n    })) }],\n    [{ type: 0, data: write_varint49(5) }],\n    [{ type: 2, data: new Uint8Array([]) }],\n    [{ type: 2, data: new Uint8Array(Array.from({ length: 510 }, function() {\n      return 255;\n    })) }],\n    [{ type: 0, data: write_varint49(1) }]\n  ];\n  if (!((_a = tri[6]) == null ? void 0 : _a[0]) || !((_b = tri[7]) == null ? void 0 : _b[0]))\n    throw \"Mutation only works on post-BNC storages!\";\n  var cnt = 0;\n  if (tri[7][0].data.length < 2 * data.length) {\n    var new_7 = new Uint8Array(2 * data.length);\n    new_7.set(tri[7][0].data);\n    tri[7][0].data = new_7;\n  }\n  if (tri[4][0].data.length < 2 * data.length) {\n    var new_4 = new Uint8Array(2 * data.length);\n    new_4.set(tri[4][0].data);\n    tri[4][0].data = new_4;\n  }\n  var dv = u8_to_dataview(tri[7][0].data), last_offset = 0, cell_storage = [];\n  var _dv = u8_to_dataview(tri[4][0].data), _last_offset = 0, _cell_storage = [];\n  var width = wide ? 4 : 1;\n  for (var C = 0; C < data.length; ++C) {\n    if (data[C] == null || data[C].t == \"z\" && !((_c = data[C].c) == null ? void 0 : _c.length) || data[C].t == \"e\") {\n      dv.setUint16(C * 2, 65535, true);\n      _dv.setUint16(C * 2, 65535);\n      continue;\n    }\n    dv.setUint16(C * 2, last_offset / width, true);\n    _dv.setUint16(C * 2, _last_offset / width, true);\n    var celload, _celload;\n    switch (data[C].t) {\n      case \"d\":\n        if (data[C].v instanceof Date) {\n          celload = write_new_storage(data[C], lut);\n          _celload = write_old_storage(data[C], lut);\n          break;\n        }\n        celload = write_new_storage(data[C], lut);\n        _celload = write_old_storage(data[C], lut);\n        break;\n      case \"s\":\n      case \"n\":\n      case \"b\":\n      case \"z\":\n        celload = write_new_storage(data[C], lut);\n        _celload = write_old_storage(data[C], lut);\n        break;\n      default:\n        throw new Error(\"Unsupported value \" + data[C]);\n    }\n    cell_storage.push(celload);\n    last_offset += celload.length;\n    {\n      _cell_storage.push(_celload);\n      _last_offset += _celload.length;\n    }\n    ++cnt;\n  }\n  tri[2][0].data = write_varint49(cnt);\n  tri[5][0].data = write_varint49(5);\n  for (; C < tri[7][0].data.length / 2; ++C) {\n    dv.setUint16(C * 2, 65535, true);\n    _dv.setUint16(C * 2, 65535, true);\n  }\n  tri[6][0].data = u8concat(cell_storage);\n  tri[3][0].data = u8concat(_cell_storage);\n  tri[8] = [{ type: 0, data: write_varint49(wide ? 1 : 0) }];\n  return tri;\n}\nfunction write_iwam(type, payload) {\n  return {\n    meta: [\n      [],\n      [{ type: 0, data: write_varint49(type) }]\n    ],\n    data: payload\n  };\n}\nfunction get_unique_msgid(dep, dependents) {\n  if (!dependents.last)\n    dependents.last = 927262;\n  for (var i = dependents.last; i < 2e6; ++i)\n    if (!dependents[i]) {\n      dependents[dependents.last = i] = dep;\n      return i;\n    }\n  throw new Error(\"Too many messages\");\n}\nfunction build_numbers_deps(cfb) {\n  var dependents = {};\n  var indices = [];\n  cfb.FileIndex.map(function(fi, idx) {\n    return [fi, cfb.FullPaths[idx]];\n  }).forEach(function(row) {\n    var fi = row[0], fp = row[1];\n    if (fi.type != 2)\n      return;\n    if (!fi.name.match(/\\.iwa/))\n      return;\n    if (fi.content[0] != 0)\n      return;\n    parse_iwa_file(decompress_iwa_file(fi.content)).forEach(function(packet) {\n      indices.push(packet.id);\n      dependents[packet.id] = { deps: [], location: fp, type: varint_to_i32(packet.messages[0].meta[1][0].data) };\n    });\n  });\n  cfb.FileIndex.forEach(function(fi) {\n    if (!fi.name.match(/\\.iwa/))\n      return;\n    if (fi.content[0] != 0)\n      return;\n    parse_iwa_file(decompress_iwa_file(fi.content)).forEach(function(ia) {\n      ia.messages.forEach(function(mess) {\n        [5, 6].forEach(function(f) {\n          if (!mess.meta[f])\n            return;\n          mess.meta[f].forEach(function(x) {\n            dependents[ia.id].deps.push(varint_to_i32(x.data));\n          });\n        });\n      });\n    });\n  });\n  return dependents;\n}\nfunction write_TSP_Color_RGB(r, g, b) {\n  return write_shallow([\n    [],\n    [{ type: 0, data: write_varint49(1) }],\n    [],\n    [{ type: 5, data: new Uint8Array(Float32Array.from([r / 255]).buffer) }],\n    [{ type: 5, data: new Uint8Array(Float32Array.from([g / 255]).buffer) }],\n    [{ type: 5, data: new Uint8Array(Float32Array.from([b / 255]).buffer) }],\n    [{ type: 5, data: new Uint8Array(Float32Array.from([1]).buffer) }],\n    [],\n    [],\n    [],\n    [],\n    [],\n    [{ type: 0, data: write_varint49(1) }]\n  ]);\n}\nfunction get_author_color(n) {\n  switch (n) {\n    case 0:\n      return write_TSP_Color_RGB(99, 222, 171);\n    case 1:\n      return write_TSP_Color_RGB(162, 197, 240);\n    case 2:\n      return write_TSP_Color_RGB(255, 189, 189);\n  }\n  return write_TSP_Color_RGB(Math.random() * 255, Math.random() * 255, Math.random() * 255);\n}\nfunction write_numbers_iwa(wb, opts) {\n  if (!opts || !opts.numbers)\n    throw new Error(\"Must pass a `numbers` option -- check the README\");\n  var cfb = CFB.read(opts.numbers, { type: \"base64\" });\n  var deps = build_numbers_deps(cfb);\n  var docroot = numbers_iwa_find(cfb, deps, 1);\n  if (docroot == null)\n    throw \"Could not find message \".concat(1, \" in Numbers template\");\n  var sheetrefs = mappa(parse_shallow(docroot.messages[0].data)[1], parse_TSP_Reference);\n  if (sheetrefs.length > 1)\n    throw new Error(\"Template NUMBERS file must have exactly one sheet\");\n  wb.SheetNames.forEach(function(name, idx) {\n    if (idx >= 1) {\n      numbers_add_ws(cfb, deps, idx + 1);\n      docroot = numbers_iwa_find(cfb, deps, 1);\n      sheetrefs = mappa(parse_shallow(docroot.messages[0].data)[1], parse_TSP_Reference);\n    }\n    write_numbers_ws(cfb, deps, wb.Sheets[name], name, idx, sheetrefs[idx]);\n  });\n  return cfb;\n}\nfunction numbers_iwa_doit(cfb, deps, id, cb) {\n  var entry = CFB.find(cfb, deps[id].location);\n  if (!entry)\n    throw \"Could not find \".concat(deps[id].location, \" in Numbers template\");\n  var x = parse_iwa_file(decompress_iwa_file(entry.content));\n  var ainfo = x.find(function(packet) {\n    return packet.id == id;\n  });\n  cb(ainfo, x);\n  entry.content = compress_iwa_file(write_iwa_file(x));\n  entry.size = entry.content.length;\n}\nfunction numbers_iwa_find(cfb, deps, id) {\n  var entry = CFB.find(cfb, deps[id].location);\n  if (!entry)\n    throw \"Could not find \".concat(deps[id].location, \" in Numbers template\");\n  var x = parse_iwa_file(decompress_iwa_file(entry.content));\n  var ainfo = x.find(function(packet) {\n    return packet.id == id;\n  });\n  return ainfo;\n}\nfunction numbers_add_meta(mlist, newid, newloc) {\n  mlist[3].push({ type: 2, data: write_shallow([\n    [],\n    [{ type: 0, data: write_varint49(newid) }],\n    [{ type: 2, data: stru8(newloc.replace(/-[\\s\\S]*$/, \"\")) }],\n    [{ type: 2, data: stru8(newloc) }],\n    [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n    [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n    [],\n    [],\n    [],\n    [],\n    [{ type: 0, data: write_varint49(0) }],\n    [],\n    [{ type: 0, data: write_varint49(0) }]\n  ]) });\n  mlist[1] = [{ type: 0, data: write_varint49(Math.max(newid + 1, varint_to_i32(mlist[1][0].data))) }];\n}\nfunction numbers_add_msg(cfb, type, msg, path, deps, id) {\n  if (!id)\n    id = get_unique_msgid({ deps: [], location: \"\", type: type }, deps);\n  var loc = \"\".concat(path, \"-\").concat(id, \".iwa\");\n  deps[id].location = \"Root Entry\" + loc;\n  CFB.utils.cfb_add(cfb, loc, compress_iwa_file(write_iwa_file([{\n    id: id,\n    messages: [write_iwam(type, write_shallow(msg))]\n  }])));\n  var newloc = loc.replace(/^[\\/]/, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n  numbers_iwa_doit(cfb, deps, 2, function(ai) {\n    var mlist = parse_shallow(ai.messages[0].data);\n    numbers_add_meta(mlist, id || 0, newloc);\n    ai.messages[0].data = write_shallow(mlist);\n  });\n  return id;\n}\nfunction numbers_meta_add_dep(mlist, deps, id, dep) {\n  var loc = deps[id].location.replace(/^Root Entry\\//, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n  var parentidx = mlist[3].findIndex(function(m) {\n    var _a, _b;\n    var mm = parse_shallow(m.data);\n    if ((_a = mm[3]) == null ? void 0 : _a[0])\n      return u8str(mm[3][0].data) == loc;\n    if (((_b = mm[2]) == null ? void 0 : _b[0]) && u8str(mm[2][0].data) == loc)\n      return true;\n    return false;\n  });\n  var parent = parse_shallow(mlist[3][parentidx].data);\n  if (!parent[6])\n    parent[6] = [];\n  (Array.isArray(dep) ? dep : [dep]).forEach(function(dep2) {\n    parent[6].push({\n      type: 2,\n      data: write_shallow([\n        [],\n        [{ type: 0, data: write_varint49(dep2) }]\n      ])\n    });\n  });\n  mlist[3][parentidx].data = write_shallow(parent);\n}\nfunction numbers_meta_del_dep(mlist, deps, id, dep) {\n  var loc = deps[id].location.replace(/^Root Entry\\//, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n  var parentidx = mlist[3].findIndex(function(m) {\n    var _a, _b;\n    var mm = parse_shallow(m.data);\n    if ((_a = mm[3]) == null ? void 0 : _a[0])\n      return u8str(mm[3][0].data) == loc;\n    if (((_b = mm[2]) == null ? void 0 : _b[0]) && u8str(mm[2][0].data) == loc)\n      return true;\n    return false;\n  });\n  var parent = parse_shallow(mlist[3][parentidx].data);\n  if (!parent[6])\n    parent[6] = [];\n  parent[6] = parent[6].filter(function(m) {\n    return varint_to_i32(parse_shallow(m.data)[1][0].data) != dep;\n  });\n  mlist[3][parentidx].data = write_shallow(parent);\n}\nfunction numbers_add_ws(cfb, deps, wsidx) {\n  var sheetref = -1, newsheetref = -1;\n  var remap = {};\n  numbers_iwa_doit(cfb, deps, 1, function(docroot, arch) {\n    var doc = parse_shallow(docroot.messages[0].data);\n    sheetref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data);\n    newsheetref = get_unique_msgid({ deps: [1], location: deps[sheetref].location, type: 2 }, deps);\n    remap[sheetref] = newsheetref;\n    numbers_add_oref(docroot, newsheetref);\n    doc[1].push({ type: 2, data: write_TSP_Reference(newsheetref) });\n    var sheet = numbers_iwa_find(cfb, deps, sheetref);\n    sheet.id = newsheetref;\n    if (deps[1].location == deps[newsheetref].location)\n      arch.push(sheet);\n    else\n      numbers_iwa_doit(cfb, deps, newsheetref, function(_, x) {\n        return x.push(sheet);\n      });\n    docroot.messages[0].data = write_shallow(doc);\n  });\n  var tiaref = -1;\n  numbers_iwa_doit(cfb, deps, newsheetref, function(sheetroot, arch) {\n    var sa = parse_shallow(sheetroot.messages[0].data);\n    for (var i = 3; i <= 69; ++i)\n      delete sa[i];\n    var drawables = mappa(sa[2], parse_TSP_Reference);\n    drawables.forEach(function(n) {\n      return numbers_del_oref(sheetroot, n);\n    });\n    tiaref = get_unique_msgid({ deps: [newsheetref], location: deps[drawables[0]].location, type: deps[drawables[0]].type }, deps);\n    numbers_add_oref(sheetroot, tiaref);\n    remap[drawables[0]] = tiaref;\n    sa[2] = [{ type: 2, data: write_TSP_Reference(tiaref) }];\n    var tia = numbers_iwa_find(cfb, deps, drawables[0]);\n    tia.id = tiaref;\n    if (deps[drawables[0]].location == deps[newsheetref].location)\n      arch.push(tia);\n    else {\n      numbers_iwa_doit(cfb, deps, 2, function(ai) {\n        var mlist = parse_shallow(ai.messages[0].data);\n        numbers_meta_add_dep(mlist, deps, newsheetref, tiaref);\n        ai.messages[0].data = write_shallow(mlist);\n      });\n      numbers_iwa_doit(cfb, deps, tiaref, function(_, x) {\n        return x.push(tia);\n      });\n    }\n    sheetroot.messages[0].data = write_shallow(sa);\n  });\n  var tmaref = -1;\n  numbers_iwa_doit(cfb, deps, tiaref, function(tiaroot, arch) {\n    var tia = parse_shallow(tiaroot.messages[0].data);\n    var da = parse_shallow(tia[1][0].data);\n    for (var i = 3; i <= 69; ++i)\n      delete da[i];\n    var dap = parse_TSP_Reference(da[2][0].data);\n    da[2][0].data = write_TSP_Reference(remap[dap]);\n    tia[1][0].data = write_shallow(da);\n    var oldtmaref = parse_TSP_Reference(tia[2][0].data);\n    numbers_del_oref(tiaroot, oldtmaref);\n    tmaref = get_unique_msgid({ deps: [tiaref], location: deps[oldtmaref].location, type: deps[oldtmaref].type }, deps);\n    numbers_add_oref(tiaroot, tmaref);\n    remap[oldtmaref] = tmaref;\n    tia[2][0].data = write_TSP_Reference(tmaref);\n    var tma = numbers_iwa_find(cfb, deps, oldtmaref);\n    tma.id = tmaref;\n    if (deps[tiaref].location == deps[tmaref].location)\n      arch.push(tma);\n    else\n      numbers_iwa_doit(cfb, deps, tmaref, function(_, x) {\n        return x.push(tma);\n      });\n    tiaroot.messages[0].data = write_shallow(tia);\n  });\n  numbers_iwa_doit(cfb, deps, tmaref, function(tmaroot, arch) {\n    var _a, _b;\n    var tma = parse_shallow(tmaroot.messages[0].data);\n    var uuid = u8str(tma[1][0].data), new_uuid = uuid.replace(/-[A-Z0-9]*/, \"-\".concat((\"0000\" + wsidx.toString(16)).slice(-4)));\n    tma[1][0].data = stru8(new_uuid);\n    [12, 13, 29, 31, 32, 33, 39, 44, 47, 81, 82, 84].forEach(function(n) {\n      return delete tma[n];\n    });\n    if (tma[45]) {\n      var srrta = parse_shallow(tma[45][0].data);\n      var ref = parse_TSP_Reference(srrta[1][0].data);\n      numbers_del_oref(tmaroot, ref);\n      delete tma[45];\n    }\n    if (tma[70]) {\n      var hsoa = parse_shallow(tma[70][0].data);\n      (_a = hsoa[2]) == null ? void 0 : _a.forEach(function(item) {\n        var hsa = parse_shallow(item.data);\n        [2, 3].map(function(n) {\n          return hsa[n][0];\n        }).forEach(function(hseadata) {\n          var hsea = parse_shallow(hseadata.data);\n          if (!hsea[8])\n            return;\n          var ref2 = parse_TSP_Reference(hsea[8][0].data);\n          numbers_del_oref(tmaroot, ref2);\n        });\n      });\n      delete tma[70];\n    }\n    [\n      46,\n      30,\n      34,\n      35,\n      36,\n      38,\n      48,\n      49,\n      60,\n      61,\n      62,\n      63,\n      64,\n      71,\n      72,\n      73,\n      74,\n      75,\n      85,\n      86,\n      87,\n      88,\n      89\n    ].forEach(function(n) {\n      if (!tma[n])\n        return;\n      var ref2 = parse_TSP_Reference(tma[n][0].data);\n      delete tma[n];\n      numbers_del_oref(tmaroot, ref2);\n    });\n    var store = parse_shallow(tma[4][0].data);\n    {\n      [2, 4, 5, 6, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22].forEach(function(n) {\n        var _a2;\n        if (!((_a2 = store[n]) == null ? void 0 : _a2[0]))\n          return;\n        var oldref = parse_TSP_Reference(store[n][0].data);\n        var newref = get_unique_msgid({ deps: [tmaref], location: deps[oldref].location, type: deps[oldref].type }, deps);\n        numbers_del_oref(tmaroot, oldref);\n        numbers_add_oref(tmaroot, newref);\n        remap[oldref] = newref;\n        var msg = numbers_iwa_find(cfb, deps, oldref);\n        msg.id = newref;\n        if (deps[oldref].location == deps[tmaref].location)\n          arch.push(msg);\n        else {\n          deps[newref].location = deps[oldref].location.replace(oldref.toString(), newref.toString());\n          if (deps[newref].location == deps[oldref].location)\n            deps[newref].location = deps[newref].location.replace(/\\.iwa/, \"-\".concat(newref, \".iwa\"));\n          CFB.utils.cfb_add(cfb, deps[newref].location, compress_iwa_file(write_iwa_file([msg])));\n          var newloc = deps[newref].location.replace(/^Root Entry\\//, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n          numbers_iwa_doit(cfb, deps, 2, function(ai) {\n            var mlist = parse_shallow(ai.messages[0].data);\n            numbers_add_meta(mlist, newref, newloc);\n            numbers_meta_add_dep(mlist, deps, tmaref, newref);\n            ai.messages[0].data = write_shallow(mlist);\n          });\n        }\n        store[n][0].data = write_TSP_Reference(newref);\n      });\n      var row_headers = parse_shallow(store[1][0].data);\n      {\n        (_b = row_headers[2]) == null ? void 0 : _b.forEach(function(tspref) {\n          var oldref = parse_TSP_Reference(tspref.data);\n          var newref = get_unique_msgid({ deps: [tmaref], location: deps[oldref].location, type: deps[oldref].type }, deps);\n          numbers_del_oref(tmaroot, oldref);\n          numbers_add_oref(tmaroot, newref);\n          remap[oldref] = newref;\n          var msg = numbers_iwa_find(cfb, deps, oldref);\n          msg.id = newref;\n          if (deps[oldref].location == deps[tmaref].location) {\n            arch.push(msg);\n          } else {\n            deps[newref].location = deps[oldref].location.replace(oldref.toString(), newref.toString());\n            if (deps[newref].location == deps[oldref].location)\n              deps[newref].location = deps[newref].location.replace(/\\.iwa/, \"-\".concat(newref, \".iwa\"));\n            CFB.utils.cfb_add(cfb, deps[newref].location, compress_iwa_file(write_iwa_file([msg])));\n            var newloc = deps[newref].location.replace(/^Root Entry\\//, \"\").replace(/^Index\\//, \"\").replace(/\\.iwa$/, \"\");\n            numbers_iwa_doit(cfb, deps, 2, function(ai) {\n              var mlist = parse_shallow(ai.messages[0].data);\n              numbers_add_meta(mlist, newref, newloc);\n              numbers_meta_add_dep(mlist, deps, tmaref, newref);\n              ai.messages[0].data = write_shallow(mlist);\n            });\n          }\n          tspref.data = write_TSP_Reference(newref);\n        });\n      }\n      store[1][0].data = write_shallow(row_headers);\n      var tiles = parse_shallow(store[3][0].data);\n      {\n        tiles[1].forEach(function(t) {\n          var tst = parse_shallow(t.data);\n          var oldtileref = parse_TSP_Reference(tst[2][0].data);\n          var newtileref = remap[oldtileref];\n          if (!remap[oldtileref]) {\n            newtileref = get_unique_msgid({ deps: [tmaref], location: \"\", type: deps[oldtileref].type }, deps);\n            deps[newtileref].location = \"Root Entry/Index/Tables/Tile-\".concat(newtileref, \".iwa\");\n            remap[oldtileref] = newtileref;\n            var oldtile = numbers_iwa_find(cfb, deps, oldtileref);\n            oldtile.id = newtileref;\n            numbers_del_oref(tmaroot, oldtileref);\n            numbers_add_oref(tmaroot, newtileref);\n            CFB.utils.cfb_add(cfb, \"/Index/Tables/Tile-\".concat(newtileref, \".iwa\"), compress_iwa_file(write_iwa_file([oldtile])));\n            numbers_iwa_doit(cfb, deps, 2, function(ai) {\n              var mlist = parse_shallow(ai.messages[0].data);\n              mlist[3].push({ type: 2, data: write_shallow([\n                [],\n                [{ type: 0, data: write_varint49(newtileref) }],\n                [{ type: 2, data: stru8(\"Tables/Tile\") }],\n                [{ type: 2, data: stru8(\"Tables/Tile-\".concat(newtileref)) }],\n                [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n                [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n                [],\n                [],\n                [],\n                [],\n                [{ type: 0, data: write_varint49(0) }],\n                [],\n                [{ type: 0, data: write_varint49(0) }]\n              ]) });\n              mlist[1] = [{ type: 0, data: write_varint49(Math.max(newtileref + 1, varint_to_i32(mlist[1][0].data))) }];\n              numbers_meta_add_dep(mlist, deps, tmaref, newtileref);\n              ai.messages[0].data = write_shallow(mlist);\n            });\n          }\n          tst[2][0].data = write_TSP_Reference(newtileref);\n          t.data = write_shallow(tst);\n        });\n      }\n      store[3][0].data = write_shallow(tiles);\n    }\n    tma[4][0].data = write_shallow(store);\n    tmaroot.messages[0].data = write_shallow(tma);\n  });\n}\nfunction write_numbers_ws(cfb, deps, ws, wsname, sheetidx, rootref) {\n  var drawables = [];\n  numbers_iwa_doit(cfb, deps, rootref, function(docroot) {\n    var sheetref = parse_shallow(docroot.messages[0].data);\n    {\n      sheetref[1] = [{ type: 2, data: stru8(wsname) }];\n      drawables = mappa(sheetref[2], parse_TSP_Reference);\n    }\n    docroot.messages[0].data = write_shallow(sheetref);\n  });\n  var tia = numbers_iwa_find(cfb, deps, drawables[0]);\n  var tmaref = parse_TSP_Reference(parse_shallow(tia.messages[0].data)[2][0].data);\n  numbers_iwa_doit(cfb, deps, tmaref, function(docroot, x) {\n    return write_numbers_tma(cfb, deps, ws, docroot, x, tmaref);\n  });\n}\nvar USE_WIDE_ROWS = true;\nfunction write_numbers_tma(cfb, deps, ws, tmaroot, tmafile, tmaref) {\n  if (!ws[\"!ref\"])\n    throw new Error(\"Cannot export empty sheet to NUMBERS\");\n  var range = decode_range(ws[\"!ref\"]);\n  range.s.r = range.s.c = 0;\n  var trunc = false;\n  if (range.e.c > 999) {\n    trunc = true;\n    range.e.c = 999;\n  }\n  if (range.e.r > 999999) {\n    trunc = true;\n    range.e.r = 999999;\n  }\n  if (trunc)\n    console.error(\"Truncating to \".concat(encode_range(range)));\n  var data = [];\n  if (ws[\"!data\"])\n    data = ws[\"!data\"];\n  else {\n    var colstr = [];\n    for (var _C = 0; _C <= range.e.c; ++_C)\n      colstr[_C] = encode_col(_C);\n    for (var R_ = 0; R_ <= range.e.r; ++R_) {\n      data[R_] = [];\n      var _R = \"\" + (R_ + 1);\n      for (_C = 0; _C <= range.e.c; ++_C) {\n        var _cell = ws[colstr[_C] + _R];\n        if (!_cell)\n          continue;\n        data[R_][_C] = _cell;\n      }\n    }\n  }\n  var LUT = {\n    cmnt: [{ a: \"~54ee77S~\", t: \"... the people who are crazy enough to think they can change the world, are the ones who do.\" }],\n    ferr: [],\n    fmla: [],\n    nfmt: [],\n    ofmt: [],\n    rsst: [{ v: \"~54ee77S~\", l: \"https://sheetjs.com/\" }],\n    sst: [\"~Sh33tJ5~\"]\n  };\n  var pb = parse_shallow(tmaroot.messages[0].data);\n  {\n    pb[6][0].data = write_varint49(range.e.r + 1);\n    pb[7][0].data = write_varint49(range.e.c + 1);\n    delete pb[46];\n    var store = parse_shallow(pb[4][0].data);\n    {\n      var row_header_ref = parse_TSP_Reference(parse_shallow(store[1][0].data)[2][0].data);\n      numbers_iwa_doit(cfb, deps, row_header_ref, function(rowhead, _x) {\n        var _a;\n        var base_bucket = parse_shallow(rowhead.messages[0].data);\n        if ((_a = base_bucket == null ? void 0 : base_bucket[2]) == null ? void 0 : _a[0])\n          for (var R2 = 0; R2 < data.length; ++R2) {\n            var _bucket = parse_shallow(base_bucket[2][0].data);\n            _bucket[1][0].data = write_varint49(R2);\n            _bucket[4][0].data = write_varint49(data[R2].length);\n            base_bucket[2][R2] = { type: base_bucket[2][0].type, data: write_shallow(_bucket) };\n          }\n        rowhead.messages[0].data = write_shallow(base_bucket);\n      });\n      var col_header_ref = parse_TSP_Reference(store[2][0].data);\n      numbers_iwa_doit(cfb, deps, col_header_ref, function(colhead, _x) {\n        var base_bucket = parse_shallow(colhead.messages[0].data);\n        for (var C = 0; C <= range.e.c; ++C) {\n          var _bucket = parse_shallow(base_bucket[2][0].data);\n          _bucket[1][0].data = write_varint49(C);\n          _bucket[4][0].data = write_varint49(range.e.r + 1);\n          base_bucket[2][C] = { type: base_bucket[2][0].type, data: write_shallow(_bucket) };\n        }\n        colhead.messages[0].data = write_shallow(base_bucket);\n      });\n      var rbtree = parse_shallow(store[9][0].data);\n      rbtree[1] = [];\n      var tilestore = parse_shallow(store[3][0].data);\n      {\n        var tstride = 256;\n        tilestore[2] = [{ type: 0, data: write_varint49(tstride) }];\n        var tileref = parse_TSP_Reference(parse_shallow(tilestore[1][0].data)[2][0].data);\n        var save_token = function() {\n          var metadata = numbers_iwa_find(cfb, deps, 2);\n          var mlist = parse_shallow(metadata.messages[0].data);\n          var mlst = mlist[3].filter(function(m) {\n            return varint_to_i32(parse_shallow(m.data)[1][0].data) == tileref;\n          });\n          return (mlst == null ? void 0 : mlst.length) ? varint_to_i32(parse_shallow(mlst[0].data)[12][0].data) : 0;\n        }();\n        {\n          CFB.utils.cfb_del(cfb, deps[tileref].location);\n          numbers_iwa_doit(cfb, deps, 2, function(ai) {\n            var mlist = parse_shallow(ai.messages[0].data);\n            mlist[3] = mlist[3].filter(function(m) {\n              return varint_to_i32(parse_shallow(m.data)[1][0].data) != tileref;\n            });\n            numbers_meta_del_dep(mlist, deps, tmaref, tileref);\n            ai.messages[0].data = write_shallow(mlist);\n          });\n          numbers_del_oref(tmaroot, tileref);\n        }\n        tilestore[1] = [];\n        var ntiles = Math.ceil((range.e.r + 1) / tstride);\n        for (var tidx = 0; tidx < ntiles; ++tidx) {\n          var newtileid = get_unique_msgid({\n            deps: [],\n            location: \"\",\n            type: 6002\n          }, deps);\n          deps[newtileid].location = \"Root Entry/Index/Tables/Tile-\".concat(newtileid, \".iwa\");\n          var tiledata = [\n            [],\n            [{ type: 0, data: write_varint49(0) }],\n            [{ type: 0, data: write_varint49(Math.min(range.e.r + 1, (tidx + 1) * tstride)) }],\n            [{ type: 0, data: write_varint49(0) }],\n            [{ type: 0, data: write_varint49(Math.min((tidx + 1) * tstride, range.e.r + 1) - tidx * tstride) }],\n            [],\n            [{ type: 0, data: write_varint49(5) }],\n            [{ type: 0, data: write_varint49(1) }],\n            [{ type: 0, data: write_varint49(USE_WIDE_ROWS ? 1 : 0) }]\n          ];\n          for (var R = tidx * tstride; R <= Math.min(range.e.r, (tidx + 1) * tstride - 1); ++R) {\n            var tilerow = write_TST_TileRowInfo(data[R], LUT, USE_WIDE_ROWS);\n            tilerow[1][0].data = write_varint49(R - tidx * tstride);\n            tiledata[5].push({ data: write_shallow(tilerow), type: 2 });\n          }\n          tilestore[1].push({ type: 2, data: write_shallow([\n            [],\n            [{ type: 0, data: write_varint49(tidx) }],\n            [{ type: 2, data: write_TSP_Reference(newtileid) }]\n          ]) });\n          var newtile = {\n            id: newtileid,\n            messages: [write_iwam(6002, write_shallow(tiledata))]\n          };\n          var tilecontent = compress_iwa_file(write_iwa_file([newtile]));\n          CFB.utils.cfb_add(cfb, \"/Index/Tables/Tile-\".concat(newtileid, \".iwa\"), tilecontent);\n          numbers_iwa_doit(cfb, deps, 2, function(ai) {\n            var mlist = parse_shallow(ai.messages[0].data);\n            mlist[3].push({ type: 2, data: write_shallow([\n              [],\n              [{ type: 0, data: write_varint49(newtileid) }],\n              [{ type: 2, data: stru8(\"Tables/Tile\") }],\n              [{ type: 2, data: stru8(\"Tables/Tile-\".concat(newtileid)) }],\n              [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n              [{ type: 2, data: new Uint8Array([2, 0, 0]) }],\n              [],\n              [],\n              [],\n              [],\n              [{ type: 0, data: write_varint49(0) }],\n              [],\n              [{ type: 0, data: write_varint49(save_token) }]\n            ]) });\n            mlist[1] = [{ type: 0, data: write_varint49(Math.max(newtileid + 1, varint_to_i32(mlist[1][0].data))) }];\n            numbers_meta_add_dep(mlist, deps, tmaref, newtileid);\n            ai.messages[0].data = write_shallow(mlist);\n          });\n          numbers_add_oref(tmaroot, newtileid);\n          rbtree[1].push({ type: 2, data: write_shallow([\n            [],\n            [{ type: 0, data: write_varint49(tidx * tstride) }],\n            [{ type: 0, data: write_varint49(tidx) }]\n          ]) });\n        }\n      }\n      store[3][0].data = write_shallow(tilestore);\n      store[9][0].data = write_shallow(rbtree);\n      store[10] = [{ type: 2, data: new Uint8Array([]) }];\n      if (ws[\"!merges\"]) {\n        var mergeid = get_unique_msgid({\n          type: 6144,\n          deps: [tmaref],\n          location: deps[tmaref].location\n        }, deps);\n        tmafile.push({\n          id: mergeid,\n          messages: [write_iwam(6144, write_shallow([\n            [],\n            ws[\"!merges\"].map(function(m) {\n              return { type: 2, data: write_shallow([\n                [],\n                [{ type: 2, data: write_shallow([\n                  [],\n                  [{ type: 5, data: new Uint8Array(new Uint16Array([m.s.r, m.s.c]).buffer) }]\n                ]) }],\n                [{ type: 2, data: write_shallow([\n                  [],\n                  [{ type: 5, data: new Uint8Array(new Uint16Array([m.e.r - m.s.r + 1, m.e.c - m.s.c + 1]).buffer) }]\n                ]) }]\n              ]) };\n            })\n          ]))]\n        });\n        store[13] = [{ type: 2, data: write_TSP_Reference(mergeid) }];\n        numbers_iwa_doit(cfb, deps, 2, function(ai) {\n          var mlist = parse_shallow(ai.messages[0].data);\n          numbers_meta_add_dep(mlist, deps, tmaref, mergeid);\n          ai.messages[0].data = write_shallow(mlist);\n        });\n        numbers_add_oref(tmaroot, mergeid);\n      } else\n        delete store[13];\n      var sstref = parse_TSP_Reference(store[4][0].data);\n      numbers_iwa_doit(cfb, deps, sstref, function(sstroot) {\n        var sstdata = parse_shallow(sstroot.messages[0].data);\n        {\n          sstdata[3] = [];\n          LUT.sst.forEach(function(str, i) {\n            if (i == 0)\n              return;\n            sstdata[3].push({ type: 2, data: write_shallow([\n              [],\n              [{ type: 0, data: write_varint49(i) }],\n              [{ type: 0, data: write_varint49(1) }],\n              [{ type: 2, data: stru8(str) }]\n            ]) });\n          });\n        }\n        sstroot.messages[0].data = write_shallow(sstdata);\n      });\n      var rsstref = parse_TSP_Reference(store[17][0].data);\n      numbers_iwa_doit(cfb, deps, rsstref, function(rsstroot) {\n        var rsstdata = parse_shallow(rsstroot.messages[0].data);\n        rsstdata[3] = [];\n        var style_indices = [\n          904980,\n          903835,\n          903815,\n          903845\n        ];\n        LUT.rsst.forEach(function(rsst, i) {\n          if (i == 0)\n            return;\n          var tswpsa = [\n            [],\n            [{ type: 0, data: new Uint8Array([5]) }],\n            [],\n            [{ type: 2, data: stru8(rsst.v) }]\n          ];\n          tswpsa[10] = [{ type: 0, data: new Uint8Array([1]) }];\n          tswpsa[19] = [{ type: 2, data: new Uint8Array([10, 6, 8, 0, 18, 2, 101, 110]) }];\n          tswpsa[5] = [{ type: 2, data: new Uint8Array([10, 8, 8, 0, 18, 4, 8, 155, 149, 55]) }];\n          tswpsa[2] = [{ type: 2, data: new Uint8Array([8, 148, 158, 55]) }];\n          tswpsa[6] = [{ type: 2, data: new Uint8Array([10, 6, 8, 0, 16, 0, 24, 0]) }];\n          tswpsa[7] = [{ type: 2, data: new Uint8Array([10, 8, 8, 0, 18, 4, 8, 135, 149, 55]) }];\n          tswpsa[8] = [{ type: 2, data: new Uint8Array([10, 8, 8, 0, 18, 4, 8, 165, 149, 55]) }];\n          tswpsa[14] = [{ type: 2, data: new Uint8Array([10, 6, 8, 0, 16, 0, 24, 0]) }];\n          tswpsa[24] = [{ type: 2, data: new Uint8Array([10, 6, 8, 0, 16, 0, 24, 0]) }];\n          var tswpsaid = get_unique_msgid({ deps: [], location: \"\", type: 2001 }, deps);\n          var tswpsarefs = [];\n          if (rsst.l) {\n            var newhlinkid = numbers_add_msg(cfb, 2032, [\n              [],\n              [],\n              [{ type: 2, data: stru8(rsst.l) }]\n            ], \"/Index/Tables/DataList\", deps);\n            tswpsa[11] = [];\n            var smartfield = [[], []];\n            if (!smartfield[1])\n              smartfield[1] = [];\n            smartfield[1].push({ type: 2, data: write_shallow([\n              [],\n              [{ type: 0, data: write_varint49(0) }],\n              [{ type: 2, data: write_TSP_Reference(newhlinkid) }]\n            ]) });\n            tswpsa[11][0] = { type: 2, data: write_shallow(smartfield) };\n            tswpsarefs.push(newhlinkid);\n          }\n          numbers_add_msg(cfb, 2001, tswpsa, \"/Index/Tables/DataList\", deps, tswpsaid);\n          numbers_iwa_doit(cfb, deps, tswpsaid, function(iwa) {\n            style_indices.forEach(function(ref) {\n              return numbers_add_oref(iwa, ref);\n            });\n            tswpsarefs.forEach(function(ref) {\n              return numbers_add_oref(iwa, ref);\n            });\n          });\n          var rtpaid = numbers_add_msg(cfb, 6218, [\n            [],\n            [{ type: 2, data: write_TSP_Reference(tswpsaid) }],\n            [],\n            [{ type: 2, data: new Uint8Array([13, 255, 255, 255, 0, 18, 10, 16, 255, 255, 1, 24, 255, 255, 255, 255, 7]) }]\n          ], \"/Index/Tables/DataList\", deps);\n          numbers_iwa_doit(cfb, deps, rtpaid, function(iwa) {\n            return numbers_add_oref(iwa, tswpsaid);\n          });\n          rsstdata[3].push({ type: 2, data: write_shallow([\n            [],\n            [{ type: 0, data: write_varint49(i) }],\n            [{ type: 0, data: write_varint49(1) }],\n            [],\n            [],\n            [],\n            [],\n            [],\n            [],\n            [{ type: 2, data: write_TSP_Reference(rtpaid) }]\n          ]) });\n          numbers_add_oref(rsstroot, rtpaid);\n          numbers_iwa_doit(cfb, deps, 2, function(ai) {\n            var mlist = parse_shallow(ai.messages[0].data);\n            numbers_meta_add_dep(mlist, deps, rsstref, rtpaid);\n            numbers_meta_add_dep(mlist, deps, rtpaid, tswpsaid);\n            numbers_meta_add_dep(mlist, deps, tswpsaid, tswpsarefs);\n            numbers_meta_add_dep(mlist, deps, tswpsaid, style_indices);\n            ai.messages[0].data = write_shallow(mlist);\n          });\n        });\n        rsstroot.messages[0].data = write_shallow(rsstdata);\n      });\n      if (LUT.cmnt.length > 1) {\n        var cmntref = parse_TSP_Reference(store[19][0].data);\n        var authors = {}, iauthor = 0;\n        numbers_iwa_doit(cfb, deps, cmntref, function(cmntroot) {\n          var cmntdata = parse_shallow(cmntroot.messages[0].data);\n          {\n            cmntdata[3] = [];\n            LUT.cmnt.forEach(function(cc, i) {\n              if (i == 0)\n                return;\n              var replies = [];\n              if (cc.replies)\n                cc.replies.forEach(function(c) {\n                  if (!authors[c.a || \"\"])\n                    authors[c.a || \"\"] = numbers_add_msg(cfb, 212, [\n                      [],\n                      [{ type: 2, data: stru8(c.a || \"\") }],\n                      [{ type: 2, data: get_author_color(++iauthor) }],\n                      [],\n                      [{ type: 0, data: write_varint49(0) }]\n                    ], \"/Index/Tables/DataList\", deps);\n                  var aaaid2 = authors[c.a || \"\"];\n                  var csaid2 = numbers_add_msg(cfb, 3056, [\n                    [],\n                    [{ type: 2, data: stru8(c.t || \"\") }],\n                    [{ type: 2, data: write_shallow([\n                      [],\n                      [{ type: 1, data: new Uint8Array([0, 0, 0, 128, 116, 109, 182, 65]) }]\n                    ]) }],\n                    [{ type: 2, data: write_TSP_Reference(aaaid2) }]\n                  ], \"/Index/Tables/DataList\", deps);\n                  numbers_iwa_doit(cfb, deps, csaid2, function(iwa) {\n                    return numbers_add_oref(iwa, aaaid2);\n                  });\n                  replies.push(csaid2);\n                  numbers_iwa_doit(cfb, deps, 2, function(ai) {\n                    var mlist = parse_shallow(ai.messages[0].data);\n                    numbers_meta_add_dep(mlist, deps, csaid2, aaaid2);\n                    ai.messages[0].data = write_shallow(mlist);\n                  });\n                });\n              if (!authors[cc.a || \"\"])\n                authors[cc.a || \"\"] = numbers_add_msg(cfb, 212, [\n                  [],\n                  [{ type: 2, data: stru8(cc.a || \"\") }],\n                  [{ type: 2, data: get_author_color(++iauthor) }],\n                  [],\n                  [{ type: 0, data: write_varint49(0) }]\n                ], \"/Index/Tables/DataList\", deps);\n              var aaaid = authors[cc.a || \"\"];\n              var csaid = numbers_add_msg(cfb, 3056, [\n                [],\n                [{ type: 2, data: stru8(cc.t || \"\") }],\n                [{ type: 2, data: write_shallow([\n                  [],\n                  [{ type: 1, data: new Uint8Array([0, 0, 0, 128, 116, 109, 182, 65]) }]\n                ]) }],\n                [{ type: 2, data: write_TSP_Reference(aaaid) }],\n                replies.map(function(r) {\n                  return { type: 2, data: write_TSP_Reference(r) };\n                }),\n                [{ type: 2, data: write_shallow([\n                  [],\n                  [{ type: 0, data: write_varint49(i) }],\n                  [{ type: 0, data: write_varint49(0) }]\n                ]) }]\n              ], \"/Index/Tables/DataList\", deps);\n              numbers_iwa_doit(cfb, deps, csaid, function(iwa) {\n                numbers_add_oref(iwa, aaaid);\n                replies.forEach(function(r) {\n                  return numbers_add_oref(iwa, r);\n                });\n              });\n              cmntdata[3].push({ type: 2, data: write_shallow([\n                [],\n                [{ type: 0, data: write_varint49(i) }],\n                [{ type: 0, data: write_varint49(1) }],\n                [],\n                [],\n                [],\n                [],\n                [],\n                [],\n                [],\n                [{ type: 2, data: write_TSP_Reference(csaid) }]\n              ]) });\n              numbers_add_oref(cmntroot, csaid);\n              numbers_iwa_doit(cfb, deps, 2, function(ai) {\n                var mlist = parse_shallow(ai.messages[0].data);\n                numbers_meta_add_dep(mlist, deps, cmntref, csaid);\n                numbers_meta_add_dep(mlist, deps, csaid, aaaid);\n                if (replies.length)\n                  numbers_meta_add_dep(mlist, deps, csaid, replies);\n                ai.messages[0].data = write_shallow(mlist);\n              });\n            });\n          }\n          cmntdata[2][0].data = write_varint49(LUT.cmnt.length + 1);\n          cmntroot.messages[0].data = write_shallow(cmntdata);\n        });\n      }\n    }\n    pb[4][0].data = write_shallow(store);\n  }\n  tmaroot.messages[0].data = write_shallow(pb);\n}\nfunction fix_opts_func(defaults/*:Array<Array<any> >*/)/*:{(o:any):void}*/ {\n\treturn function fix_opts(opts) {\n\t\tfor(var i = 0; i != defaults.length; ++i) {\n\t\t\tvar d = defaults[i];\n\t\t\tif(opts[d[0]] === undefined) opts[d[0]] = d[1];\n\t\t\tif(d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n\t\t}\n\t};\n}\n\nfunction fix_read_opts(opts) {\nfix_opts_func([\n\t['cellNF', false], /* emit cell number format string as .z */\n\t['cellHTML', true], /* emit html string as .h */\n\t['cellFormula', true], /* emit formulae as .f */\n\t['cellStyles', false], /* emits style/theme as .s */\n\t['cellText', true], /* emit formatted text as .w */\n\t['cellDates', false], /* emit date cells with type `d` */\n\n\t['sheetStubs', false], /* emit empty cells */\n\t['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\n\n\t['bookDeps', false], /* parse calculation chains */\n\t['bookSheets', false], /* only try to get sheet names (no Sheets) */\n\t['bookProps', false], /* only try to get properties (no Sheets) */\n\t['bookFiles', false], /* include raw file structure (keys, files, cfb) */\n\t['bookVBA', false], /* include vba raw data (vbaraw) */\n\n\t['password',''], /* password */\n\t['WTF', false] /* WTF mode (throws errors) */\n])(opts);\n}\n\nfunction fix_write_opts(opts) {\nfix_opts_func([\n\t['cellDates', false], /* write date cells with type `d` */\n\n\t['bookSST', false], /* Generate Shared String Table */\n\n\t['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\n\n\t['compression', false], /* Use file compression */\n\n\t['WTF', false] /* WTF mode (throws errors) */\n])(opts);\n}\nfunction get_sheet_type(n/*:string*/)/*:string*/ {\n\tif(RELS.WS.indexOf(n) > -1) return \"sheet\";\n\tif(RELS.CS && n == RELS.CS) return \"chart\";\n\tif(RELS.DS && n == RELS.DS) return \"dialog\";\n\tif(RELS.MS && n == RELS.MS) return \"macro\";\n\treturn (n && n.length) ? n : \"sheet\";\n}\nfunction safe_parse_wbrels(wbrels, sheets) {\n\tif(!wbrels) return 0;\n\ttry {\n\t\twbrels = sheets.map(function pwbr(w) { if(!w.id) w.id = w.strRelID; return [w.name, wbrels['!id'][w.id].Target, get_sheet_type(wbrels['!id'][w.id].Type)]; });\n\t} catch(e) { return null; }\n\treturn !wbrels || wbrels.length === 0 ? null : wbrels;\n}\n\nfunction parse_sheet_legacy_drawing(sheet, type, zip, path, idx, opts, wb, comments) {\n\tif(!sheet || !sheet['!legdrawel']) return;\n\tvar dfile = resolve_path(sheet['!legdrawel'].Target, path);\n\tvar draw = getzipstr(zip, dfile, true);\n\tif(draw) parse_vml(utf8read(draw), sheet, comments||[]);\n}\n\nfunction safe_parse_sheet(zip, path/*:string*/, relsPath/*:string*/, sheet, idx/*:number*/, sheetRels, sheets, stype/*:string*/, opts, wb, themes, styles) {\n\ttry {\n\t\tsheetRels[sheet]=parse_rels(getzipstr(zip, relsPath, true), path);\n\t\tvar data = getzipdata(zip, path);\n\t\tvar _ws;\n\t\tswitch(stype) {\n\t\t\tcase 'sheet':  _ws = parse_ws(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tcase 'chart':  _ws = parse_cs(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n\t\t\t\tif(!_ws || !_ws['!drawel']) break;\n\t\t\t\tvar dfile = resolve_path(_ws['!drawel'].Target, path);\n\t\t\t\tvar drelsp = get_rels_path(dfile);\n\t\t\t\tvar draw = parse_drawing(getzipstr(zip, dfile, true), parse_rels(getzipstr(zip, drelsp, true), dfile));\n\t\t\t\tvar chartp = resolve_path(draw, dfile);\n\t\t\t\tvar crelsp = get_rels_path(chartp);\n\t\t\t\t_ws = parse_chart(getzipstr(zip, chartp, true), chartp, opts, parse_rels(getzipstr(zip, crelsp, true), chartp), wb, _ws);\n\t\t\t\tbreak;\n\t\t\tcase 'macro':  _ws = parse_ms(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tcase 'dialog': _ws = parse_ds(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tdefault: throw new Error(\"Unrecognized sheet type \" + stype);\n\t\t}\n\t\tsheets[sheet] = _ws;\n\n\t\t/* scan rels for comments and threaded comments */\n\t\tvar comments = [], tcomments = [];\n\t\tif(sheetRels && sheetRels[sheet]) keys(sheetRels[sheet]).forEach(function(n) {\n\t\t\tvar dfile = \"\";\n\t\t\tif(sheetRels[sheet][n].Type == RELS.CMNT) {\n\t\t\t\tdfile = resolve_path(sheetRels[sheet][n].Target, path);\n\t\t\t\tcomments = parse_cmnt(getzipdata(zip, dfile, true), dfile, opts);\n\t\t\t\tif(!comments || !comments.length) return;\n\t\t\t\tsheet_insert_comments(_ws, comments, false);\n\t\t\t}\n\t\t\tif(sheetRels[sheet][n].Type == RELS.TCMNT) {\n\t\t\t\tdfile = resolve_path(sheetRels[sheet][n].Target, path);\n\t\t\t\ttcomments = tcomments.concat(parse_tcmnt_xml(getzipdata(zip, dfile, true), opts));\n\t\t\t}\n\t\t});\n\t\tif(tcomments && tcomments.length) sheet_insert_comments(_ws, tcomments, true, opts.people || []);\n\t\tparse_sheet_legacy_drawing(_ws, stype, zip, path, idx, opts, wb, comments);\n\t} catch(e) { if(opts.WTF) throw e; }\n}\n\nfunction strip_front_slash(x/*:string*/)/*:string*/ { return x.charAt(0) == '/' ? x.slice(1) : x; }\n\nfunction parse_zip(zip/*:ZIP*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tmake_ssf();\n\topts = opts || {};\n\tfix_read_opts(opts);\n\n\t/* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n\t/* UOC */\n\tif(safegetzipfile(zip, 'objectdata.xml')) return parse_ods(zip, opts);\n\t/* Numbers */\n\tif(safegetzipfile(zip, 'Index/Document.iwa')) {\n\t\tif(typeof Uint8Array == \"undefined\") throw new Error('NUMBERS file parsing requires Uint8Array support');\n\t\tif(typeof parse_numbers_iwa != \"undefined\") {\n\t\t\tif(zip.FileIndex) return parse_numbers_iwa(zip, opts);\n\t\t\tvar _zip = CFB.utils.cfb_new();\n\t\t\tzipentries(zip).forEach(function(e) { zip_add_file(_zip, e, getzipbin(zip, e)); });\n\t\t\treturn parse_numbers_iwa(_zip, opts);\n\t\t}\n\t\tthrow new Error('Unsupported NUMBERS file');\n\t}\n\tif(!safegetzipfile(zip, '[Content_Types].xml')) {\n\t\tif(safegetzipfile(zip, 'index.xml.gz')) throw new Error('Unsupported NUMBERS 08 file');\n\t\tif(safegetzipfile(zip, 'index.xml')) throw new Error('Unsupported NUMBERS 09 file');\n\t\tvar index_zip = CFB.find(zip, 'Index.zip');\n\t\tif(index_zip) {\n\t\t\topts = dup(opts);\n\t\t\tdelete opts.type;\n\t\t\tif(typeof index_zip.content == \"string\") opts.type = \"binary\";\n\t\t\t// TODO: Bun buffer bug\n\t\t\tif(typeof Bun !== \"undefined\" && Buffer.isBuffer(index_zip.content)) return readSync(new Uint8Array(index_zip.content), opts);\n\t\t\treturn readSync(index_zip.content, opts);\n\t\t}\n\t\tthrow new Error('Unsupported ZIP file');\n\t}\n\n\tvar entries = zipentries(zip);\n\tvar dir = parse_ct((getzipstr(zip, '[Content_Types].xml')/*:?any*/));\n\tvar xlsb = false;\n\tvar sheets, binname;\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.xml\";\n\t\tif(getzipdata(zip,binname, true)) dir.workbooks.push(binname);\n\t}\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.bin\";\n\t\tif(!getzipdata(zip,binname,true)) throw new Error(\"Could not find workbook\");\n\t\tdir.workbooks.push(binname);\n\t\txlsb = true;\n\t}\n\tif(dir.workbooks[0].slice(-3) == \"bin\") xlsb = true;\n\n\tvar themes = ({}/*:any*/);\n\tvar styles = ({}/*:any*/);\n\tif(!opts.bookSheets && !opts.bookProps) {\n\t\tstrs = [];\n\t\tif(dir.sst) try { strs=parse_sst(getzipdata(zip, strip_front_slash(dir.sst)), dir.sst, opts); } catch(e) { if(opts.WTF) throw e; }\n\n\t\tif(opts.cellStyles && dir.themes.length) themes = parse_theme_xml(getzipstr(zip, dir.themes[0].replace(/^\\//,''), true)||\"\", opts);\n\n\t\tif(dir.style) styles = parse_sty(getzipdata(zip, strip_front_slash(dir.style)), dir.style, themes, opts);\n\t}\n\n\t/*var externbooks = */dir.links.map(function(link) {\n\t\ttry {\n\t\t\tvar rels = parse_rels(getzipstr(zip, get_rels_path(strip_front_slash(link))), link);\n\t\t\treturn parse_xlink(getzipdata(zip, strip_front_slash(link)), rels, link, opts);\n\t\t} catch(e) {}\n\t});\n\n\tvar wb = parse_wb(getzipdata(zip, strip_front_slash(dir.workbooks[0])), dir.workbooks[0], opts);\n\n\tvar props = {}, propdata = \"\";\n\n\tif(dir.coreprops.length) {\n\t\tpropdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\n\t\tif(propdata) props = parse_core_props(propdata);\n\t\tif(dir.extprops.length !== 0) {\n\t\t\tpropdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\n\t\t\tif(propdata) parse_ext_props(propdata, props, opts);\n\t\t}\n\t}\n\n\tvar custprops = {};\n\tif(!opts.bookSheets || opts.bookProps) {\n\t\tif (dir.custprops.length !== 0) {\n\t\t\tpropdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\n\t\t\tif(propdata) custprops = parse_cust_props(propdata, opts);\n\t\t}\n\t}\n\n\tvar out = ({}/*:any*/);\n\tif(opts.bookSheets || opts.bookProps) {\n\t\tif(wb.Sheets) sheets = wb.Sheets.map(function pluck(x){ return x.name; });\n\t\telse if(props.Worksheets && props.SheetNames.length > 0) sheets=props.SheetNames;\n\t\tif(opts.bookProps) { out.Props = props; out.Custprops = custprops; }\n\t\tif(opts.bookSheets && typeof sheets !== 'undefined') out.SheetNames = sheets;\n\t\tif(opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n\t}\n\tsheets = {};\n\n\tvar deps = {};\n\tif(opts.bookDeps && dir.calcchain) deps=parse_cc(getzipdata(zip, strip_front_slash(dir.calcchain)),dir.calcchain,opts);\n\n\tvar i=0;\n\tvar sheetRels = ({}/*:any*/);\n\tvar path, relsPath;\n\n\t{\n\t\tvar wbsheets = wb.Sheets;\n\t\tprops.Worksheets = wbsheets.length;\n\t\tprops.SheetNames = [];\n\t\tfor(var j = 0; j != wbsheets.length; ++j) {\n\t\t\tprops.SheetNames[j] = wbsheets[j].name;\n\t\t}\n\t}\n\n\tvar wbext = xlsb ? \"bin\" : \"xml\";\n\tvar wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\n\tvar wbrelsfile = (dir.workbooks[0].slice(0, wbrelsi+1) + \"_rels/\" + dir.workbooks[0].slice(wbrelsi+1) + \".rels\").replace(/^\\//,\"\");\n\tif(!safegetzipfile(zip, wbrelsfile)) wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n\tvar wbrels = parse_rels(getzipstr(zip, wbrelsfile, true), wbrelsfile.replace(/_rels.*/, \"s5s\"));\n\n\tif((dir.metadata || []).length >= 1) {\n\t\t/* TODO: MDX and other types of metadata */\n\t\topts.xlmeta = parse_xlmeta(getzipdata(zip, strip_front_slash(dir.metadata[0])),dir.metadata[0],opts);\n\t}\n\n\tif((dir.people || []).length >= 1) {\n\t\topts.people = parse_people_xml(getzipdata(zip, strip_front_slash(dir.people[0])),opts);\n\t}\n\n\tif(wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n\n\t/* Numbers iOS hack */\n\tvar nmode = (getzipdata(zip,\"xl/worksheets/sheet.xml\",true))?1:0;\n\twsloop: for(i = 0; i != props.Worksheets; ++i) {\n\t\tvar stype = \"sheet\";\n\t\tif(wbrels && wbrels[i]) {\n\t\t\tpath = 'xl/' + (wbrels[i][1]).replace(/[\\/]?xl\\//, \"\");\n\t\t\tif(!safegetzipfile(zip, path)) path = wbrels[i][1];\n\t\t\tif(!safegetzipfile(zip, path)) path = wbrelsfile.replace(/_rels\\/[\\S\\s]*$/,\"\") + wbrels[i][1];\n\t\t\tstype = wbrels[i][2];\n\t\t} else {\n\t\t\tpath = 'xl/worksheets/sheet'+(i+1-nmode)+\".\" + wbext;\n\t\t\tpath = path.replace(/sheet0\\./,\"sheet.\");\n\t\t}\n\t\trelsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n\t\tif(opts && opts.sheets != null) switch(typeof opts.sheets) {\n\t\t\tcase \"number\": if(i != opts.sheets) continue wsloop; break;\n\t\t\tcase \"string\": if(props.SheetNames[i].toLowerCase() != opts.sheets.toLowerCase()) continue wsloop; break;\n\t\t\tdefault: if(Array.isArray && Array.isArray(opts.sheets)) {\n\t\t\t\tvar snjseen = false;\n\t\t\t\tfor(var snj = 0; snj != opts.sheets.length; ++snj) {\n\t\t\t\t\tif(typeof opts.sheets[snj] == \"number\" && opts.sheets[snj] == i) snjseen=1;\n\t\t\t\t\tif(typeof opts.sheets[snj] == \"string\" && opts.sheets[snj].toLowerCase() == props.SheetNames[i].toLowerCase()) snjseen = 1;\n\t\t\t\t}\n\t\t\t\tif(!snjseen) continue wsloop;\n\t\t\t}\n\t\t}\n\t\tsafe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, opts, wb, themes, styles);\n\t}\n\n\tout = ({\n\t\tDirectory: dir,\n\t\tWorkbook: wb,\n\t\tProps: props,\n\t\tCustprops: custprops,\n\t\tDeps: deps,\n\t\tSheets: sheets,\n\t\tSheetNames: props.SheetNames,\n\t\tStrings: strs,\n\t\tStyles: styles,\n\t\tThemes: themes,\n\t\tSSF: dup(table_fmt)\n\t}/*:any*/);\n\tif(opts && opts.bookFiles) {\n\t\tif(zip.files) {\n\t\t\tout.keys = entries;\n\t\t\tout.files = zip.files;\n\t\t} else {\n\t\t\tout.keys = [];\n\t\t\tout.files = {};\n\t\t\tzip.FullPaths.forEach(function(p, idx) {\n\t\t\t\tp = p.replace(/^Root Entry[\\/]/, \"\");\n\t\t\t\tout.keys.push(p);\n\t\t\t\tout.files[p] = zip.FileIndex[idx];\n\t\t\t});\n\t\t}\n\t}\n\tif(opts && opts.bookVBA) {\n\t\tif(dir.vba.length > 0) out.vbaraw = getzipdata(zip,strip_front_slash(dir.vba[0]),true);\n\t\telse if(dir.defaults && dir.defaults.bin === CT_VBA) out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin',true);\n\t}\n\t// TODO: pass back content types metadata for xlsm/xlsx resolution\n\tout.bookType = xlsb ? \"xlsb\" : \"xlsx\";\n\treturn out;\n}\n\n/* [MS-OFFCRYPTO] 2.1.1 */\nfunction parse_xlsxcfb(cfb, _opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tvar opts = _opts || {};\n\tvar f = 'Workbook', data = CFB.find(cfb, f);\n\ttry {\n\tf = '/!DataSpaces/Version';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\t/*var version = */parse_DataSpaceVersionInfo(data.content);\n\n\t/* 2.3.4.1 */\n\tf = '/!DataSpaces/DataSpaceMap';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar dsm = parse_DataSpaceMap(data.content);\n\tif(dsm.length !== 1 || dsm[0].comps.length !== 1 || dsm[0].comps[0].t !== 0 || dsm[0].name !== \"StrongEncryptionDataSpace\" || dsm[0].comps[0].v !== \"EncryptedPackage\")\n\t\tthrow new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n\t/* 2.3.4.2 */\n\tf = '/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar seds = parse_DataSpaceDefinition(data.content);\n\tif(seds.length != 1 || seds[0] != \"StrongEncryptionTransform\")\n\t\tthrow new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n\t/* 2.3.4.3 */\n\tf = '/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\t/*var hdr = */parse_Primary(data.content);\n\t} catch(e) {}\n\n\tf = '/EncryptionInfo';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar einfo = parse_EncryptionInfo(data.content);\n\n\t/* 2.3.4.4 */\n\tf = '/EncryptedPackage';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\n/*global decrypt_agile */\n/*:: declare var decrypt_agile:any; */\n\tif(einfo[0] == 0x04 && typeof decrypt_agile !== 'undefined') return decrypt_agile(einfo[1], data.content, opts.password || \"\", opts);\n/*global decrypt_std76 */\n/*:: declare var decrypt_std76:any; */\n\tif(einfo[0] == 0x02 && typeof decrypt_std76 !== 'undefined') return decrypt_std76(einfo[1], data.content, opts.password || \"\", opts);\n\tthrow new Error(\"File is password-protected\");\n}\n\nfunction write_zip_xlsb(wb/*:Workbook*/, opts/*:WriteOpts*/)/*:ZIP*/ {\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = /*::((*/[]/*:: :any):SST)*/; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tif(browser_has_Map) opts.revStrings = new Map();\n\telse { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\n\tvar wbext = \"bin\";\n\tvar vbafmt = true;\n\tvar ct = new_ct();\n\tfix_write_opts(opts = opts || {});\n\tvar zip = zip_new();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tf = \"docProps/core.xml\";\n\tzip_add_file(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\n\t/*::if(!wb.Props) throw \"unreachable\"; */\n\tf = \"docProps/app.xml\";\n\tif(wb.Props && wb.Props.SheetNames){/* empty */}\n\telse if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\n\telse {\n\t\tvar _sn = [];\n\t\tfor(var _i = 0; _i < wb.SheetNames.length; ++_i)\n\t\t\tif((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\t\twb.Props.SheetNames = _sn;\n\t}\n\twb.Props.Worksheets = wb.Props.SheetNames.length;\n\tzip_add_file(zip, f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tvar people = [\"SheetJ5\"];\n\topts.tcid = 0;\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tvar wsrels = {'!id':{}};\n\t\tvar ws = wb.Sheets[wb.SheetNames[rId-1]];\n\t\tvar _type = (ws || {})[\"!type\"] || \"sheet\";\n\t\tswitch(_type) {\n\t\tcase \"chart\":\n\t\t\t/* falls through */\n\t\tdefault:\n\t\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\t\tzip_add_file(zip, f, write_ws_bin(rId-1, opts, wb, wsrels));\n\t\t\tct.sheets.push(f);\n\t\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n\t\t}\n\n\t\tif(ws) {\n\t\t\tvar comments = ws['!comments'];\n\t\t\tvar need_vml = false;\n\t\t\tvar cf = \"\";\n\t\t\tif(comments && comments.length > 0) {\n\t\t\t\tvar needtc = false;\n\t\t\t\tcomments.forEach(function(carr) {\n\t\t\t\t\tcarr[1].forEach(function(c) { if(c.T == true) needtc = true; });\n\t\t\t\t});\n\t\t\t\tif(needtc) {\n\t\t\t\t\tcf = \"xl/threadedComments/threadedComment\" + rId + \".xml\";\n\t\t\t\t\tzip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));\n\t\t\t\t\tct.threadedcomments.push(cf);\n\t\t\t\t\tadd_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".xml\", RELS.TCMNT);\n\t\t\t\t}\n\n\t\t\t\tcf = \"xl/comments\" + rId + \".\" + wbext;\n\t\t\t\tzip_add_file(zip, cf, write_comments_bin(comments, opts));\n\t\t\t\tct.comments.push(cf);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\t\t\tif(ws['!legacy']) {\n\t\t\t\tif(need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_vml(rId, ws['!comments']));\n\t\t\t}\n\t\t\tdelete ws['!comments'];\n\t\t\tdelete ws['!legacy'];\n\t\t}\n\n\t\tif(wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip_add_file(zip, f, write_sst_bin(opts.Strings, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip_add_file(zip, f, write_wb_bin(wb, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n\tvar ww = write_theme(wb.Themes, opts);\n\tzip_add_file(zip, f, ww);\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip_add_file(zip, f, write_sty_bin(wb, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n\tif(wb.vbaraw && vbafmt) {\n\t\tf = \"xl/vbaProject.bin\";\n\t\tzip_add_file(zip, f, wb.vbaraw);\n\t\tct.vba.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n\t}\n\n\tf = \"xl/metadata.\" + wbext;\n\tzip_add_file(zip, f, write_xlmeta_bin());\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n\tif(people.length > 1) {\n\t\tf = \"xl/persons/person.xml\";\n\t\tzip_add_file(zip, f, write_people_xml(people, opts));\n\t\tct.people.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"persons/person.xml\", RELS.PEOPLE);\n\t}\n\n\tzip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n\tzip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\n\tdelete opts.revssf; delete opts.ssf;\n\treturn zip;\n}\n\nfunction write_zip_xlsx(wb/*:Workbook*/, opts/*:WriteOpts*/)/*:ZIP*/ {\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = /*::((*/[]/*:: :any):SST)*/; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tif(browser_has_Map) opts.revStrings = new Map();\n\telse { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\n\tvar wbext = \"xml\";\n\tvar vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n\tvar ct = new_ct();\n\tfix_write_opts(opts = opts || {});\n\tvar zip = zip_new();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tf = \"docProps/core.xml\";\n\tzip_add_file(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\n\t/*::if(!wb.Props) throw \"unreachable\"; */\n\tf = \"docProps/app.xml\";\n\tif(wb.Props && wb.Props.SheetNames){/* empty */}\n\telse if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\n\telse {\n\t\tvar _sn = [];\n\t\tfor(var _i = 0; _i < wb.SheetNames.length; ++_i)\n\t\t\tif((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\t\twb.Props.SheetNames = _sn;\n\t}\n\twb.Props.Worksheets = wb.Props.SheetNames.length;\n\tzip_add_file(zip, f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tvar people = [\"SheetJ5\"];\n\topts.tcid = 0;\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tvar wsrels = {'!id':{}};\n\t\tvar ws = wb.Sheets[wb.SheetNames[rId-1]];\n\t\tvar _type = (ws || {})[\"!type\"] || \"sheet\";\n\t\tswitch(_type) {\n\t\tcase \"chart\":\n\t\t\t/* falls through */\n\t\tdefault:\n\t\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\t\tzip_add_file(zip, f, write_ws_xml(rId-1, opts, wb, wsrels));\n\t\t\tct.sheets.push(f);\n\t\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n\t\t}\n\n\t\tif(ws) {\n\t\t\tvar comments = ws['!comments'];\n\t\t\tvar need_vml = false;\n\t\t\tvar cf = \"\";\n\t\t\tif(comments && comments.length > 0) {\n\t\t\t\tvar needtc = false;\n\t\t\t\tcomments.forEach(function(carr) {\n\t\t\t\t\tcarr[1].forEach(function(c) { if(c.T == true) needtc = true; });\n\t\t\t\t});\n\t\t\t\tif(needtc) {\n\t\t\t\t\tcf = \"xl/threadedComments/threadedComment\" + rId + \".xml\";\n\t\t\t\t\tzip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));\n\t\t\t\t\tct.threadedcomments.push(cf);\n\t\t\t\t\tadd_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".xml\", RELS.TCMNT);\n\t\t\t\t}\n\n\t\t\t\tcf = \"xl/comments\" + rId + \".\" + wbext;\n\t\t\t\tzip_add_file(zip, cf, write_comments_xml(comments, opts));\n\t\t\t\tct.comments.push(cf);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\t\t\tif(ws['!legacy']) {\n\t\t\t\tif(need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_vml(rId, ws['!comments']));\n\t\t\t}\n\t\t\tdelete ws['!comments'];\n\t\t\tdelete ws['!legacy'];\n\t\t}\n\n\t\tif(wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip_add_file(zip, f, write_sst_xml(opts.Strings, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip_add_file(zip, f, write_wb_xml(wb, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n\tzip_add_file(zip, f, write_theme(wb.Themes, opts));\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip_add_file(zip, f, write_sty_xml(wb, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n\tif(wb.vbaraw && vbafmt) {\n\t\tf = \"xl/vbaProject.bin\";\n\t\tzip_add_file(zip, f, wb.vbaraw);\n\t\tct.vba.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n\t}\n\n\tf = \"xl/metadata.\" + wbext;\n\tzip_add_file(zip, f, write_xlmeta_xml());\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n\tif(people.length > 1) {\n\t\tf = \"xl/persons/person.xml\";\n\t\tzip_add_file(zip, f, write_people_xml(people, opts));\n\t\tct.people.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"persons/person.xml\", RELS.PEOPLE);\n\t}\n\n\tzip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n\tzip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\n\tdelete opts.revssf; delete opts.ssf;\n\treturn zip;\n}\n\nfunction firstbyte(f/*:RawData*/,o/*:?TypeOpts*/)/*:Array<number>*/ {\n\tvar x = \"\";\n\tswitch((o||{}).type || \"base64\") {\n\t\tcase 'buffer': return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\t\tcase 'base64': x = Base64_decode(f.slice(0,12)); break;\n\t\tcase 'binary': x = f; break;\n\t\tcase 'array':  return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\t\tdefault: throw new Error(\"Unrecognized type \" + (o && o.type || \"undefined\"));\n\t}\n\treturn [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3), x.charCodeAt(4), x.charCodeAt(5), x.charCodeAt(6), x.charCodeAt(7)];\n}\n\nfunction read_cfb(cfb/*:CFBContainer*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tif(CFB.find(cfb, \"EncryptedPackage\")) return parse_xlsxcfb(cfb, opts);\n\treturn parse_xlscfb(cfb, opts);\n}\n\nfunction read_zip(data/*:RawData*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tvar zip, d = data;\n\tvar o = opts||{};\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tzip = zip_read(d, o);\n\treturn parse_zip(zip, o);\n}\n\nfunction read_plaintext(data/*:string*/, o/*:ParseOpts*/)/*:Workbook*/ {\n\tvar i = 0;\n\tmain: while(i < data.length) switch(data.charCodeAt(i)) {\n\t\tcase 0x0A: case 0x0D: case 0x20: ++i; break;\n\t\tcase 0x3C: return parse_xlml(data.slice(i),o);\n\t\tdefault: break main;\n\t}\n\treturn PRN.to_workbook(data, o);\n}\n\nfunction read_plaintext_raw(data/*:RawData*/, o/*:ParseOpts*/)/*:Workbook*/ {\n\tvar str = \"\", bytes = firstbyte(data, o);\n\tswitch(o.type) {\n\t\tcase 'base64': str = Base64_decode(data); break;\n\t\tcase 'binary': str = data; break;\n\t\tcase 'buffer': str = data.toString('binary'); break;\n\t\tcase 'array': str = cc2str(data); break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\tif(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str);\n\to.type = \"binary\";\n\treturn read_plaintext(str, o);\n}\n\nfunction read_utf16(data/*:RawData*/, o/*:ParseOpts*/)/*:Workbook*/ {\n\tvar d = data;\n\tif(o.type == 'base64') d = Base64_decode(d);\n\tif(typeof ArrayBuffer !== \"undefined\" && data instanceof ArrayBuffer) d = new Uint8Array(data);\n\td = typeof $cptable !== \"undefined\" ? $cptable.utils.decode(1200, d.slice(2), 'str') : (\n\t\t(has_buf && Buffer.isBuffer(data)) ? data.slice(2).toString(\"utf16le\") :\n\t\t(typeof Uint8Array !== \"undefined\" && d instanceof Uint8Array) ? (\n\t\t\ttypeof TextDecoder !== \"undefined\" ? new TextDecoder(\"utf-16le\").decode(d.slice(2)) : utf16lereadu(d.slice(2))\n\t\t) : utf16leread(d.slice(2))\n\t);\n\to.type = \"binary\";\n\treturn read_plaintext(d, o);\n}\n\nfunction bstrify(data/*:string*/)/*:string*/ {\n\treturn !data.match(/[^\\x00-\\x7F]/) ? data : utf8write(data);\n}\n\nfunction read_prn(data, d, o, str) {\n\tif(str) { o.type = \"string\"; return PRN.to_workbook(data, o); }\n\treturn PRN.to_workbook(d, o);\n}\n\nfunction readSync(data/*:RawData*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\treset_cp();\n\tvar o = opts||{};\n\tif(o.codepage && typeof $cptable === \"undefined\") console.error(\"Codepage tables are not loaded.  Non-ASCII characters may not give expected results\");\n\tif(typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) return readSync(new Uint8Array(data), (o = dup(o), o.type = \"array\", o));\n\t/* Javet projects `byte[]` to `Int8Array` */\n\tif(typeof Int8Array !== 'undefined' && data instanceof Int8Array) return readSync(new Uint8Array(data.buffer, data.byteOffset, data.length), o);\n\tif(typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && !o.type) o.type = typeof Deno !== \"undefined\" ? \"buffer\" : \"array\";\n\tvar d = data, n = [0,0,0,0], str = false;\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\t_ssfopts = {};\n\tif(o.dateNF) _ssfopts.dateNF = o.dateNF;\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tif(o.type == \"file\") { o.type = has_buf ? \"buffer\" : \"binary\"; d = read_binary(data); if(typeof Uint8Array !== 'undefined' && !has_buf) o.type = \"array\"; }\n\tif(o.type == \"string\") { str = true; o.type = \"binary\"; o.codepage = 65001; d = bstrify(data); }\n\tif(o.type == 'array' && typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && typeof ArrayBuffer !== 'undefined') {\n\t\t// $FlowIgnore\n\t\tvar ab=new ArrayBuffer(3), vu=new Uint8Array(ab); vu.foo=\"bar\";\n\t\t// $FlowIgnore\n\t\tif(!vu.foo) {o=dup(o); o.type='array'; return readSync(ab2a(d), o);}\n\t}\n\tswitch((n = firstbyte(d, o))[0]) {\n\t\tcase 0xD0: if(n[1] === 0xCF && n[2] === 0x11 && n[3] === 0xE0 && n[4] === 0xA1 && n[5] === 0xB1 && n[6] === 0x1A && n[7] === 0xE1) return read_cfb(CFB.read(d, o), o); break;\n\t\tcase 0x09: if(n[1] <= 0x08) return parse_xlscfb(d, o); break;\n\t\tcase 0x3C: return parse_xlml(d, o);\n\t\tcase 0x49:\n\t\t\tif(n[1] === 0x49 && n[2] === 0x2a && n[3] === 0x00) throw new Error(\"TIFF Image File is not a spreadsheet\");\n\t\t\tif(n[1] === 0x44) return read_wb_ID(d, o);\n\t\t\tbreak;\n\t\tcase 0x54: if(n[1] === 0x41 && n[2] === 0x42 && n[3] === 0x4C) return DIF.to_workbook(d, o); break;\n\t\tcase 0x50: return (n[1] === 0x4B && n[2] < 0x09 && n[3] < 0x09) ? read_zip(d, o) : read_prn(data, d, o, str);\n\t\tcase 0xEF: return n[3] === 0x3C ? parse_xlml(d, o) : read_prn(data, d, o, str);\n\t\tcase 0xFF:\n\t\t\tif(n[1] === 0xFE) { return read_utf16(d, o); }\n\t\t\telse if(n[1] === 0x00 && n[2] === 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\t\t\tbreak;\n\t\tcase 0x00:\n\t\t\tif(n[1] === 0x00) {\n\t\t\t\tif(n[2] >= 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\t\t\t\tif(n[2] === 0x00 && (n[3] === 0x08 || n[3] === 0x09)) return WK_.to_workbook(d, o);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 0x03: case 0x83: case 0x8B: case 0x8C: return DBF.to_workbook(d, o);\n\t\tcase 0x7B: if(n[1] === 0x5C && n[2] === 0x72 && n[3] === 0x74) return rtf_to_workbook(d, o); break;\n\t\tcase 0x0A: case 0x0D: case 0x20: return read_plaintext_raw(d, o);\n\t\tcase 0x89: if(n[1] === 0x50 && n[2] === 0x4E && n[3] === 0x47) throw new Error(\"PNG Image File is not a spreadsheet\"); break;\n\t\tcase 0x08: if(n[1] === 0xE7) throw new Error(\"Unsupported Multiplan 1.x file!\"); break;\n\t\tcase 0x0C:\n\t\t\tif(n[1] === 0xEC) throw new Error(\"Unsupported Multiplan 2.x file!\");\n\t\t\tif(n[1] === 0xED) throw new Error(\"Unsupported Multiplan 3.x file!\");\n\t\t\tbreak;\n\t}\n\tif(DBF_SUPPORTED_VERSIONS.indexOf(n[0]) > -1 && n[2] <= 12 && n[3] <= 31) return DBF.to_workbook(d, o);\n\treturn read_prn(data, d, o, str);\n}\n\nfunction readFileSync(filename/*:string*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tvar o = opts||{}; o.type = 'file';\n\treturn readSync(filename, o);\n}\nfunction write_cfb_ctr(cfb/*:CFBContainer*/, o/*:WriteOpts*/)/*:any*/ {\n\tswitch(o.type) {\n\t\tcase \"base64\": case \"binary\": break;\n\t\tcase \"buffer\": case \"array\": o.type = \"\"; break;\n\t\tcase \"file\": return write_dl(o.file, CFB.write(cfb, {type:has_buf ? 'buffer' : \"\"}));\n\t\tcase \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\treturn CFB.write(cfb, o);\n}\n\nfunction write_zip(wb/*:Workbook*/, opts/*:WriteOpts*/)/*:ZIP*/ {\n\tswitch(opts.bookType) {\n\t\tcase \"ods\": return write_ods(wb, opts);\n\t\tcase \"numbers\": return write_numbers_iwa(wb, opts);\n\t\tcase \"xlsb\": return write_zip_xlsb(wb, opts);\n\t\tdefault: return write_zip_xlsx(wb, opts);\n\t}\n}\n\n/*:: declare var encrypt_agile:any; */\nfunction write_zip_type(wb/*:Workbook*/, opts/*:?WriteOpts*/)/*:any*/ {\n\tvar o = dup(opts||{});\n\tvar z = write_zip(wb, o);\n\treturn write_zip_denouement(z, o);\n}\nfunction write_zip_typeXLSX(wb/*:Workbook*/, opts/*:?WriteOpts*/)/*:any*/ {\n\tvar o = dup(opts||{});\n\tvar z = write_zip_xlsx(wb, o);\n\treturn write_zip_denouement(z, o);\n}\nfunction write_zip_denouement(z/*:any*/, o/*:?WriteOpts*/)/*:any*/ {\n\tvar oopts = {};\n\tvar ftype = has_buf ? \"nodebuffer\" : (typeof Uint8Array !== \"undefined\" ? \"array\" : \"string\");\n\tif(o.compression) oopts.compression = 'DEFLATE';\n\tif(o.password) oopts.type = ftype;\n\telse switch(o.type) {\n\t\tcase \"base64\": oopts.type = \"base64\"; break;\n\t\tcase \"binary\": oopts.type = \"string\"; break;\n\t\tcase \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\t\tcase \"buffer\":\n\t\tcase \"file\": oopts.type = ftype; break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\tvar out = z.FullPaths ? CFB.write(z, {fileType:\"zip\", type: /*::(*/{\"nodebuffer\": \"buffer\", \"string\": \"binary\"}/*:: :any)*/[oopts.type] || oopts.type, compression: !!o.compression}) : z.generate(oopts);\n\tif(typeof Deno !== \"undefined\") {\n\t\tif(typeof out == \"string\") {\n\t\t\tif(o.type == \"binary\" || o.type == \"base64\") return out;\n\t\t\tout = new Uint8Array(s2ab(out));\n\t\t}\n\t}\n/*jshint -W083 */\n\tif(o.password && typeof encrypt_agile !== 'undefined') return write_cfb_ctr(encrypt_agile(out, o.password), o); // eslint-disable-line no-undef\n/*jshint +W083 */\n\tif(o.type === \"file\") return write_dl(o.file, out);\n\treturn o.type == \"string\" ? utf8read(/*::(*/out/*:: :any)*/) : out;\n}\n\nfunction write_cfb_type(wb/*:Workbook*/, opts/*:?WriteOpts*/)/*:any*/ {\n\tvar o = opts||{};\n\tvar cfb/*:CFBContainer*/ = write_xlscfb(wb, o);\n\treturn write_cfb_ctr(cfb, o);\n}\n\nfunction write_string_type(out/*:string*/, opts/*:WriteOpts*/, bom/*:?string*/)/*:any*/ {\n\tif(!bom) bom = \"\";\n\tvar o = bom + out;\n\tswitch(opts.type) {\n\t\tcase \"base64\": return Base64_encode(utf8write(o));\n\t\tcase \"binary\": return utf8write(o);\n\t\tcase \"string\": return out;\n\t\tcase \"file\": return write_dl(opts.file, o, 'utf8');\n\t\tcase \"buffer\": {\n\t\t\tif(has_buf) return Buffer_from(o, 'utf8');\n\t\t\telse if(typeof TextEncoder !== \"undefined\") return new TextEncoder().encode(o);\n\t\t\telse return write_string_type(o, {type:'binary'}).split(\"\").map(function(c) { return c.charCodeAt(0); });\n\t\t}\n\t}\n\tthrow new Error(\"Unrecognized type \" + opts.type);\n}\n\nfunction write_stxt_type(out/*:string*/, opts/*:WriteOpts*/)/*:any*/ {\n\tswitch(opts.type) {\n\t\tcase \"base64\": return Base64_encode_pass(out);\n\t\tcase \"binary\": return out;\n\t\tcase \"string\": return out; /* override in sheet_to_txt */\n\t\tcase \"file\": return write_dl(opts.file, out, 'binary');\n\t\tcase \"buffer\": {\n\t\t\tif(has_buf) return Buffer_from(out, 'binary');\n\t\t\telse return out.split(\"\").map(function(c) { return c.charCodeAt(0); });\n\t\t}\n\t}\n\tthrow new Error(\"Unrecognized type \" + opts.type);\n}\n\n/* TODO: test consistency */\nfunction write_binary_type(out, opts/*:WriteOpts*/)/*:any*/ {\n\tswitch(opts.type) {\n\t\tcase \"string\":\n\t\tcase \"base64\":\n\t\tcase \"binary\":\n\t\t\tvar bstr = \"\";\n\t\t\t// $FlowIgnore\n\t\t\tfor(var i = 0; i < out.length; ++i) bstr += String.fromCharCode(out[i]);\n\t\t\treturn opts.type == 'base64' ? Base64_encode(bstr) : opts.type == 'string' ? utf8read(bstr) : bstr;\n\t\tcase \"file\": return write_dl(opts.file, out);\n\t\tcase \"buffer\": return out;\n\t\tdefault: throw new Error(\"Unrecognized type \" + opts.type);\n\t}\n}\n\nfunction writeSyncXLSX(wb/*:Workbook*/, opts/*:?WriteOpts*/) {\n\treset_cp();\n\tcheck_wb(wb);\n\tvar o = dup(opts||{});\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\tif(o.type == \"array\") { o.type = \"binary\"; var out/*:string*/ = (writeSyncXLSX(wb, o)/*:any*/); o.type = \"array\"; return s2ab(out); }\n\treturn write_zip_typeXLSX(wb, o);\n}\n\nfunction writeSync(wb/*:Workbook*/, opts/*:?WriteOpts*/) {\n\treset_cp();\n\tcheck_wb(wb);\n\tvar o = dup(opts||{});\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\tif(o.type == \"array\") { o.type = \"binary\"; var out/*:string*/ = (writeSync(wb, o)/*:any*/); o.type = \"array\"; return s2ab(out); }\n\tvar idx = 0;\n\tif(o.sheet) {\n\t\tif(typeof o.sheet == \"number\") idx = o.sheet;\n\t\telse idx = wb.SheetNames.indexOf(o.sheet);\n\t\tif(!wb.SheetNames[idx]) throw new Error(\"Sheet not found: \" + o.sheet + \" : \" + (typeof o.sheet));\n\t}\n\tswitch(o.bookType || 'xlsb') {\n\t\tcase 'xml':\n\t\tcase 'xlml': return write_string_type(write_xlml(wb, o), o);\n\t\tcase 'slk':\n\t\tcase 'sylk': return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]], o, wb), o);\n\t\tcase 'htm':\n\t\tcase 'html': return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'txt': return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'csv': return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]], o), o, \"\\ufeff\");\n\t\tcase 'dif': return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'dbf': return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'prn': return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'rtf': return write_string_type(sheet_to_rtf(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'eth': return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'fods': return write_string_type(write_ods(wb, o), o);\n\t\tcase 'wk1': return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'wk3': return write_binary_type(WK_.book_to_wk3(wb, o), o);\n\t\tcase 'biff2': if(!o.biff) o.biff = 2; /* falls through */\n\t\tcase 'biff3': if(!o.biff) o.biff = 3; /* falls through */\n\t\tcase 'biff4': if(!o.biff) o.biff = 4; return write_binary_type(write_biff_buf(wb, o), o);\n\t\tcase 'biff5': if(!o.biff) o.biff = 5; /* falls through */\n\t\tcase 'biff8':\n\t\tcase 'xla':\n\t\tcase 'xls': if(!o.biff) o.biff = 8; return write_cfb_type(wb, o);\n\t\tcase 'xlsx':\n\t\tcase 'xlsm':\n\t\tcase 'xlam':\n\t\tcase 'xlsb':\n\t\tcase 'numbers':\n\t\tcase 'ods': return write_zip_type(wb, o);\n\t\tdefault: throw new Error (\"Unrecognized bookType |\" + o.bookType + \"|\");\n\t}\n}\n\nfunction resolve_book_type(o/*:WriteFileOpts*/) {\n\tif(o.bookType) return;\n\tvar _BT = {\n\t\t\"xls\": \"biff8\",\n\t\t\"htm\": \"html\",\n\t\t\"slk\": \"sylk\",\n\t\t\"socialcalc\": \"eth\",\n\t\t\"Sh33tJS\": \"WTF\"\n\t};\n\tvar ext = o.file.slice(o.file.lastIndexOf(\".\")).toLowerCase();\n\tif(ext.match(/^\\.[a-z]+$/)) o.bookType = ext.slice(1);\n\to.bookType = _BT[o.bookType] || o.bookType;\n}\n\nfunction writeFileSync(wb/*:Workbook*/, filename/*:string*/, opts/*:?WriteFileOpts*/) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\treturn writeSync(wb, o);\n}\n\nfunction writeFileSyncXLSX(wb/*:Workbook*/, filename/*:string*/, opts/*:?WriteFileOpts*/) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\treturn writeSyncXLSX(wb, o);\n}\n\n\nfunction writeFileAsync(filename/*:string*/, wb/*:Workbook*/, opts/*:?WriteFileOpts*/, cb/*:?(e?:ErrnoError)=>void*/) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\to.type = 'buffer';\n\tvar _cb = cb; if(!(_cb instanceof Function)) _cb = (opts/*:any*/);\n\treturn _fs.writeFile(filename, writeSync(wb, o), _cb);\n}\n/*::\ntype MJRObject = {\n\trow: any;\n\tisempty: boolean;\n};\n*/\nfunction make_json_row(sheet/*:Worksheet*/, r/*:Range*/, R/*:number*/, cols/*:Array<string>*/, header/*:number*/, hdr/*:Array<any>*/, o/*:Sheet2JSONOpts*/)/*:MJRObject*/ {\n\tvar rr = encode_row(R);\n\tvar defval = o.defval, raw = o.raw || !Object.prototype.hasOwnProperty.call(o, \"raw\");\n\tvar isempty = true, dense = (sheet[\"!data\"] != null);\n\tvar row/*:any*/ = (header === 1) ? [] : {};\n\tif(header !== 1) {\n\t\tif(Object.defineProperty) try { Object.defineProperty(row, '__rowNum__', {value:R, enumerable:false}); } catch(e) { row.__rowNum__ = R; }\n\t\telse row.__rowNum__ = R;\n\t}\n\tif(!dense || sheet[\"!data\"][R]) for (var C = r.s.c; C <= r.e.c; ++C) {\n\t\tvar val = dense ? (sheet[\"!data\"][R]||[])[C] : sheet[cols[C] + rr];\n\t\tif(val == null || val.t === undefined) {\n\t\t\tif(defval === undefined) continue;\n\t\t\tif(hdr[C] != null) { row[hdr[C]] = defval; }\n\t\t\tcontinue;\n\t\t}\n\t\tvar v = val.v;\n\t\tswitch(val.t){\n\t\t\tcase 'z': if(v == null) break; continue;\n\t\t\tcase 'e': v = (v == 0 ? null : void 0); break;\n\t\t\tcase 's': case 'b':\n\t\t\tcase 'n': if(!val.z || !fmt_is_date(val.z)) break;\n\t\t\tv = numdate(v); // TODO: date1904 setting should also be stored in worksheet object\n\t\t\tif(typeof v == \"number\") break;\n\t\t\t/* falls through */\n\t\t\tcase 'd': if(!(o && (o.UTC||(o.raw === false)))) v = utc_to_local(new Date(v)); break;\n\t\t\tdefault: throw new Error('unrecognized type ' + val.t);\n\t\t}\n\t\tif(hdr[C] != null) {\n\t\t\tif(v == null) {\n\t\t\t\tif(val.t == \"e\" && v === null) row[hdr[C]] = null;\n\t\t\t\telse if(defval !== undefined) row[hdr[C]] = defval;\n\t\t\t\telse if(raw && v === null) row[hdr[C]] = null;\n\t\t\t\telse continue;\n\t\t\t} else {\n\t\t\t\trow[hdr[C]] = (val.t === 'n' && typeof o.rawNumbers === 'boolean' ? o.rawNumbers : raw) ? v : format_cell(val, v, o);\n\t\t\t}\n\t\t\tif(v != null) isempty = false;\n\t\t}\n\t}\n\treturn { row: row, isempty: isempty };\n}\n\n\nfunction sheet_to_json(sheet/*:Worksheet*/, opts/*:?Sheet2JSONOpts*/) {\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar val = {t:'n',v:0}, header = 0, offset = 1, hdr/*:Array<any>*/ = [], v=0, vv=\"\";\n\tvar r = {s:{r:0,c:0},e:{r:0,c:0}};\n\tvar o = opts || {};\n\tvar range = o.range != null ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\telse if(o.header == null) header = 0;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols/*:Array<string>*/ = [];\n\tvar out/*:Array<any>*/ = [];\n\tvar outi = 0, counter = 0;\n\tvar dense = sheet[\"!data\"] != null;\n\tvar R = r.s.r, C = 0;\n\tvar header_cnt = {};\n\tif(dense && !sheet[\"!data\"][R]) sheet[\"!data\"][R] = [];\n\tvar colinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tif(((colinfo[C]||{}).hidden)) continue;\n\t\tcols[C] = encode_col(C);\n\t\tval = dense ? sheet[\"!data\"][R][C] : sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C - r.s.c; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val == null) val = {w: \"__EMPTY\", t: \"s\"};\n\t\t\t\tvv = v = format_cell(val, null, o);\n\t\t\t\tcounter = header_cnt[v] || 0;\n\t\t\t\tif(!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo { vv = v + \"_\" + (counter++); } while(header_cnt[vv]); header_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t}\n\t}\n\tfor (R = r.s.r + offset; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R]||{}).hidden) continue;\n\t\tvar row = make_json_row(sheet, r, R, cols, header, hdr, o);\n\t\tif((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;\n\t}\n\tout.length = outi;\n\treturn out;\n}\n\nvar qreg = /\"/g;\nfunction make_csv_row(sheet/*:Worksheet*/, r/*:Range*/, R/*:number*/, cols/*:Array<string>*/, fs/*:number*/, rs/*:number*/, FS/*:string*/, w/*:number*/, o/*:Sheet2CSVOpts*/)/*:?string*/ {\n\tvar isempty = true;\n\tvar row/*:Array<string>*/ = [], txt = \"\", rr = encode_row(R);\n\tvar dense = sheet[\"!data\"] != null;\n\tvar datarow = dense && sheet[\"!data\"][R] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\tif (!cols[C]) continue;\n\t\tvar val = dense ? datarow[C]: sheet[cols[C] + rr];\n\t\tif(val == null) txt = \"\";\n\t\telse if(val.v != null) {\n\t\t\tisempty = false;\n\t\t\ttxt = ''+(o.rawNumbers && val.t == \"n\" ? val.v : format_cell(val, null, o));\n\t\t\tfor(var i = 0, cc = 0; i !== txt.length; ++i) if((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34 || o.forceQuotes) {txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break; }\n\t\t\tif(txt == \"ID\" && w == 0 && row.length == 0) txt = '\"ID\"';\n\t\t} else if(val.f != null && !val.F) {\n\t\t\tisempty = false;\n\t\t\ttxt = '=' + val.f; if(txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n\t\t} else txt = \"\";\n\t\t/* NOTE: Excel CSV does not support array formulae */\n\t\trow.push(txt);\n\t}\n\tif(o.strip) while(row[row.length - 1] === \"\") --row.length;\n\tif(o.blankrows === false && isempty) return null;\n\treturn row.join(FS);\n}\n\nfunction sheet_to_csv(sheet/*:Worksheet*/, opts/*:?Sheet2CSVOpts*/)/*:string*/ {\n\tvar out/*:Array<string>*/ = [];\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar row = \"\", cols/*:Array<string>*/ = [];\n\tvar colinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\n\tvar w = 0;\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R]||{}).hidden) continue;\n\t\trow = make_csv_row(sheet, r, R, cols, fs, rs, FS, w, o);\n\t\tif(row == null) { continue; }\n\t\tif(row || (o.blankrows !== false)) out.push((w++ ? RS : \"\") + row);\n\t}\n\treturn out.join(\"\");\n}\n\nfunction sheet_to_txt(sheet/*:Worksheet*/, opts/*:?Sheet2CSVOpts*/) {\n\tif(!opts) opts = {}; opts.FS = \"\\t\"; opts.RS = \"\\n\";\n\tvar s = sheet_to_csv(sheet, opts);\n\tif(typeof $cptable == 'undefined' || opts.type == 'string') return s;\n\tvar o = $cptable.utils.encode(1200, s, 'str');\n\treturn String.fromCharCode(255) + String.fromCharCode(254) + o;\n}\n\nfunction sheet_to_formulae(sheet/*:Worksheet*/, opts/*:?Sheet2FormulaOpts*/)/*:Array<string>*/ {\n\tvar y = \"\", x, val=\"\";\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar r = safe_decode_range(sheet['!ref']), rr = \"\", cols/*:Array<string>*/ = [], C;\n\tvar cmds/*:Array<string>*/ = [];\n\tvar dense = sheet[\"!data\"] != null;\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\ty = cols[C] + rr;\n\t\t\tx = dense ? (sheet[\"!data\"][R]||[])[C] : sheet[y];\n\t\t\tval = \"\";\n\t\t\tif(x === undefined) continue;\n\t\t\telse if(x.F != null) {\n\t\t\t\ty = x.F;\n\t\t\t\tif(!x.f) continue;\n\t\t\t\tval = x.f;\n\t\t\t\tif(y.indexOf(\":\") == -1) y = y + \":\" + y;\n\t\t\t}\n\t\t\tif(x.f != null) val = x.f;\n\t\t\telse if(opts && opts.values === false) continue;\n\t\t\telse if(x.t == 'z') continue;\n\t\t\telse if(x.t == 'n' && x.v != null) val = \"\" + x.v;\n\t\t\telse if(x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";\n\t\t\telse if(x.w !== undefined) val = \"'\" + x.w;\n\t\t\telse if(x.v === undefined) continue;\n\t\t\telse if(x.t == 's') val = \"'\" + x.v;\n\t\t\telse val = \"\"+x.v;\n\t\t\tcmds[cmds.length] = y + \"=\" + val;\n\t\t}\n\t}\n\treturn cmds;\n}\n\nfunction sheet_add_json(_ws/*:?Worksheet*/, js/*:Array<any>*/, opts)/*:Worksheet*/ {\n\tvar o = opts || {};\n\tvar dense = _ws ? (_ws[\"!data\"] != null) : o.dense;\n\tif(DENSE != null && dense == null) dense = DENSE;\n\tvar offset = +!o.skipHeader;\n\tvar ws/*:Worksheet*/ = _ws || ({});\n\tif(!_ws && dense) ws[\"!data\"] = [];\n\tvar _R = 0, _C = 0;\n\tif(ws && o.origin != null) {\n\t\tif(typeof o.origin == 'number') _R = o.origin;\n\t\telse {\n\t\t\tvar _origin/*:CellAddress*/ = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r; _C = _origin.c;\n\t\t}\n\t}\n\tvar range/*:Range*/ = ({s: {c:0, r:0}, e: {c:_C, r:_R + js.length - 1 + offset}}/*:any*/);\n\tif(ws['!ref']) {\n\t\tvar _range = safe_decode_range(ws['!ref']);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif(_R == -1) { _R = _range.e.r + 1; range.e.r = _R + js.length - 1 + offset; }\n\t} else {\n\t\tif(_R == -1) { _R = 0; range.e.r = js.length - 1 + offset; }\n\t}\n\tvar hdr/*:Array<string>*/ = o.header || [], C = 0;\n\tvar ROW = [];\n\tjs.forEach(function (JS, R/*:number*/) {\n\t\tif(dense && !ws[\"!data\"][_R + R + offset]) ws[\"!data\"][_R + R + offset] = [];\n\t\tif(dense) ROW = ws[\"!data\"][_R + R + offset];\n\t\tkeys(JS).forEach(function(k) {\n\t\t\tif((C=hdr.indexOf(k)) == -1) hdr[C=hdr.length] = k;\n\t\t\tvar v = JS[k];\n\t\t\tvar t = 'z';\n\t\t\tvar z = \"\";\n\t\t\tvar ref = dense ? \"\" : (encode_col(_C + C) + encode_row(_R + R + offset));\n\t\t\tvar cell/*:Cell*/ = dense ? ROW[_C + C] : ws[ref];\n\t\t\tif(v && typeof v === 'object' && !(v instanceof Date)){\n\t\t\t\tif(dense) ROW[_C + C] = v;\n\t\t\t\telse ws[ref] = v;\n\t\t\t} else {\n\t\t\t\tif(typeof v == 'number') t = 'n';\n\t\t\t\telse if(typeof v == 'boolean') t = 'b';\n\t\t\t\telse if(typeof v == 'string') t = 's';\n\t\t\t\telse if(v instanceof Date) {\n\t\t\t\t\tt = 'd';\n\t\t\t\t\tif(!o.UTC) v = local_to_utc(v);\n\t\t\t\t\tif(!o.cellDates) { t = 'n'; v = datenum(v); }\n\t\t\t\t\tz = (cell != null && cell.z && fmt_is_date(cell.z)) ? cell.z : (o.dateNF || table_fmt[14]);\n\t\t\t\t}\n\t\t\t\telse if(v === null && o.nullError) { t = 'e'; v = 0; }\n\t\t\t\tif(!cell) {\n\t\t\t\t\tif(!dense) ws[ref] = cell = ({t:t, v:v}/*:any*/);\n\t\t\t\t\telse ROW[_C + C] = cell = ({t:t, v:v}/*:any*/);\n\t\t\t\t} else {\n\t\t\t\t\tcell.t = t; cell.v = v;\n\t\t\t\t\tdelete cell.w; delete cell.R;\n\t\t\t\t\tif(z) cell.z = z;\n\t\t\t\t}\n\t\t\t\tif(z) cell.z = z;\n\t\t\t}\n\t\t});\n\t});\n\trange.e.c = Math.max(range.e.c, _C + hdr.length - 1);\n\tvar __R = encode_row(_R);\n\tif(dense && !ws[\"!data\"][_R]) ws[\"!data\"][_R] = [];\n\tif(offset) for(C = 0; C < hdr.length; ++C) {\n\t\tif(dense) ws[\"!data\"][_R][C + _C] = {t:'s', v:hdr[C]};\n\t\telse ws[encode_col(C + _C) + __R] = {t:'s', v:hdr[C]};\n\t}\n\tws['!ref'] = encode_range(range);\n\treturn ws;\n}\nfunction json_to_sheet(js/*:Array<any>*/, opts)/*:Worksheet*/ { return sheet_add_json(null, js, opts); }\n\n/* get cell, creating a stub if necessary */\nfunction ws_get_cell_stub(ws/*:Worksheet*/, R, C/*:?number*/)/*:Cell*/ {\n\t/* A1 cell address */\n\tif(typeof R == \"string\") {\n\t\tif(ws[\"!data\"] != null) {\n\t\t\tvar RC = decode_cell(R);\n\t\t\tif(!ws[\"!data\"][RC.r]) ws[\"!data\"][RC.r] = [];\n\t\t\treturn ws[\"!data\"][RC.r][RC.c] || (ws[\"!data\"][RC.r][RC.c] = {t:'z'});\n\t\t}\n\t\treturn ws[R] || (ws[R] = {t:'z'});\n\t}\n\t/* cell address object */\n\tif(typeof R != \"number\") return ws_get_cell_stub(ws, encode_cell(R));\n\t/* R and C are 0-based indices */\n\treturn ws_get_cell_stub(ws, encode_col(C||0) + encode_row(R));\n}\n\n/* find sheet index for given name / validate index */\nfunction wb_sheet_idx(wb/*:Workbook*/, sh/*:number|string*/) {\n\tif(typeof sh == \"number\") {\n\t\tif(sh >= 0 && wb.SheetNames.length > sh) return sh;\n\t\tthrow new Error(\"Cannot find sheet # \" + sh);\n\t} else if(typeof sh == \"string\") {\n\t\tvar idx = wb.SheetNames.indexOf(sh);\n\t\tif(idx > -1) return idx;\n\t\tthrow new Error(\"Cannot find sheet name |\" + sh + \"|\");\n\t} else throw new Error(\"Cannot find sheet |\" + sh + \"|\");\n}\n\n/* simple blank or single-sheet workbook object */\nfunction book_new(ws/*:?Worksheet*/, wsname/*:?string*/)/*:Workbook*/ {\n\tvar wb = { SheetNames: [], Sheets: {} };\n\tif(ws) book_append_sheet(wb, ws, wsname || \"Sheet1\");\n\treturn wb;\n}\n\n/* add a worksheet to the end of a given workbook */\nfunction book_append_sheet(wb/*:Workbook*/, ws/*:Worksheet*/, name/*:?string*/, roll/*:?boolean*/)/*:string*/ {\n\tvar i = 1;\n\tif(!name) for(; i <= 0xFFFF; ++i, name = undefined) if(wb.SheetNames.indexOf(name = \"Sheet\" + i) == -1) break;\n\tif(!name || wb.SheetNames.length >= 0xFFFF) throw new Error(\"Too many worksheets\");\n\tif(roll && wb.SheetNames.indexOf(name) >= 0 && name.length < 32) {\n\t\tvar m = name.match(/\\d+$/); // at this point, name length is capped at 32\n\t\ti = m && +m[0] || 0;\n\t\tvar root = m && name.slice(0, m.index) || name;\n\t\tfor(++i; i <= 0xFFFF; ++i) if(wb.SheetNames.indexOf(name = root + i) == -1) break;\n\t}\n\tcheck_ws_name(name);\n\tif(wb.SheetNames.indexOf(name) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\n\n\twb.SheetNames.push(name);\n\twb.Sheets[name] = ws;\n\treturn name;\n}\n\n/* set sheet visibility (visible/hidden/very hidden) */\nfunction book_set_sheet_visibility(wb/*:Workbook*/, sh/*:number|string*/, vis/*:number*/) {\n\tif(!wb.Workbook) wb.Workbook = {};\n\tif(!wb.Workbook.Sheets) wb.Workbook.Sheets = [];\n\n\tvar idx = wb_sheet_idx(wb, sh);\n\t// $FlowIgnore\n\tif(!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};\n\n\tswitch(vis) {\n\t\tcase 0: case 1: case 2: break;\n\t\tdefault: throw new Error(\"Bad sheet visibility setting \" + vis);\n\t}\n\t// $FlowIgnore\n\twb.Workbook.Sheets[idx].Hidden = vis;\n}\n\n/* set number format */\nfunction cell_set_number_format(cell/*:Cell*/, fmt/*:string|number*/) {\n\tcell.z = fmt;\n\treturn cell;\n}\n\n/* set cell hyperlink */\nfunction cell_set_hyperlink(cell/*:Cell*/, target/*:string*/, tooltip/*:?string*/) {\n\tif(!target) {\n\t\tdelete cell.l;\n\t} else {\n\t\tcell.l = ({ Target: target }/*:Hyperlink*/);\n\t\tif(tooltip) cell.l.Tooltip = tooltip;\n\t}\n\treturn cell;\n}\nfunction cell_set_internal_link(cell/*:Cell*/, range/*:string*/, tooltip/*:?string*/) { return cell_set_hyperlink(cell, \"#\" + range, tooltip); }\n\n/* add to cell comments */\nfunction cell_add_comment(cell/*:Cell*/, text/*:string*/, author/*:?string*/) {\n\tif(!cell.c) cell.c = [];\n\tcell.c.push({t:text, a:author||\"SheetJS\"});\n}\n\n/* set array formula and flush related cells */\nfunction sheet_set_array_formula(ws/*:Worksheet*/, range, formula/*:string*/, dynamic/*:boolean*/) {\n\tvar rng = typeof range != \"string\" ? range : safe_decode_range(range);\n\tvar rngstr = typeof range == \"string\" ? range : encode_range(range);\n\tfor(var R = rng.s.r; R <= rng.e.r; ++R) for(var C = rng.s.c; C <= rng.e.c; ++C) {\n\t\tvar cell = ws_get_cell_stub(ws, R, C);\n\t\tcell.t = 'n';\n\t\tcell.F = rngstr;\n\t\tdelete cell.v;\n\t\tif(R == rng.s.r && C == rng.s.c) {\n\t\t\tcell.f = formula;\n\t\t\tif(dynamic) cell.D = true;\n\t\t}\n\t}\n\tvar wsr = decode_range(ws[\"!ref\"]);\n\tif(wsr.s.r > rng.s.r) wsr.s.r = rng.s.r;\n\tif(wsr.s.c > rng.s.c) wsr.s.c = rng.s.c;\n\tif(wsr.e.r < rng.e.r) wsr.e.r = rng.e.r;\n\tif(wsr.e.c < rng.e.c) wsr.e.c = rng.e.c;\n\tws[\"!ref\"] = encode_range(wsr);\n\treturn ws;\n}\n\nvar utils/*:any*/ = {\n\tencode_col: encode_col,\n\tencode_row: encode_row,\n\tencode_cell: encode_cell,\n\tencode_range: encode_range,\n\tdecode_col: decode_col,\n\tdecode_row: decode_row,\n\tsplit_cell: split_cell,\n\tdecode_cell: decode_cell,\n\tdecode_range: decode_range,\n\tformat_cell: format_cell,\n\tsheet_new: sheet_new,\n\tsheet_add_aoa: sheet_add_aoa,\n\tsheet_add_json: sheet_add_json,\n\tsheet_add_dom: sheet_add_dom,\n\taoa_to_sheet: aoa_to_sheet,\n\tjson_to_sheet: json_to_sheet,\n\ttable_to_sheet: parse_dom_table,\n\ttable_to_book: table_to_book,\n\tsheet_to_csv: sheet_to_csv,\n\tsheet_to_txt: sheet_to_txt,\n\tsheet_to_json: sheet_to_json,\n\tsheet_to_html: sheet_to_html,\n\tsheet_to_formulae: sheet_to_formulae,\n\tsheet_to_row_object_array: sheet_to_json,\n\tsheet_get_cell: ws_get_cell_stub,\n\tbook_new: book_new,\n\tbook_append_sheet: book_append_sheet,\n\tbook_set_sheet_visibility: book_set_sheet_visibility,\n\tcell_set_number_format: cell_set_number_format,\n\tcell_set_hyperlink: cell_set_hyperlink,\n\tcell_set_internal_link: cell_set_internal_link,\n\tcell_add_comment: cell_add_comment,\n\tsheet_set_array_formula: sheet_set_array_formula,\n\tconsts: {\n\t\tSHEET_VISIBLE: 0,\n\t\tSHEET_HIDDEN: 1,\n\t\tSHEET_VERY_HIDDEN: 2\n\t}\n};\n\nvar _Readable;\nfunction set_readable(R) { _Readable = R; }\n\nfunction write_csv_stream(sheet/*:Worksheet*/, opts/*:?Sheet2CSVOpts*/) {\n\tvar stream = _Readable();\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar row/*:?string*/ = \"\", cols/*:Array<string>*/ = [];\n\tvar colinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo/*:Array<RowInfo>*/ = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\n\tvar R = r.s.r;\n\tvar BOM = false, w = 0;\n\tstream._read = function() {\n\t\tif(!BOM) { BOM = true; return stream.push(\"\\uFEFF\"); }\n\t\twhile(R <= r.e.r) {\n\t\t\t++R;\n\t\t\tif ((rowinfo[R-1]||{}).hidden) continue;\n\t\t\trow = make_csv_row(sheet, r, R-1, cols, fs, rs, FS, w, o);\n\t\t\tif(row != null) {\n\t\t\t\tif(row || (o.blankrows !== false)) return stream.push((w++ ? RS : \"\") + row);\n\t\t\t}\n\t\t}\n\t\treturn stream.push(null);\n\t};\n\treturn stream;\n}\n\nfunction write_html_stream(ws/*:Worksheet*/, opts/*:?Sheet2HTMLOpts*/) {\n\tvar stream = _Readable();\n\n\tvar o = opts || {};\n\tvar header = o.header != null ? o.header : HTML_BEGIN;\n\tvar footer = o.footer != null ? o.footer : HTML_END;\n\tstream.push(header);\n\tvar r = decode_range(ws['!ref']);\n\tstream.push(make_html_preamble(ws, r, o));\n\tvar R = r.s.r;\n\tvar end = false;\n\tstream._read = function() {\n\t\tif(R > r.e.r) {\n\t\t\tif(!end) { end = true; stream.push(\"</table>\" + footer); }\n\t\t\treturn stream.push(null);\n\t\t}\n\t\twhile(R <= r.e.r) {\n\t\t\tstream.push(make_html_row(ws, r, R, o));\n\t\t\t++R;\n\t\t\tbreak;\n\t\t}\n\t};\n\treturn stream;\n}\n\nfunction write_json_stream(sheet/*:Worksheet*/, opts/*:?Sheet2CSVOpts*/) {\n\tvar stream = _Readable({objectMode:true});\n\n\tif(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\n\tvar val = {t:'n',v:0}, header = 0, offset = 1, hdr/*:Array<any>*/ = [], v=0, vv=\"\";\n\tvar r = {s:{r:0,c:0},e:{r:0,c:0}};\n\tvar o = opts || {};\n\tvar range = o.range != null ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols/*:Array<string>*/ = [];\n\tvar counter = 0;\n\tvar dense = sheet[\"!data\"] != null;\n\tvar R = r.s.r, C = 0;\n\tvar header_cnt = {};\n\tif(dense && !sheet[\"!data\"][R]) sheet[\"!data\"][R] = [];\n\tvar colinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo/*:Array<RowInfo>*/ = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tif(((colinfo[C]||{}).hidden)) continue;\n\t\tcols[C] = encode_col(C);\n\t\tval = dense ? sheet[\"!data\"][R][C] : sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C - r.s.c; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val == null) val = {w: \"__EMPTY\", t: \"s\"};\n\t\t\t\tvv = v = format_cell(val, null, o);\n\t\t\t\tcounter = header_cnt[v] || 0;\n\t\t\t\tif(!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo { vv = v + \"_\" + (counter++); } while(header_cnt[vv]); header_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t}\n\t}\n\tR = r.s.r + offset;\n\tstream._read = function() {\n\t\twhile(R <= r.e.r) {\n\t\t\tif ((rowinfo[R-1]||{}).hidden) continue;\n\t\t\tvar row = make_json_row(sheet, r, R, cols, header, hdr, o);\n\t\t\t++R;\n\t\t\tif((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) {\n\t\t\t\tstream.push(row.row);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\treturn stream.push(null);\n\t};\n\treturn stream;\n}\n\nfunction write_xlml_stream(wb/*:Workbook*/, o/*:?Sheet2XLMLOpts*/) {\n\tvar stream = _Readable();\n\tvar opts = o == null ? {} : o;\n\tvar stride = +opts.stride || 10;\n\tif(!wb.SSF) wb.SSF = dup(table_fmt);\n\tif(wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t\topts.cellXfs = [];\n\t\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\t}\n\n\t/* do one pass to determine styles since they must be added before tables */\n\twb.SheetNames.forEach(function(n) {\n\t\tvar ws = wb.Sheets[n];\n\t\tif(!ws || !ws[\"!ref\"]) return;\n\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\tvar dense = ws[\"!data\"] != null;\n\t\tvar ddata = dense ? ws[\"!data\"] : [];\n\t\tvar addr = {r:0,c:0};\n\t\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\t\taddr.r = R;\n\t\t\tif(dense && !ddata[R]) continue;\n\t\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\taddr.c = C;\n\t\t\t\tvar cell = dense ? ddata[R][C] : ws[encode_col(C) + encode_row(R)];\n\t\t\t\tif(!cell) continue;\n\t\t\t\tif(cell.t == \"d\" && cell.z == null) { cell = dup(cell); cell.z = table_fmt[14]; }\n\t\t\t\tvoid get_cell_style(opts.cellXfs, cell, opts);\n\t\t\t}\n\t\t}\n\t});\n\tvar sty = write_sty_xlml(wb, opts);\n\n\tvar stage = 0, wsidx = 0, ws = wb.Sheets[wb.SheetNames[wsidx]], range = safe_decode_range(ws), R = -1, T = false;\n\n\tvar marr = [], mi = 0, dense = false, darr = [], addr = {r:0,c:0};\n\n\tstream._read = function() { switch(stage) {\n\t\t/* header */\n\t\tcase 0: {\n\t\t\tstage = 1;\n\t\t\tstream.push(XML_HEADER);\n\t\t\tstream.push(\"<Workbook\" + wxt_helper({\n\t\t\t\t'xmlns':      XLMLNS.ss,\n\t\t\t\t'xmlns:o':    XLMLNS.o,\n\t\t\t\t'xmlns:x':    XLMLNS.x,\n\t\t\t\t'xmlns:ss':   XLMLNS.ss,\n\t\t\t\t'xmlns:dt':   XLMLNS.dt,\n\t\t\t\t'xmlns:html': XLMLNS.html\n\t\t\t}) + \">\");\n\t\t} break;\n\n\t\t/* preamble */\n\t\tcase 1: {\n\t\t\tstage = 2;\n\t\t\tstream.push(write_props_xlml(wb, opts));\n\t\t\tstream.push(write_wb_xlml(wb, opts));\n\t\t} break;\n\n\t\t/* style and name tables */\n\t\tcase 2: {\n\t\t\tstage = 3;\n\t\t\tstream.push(sty);\n\t\t\tstream.push(write_names_xlml(wb, opts));\n\t\t} break;\n\n\t\t/* worksheet preamble */\n\t\tcase 3: {\n\t\t\tT = false;\n\t\t\tif(wsidx >= wb.SheetNames.length) { stage = -1; stream.push(\"\"); break; }\n\n\t\t\tstream.push(\"<Worksheet\" + wxt_helper({ \"ss:Name\": escapexml(wb.SheetNames[wsidx])}) + \">\");\n\n\t\t\tws = wb.Sheets[wb.SheetNames[wsidx]];\n\t\t\tif(!ws) { stream.push(\"</Worksheet>\"); return void ++wsidx; }\n\n\t\t\tvar names = write_ws_xlml_names(ws, opts, wsidx, wb);\n\t\t\tif(names.length) stream.push(\"<Names>\" + names + \"</Names>\");\n\n\t\t\tif(!ws[\"!ref\"]) return (stage = 5);\n\t\t\trange = safe_decode_range(ws[\"!ref\"]);\n\t\t\tR = range.s.r;\n\t\t\tstage = 4;\n\t\t} break;\n\n\t\t/* worksheet intramble */\n\t\tcase 4: {\n\t\t\tif(R < 0 || R > range.e.r) { if(T) stream.push(\"</Table>\"); return void (stage = 5); }\n\n\t\t\tif(R <= range.s.r) {\n\t\t\t\tif(ws['!cols']) ws['!cols'].forEach(function(n, i) {\n\t\t\t\t\tprocess_col(n);\n\t\t\t\t\tvar w = !!n.width;\n\t\t\t\t\tvar p = col_obj_w(i, n);\n\t\t\t\t\tvar k/*:any*/ = {\"ss:Index\":i+1};\n\t\t\t\t\tif(w) k['ss:Width'] = width2px(p.width);\n\t\t\t\t\tif(n.hidden) k['ss:Hidden']=\"1\";\n\t\t\t\t\tif(!T) { T = true; stream.push(\"<Table>\"); }\n\t\t\t\t\tstream.push(writextag(\"Column\",null,k));\n\t\t\t\t});\n\t\t\t\tdense = ws[\"!data\"] != null;\n\t\t\t\tif(dense) darr = ws[\"!data\"];\n\t\t\t\taddr.r = addr.c = 0;\n\t\t\t}\n\n\t\t\t/* process `stride` rows per invocation */\n\t\t\tfor(var cnt = 0; R <= range.e.r && cnt < stride; ++R, ++cnt) {\n\t\t\t\tvar row = [write_ws_xlml_row(R, (ws['!rows']||[])[R])];\n\t\t\t\taddr.r = R;\n\t\t\t\tif(!(dense && !darr[R])) for(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\t\taddr.c = C;\n\t\t\t\t\tvar skip = false;\n\t\t\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(skip) continue;\n\t\t\t\t\tvar ref = encode_col(C) + encode_row(R), cell = dense ? darr[R][C] : ws[ref];\n\t\t\t\t\trow.push(write_ws_xlml_cell(cell, ref, ws, opts, wsidx, wb, addr));\n\t\t\t\t}\n\t\t\t\trow.push(\"</Row>\");\n\t\t\t\tif(!T) { T = true; stream.push(\"<Table>\"); }\n\t\t\t\tstream.push(row.join(\"\"));\n\t\t\t}\n\t\t} break;\n\n\t\t/* worksheet postamble */\n\t\tcase 5: {\n\t\t\tstream.push(write_ws_xlml_wsopts(ws, opts, wsidx, wb));\n\t\t\tif(ws && ws[\"!autofilter\"]) stream.push('<AutoFilter x:Range=\"' + a1_to_rc(fix_range(ws[\"!autofilter\"].ref), {r:0,c:0}) + '\" xmlns=\"urn:schemas-microsoft-com:office:excel\"></AutoFilter>');\n\t\t\tstream.push(\"</Worksheet>\");\n\t\t\twsidx++; R = -1;\n\t\t\treturn void (stage = 3);\n\t\t}\n\n\t\t/* footer */\n\t\tcase -1: {\n\t\t\tstage = -2;\n\t\t\tstream.push(\"</Workbook>\");\n\t\t} break;\n\n\t\t/* exeunt */\n\t\tcase -2: stream.push(null); break;\n\t}};\n\treturn stream;\n}\n\nvar __stream = {\n\tto_json: write_json_stream,\n\tto_html: write_html_stream,\n\tto_csv: write_csv_stream,\n\tto_xlml: write_xlml_stream,\n\tset_readable: set_readable\n};\nexport const version = XLSX.version;\nexport {\n\tparse_xlscfb,\n\tparse_zip,\n\treadSync as read,\n\treadFileSync as readFile,\n\treadFileSync,\n\twriteSync as write,\n\twriteFileSync as writeFile,\n\twriteFileSync,\n\twriteFileAsync,\n\twriteSyncXLSX as writeXLSX,\n\twriteFileSyncXLSX as writeFileXLSX,\n\tutils,\n\tset_fs,\n\tset_cptable,\n\t__stream as stream,\n\tSSF,\n\tCFB\n};\nexport default {\n\tparse_xlscfb,\n\tparse_zip,\n\tread: readSync,\n\treadFile: readFileSync,\n\treadFileSync,\n\twrite: writeSync,\n\twriteFile: writeFileSync,\n\twriteFileSync,\n\twriteFileAsync,\n\twriteXLSX: writeSyncXLSX,\n\twriteFileXLSX: writeFileSyncXLSX,\n\tutils,\n\tset_fs,\n\tset_cptable,\n\tstream: __stream,\n\tSSF,\n\tCFB\n}\n","import * as XLSX from \"xlsx\";\n\n/**\n * Tabulator 테이블 데이터를 엑셀 파일로 다운로드하는 함수\n * @param {Object} tableInstance - Tabulator 테이블 인스턴스 (Tabulator 객체)\n * @param {string} tableStatus - 테이블 상태 (\"initializing\", \"ready\", \"error\")\n * @param {string} [fileName=\"table_data.xlsx\"] - 다운로드될 엑셀 파일 이름 (기본값: table_data.xlsx)\n * @param {string} [sheetName=\"Sheet1\"] - 엑셀 시트 이름 (기본값: Sheet1)\n */\nexport const handleDownloadExcel = (\n  tableInstance,\n  tableStatus,\n  fileName = \"table_data.xlsx\",\n  sheetName = \"Sheet1\"\n) => {\n  // 테이블 인스턴스와 상태 검증\n  // tableInstance가 없거나 상태가 \"ready\"가 아니면 실행 중단\n  if (!tableInstance || tableStatus !== \"ready\") {\n    console.error(\"Table instance not ready:\", tableInstance, tableStatus);\n    return;\n  }\n\n  try {\n    // 테이블에서 현재 데이터 가져오기\n    const data = tableInstance.getData();\n    // 데이터가 없거나 빈 배열이면 경고 후 중단\n    if (!data || data.length === 0) {\n      console.warn(\"No data available to download\");\n      return;\n    }\n\n    // 테이블의 컬럼 정의 가져오기\n    const columns = tableInstance.getColumns();\n    // 컬럼 제목 배열 생성 (예: [\"ID\", \"이름\", \"나이\", \"상태\"])\n    const headers = columns.map(col => col.getDefinition().title);\n    // 필드명 배열 생성 (예: [\"id\", \"name\", \"age\", \"status\"])\n    const fields = columns.map(col => col.getField());\n\n    // 엑셀용 2D 배열 생성\n    // 첫 번째 행은 헤더(컬럼 제목), 이후 행은 데이터\n    const aoaData = [\n      headers, // 헤더 행 추가\n      ...data.map(row => fields.map(field => row[field])), // 데이터 행 변환\n    ];\n\n    // 2D 배열을 워크시트로 변환\n    const worksheet = XLSX.utils.aoa_to_sheet(aoaData);\n    // 새 워크북 생성\n    const workbook = XLSX.utils.book_new();\n    // 워크시트를 워크북에 추가\n    XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);\n    // 엑셀 파일로 다운로드\n    XLSX.writeFile(workbook, fileName);\n  } catch (err) {\n    // 다운로드 중 예외 발생 시 에러 로깅\n    console.error(\"Excel download failed:\", err);\n  }\n};"],"names":["CoreFeature","table","data","silent","columnsChanged","force","key","value","oldOption","newOption","convert","msg","Helpers","el","box","separator","field","structure","length","output","i","obj","clone","list","objectProto","arrayProto","subject","match","copy","item","Popup$1","Popup","element","parent","container","callback","touch","x","y","parentOffset","position","offset","containerOffset","origin","parentEl","coords","e","scrollTop","offsetHeight","Module","name","func","args","component","handler","priority","adjust","index","lookupIndex","renderInPosition","menuEl","menuContainer","content","type","defaultAccessors","params","column","row","_Accessor","config","accessor","rowComponent","colComponent","__publicField","Accessor","defaultConfig","generateParamsList$1","prefix","serializeParams","encoded","urlBuilder","url","defaultLoaderPromise","contentType","resolve","reject","response","error","generateParamsList","defaultContentTypeFormatters","form","_Ajax","ajaxParams","previousData","ajaxConfig","Ajax","defaultPasteActions","defaultPasteParsers","clipboard","headerFindSuccess","columns","columnMap","rows","bindings$2","actions$2","extensions$4","_Clipboard","plain","html","rowData","col","range","internal","sel","textRange","action","parser","valid","blocked","Clipboard","CalcComponent","target","receiver","transform","cells","cell","CellComponent","mutate","Cell","vertAligns","hozAligns","classNames","className","val","containerOnly","changed","ColumnComponent","ifVisible","to","after","toColumn","nextCol","prevCol","updates","width","result","defaultColumnOptions","_Column","def","rowHeader","newCol","defaults","contentElement","titleHolderElement","titleElement","text","title","contents","dataObj","alignment","height","parentHeight","traverse","updateBranches","colDefs","visible","responsiveToggle","childWidth","child","minWidth","maxWidth","cellCount","setTo","definition","Column","RowComponent","Row","inFragment","children","maxHeight","minHeight","updatedData","tempData","newRowData","attrname","findCell","before","toRow","blockRedraw","defaultCalculations","values","calcParams","precision","sum","unique","_ColumnCalcs","viewable","fragment","left","groups","group","hasDataTreeColumnCalcs","dataTree","_a","dataRow","pos","calcs","paramKey","results","groupObj","subGroups","subGroupResults","subgroup","ColumnCalcs","DataTree","dummyEl","options","firstCol","childArray","isArray","oldControl","allChildren","sortOnly","subChildren","sub","childData","childRow","childIndex","top","recurse","csv$1","setFileContents","delimiter","fileContents","headers","json$2","pdf","header","body","autoTableParams","rowGroupStyles","rowCalcStyles","jsPDFParams","jspdfLib","doc","parseRow","styles","xlsx$1","self","sheetName","XLSXLib","workbook","tableFeatures","compression","writeOptions","generateSheet","merges","worksheet","a","b","j","sheet","s2ab","s","buf","view","html$1","jsonLines","defaultDownloaders","_Download","mimeType","filename","active","interceptCallback","downloadFunc","buildLink","mime","groupHeader","newTab","blob","Download","maskInput","mask","maskLetter","maskNumber","maskWildcard","fillSymbols","symbol","char","input","onRendered","success","cancel","editorParams","cellValue","onChange","textarea$1","vertNav","scrollHeight","heightNow","number$1","blurFunc","date$1","inputFormat","DT","convertDate","newDatetime","luxDate","time$1","luxTime","datetime$2","luxDateTime","Edit$1","editor","initialValue","cellEl","clickStop","listEl","attribs","valueKeys","valueCheck","character","iteration","responseValues","placeholder","term","inputValues","option","level","sorter","as","bs","a1","b1","L","rx","rd","emptyAlign","filterFunc","matches","label","startVis","blur","star$1","maxStars","size","stars","starsHolder","star","starChange","buildStar","starHolder","nextStar","changeValue","progress$1","max","min","percent","handle","bar","mouseDrag","mouseDragWidth","updateValue","style","calcVal","tickCross$1","tristate","indetermValue","indetermState","trueValueSet","falseValueSet","setValue","checkedValue","adaptable$1","lookup","editorFunc","defaultLookup","defaultEditors","_Edit","newRow","nextCell","prevRow","nextRow","prevCell","convertEmpty","block","forceEdit","topEdge","bottomEdge","rowEl","leftEdge","rightEdge","check","allowEdit","rendered","editFinished","cellEditor","mod","checkFunc","editIndex","Edit","ExportRow","indent","ExportColumn","depth","columnLookups$1","rowLookups$1","_Export","colVisProp","colLookup","rowLookup","colData","maxDepth","groupData","subGroup","subGroupData","visProp","headerDepth","exportRows","parseColumnGroup","exportCols","headerEl","bodyEl","rowFormatter","setup","cellStyle","styleProps","cellWrapper","formatComponent","holder","from","props","fromStyle","prop","Export","defaultFilters","filterVal","rowVal","filterParams","keywords","keyword","_Filter","all","filterType","filterChangeCheck","fieldVal","colVal","reinitialize","filterElement","editorElement","typingTimer","searchTrigger","onRenderedCallback","headerPos","filter","filters","ajax","filterList","searchType","activeRows","rowList","activeRowComponents","subFilter","Filter","plaintext","formatterParams","textarea","money","floatVal","sign","number","integer","decimal","rgx","decimalSym","thousandSym","negativeSign","link","urlPrefix","download","labelTraverse","path","image","src","tickCross","empty","truthy","tick","cross","datetime$1","outputFormat","invalid","datetimediff","suffix","unit","humanize","date","starActive","starInactive","traffic","colors","color","percentValue","progress","legendAlign","legend","legendColor","barEl","barContainer","legendEl","holderEl","buttonTick","buttonCross","toggle","sizePx","containEl","switchEl","onValue","offValue","state","rownum","adaptable","formatterFunc","formatter","array$2","valueMap","json$1","multiline","replacer","defaultFormatters","_Format","mockCell","entityMap","Format","FrozenColumns","allCells","leftParents","leftMargin","rightMargin","visibleRows","otherRows","FrozenRows","frozenRows","rowType","GroupComponent","Group","groupManager","generator","oldGroup","elementsOnly","arrow","toggleElement","groupID","groupKey","toIndex","count","prev","includeChildren","GroupRows","groupBy","startOpen","langValue","lang","cols","lookupFunc","prevValue","groupRows","groupValues","toGroup","fromGroup","groupComponents","groupList","groupListData","oldGroups","newGroupNeeded","oldRowGroup","oldGroupPath","newGroupPath","samePath","groupPath","groupId","onlyGroupHeaders","defaultUndoers","defaultRedoers","bindings$1","actions$1","extensions$3","_History","oldRow","History","HtmlTableImport","defaultOptions","attributes","optionsArr","optionsList","attrib","exists","csv","inQuote","nextChar","json","array$1","xlsx","workbook2","defaultImporters","_Import","err","importFormat","importer","extension","importReader","extensions","file","reader","parsedData","firstRow","Import","Interaction","types","added","noTouch","watchers","componentObj","defaultBindings","defaultActions","rowManager","newPos","scrollMax","_Keybindings","bindings","mergedBindings","binding","bindingList","symbolsList","symbols","code","Keybindings","Menu","icon","headerMenuEl","menu","parentPopup","popup","itemEl","disabled","MoveColumns","colEl","startXMove","nextColWidth","prevColWidth","nextColWidthLast","prevColWidthLast","diff","moveToCol","headerElement","headersElement","movingCells","columnHolder","scrollLeft","xPos","scrollPos","defaultSenders","fromRow","toTable","defaultReceivers","fromTable","_MoveRows","startYMove","nextRowHeight","prevRowHeight","nextRowHeightLast","prevRowHeightLast","moveToRow","pageX","pageY","rowHolder","yPos","connectionTables","query","dropEvent","sender","MoveRows","defaultMutators","_Mutator","mutator","links","linkCell","Mutator","pageSize","currentRow","currentPage","totalRows","totalPages","showingEl","valueEl","ofEl","totalEl","rowsEl","pages","defaultPageCounters","_Page","displayRows","testElRow","testElCell","dir","margin","button","pageSizes","counter","pageCounter","hidden","pageSelectLabel","paginationCounterHolder","mode","rowCount","page","leftSize","rightSize","actualRowPageSize","start","end","actualStartRow","actualRows","paginationOutOfRange","footer","Page","defaultReaders","id","cookie","cookiePos","defaultWriters","expireDate","_Persistence","testKey","retrievedData","sorters","headerFilters","layout","keys","newValue","current","oldCols","newCols","mergeAllNew","definitions","excludedKeys","defStore","colDef","Persistence","headerPopupEl","renderedCallback","contentsEl","Print","scrollX","scrollY","footerEl","tableEl","headerContent","footerContent","ReactiveData","version","arg","newRows","startRow","oldRows","childField","origFuncs","update","ResizeColumns","frozenOffset","variableHeight","nearestColumn","handleDown","oldWidth","handleEl","startDiff","moveDiff","blockedBefore","blockedAfter","colWidth","mouseX","handleX","tableX","columnX","mouseDiff","guideEl","mouseMove","mouseUp","ResizeRows","prevHandle","prevHandleDown","mouseY","handleY","tableY","rowY","ResizeTable","tableStyle","entry","nodeHeight","nodeWidth","entries","responsiveCollapse","toggleList","isOpen","collapseEl","extensions$2","ResponsiveLayout","colCount","working","mockCellComponent","titleData","valueData","node_content","titleHighlight","rowSelection","checkbox","extensions$1","SelectRow","prevSelected","selectable","endSelect","lastClickedRowIdx","rowIdx","fromRowIdx","toRowIdx","toggledRows","toggledRow","changes","rowMatch","change","rowInfo","selectedRow","selected","deselected","select","RangeComponent","Range","rangeManager","rowsCount","isRowHeader","_vDomTop","_vDomBottom","_vDomLeft","_vDomRight","bottom","right","topLeftCell","bottomRightCell","topLeftCellEl","bottomRightCellEl","topLeftRowEl","bottomRightRowEl","structured","arr","clearValue","notify","actions","pasteActions","singleCell","bounds","startCell","rowWidth","dataLength","pasteParsers","startCol","itemLength","columnLookups","rowLookups","SelectRange","frozenCols","ranges","selectedColumns","selectedColumn","_event","_to","_after","event","rangeIdx","jump","expand","moved","rangeEdge","prevRect","rowRect","rowManagerRect","columnRect","columnManagerRect","removed","reverse","emptyStart","emptySide","items","valueResolver","nextItem","currentItem","currentValue","rowPos","colPos","isStartingCellEmpty","isLeftOfStartingCellEmpty","targetCols","jumpCol","isRightOfStartingCellEmpty","isTopOfStartingCellEmpty","jumpRow","isBottomOfStartingCellEmpty","tableHolder","rect","withinHorizontalView","withinVerticalView","occupied","activeCell","activeCellEl","activeRowEl","colIdx","visibleCells","aRow","bRow","alignEmptyValues","thousand","string","locale","datetime","format","time","boolean","el1","el2","array","calc","c","d","alphanum","defaultSorters","_Sort","sortList","arrowEl","newSortList","sortListActual","rowComponents","sortObj","sortEl","sorterCount","sortItem","el1Comp","el2Comp","Sort","GridCalculator","SheetComponent","Sheet","spreadsheetManager","ref","refs","wasInactive","full","rowWidths","outputWidth","outputHeight","Spreadsheet","altContainer","data1","data2","sheets","prevSheet","Tooltip","tooltip","defaultValidators","parameters","reg","cellData","_Validate","previousValue","cancelled","validator","validators","failedValidators","invalidIndex","Validate","allModules","OptionsList","msgType","userOptions","warn","Renderer","includingBuffer","rowIndex","BasicHorizontal","rowFrag","VirtualDomHorizontal","buffer","old","colEnd","ex","newWidth","widthDiff","ColumnManager","renderClass","renderers","collProgress","rowSample","nextToColumn","topColumn","parentIndex","nextEl","root","fieldRoot","updateRows","fromIndex","totalWidth","fixedWidth","BasicVertical","tableFrag","rowTop","VirtualDomVertical","topRow","topOffset","topDiff","bottomDiff","topFound","bottomRow","forceMove","topPad","rowsHeight","rowHeight","heightOccupied","topPadHeight","rowFragment","renderedRows","totalRowsRendered","rowsToRender","fixedHeight","containerHeight","avgRowHeight","resized","fillableSpace","addedRows","paddingAdjust","initialized","removableRows","RowManager","leftDir","topDir","allIndex","activeIndex","displayIndex","refreshDisplayOnly","chainResult","rowOnly","skipStage","stage","cascadeOrder","chain","scrollbarWidth","initialHeight","otherHeight","FooterManager","InteractionManager","listenerMap","listener","leaveList","linkedKeys","listeners","components","comp","targets","componentMap","classList","elTargets","targetMatches","previousTarget","ComponentFunctionBinder","funcName","DataLoader","replace","requestNo","map","shouldLoad","ExternalEventBus","debug","subscribed","notifiers","callResult","InternalEventBus","fallback","subscriber","confirmed","DeprecationAdvisor","DependencyRegistry","dependency","fitData","forced","fitDataGeneral","fitDataStretch","colsWidth","tableWidth","gap","lastCol","fitColumns","flexWidth","flexGrowUnits","flexColWidth","flexColumns","fixedShrinkColumns","flexShrinkUnits","overflowWidth","gapFill","calcWidth","scaleColumns","freeSpace","shrinkCols","oversizeCols","oversizeSpace","remainingSpace","remainingFlexGrowUnits","changeUnits","undersizeCols","calcGrow","calcShrink","defaultModes","_Layout","dataChanged","Layout","defaultLangs","_Localize","desiredLocale","traverseLang","trans","fillPath","pathArray","rootPath","Localize","Comms","selectors","connections","connection","con","module","coreModules","_TableRegistry","TableRegistry","_ModuleBinder","defaultModules","property","source","modules","core","mods","modKey","ext","propKey","orderedStartMods","orderedEndMods","unOrderedMods","ModuleBinder","Alert","_Tabulator","newElement","ua","stack","line","responses","foundRows","fromColumn","plugin","required","Tabulator","Tabulator$1","TabulatorFull","TabulatorFull$1","createTable","customOptions","applyCellStyle","cellElement","styleKey","processedCols","originalFormatter","rest","XLSX","current_codepage","set_cp","cp","reset_cp","_getchar","_getansi","Base64_map","Base64_encode","o","c1","c2","c3","e1","e2","e3","e4","Base64_encode_pass","Base64_encode_arr","Base64_decode","has_buf","Buffer_from","nbfs","enc","buf_utf16le","new_raw_buf","len","new_unsafe_buf","s2a","a2s","a2u","bconcat","bufs","maxlen","utf8decode","out","widx","ridx","chr0","chr1","_strrev","pad0","v","fill","pad_","rpad_","pad0r1","pad0r2","p2_32","pad0r","SSF_isgeneral","days","months","SSF_init_table","t","table_fmt","SSF_default_map","SSF_default_str","SSF_frac","D","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","q","SSF_normalize_xl_unsafe","m","n","SSF_parse_date_code","opts","b2","dow","dout","SSF_fix_hijri","SSF_strip_decimal","SSF_normalize_exp","SSF_small_exp","w","SSF_large_exp","SSF_general_num","V","SSF_general","SSF_format","datenum","SSF_write_date","fmt","ss0","ss","tt","outl","outstr","commaify","pct1","write_num_pct","sfmt","mul","write_num","write_num_cm","idx","write_num_exp","period","ee","fakee","$$","$1","$2","$3","frac1","write_num_f1","aval","den","rr","base","myn","myd","write_num_f2","dec1","closeparen","phone","hashq","str","cc","rnd","dd","dec","_frac","carry","flr","write_num_flt","ffmt","r","ri","ff","oa","lres","rres","write_num_cm2","write_num_pct2","write_num_exp2","write_num_int","SSF_split_fmt","in_str","SSF_abstime","fmt_is_date","eval_fmt","flen","lst","dt","hr","bt","ssm","_dt","nstr","jj","vv","myv","ostr","decpt","lasti","retval","cfregex2","chkcond","thresh","choose_fmt","f","l","lat","m1","m2","SSF_load","SSF_load_table","tbl","make_ssf","dateNFregex","dateNF_regex","dateNF","dateNF_fix","Y","H","M","S","datestr","timestr","bad_formats","SSF__load","CRC32","signed_crc_table","T0","slice_by_16_tables","T","TT","T1","T2","T3","T4","T5","T6","T7","T8","T9","Ta","Tb","Tc","Td","Te","Tf","crc32_bstr","bstr","seed","C","crc32_buf","crc32_str","CFB","exports","namecmp","R","Z","dirname","p","write_dos_date","hms","ymd","parse_dos_date","parse_extra_field","prep_blob","flags","sz","tgt","sz1","sz2","fs","get_fs","_fs","parse","parse_zip","parse_mad","mver","ssz","nmfs","difat_sec_cnt","dir_start","minifat_start","difat_start","fat_addrs","mv","check_get_mver","check_shifts","dir_cnt","sectors","sectorify","sleuth_fat","sector_list","make_sector_list","ENDOFCHAIN","files","Paths","FileIndex","FullPaths","read_directory","build_full_paths","HEADER_SIGNATURE","shift","nsectors","FI","FP","pl","dad","get_mfat_entry","payload","mini","MSSZ","__readInt32LE","new_buf","cnt","sector","get_sector_list","chkd","buf_chain","modulus","addr","__toBuffer","sl","k","seen","minifat_store","namelen","__utf16le","ctime","read_date","mtime","__readUInt32LE","read_file","read","init_cfb","cfb","seed_cfb","nm","rebuild_cfb","gc","_file","now","fullPaths","HEADER_CLSID","elt","_write","_opts","write_mad","write_zip","mini_size","fat_size","mini_cnt","mfat_cnt","fat_base","fat_cnt","difat_cnt","HEADER_SIG","chainit","consts","_nm","find","UCFullPaths","UCPaths","UCPath","write_file","write","_zlib","use_zlib","zlib","InflateRaw","InflRaw","_inflateRawSync","usz","_inflate","_deflateRawSync","_deflate","CLEN_ORDER","LEN_LN","DST_LN","bit_swap_8","use_typed_arrays","bitswap8","bit_swap_n","rev","read_bits_2","bl","h","read_bits_3","read_bits_4","read_bits_5","read_bits_7","read_bits_n","write_bits_3","write_bits_1","write_bits_8","write_bits_16","realloc","zero_fill_array","build_tree","clens","cmap","MAX","ccode","bl_count","ctree","cleni","fix_lmap","fix_dmap","dlens","_deflateRaw","DST_LN_RE","LEN_LN_RE","write_stored","boff","write_huff_fixed","addrs","hash","mlen","len_eb","dst_eb","off","dyn_lmap","dyn_dmap","dyn_cmap","dyn_len_1","dyn_len_2","dyn","_HLIT","_HDIST","_HCLEN","next_code","hcodes","h1","h2","inflate","outbuf","woff","OL","max_len_1","max_len_2","bits","dst","warn_or_throw","wrn","fcnt","start_cd","csz","efsz","fcsz","EF","parse_local_file","meth","crc32","_csz","_usz","ef","cfb_add","cdirs","method","fp","fi","crcs","sz_cd","namebuf","ContentTypeMap","get_content_type","write_base64_76","write_quoted_printable","split","si","tmp","parse_quoted_printable","di","oi","parse_mime","fname","cte","ctype","fdata","mboundary","boundary","start_di","u","ca","cstr","dispcnt","csl","qp","cfb_new","unsafe","fpath","cfb_del","cfb_mov","old_name","new_name","cfb_gc","ReadShift","CheckField","blobify","write_dl","utf8write","b64","ks","o2","evert_key","K","evert","evert_num","evert_arr","dnthresh","dnthresh1","dnthresh2","date1904","epoch","res","numdate","pdre1","pdre2","pdre3","parseDate","cc2str","debomit","dup","fuzzynum","wt","FDRE1","FDRE2","FDISO","utc_append_works","fuzzytime1","fuzzytime2","lower_months","fuzzydate","local_to_utc","lower","lnos","utc_to_local","utc","local","zip_add_file","zip","zip_new","XML_HEADER","encodings","rencoding","decregex","charegex","escapexml","escapexmltag","htmlcharegex","escapehtml","escapexlml","xlml_unfixstr","parsexmlbool","utf8reada","orig","utf8readb","ww","utf8readc","utf8corpus","utf8read","htmldecode","entities","wtregex","writetag","g","wxt_helper","writextag","write_w3cdtf","write_vt","XMLNS","XMLNS_main","XLMLNS","read_double_le","write_double_le","av","___toBuffer","___utf16le","__readUInt16LE","___hexlify","__hexlify","___utf8","__readUInt8","__utf8","___lpstr","__lpstr","___cpstr","__cpstr","___lpwstr","__lpwstr","___lpp4","__lpp4","___8lpp4","__8lpp4","___double","__double","is_buf","__readInt16LE","__readInt32BE","oI","oR","oo","loc","__writeUInt32LE","__writeInt32LE","__writeUInt16LE","WriteShift","hexstr","fld","parsenoop","buf_array","blksz","newblk","curbuf","endbuf","next","end2","push","write_record","ba","XLSBRecordEnum","shift_cell_xls","shift_range_xls","encode_cell_xls","biff","encode_cell","fix_col","fix_row","encode_range_xls","encode_col","encode_row","decode_row","rowstr","unfix_row","decode_col","colstr","unfix_col","split_cell","decode_cell","decode_range","encode_range","cs","ce","fix_range","formula_quote_sheet_name","sname","safe_decode_range","safe_format_cell","format_cell","BErr","sheet_to_workbook","sheet_new","sheet_add_aoa","_ws","dense","ws","_R","_C","_origin","_range","__R","data_R","__C","cell_ref","aoa_to_sheet","parse_Int32LE","write_UInt32LE","parse_XLWideString","cchCharacters","write_XLWideString","_null","parse_StrRun","write_StrRun","run","parse_RichStr","rgsStrRun","z","dwSizeStrRun","write_RichStr","parse_BrtCommentText","write_BrtCommentText","parse_XLSBCell","iStyleRef","write_XLSBCell","parse_XLSBShortCell","write_XLSBShortCell","parse_XLSBCodeName","write_XLSBCodeName","parse_XLNullableWideString","write_XLNullableWideString","parse_XLNameWideString","parse_RelID","write_RelID","parse_RkNumber","fX100","fInt","RK","write_RkNumber","d100","parse_RfX","write_RfX","parse_UncheckedRfX","write_UncheckedRfX","parse_Xnum","write_Xnum","parse_BrtColor","xColorType","nTS","bR","bG","bB","icv","XLSIcv","rgb2Hex","write_BrtColor","rgb","parse_FontFlags","write_FontFlags","font","grbit","VT_I2","VT_I4","VT_BOOL","VT_UI4","VT_FILETIME","VT_BLOB","VT_CF","VT_VECTOR_VARIANT","VT_VECTOR_LPSTR","VT_STRING","DocSummaryPIDDSI","SummaryPIDSI","rgbify","_XLSIcv","RBErr","XLSLblBuiltIn","ct2type","CT_LIST","new_ct","write_ct","ct","raw","type2ct","f1","f2","f3","RELS","get_rels_path","write_rels","rels","rid","add_rels","rId","relobj","targetmode","write_manifest","manifest","write_rdf_type","tag","write_rdf_has","write_rdf","rdf","write_meta_ods","wb","CORE_PROPS","cp_doit","write_core_props","EXT_PROPS","PseudoPropsPairs","write_ext_props","W","write_cust_props","pid","XLMLDocPropsMap","xlml_write_docprops","Props","xlml_write_custprops","Custprops","BLACKLIST","write_FILETIME","write_TypedPropertyValue","XLSPSSkip","guess_property_type","write_PropertySet","RE","PIDSI","hdr","piao","pr","pio","pinfo","write_PropertySetStream","clsid","entries2","clsid2","ps0","ps1","writezeroes","parsebool","writebool","parseuint16","writeuint16","write_Bes","parse_ShortXLUnicodeString","cch","encoding","fHighByte","write_XLUnicodeRichExtendedString","xlstr","otext","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","write_XLUnicodeString","write_HyperlinkString","write_Hyperlink","hl","Target","hashidx","F","Pretarget","write_XLSCell","ixfe","parse_XTI","iSupBook","itabFirst","itabLast","parse_Ref8U","rwFirst","rwLast","colFirst","colLast","write_Ref8U","write_BOF","write_WriteAccess","b8","write_BoundSheet8","write_SST","sst","strs","write_Window1","write_Window2","write_Font","b5","write_LabelSst","os","write_Label","write_Format","write_BIFF2Format","write_BIFF4Format","write_Dimensions","write_XF","ixfeP","write_BIFF2XF","xf","write_BIFF3XF","write_BIFF4XF","write_Guts","guts","write_BoolErr","write_Number","parse_ExternSheet","parse_BIFF5ExternSheet","write_NOTE_BIFF2","write_MergeCells","write_HLink","O","write_HLinkTooltip","write_Country","parse_ColInfo","coldx","write_ColInfo","write_RRTabId","write_BIFF2Cell","ifmt","write_BIFF2NUM","write_BIFF2INT","DBF","dbf_codepage_map","dbf_reverse_map","dbf_to_aoa","ft","memo","vfp","l7","nrow","fpos","rlen","fields","hend","hi","lo","dbf_to_sheet","dbf_to_workbook","_RLEN","sheet_to_dbf","old_cp","aoa","sheet_to_json","hcnt","coltypes","colwidths","coldecimals","guess","_guess","hf","_f","hb","rout","_n","_l","_s","SYLK","sylk_escapes","sylk_char_regex","sylk_char_fn","_","decode_sylk_char","newcc","encode_sylk_str","sylk_to_aoa","sylk_to_aoa_str","records","rj","formats","next_cell_format","sht","rowinfo","colinfo","cw","Mval","rstr","record","RT","d1904","nn","rc_to_a1","C_seen_K","C_seen_X","C_seen_S","C_seen_E","formula","cell_t","cmnt","shrbase","shift_formula_str","F_seen","pt2px","process_col","sylk_to_workbook","aoasht","outwb","write_ws_cell_sylk","a1_to_rc","write_ws_cmnt_sylk","write_ws_cols_sylk","rec","width2px","px2char","write_ws_rows_sylk","px2pt","sheet_to_sylk","preamble","RS","_lastfmt","DIF","dif_to_aoa","dif_to_aoa_str","metadata","dif_to_sheet","dif_to_workbook","make_value","make_value_str","sheet_to_dif","ETH","decode","encode","eth_to_aoa","eth_to_sheet","eth_to_workbook","sep","meta","sheet_to_eth_data","coord","sheet_to_eth","PRN","set_text_arr","prn_to_aoa_str","lines","guess_seps","guess_sep_weights","guess_sep","instr","dsv_to_sheet_str","sepcc","startcc","_re","finish_cell","fuzzyfmla","news","outer","prn_to_sheet_str","prn_to_sheet","bytes","firstbyte","prn_to_workbook","sheet_to_prn","WK_","lotushopper","cb","Enum","WK1Enum","lotus_to_workbook","lotus_to_workbook_buf","LOTUS_DATE_FMTS","next_n","sidx","snames","realnames","sdata","refguess","sheetRows","lastcell","qpw_to_workbook_buf","tmpcell","WK3Enum","osheets","rnames","sheet_to_wk1","write_biff_rec","write_BOF_WK1","write_RANGE","max_R","write_INTEGER","write_NUMBER","dc","write_LABEL","book_to_wk3","write_BOF_WK3","write_XFORMAT_SHEETNAME","wsidx","write_NUMBER_17","write_LABEL_16","wscnt","parse_RANGE","parse_cell","get_wk1_fmt","parse_LABEL","parse_STRING","parse_INTEGER","parse_NUMBER","parse_FORMULA","wk1_fmla_to_csf","wk1_parse_rc","rel","FuncTab","BinOpTab","argc","argL","argR","parse_cell_3","parse_LABEL_16","parse_NUMBER_18","parse_NUMBER_17","v1","v2","parse_FORMULA_19","parse_NUMBER_25","parse_NUMBER_27","parse_FORMULA_28","parse_SHEETNAMECS","parse_SHEETNAMELP","parse_SHEETINFOQP","parse_XFORMAT","QPWNFTable","parse_qpw_str","SST","FMTS","step","book_append_sheet","CC","fmtidx","delta","newcell","straywsregex","write_sst_xml","sitag","parse_BrtBeginSst","write_BrtBeginSst","write_BrtSSTItem","write_sst_bin","_JS2ANSI","crypto_CreatePasswordVerifier_Method1","Password","Verifier","PasswordArray","PasswordDecoded","PasswordByte","Intermediate1","Intermediate2","Intermediate3","sheet_to_rtf","DEF_MDW","MDW","px","char2width","chr","coll","DEF_PPI","PPI","pt","write_numFmts","NF","write_cellXfs","cellXfs","write_sty_xml","parse_BrtFmt","numFmtId","stFmtCode","write_BrtFmt","parse_BrtFont","bls","underline","family","bCharSet","write_BrtFont","sss","scheme","XLSBFillPTNames","rev_XLSBFillPTNames","parse_BrtFill","write_BrtFill","fls","parse_BrtXF","ixfeParent","write_BrtXF","flow","write_Blxf","parse_BrtBorder","write_BrtBorder","border","write_BrtStyle","write_BrtBeginTableStyles","defTableStyle","defPivotStyle","write_FMTS_bin","write_FONTS_bin","write_FILLS_bin","write_BORDERS_bin","write_CELLSTYLEXFS_bin","write_CELLXFS_bin","write_STYLES_bin","write_DXFS_bin","write_TABLESTYLES_bin","write_sty_bin","write_theme","Themes","parse_BrtMdtinfo","write_BrtMdtinfo","parse_BrtMdb","write_BrtMdb","mdb","write_BrtBeginEsfmd","parse_BrtBeginEsmdb","write_BrtBeginEsmdb","cm","write_xlmeta_bin","write_xlmeta_xml","parse_BrtCalcChainItem$","write_vml","comments","csize","bbox","_shapeid","_comments","write_vml_comment","fillopts","fillparm","fillxml","shadata","write_comments_xml","iauthor","lastauthor","ts","tcnt","write_tcmnt_xml","people","carr","rootid","tcopts","write_people_xml","person","parse_BrtBeginComment","rfx","write_BrtBeginComment","parse_BrtCommentAuthor","write_BrtCommentAuthor","write_comments_bin","comment","_ia","fill_vba_xls","vba","newpath","VBAFMTS","rcregex","rcbase","rcfunc","cRel","rRel","fstr","crefregex","$0","$4","$5","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceArea_BIFF2","parse_RgceAreaRel","parse_RgceLoc","parse_RgceLoc_BIFF2","parse_RgceElfLoc","parse_RgceLocRel","parse_RgceLocRel_BIFF2","cl","rl","parse_PtgArea","area","parse_PtgArea3d","ixti","parse_PtgAreaErr","parse_PtgAreaErr3d","parse_PtgAreaN","parse_PtgArray","parse_PtgAttrBaxcel","bitSemi","bitBaxcel","parse_PtgAttrChoose","parse_PtgAttrGoto","bitGoto","parse_PtgAttrIf","bitIf","parse_PtgAttrIfError","parse_PtgAttrSemi","parse_PtgAttrSpaceType","parse_PtgAttrSpace","parse_PtgAttrSpaceSemi","parse_PtgRef","parse_PtgRefN","parse_PtgRef3d","parse_PtgFunc","iftab","FtabArgc","Ftab","parse_PtgFuncVar","cparams","tab","parsetab","Cetab","parse_PtgAttrSum","parse_PtgExp","parse_PtgErr","parse_PtgInt","parse_PtgBool","parse_PtgNum","parse_PtgStr","parse_SerAr","parse_PtgExtraMem","cce","parse_PtgExtraArray","parse_PtgName","nameindex","parse_PtgNameX","parse_PtgNameX_BIFF5","parse_PtgMemArea","parse_PtgMemFunc","parse_PtgRefErr","parse_PtgRefErr3d","parse_PtgMemErr","parse_PtgMemNoMem","parse_PtgTbl","parse_PtgElfLoc","parse_PtgElfNoop","parse_PtgElfCol","parse_PtgElfColS","parse_PtgElfColSV","parse_PtgElfColV","parse_PtgElfLel","parse_PtgElfRadical","parse_PtgElfRadicalLel","parse_PtgElfRadicalS","parse_PtgElfRw","parse_PtgElfRwV","PtgListRT","parse_PtgList","rt","parse_PtgSxName","parse_PtgSheet","parse_PtgEndSheet","parse_PtgMemAreaN","parse_PtgMemNoMemN","parse_PtgAttrNoop","PtgTypes","PtgDupes","Ptg18","Ptg19","parse_RgbExtra","rgce","parse_Rgce","ptgs","stringify_array","PtgBinOp","make_3d_range","get_ixti_raw","supbooks","XTI","get_ixti","ixtiraw","stringify_formula","nameidx","last_sp","sp","fflen","lbl","bookidx","externbook","ixtidata","lp","rp","parsedf","fnd","PtgNonDisp","_left","write_FormulaValue","write_Formula","o1","o3","bf","parse_XLSBParsedFormula","rgcb","parse_XLSBArrayParsedFormula","parse_XLSBCellParsedFormula","parse_XLSBNameParsedFormula","parse_XLSBSharedParsedFormula","write_XLSBFormulaNum","oint","num","write_XLSBFormulaErr","write_XLSBFormulaBool","write_XLSBFormulaStr","postamble","write_XLSBFormulaRef","write_XLSBFormulaRef3D","lastbang","write_XLSBFormulaRefErr3D","write_XLSBFormulaRange","_str","parts","write_XLSBFormulaRangeWS","write_XLSBFormulaArea3D","write_XLSBFormula","write_XLSBNameParsedFormula","csf_to_ods_formula","csf_to_ods_3D","browser_has_Map","get_sst_id","revarr","col_obj_w","wch","default_margins","margins","defs","get_cell_style","check_ws","write_ws_xml_merges","write_ws_xml_sheetpr","needed","cname","outlineprops","sheetprot_deffalse","sheetprot_deftrue","write_ws_xml_protection","write_ws_xml_margins","write_ws_xml_cols","write_ws_xml_autofilter","names","write_ws_xml_sheetviews","sview","write_ws_xml_cell","oldt","oldv","_vv","write_ws_xml_data","_cell","write_ws_xml","rdata","_drawing","relc","parse_BrtRowHdr","miyRw","write_BrtRowHdr","ncolspan","lcs","caddr","first","last","write_row_header","parse_BrtWsDim","write_BrtWsDim","parse_BrtWsFmtInfo","parse_BrtWsProp","write_BrtWsProp","parse_BrtCellBlank","write_BrtCellBlank","ncell","parse_BrtShortBlank","write_BrtShortBlank","parse_BrtCellBool","fBool","write_BrtCellBool","parse_BrtShortBool","write_BrtShortBool","parse_BrtCellError","bError","write_BrtCellError","parse_BrtShortError","write_BrtShortError","parse_BrtCellIsst","isst","write_BrtCellIsst","parse_BrtShortIsst","write_BrtShortIsst","parse_BrtCellReal","write_BrtCellReal","parse_BrtShortReal","write_BrtShortReal","parse_BrtCellRk","write_BrtCellRk","parse_BrtShortRk","write_BrtShortRk","parse_BrtCellRString","parse_BrtCellSt","write_BrtCellSt","parse_BrtShortSt","write_BrtShortSt","parse_BrtFmlaBool","parse_BrtFmlaError","parse_BrtFmlaNum","parse_BrtFmlaString","parse_BrtMergeCell","write_BrtMergeCell","write_BrtBeginMergeCells","parse_BrtHLink","relId","display","write_BrtHLink","locidx","parse_BrtPane","parse_BrtArrFmla","fAlwaysCalc","parse_BrtShrFmla","write_BrtColInfo","BrtMarginKeys","parse_BrtMargins","write_BrtMargins","parse_BrtBeginWsView","write_BrtBeginWsView","Workbook","write_BrtCellIgnoreEC","write_BrtSheetProtection","parse_BrtDVal","parse_BrtDVal14","write_ws_bin_cell","last_seen","write_CELLTABLE","cap","write_MERGECELLS","write_COLINFOS","write_IGNOREECS","write_HLINKS","write_LEGACYDRAWING","write_AUTOFILTER","write_WSVIEWS2","write_SHEETPROTECT","write_ws_bin","parse_BrtCsProp","WBPropsDef","safe1904","badchars","check_ws_name","safe","check_wb_names","N","codes","cn","check_wb","Sheets","DN","dn","write_wb_xml","write_names","workbookPr","parse_BrtBundleSh","write_BrtBundleSh","parse_BrtWbProp","strName","write_BrtWbProp","parse_BrtName","itab","write_BrtName","dname","write_BUNDLESHS","viz","write_BrtFileVersion","write_BrtBookView","write_BOOKVIEWS","vistab","write_BRTNAMES","write_SELF_EXTERNS_xlsb","write_EXTERNALS_xlsb","write_wb_bin","write_props_xlml","write_wb_xlml","write_sty_xlml","write_name_xlml","write_names_xlml","write_ws_xlml_names","write_ws_xlml_wsopts","write_ws_xlml_comment","write_ws_xlml_cell","attr","marr","mi","_v","write_ws_xlml_row","write_ws_xlml_table","skip","write_ws_xlml","write_xlml","PSCLSID","write_xls_props","DSEntries","SEntries","CEntries","Keys","DocSummaryRE","SummaryRE","CEntries2","write_xlscfb","wbpath","write_biff_buf","write_biff_continue","write_BIFF2BERR","write_BIFF2LABEL","write_comments_biff2","write_ws_biff2_cell","write_ws_biff2","write_biff2_buf","b8oid","b8ocnts","write_MsoDrawingGroup","acc","write_comments_biff8","notes","baseid","_oasc","ci","author","oasc","oact","txo","cont","conf","notesh","write_FONTS_biff8","write_FMTS_biff8","write_FEAT","write_CELLXFS_biff8","write_ws_biff8_hlinks","HL","write_ws_cols_biff8","write_ws_biff8_cell","write_ws_biff8","_WB","_sheet","MAX_ROWS","write_biff8_global","_sheets","_wb","blen","write_biff8_buf","fix_write_opts","make_html_row","CS","HTML_BEGIN","HTML_END","make_html_preamble","sheet_to_html","sheet_add_dom","or_R","or_C","midx","is_dom_element_hidden","elts","_t","Aelts","Aelti","parse_dom_table","table_to_book","get_computed_style","get_get_computed_style_function","write_styles_ods","master_styles","write_number_format_ods","nf","nfidx","nopts","has_time","np","write_names_ods","Names","SheetNames","scoped","namei","odsref","write_content_ods","write_text_p","span","null_cell_xml","write_ws","nfs","ROWS","textp","_Fref","text_p","_tgt","acreator","apayload","aprops","write_automatic_styles_ods","cidx","colobj","nfi","fods","write_ods","subarray","u8_to_dataview","u8str","u8","stru8","u8concat","u8a","writeDecimal128LE","exp","mantissa","parse_varint49","ptr","varint","write_varint49","parse_packed_varints","write_packed_varints","nums","varint_to_i32","i32","parse_shallow","write_shallow","proto","mappa","parse_iwa_file","ai","fl","write_iwa_file","ias","ia","midata","aipayload","mid","parse_snappy_chunk","chunks","clen","u8i","decompress_iwa_file","compress_iwa_file","frame","write_new_storage","lut","dv","irsst","s5s_to_iwa_comment","write_old_storage","parse_TSP_Reference","pb","write_TSP_Reference","numbers_add_oref","iwa","orefs","orefidx","numbers_del_oref","s5s","write_TST_TileRowInfo","wide","_b","_c","tri","new_7","new_4","last_offset","cell_storage","_dv","_last_offset","_cell_storage","celload","_celload","write_iwam","get_unique_msgid","dep","dependents","build_numbers_deps","indices","packet","mess","write_TSP_Color_RGB","get_author_color","write_numbers_iwa","deps","docroot","numbers_iwa_find","sheetrefs","numbers_add_ws","write_numbers_ws","numbers_iwa_doit","ainfo","numbers_add_meta","mlist","newid","newloc","numbers_add_msg","numbers_meta_add_dep","parentidx","mm","dep2","numbers_meta_del_dep","sheetref","newsheetref","remap","arch","tiaref","sheetroot","sa","drawables","tia","tmaref","tiaroot","da","dap","oldtmaref","tma","tmaroot","uuid","new_uuid","srrta","hsoa","hsa","hseadata","hsea","ref2","store","_a2","oldref","newref","row_headers","tspref","tiles","tst","oldtileref","newtileref","oldtile","wsname","sheetidx","rootref","write_numbers_tma","tmafile","trunc","R_","LUT","row_header_ref","rowhead","_x","base_bucket","R2","_bucket","col_header_ref","colhead","rbtree","tilestore","tstride","tileref","save_token","mlst","ntiles","tidx","newtileid","tiledata","tilerow","newtile","tilecontent","mergeid","sstref","sstroot","sstdata","rsstref","rsstroot","rsstdata","style_indices","rsst","tswpsa","tswpsaid","tswpsarefs","newhlinkid","smartfield","rtpaid","cmntref","authors","cmntroot","cmntdata","replies","aaaid2","csaid2","aaaid","csaid","fix_opts_func","write_zip_xlsb","wbext","vbafmt","_sn","_i","wsrels","_type","need_vml","cf","needtc","write_zip_xlsx","write_cfb_ctr","write_zip_type","write_zip_denouement","oopts","ftype","write_cfb_type","write_string_type","bom","write_stxt_type","write_binary_type","writeSync","sheet_to_txt","sheet_to_csv","resolve_book_type","_BT","writeFileSync","make_json_row","defval","isempty","outi","header_cnt","qreg","make_csv_row","rs","FS","txt","datarow","sheet_to_formulae","cmds","sheet_add_json","js","ROW","JS","json_to_sheet","ws_get_cell_stub","RC","wb_sheet_idx","sh","book_new","roll","book_set_sheet_visibility","vis","cell_set_number_format","cell_set_hyperlink","cell_set_internal_link","cell_add_comment","sheet_set_array_formula","dynamic","rng","rngstr","wsr","utils","handleDownloadExcel","tableInstance","tableStatus","fileName","aoaData","XLSX.utils","XLSX.writeFile"],"mappings":"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MAAO,CAAEA,GAAG,GAAI,IAAKA,GAAG,EAAG,IAAIA,EAAE,GAAG,CAAG,CAAC,CAAG,CAIrJ,IAAI8yD,GAAwBD,GAAO,CAElC,EACA,SACA,SACA,MACA,IACA,SACA,SACA,MAGA,EACA,SACA,SACA,MACA,IACA,SACA,SACA,MAEA,QACA,MACA,IACA,QACA,QACA,MACA,SACA,QACA,SACA,SACA,SACA,SACA,QACA,SACA,MACA,SAEA,IACA,SACA,SACA,MACA,QACA,QACA,MACA,IACA,MACA,SACA,SACA,SACA,SACA,SACA,SACA,SAEA,QACA,QACA,SACA,SACA,SACA,SACA,QACA,QACA,MACA,QACA,MACA,QACA,SACA,SACA,QACA,QAGA,EACA,SACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,CACD,CAAC,EACGpB,GAAsB9L,GAAImN,EAAO,EAGjCpF,GAAO,CACV,EAAM,SACN,EAAM,UACN,GAAM,UACN,GAAM,QACN,GAAM,SACN,GAAM,QACN,GAAM,OACN,GAAM,gBACN,IAAM,OACP,EAEIqF,GAAQ,CACX,SAAiB,EACjB,UAAiB,EACjB,UAAiB,GACjB,QAAiB,GACjB,SAAiB,GACjB,QAAiB,GACjB,OAAiB,GACjB,gBAAiB,GACjB,QAAiB,GAClB,EAEIC,GAAgB,CACnB,yBACA,kBACA,mBACA,gBACA,iBACA,iBACA,mBACA,qBACA,iBACA,kBACA,sBACA,wBACA,oBACA,uBACD,EAMIC,GAAgC,CAEnC,6EAA8E,YAC9E,uDAAwD,YACxD,0DAA2D,YAC3D,uDAAwD,YACxD,gFAAiF,YAGjF,4EAA6E,SAC7E,qCAAsC,SACtC,sCAAuC,OAGvC,6EAA8E,SAC9E,sCAAuC,SAGvC,0CAA2C,SAC3C,sCAAuC,SACvC,0CAA2C,OAC3C,sCAAuC,OAGvC,8EAA+E,UAC/E,uCAAwC,UAGxC,gFAAiF,OACjF,yCAA0C,OAG1C,yEAA0E,SAC1E,kCAAmC,SAGnC,6DAA8D,YAC9D,sEAAuE,YACvE,wEAAyE,WAGzE,wEAA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,IAAK,gBACL,IAAK,eACL,IAAK,iBACL,IAAK,kBACL,IAAK,cACL,IAAK,qBACL,IAAK,SACL,IAAK,cACL,IAAK,WACL,IAAK,WACL,IAAK,eACL,IAAK,eACL,IAAK,iBACL,IAAK,eACL,IAAK,kBACL,IAAK,qBACL,IAAK,aACL,IAAK,YACL,IAAK,YACL,IAAK,gBACL,IAAK,cACL,IAAK,eACL,IAAK,kBACL,IAAK,oBACL,IAAK,kBACL,IAAK,iBACL,IAAK,UACL,IAAK,YACL,IAAK,YACL,IAAK,aACL,IAAK,cACL,IAAK,UACL,IAAK,SACL,IAAK,cACL,IAAK,UACL,IAAK,oBACL,IAAK,kBACL,IAAK,QACL,IAAK,aACL,IAAK,YACL,IAAK,cACL,IAAK,mBACL,IAAK,oBACL,IAAK,cACL,IAAK,cACL,IAAK,mBACL,IAAK,eACL,IAAK,aACL,IAAK,eACL,IAAK,gBACL,IAAK,aACL,IAAK,cACL,IAAK,cACL,IAAK,iBACL,IAAK,YACL,IAAK,cACL,IAAK,eACL,IAAK,aACL,IAAK,aACL,IAAK,gBACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,qBACL,IAAK,WACL,IAAK,OACL,IAAK,gBACL,IAAK,kBACL,IAAK,aACL,IAAK,aACL,IAAK,eACL,IAAK,iBACL,IAAK,cACL,IAAK,iBACL,IAAK,qBACL,IAAK,YACL,IAAK,oBACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,WACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,mBACL,IAAK,iBACL,IAAK,eACL,IAAK,cACL,IAAK,YACL,IAAK,kBACL,IAAK,oBACL,IAAK,iBACL,IAAK,YACL,IAAK,aACL,IAAK,oBACL,IAAK,aACL,IAAK,eACL,IAAK,iBACL,IAAK,kBACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,qBACL,IAAK,mBACL,IAAK,qBACL,IAAK,yBACL,IAAK,cACL,IAAK,aACL,IAAK,mBACL,IAAK,sBACL,IAAK,eACL,IAAK,eACL,IAAK,gBACL,IAAK,cACL,IAAK,kBACL,IAAK,cACL,IAAK,gBACL,IAAK,kBACL,IAAK,2BACL,IAAK,eACL,IAAK,iBACL,IAAK,aACL,IAAK,iBACL,IAAK,YACL,IAAK,mBACL,IAAK,cACL,IAAK,wBACL,IAAK,kBACL,IAAK,qBACL,IAAK,kBACL,IAAK,kBACL,IAAK,kBACL,IAAK,qBACL,IAAK,aACL,IAAK,iBACL,IAAK,eACL,IAAK,mBACL,IAAK,aACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,iBACL,IAAK,uBACL,IAAK,0BACL,IAAK,iBACL,IAAK,eACL,IAAK,YACL,IAAK,cACL,IAAK,aACL,IAAK,iBACL,IAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,qBACL,IAAK,cACL,IAAK,mBACL,IAAK,uBACL,IAAK,mBACL,IAAK,kBACL,IAAK,mBACL,IAAK,cACL,IAAK,iBACL,IAAK,kBACL,IAAK,eACL,IAAK,eACL,IAAK,oBACL,IAAK,sBACL,IAAK,sBACL,IAAK,mBACL,IAAK,qBACL,IAAK,qBACL,IAAK,gBACL,IAAK,aACL,IAAK,YACL,IAAK,cACL,IAAK,mBACL,IAAK,gBACL,IAAK,wBACL,IAAK,qBACL,IAAK,SACL,IAAK,kBACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,mBACL,IAAK,mBACL,IAAK,oBACL,IAAK,eACL,IAAK,oBACL,IAAK,uBACL,IAAK,cACL,IAAK,WACL,IAAK,WACL,IAAK,aACL,IAAK,aACL,IAAK,eACL,IAAK,eACL,IAAK,cACL,IAAK,qBACL,IAAK,yBACL,IAAK,mBACL,IAAK,WACL,IAAK,iBACL,IAAK,iBACL,IAAK,eACL,IAAK,YACL,IAAK,mBACL,IAAK,mBACL,IAAK,iBACL,IAAK,kBACL,IAAK,oBACL,IAAK,mBACL,IAAK,cACL,IAAK,gBACL,IAAK,WACL,IAAK,YACL,IAAK,cACL,IAAK,cACL,IAAK,mBACL,IAAK,oBACL,IAAK,iBACL,IAAK,YACL,IAAK,SACL,IAAK,SACL,IAAK,gBACL,IAAK,mBACL,IAAK,iBACL,IAAK,WACL,IAAK,gBACL,IAAK,gBACL,IAAK,cACL,IAAK,iBACL,IAAK,iBACL,IAAK,oBACL,IAAK,sBACL,IAAK,aACL,IAAK,cACL,IAAK,cACL,IAAK,oBACL,IAAK,eACL,IAAK,gBACL,IAAK,mBACP,EACIL,GAAO,CACT,EAAG,QACH,EAAG,KACH,EAAG,OACH,EAAG,UACH,EAAG,MACH,EAAG,UACH,EAAG,MACH,EAAG,MACH,EAAG,MACH,EAAG,SACH,GAAI,KACJ,GAAI,MACJ,GAAI,QACJ,GAAI,SACJ,GAAI,QACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,OACJ,GAAI,KACJ,GAAI,OACJ,GAAI,MACJ,GAAI,KACJ,GAAI,QACJ,GAAI,MACJ,GAAI,MACJ,GAAI,OACJ,GAAI,QACJ,GAAI,SACJ,GAAI,QACJ,GAAI,OACJ,GAAI,MACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,QACJ,GAAI,MACJ,GAAI,KACJ,GAAI,MACJ,GAAI,MACJ,GAAI,SACJ,GAAI,OACJ,GAAI,WACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,MACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,QACJ,GAAI,SACJ,GAAI,SACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,KACJ,GAAI,KACJ,GAAI,OACJ,GAAI,MACJ,GAAI,OACJ,GAAI,OACJ,GAAI,MACJ,GAAI,OACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,UACJ,GAAI,OACJ,GAAI,SACJ,GAAI,SACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,UACJ,GAAI,SACJ,GAAI,SACJ,GAAI,SACJ,GAAI,WACJ,GAAI,SACJ,GAAI,YACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,GAAI,OACJ,GAAI,WACJ,GAAI,SACJ,GAAI,QACJ,GAAI,UACJ,GAAI,SACJ,GAAI,YACJ,GAAI,cACJ,GAAI,YACJ,GAAI,SACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,IAAK,SACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,cACL,IAAK,WACL,IAAK,YACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,UACL,IAAK,aACL,IAAK,OACL,IAAK,QACL,IAAK,YACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,IACL,IAAK,IACL,IAAK,QACL,IAAK,SACL,IAAK,QACL,IAAK,UACL,IAAK,QACL,IAAK,WACL,IAAK,SACL,IAAK,OACL,IAAK,YACL,IAAK,YACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,WACL,IAAK,OACL,IAAK,UACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,gBACL,IAAK,iBACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,iBACL,IAAK,aACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,aACL,IAAK,MACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,WACL,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,OACL,IAAK,WACL,IAAK,gBACL,IAAK,aACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,WACL,IAAK,OACL,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,WACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,MACL,IAAK,OACL,IAAK,UACL,IAAK,SACL,IAAK,WACL,IAAK,SACL,IAAK,aACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,gBACL,IAAK,WACL,IAAK,aACL,IAAK,cACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,WACL,IAAK,OACL,IAAK,QACL,IAAK,aACL,IAAK,KACL,IAAK,QACL,IAAK,SACL,IAAK,YACL,IAAK,cACL,IAAK,iBACL,IAAK,OACL,IAAK,gBACL,IAAK,WACL,IAAK,cACL,IAAK,WACL,IAAK,iBACL,IAAK,aACL,IAAK,YACL,IAAK,eACL,IAAK,eACL,IAAK,cACL,IAAK,aACL,IAAK,cACL,IAAK,eACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,UACL,IAAK,YACL,IAAK,UACL,IAAK,SACL,IAAK,SACL,IAAK,aACL,IAAK,YACL,IAAK,OACL,IAAK,YACL,IAAK,QACL,IAAK,OACL,IAAK,SACL,IAAK,YACL,IAAK,QACL,IAAK,YACL,IAAK,WACL,IAAK,UACL,IAAK,cACL,IAAK,cACL,IAAK,SACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,UACL,IAAK,WACL,IAAK,cACL,IAAK,MACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,SACL,IAAK,QACL,IAAK,WACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,MACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,aACL,IAAK,cACL,IAAK,OACL,IAAK,WACL,IAAK,OACL,IAAK,gBACL,IAAK,YACL,IAAK,cACL,IAAK,QACL,IAAK,iBACL,IAAK,kBACL,IAAK,kBACL,IAAK,iBACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,oBACL,IAAK,QACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,QACL,IAAK,cACL,IAAK,cACL,IAAK,WACL,IAAK,eACL,IAAK,YACL,IAAK,WACL,IAAK,WACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,WACL,IAAK,gBACL,IAAK,YACL,IAAK,kBACL,IAAK,eACL,IAAK,gBACL,IAAK,mBACL,IAAK,cACL,IAAK,gBACL,IAAK,cACL,IAAK,WACL,IAAK,MACL,IAAK,YACL,IAAK,aACL,IAAK,qBACL,IAAK,mBACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,UACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,aACL,IAAK,cACL,IAAK,YACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,YACL,IAAK,YACL,IAAK,aACL,IAAK,SACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,MACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,OACL,IAAK,OACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,WACL,IAAK,OACL,IAAK,YACL,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,YACL,IAAK,WACL,IAAK,aACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,cACL,IAAK,UACL,IAAK,YACL,IAAK,WACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,UACL,IAAK,cACL,IAAK,MACL,IAAK,cACL,IAAK,MACL,IAAK,aACL,IAAK,gBACL,IAAK,UACL,IAAK,eACL,IAAK,UACL,IAAK,WACL,IAAK,SACL,IAAK,YACL,IAAK,YACP,EACID,GAAW,CACb,EAAG,EACH,EAAG,EACH,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IA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","x_google_ignoreList":[0,2]}