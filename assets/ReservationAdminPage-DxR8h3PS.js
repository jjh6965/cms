import{b as je,u as $e,h as J,r as I,j as o,f as pe,c as he,d as ge}from"./index-NQW_x_Sn.js";import{C as ze}from"./CommonPopup-Dwp1i3fD.js";import{i as Ie,M as ke,T as Ue}from"./TableSearch-D0PWM4AW.js";import{h as Be,c as He}from"./tableExcel-h_9-hs2N.js";import{s as C}from"./TableSearch.module-DFltd_EQ.js";import{e as g}from"./errorMsgPopup-CX9GGfgq.js";import{m as Re}from"./msgPopup-B5uV-LHr.js";import"./DatePickerCommon-MvAA8I6u.js";import"./react-datepicker-D9fc_BLh.js";import"./index-BBx72Rax.js";const Se={editor:"input",editable:!0},We={editor:"number",editorParams:{min:0},editable:!0},Ce=h=>({editor:"list",editorParams:{values:h,autocomplete:!0},editable:!0}),Ge=(h,x,L)=>({formatter:F=>{const T=document.createElement("button");return T.className=`btn btn-sm ${x}`,T.innerText=h,T.onclick=()=>L(F.getData()),T}}),G=(h,x,L,F)=>{const T=`${h.getRow().getData().ROOM_ID}`,Q=h.getValue();setTimeout(()=>{L(j=>j.map($=>{if($.ROOM_ID===T){const _={...$,[x]:Q};return _.isDeleted==="N"&&_.isAdded==="N"&&(_.isChanged="Y"),_}return $})),F.current&&F.current.redraw()},0)},Xe=h=>({ROOM_TYPE:[{value:"",label:"전체"},{value:"1인실",label:"1인실"},{value:"2인실",label:"2인실"},{value:"4인실",label:"4인실"},{value:"8인실",label:"8인실"}]})[h]||[],y={"1인실":1,"2인실":2,"4인실":4,"8인실":8},de=h=>{const x=y[h]||1;return x===1?{colSpan:1,rowSpan:1}:x===2?{colSpan:2,rowSpan:1}:x===4?{colSpan:2,rowSpan:2}:x===8?{colSpan:2,rowSpan:4}:{colSpan:1,rowSpan:1}},ot=()=>{const{user:h}=je(),x=$e(),L={areas:[{type:"search",fields:[{id:"FLOOR_ID",type:"text",row:1,label:"층 ID",labelVisible:!0,placeholder:"층 ID 검색 (예: 1F)",width:"200px",height:"30px",backgroundColor:"#ffffff",color:"#000000",enabled:J(h==null?void 0:h.auth,"admin")},{id:"SECTION",type:"text",row:1,label:"섹션",labelVisible:!0,placeholder:"섹션 검색 (예: A)",width:"150px",height:"30px",backgroundColor:"#ffffff",color:"#000000",enabled:J(h==null?void 0:h.auth,"admin")},{id:"ROOM_TYPE",type:"select",row:2,label:"호실 유형",labelVisible:!0,options:Xe("ROOM_TYPE"),width:"200px",height:"30px",backgroundColor:"#ffffff",color:"#000000",enabled:J(h==null?void 0:h.auth,"admin")}]},{type:"buttons",fields:[{id:"searchBtn",type:"button",row:1,label:"검색",eventType:"search",width:"80px",height:"30px",backgroundColor:"#00c4b4",color:"#ffffff",enabled:!0}]}]},F=[{id:"filterSelect",label:"",type:"select",options:[{value:"",label:"선택"},{value:"ROOM_ID",label:"호실 ID"},{value:"FLOOR_ID",label:"층 ID"},{value:"SECTION",label:"섹션"},{value:"ROOM_TYPE",label:"호실 유형"},{value:"PRICE",label:"호실 가격"},{value:"STATUS",label:"상태"}]},{id:"filterText",label:"",type:"text",placeholder:"찾을 내용을 입력하세요",width:"200px"}],[T,Q]=I.useState(Ie(L.areas.find(e=>e.type==="search").fields)),[j,$]=I.useState(Ie(F)),[_,X]=I.useState(!1),[M,E]=I.useState([]),[ue,De]=I.useState(!1),[v,ee]=I.useState("initializing"),[Te,te]=I.useState(!1),[Ke,Ee]=I.useState(1),[me,xe]=I.useState(0),[z,le]=I.useState([]),[O,V]=I.useState(""),[Oe,P]=I.useState({}),[ne,N]=I.useState({}),se=I.useRef(null),R=I.useRef(null),re=I.useRef(!0),[u,Y]=I.useState({FLOOR_ID:"",SECTION:"",ROOM_TYPE:"1인실",PRICE:0,ROOM_INDEX:1}),[S,w]=I.useState({isDragging:!1,startCell:null,endCell:null,section:null}),[m,fe]=I.useState(""),_e=[{frozen:!0,headerHozAlign:"center",hozAlign:"center",title:"작업",field:"actions",width:80,visible:!0,...Ge("삭제",`btn-danger ${C.deleteButton}`,e=>we(e))},{frozen:!0,headerHozAlign:"center",hozAlign:"center",title:"작업대상",field:"applyTarget",sorter:"string",width:100,formatter:e=>{const t=e.getRow().getData();let l="",i="";if(t.isDeleted==="Y"?(l="삭제",i="isDeleted"):t.isAdded==="Y"?(l="추가",i="isAdded"):t.isChanged==="Y"&&(l="변경",i="isChanged"),!l)return"";const n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.gap="5px";const a=document.createElement("input");a.type="checkbox",a.checked=t[i]==="Y",a.onclick=()=>{setTimeout(()=>{E(f=>f.map(c=>{if(c.ROOM_ID===t.ROOM_ID){const s={...c,[i]:a.checked?"Y":"N"};return i==="isDeleted"&&!a.checked&&(s.isChanged="N"),i==="isAdded"&&!a.checked?null:s}return c}).filter(Boolean))},0)};const r=document.createElement("span");return r.innerText=l,n.appendChild(a),n.appendChild(r),n}},{headerHozAlign:"center",hozAlign:"center",title:"호실 ID",field:"ROOM_ID",sorter:"string",width:120},{headerHozAlign:"center",hozAlign:"center",title:"층 ID",field:"FLOOR_ID",sorter:"string",width:100,...Se,cellEdited:e=>G(e,"FLOOR_ID",E,R)},{headerHozAlign:"center",hozAlign:"center",title:"섹션",field:"SECTION",sorter:"string",width:80,...Se,cellEdited:e=>G(e,"SECTION",E,R)},{headerHozAlign:"center",hozAlign:"center",title:"호실 유형",field:"ROOM_TYPE",sorter:"string",width:120,...Ce(["1인실","2인실","4인실","8인실"]),cellEdited:e=>G(e,"ROOM_TYPE",E,R)},{headerHozAlign:"center",hozAlign:"center",title:"호실 가격",field:"PRICE",sorter:"number",width:120,...We,cellEdited:e=>G(e,"PRICE",E,R)},{headerHozAlign:"center",hozAlign:"center",title:"상태",field:"STATUS",sorter:"string",width:100,...Ce(["사용 가능","사용 중"]),cellEdited:e=>G(e,"STATUS",E,R)},{headerHozAlign:"center",hozAlign:"center",title:"생성일시",field:"CREATE_DATE",sorter:"string",width:150},{headerHozAlign:"center",hozAlign:"center",title:"수정일시",field:"UPDATE_DATE",sorter:"string",width:150}],oe=async()=>{X(!0),De(!0);try{const e={p_FLOOR_ID:T.FLOOR_ID||"",p_SECTION:T.SECTION||"",p_DEBUG:"F"},t=await pe(he,`${ge.getServerUrl("reservation/layout/list")}`,e,{timeout:3e4});if(!t.success){g(t.errMsg||"레이아웃 데이터를 가져오는 중 오류가 발생했습니다."),E([]);return}const l=Array.isArray(t.data)?t.data.map(r=>({ROOM_ID:r.ROOM_ID||`${r.FLOOR_ID}${r.SECTION}${r.ROOM_INDEX||1}`,FLOOR_ID:r.FLOOR_ID||"",SECTION:r.SECTION||"",ROOM_TYPE:["1인실","2인실","4인실","8인실"].includes(r.ROOM_TYPE)?r.ROOM_TYPE:"1인실",PRICE:r.PRICE||0,CREATE_DATE:r.CREATE_DATE||new Date().toLocaleString("ko-KR",{timeZone:"Asia/Seoul"}),UPDATE_DATE:r.UPDATE_DATE||new Date().toLocaleString("ko-KR",{timeZone:"Asia/Seoul"}),STATUS:r.STATUS||"사용 가능",isDeleted:"N",isChanged:"N",isAdded:"N",col:Math.min(Math.max(r.col||0,0),1),row:Math.min(Math.max(r.row||0,0),3),...de(["1인실","2인실","4인실","8인실"].includes(r.ROOM_TYPE)?r.ROOM_TYPE:"1인실")})):[];E(l);const i=[...new Set(l.map(r=>r.FLOOR_ID))].filter(Boolean);le(i),i.length>0&&!O&&V(i[0]||"");const n=i.reduce((r,f)=>(r[f]={A:[],B:[],C:[]},l.filter(c=>c.FLOOR_ID===f&&c.isDeleted!=="Y").forEach(c=>{r[f][c.SECTION].push(c.ROOM_TYPE)}),r),{});P(n);const a=i.reduce((r,f)=>(r[f]={A:[],B:[],C:[]},l.filter(c=>c.FLOOR_ID===f&&c.isDeleted!=="Y").forEach(c=>{const s=c.ROOM_TYPE,{colSpan:p,rowSpan:D}=de(s);r[f][c.SECTION].push({roomType:s,col:c.col,row:c.row,colSpan:s==="8인실"?2:p,rowSpan:s==="8인실"?4:D,size:y[s],orientation:p>D?"horizontal":"vertical"})}),r),{});N(a)}catch(e){console.error("데이터 로드 실패:",e),g(`데이터 로드 실패: ${e.message||"서버 응답 없음"}`),E([])}finally{X(!1)}};I.useEffect(()=>{!h||!J(h.auth,"menuManage")?x("/"):oe()},[h,x]),I.useEffect(()=>((async()=>{if(await new Promise(t=>setTimeout(t,1e3)),!se.current){console.warn("테이블 컨테이너가 준비되지 않았습니다.");return}try{R.current=He(se.current,_e,[],{selectable:!0,selectableRangeMode:"click",rowFormatter:t=>{const l=t.getData(),i=t.getElement();i.classList.remove("tabulator-selected",C.addedRow,C.editedRow),l.isDeleted==="Y"?(t.select(),i.style.backgroundColor="#ffcccc"):l.isAdded==="Y"?(i.classList.add(C.addedRow),i.style.backgroundColor="#d4edda"):l.isChanged==="Y"&&i.classList.add(C.editedRow)}}),ee("ready")}catch(t){ee("error"),console.error("테이블 초기화 실패:",t.message)}})(),()=>{R.current&&(R.current.destroy(),R.current=null,ee("initializing"))}),[]),I.useEffect(()=>{if(re.current){re.current=!1;return}const e=R.current;!e||v!=="ready"||_||(e.setData(M),ue&&M.length===0&&!_?e.alert("검색 결과 없음","info"):(e.clearAlert(),xe(e.getDataCount())))},[M,v,_,ue]),I.useEffect(()=>{if(re.current||!R.current||v!=="ready"||_)return;const{filterSelect:e,filterText:t}=j;t&&e?R.current.setFilter(e,"like",t):t?t!==""?R.current.setFilter([{field:"ROOM_ID",type:"like",value:t},{field:"FLOOR_ID",type:"like",value:t},{field:"SECTION",type:"like",value:t},{field:"ROOM_TYPE",type:"like",value:t},{field:"PRICE",type:"like",value:t},{field:"STATUS",type:"like",value:t}],"or"):R.current.clearFilter():e&&R.current.clearFilter()},[j,v,_]),I.useEffect(()=>{if(S.isDragging&&O){const{startCell:e,endCell:t,section:l}=S;if(e&&t){const i=Math.min(e.col,t.col),n=Math.max(e.col,t.col),a=Math.min(e.row,t.row),r=Math.max(e.row,t.row);N(f=>{var c,s;return{...f,[O]:{...f[O],[l]:((s=(c=f[O])==null?void 0:c[l])==null?void 0:s.map(p=>p.col>=i&&p.col<=n&&p.row>=a&&p.row<=r?{...p,isDragging:!0}:p))||[]}}})}}},[S,O]);const be=e=>{e==="search"&&oe()},Ae=()=>te(!0),Me=()=>{if(!u.FLOOR_ID||!u.SECTION||!u.ROOM_TYPE){g("층 ID, 섹션, 호실 유형은 필수 입력 항목입니다.");return}if(!u.FLOOR_ID.match(/^[0-9]+F$/)){g("층 ID는 1F, 2F 등의 형식이어야 합니다.");return}if(!["A","B","C"].includes(u.SECTION)){g("섹션은 A, B, C 중 하나여야 합니다.");return}if(u.PRICE<0){g("호실 가격은 0 이상이어야 합니다.");return}const t=M.filter(s=>s.FLOOR_ID===u.FLOOR_ID&&s.SECTION===u.SECTION&&s.isDeleted!=="Y"&&s.STATUS!=="사용 중").reduce((s,p)=>s+(y[p.ROOM_TYPE||"1인실"]||0),0),l=y[u.ROOM_TYPE]||0;if(t+l>8){g(`${u.SECTION} 섹션의 총 호실 크기가 8을 초과할 수 없습니다. 현재 합계: ${t}`);return}const i=M.filter(s=>s.FLOOR_ID===u.FLOOR_ID&&s.SECTION===u.SECTION&&s.isDeleted!=="Y"&&s.STATUS!=="사용 중").map(s=>parseInt(s.ROOM_ID.replace(`${s.FLOOR_ID}${s.SECTION}`,""))||0),n=Math.max(0,...i)+1,a=`${u.FLOOR_ID}${u.SECTION}${n}`,{colSpan:r,rowSpan:f}=de(u.ROOM_TYPE),c={ROOM_ID:a,FLOOR_ID:u.FLOOR_ID,SECTION:u.SECTION,ROOM_TYPE:u.ROOM_TYPE,PRICE:u.PRICE,CREATE_DATE:new Date().toISOString().slice(0,19).replace("T"," "),UPDATE_DATE:new Date().toISOString().slice(0,19).replace("T"," "),STATUS:"사용 가능",col:0,row:0,colSpan:r,rowSpan:f,isDeleted:"N",isChanged:"N",isAdded:"Y"};E(s=>[c,...s]),P(s=>{var p;return{...s,[u.FLOOR_ID]:{...s[u.FLOOR_ID]||{A:[],B:[],C:[]},[u.SECTION]:[...((p=s[u.FLOOR_ID])==null?void 0:p[u.SECTION])||[],u.ROOM_TYPE]}}}),N(s=>{var p;return{...s,[u.FLOOR_ID]:{...s[u.FLOOR_ID]||{A:[],B:[],C:[]},[u.SECTION]:[...((p=s[u.FLOOR_ID])==null?void 0:p[u.SECTION])||[],{roomType:u.ROOM_TYPE,col:0,row:0,colSpan:r,rowSpan:f,size:y[u.ROOM_TYPE],orientation:r>f?"horizontal":"vertical"}]}}}),Ee(s=>s+1),te(!1),Y({FLOOR_ID:"",SECTION:"",ROOM_TYPE:"1인실",PRICE:0,ROOM_INDEX:1})},Ne=()=>{te(!1),Y({FLOOR_ID:"",SECTION:"",ROOM_TYPE:"1인실",PRICE:0,ROOM_INDEX:1})},we=e=>{if(!e||!e.ROOM_ID){g("삭제할 데이터가 없습니다.");return}if(e.STATUS==="사용 중"){g("사용 중인 호실은 삭제할 수 없습니다.");return}const t=R.current;if(t){const l=t.getRows().find(i=>i.getData().ROOM_ID===e.ROOM_ID);l&&l.select()}E(l=>l.map(i=>i.ROOM_ID===e.ROOM_ID?{...i,isDeleted:"Y",isChanged:i.isAdded==="Y"?"N":"Y"}:i)),P(l=>{var i,n;return{...l,[e.FLOOR_ID]:{...l[e.FLOOR_ID],[e.SECTION]:((n=(i=l[e.FLOOR_ID])==null?void 0:i[e.SECTION])==null?void 0:n.filter((a,r)=>{var f,c;return r!==((c=(f=l[e.FLOOR_ID])==null?void 0:f[e.SECTION])==null?void 0:c.indexOf(e.ROOM_TYPE||"1인실"))}))||[]}}}),N(l=>{var i,n;return{...l,[e.FLOOR_ID]:{...l[e.FLOOR_ID],[e.SECTION]:((n=(i=l[e.FLOOR_ID])==null?void 0:i[e.SECTION])==null?void 0:n.filter(a=>!(a.col===e.col&&a.row===e.row)))||[]}}})},ye=()=>{if(!m){g("층 ID를 입력해주세요.");return}if(!m.match(/^[0-9]+F$/)){g("층 ID는 1F, 2F 등의 형식이어야 합니다.");return}if(z.includes(m)){g("이미 존재하는 층 ID입니다.");return}le([...z,m]),V(m),P(e=>({...e,[m]:{A:[],B:[],C:[]}})),N(e=>({...e,[m]:{A:[],B:[],C:[]}})),fe(""),Re(`새로운 층 ${m}가 추가되었습니다.`)},Fe=()=>{if(!m){g("삭제할 층 ID를 입력해주세요.");return}if(!m.match(/^[0-9]+F$/)){g("층 ID는 1F, 2F 등의 형식이어야 합니다.");return}if(!z.includes(m)){g("입력한 층 ID가 존재하지 않습니다.");return}if(M.some(t=>t.FLOOR_ID===m&&t.STATUS==="사용 중")){g("사용 중인 층은 삭제할 수 없습니다.");return}E(t=>t.map(l=>l.FLOOR_ID===O&&l.isDeleted!=="Y"&&l.STATUS!=="사용 중"?{...l,isDeleted:"Y",isChanged:l.isAdded==="Y"?"N":"Y"}:l)),P(t=>{const l={...t};return delete l[O],l}),N(t=>{const l={...t};return delete l[O],l}),le(t=>t.filter(l=>l!==O)),V(z.find(t=>t!==O)||"")},ve=(e,t,l)=>{if(!O){g("층을 먼저 선택하세요.");return}if(M.some(n=>n.FLOOR_ID===O&&n.SECTION===e&&n.col===t&&n.row===l&&n.STATUS==="사용 중")){g("사용 중인 호실은 수정할 수 없습니다.");return}w({isDragging:!0,startCell:{col:t,row:l},endCell:{col:t,row:l},section:e})},Le=(e,t)=>{S.isDragging&&O&&w(l=>({...l,endCell:{col:Math.min(Math.max(e,0),1),row:Math.min(Math.max(t,0),3)}}))},Pe=()=>{var U,B,H,W;if(!S.isDragging||!O)return;const{startCell:e,endCell:t,section:l}=S,i=Math.min(e.col,t.col),n=Math.max(e.col,t.col),a=Math.min(e.row,t.row),r=Math.max(e.row,t.row);let f=n-i+1,c=r-a+1;const s=f*c;if(![1,2,4,8].includes(s)){g("선택한 셀 크기는 1, 2, 4, 8 중 하나여야 합니다."),w({isDragging:!1,startCell:null,endCell:null,section:null});return}let p,D,b;if(s===1)p="1인실",D=1,b=1;else if(s===2)if(p="2인실",f===1&&c===2)D=1,b=2;else if(f===2&&c===1)D=2,b=1;else{g("2인실은 1x2 또는 2x1 형식이어야 합니다."),w({isDragging:!1,startCell:null,endCell:null,section:null});return}else if(s===4)if(p="4인실",f===1&&c===4)D=1,b=4;else if(f===2&&c===2)D=2,b=2;else{g("4인실은 1x4 또는 2x2 형식이어야 합니다."),w({isDragging:!1,startCell:null,endCell:null,section:null});return}else s===8&&(p="8인실",D=2,b=4);const k=((B=(U=Oe[O])==null?void 0:U[l])==null?void 0:B.reduce((d,A)=>d+(y[A||"1인실"]||0),0))||0;if(k+s>8){g(`${l} 섹션의 총 크기가 8을 초과할 수 없습니다. (현재: ${k})`),w({isDragging:!1,startCell:null,endCell:null,section:null});return}if((W=(H=ne[O])==null?void 0:H[l])==null?void 0:W.some(d=>{const A=d.col+(d.colSpan||1)-1,ce=d.row+(d.rowSpan||1)-1;return!(n<d.col||i>A||r<d.row||a>ce)})){g("이미 다른 호실이 배치된 위치입니다."),w({isDragging:!1,startCell:null,endCell:null,section:null});return}const K=M.filter(d=>d.FLOOR_ID===O&&d.SECTION===l&&d.isDeleted!=="Y"&&d.STATUS!=="사용 중").map(d=>parseInt(d.ROOM_ID.replace(`${O}${l}`,""))||0),Z=Math.max(0,...K)+1,q={ROOM_ID:`${O}${l}${Z}`,FLOOR_ID:O,SECTION:l,ROOM_TYPE:p,PRICE:0,CREATE_DATE:new Date().toISOString().slice(0,19).replace("T"," "),UPDATE_DATE:new Date().toISOString().slice(0,19).replace("T"," "),STATUS:"사용 가능",col:i,row:a,colSpan:D,rowSpan:b,isDeleted:"N",isChanged:"N",isAdded:"Y"};E(d=>[q,...d]),P(d=>{var A;return{...d,[O]:{...d[O],[l]:[...((A=d[O])==null?void 0:A[l])||[],p]}}}),N(d=>{var A;return{...d,[O]:{...d[O],[l]:[...((A=d[O])==null?void 0:A[l])||[],{roomType:p,col:i,row:a,colSpan:D,rowSpan:b,size:s,orientation:D>b?"horizontal":"vertical"}]}}}),w({isDragging:!1,startCell:null,endCell:null,section:null})},Ye=async e=>{e.preventDefault();const t=M.filter(n=>n.isDeleted==="Y"&&n.isAdded!=="Y"||n.isAdded==="Y"||n.isChanged==="Y"&&n.isDeleted==="N");if(t.length===0){g("변경된 데이터가 없습니다.");return}const l=["A","B","C"],i=[...new Set(t.map(n=>n.FLOOR_ID))];for(const n of i)for(const a of l){const r=t.filter(c=>c.FLOOR_ID===n&&c.SECTION===a&&c.isDeleted!=="Y"),f=r.reduce((c,s)=>c+(y[s.ROOM_TYPE||"1인실"]||0),0);if(r.length>0&&f>8){g(`${n} ${a} 섹션의 총 호실 크기가 8을 초과합니다. (현재: ${f})`);return}}X(!0);try{for(const n of t){let a="";if(n.isDeleted==="Y"&&n.isAdded!=="Y"){if(T.FLOOR_ID&&n.FLOOR_ID!==T.FLOOR_ID||T.SECTION&&n.SECTION!==T.SECTION)continue;a="D"}else n.isAdded==="Y"?a="I":n.isChanged==="Y"&&n.isDeleted==="N"&&(a="U");const r={p_GUBUN:a,p_ROOM_ID:n.ROOM_ID,p_FLOOR_ID:n.FLOOR_ID,p_SECTION:n.SECTION,p_ROOM_INDEX:parseInt(n.ROOM_ID.replace(`${n.FLOOR_ID}${n.SECTION}`,""))||1,p_ROOM_TYPE:n.ROOM_TYPE||"1인실",p_PRICE:n.PRICE||0,p_EMP_NO:(h==null?void 0:h.empNo)||"admin",p_DEBUG:"F"},f=await pe(he,`${ge.getServerUrl("reservation/layout/save")}`,r,{timeout:3e4});if(!f.success){g(`${a==="D"?"삭제":a==="I"?"추가":"수정"} 실패: ${f.errMsg||"서버 오류"} (ROOM_ID: ${n.ROOM_ID})`);continue}}Re("모든 변경사항이 성공적으로 저장되었습니다."),await oe(),N(n=>({...n}))}catch(n){console.error("저장 오류:",n),g("레이아웃 저장 중 오류가 발생했습니다: "+(n.message||"서버 응답 없음"))}finally{X(!1)}};return o.jsxs("div",{className:C.container,children:[o.jsx(ke,{config:L,filters:T,setFilters:Q,onEvent:be}),o.jsx(Ue,{filterFields:F,filters:j,setFilters:$,rowCount:me,onDownloadExcel:()=>Be(R.current,v,"레이아웃관리.xlsx"),buttonStyles:C,children:o.jsxs("div",{className:C.btnGroupCustom,children:[o.jsx("button",{className:`${C.btn} text-bg-primary`,onClick:Ae,children:"추가"}),o.jsx("button",{className:`${C.btn} text-bg-success`,onClick:Ye,children:"저장"})]})}),o.jsxs("div",{className:C.tableWrapper,children:[v==="initializing"&&o.jsx("div",{children:"초기화 중..."}),_&&o.jsx("div",{children:"로딩 중..."}),o.jsx("div",{ref:se,className:C.tableSection,style:{visibility:_||v!=="ready"?"hidden":"visible"}})]}),o.jsx("div",{className:"mt-6 max-w-6xl mx-auto",children:o.jsxs("div",{className:"w-full p-4 bg-gray-100 rounded-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("select",{value:O,onChange:e=>V(e.target.value),style:{padding:"0.5rem 1rem",borderRadius:"8px",border:"2px solid #e9ecef",fontSize:"1rem",background:"white",cursor:"pointer"},children:[o.jsx("option",{value:"",disabled:!0,children:"층을 선택하세요"}),z.map(e=>o.jsx("option",{value:e,children:e},e))]}),o.jsxs("div",{style:{display:"flex",gap:"10px"},children:[o.jsx("input",{type:"text",value:m,onChange:e=>fe(e.target.value),placeholder:"층 입력 (예: 3F)",style:{padding:"0.5rem",borderRadius:"8px",border:"2px solid #e9ecef",fontSize:"1rem"}}),o.jsx("button",{className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:ye,children:"층 추가"}),o.jsx("button",{className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",onClick:Fe,disabled:!O,children:"층 삭제"})]})]}),O&&o.jsxs("div",{style:{position:"relative",width:"100%",height:"400px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",position:"absolute",top:"-2rem",left:0,right:0},children:[o.jsx("span",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#374151",textAlign:"center",flex:"1"},children:"A 섹션"}),o.jsx("span",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#374151",textAlign:"center",flex:"1"},children:"B 섹션"}),o.jsx("span",{style:{fontSize:"1.125rem",fontWeight:"600",color:"#374151",textAlign:"center",flex:"1"},children:"C 섹션"})]}),o.jsx("div",{style:{display:"flex",flexWrap:"nowrap",width:"100%",minWidth:"100%",height:"300px",overflowX:"auto",marginTop:"1.5rem",boxSizing:"border-box"},children:["A","B","C"].map(e=>{var t,l;return o.jsxs("div",{"data-section":e,style:{flex:"1 1 33.3%",padding:"8px",border:"2px solid #d1d5db",borderRadius:"8px",backgroundColor:"#fff",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"repeat(4, 1fr)",gap:"4px",minHeight:"300px",position:"relative",margin:"0 4px",minWidth:"300px",boxSizing:"border-box"},onMouseUp:Pe,children:[Array.from({length:8}).map((i,n)=>{var D,b,k,ie,K,Z,ae,q,U,B,H,W;const a=n%2,r=Math.floor(n/2),f=S.isDragging&&S.section===e&&a>=Math.min((D=S.startCell)==null?void 0:D.col,(b=S.endCell)==null?void 0:b.col)&&a<=Math.max((k=S.startCell)==null?void 0:k.col,(ie=S.endCell)==null?void 0:ie.col)&&r>=Math.min((K=S.startCell)==null?void 0:K.row,(Z=S.endCell)==null?void 0:Z.row)&&r<=Math.max((ae=S.startCell)==null?void 0:ae.row,(q=S.endCell)==null?void 0:q.row),c=(B=(U=ne[O])==null?void 0:U[e])==null?void 0:B.find(d=>d.col===a&&d.row===r),s=M.some(d=>d.FLOOR_ID===O&&d.SECTION===e&&d.col===a&&d.row===r&&d.STATUS==="사용 중"),p=(W=(H=ne[O])==null?void 0:H[e])==null?void 0:W.some(d=>{const A=d.col+(d.colSpan||1)-1,ce=d.row+(d.rowSpan||1)-1;return a>=d.col&&a<=A&&r>=d.row&&r<=ce&&(d.col!==a||d.row!==r)});return c?o.jsx("div",{style:{gridColumn:`${c.col+1} / span ${c.colSpan}`,gridRow:`${c.row+1} / span ${c.rowSpan}`,padding:"4px",textAlign:"center",borderRadius:"4px",color:"#fff",background:s?"#888888":Ve(c.roomType||"1인실"),display:"flex",alignItems:"center",justifyContent:"center",cursor:s?"not-allowed":"pointer",opacity:s?.6:1},children:c.roomType||"1인실"},`cell-${e}-${a}-${r}`):o.jsx("div",{style:{gridColumn:`${a+1} / span 1`,gridRow:`${r+1} / span 1`,padding:"4px",textAlign:"center",borderRadius:"4px",color:"#fff",background:s?"#888888":f?"#90cdf4":"#e5e7eb",display:"flex",alignItems:"center",justifyContent:"center",cursor:s||p?"not-allowed":"pointer",opacity:s||p?.6:1},onMouseDown:()=>!s&&!p&&ve(e,a,r),onMouseOver:()=>!s&&!p&&Le(a,r),children:s?"사용 중":p?"":"빈 공간"},`cell-${e}-${a}-${r}`)}),o.jsxs("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"#374151"},children:["총 크기: ",((l=(t=Oe[O])==null?void 0:t[e])==null?void 0:l.reduce((i,n)=>i+(y[n||"1인실"]||0),0))||0," ","/ 8"]})]},e)})})]})]})}),o.jsxs(ze,{show:Te,onHide:Ne,onConfirm:Me,title:"레이아웃 추가",children:[o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"form-label",children:"층 ID"}),o.jsx("input",{type:"text",className:`form-control ${C.formControl}`,placeholder:"층 ID 입력 (예: 1F)",value:u.FLOOR_ID,onChange:e=>Y({...u,FLOOR_ID:e.target.value})})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"form-label",children:"섹션"}),o.jsxs("select",{className:`form-select ${C.formSelect}`,value:u.SECTION,onChange:e=>Y({...u,SECTION:e.target.value}),children:[o.jsx("option",{value:"",children:"섹션 선택"}),o.jsx("option",{value:"A",children:"A"}),o.jsx("option",{value:"B",children:"B"}),o.jsx("option",{value:"C",children:"C"})]})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"form-label",children:"호실 유형"}),o.jsxs("select",{className:`form-select ${C.formSelect}`,value:u.ROOM_TYPE,onChange:e=>Y({...u,ROOM_TYPE:e.target.value}),children:[o.jsx("option",{value:"1인실",children:"1인실"}),o.jsx("option",{value:"2인실",children:"2인실"}),o.jsx("option",{value:"4인실",children:"4인실"}),o.jsx("option",{value:"8인실",children:"8인실"})]})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"form-label",children:"호실 가격"}),o.jsx("input",{type:"number",className:`form-control ${C.formControl}`,placeholder:"호실 가격 입력",min:"0",value:u.PRICE,onChange:e=>Y({...u,PRICE:parseInt(e.target.value)||0})})]})]})]})},Ve=h=>{switch(h){case"1인실":return"#3498db";case"2인실":return"#e74c3c";case"4인실":return"#2ecc71";case"8인실":return"#FF6B35";default:return"#e5e7eb"}};export{ot as default};
//# sourceMappingURL=ReservationAdminPage-DxR8h3PS.js.map
